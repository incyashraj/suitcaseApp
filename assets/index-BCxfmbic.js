var LF=Object.defineProperty;var cI=i=>{throw TypeError(i)};var OF=(i,e,t)=>e in i?LF(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var ce=(i,e,t)=>OF(i,typeof e!="symbol"?e+"":e,t),OA=(i,e,t)=>e.has(i)||cI("Cannot "+t);var d=(i,e,t)=>(OA(i,e,"read from private field"),t?t.call(i):e.get(i)),R=(i,e,t)=>e.has(i)?cI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),E=(i,e,t,n)=>(OA(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),M=(i,e,t)=>(OA(i,e,"access private method"),t);var Sn=(i,e,t,n)=>({set _(s){E(i,e,s,t)},get _(){return d(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function pw(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var UA={exports:{}},ng={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uI;function UF(){if(uI)return ng;uI=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:o}}return ng.Fragment=e,ng.jsx=t,ng.jsxs=t,ng}var dI;function FF(){return dI||(dI=1,UA.exports=UF()),UA.exports}var T=FF(),FA={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hI;function BF(){if(hI)return Le;hI=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(H){return H===null||typeof H!="object"?null:(H=b&&H[b]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,N={};function I(H,J,re){this.props=H,this.context=J,this.refs=N,this.updater=re||w}I.prototype.isReactComponent={},I.prototype.setState=function(H,J){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,J,"setState")},I.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function P(){}P.prototype=I.prototype;function k(H,J,re){this.props=H,this.context=J,this.refs=N,this.updater=re||w}var L=k.prototype=new P;L.constructor=k,C(L,I.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function U(){}var F={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function q(H,J,re){var de=re.ref;return{$$typeof:i,type:H,key:J,ref:de!==void 0?de:null,props:re}}function Q(H,J){return q(H.type,J,H.props)}function ee(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function se(H){var J={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(re){return J[re]})}var le=/\/+/g;function ue(H,J){return typeof H=="object"&&H!==null&&H.key!=null?se(""+H.key):J.toString(36)}function me(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(U,U):(H.status="pending",H.then(function(J){H.status==="pending"&&(H.status="fulfilled",H.value=J)},function(J){H.status==="pending"&&(H.status="rejected",H.reason=J)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,J,re,de,_e){var Ce=typeof H;(Ce==="undefined"||Ce==="boolean")&&(H=null);var Ee=!1;if(H===null)Ee=!0;else switch(Ce){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(H.$$typeof){case i:case e:Ee=!0;break;case g:return Ee=H._init,G(Ee(H._payload),J,re,de,_e)}}if(Ee)return _e=_e(H),Ee=de===""?"."+ue(H,0):de,O(_e)?(re="",Ee!=null&&(re=Ee.replace(le,"$&/")+"/"),G(_e,J,re,"",function(It){return It})):_e!=null&&(ee(_e)&&(_e=Q(_e,re+(_e.key==null||H&&H.key===_e.key?"":(""+_e.key).replace(le,"$&/")+"/")+Ee)),J.push(_e)),1;Ee=0;var st=de===""?".":de+":";if(O(H))for(var Je=0;Je<H.length;Je++)de=H[Je],Ce=st+ue(de,Je),Ee+=G(de,J,re,Ce,_e);else if(Je=A(H),typeof Je=="function")for(H=Je.call(H),Je=0;!(de=H.next()).done;)de=de.value,Ce=st+ue(de,Je++),Ee+=G(de,J,re,Ce,_e);else if(Ce==="object"){if(typeof H.then=="function")return G(me(H),J,re,de,_e);throw J=String(H),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function $(H,J,re){if(H==null)return H;var de=[],_e=0;return G(H,de,"","",function(Ce){return J.call(re,Ce,_e++)}),de}function oe(H){if(H._status===-1){var J=H._result;J=J(),J.then(function(re){(H._status===0||H._status===-1)&&(H._status=1,H._result=re)},function(re){(H._status===0||H._status===-1)&&(H._status=2,H._result=re)}),H._status===-1&&(H._status=0,H._result=J)}if(H._status===1)return H._result.default;throw H._result}var pe=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Me={map:$,forEach:function(H,J,re){$(H,function(){J.apply(this,arguments)},re)},count:function(H){var J=0;return $(H,function(){J++}),J},toArray:function(H){return $(H,function(J){return J})||[]},only:function(H){if(!ee(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Le.Activity=y,Le.Children=Me,Le.Component=I,Le.Fragment=t,Le.Profiler=s,Le.PureComponent=k,Le.StrictMode=n,Le.Suspense=h,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Le.__COMPILER_RUNTIME={__proto__:null,c:function(H){return F.H.useMemoCache(H)}},Le.cache=function(H){return function(){return H.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(H,J,re){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var de=C({},H.props),_e=H.key;if(J!=null)for(Ce in J.key!==void 0&&(_e=""+J.key),J)!K.call(J,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&J.ref===void 0||(de[Ce]=J[Ce]);var Ce=arguments.length-2;if(Ce===1)de.children=re;else if(1<Ce){for(var Ee=Array(Ce),st=0;st<Ce;st++)Ee[st]=arguments[st+2];de.children=Ee}return q(H.type,_e,de)},Le.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:o,_context:H},H},Le.createElement=function(H,J,re){var de,_e={},Ce=null;if(J!=null)for(de in J.key!==void 0&&(Ce=""+J.key),J)K.call(J,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(_e[de]=J[de]);var Ee=arguments.length-2;if(Ee===1)_e.children=re;else if(1<Ee){for(var st=Array(Ee),Je=0;Je<Ee;Je++)st[Je]=arguments[Je+2];_e.children=st}if(H&&H.defaultProps)for(de in Ee=H.defaultProps,Ee)_e[de]===void 0&&(_e[de]=Ee[de]);return q(H,Ce,_e)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(H){return{$$typeof:c,render:H}},Le.isValidElement=ee,Le.lazy=function(H){return{$$typeof:g,_payload:{_status:-1,_result:H},_init:oe}},Le.memo=function(H,J){return{$$typeof:f,type:H,compare:J===void 0?null:J}},Le.startTransition=function(H){var J=F.T,re={};F.T=re;try{var de=H(),_e=F.S;_e!==null&&_e(re,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(U,pe)}catch(Ce){pe(Ce)}finally{J!==null&&re.types!==null&&(J.types=re.types),F.T=J}},Le.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Le.use=function(H){return F.H.use(H)},Le.useActionState=function(H,J,re){return F.H.useActionState(H,J,re)},Le.useCallback=function(H,J){return F.H.useCallback(H,J)},Le.useContext=function(H){return F.H.useContext(H)},Le.useDebugValue=function(){},Le.useDeferredValue=function(H,J){return F.H.useDeferredValue(H,J)},Le.useEffect=function(H,J){return F.H.useEffect(H,J)},Le.useEffectEvent=function(H){return F.H.useEffectEvent(H)},Le.useId=function(){return F.H.useId()},Le.useImperativeHandle=function(H,J,re){return F.H.useImperativeHandle(H,J,re)},Le.useInsertionEffect=function(H,J){return F.H.useInsertionEffect(H,J)},Le.useLayoutEffect=function(H,J){return F.H.useLayoutEffect(H,J)},Le.useMemo=function(H,J){return F.H.useMemo(H,J)},Le.useOptimistic=function(H,J){return F.H.useOptimistic(H,J)},Le.useReducer=function(H,J,re){return F.H.useReducer(H,J,re)},Le.useRef=function(H){return F.H.useRef(H)},Le.useState=function(H){return F.H.useState(H)},Le.useSyncExternalStore=function(H,J,re){return F.H.useSyncExternalStore(H,J,re)},Le.useTransition=function(){return F.H.useTransition()},Le.version="19.2.4",Le}var fI;function gw(){return fI||(fI=1,FA.exports=BF()),FA.exports}var Z=gw();const HF=pw(Z);var BA={exports:{}},ig={},HA={exports:{}},GA={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pI;function GF(){return pI||(pI=1,(function(i){function e(G,$){var oe=G.length;G.push($);e:for(;0<oe;){var pe=oe-1>>>1,Me=G[pe];if(0<s(Me,$))G[pe]=$,G[oe]=Me,oe=pe;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var $=G[0],oe=G.pop();if(oe!==$){G[0]=oe;e:for(var pe=0,Me=G.length,H=Me>>>1;pe<H;){var J=2*(pe+1)-1,re=G[J],de=J+1,_e=G[de];if(0>s(re,oe))de<Me&&0>s(_e,re)?(G[pe]=_e,G[de]=oe,pe=de):(G[pe]=re,G[J]=oe,pe=J);else if(de<Me&&0>s(_e,oe))G[pe]=_e,G[de]=oe,pe=de;else break e}}return $}function s(G,$){var oe=G.sortIndex-$.sortIndex;return oe!==0?oe:G.id-$.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,y=null,b=3,A=!1,w=!1,C=!1,N=!1,I=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function L(G){for(var $=t(f);$!==null;){if($.callback===null)n(f);else if($.startTime<=G)n(f),$.sortIndex=$.expirationTime,e(h,$);else break;$=t(f)}}function O(G){if(C=!1,L(G),!w)if(t(h)!==null)w=!0,U||(U=!0,se());else{var $=t(f);$!==null&&me(O,$.startTime-G)}}var U=!1,F=-1,K=5,q=-1;function Q(){return N?!0:!(i.unstable_now()-q<K)}function ee(){if(N=!1,U){var G=i.unstable_now();q=G;var $=!0;try{e:{w=!1,C&&(C=!1,P(F),F=-1),A=!0;var oe=b;try{t:{for(L(G),y=t(h);y!==null&&!(y.expirationTime>G&&Q());){var pe=y.callback;if(typeof pe=="function"){y.callback=null,b=y.priorityLevel;var Me=pe(y.expirationTime<=G);if(G=i.unstable_now(),typeof Me=="function"){y.callback=Me,L(G),$=!0;break t}y===t(h)&&n(h),L(G)}else n(h);y=t(h)}if(y!==null)$=!0;else{var H=t(f);H!==null&&me(O,H.startTime-G),$=!1}}break e}finally{y=null,b=oe,A=!1}$=void 0}}finally{$?se():U=!1}}}var se;if(typeof k=="function")se=function(){k(ee)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ue=le.port2;le.port1.onmessage=ee,se=function(){ue.postMessage(null)}}else se=function(){I(ee,0)};function me(G,$){F=I(function(){G(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(G){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var oe=b;b=$;try{return G()}finally{b=oe}},i.unstable_requestPaint=function(){N=!0},i.unstable_runWithPriority=function(G,$){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var oe=b;b=G;try{return $()}finally{b=oe}},i.unstable_scheduleCallback=function(G,$,oe){var pe=i.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?pe+oe:pe):oe=pe,G){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=oe+Me,G={id:g++,callback:$,priorityLevel:G,startTime:oe,expirationTime:Me,sortIndex:-1},oe>pe?(G.sortIndex=oe,e(f,G),t(h)===null&&G===t(f)&&(C?(P(F),F=-1):C=!0,me(O,oe-pe))):(G.sortIndex=Me,e(h,G),w||A||(w=!0,U||(U=!0,se()))),G},i.unstable_shouldYield=Q,i.unstable_wrapCallback=function(G){var $=b;return function(){var oe=b;b=$;try{return G.apply(this,arguments)}finally{b=oe}}}})(GA)),GA}var gI;function zF(){return gI||(gI=1,HA.exports=GF()),HA.exports}var zA={exports:{}},ei={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mI;function VF(){if(mI)return ei;mI=1;var i=gw();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:h,containerInfo:f,implementation:g}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ei.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ei.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,g)},ei.flushSync=function(h){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=g,n.d.f()}},ei.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},ei.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},ei.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ei.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},ei.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ei.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},ei.requestFormReset=function(h){n.d.r(h)},ei.unstable_batchedUpdates=function(h,f){return h(f)},ei.useFormState=function(h,f,g){return l.H.useFormState(h,f,g)},ei.useFormStatus=function(){return l.H.useHostTransitionStatus()},ei.version="19.2.4",ei}var yI;function qF(){if(yI)return zA.exports;yI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),zA.exports=VF(),zA.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vI;function $F(){if(vI)return ig;vI=1;var i=zF(),e=gw(),t=qF();function n(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,u=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(u=a.return),r=a.return;while(r)}return a.tag===3?u:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function c(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(n(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(n(188));return a!==r?null:r}for(var u=r,p=a;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(p=_.return,p!==null){u=p;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return h(_),r;if(S===p)return h(_),a;S=S.sibling}throw Error(n(188))}if(u.return!==p.return)u=_,p=S;else{for(var x=!1,D=_.child;D;){if(D===u){x=!0,u=_,p=S;break}if(D===p){x=!0,p=_,u=S;break}D=D.sibling}if(!x){for(D=S.child;D;){if(D===u){x=!0,u=S,p=_;break}if(D===p){x=!0,p=S,u=_;break}D=D.sibling}if(!x)throw Error(n(189))}}if(u.alternate!==p)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:a}function g(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=g(r),a!==null)return a;r=r.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),k=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function se(r){return r===null||typeof r!="object"?null:(r=ee&&r[ee]||r["@@iterator"],typeof r=="function"?r:null)}var le=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===le?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case I:return"Profiler";case N:return"StrictMode";case O:return"Suspense";case U:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case k:return r.displayName||"Context";case P:return(r._context.displayName||"Context")+".Consumer";case L:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case F:return a=r.displayName||null,a!==null?a:ue(r.type)||"Memo";case K:a=r._payload,r=r._init;try{return ue(r(a))}catch{}}return null}var me=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},pe=[],Me=-1;function H(r){return{current:r}}function J(r){0>Me||(r.current=pe[Me],pe[Me]=null,Me--)}function re(r,a){Me++,pe[Me]=r.current,r.current=a}var de=H(null),_e=H(null),Ce=H(null),Ee=H(null);function st(r,a){switch(re(Ce,a),re(_e,r),re(de,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?DR(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=DR(a),r=kR(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}J(de),re(de,r)}function Je(){J(de),J(_e),J(Ce)}function It(r){r.memoizedState!==null&&re(Ee,r);var a=de.current,u=kR(a,r.type);a!==u&&(re(_e,r),re(de,u))}function Xe(r){_e.current===r&&(J(de),J(_e)),Ee.current===r&&(J(Ee),Qp._currentValue=oe)}var Cn,rt;function We(r){if(Cn===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);Cn=a&&a[1]||"",rt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cn+r+rt}var pt=!1;function Qt(r,a){if(!r||pt)return"";pt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(j){var W=j}Reflect.construct(r,[],ie)}else{try{ie.call()}catch(j){W=j}r.call(ie.prototype)}}else{try{throw Error()}catch(j){W=j}(ie=r())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(j){if(j&&W&&typeof j.stack=="string")return[j.stack,W.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),x=S[0],D=S[1];if(x&&D){var B=x.split(`
`),X=D.split(`
`);for(_=p=0;p<B.length&&!B[p].includes("DetermineComponentFrameRoot");)p++;for(;_<X.length&&!X[_].includes("DetermineComponentFrameRoot");)_++;if(p===B.length||_===X.length)for(p=B.length-1,_=X.length-1;1<=p&&0<=_&&B[p]!==X[_];)_--;for(;1<=p&&0<=_;p--,_--)if(B[p]!==X[_]){if(p!==1||_!==1)do if(p--,_--,0>_||B[p]!==X[_]){var te=`
`+B[p].replace(" at new "," at ");return r.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",r.displayName)),te}while(1<=p&&0<=_);break}}}finally{pt=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?We(u):""}function Ht(r,a){switch(r.tag){case 26:case 27:case 5:return We(r.type);case 16:return We("Lazy");case 13:return r.child!==a&&a!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return Qt(r.type,!1);case 11:return Qt(r.type.render,!1);case 1:return Qt(r.type,!0);case 31:return We("Activity");default:return""}}function er(r){try{var a="",u=null;do a+=Ht(r,u),u=r,r=r.return;while(r);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Vi=Object.prototype.hasOwnProperty,Ts=i.unstable_scheduleCallback,ws=i.unstable_cancelCallback,ae=i.unstable_shouldYield,Ge=i.unstable_requestPaint,Re=i.unstable_now,hn=i.unstable_getCurrentPriorityLevel,wi=i.unstable_ImmediatePriority,di=i.unstable_UserBlockingPriority,Qn=i.unstable_NormalPriority,Rr=i.unstable_LowPriority,qi=i.unstable_IdlePriority,ye=i.log,Nt=i.unstable_setDisableYieldValue,gt=null,_t=null;function tr(r){if(typeof ye=="function"&&Nt(r),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(gt,r)}catch{}}var Zn=Math.clz32?Math.clz32:SO,Vy=Math.log,qy=Math.LN2;function SO(r){return r>>>=0,r===0?32:31-(Vy(r)/qy|0)|0}var $y=256,Yy=262144,Xy=4194304;function yc(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Wy(r,a,u){var p=r.pendingLanes;if(p===0)return 0;var _=0,S=r.suspendedLanes,x=r.pingedLanes;r=r.warmLanes;var D=p&134217727;return D!==0?(p=D&~S,p!==0?_=yc(p):(x&=D,x!==0?_=yc(x):u||(u=D&~r,u!==0&&(_=yc(u))))):(D=p&~S,D!==0?_=yc(D):x!==0?_=yc(x):u||(u=p&~r,u!==0&&(_=yc(u)))),_===0?0:a!==0&&a!==_&&(a&S)===0&&(S=_&-_,u=a&-a,S>=u||S===32&&(u&4194048)!==0)?a:_}function dp(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function AO(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fC(){var r=Xy;return Xy<<=1,(Xy&62914560)===0&&(Xy=4194304),r}function T_(r){for(var a=[],u=0;31>u;u++)a.push(r);return a}function hp(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function EO(r,a,u,p,_,S){var x=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var D=r.entanglements,B=r.expirationTimes,X=r.hiddenUpdates;for(u=x&~u;0<u;){var te=31-Zn(u),ie=1<<te;D[te]=0,B[te]=-1;var W=X[te];if(W!==null)for(X[te]=null,te=0;te<W.length;te++){var j=W[te];j!==null&&(j.lane&=-536870913)}u&=~ie}p!==0&&pC(r,p,0),S!==0&&_===0&&r.tag!==0&&(r.suspendedLanes|=S&~(x&~a))}function pC(r,a,u){r.pendingLanes|=a,r.suspendedLanes&=~a;var p=31-Zn(a);r.entangledLanes|=a,r.entanglements[p]=r.entanglements[p]|1073741824|u&261930}function gC(r,a){var u=r.entangledLanes|=a;for(r=r.entanglements;u;){var p=31-Zn(u),_=1<<p;_&a|r[p]&a&&(r[p]|=a),u&=~_}}function mC(r,a){var u=a&-a;return u=(u&42)!==0?1:w_(u),(u&(r.suspendedLanes|a))!==0?0:u}function w_(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function C_(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function yC(){var r=$.p;return r!==0?r:(r=window.event,r===void 0?32:nI(r.type))}function vC(r,a){var u=$.p;try{return $.p=r,a()}finally{$.p=u}}var Ua=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Ua,Ci="__reactProps$"+Ua,gd="__reactContainer$"+Ua,x_="__reactEvents$"+Ua,TO="__reactListeners$"+Ua,wO="__reactHandles$"+Ua,bC="__reactResources$"+Ua,fp="__reactMarker$"+Ua;function R_(r){delete r[Fn],delete r[Ci],delete r[x_],delete r[TO],delete r[wO]}function md(r){var a=r[Fn];if(a)return a;for(var u=r.parentNode;u;){if(a=u[gd]||u[Fn]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(r=HR(r);r!==null;){if(u=r[Fn])return u;r=HR(r)}return a}r=u,u=r.parentNode}return null}function yd(r){if(r=r[Fn]||r[gd]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function pp(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(n(33))}function vd(r){var a=r[bC];return a||(a=r[bC]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function xn(r){r[fp]=!0}var _C=new Set,SC={};function vc(r,a){bd(r,a),bd(r+"Capture",a)}function bd(r,a){for(SC[r]=a,r=0;r<a.length;r++)_C.add(a[r])}var CO=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),AC={},EC={};function xO(r){return Vi.call(EC,r)?!0:Vi.call(AC,r)?!1:CO.test(r)?EC[r]=!0:(AC[r]=!0,!1)}function Ky(r,a,u){if(xO(a))if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+u)}}function Jy(r,a,u){if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+u)}}function mo(r,a,u,p){if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(a,u,""+p)}}function Cs(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function TC(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function RO(r,a,u){var p=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,S=p.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return _.call(this)},set:function(x){u=""+x,S.call(this,x)}}),Object.defineProperty(r,a,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(x){u=""+x},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function I_(r){if(!r._valueTracker){var a=TC(r)?"checked":"value";r._valueTracker=RO(r,a,""+r[a])}}function wC(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var u=a.getValue(),p="";return r&&(p=TC(r)?r.checked?"true":"false":r.value),r=p,r!==u?(a.setValue(r),!0):!1}function jy(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var IO=/[\n"\\]/g;function xs(r){return r.replace(IO,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function N_(r,a,u,p,_,S,x,D){r.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.type=x:r.removeAttribute("type"),a!=null?x==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Cs(a)):r.value!==""+Cs(a)&&(r.value=""+Cs(a)):x!=="submit"&&x!=="reset"||r.removeAttribute("value"),a!=null?M_(r,x,Cs(a)):u!=null?M_(r,x,Cs(u)):p!=null&&r.removeAttribute("value"),_==null&&S!=null&&(r.defaultChecked=!!S),_!=null&&(r.checked=_&&typeof _!="function"&&typeof _!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+Cs(D):r.removeAttribute("name")}function CC(r,a,u,p,_,S,x,D){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.type=S),a!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||a!=null)){I_(r);return}u=u!=null?""+Cs(u):"",a=a!=null?""+Cs(a):u,D||a===r.value||(r.value=a),r.defaultValue=a}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,r.checked=D?r.checked:!!p,r.defaultChecked=!!p,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.name=x),I_(r)}function M_(r,a,u){a==="number"&&jy(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function _d(r,a,u,p){if(r=r.options,a){a={};for(var _=0;_<u.length;_++)a["$"+u[_]]=!0;for(u=0;u<r.length;u++)_=a.hasOwnProperty("$"+r[u].value),r[u].selected!==_&&(r[u].selected=_),_&&p&&(r[u].defaultSelected=!0)}else{for(u=""+Cs(u),a=null,_=0;_<r.length;_++){if(r[_].value===u){r[_].selected=!0,p&&(r[_].defaultSelected=!0);return}a!==null||r[_].disabled||(a=r[_])}a!==null&&(a.selected=!0)}}function xC(r,a,u){if(a!=null&&(a=""+Cs(a),a!==r.value&&(r.value=a),u==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=u!=null?""+Cs(u):""}function RC(r,a,u,p){if(a==null){if(p!=null){if(u!=null)throw Error(n(92));if(me(p)){if(1<p.length)throw Error(n(93));p=p[0]}u=p}u==null&&(u=""),a=u}u=Cs(a),r.defaultValue=u,p=r.textContent,p===u&&p!==""&&p!==null&&(r.value=p),I_(r)}function Sd(r,a){if(a){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=a;return}}r.textContent=a}var NO=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function IC(r,a,u){var p=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":p?r.setProperty(a,u):typeof u!="number"||u===0||NO.has(a)?a==="float"?r.cssFloat=u:r[a]=(""+u).trim():r[a]=u+"px"}function NC(r,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(r=r.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?r.setProperty(p,""):p==="float"?r.cssFloat="":r[p]="");for(var _ in a)p=a[_],a.hasOwnProperty(_)&&u[_]!==p&&IC(r,_,p)}else for(var S in a)a.hasOwnProperty(S)&&IC(r,S,a[S])}function D_(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var MO=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),DO=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qy(r){return DO.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function yo(){}var k_=null;function P_(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ad=null,Ed=null;function MC(r){var a=yd(r);if(a&&(r=a.stateNode)){var u=r[Ci]||null;e:switch(r=a.stateNode,a.type){case"input":if(N_(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+xs(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var p=u[a];if(p!==r&&p.form===r.form){var _=p[Ci]||null;if(!_)throw Error(n(90));N_(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(a=0;a<u.length;a++)p=u[a],p.form===r.form&&wC(p)}break e;case"textarea":xC(r,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&_d(r,!!u.multiple,a,!1)}}}var L_=!1;function DC(r,a,u){if(L_)return r(a,u);L_=!0;try{var p=r(a);return p}finally{if(L_=!1,(Ad!==null||Ed!==null)&&(B0(),Ad&&(a=Ad,r=Ed,Ed=Ad=null,MC(a),r)))for(a=0;a<r.length;a++)MC(r[a])}}function gp(r,a){var u=r.stateNode;if(u===null)return null;var p=u[Ci]||null;if(p===null)return null;u=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(r=r.type,p=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!p;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var vo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O_=!1;if(vo)try{var mp={};Object.defineProperty(mp,"passive",{get:function(){O_=!0}}),window.addEventListener("test",mp,mp),window.removeEventListener("test",mp,mp)}catch{O_=!1}var Fa=null,U_=null,Zy=null;function kC(){if(Zy)return Zy;var r,a=U_,u=a.length,p,_="value"in Fa?Fa.value:Fa.textContent,S=_.length;for(r=0;r<u&&a[r]===_[r];r++);var x=u-r;for(p=1;p<=x&&a[u-p]===_[S-p];p++);return Zy=_.slice(r,1<p?1-p:void 0)}function e0(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function t0(){return!0}function PC(){return!1}function xi(r){function a(u,p,_,S,x){this._reactName=u,this._targetInst=_,this.type=p,this.nativeEvent=S,this.target=x,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(u=r[D],this[D]=u?u(S):S[D]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?t0:PC,this.isPropagationStopped=PC,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=t0)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=t0)},persist:function(){},isPersistent:t0}),a}var bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n0=xi(bc),yp=y({},bc,{view:0,detail:0}),kO=xi(yp),F_,B_,vp,i0=y({},yp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G_,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==vp&&(vp&&r.type==="mousemove"?(F_=r.screenX-vp.screenX,B_=r.screenY-vp.screenY):B_=F_=0,vp=r),F_)},movementY:function(r){return"movementY"in r?r.movementY:B_}}),LC=xi(i0),PO=y({},i0,{dataTransfer:0}),LO=xi(PO),OO=y({},yp,{relatedTarget:0}),H_=xi(OO),UO=y({},bc,{animationName:0,elapsedTime:0,pseudoElement:0}),FO=xi(UO),BO=y({},bc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),HO=xi(BO),GO=y({},bc,{data:0}),OC=xi(GO),zO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $O(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=qO[r])?!!a[r]:!1}function G_(){return $O}var YO=y({},yp,{key:function(r){if(r.key){var a=zO[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=e0(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?VO[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G_,charCode:function(r){return r.type==="keypress"?e0(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?e0(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),XO=xi(YO),WO=y({},i0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UC=xi(WO),KO=y({},yp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G_}),JO=xi(KO),jO=y({},bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),QO=xi(jO),ZO=y({},i0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),eU=xi(ZO),tU=y({},bc,{newState:0,oldState:0}),nU=xi(tU),iU=[9,13,27,32],z_=vo&&"CompositionEvent"in window,bp=null;vo&&"documentMode"in document&&(bp=document.documentMode);var sU=vo&&"TextEvent"in window&&!bp,FC=vo&&(!z_||bp&&8<bp&&11>=bp),BC=" ",HC=!1;function GC(r,a){switch(r){case"keyup":return iU.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zC(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Td=!1;function rU(r,a){switch(r){case"compositionend":return zC(a);case"keypress":return a.which!==32?null:(HC=!0,BC);case"textInput":return r=a.data,r===BC&&HC?null:r;default:return null}}function oU(r,a){if(Td)return r==="compositionend"||!z_&&GC(r,a)?(r=kC(),Zy=U_=Fa=null,Td=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return FC&&a.locale!=="ko"?null:a.data;default:return null}}var aU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VC(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!aU[r.type]:a==="textarea"}function qC(r,a,u,p){Ad?Ed?Ed.push(p):Ed=[p]:Ad=p,a=Y0(a,"onChange"),0<a.length&&(u=new n0("onChange","change",null,u,p),r.push({event:u,listeners:a}))}var _p=null,Sp=null;function lU(r){CR(r,0)}function s0(r){var a=pp(r);if(wC(a))return r}function $C(r,a){if(r==="change")return a}var YC=!1;if(vo){var V_;if(vo){var q_="oninput"in document;if(!q_){var XC=document.createElement("div");XC.setAttribute("oninput","return;"),q_=typeof XC.oninput=="function"}V_=q_}else V_=!1;YC=V_&&(!document.documentMode||9<document.documentMode)}function WC(){_p&&(_p.detachEvent("onpropertychange",KC),Sp=_p=null)}function KC(r){if(r.propertyName==="value"&&s0(Sp)){var a=[];qC(a,Sp,r,P_(r)),DC(lU,a)}}function cU(r,a,u){r==="focusin"?(WC(),_p=a,Sp=u,_p.attachEvent("onpropertychange",KC)):r==="focusout"&&WC()}function uU(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return s0(Sp)}function dU(r,a){if(r==="click")return s0(a)}function hU(r,a){if(r==="input"||r==="change")return s0(a)}function fU(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var $i=typeof Object.is=="function"?Object.is:fU;function Ap(r,a){if($i(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var u=Object.keys(r),p=Object.keys(a);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var _=u[p];if(!Vi.call(a,_)||!$i(r[_],a[_]))return!1}return!0}function JC(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function jC(r,a){var u=JC(r);r=0;for(var p;u;){if(u.nodeType===3){if(p=r+u.textContent.length,r<=a&&p>=a)return{node:u,offset:a-r};r=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=JC(u)}}function QC(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?QC(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function ZC(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=jy(r.document);a instanceof r.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)r=a.contentWindow;else break;a=jy(r.document)}return a}function $_(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var pU=vo&&"documentMode"in document&&11>=document.documentMode,wd=null,Y_=null,Ep=null,X_=!1;function ex(r,a,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;X_||wd==null||wd!==jy(p)||(p=wd,"selectionStart"in p&&$_(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ep&&Ap(Ep,p)||(Ep=p,p=Y0(Y_,"onSelect"),0<p.length&&(a=new n0("onSelect","select",null,a,u),r.push({event:a,listeners:p}),a.target=wd)))}function _c(r,a){var u={};return u[r.toLowerCase()]=a.toLowerCase(),u["Webkit"+r]="webkit"+a,u["Moz"+r]="moz"+a,u}var Cd={animationend:_c("Animation","AnimationEnd"),animationiteration:_c("Animation","AnimationIteration"),animationstart:_c("Animation","AnimationStart"),transitionrun:_c("Transition","TransitionRun"),transitionstart:_c("Transition","TransitionStart"),transitioncancel:_c("Transition","TransitionCancel"),transitionend:_c("Transition","TransitionEnd")},W_={},tx={};vo&&(tx=document.createElement("div").style,"AnimationEvent"in window||(delete Cd.animationend.animation,delete Cd.animationiteration.animation,delete Cd.animationstart.animation),"TransitionEvent"in window||delete Cd.transitionend.transition);function Sc(r){if(W_[r])return W_[r];if(!Cd[r])return r;var a=Cd[r],u;for(u in a)if(a.hasOwnProperty(u)&&u in tx)return W_[r]=a[u];return r}var nx=Sc("animationend"),ix=Sc("animationiteration"),sx=Sc("animationstart"),gU=Sc("transitionrun"),mU=Sc("transitionstart"),yU=Sc("transitioncancel"),rx=Sc("transitionend"),ox=new Map,K_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");K_.push("scrollEnd");function nr(r,a){ox.set(r,a),vc(a,[r])}var r0=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Rs=[],xd=0,J_=0;function o0(){for(var r=xd,a=J_=xd=0;a<r;){var u=Rs[a];Rs[a++]=null;var p=Rs[a];Rs[a++]=null;var _=Rs[a];Rs[a++]=null;var S=Rs[a];if(Rs[a++]=null,p!==null&&_!==null){var x=p.pending;x===null?_.next=_:(_.next=x.next,x.next=_),p.pending=_}S!==0&&ax(u,_,S)}}function a0(r,a,u,p){Rs[xd++]=r,Rs[xd++]=a,Rs[xd++]=u,Rs[xd++]=p,J_|=p,r.lanes|=p,r=r.alternate,r!==null&&(r.lanes|=p)}function j_(r,a,u,p){return a0(r,a,u,p),l0(r)}function Ac(r,a){return a0(r,null,null,a),l0(r)}function ax(r,a,u){r.lanes|=u;var p=r.alternate;p!==null&&(p.lanes|=u);for(var _=!1,S=r.return;S!==null;)S.childLanes|=u,p=S.alternate,p!==null&&(p.childLanes|=u),S.tag===22&&(r=S.stateNode,r===null||r._visibility&1||(_=!0)),r=S,S=S.return;return r.tag===3?(S=r.stateNode,_&&a!==null&&(_=31-Zn(u),r=S.hiddenUpdates,p=r[_],p===null?r[_]=[a]:p.push(a),a.lane=u|536870912),S):null}function l0(r){if(50<$p)throw $p=0,oA=null,Error(n(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Rd={};function vU(r,a,u,p){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yi(r,a,u,p){return new vU(r,a,u,p)}function Q_(r){return r=r.prototype,!(!r||!r.isReactComponent)}function bo(r,a){var u=r.alternate;return u===null?(u=Yi(r.tag,a,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=a,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,a=r.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function lx(r,a){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,a=u.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function c0(r,a,u,p,_,S){var x=0;if(p=r,typeof r=="function")Q_(r)&&(x=1);else if(typeof r=="string")x=EF(r,u,de.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=Yi(31,u,a,_),r.elementType=q,r.lanes=S,r;case C:return Ec(u.children,_,S,a);case N:x=8,_|=24;break;case I:return r=Yi(12,u,a,_|2),r.elementType=I,r.lanes=S,r;case O:return r=Yi(13,u,a,_),r.elementType=O,r.lanes=S,r;case U:return r=Yi(19,u,a,_),r.elementType=U,r.lanes=S,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k:x=10;break e;case P:x=9;break e;case L:x=11;break e;case F:x=14;break e;case K:x=16,p=null;break e}x=29,u=Error(n(130,r===null?"null":typeof r,"")),p=null}return a=Yi(x,u,a,_),a.elementType=r,a.type=p,a.lanes=S,a}function Ec(r,a,u,p){return r=Yi(7,r,p,a),r.lanes=u,r}function Z_(r,a,u){return r=Yi(6,r,null,a),r.lanes=u,r}function cx(r){var a=Yi(18,null,null,0);return a.stateNode=r,a}function eS(r,a,u){return a=Yi(4,r.children!==null?r.children:[],r.key,a),a.lanes=u,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var ux=new WeakMap;function Is(r,a){if(typeof r=="object"&&r!==null){var u=ux.get(r);return u!==void 0?u:(a={value:r,source:a,stack:er(a)},ux.set(r,a),a)}return{value:r,source:a,stack:er(a)}}var Id=[],Nd=0,u0=null,Tp=0,Ns=[],Ms=0,Ba=null,Ir=1,Nr="";function _o(r,a){Id[Nd++]=Tp,Id[Nd++]=u0,u0=r,Tp=a}function dx(r,a,u){Ns[Ms++]=Ir,Ns[Ms++]=Nr,Ns[Ms++]=Ba,Ba=r;var p=Ir;r=Nr;var _=32-Zn(p)-1;p&=~(1<<_),u+=1;var S=32-Zn(a)+_;if(30<S){var x=_-_%5;S=(p&(1<<x)-1).toString(32),p>>=x,_-=x,Ir=1<<32-Zn(a)+_|u<<_|p,Nr=S+r}else Ir=1<<S|u<<_|p,Nr=r}function tS(r){r.return!==null&&(_o(r,1),dx(r,1,0))}function nS(r){for(;r===u0;)u0=Id[--Nd],Id[Nd]=null,Tp=Id[--Nd],Id[Nd]=null;for(;r===Ba;)Ba=Ns[--Ms],Ns[Ms]=null,Nr=Ns[--Ms],Ns[Ms]=null,Ir=Ns[--Ms],Ns[Ms]=null}function hx(r,a){Ns[Ms++]=Ir,Ns[Ms++]=Nr,Ns[Ms++]=Ba,Ir=a.id,Nr=a.overflow,Ba=r}var Bn=null,Gt=null,nt=!1,Ha=null,Ds=!1,iS=Error(n(519));function Ga(r){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wp(Is(a,r)),iS}function fx(r){var a=r.stateNode,u=r.type,p=r.memoizedProps;switch(a[Fn]=r,a[Ci]=p,u){case"dialog":Qe("cancel",a),Qe("close",a);break;case"iframe":case"object":case"embed":Qe("load",a);break;case"video":case"audio":for(u=0;u<Xp.length;u++)Qe(Xp[u],a);break;case"source":Qe("error",a);break;case"img":case"image":case"link":Qe("error",a),Qe("load",a);break;case"details":Qe("toggle",a);break;case"input":Qe("invalid",a),CC(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Qe("invalid",a);break;case"textarea":Qe("invalid",a),RC(a,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||p.suppressHydrationWarning===!0||NR(a.textContent,u)?(p.popover!=null&&(Qe("beforetoggle",a),Qe("toggle",a)),p.onScroll!=null&&Qe("scroll",a),p.onScrollEnd!=null&&Qe("scrollend",a),p.onClick!=null&&(a.onclick=yo),a=!0):a=!1,a||Ga(r,!0)}function px(r){for(Bn=r.return;Bn;)switch(Bn.tag){case 5:case 31:case 13:Ds=!1;return;case 27:case 3:Ds=!0;return;default:Bn=Bn.return}}function Md(r){if(r!==Bn)return!1;if(!nt)return px(r),nt=!0,!1;var a=r.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||SA(r.type,r.memoizedProps)),u=!u),u&&Gt&&Ga(r),px(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Gt=BR(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Gt=BR(r)}else a===27?(a=Gt,tl(r.type)?(r=CA,CA=null,Gt=r):Gt=a):Gt=Bn?Ps(r.stateNode.nextSibling):null;return!0}function Tc(){Gt=Bn=null,nt=!1}function sS(){var r=Ha;return r!==null&&(Mi===null?Mi=r:Mi.push.apply(Mi,r),Ha=null),r}function wp(r){Ha===null?Ha=[r]:Ha.push(r)}var rS=H(null),wc=null,So=null;function za(r,a,u){re(rS,a._currentValue),a._currentValue=u}function Ao(r){r._currentValue=rS.current,J(rS)}function oS(r,a,u){for(;r!==null;){var p=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),r===u)break;r=r.return}}function aS(r,a,u,p){var _=r.child;for(_!==null&&(_.return=r);_!==null;){var S=_.dependencies;if(S!==null){var x=_.child;S=S.firstContext;e:for(;S!==null;){var D=S;S=_;for(var B=0;B<a.length;B++)if(D.context===a[B]){S.lanes|=u,D=S.alternate,D!==null&&(D.lanes|=u),oS(S.return,u,r),p||(x=null);break e}S=D.next}}else if(_.tag===18){if(x=_.return,x===null)throw Error(n(341));x.lanes|=u,S=x.alternate,S!==null&&(S.lanes|=u),oS(x,u,r),x=null}else x=_.child;if(x!==null)x.return=_;else for(x=_;x!==null;){if(x===r){x=null;break}if(_=x.sibling,_!==null){_.return=x.return,x=_;break}x=x.return}_=x}}function Dd(r,a,u,p){r=null;for(var _=a,S=!1;_!==null;){if(!S){if((_.flags&524288)!==0)S=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var x=_.alternate;if(x===null)throw Error(n(387));if(x=x.memoizedProps,x!==null){var D=_.type;$i(_.pendingProps.value,x.value)||(r!==null?r.push(D):r=[D])}}else if(_===Ee.current){if(x=_.alternate,x===null)throw Error(n(387));x.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(r!==null?r.push(Qp):r=[Qp])}_=_.return}r!==null&&aS(a,r,u,p),a.flags|=262144}function d0(r){for(r=r.firstContext;r!==null;){if(!$i(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Cc(r){wc=r,So=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Hn(r){return gx(wc,r)}function h0(r,a){return wc===null&&Cc(r),gx(r,a)}function gx(r,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},So===null){if(r===null)throw Error(n(308));So=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else So=So.next=a;return u}var bU=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(u,p){r.push(p)}};this.abort=function(){a.aborted=!0,r.forEach(function(u){return u()})}},_U=i.unstable_scheduleCallback,SU=i.unstable_NormalPriority,fn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lS(){return{controller:new bU,data:new Map,refCount:0}}function Cp(r){r.refCount--,r.refCount===0&&_U(SU,function(){r.controller.abort()})}var xp=null,cS=0,kd=0,Pd=null;function AU(r,a){if(xp===null){var u=xp=[];cS=0,kd=hA(),Pd={status:"pending",value:void 0,then:function(p){u.push(p)}}}return cS++,a.then(mx,mx),a}function mx(){if(--cS===0&&xp!==null){Pd!==null&&(Pd.status="fulfilled");var r=xp;xp=null,kd=0,Pd=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function EU(r,a){var u=[],p={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return r.then(function(){p.status="fulfilled",p.value=a;for(var _=0;_<u.length;_++)(0,u[_])(a)},function(_){for(p.status="rejected",p.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),p}var yx=G.S;G.S=function(r,a){eR=Re(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&AU(r,a),yx!==null&&yx(r,a)};var xc=H(null);function uS(){var r=xc.current;return r!==null?r:Mt.pooledCache}function f0(r,a){a===null?re(xc,xc.current):re(xc,a.pool)}function vx(){var r=uS();return r===null?null:{parent:fn._currentValue,pool:r}}var Ld=Error(n(460)),dS=Error(n(474)),p0=Error(n(542)),g0={then:function(){}};function bx(r){return r=r.status,r==="fulfilled"||r==="rejected"}function _x(r,a,u){switch(u=r[u],u===void 0?r.push(a):u!==a&&(a.then(yo,yo),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,Ax(r),r;default:if(typeof a.status=="string")a.then(yo,yo);else{if(r=Mt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=a,r.status="pending",r.then(function(p){if(a.status==="pending"){var _=a;_.status="fulfilled",_.value=p}},function(p){if(a.status==="pending"){var _=a;_.status="rejected",_.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,Ax(r),r}throw Ic=a,Ld}}function Rc(r){try{var a=r._init;return a(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Ic=u,Ld):u}}var Ic=null;function Sx(){if(Ic===null)throw Error(n(459));var r=Ic;return Ic=null,r}function Ax(r){if(r===Ld||r===p0)throw Error(n(483))}var Od=null,Rp=0;function m0(r){var a=Rp;return Rp+=1,Od===null&&(Od=[]),_x(Od,r,a)}function Ip(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function y0(r,a){throw a.$$typeof===b?Error(n(525)):(r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function Ex(r){function a(V,z){if(r){var Y=V.deletions;Y===null?(V.deletions=[z],V.flags|=16):Y.push(z)}}function u(V,z){if(!r)return null;for(;z!==null;)a(V,z),z=z.sibling;return null}function p(V){for(var z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function _(V,z){return V=bo(V,z),V.index=0,V.sibling=null,V}function S(V,z,Y){return V.index=Y,r?(Y=V.alternate,Y!==null?(Y=Y.index,Y<z?(V.flags|=67108866,z):Y):(V.flags|=67108866,z)):(V.flags|=1048576,z)}function x(V){return r&&V.alternate===null&&(V.flags|=67108866),V}function D(V,z,Y,ne){return z===null||z.tag!==6?(z=Z_(Y,V.mode,ne),z.return=V,z):(z=_(z,Y),z.return=V,z)}function B(V,z,Y,ne){var xe=Y.type;return xe===C?te(V,z,Y.props.children,ne,Y.key):z!==null&&(z.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===K&&Rc(xe)===z.type)?(z=_(z,Y.props),Ip(z,Y),z.return=V,z):(z=c0(Y.type,Y.key,Y.props,null,V.mode,ne),Ip(z,Y),z.return=V,z)}function X(V,z,Y,ne){return z===null||z.tag!==4||z.stateNode.containerInfo!==Y.containerInfo||z.stateNode.implementation!==Y.implementation?(z=eS(Y,V.mode,ne),z.return=V,z):(z=_(z,Y.children||[]),z.return=V,z)}function te(V,z,Y,ne,xe){return z===null||z.tag!==7?(z=Ec(Y,V.mode,ne,xe),z.return=V,z):(z=_(z,Y),z.return=V,z)}function ie(V,z,Y){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Z_(""+z,V.mode,Y),z.return=V,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case A:return Y=c0(z.type,z.key,z.props,null,V.mode,Y),Ip(Y,z),Y.return=V,Y;case w:return z=eS(z,V.mode,Y),z.return=V,z;case K:return z=Rc(z),ie(V,z,Y)}if(me(z)||se(z))return z=Ec(z,V.mode,Y,null),z.return=V,z;if(typeof z.then=="function")return ie(V,m0(z),Y);if(z.$$typeof===k)return ie(V,h0(V,z),Y);y0(V,z)}return null}function W(V,z,Y,ne){var xe=z!==null?z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return xe!==null?null:D(V,z,""+Y,ne);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return Y.key===xe?B(V,z,Y,ne):null;case w:return Y.key===xe?X(V,z,Y,ne):null;case K:return Y=Rc(Y),W(V,z,Y,ne)}if(me(Y)||se(Y))return xe!==null?null:te(V,z,Y,ne,null);if(typeof Y.then=="function")return W(V,z,m0(Y),ne);if(Y.$$typeof===k)return W(V,z,h0(V,Y),ne);y0(V,Y)}return null}function j(V,z,Y,ne,xe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return V=V.get(Y)||null,D(z,V,""+ne,xe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case A:return V=V.get(ne.key===null?Y:ne.key)||null,B(z,V,ne,xe);case w:return V=V.get(ne.key===null?Y:ne.key)||null,X(z,V,ne,xe);case K:return ne=Rc(ne),j(V,z,Y,ne,xe)}if(me(ne)||se(ne))return V=V.get(Y)||null,te(z,V,ne,xe,null);if(typeof ne.then=="function")return j(V,z,Y,m0(ne),xe);if(ne.$$typeof===k)return j(V,z,Y,h0(z,ne),xe);y0(z,ne)}return null}function Se(V,z,Y,ne){for(var xe=null,lt=null,Te=z,ze=z=0,et=null;Te!==null&&ze<Y.length;ze++){Te.index>ze?(et=Te,Te=null):et=Te.sibling;var ct=W(V,Te,Y[ze],ne);if(ct===null){Te===null&&(Te=et);break}r&&Te&&ct.alternate===null&&a(V,Te),z=S(ct,z,ze),lt===null?xe=ct:lt.sibling=ct,lt=ct,Te=et}if(ze===Y.length)return u(V,Te),nt&&_o(V,ze),xe;if(Te===null){for(;ze<Y.length;ze++)Te=ie(V,Y[ze],ne),Te!==null&&(z=S(Te,z,ze),lt===null?xe=Te:lt.sibling=Te,lt=Te);return nt&&_o(V,ze),xe}for(Te=p(Te);ze<Y.length;ze++)et=j(Te,V,ze,Y[ze],ne),et!==null&&(r&&et.alternate!==null&&Te.delete(et.key===null?ze:et.key),z=S(et,z,ze),lt===null?xe=et:lt.sibling=et,lt=et);return r&&Te.forEach(function(ol){return a(V,ol)}),nt&&_o(V,ze),xe}function Ie(V,z,Y,ne){if(Y==null)throw Error(n(151));for(var xe=null,lt=null,Te=z,ze=z=0,et=null,ct=Y.next();Te!==null&&!ct.done;ze++,ct=Y.next()){Te.index>ze?(et=Te,Te=null):et=Te.sibling;var ol=W(V,Te,ct.value,ne);if(ol===null){Te===null&&(Te=et);break}r&&Te&&ol.alternate===null&&a(V,Te),z=S(ol,z,ze),lt===null?xe=ol:lt.sibling=ol,lt=ol,Te=et}if(ct.done)return u(V,Te),nt&&_o(V,ze),xe;if(Te===null){for(;!ct.done;ze++,ct=Y.next())ct=ie(V,ct.value,ne),ct!==null&&(z=S(ct,z,ze),lt===null?xe=ct:lt.sibling=ct,lt=ct);return nt&&_o(V,ze),xe}for(Te=p(Te);!ct.done;ze++,ct=Y.next())ct=j(Te,V,ze,ct.value,ne),ct!==null&&(r&&ct.alternate!==null&&Te.delete(ct.key===null?ze:ct.key),z=S(ct,z,ze),lt===null?xe=ct:lt.sibling=ct,lt=ct);return r&&Te.forEach(function(PF){return a(V,PF)}),nt&&_o(V,ze),xe}function Et(V,z,Y,ne){if(typeof Y=="object"&&Y!==null&&Y.type===C&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:e:{for(var xe=Y.key;z!==null;){if(z.key===xe){if(xe=Y.type,xe===C){if(z.tag===7){u(V,z.sibling),ne=_(z,Y.props.children),ne.return=V,V=ne;break e}}else if(z.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===K&&Rc(xe)===z.type){u(V,z.sibling),ne=_(z,Y.props),Ip(ne,Y),ne.return=V,V=ne;break e}u(V,z);break}else a(V,z);z=z.sibling}Y.type===C?(ne=Ec(Y.props.children,V.mode,ne,Y.key),ne.return=V,V=ne):(ne=c0(Y.type,Y.key,Y.props,null,V.mode,ne),Ip(ne,Y),ne.return=V,V=ne)}return x(V);case w:e:{for(xe=Y.key;z!==null;){if(z.key===xe)if(z.tag===4&&z.stateNode.containerInfo===Y.containerInfo&&z.stateNode.implementation===Y.implementation){u(V,z.sibling),ne=_(z,Y.children||[]),ne.return=V,V=ne;break e}else{u(V,z);break}else a(V,z);z=z.sibling}ne=eS(Y,V.mode,ne),ne.return=V,V=ne}return x(V);case K:return Y=Rc(Y),Et(V,z,Y,ne)}if(me(Y))return Se(V,z,Y,ne);if(se(Y)){if(xe=se(Y),typeof xe!="function")throw Error(n(150));return Y=xe.call(Y),Ie(V,z,Y,ne)}if(typeof Y.then=="function")return Et(V,z,m0(Y),ne);if(Y.$$typeof===k)return Et(V,z,h0(V,Y),ne);y0(V,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,z!==null&&z.tag===6?(u(V,z.sibling),ne=_(z,Y),ne.return=V,V=ne):(u(V,z),ne=Z_(Y,V.mode,ne),ne.return=V,V=ne),x(V)):u(V,z)}return function(V,z,Y,ne){try{Rp=0;var xe=Et(V,z,Y,ne);return Od=null,xe}catch(Te){if(Te===Ld||Te===p0)throw Te;var lt=Yi(29,Te,null,V.mode);return lt.lanes=ne,lt.return=V,lt}finally{}}}var Nc=Ex(!0),Tx=Ex(!1),Va=!1;function hS(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fS(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function qa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function $a(r,a,u){var p=r.updateQueue;if(p===null)return null;if(p=p.shared,(dt&2)!==0){var _=p.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),p.pending=a,a=l0(r),ax(r,null,u),a}return a0(r,p,a,u),l0(r)}function Np(r,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,gC(r,u)}}function pS(r,a){var u=r.updateQueue,p=r.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var x={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?_=S=x:S=S.next=x,u=u.next}while(u!==null);S===null?_=S=a:S=S.next=a}else _=S=a;u={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=a:r.next=a,u.lastBaseUpdate=a}var gS=!1;function Mp(){if(gS){var r=Pd;if(r!==null)throw r}}function Dp(r,a,u,p){gS=!1;var _=r.updateQueue;Va=!1;var S=_.firstBaseUpdate,x=_.lastBaseUpdate,D=_.shared.pending;if(D!==null){_.shared.pending=null;var B=D,X=B.next;B.next=null,x===null?S=X:x.next=X,x=B;var te=r.alternate;te!==null&&(te=te.updateQueue,D=te.lastBaseUpdate,D!==x&&(D===null?te.firstBaseUpdate=X:D.next=X,te.lastBaseUpdate=B))}if(S!==null){var ie=_.baseState;x=0,te=X=B=null,D=S;do{var W=D.lane&-536870913,j=W!==D.lane;if(j?(Ze&W)===W:(p&W)===W){W!==0&&W===kd&&(gS=!0),te!==null&&(te=te.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Se=r,Ie=D;W=a;var Et=u;switch(Ie.tag){case 1:if(Se=Ie.payload,typeof Se=="function"){ie=Se.call(Et,ie,W);break e}ie=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ie.payload,W=typeof Se=="function"?Se.call(Et,ie,W):Se,W==null)break e;ie=y({},ie,W);break e;case 2:Va=!0}}W=D.callback,W!==null&&(r.flags|=64,j&&(r.flags|=8192),j=_.callbacks,j===null?_.callbacks=[W]:j.push(W))}else j={lane:W,tag:D.tag,payload:D.payload,callback:D.callback,next:null},te===null?(X=te=j,B=ie):te=te.next=j,x|=W;if(D=D.next,D===null){if(D=_.shared.pending,D===null)break;j=D,D=j.next,j.next=null,_.lastBaseUpdate=j,_.shared.pending=null}}while(!0);te===null&&(B=ie),_.baseState=B,_.firstBaseUpdate=X,_.lastBaseUpdate=te,S===null&&(_.shared.lanes=0),Ja|=x,r.lanes=x,r.memoizedState=ie}}function wx(r,a){if(typeof r!="function")throw Error(n(191,r));r.call(a)}function Cx(r,a){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)wx(u[r],a)}var Ud=H(null),v0=H(0);function xx(r,a){r=Mo,re(v0,r),re(Ud,a),Mo=r|a.baseLanes}function mS(){re(v0,Mo),re(Ud,Ud.current)}function yS(){Mo=v0.current,J(Ud),J(v0)}var Xi=H(null),ks=null;function Ya(r){var a=r.alternate;re(an,an.current&1),re(Xi,r),ks===null&&(a===null||Ud.current!==null||a.memoizedState!==null)&&(ks=r)}function vS(r){re(an,an.current),re(Xi,r),ks===null&&(ks=r)}function Rx(r){r.tag===22?(re(an,an.current),re(Xi,r),ks===null&&(ks=r)):Xa()}function Xa(){re(an,an.current),re(Xi,Xi.current)}function Wi(r){J(Xi),ks===r&&(ks=null),J(an)}var an=H(0);function b0(r){for(var a=r;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||TA(u)||wA(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Eo=0,Be=null,St=null,pn=null,_0=!1,Fd=!1,Mc=!1,S0=0,kp=0,Bd=null,TU=0;function Zt(){throw Error(n(321))}function bS(r,a){if(a===null)return!1;for(var u=0;u<a.length&&u<r.length;u++)if(!$i(r[u],a[u]))return!1;return!0}function _S(r,a,u,p,_,S){return Eo=S,Be=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,G.H=r===null||r.memoizedState===null?d1:LS,Mc=!1,S=u(p,_),Mc=!1,Fd&&(S=Nx(a,u,p,_)),Ix(r),S}function Ix(r){G.H=Op;var a=St!==null&&St.next!==null;if(Eo=0,pn=St=Be=null,_0=!1,kp=0,Bd=null,a)throw Error(n(300));r===null||gn||(r=r.dependencies,r!==null&&d0(r)&&(gn=!0))}function Nx(r,a,u,p){Be=r;var _=0;do{if(Fd&&(Bd=null),kp=0,Fd=!1,25<=_)throw Error(n(301));if(_+=1,pn=St=null,r.updateQueue!=null){var S=r.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}G.H=h1,S=a(u,p)}while(Fd);return S}function wU(){var r=G.H,a=r.useState()[0];return a=typeof a.then=="function"?Pp(a):a,r=r.useState()[0],(St!==null?St.memoizedState:null)!==r&&(Be.flags|=1024),a}function SS(){var r=S0!==0;return S0=0,r}function AS(r,a,u){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~u}function ES(r){if(_0){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}_0=!1}Eo=0,pn=St=Be=null,Fd=!1,kp=S0=0,Bd=null}function hi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Be.memoizedState=pn=r:pn=pn.next=r,pn}function ln(){if(St===null){var r=Be.alternate;r=r!==null?r.memoizedState:null}else r=St.next;var a=pn===null?Be.memoizedState:pn.next;if(a!==null)pn=a,St=r;else{if(r===null)throw Be.alternate===null?Error(n(467)):Error(n(310));St=r,r={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},pn===null?Be.memoizedState=pn=r:pn=pn.next=r}return pn}function A0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pp(r){var a=kp;return kp+=1,Bd===null&&(Bd=[]),r=_x(Bd,r,a),a=Be,(pn===null?a.memoizedState:pn.next)===null&&(a=a.alternate,G.H=a===null||a.memoizedState===null?d1:LS),r}function E0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Pp(r);if(r.$$typeof===k)return Hn(r)}throw Error(n(438,String(r)))}function TS(r){var a=null,u=Be.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var p=Be.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(_){return _.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=A0(),Be.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(r),p=0;p<r;p++)u[p]=Q;return a.index++,u}function To(r,a){return typeof a=="function"?a(r):a}function T0(r){var a=ln();return wS(a,St,r)}function wS(r,a,u){var p=r.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=u;var _=r.baseQueue,S=p.pending;if(S!==null){if(_!==null){var x=_.next;_.next=S.next,S.next=x}a.baseQueue=_=S,p.pending=null}if(S=r.baseState,_===null)r.memoizedState=S;else{a=_.next;var D=x=null,B=null,X=a,te=!1;do{var ie=X.lane&-536870913;if(ie!==X.lane?(Ze&ie)===ie:(Eo&ie)===ie){var W=X.revertLane;if(W===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),ie===kd&&(te=!0);else if((Eo&W)===W){X=X.next,W===kd&&(te=!0);continue}else ie={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(D=B=ie,x=S):B=B.next=ie,Be.lanes|=W,Ja|=W;ie=X.action,Mc&&u(S,ie),S=X.hasEagerState?X.eagerState:u(S,ie)}else W={lane:ie,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(D=B=W,x=S):B=B.next=W,Be.lanes|=ie,Ja|=ie;X=X.next}while(X!==null&&X!==a);if(B===null?x=S:B.next=D,!$i(S,r.memoizedState)&&(gn=!0,te&&(u=Pd,u!==null)))throw u;r.memoizedState=S,r.baseState=x,r.baseQueue=B,p.lastRenderedState=S}return _===null&&(p.lanes=0),[r.memoizedState,p.dispatch]}function CS(r){var a=ln(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var p=u.dispatch,_=u.pending,S=a.memoizedState;if(_!==null){u.pending=null;var x=_=_.next;do S=r(S,x.action),x=x.next;while(x!==_);$i(S,a.memoizedState)||(gn=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),u.lastRenderedState=S}return[S,p]}function Mx(r,a,u){var p=Be,_=ln(),S=nt;if(S){if(u===void 0)throw Error(n(407));u=u()}else u=a();var x=!$i((St||_).memoizedState,u);if(x&&(_.memoizedState=u,gn=!0),_=_.queue,IS(Px.bind(null,p,_,r),[r]),_.getSnapshot!==a||x||pn!==null&&pn.memoizedState.tag&1){if(p.flags|=2048,Hd(9,{destroy:void 0},kx.bind(null,p,_,u,a),null),Mt===null)throw Error(n(349));S||(Eo&127)!==0||Dx(p,a,u)}return u}function Dx(r,a,u){r.flags|=16384,r={getSnapshot:a,value:u},a=Be.updateQueue,a===null?(a=A0(),Be.updateQueue=a,a.stores=[r]):(u=a.stores,u===null?a.stores=[r]:u.push(r))}function kx(r,a,u,p){a.value=u,a.getSnapshot=p,Lx(a)&&Ox(r)}function Px(r,a,u){return u(function(){Lx(a)&&Ox(r)})}function Lx(r){var a=r.getSnapshot;r=r.value;try{var u=a();return!$i(r,u)}catch{return!0}}function Ox(r){var a=Ac(r,2);a!==null&&Di(a,r,2)}function xS(r){var a=hi();if(typeof r=="function"){var u=r;if(r=u(),Mc){tr(!0);try{u()}finally{tr(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:r},a}function Ux(r,a,u,p){return r.baseState=u,wS(r,St,typeof p=="function"?p:To)}function CU(r,a,u,p,_){if(x0(r))throw Error(n(485));if(r=a.action,r!==null){var S={payload:_,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){S.listeners.push(x)}};G.T!==null?u(!0):S.isTransition=!1,p(S),u=a.pending,u===null?(S.next=a.pending=S,Fx(a,S)):(S.next=u.next,a.pending=u.next=S)}}function Fx(r,a){var u=a.action,p=a.payload,_=r.state;if(a.isTransition){var S=G.T,x={};G.T=x;try{var D=u(_,p),B=G.S;B!==null&&B(x,D),Bx(r,a,D)}catch(X){RS(r,a,X)}finally{S!==null&&x.types!==null&&(S.types=x.types),G.T=S}}else try{S=u(_,p),Bx(r,a,S)}catch(X){RS(r,a,X)}}function Bx(r,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){Hx(r,a,p)},function(p){return RS(r,a,p)}):Hx(r,a,u)}function Hx(r,a,u){a.status="fulfilled",a.value=u,Gx(a),r.state=u,a=r.pending,a!==null&&(u=a.next,u===a?r.pending=null:(u=u.next,a.next=u,Fx(r,u)))}function RS(r,a,u){var p=r.pending;if(r.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=u,Gx(a),a=a.next;while(a!==p)}r.action=null}function Gx(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function zx(r,a){return a}function Vx(r,a){if(nt){var u=Mt.formState;if(u!==null){e:{var p=Be;if(nt){if(Gt){t:{for(var _=Gt,S=Ds;_.nodeType!==8;){if(!S){_=null;break t}if(_=Ps(_.nextSibling),_===null){_=null;break t}}S=_.data,_=S==="F!"||S==="F"?_:null}if(_){Gt=Ps(_.nextSibling),p=_.data==="F!";break e}}Ga(p)}p=!1}p&&(a=u[0])}}return u=hi(),u.memoizedState=u.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zx,lastRenderedState:a},u.queue=p,u=l1.bind(null,Be,p),p.dispatch=u,p=xS(!1),S=PS.bind(null,Be,!1,p.queue),p=hi(),_={state:a,dispatch:null,action:r,pending:null},p.queue=_,u=CU.bind(null,Be,_,S,u),_.dispatch=u,p.memoizedState=r,[a,u,!1]}function qx(r){var a=ln();return $x(a,St,r)}function $x(r,a,u){if(a=wS(r,a,zx)[0],r=T0(To)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=Pp(a)}catch(x){throw x===Ld?p0:x}else p=a;a=ln();var _=a.queue,S=_.dispatch;return u!==a.memoizedState&&(Be.flags|=2048,Hd(9,{destroy:void 0},xU.bind(null,_,u),null)),[p,S,r]}function xU(r,a){r.action=a}function Yx(r){var a=ln(),u=St;if(u!==null)return $x(a,u,r);ln(),a=a.memoizedState,u=ln();var p=u.queue.dispatch;return u.memoizedState=r,[a,p,!1]}function Hd(r,a,u,p){return r={tag:r,create:u,deps:p,inst:a,next:null},a=Be.updateQueue,a===null&&(a=A0(),Be.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=r.next=r:(p=u.next,u.next=r,r.next=p,a.lastEffect=r),r}function Xx(){return ln().memoizedState}function w0(r,a,u,p){var _=hi();Be.flags|=r,_.memoizedState=Hd(1|a,{destroy:void 0},u,p===void 0?null:p)}function C0(r,a,u,p){var _=ln();p=p===void 0?null:p;var S=_.memoizedState.inst;St!==null&&p!==null&&bS(p,St.memoizedState.deps)?_.memoizedState=Hd(a,S,u,p):(Be.flags|=r,_.memoizedState=Hd(1|a,S,u,p))}function Wx(r,a){w0(8390656,8,r,a)}function IS(r,a){C0(2048,8,r,a)}function RU(r){Be.flags|=4;var a=Be.updateQueue;if(a===null)a=A0(),Be.updateQueue=a,a.events=[r];else{var u=a.events;u===null?a.events=[r]:u.push(r)}}function Kx(r){var a=ln().memoizedState;return RU({ref:a,nextImpl:r}),function(){if((dt&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Jx(r,a){return C0(4,2,r,a)}function jx(r,a){return C0(4,4,r,a)}function Qx(r,a){if(typeof a=="function"){r=r();var u=a(r);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function Zx(r,a,u){u=u!=null?u.concat([r]):null,C0(4,4,Qx.bind(null,a,r),u)}function NS(){}function e1(r,a){var u=ln();a=a===void 0?null:a;var p=u.memoizedState;return a!==null&&bS(a,p[1])?p[0]:(u.memoizedState=[r,a],r)}function t1(r,a){var u=ln();a=a===void 0?null:a;var p=u.memoizedState;if(a!==null&&bS(a,p[1]))return p[0];if(p=r(),Mc){tr(!0);try{r()}finally{tr(!1)}}return u.memoizedState=[p,a],p}function MS(r,a,u){return u===void 0||(Eo&1073741824)!==0&&(Ze&261930)===0?r.memoizedState=a:(r.memoizedState=u,r=nR(),Be.lanes|=r,Ja|=r,u)}function n1(r,a,u,p){return $i(u,a)?u:Ud.current!==null?(r=MS(r,u,p),$i(r,a)||(gn=!0),r):(Eo&42)===0||(Eo&1073741824)!==0&&(Ze&261930)===0?(gn=!0,r.memoizedState=u):(r=nR(),Be.lanes|=r,Ja|=r,a)}function i1(r,a,u,p,_){var S=$.p;$.p=S!==0&&8>S?S:8;var x=G.T,D={};G.T=D,PS(r,!1,a,u);try{var B=_(),X=G.S;if(X!==null&&X(D,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var te=EU(B,p);Lp(r,a,te,ji(r))}else Lp(r,a,p,ji(r))}catch(ie){Lp(r,a,{then:function(){},status:"rejected",reason:ie},ji())}finally{$.p=S,x!==null&&D.types!==null&&(x.types=D.types),G.T=x}}function IU(){}function DS(r,a,u,p){if(r.tag!==5)throw Error(n(476));var _=s1(r).queue;i1(r,_,a,oe,u===null?IU:function(){return r1(r),u(p)})}function s1(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:oe},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:u},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function r1(r){var a=s1(r);a.next===null&&(a=r.alternate.memoizedState),Lp(r,a.next.queue,{},ji())}function kS(){return Hn(Qp)}function o1(){return ln().memoizedState}function a1(){return ln().memoizedState}function NU(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var u=ji();r=qa(u);var p=$a(a,r,u);p!==null&&(Di(p,a,u),Np(p,a,u)),a={cache:lS()},r.payload=a;return}a=a.return}}function MU(r,a,u){var p=ji();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},x0(r)?c1(a,u):(u=j_(r,a,u,p),u!==null&&(Di(u,r,p),u1(u,a,p)))}function l1(r,a,u){var p=ji();Lp(r,a,u,p)}function Lp(r,a,u,p){var _={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(x0(r))c1(a,_);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var x=a.lastRenderedState,D=S(x,u);if(_.hasEagerState=!0,_.eagerState=D,$i(D,x))return a0(r,a,_,0),Mt===null&&o0(),!1}catch{}finally{}if(u=j_(r,a,_,p),u!==null)return Di(u,r,p),u1(u,a,p),!0}return!1}function PS(r,a,u,p){if(p={lane:2,revertLane:hA(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},x0(r)){if(a)throw Error(n(479))}else a=j_(r,u,p,2),a!==null&&Di(a,r,2)}function x0(r){var a=r.alternate;return r===Be||a!==null&&a===Be}function c1(r,a){Fd=_0=!0;var u=r.pending;u===null?a.next=a:(a.next=u.next,u.next=a),r.pending=a}function u1(r,a,u){if((u&4194048)!==0){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,gC(r,u)}}var Op={readContext:Hn,use:E0,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt};Op.useEffectEvent=Zt;var d1={readContext:Hn,use:E0,useCallback:function(r,a){return hi().memoizedState=[r,a===void 0?null:a],r},useContext:Hn,useEffect:Wx,useImperativeHandle:function(r,a,u){u=u!=null?u.concat([r]):null,w0(4194308,4,Qx.bind(null,a,r),u)},useLayoutEffect:function(r,a){return w0(4194308,4,r,a)},useInsertionEffect:function(r,a){w0(4,2,r,a)},useMemo:function(r,a){var u=hi();a=a===void 0?null:a;var p=r();if(Mc){tr(!0);try{r()}finally{tr(!1)}}return u.memoizedState=[p,a],p},useReducer:function(r,a,u){var p=hi();if(u!==void 0){var _=u(a);if(Mc){tr(!0);try{u(a)}finally{tr(!1)}}}else _=a;return p.memoizedState=p.baseState=_,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:_},p.queue=r,r=r.dispatch=MU.bind(null,Be,r),[p.memoizedState,r]},useRef:function(r){var a=hi();return r={current:r},a.memoizedState=r},useState:function(r){r=xS(r);var a=r.queue,u=l1.bind(null,Be,a);return a.dispatch=u,[r.memoizedState,u]},useDebugValue:NS,useDeferredValue:function(r,a){var u=hi();return MS(u,r,a)},useTransition:function(){var r=xS(!1);return r=i1.bind(null,Be,r.queue,!0,!1),hi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,u){var p=Be,_=hi();if(nt){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),Mt===null)throw Error(n(349));(Ze&127)!==0||Dx(p,a,u)}_.memoizedState=u;var S={value:u,getSnapshot:a};return _.queue=S,Wx(Px.bind(null,p,S,r),[r]),p.flags|=2048,Hd(9,{destroy:void 0},kx.bind(null,p,S,u,a),null),u},useId:function(){var r=hi(),a=Mt.identifierPrefix;if(nt){var u=Nr,p=Ir;u=(p&~(1<<32-Zn(p)-1)).toString(32)+u,a="_"+a+"R_"+u,u=S0++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=TU++,a="_"+a+"r_"+u.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:kS,useFormState:Vx,useActionState:Vx,useOptimistic:function(r){var a=hi();a.memoizedState=a.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=PS.bind(null,Be,!0,u),u.dispatch=a,[r,a]},useMemoCache:TS,useCacheRefresh:function(){return hi().memoizedState=NU.bind(null,Be)},useEffectEvent:function(r){var a=hi(),u={impl:r};return a.memoizedState=u,function(){if((dt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},LS={readContext:Hn,use:E0,useCallback:e1,useContext:Hn,useEffect:IS,useImperativeHandle:Zx,useInsertionEffect:Jx,useLayoutEffect:jx,useMemo:t1,useReducer:T0,useRef:Xx,useState:function(){return T0(To)},useDebugValue:NS,useDeferredValue:function(r,a){var u=ln();return n1(u,St.memoizedState,r,a)},useTransition:function(){var r=T0(To)[0],a=ln().memoizedState;return[typeof r=="boolean"?r:Pp(r),a]},useSyncExternalStore:Mx,useId:o1,useHostTransitionStatus:kS,useFormState:qx,useActionState:qx,useOptimistic:function(r,a){var u=ln();return Ux(u,St,r,a)},useMemoCache:TS,useCacheRefresh:a1};LS.useEffectEvent=Kx;var h1={readContext:Hn,use:E0,useCallback:e1,useContext:Hn,useEffect:IS,useImperativeHandle:Zx,useInsertionEffect:Jx,useLayoutEffect:jx,useMemo:t1,useReducer:CS,useRef:Xx,useState:function(){return CS(To)},useDebugValue:NS,useDeferredValue:function(r,a){var u=ln();return St===null?MS(u,r,a):n1(u,St.memoizedState,r,a)},useTransition:function(){var r=CS(To)[0],a=ln().memoizedState;return[typeof r=="boolean"?r:Pp(r),a]},useSyncExternalStore:Mx,useId:o1,useHostTransitionStatus:kS,useFormState:Yx,useActionState:Yx,useOptimistic:function(r,a){var u=ln();return St!==null?Ux(u,St,r,a):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:TS,useCacheRefresh:a1};h1.useEffectEvent=Kx;function OS(r,a,u,p){a=r.memoizedState,u=u(p,a),u=u==null?a:y({},a,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var US={enqueueSetState:function(r,a,u){r=r._reactInternals;var p=ji(),_=qa(p);_.payload=a,u!=null&&(_.callback=u),a=$a(r,_,p),a!==null&&(Di(a,r,p),Np(a,r,p))},enqueueReplaceState:function(r,a,u){r=r._reactInternals;var p=ji(),_=qa(p);_.tag=1,_.payload=a,u!=null&&(_.callback=u),a=$a(r,_,p),a!==null&&(Di(a,r,p),Np(a,r,p))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var u=ji(),p=qa(u);p.tag=2,a!=null&&(p.callback=a),a=$a(r,p,u),a!==null&&(Di(a,r,u),Np(a,r,u))}};function f1(r,a,u,p,_,S,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(p,S,x):a.prototype&&a.prototype.isPureReactComponent?!Ap(u,p)||!Ap(_,S):!0}function p1(r,a,u,p){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,p),a.state!==r&&US.enqueueReplaceState(a,a.state,null)}function Dc(r,a){var u=a;if("ref"in a){u={};for(var p in a)p!=="ref"&&(u[p]=a[p])}if(r=r.defaultProps){u===a&&(u=y({},u));for(var _ in r)u[_]===void 0&&(u[_]=r[_])}return u}function g1(r){r0(r)}function m1(r){console.error(r)}function y1(r){r0(r)}function R0(r,a){try{var u=r.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function v1(r,a,u){try{var p=r.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function FS(r,a,u){return u=qa(u),u.tag=3,u.payload={element:null},u.callback=function(){R0(r,a)},u}function b1(r){return r=qa(r),r.tag=3,r}function _1(r,a,u,p){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var S=p.value;r.payload=function(){return _(S)},r.callback=function(){v1(a,u,p)}}var x=u.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(r.callback=function(){v1(a,u,p),typeof _!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var D=p.stack;this.componentDidCatch(p.value,{componentStack:D!==null?D:""})})}function DU(r,a,u,p,_){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=u.alternate,a!==null&&Dd(a,u,_,!0),u=Xi.current,u!==null){switch(u.tag){case 31:case 13:return ks===null?H0():u.alternate===null&&en===0&&(en=3),u.flags&=-257,u.flags|=65536,u.lanes=_,p===g0?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([p]):a.add(p),cA(r,p,_)),!1;case 22:return u.flags|=65536,p===g0?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([p]):u.add(p)),cA(r,p,_)),!1}throw Error(n(435,u.tag))}return cA(r,p,_),H0(),!1}if(nt)return a=Xi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=_,p!==iS&&(r=Error(n(422),{cause:p}),wp(Is(r,u)))):(p!==iS&&(a=Error(n(423),{cause:p}),wp(Is(a,u))),r=r.current.alternate,r.flags|=65536,_&=-_,r.lanes|=_,p=Is(p,u),_=FS(r.stateNode,p,_),pS(r,_),en!==4&&(en=2)),!1;var S=Error(n(520),{cause:p});if(S=Is(S,u),qp===null?qp=[S]:qp.push(S),en!==4&&(en=2),a===null)return!0;p=Is(p,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,r=_&-_,u.lanes|=r,r=FS(u.stateNode,p,r),pS(u,r),!1;case 1:if(a=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ja===null||!ja.has(S))))return u.flags|=65536,_&=-_,u.lanes|=_,_=b1(_),_1(_,r,u,p),pS(u,_),!1}u=u.return}while(u!==null);return!1}var BS=Error(n(461)),gn=!1;function Gn(r,a,u,p){a.child=r===null?Tx(a,null,u,p):Nc(a,r.child,u,p)}function S1(r,a,u,p,_){u=u.render;var S=a.ref;if("ref"in p){var x={};for(var D in p)D!=="ref"&&(x[D]=p[D])}else x=p;return Cc(a),p=_S(r,a,u,x,S,_),D=SS(),r!==null&&!gn?(AS(r,a,_),wo(r,a,_)):(nt&&D&&tS(a),a.flags|=1,Gn(r,a,p,_),a.child)}function A1(r,a,u,p,_){if(r===null){var S=u.type;return typeof S=="function"&&!Q_(S)&&S.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=S,E1(r,a,S,p,_)):(r=c0(u.type,null,p,a,a.mode,_),r.ref=a.ref,r.return=a,a.child=r)}if(S=r.child,!XS(r,_)){var x=S.memoizedProps;if(u=u.compare,u=u!==null?u:Ap,u(x,p)&&r.ref===a.ref)return wo(r,a,_)}return a.flags|=1,r=bo(S,p),r.ref=a.ref,r.return=a,a.child=r}function E1(r,a,u,p,_){if(r!==null){var S=r.memoizedProps;if(Ap(S,p)&&r.ref===a.ref)if(gn=!1,a.pendingProps=p=S,XS(r,_))(r.flags&131072)!==0&&(gn=!0);else return a.lanes=r.lanes,wo(r,a,_)}return HS(r,a,u,p,_)}function T1(r,a,u,p){var _=p.children,S=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(S=S!==null?S.baseLanes|u:u,r!==null){for(p=a.child=r.child,_=0;p!==null;)_=_|p.lanes|p.childLanes,p=p.sibling;p=_&~S}else p=0,a.child=null;return w1(r,a,S,u,p)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&f0(a,S!==null?S.cachePool:null),S!==null?xx(a,S):mS(),Rx(a);else return p=a.lanes=536870912,w1(r,a,S!==null?S.baseLanes|u:u,u,p)}else S!==null?(f0(a,S.cachePool),xx(a,S),Xa(),a.memoizedState=null):(r!==null&&f0(a,null),mS(),Xa());return Gn(r,a,_,u),a.child}function Up(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function w1(r,a,u,p,_){var S=uS();return S=S===null?null:{parent:fn._currentValue,pool:S},a.memoizedState={baseLanes:u,cachePool:S},r!==null&&f0(a,null),mS(),Rx(a),r!==null&&Dd(r,a,p,!0),a.childLanes=_,null}function I0(r,a){return a=M0({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function C1(r,a,u){return Nc(a,r.child,null,u),r=I0(a,a.pendingProps),r.flags|=2,Wi(a),a.memoizedState=null,r}function kU(r,a,u){var p=a.pendingProps,_=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(nt){if(p.mode==="hidden")return r=I0(a,p),a.lanes=536870912,Up(null,r);if(vS(a),(r=Gt)?(r=FR(r,Ds),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:Ba!==null?{id:Ir,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},u=cx(r),u.return=a,a.child=u,Bn=a,Gt=null)):r=null,r===null)throw Ga(a);return a.lanes=536870912,null}return I0(a,p)}var S=r.memoizedState;if(S!==null){var x=S.dehydrated;if(vS(a),_)if(a.flags&256)a.flags&=-257,a=C1(r,a,u);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(n(558));else if(gn||Dd(r,a,u,!1),_=(u&r.childLanes)!==0,gn||_){if(p=Mt,p!==null&&(x=mC(p,u),x!==0&&x!==S.retryLane))throw S.retryLane=x,Ac(r,x),Di(p,r,x),BS;H0(),a=C1(r,a,u)}else r=S.treeContext,Gt=Ps(x.nextSibling),Bn=a,nt=!0,Ha=null,Ds=!1,r!==null&&hx(a,r),a=I0(a,p),a.flags|=4096;return a}return r=bo(r.child,{mode:p.mode,children:p.children}),r.ref=a.ref,a.child=r,r.return=a,r}function N0(r,a){var u=a.ref;if(u===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(a.flags|=4194816)}}function HS(r,a,u,p,_){return Cc(a),u=_S(r,a,u,p,void 0,_),p=SS(),r!==null&&!gn?(AS(r,a,_),wo(r,a,_)):(nt&&p&&tS(a),a.flags|=1,Gn(r,a,u,_),a.child)}function x1(r,a,u,p,_,S){return Cc(a),a.updateQueue=null,u=Nx(a,p,u,_),Ix(r),p=SS(),r!==null&&!gn?(AS(r,a,S),wo(r,a,S)):(nt&&p&&tS(a),a.flags|=1,Gn(r,a,u,S),a.child)}function R1(r,a,u,p,_){if(Cc(a),a.stateNode===null){var S=Rd,x=u.contextType;typeof x=="object"&&x!==null&&(S=Hn(x)),S=new u(p,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=US,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=p,S.state=a.memoizedState,S.refs={},hS(a),x=u.contextType,S.context=typeof x=="object"&&x!==null?Hn(x):Rd,S.state=a.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(OS(a,u,x,p),S.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(x=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),x!==S.state&&US.enqueueReplaceState(S,S.state,null),Dp(a,p,S,_),Mp(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(r===null){S=a.stateNode;var D=a.memoizedProps,B=Dc(u,D);S.props=B;var X=S.context,te=u.contextType;x=Rd,typeof te=="object"&&te!==null&&(x=Hn(te));var ie=u.getDerivedStateFromProps;te=typeof ie=="function"||typeof S.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,te||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D||X!==x)&&p1(a,S,p,x),Va=!1;var W=a.memoizedState;S.state=W,Dp(a,p,S,_),Mp(),X=a.memoizedState,D||W!==X||Va?(typeof ie=="function"&&(OS(a,u,ie,p),X=a.memoizedState),(B=Va||f1(a,u,B,p,W,X,x))?(te||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=X),S.props=p,S.state=X,S.context=x,p=B):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{S=a.stateNode,fS(r,a),x=a.memoizedProps,te=Dc(u,x),S.props=te,ie=a.pendingProps,W=S.context,X=u.contextType,B=Rd,typeof X=="object"&&X!==null&&(B=Hn(X)),D=u.getDerivedStateFromProps,(X=typeof D=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(x!==ie||W!==B)&&p1(a,S,p,B),Va=!1,W=a.memoizedState,S.state=W,Dp(a,p,S,_),Mp();var j=a.memoizedState;x!==ie||W!==j||Va||r!==null&&r.dependencies!==null&&d0(r.dependencies)?(typeof D=="function"&&(OS(a,u,D,p),j=a.memoizedState),(te=Va||f1(a,u,te,p,W,j,B)||r!==null&&r.dependencies!==null&&d0(r.dependencies))?(X||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,j,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,j,B)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=j),S.props=p,S.state=j,S.context=B,p=te):(typeof S.componentDidUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),p=!1)}return S=p,N0(r,a),p=(a.flags&128)!==0,S||p?(S=a.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,r!==null&&p?(a.child=Nc(a,r.child,null,_),a.child=Nc(a,null,u,_)):Gn(r,a,u,_),a.memoizedState=S.state,r=a.child):r=wo(r,a,_),r}function I1(r,a,u,p){return Tc(),a.flags|=256,Gn(r,a,u,p),a.child}var GS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zS(r){return{baseLanes:r,cachePool:vx()}}function VS(r,a,u){return r=r!==null?r.childLanes&~u:0,a&&(r|=Ji),r}function N1(r,a,u){var p=a.pendingProps,_=!1,S=(a.flags&128)!==0,x;if((x=S)||(x=r!==null&&r.memoizedState===null?!1:(an.current&2)!==0),x&&(_=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,r===null){if(nt){if(_?Ya(a):Xa(),(r=Gt)?(r=FR(r,Ds),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:Ba!==null?{id:Ir,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},u=cx(r),u.return=a,a.child=u,Bn=a,Gt=null)):r=null,r===null)throw Ga(a);return wA(r)?a.lanes=32:a.lanes=536870912,null}var D=p.children;return p=p.fallback,_?(Xa(),_=a.mode,D=M0({mode:"hidden",children:D},_),p=Ec(p,_,u,null),D.return=a,p.return=a,D.sibling=p,a.child=D,p=a.child,p.memoizedState=zS(u),p.childLanes=VS(r,x,u),a.memoizedState=GS,Up(null,p)):(Ya(a),qS(a,D))}var B=r.memoizedState;if(B!==null&&(D=B.dehydrated,D!==null)){if(S)a.flags&256?(Ya(a),a.flags&=-257,a=$S(r,a,u)):a.memoizedState!==null?(Xa(),a.child=r.child,a.flags|=128,a=null):(Xa(),D=p.fallback,_=a.mode,p=M0({mode:"visible",children:p.children},_),D=Ec(D,_,u,null),D.flags|=2,p.return=a,D.return=a,p.sibling=D,a.child=p,Nc(a,r.child,null,u),p=a.child,p.memoizedState=zS(u),p.childLanes=VS(r,x,u),a.memoizedState=GS,a=Up(null,p));else if(Ya(a),wA(D)){if(x=D.nextSibling&&D.nextSibling.dataset,x)var X=x.dgst;x=X,p=Error(n(419)),p.stack="",p.digest=x,wp({value:p,source:null,stack:null}),a=$S(r,a,u)}else if(gn||Dd(r,a,u,!1),x=(u&r.childLanes)!==0,gn||x){if(x=Mt,x!==null&&(p=mC(x,u),p!==0&&p!==B.retryLane))throw B.retryLane=p,Ac(r,p),Di(x,r,p),BS;TA(D)||H0(),a=$S(r,a,u)}else TA(D)?(a.flags|=192,a.child=r.child,a=null):(r=B.treeContext,Gt=Ps(D.nextSibling),Bn=a,nt=!0,Ha=null,Ds=!1,r!==null&&hx(a,r),a=qS(a,p.children),a.flags|=4096);return a}return _?(Xa(),D=p.fallback,_=a.mode,B=r.child,X=B.sibling,p=bo(B,{mode:"hidden",children:p.children}),p.subtreeFlags=B.subtreeFlags&65011712,X!==null?D=bo(X,D):(D=Ec(D,_,u,null),D.flags|=2),D.return=a,p.return=a,p.sibling=D,a.child=p,Up(null,p),p=a.child,D=r.child.memoizedState,D===null?D=zS(u):(_=D.cachePool,_!==null?(B=fn._currentValue,_=_.parent!==B?{parent:B,pool:B}:_):_=vx(),D={baseLanes:D.baseLanes|u,cachePool:_}),p.memoizedState=D,p.childLanes=VS(r,x,u),a.memoizedState=GS,Up(r.child,p)):(Ya(a),u=r.child,r=u.sibling,u=bo(u,{mode:"visible",children:p.children}),u.return=a,u.sibling=null,r!==null&&(x=a.deletions,x===null?(a.deletions=[r],a.flags|=16):x.push(r)),a.child=u,a.memoizedState=null,u)}function qS(r,a){return a=M0({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function M0(r,a){return r=Yi(22,r,null,a),r.lanes=0,r}function $S(r,a,u){return Nc(a,r.child,null,u),r=qS(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function M1(r,a,u){r.lanes|=a;var p=r.alternate;p!==null&&(p.lanes|=a),oS(r.return,a,u)}function YS(r,a,u,p,_,S){var x=r.memoizedState;x===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:_,treeForkCount:S}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=u,x.tailMode=_,x.treeForkCount=S)}function D1(r,a,u){var p=a.pendingProps,_=p.revealOrder,S=p.tail;p=p.children;var x=an.current,D=(x&2)!==0;if(D?(x=x&1|2,a.flags|=128):x&=1,re(an,x),Gn(r,a,p,u),p=nt?Tp:0,!D&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&M1(r,u,a);else if(r.tag===19)M1(r,u,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(_){case"forwards":for(u=a.child,_=null;u!==null;)r=u.alternate,r!==null&&b0(r)===null&&(_=u),u=u.sibling;u=_,u===null?(_=a.child,a.child=null):(_=u.sibling,u.sibling=null),YS(a,!1,_,u,S,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,_=a.child,a.child=null;_!==null;){if(r=_.alternate,r!==null&&b0(r)===null){a.child=_;break}r=_.sibling,_.sibling=u,u=_,_=r}YS(a,!0,u,null,S,p);break;case"together":YS(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function wo(r,a,u){if(r!==null&&(a.dependencies=r.dependencies),Ja|=a.lanes,(u&a.childLanes)===0)if(r!==null){if(Dd(r,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,u=bo(r,r.pendingProps),a.child=u,u.return=a;r.sibling!==null;)r=r.sibling,u=u.sibling=bo(r,r.pendingProps),u.return=a;u.sibling=null}return a.child}function XS(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&d0(r)))}function PU(r,a,u){switch(a.tag){case 3:st(a,a.stateNode.containerInfo),za(a,fn,r.memoizedState.cache),Tc();break;case 27:case 5:It(a);break;case 4:st(a,a.stateNode.containerInfo);break;case 10:za(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,vS(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(Ya(a),a.flags|=128,null):(u&a.child.childLanes)!==0?N1(r,a,u):(Ya(a),r=wo(r,a,u),r!==null?r.sibling:null);Ya(a);break;case 19:var _=(r.flags&128)!==0;if(p=(u&a.childLanes)!==0,p||(Dd(r,a,u,!1),p=(u&a.childLanes)!==0),_){if(p)return D1(r,a,u);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),re(an,an.current),p)break;return null;case 22:return a.lanes=0,T1(r,a,u,a.pendingProps);case 24:za(a,fn,r.memoizedState.cache)}return wo(r,a,u)}function k1(r,a,u){if(r!==null)if(r.memoizedProps!==a.pendingProps)gn=!0;else{if(!XS(r,u)&&(a.flags&128)===0)return gn=!1,PU(r,a,u);gn=(r.flags&131072)!==0}else gn=!1,nt&&(a.flags&1048576)!==0&&dx(a,Tp,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(r=Rc(a.elementType),a.type=r,typeof r=="function")Q_(r)?(p=Dc(r,p),a.tag=1,a=R1(null,a,r,p,u)):(a.tag=0,a=HS(null,a,r,p,u));else{if(r!=null){var _=r.$$typeof;if(_===L){a.tag=11,a=S1(null,a,r,p,u);break e}else if(_===F){a.tag=14,a=A1(null,a,r,p,u);break e}}throw a=ue(r)||r,Error(n(306,a,""))}}return a;case 0:return HS(r,a,a.type,a.pendingProps,u);case 1:return p=a.type,_=Dc(p,a.pendingProps),R1(r,a,p,_,u);case 3:e:{if(st(a,a.stateNode.containerInfo),r===null)throw Error(n(387));p=a.pendingProps;var S=a.memoizedState;_=S.element,fS(r,a),Dp(a,p,null,u);var x=a.memoizedState;if(p=x.cache,za(a,fn,p),p!==S.cache&&aS(a,[fn],u,!0),Mp(),p=x.element,S.isDehydrated)if(S={element:p,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=I1(r,a,p,u);break e}else if(p!==_){_=Is(Error(n(424)),a),wp(_),a=I1(r,a,p,u);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Gt=Ps(r.firstChild),Bn=a,nt=!0,Ha=null,Ds=!0,u=Tx(a,null,p,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Tc(),p===_){a=wo(r,a,u);break e}Gn(r,a,p,u)}a=a.child}return a;case 26:return N0(r,a),r===null?(u=qR(a.type,null,a.pendingProps,null))?a.memoizedState=u:nt||(u=a.type,r=a.pendingProps,p=X0(Ce.current).createElement(u),p[Fn]=a,p[Ci]=r,zn(p,u,r),xn(p),a.stateNode=p):a.memoizedState=qR(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return It(a),r===null&&nt&&(p=a.stateNode=GR(a.type,a.pendingProps,Ce.current),Bn=a,Ds=!0,_=Gt,tl(a.type)?(CA=_,Gt=Ps(p.firstChild)):Gt=_),Gn(r,a,a.pendingProps.children,u),N0(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&nt&&((_=p=Gt)&&(p=uF(p,a.type,a.pendingProps,Ds),p!==null?(a.stateNode=p,Bn=a,Gt=Ps(p.firstChild),Ds=!1,_=!0):_=!1),_||Ga(a)),It(a),_=a.type,S=a.pendingProps,x=r!==null?r.memoizedProps:null,p=S.children,SA(_,S)?p=null:x!==null&&SA(_,x)&&(a.flags|=32),a.memoizedState!==null&&(_=_S(r,a,wU,null,null,u),Qp._currentValue=_),N0(r,a),Gn(r,a,p,u),a.child;case 6:return r===null&&nt&&((r=u=Gt)&&(u=dF(u,a.pendingProps,Ds),u!==null?(a.stateNode=u,Bn=a,Gt=null,r=!0):r=!1),r||Ga(a)),null;case 13:return N1(r,a,u);case 4:return st(a,a.stateNode.containerInfo),p=a.pendingProps,r===null?a.child=Nc(a,null,p,u):Gn(r,a,p,u),a.child;case 11:return S1(r,a,a.type,a.pendingProps,u);case 7:return Gn(r,a,a.pendingProps,u),a.child;case 8:return Gn(r,a,a.pendingProps.children,u),a.child;case 12:return Gn(r,a,a.pendingProps.children,u),a.child;case 10:return p=a.pendingProps,za(a,a.type,p.value),Gn(r,a,p.children,u),a.child;case 9:return _=a.type._context,p=a.pendingProps.children,Cc(a),_=Hn(_),p=p(_),a.flags|=1,Gn(r,a,p,u),a.child;case 14:return A1(r,a,a.type,a.pendingProps,u);case 15:return E1(r,a,a.type,a.pendingProps,u);case 19:return D1(r,a,u);case 31:return kU(r,a,u);case 22:return T1(r,a,u,a.pendingProps);case 24:return Cc(a),p=Hn(fn),r===null?(_=uS(),_===null&&(_=Mt,S=lS(),_.pooledCache=S,S.refCount++,S!==null&&(_.pooledCacheLanes|=u),_=S),a.memoizedState={parent:p,cache:_},hS(a),za(a,fn,_)):((r.lanes&u)!==0&&(fS(r,a),Dp(a,null,null,u),Mp()),_=r.memoizedState,S=a.memoizedState,_.parent!==p?(_={parent:p,cache:p},a.memoizedState=_,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=_),za(a,fn,p)):(p=S.cache,za(a,fn,p),p!==_.cache&&aS(a,[fn],u,!0))),Gn(r,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Co(r){r.flags|=4}function WS(r,a,u,p,_){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(_&335544128)===_)if(r.stateNode.complete)r.flags|=8192;else if(oR())r.flags|=8192;else throw Ic=g0,dS}else r.flags&=-16777217}function P1(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!KR(a))if(oR())r.flags|=8192;else throw Ic=g0,dS}function D0(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?fC():536870912,r.lanes|=a,qd|=a)}function Fp(r,a){if(!nt)switch(r.tailMode){case"hidden":a=r.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:p.sibling=null}}function zt(r){var a=r.alternate!==null&&r.alternate.child===r.child,u=0,p=0;if(a)for(var _=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=p,r.childLanes=u,a}function LU(r,a,u){var p=a.pendingProps;switch(nS(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(a),null;case 1:return zt(a),null;case 3:return u=a.stateNode,p=null,r!==null&&(p=r.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),Ao(fn),Je(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Md(a)?Co(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,sS())),zt(a),null;case 26:var _=a.type,S=a.memoizedState;return r===null?(Co(a),S!==null?(zt(a),P1(a,S)):(zt(a),WS(a,_,null,p,u))):S?S!==r.memoizedState?(Co(a),zt(a),P1(a,S)):(zt(a),a.flags&=-16777217):(r=r.memoizedProps,r!==p&&Co(a),zt(a),WS(a,_,r,p,u)),null;case 27:if(Xe(a),u=Ce.current,_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&Co(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return zt(a),null}r=de.current,Md(a)?fx(a):(r=GR(_,p,u),a.stateNode=r,Co(a))}return zt(a),null;case 5:if(Xe(a),_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&Co(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return zt(a),null}if(S=de.current,Md(a))fx(a);else{var x=X0(Ce.current);switch(S){case 1:S=x.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:S=x.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":S=x.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":S=x.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":S=x.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?S.multiple=!0:p.size&&(S.size=p.size);break;default:S=typeof p.is=="string"?x.createElement(_,{is:p.is}):x.createElement(_)}}S[Fn]=a,S[Ci]=p;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)S.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=S;e:switch(zn(S,_,p),_){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Co(a)}}return zt(a),WS(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,u),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==p&&Co(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(n(166));if(r=Ce.current,Md(a)){if(r=a.stateNode,u=a.memoizedProps,p=null,_=Bn,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}r[Fn]=a,r=!!(r.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||NR(r.nodeValue,u)),r||Ga(a,!0)}else r=X0(r).createTextNode(p),r[Fn]=a,a.stateNode=r}return zt(a),null;case 31:if(u=a.memoizedState,r===null||r.memoizedState!==null){if(p=Md(a),u!==null){if(r===null){if(!p)throw Error(n(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Fn]=a}else Tc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;zt(a),r=!1}else u=sS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return a.flags&256?(Wi(a),a):(Wi(a),null);if((a.flags&128)!==0)throw Error(n(558))}return zt(a),null;case 13:if(p=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(_=Md(a),p!==null&&p.dehydrated!==null){if(r===null){if(!_)throw Error(n(318));if(_=a.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[Fn]=a}else Tc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;zt(a),_=!1}else _=sS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=_),_=!0;if(!_)return a.flags&256?(Wi(a),a):(Wi(a),null)}return Wi(a),(a.flags&128)!==0?(a.lanes=u,a):(u=p!==null,r=r!==null&&r.memoizedState!==null,u&&(p=a.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool),S=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==_&&(p.flags|=2048)),u!==r&&u&&(a.child.flags|=8192),D0(a,a.updateQueue),zt(a),null);case 4:return Je(),r===null&&mA(a.stateNode.containerInfo),zt(a),null;case 10:return Ao(a.type),zt(a),null;case 19:if(J(an),p=a.memoizedState,p===null)return zt(a),null;if(_=(a.flags&128)!==0,S=p.rendering,S===null)if(_)Fp(p,!1);else{if(en!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=b0(r),S!==null){for(a.flags|=128,Fp(p,!1),r=S.updateQueue,a.updateQueue=r,D0(a,r),a.subtreeFlags=0,r=u,u=a.child;u!==null;)lx(u,r),u=u.sibling;return re(an,an.current&1|2),nt&&_o(a,p.treeForkCount),a.child}r=r.sibling}p.tail!==null&&Re()>U0&&(a.flags|=128,_=!0,Fp(p,!1),a.lanes=4194304)}else{if(!_)if(r=b0(S),r!==null){if(a.flags|=128,_=!0,r=r.updateQueue,a.updateQueue=r,D0(a,r),Fp(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!nt)return zt(a),null}else 2*Re()-p.renderingStartTime>U0&&u!==536870912&&(a.flags|=128,_=!0,Fp(p,!1),a.lanes=4194304);p.isBackwards?(S.sibling=a.child,a.child=S):(r=p.last,r!==null?r.sibling=S:a.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=Re(),r.sibling=null,u=an.current,re(an,_?u&1|2:u&1),nt&&_o(a,p.treeForkCount),r):(zt(a),null);case 22:case 23:return Wi(a),yS(),p=a.memoizedState!==null,r!==null?r.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(u&536870912)!==0&&(a.flags&128)===0&&(zt(a),a.subtreeFlags&6&&(a.flags|=8192)):zt(a),u=a.updateQueue,u!==null&&D0(a,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==u&&(a.flags|=2048),r!==null&&J(xc),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Ao(fn),zt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function OU(r,a){switch(nS(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Ao(fn),Je(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Xe(a),null;case 31:if(a.memoizedState!==null){if(Wi(a),a.alternate===null)throw Error(n(340));Tc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Wi(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Tc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return J(an),null;case 4:return Je(),null;case 10:return Ao(a.type),null;case 22:case 23:return Wi(a),yS(),r!==null&&J(xc),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Ao(fn),null;case 25:return null;default:return null}}function L1(r,a){switch(nS(a),a.tag){case 3:Ao(fn),Je();break;case 26:case 27:case 5:Xe(a);break;case 4:Je();break;case 31:a.memoizedState!==null&&Wi(a);break;case 13:Wi(a);break;case 19:J(an);break;case 10:Ao(a.type);break;case 22:case 23:Wi(a),yS(),r!==null&&J(xc);break;case 24:Ao(fn)}}function Bp(r,a){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var _=p.next;u=_;do{if((u.tag&r)===r){p=void 0;var S=u.create,x=u.inst;p=S(),x.destroy=p}u=u.next}while(u!==_)}}catch(D){yt(a,a.return,D)}}function Wa(r,a,u){try{var p=a.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var S=_.next;p=S;do{if((p.tag&r)===r){var x=p.inst,D=x.destroy;if(D!==void 0){x.destroy=void 0,_=a;var B=u,X=D;try{X()}catch(te){yt(_,B,te)}}}p=p.next}while(p!==S)}}catch(te){yt(a,a.return,te)}}function O1(r){var a=r.updateQueue;if(a!==null){var u=r.stateNode;try{Cx(a,u)}catch(p){yt(r,r.return,p)}}}function U1(r,a,u){u.props=Dc(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(p){yt(r,a,p)}}function Hp(r,a){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var p=r.stateNode;break;case 30:p=r.stateNode;break;default:p=r.stateNode}typeof u=="function"?r.refCleanup=u(p):u.current=p}}catch(_){yt(r,a,_)}}function Mr(r,a){var u=r.ref,p=r.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(_){yt(r,a,_)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){yt(r,a,_)}else u.current=null}function F1(r){var a=r.type,u=r.memoizedProps,p=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(_){yt(r,r.return,_)}}function KS(r,a,u){try{var p=r.stateNode;sF(p,r.type,u,a),p[Ci]=a}catch(_){yt(r,r.return,_)}}function B1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&tl(r.type)||r.tag===4}function JS(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||B1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&tl(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function jS(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(r),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=yo));else if(p!==4&&(p===27&&tl(r.type)&&(u=r.stateNode,a=null),r=r.child,r!==null))for(jS(r,a,u),r=r.sibling;r!==null;)jS(r,a,u),r=r.sibling}function k0(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?u.insertBefore(r,a):u.appendChild(r);else if(p!==4&&(p===27&&tl(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(k0(r,a,u),r=r.sibling;r!==null;)k0(r,a,u),r=r.sibling}function H1(r){var a=r.stateNode,u=r.memoizedProps;try{for(var p=r.type,_=a.attributes;_.length;)a.removeAttributeNode(_[0]);zn(a,p,u),a[Fn]=r,a[Ci]=u}catch(S){yt(r,r.return,S)}}var xo=!1,mn=!1,QS=!1,G1=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function UU(r,a){if(r=r.containerInfo,bA=ev,r=ZC(r),$_(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var _=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var x=0,D=-1,B=-1,X=0,te=0,ie=r,W=null;t:for(;;){for(var j;ie!==u||_!==0&&ie.nodeType!==3||(D=x+_),ie!==S||p!==0&&ie.nodeType!==3||(B=x+p),ie.nodeType===3&&(x+=ie.nodeValue.length),(j=ie.firstChild)!==null;)W=ie,ie=j;for(;;){if(ie===r)break t;if(W===u&&++X===_&&(D=x),W===S&&++te===p&&(B=x),(j=ie.nextSibling)!==null)break;ie=W,W=ie.parentNode}ie=j}u=D===-1||B===-1?null:{start:D,end:B}}else u=null}u=u||{start:0,end:0}}else u=null;for(_A={focusedElem:r,selectionRange:u},ev=!1,Rn=a;Rn!==null;)if(a=Rn,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,Rn=r;else for(;Rn!==null;){switch(a=Rn,S=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)_=r[u],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&S!==null){r=void 0,u=a,_=S.memoizedProps,S=S.memoizedState,p=u.stateNode;try{var Se=Dc(u.type,_);r=p.getSnapshotBeforeUpdate(Se,S),p.__reactInternalSnapshotBeforeUpdate=r}catch(Ie){yt(u,u.return,Ie)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,u=r.nodeType,u===9)EA(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":EA(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=a.sibling,r!==null){r.return=a.return,Rn=r;break}Rn=a.return}}function z1(r,a,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Io(r,u),p&4&&Bp(5,u);break;case 1:if(Io(r,u),p&4)if(r=u.stateNode,a===null)try{r.componentDidMount()}catch(x){yt(u,u.return,x)}else{var _=Dc(u.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(_,a,r.__reactInternalSnapshotBeforeUpdate)}catch(x){yt(u,u.return,x)}}p&64&&O1(u),p&512&&Hp(u,u.return);break;case 3:if(Io(r,u),p&64&&(r=u.updateQueue,r!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{Cx(r,a)}catch(x){yt(u,u.return,x)}}break;case 27:a===null&&p&4&&H1(u);case 26:case 5:Io(r,u),a===null&&p&4&&F1(u),p&512&&Hp(u,u.return);break;case 12:Io(r,u);break;case 31:Io(r,u),p&4&&$1(r,u);break;case 13:Io(r,u),p&4&&Y1(r,u),p&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=YU.bind(null,u),hF(r,u))));break;case 22:if(p=u.memoizedState!==null||xo,!p){a=a!==null&&a.memoizedState!==null||mn,_=xo;var S=mn;xo=p,(mn=a)&&!S?No(r,u,(u.subtreeFlags&8772)!==0):Io(r,u),xo=_,mn=S}break;case 30:break;default:Io(r,u)}}function V1(r){var a=r.alternate;a!==null&&(r.alternate=null,V1(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&R_(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var qt=null,Ri=!1;function Ro(r,a,u){for(u=u.child;u!==null;)q1(r,a,u),u=u.sibling}function q1(r,a,u){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(gt,u)}catch{}switch(u.tag){case 26:mn||Mr(u,a),Ro(r,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:mn||Mr(u,a);var p=qt,_=Ri;tl(u.type)&&(qt=u.stateNode,Ri=!1),Ro(r,a,u),Kp(u.stateNode),qt=p,Ri=_;break;case 5:mn||Mr(u,a);case 6:if(p=qt,_=Ri,qt=null,Ro(r,a,u),qt=p,Ri=_,qt!==null)if(Ri)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(u.stateNode)}catch(S){yt(u,a,S)}else try{qt.removeChild(u.stateNode)}catch(S){yt(u,a,S)}break;case 18:qt!==null&&(Ri?(r=qt,OR(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Qd(r)):OR(qt,u.stateNode));break;case 4:p=qt,_=Ri,qt=u.stateNode.containerInfo,Ri=!0,Ro(r,a,u),qt=p,Ri=_;break;case 0:case 11:case 14:case 15:Wa(2,u,a),mn||Wa(4,u,a),Ro(r,a,u);break;case 1:mn||(Mr(u,a),p=u.stateNode,typeof p.componentWillUnmount=="function"&&U1(u,a,p)),Ro(r,a,u);break;case 21:Ro(r,a,u);break;case 22:mn=(p=mn)||u.memoizedState!==null,Ro(r,a,u),mn=p;break;default:Ro(r,a,u)}}function $1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Qd(r)}catch(u){yt(a,a.return,u)}}}function Y1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Qd(r)}catch(u){yt(a,a.return,u)}}function FU(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new G1),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new G1),a;default:throw Error(n(435,r.tag))}}function P0(r,a){var u=FU(r);a.forEach(function(p){if(!u.has(p)){u.add(p);var _=XU.bind(null,r,p);p.then(_,_)}})}function Ii(r,a){var u=a.deletions;if(u!==null)for(var p=0;p<u.length;p++){var _=u[p],S=r,x=a,D=x;e:for(;D!==null;){switch(D.tag){case 27:if(tl(D.type)){qt=D.stateNode,Ri=!1;break e}break;case 5:qt=D.stateNode,Ri=!1;break e;case 3:case 4:qt=D.stateNode.containerInfo,Ri=!0;break e}D=D.return}if(qt===null)throw Error(n(160));q1(S,x,_),qt=null,Ri=!1,S=_.alternate,S!==null&&(S.return=null),_.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)X1(a,r),a=a.sibling}var ir=null;function X1(r,a){var u=r.alternate,p=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ii(a,r),Ni(r),p&4&&(Wa(3,r,r.return),Bp(3,r),Wa(5,r,r.return));break;case 1:Ii(a,r),Ni(r),p&512&&(mn||u===null||Mr(u,u.return)),p&64&&xo&&(r=r.updateQueue,r!==null&&(p=r.callbacks,p!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var _=ir;if(Ii(a,r),Ni(r),p&512&&(mn||u===null||Mr(u,u.return)),p&4){var S=u!==null?u.memoizedState:null;if(p=r.memoizedState,u===null)if(p===null)if(r.stateNode===null){e:{p=r.type,u=r.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":S=_.getElementsByTagName("title")[0],(!S||S[fp]||S[Fn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=_.createElement(p),_.head.insertBefore(S,_.querySelector("head > title"))),zn(S,p,u),S[Fn]=r,xn(S),p=S;break e;case"link":var x=XR("link","href",_).get(p+(u.href||""));if(x){for(var D=0;D<x.length;D++)if(S=x[D],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){x.splice(D,1);break t}}S=_.createElement(p),zn(S,p,u),_.head.appendChild(S);break;case"meta":if(x=XR("meta","content",_).get(p+(u.content||""))){for(D=0;D<x.length;D++)if(S=x[D],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){x.splice(D,1);break t}}S=_.createElement(p),zn(S,p,u),_.head.appendChild(S);break;default:throw Error(n(468,p))}S[Fn]=r,xn(S),p=S}r.stateNode=p}else WR(_,r.type,r.stateNode);else r.stateNode=YR(_,p,r.memoizedProps);else S!==p?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,p===null?WR(_,r.type,r.stateNode):YR(_,p,r.memoizedProps)):p===null&&r.stateNode!==null&&KS(r,r.memoizedProps,u.memoizedProps)}break;case 27:Ii(a,r),Ni(r),p&512&&(mn||u===null||Mr(u,u.return)),u!==null&&p&4&&KS(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Ii(a,r),Ni(r),p&512&&(mn||u===null||Mr(u,u.return)),r.flags&32){_=r.stateNode;try{Sd(_,"")}catch(Se){yt(r,r.return,Se)}}p&4&&r.stateNode!=null&&(_=r.memoizedProps,KS(r,_,u!==null?u.memoizedProps:_)),p&1024&&(QS=!0);break;case 6:if(Ii(a,r),Ni(r),p&4){if(r.stateNode===null)throw Error(n(162));p=r.memoizedProps,u=r.stateNode;try{u.nodeValue=p}catch(Se){yt(r,r.return,Se)}}break;case 3:if(J0=null,_=ir,ir=W0(a.containerInfo),Ii(a,r),ir=_,Ni(r),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Qd(a.containerInfo)}catch(Se){yt(r,r.return,Se)}QS&&(QS=!1,W1(r));break;case 4:p=ir,ir=W0(r.stateNode.containerInfo),Ii(a,r),Ni(r),ir=p;break;case 12:Ii(a,r),Ni(r);break;case 31:Ii(a,r),Ni(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,P0(r,p)));break;case 13:Ii(a,r),Ni(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(O0=Re()),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,P0(r,p)));break;case 22:_=r.memoizedState!==null;var B=u!==null&&u.memoizedState!==null,X=xo,te=mn;if(xo=X||_,mn=te||B,Ii(a,r),mn=te,xo=X,Ni(r),p&8192)e:for(a=r.stateNode,a._visibility=_?a._visibility&-2:a._visibility|1,_&&(u===null||B||xo||mn||kc(r)),u=null,a=r;;){if(a.tag===5||a.tag===26){if(u===null){B=u=a;try{if(S=B.stateNode,_)x=S.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{D=B.stateNode;var ie=B.memoizedProps.style,W=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;D.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Se){yt(B,B.return,Se)}}}else if(a.tag===6){if(u===null){B=a;try{B.stateNode.nodeValue=_?"":B.memoizedProps}catch(Se){yt(B,B.return,Se)}}}else if(a.tag===18){if(u===null){B=a;try{var j=B.stateNode;_?UR(j,!0):UR(B.stateNode,!1)}catch(Se){yt(B,B.return,Se)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=r.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,P0(r,u))));break;case 19:Ii(a,r),Ni(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,P0(r,p)));break;case 30:break;case 21:break;default:Ii(a,r),Ni(r)}}function Ni(r){var a=r.flags;if(a&2){try{for(var u,p=r.return;p!==null;){if(B1(p)){u=p;break}p=p.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var _=u.stateNode,S=JS(r);k0(r,S,_);break;case 5:var x=u.stateNode;u.flags&32&&(Sd(x,""),u.flags&=-33);var D=JS(r);k0(r,D,x);break;case 3:case 4:var B=u.stateNode.containerInfo,X=JS(r);jS(r,X,B);break;default:throw Error(n(161))}}catch(te){yt(r,r.return,te)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function W1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;W1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Io(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)z1(r,a.alternate,a),a=a.sibling}function kc(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Wa(4,a,a.return),kc(a);break;case 1:Mr(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&U1(a,a.return,u),kc(a);break;case 27:Kp(a.stateNode);case 26:case 5:Mr(a,a.return),kc(a);break;case 22:a.memoizedState===null&&kc(a);break;case 30:kc(a);break;default:kc(a)}r=r.sibling}}function No(r,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,_=r,S=a,x=S.flags;switch(S.tag){case 0:case 11:case 15:No(_,S,u),Bp(4,S);break;case 1:if(No(_,S,u),p=S,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(X){yt(p,p.return,X)}if(p=S,_=p.updateQueue,_!==null){var D=p.stateNode;try{var B=_.shared.hiddenCallbacks;if(B!==null)for(_.shared.hiddenCallbacks=null,_=0;_<B.length;_++)wx(B[_],D)}catch(X){yt(p,p.return,X)}}u&&x&64&&O1(S),Hp(S,S.return);break;case 27:H1(S);case 26:case 5:No(_,S,u),u&&p===null&&x&4&&F1(S),Hp(S,S.return);break;case 12:No(_,S,u);break;case 31:No(_,S,u),u&&x&4&&$1(_,S);break;case 13:No(_,S,u),u&&x&4&&Y1(_,S);break;case 22:S.memoizedState===null&&No(_,S,u),Hp(S,S.return);break;case 30:break;default:No(_,S,u)}a=a.sibling}}function ZS(r,a){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Cp(u))}function eA(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Cp(r))}function sr(r,a,u,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)K1(r,a,u,p),a=a.sibling}function K1(r,a,u,p){var _=a.flags;switch(a.tag){case 0:case 11:case 15:sr(r,a,u,p),_&2048&&Bp(9,a);break;case 1:sr(r,a,u,p);break;case 3:sr(r,a,u,p),_&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Cp(r)));break;case 12:if(_&2048){sr(r,a,u,p),r=a.stateNode;try{var S=a.memoizedProps,x=S.id,D=S.onPostCommit;typeof D=="function"&&D(x,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(B){yt(a,a.return,B)}}else sr(r,a,u,p);break;case 31:sr(r,a,u,p);break;case 13:sr(r,a,u,p);break;case 23:break;case 22:S=a.stateNode,x=a.alternate,a.memoizedState!==null?S._visibility&2?sr(r,a,u,p):Gp(r,a):S._visibility&2?sr(r,a,u,p):(S._visibility|=2,Gd(r,a,u,p,(a.subtreeFlags&10256)!==0||!1)),_&2048&&ZS(x,a);break;case 24:sr(r,a,u,p),_&2048&&eA(a.alternate,a);break;default:sr(r,a,u,p)}}function Gd(r,a,u,p,_){for(_=_&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var S=r,x=a,D=u,B=p,X=x.flags;switch(x.tag){case 0:case 11:case 15:Gd(S,x,D,B,_),Bp(8,x);break;case 23:break;case 22:var te=x.stateNode;x.memoizedState!==null?te._visibility&2?Gd(S,x,D,B,_):Gp(S,x):(te._visibility|=2,Gd(S,x,D,B,_)),_&&X&2048&&ZS(x.alternate,x);break;case 24:Gd(S,x,D,B,_),_&&X&2048&&eA(x.alternate,x);break;default:Gd(S,x,D,B,_)}a=a.sibling}}function Gp(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=r,p=a,_=p.flags;switch(p.tag){case 22:Gp(u,p),_&2048&&ZS(p.alternate,p);break;case 24:Gp(u,p),_&2048&&eA(p.alternate,p);break;default:Gp(u,p)}a=a.sibling}}var zp=8192;function zd(r,a,u){if(r.subtreeFlags&zp)for(r=r.child;r!==null;)J1(r,a,u),r=r.sibling}function J1(r,a,u){switch(r.tag){case 26:zd(r,a,u),r.flags&zp&&r.memoizedState!==null&&TF(u,ir,r.memoizedState,r.memoizedProps);break;case 5:zd(r,a,u);break;case 3:case 4:var p=ir;ir=W0(r.stateNode.containerInfo),zd(r,a,u),ir=p;break;case 22:r.memoizedState===null&&(p=r.alternate,p!==null&&p.memoizedState!==null?(p=zp,zp=16777216,zd(r,a,u),zp=p):zd(r,a,u));break;default:zd(r,a,u)}}function j1(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Vp(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Rn=p,Z1(p,r)}j1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Q1(r),r=r.sibling}function Q1(r){switch(r.tag){case 0:case 11:case 15:Vp(r),r.flags&2048&&Wa(9,r,r.return);break;case 3:Vp(r);break;case 12:Vp(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,L0(r)):Vp(r);break;default:Vp(r)}}function L0(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Rn=p,Z1(p,r)}j1(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Wa(8,a,a.return),L0(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,L0(a));break;default:L0(a)}r=r.sibling}}function Z1(r,a){for(;Rn!==null;){var u=Rn;switch(u.tag){case 0:case 11:case 15:Wa(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Cp(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Rn=p;else e:for(u=r;Rn!==null;){p=Rn;var _=p.sibling,S=p.return;if(V1(p),p===u){Rn=null;break e}if(_!==null){_.return=S,Rn=_;break e}Rn=S}}}var BU={getCacheForType:function(r){var a=Hn(fn),u=a.data.get(r);return u===void 0&&(u=r(),a.data.set(r,u)),u},cacheSignal:function(){return Hn(fn).controller.signal}},HU=typeof WeakMap=="function"?WeakMap:Map,dt=0,Mt=null,je=null,Ze=0,mt=0,Ki=null,Ka=!1,Vd=!1,tA=!1,Mo=0,en=0,Ja=0,Pc=0,nA=0,Ji=0,qd=0,qp=null,Mi=null,iA=!1,O0=0,eR=0,U0=1/0,F0=null,ja=null,_n=0,Qa=null,$d=null,Do=0,sA=0,rA=null,tR=null,$p=0,oA=null;function ji(){return(dt&2)!==0&&Ze!==0?Ze&-Ze:G.T!==null?hA():yC()}function nR(){if(Ji===0)if((Ze&536870912)===0||nt){var r=Yy;Yy<<=1,(Yy&3932160)===0&&(Yy=262144),Ji=r}else Ji=536870912;return r=Xi.current,r!==null&&(r.flags|=32),Ji}function Di(r,a,u){(r===Mt&&(mt===2||mt===9)||r.cancelPendingCommit!==null)&&(Yd(r,0),Za(r,Ze,Ji,!1)),hp(r,u),((dt&2)===0||r!==Mt)&&(r===Mt&&((dt&2)===0&&(Pc|=u),en===4&&Za(r,Ze,Ji,!1)),Dr(r))}function iR(r,a,u){if((dt&6)!==0)throw Error(n(327));var p=!u&&(a&127)===0&&(a&r.expiredLanes)===0||dp(r,a),_=p?VU(r,a):lA(r,a,!0),S=p;do{if(_===0){Vd&&!p&&Za(r,a,0,!1);break}else{if(u=r.current.alternate,S&&!GU(u)){_=lA(r,a,!1),S=!1;continue}if(_===2){if(S=a,r.errorRecoveryDisabledLanes&S)var x=0;else x=r.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var D=r;_=qp;var B=D.current.memoizedState.isDehydrated;if(B&&(Yd(D,x).flags|=256),x=lA(D,x,!1),x!==2){if(tA&&!B){D.errorRecoveryDisabledLanes|=S,Pc|=S,_=4;break e}S=Mi,Mi=_,S!==null&&(Mi===null?Mi=S:Mi.push.apply(Mi,S))}_=x}if(S=!1,_!==2)continue}}if(_===1){Yd(r,0),Za(r,a,0,!0);break}e:{switch(p=r,S=_,S){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Za(p,a,Ji,!Ka);break e;case 2:Mi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(_=O0+300-Re(),10<_)){if(Za(p,a,Ji,!Ka),Wy(p,0,!0)!==0)break e;Do=a,p.timeoutHandle=PR(sR.bind(null,p,u,Mi,F0,iA,a,Ji,Pc,qd,Ka,S,"Throttled",-0,0),_);break e}sR(p,u,Mi,F0,iA,a,Ji,Pc,qd,Ka,S,null,-0,0)}}break}while(!0);Dr(r)}function sR(r,a,u,p,_,S,x,D,B,X,te,ie,W,j){if(r.timeoutHandle=-1,ie=a.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yo},J1(a,S,ie);var Se=(S&62914560)===S?O0-Re():(S&4194048)===S?eR-Re():0;if(Se=wF(ie,Se),Se!==null){Do=S,r.cancelPendingCommit=Se(hR.bind(null,r,a,S,u,p,_,x,D,B,te,ie,null,W,j)),Za(r,S,x,!X);return}}hR(r,a,S,u,p,_,x,D,B)}function GU(r){for(var a=r;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var _=u[p],S=_.getSnapshot;_=_.value;try{if(!$i(S(),_))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Za(r,a,u,p){a&=~nA,a&=~Pc,r.suspendedLanes|=a,r.pingedLanes&=~a,p&&(r.warmLanes|=a),p=r.expirationTimes;for(var _=a;0<_;){var S=31-Zn(_),x=1<<S;p[S]=-1,_&=~x}u!==0&&pC(r,u,a)}function B0(){return(dt&6)===0?(Yp(0),!1):!0}function aA(){if(je!==null){if(mt===0)var r=je.return;else r=je,So=wc=null,ES(r),Od=null,Rp=0,r=je;for(;r!==null;)L1(r.alternate,r),r=r.return;je=null}}function Yd(r,a){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,aF(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Do=0,aA(),Mt=r,je=u=bo(r.current,null),Ze=a,mt=0,Ki=null,Ka=!1,Vd=dp(r,a),tA=!1,qd=Ji=nA=Pc=Ja=en=0,Mi=qp=null,iA=!1,(a&8)!==0&&(a|=a&32);var p=r.entangledLanes;if(p!==0)for(r=r.entanglements,p&=a;0<p;){var _=31-Zn(p),S=1<<_;a|=r[_],p&=~S}return Mo=a,o0(),u}function rR(r,a){Be=null,G.H=Op,a===Ld||a===p0?(a=Sx(),mt=3):a===dS?(a=Sx(),mt=4):mt=a===BS?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ki=a,je===null&&(en=1,R0(r,Is(a,r.current)))}function oR(){var r=Xi.current;return r===null?!0:(Ze&4194048)===Ze?ks===null:(Ze&62914560)===Ze||(Ze&536870912)!==0?r===ks:!1}function aR(){var r=G.H;return G.H=Op,r===null?Op:r}function lR(){var r=G.A;return G.A=BU,r}function H0(){en=4,Ka||(Ze&4194048)!==Ze&&Xi.current!==null||(Vd=!0),(Ja&134217727)===0&&(Pc&134217727)===0||Mt===null||Za(Mt,Ze,Ji,!1)}function lA(r,a,u){var p=dt;dt|=2;var _=aR(),S=lR();(Mt!==r||Ze!==a)&&(F0=null,Yd(r,a)),a=!1;var x=en;e:do try{if(mt!==0&&je!==null){var D=je,B=Ki;switch(mt){case 8:aA(),x=6;break e;case 3:case 2:case 9:case 6:Xi.current===null&&(a=!0);var X=mt;if(mt=0,Ki=null,Xd(r,D,B,X),u&&Vd){x=0;break e}break;default:X=mt,mt=0,Ki=null,Xd(r,D,B,X)}}zU(),x=en;break}catch(te){rR(r,te)}while(!0);return a&&r.shellSuspendCounter++,So=wc=null,dt=p,G.H=_,G.A=S,je===null&&(Mt=null,Ze=0,o0()),x}function zU(){for(;je!==null;)cR(je)}function VU(r,a){var u=dt;dt|=2;var p=aR(),_=lR();Mt!==r||Ze!==a?(F0=null,U0=Re()+500,Yd(r,a)):Vd=dp(r,a);e:do try{if(mt!==0&&je!==null){a=je;var S=Ki;t:switch(mt){case 1:mt=0,Ki=null,Xd(r,a,S,1);break;case 2:case 9:if(bx(S)){mt=0,Ki=null,uR(a);break}a=function(){mt!==2&&mt!==9||Mt!==r||(mt=7),Dr(r)},S.then(a,a);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:bx(S)?(mt=0,Ki=null,uR(a)):(mt=0,Ki=null,Xd(r,a,S,7));break;case 5:var x=null;switch(je.tag){case 26:x=je.memoizedState;case 5:case 27:var D=je;if(x?KR(x):D.stateNode.complete){mt=0,Ki=null;var B=D.sibling;if(B!==null)je=B;else{var X=D.return;X!==null?(je=X,G0(X)):je=null}break t}}mt=0,Ki=null,Xd(r,a,S,5);break;case 6:mt=0,Ki=null,Xd(r,a,S,6);break;case 8:aA(),en=6;break e;default:throw Error(n(462))}}qU();break}catch(te){rR(r,te)}while(!0);return So=wc=null,G.H=p,G.A=_,dt=u,je!==null?0:(Mt=null,Ze=0,o0(),en)}function qU(){for(;je!==null&&!ae();)cR(je)}function cR(r){var a=k1(r.alternate,r,Mo);r.memoizedProps=r.pendingProps,a===null?G0(r):je=a}function uR(r){var a=r,u=a.alternate;switch(a.tag){case 15:case 0:a=x1(u,a,a.pendingProps,a.type,void 0,Ze);break;case 11:a=x1(u,a,a.pendingProps,a.type.render,a.ref,Ze);break;case 5:ES(a);default:L1(u,a),a=je=lx(a,Mo),a=k1(u,a,Mo)}r.memoizedProps=r.pendingProps,a===null?G0(r):je=a}function Xd(r,a,u,p){So=wc=null,ES(a),Od=null,Rp=0;var _=a.return;try{if(DU(r,_,a,u,Ze)){en=1,R0(r,Is(u,r.current)),je=null;return}}catch(S){if(_!==null)throw je=_,S;en=1,R0(r,Is(u,r.current)),je=null;return}a.flags&32768?(nt||p===1?r=!0:Vd||(Ze&536870912)!==0?r=!1:(Ka=r=!0,(p===2||p===9||p===3||p===6)&&(p=Xi.current,p!==null&&p.tag===13&&(p.flags|=16384))),dR(a,r)):G0(a)}function G0(r){var a=r;do{if((a.flags&32768)!==0){dR(a,Ka);return}r=a.return;var u=LU(a.alternate,a,Mo);if(u!==null){je=u;return}if(a=a.sibling,a!==null){je=a;return}je=a=r}while(a!==null);en===0&&(en=5)}function dR(r,a){do{var u=OU(r.alternate,r);if(u!==null){u.flags&=32767,je=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(r=r.sibling,r!==null)){je=r;return}je=r=u}while(r!==null);en=6,je=null}function hR(r,a,u,p,_,S,x,D,B){r.cancelPendingCommit=null;do z0();while(_n!==0);if((dt&6)!==0)throw Error(n(327));if(a!==null){if(a===r.current)throw Error(n(177));if(S=a.lanes|a.childLanes,S|=J_,EO(r,u,S,x,D,B),r===Mt&&(je=Mt=null,Ze=0),$d=a,Qa=r,Do=u,sA=S,rA=_,tR=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,WU(Qn,function(){return yR(),null})):(r.callbackNode=null,r.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=G.T,G.T=null,_=$.p,$.p=2,x=dt,dt|=4;try{UU(r,a,u)}finally{dt=x,$.p=_,G.T=p}}_n=1,fR(),pR(),gR()}}function fR(){if(_n===1){_n=0;var r=Qa,a=$d,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=dt;dt|=4;try{X1(a,r);var S=_A,x=ZC(r.containerInfo),D=S.focusedElem,B=S.selectionRange;if(x!==D&&D&&D.ownerDocument&&QC(D.ownerDocument.documentElement,D)){if(B!==null&&$_(D)){var X=B.start,te=B.end;if(te===void 0&&(te=X),"selectionStart"in D)D.selectionStart=X,D.selectionEnd=Math.min(te,D.value.length);else{var ie=D.ownerDocument||document,W=ie&&ie.defaultView||window;if(W.getSelection){var j=W.getSelection(),Se=D.textContent.length,Ie=Math.min(B.start,Se),Et=B.end===void 0?Ie:Math.min(B.end,Se);!j.extend&&Ie>Et&&(x=Et,Et=Ie,Ie=x);var V=jC(D,Ie),z=jC(D,Et);if(V&&z&&(j.rangeCount!==1||j.anchorNode!==V.node||j.anchorOffset!==V.offset||j.focusNode!==z.node||j.focusOffset!==z.offset)){var Y=ie.createRange();Y.setStart(V.node,V.offset),j.removeAllRanges(),Ie>Et?(j.addRange(Y),j.extend(z.node,z.offset)):(Y.setEnd(z.node,z.offset),j.addRange(Y))}}}}for(ie=[],j=D;j=j.parentNode;)j.nodeType===1&&ie.push({element:j,left:j.scrollLeft,top:j.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ie.length;D++){var ne=ie[D];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}ev=!!bA,_A=bA=null}finally{dt=_,$.p=p,G.T=u}}r.current=a,_n=2}}function pR(){if(_n===2){_n=0;var r=Qa,a=$d,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=dt;dt|=4;try{z1(r,a.alternate,a)}finally{dt=_,$.p=p,G.T=u}}_n=3}}function gR(){if(_n===4||_n===3){_n=0,Ge();var r=Qa,a=$d,u=Do,p=tR;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?_n=5:(_n=0,$d=Qa=null,mR(r,r.pendingLanes));var _=r.pendingLanes;if(_===0&&(ja=null),C_(u),a=a.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(gt,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=G.T,_=$.p,$.p=2,G.T=null;try{for(var S=r.onRecoverableError,x=0;x<p.length;x++){var D=p[x];S(D.value,{componentStack:D.stack})}}finally{G.T=a,$.p=_}}(Do&3)!==0&&z0(),Dr(r),_=r.pendingLanes,(u&261930)!==0&&(_&42)!==0?r===oA?$p++:($p=0,oA=r):$p=0,Yp(0)}}function mR(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Cp(a)))}function z0(){return fR(),pR(),gR(),yR()}function yR(){if(_n!==5)return!1;var r=Qa,a=sA;sA=0;var u=C_(Do),p=G.T,_=$.p;try{$.p=32>u?32:u,G.T=null,u=rA,rA=null;var S=Qa,x=Do;if(_n=0,$d=Qa=null,Do=0,(dt&6)!==0)throw Error(n(331));var D=dt;if(dt|=4,Q1(S.current),K1(S,S.current,x,u),dt=D,Yp(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(gt,S)}catch{}return!0}finally{$.p=_,G.T=p,mR(r,a)}}function vR(r,a,u){a=Is(u,a),a=FS(r.stateNode,a,2),r=$a(r,a,2),r!==null&&(hp(r,2),Dr(r))}function yt(r,a,u){if(r.tag===3)vR(r,r,u);else for(;a!==null;){if(a.tag===3){vR(a,r,u);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ja===null||!ja.has(p))){r=Is(u,r),u=b1(2),p=$a(a,u,2),p!==null&&(_1(u,p,a,r),hp(p,2),Dr(p));break}}a=a.return}}function cA(r,a,u){var p=r.pingCache;if(p===null){p=r.pingCache=new HU;var _=new Set;p.set(a,_)}else _=p.get(a),_===void 0&&(_=new Set,p.set(a,_));_.has(u)||(tA=!0,_.add(u),r=$U.bind(null,r,a,u),a.then(r,r))}function $U(r,a,u){var p=r.pingCache;p!==null&&p.delete(a),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,Mt===r&&(Ze&u)===u&&(en===4||en===3&&(Ze&62914560)===Ze&&300>Re()-O0?(dt&2)===0&&Yd(r,0):nA|=u,qd===Ze&&(qd=0)),Dr(r)}function bR(r,a){a===0&&(a=fC()),r=Ac(r,a),r!==null&&(hp(r,a),Dr(r))}function YU(r){var a=r.memoizedState,u=0;a!==null&&(u=a.retryLane),bR(r,u)}function XU(r,a){var u=0;switch(r.tag){case 31:case 13:var p=r.stateNode,_=r.memoizedState;_!==null&&(u=_.retryLane);break;case 19:p=r.stateNode;break;case 22:p=r.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(a),bR(r,u)}function WU(r,a){return Ts(r,a)}var V0=null,Wd=null,uA=!1,q0=!1,dA=!1,el=0;function Dr(r){r!==Wd&&r.next===null&&(Wd===null?V0=Wd=r:Wd=Wd.next=r),q0=!0,uA||(uA=!0,JU())}function Yp(r,a){if(!dA&&q0){dA=!0;do for(var u=!1,p=V0;p!==null;){if(r!==0){var _=p.pendingLanes;if(_===0)var S=0;else{var x=p.suspendedLanes,D=p.pingedLanes;S=(1<<31-Zn(42|r)+1)-1,S&=_&~(x&~D),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,ER(p,S))}else S=Ze,S=Wy(p,p===Mt?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(S&3)===0||dp(p,S)||(u=!0,ER(p,S));p=p.next}while(u);dA=!1}}function KU(){_R()}function _R(){q0=uA=!1;var r=0;el!==0&&oF()&&(r=el);for(var a=Re(),u=null,p=V0;p!==null;){var _=p.next,S=SR(p,a);S===0?(p.next=null,u===null?V0=_:u.next=_,_===null&&(Wd=u)):(u=p,(r!==0||(S&3)!==0)&&(q0=!0)),p=_}_n!==0&&_n!==5||Yp(r),el!==0&&(el=0)}function SR(r,a){for(var u=r.suspendedLanes,p=r.pingedLanes,_=r.expirationTimes,S=r.pendingLanes&-62914561;0<S;){var x=31-Zn(S),D=1<<x,B=_[x];B===-1?((D&u)===0||(D&p)!==0)&&(_[x]=AO(D,a)):B<=a&&(r.expiredLanes|=D),S&=~D}if(a=Mt,u=Ze,u=Wy(r,r===a?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p=r.callbackNode,u===0||r===a&&(mt===2||mt===9)||r.cancelPendingCommit!==null)return p!==null&&p!==null&&ws(p),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||dp(r,u)){if(a=u&-u,a===r.callbackPriority)return a;switch(p!==null&&ws(p),C_(u)){case 2:case 8:u=di;break;case 32:u=Qn;break;case 268435456:u=qi;break;default:u=Qn}return p=AR.bind(null,r),u=Ts(u,p),r.callbackPriority=a,r.callbackNode=u,a}return p!==null&&p!==null&&ws(p),r.callbackPriority=2,r.callbackNode=null,2}function AR(r,a){if(_n!==0&&_n!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(z0()&&r.callbackNode!==u)return null;var p=Ze;return p=Wy(r,r===Mt?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p===0?null:(iR(r,p,a),SR(r,Re()),r.callbackNode!=null&&r.callbackNode===u?AR.bind(null,r):null)}function ER(r,a){if(z0())return null;iR(r,a,!0)}function JU(){lF(function(){(dt&6)!==0?Ts(wi,KU):_R()})}function hA(){if(el===0){var r=kd;r===0&&(r=$y,$y<<=1,($y&261888)===0&&($y=256)),el=r}return el}function TR(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Qy(""+r)}function wR(r,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,r.id&&u.setAttribute("form",r.id),a.parentNode.insertBefore(u,a),r=new FormData(r),u.parentNode.removeChild(u),r}function jU(r,a,u,p,_){if(a==="submit"&&u&&u.stateNode===_){var S=TR((_[Ci]||null).action),x=p.submitter;x&&(a=(a=x[Ci]||null)?TR(a.formAction):x.getAttribute("formAction"),a!==null&&(S=a,x=null));var D=new n0("action","action",null,p,_);r.push({event:D,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(el!==0){var B=x?wR(_,x):new FormData(_);DS(u,{pending:!0,data:B,method:_.method,action:S},null,B)}}else typeof S=="function"&&(D.preventDefault(),B=x?wR(_,x):new FormData(_),DS(u,{pending:!0,data:B,method:_.method,action:S},S,B))},currentTarget:_}]})}}for(var fA=0;fA<K_.length;fA++){var pA=K_[fA],QU=pA.toLowerCase(),ZU=pA[0].toUpperCase()+pA.slice(1);nr(QU,"on"+ZU)}nr(nx,"onAnimationEnd"),nr(ix,"onAnimationIteration"),nr(sx,"onAnimationStart"),nr("dblclick","onDoubleClick"),nr("focusin","onFocus"),nr("focusout","onBlur"),nr(gU,"onTransitionRun"),nr(mU,"onTransitionStart"),nr(yU,"onTransitionCancel"),nr(rx,"onTransitionEnd"),bd("onMouseEnter",["mouseout","mouseover"]),bd("onMouseLeave",["mouseout","mouseover"]),bd("onPointerEnter",["pointerout","pointerover"]),bd("onPointerLeave",["pointerout","pointerover"]),vc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vc("onBeforeInput",["compositionend","keypress","textInput","paste"]),vc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xp));function CR(r,a){a=(a&4)!==0;for(var u=0;u<r.length;u++){var p=r[u],_=p.event;p=p.listeners;e:{var S=void 0;if(a)for(var x=p.length-1;0<=x;x--){var D=p[x],B=D.instance,X=D.currentTarget;if(D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=X;try{S(_)}catch(te){r0(te)}_.currentTarget=null,S=B}else for(x=0;x<p.length;x++){if(D=p[x],B=D.instance,X=D.currentTarget,D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=X;try{S(_)}catch(te){r0(te)}_.currentTarget=null,S=B}}}}function Qe(r,a){var u=a[x_];u===void 0&&(u=a[x_]=new Set);var p=r+"__bubble";u.has(p)||(xR(a,r,2,!1),u.add(p))}function gA(r,a,u){var p=0;a&&(p|=4),xR(u,r,p,a)}var $0="_reactListening"+Math.random().toString(36).slice(2);function mA(r){if(!r[$0]){r[$0]=!0,_C.forEach(function(u){u!=="selectionchange"&&(eF.has(u)||gA(u,!1,r),gA(u,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[$0]||(a[$0]=!0,gA("selectionchange",!1,a))}}function xR(r,a,u,p){switch(nI(a)){case 2:var _=RF;break;case 8:_=IF;break;default:_=MA}u=_.bind(null,a,u,r),_=void 0,!O_||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),p?_!==void 0?r.addEventListener(a,u,{capture:!0,passive:_}):r.addEventListener(a,u,!0):_!==void 0?r.addEventListener(a,u,{passive:_}):r.addEventListener(a,u,!1)}function yA(r,a,u,p,_){var S=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var x=p.tag;if(x===3||x===4){var D=p.stateNode.containerInfo;if(D===_)break;if(x===4)for(x=p.return;x!==null;){var B=x.tag;if((B===3||B===4)&&x.stateNode.containerInfo===_)return;x=x.return}for(;D!==null;){if(x=md(D),x===null)return;if(B=x.tag,B===5||B===6||B===26||B===27){p=S=x;continue e}D=D.parentNode}}p=p.return}DC(function(){var X=S,te=P_(u),ie=[];e:{var W=ox.get(r);if(W!==void 0){var j=n0,Se=r;switch(r){case"keypress":if(e0(u)===0)break e;case"keydown":case"keyup":j=XO;break;case"focusin":Se="focus",j=H_;break;case"focusout":Se="blur",j=H_;break;case"beforeblur":case"afterblur":j=H_;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=LC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=LO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=JO;break;case nx:case ix:case sx:j=FO;break;case rx:j=QO;break;case"scroll":case"scrollend":j=kO;break;case"wheel":j=eU;break;case"copy":case"cut":case"paste":j=HO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=UC;break;case"toggle":case"beforetoggle":j=nU}var Ie=(a&4)!==0,Et=!Ie&&(r==="scroll"||r==="scrollend"),V=Ie?W!==null?W+"Capture":null:W;Ie=[];for(var z=X,Y;z!==null;){var ne=z;if(Y=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||Y===null||V===null||(ne=gp(z,V),ne!=null&&Ie.push(Wp(z,ne,Y))),Et)break;z=z.return}0<Ie.length&&(W=new j(W,Se,null,u,te),ie.push({event:W,listeners:Ie}))}}if((a&7)===0){e:{if(W=r==="mouseover"||r==="pointerover",j=r==="mouseout"||r==="pointerout",W&&u!==k_&&(Se=u.relatedTarget||u.fromElement)&&(md(Se)||Se[gd]))break e;if((j||W)&&(W=te.window===te?te:(W=te.ownerDocument)?W.defaultView||W.parentWindow:window,j?(Se=u.relatedTarget||u.toElement,j=X,Se=Se?md(Se):null,Se!==null&&(Et=o(Se),Ie=Se.tag,Se!==Et||Ie!==5&&Ie!==27&&Ie!==6)&&(Se=null)):(j=null,Se=X),j!==Se)){if(Ie=LC,ne="onMouseLeave",V="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Ie=UC,ne="onPointerLeave",V="onPointerEnter",z="pointer"),Et=j==null?W:pp(j),Y=Se==null?W:pp(Se),W=new Ie(ne,z+"leave",j,u,te),W.target=Et,W.relatedTarget=Y,ne=null,md(te)===X&&(Ie=new Ie(V,z+"enter",Se,u,te),Ie.target=Y,Ie.relatedTarget=Et,ne=Ie),Et=ne,j&&Se)t:{for(Ie=tF,V=j,z=Se,Y=0,ne=V;ne;ne=Ie(ne))Y++;ne=0;for(var xe=z;xe;xe=Ie(xe))ne++;for(;0<Y-ne;)V=Ie(V),Y--;for(;0<ne-Y;)z=Ie(z),ne--;for(;Y--;){if(V===z||z!==null&&V===z.alternate){Ie=V;break t}V=Ie(V),z=Ie(z)}Ie=null}else Ie=null;j!==null&&RR(ie,W,j,Ie,!1),Se!==null&&Et!==null&&RR(ie,Et,Se,Ie,!0)}}e:{if(W=X?pp(X):window,j=W.nodeName&&W.nodeName.toLowerCase(),j==="select"||j==="input"&&W.type==="file")var lt=$C;else if(VC(W))if(YC)lt=hU;else{lt=uU;var Te=cU}else j=W.nodeName,!j||j.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?X&&D_(X.elementType)&&(lt=$C):lt=dU;if(lt&&(lt=lt(r,X))){qC(ie,lt,u,te);break e}Te&&Te(r,W,X),r==="focusout"&&X&&W.type==="number"&&X.memoizedProps.value!=null&&M_(W,"number",W.value)}switch(Te=X?pp(X):window,r){case"focusin":(VC(Te)||Te.contentEditable==="true")&&(wd=Te,Y_=X,Ep=null);break;case"focusout":Ep=Y_=wd=null;break;case"mousedown":X_=!0;break;case"contextmenu":case"mouseup":case"dragend":X_=!1,ex(ie,u,te);break;case"selectionchange":if(pU)break;case"keydown":case"keyup":ex(ie,u,te)}var ze;if(z_)e:{switch(r){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Td?GC(r,u)&&(et="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(et="onCompositionStart");et&&(FC&&u.locale!=="ko"&&(Td||et!=="onCompositionStart"?et==="onCompositionEnd"&&Td&&(ze=kC()):(Fa=te,U_="value"in Fa?Fa.value:Fa.textContent,Td=!0)),Te=Y0(X,et),0<Te.length&&(et=new OC(et,r,null,u,te),ie.push({event:et,listeners:Te}),ze?et.data=ze:(ze=zC(u),ze!==null&&(et.data=ze)))),(ze=sU?rU(r,u):oU(r,u))&&(et=Y0(X,"onBeforeInput"),0<et.length&&(Te=new OC("onBeforeInput","beforeinput",null,u,te),ie.push({event:Te,listeners:et}),Te.data=ze)),jU(ie,r,X,u,te)}CR(ie,a)})}function Wp(r,a,u){return{instance:r,listener:a,currentTarget:u}}function Y0(r,a){for(var u=a+"Capture",p=[];r!==null;){var _=r,S=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||S===null||(_=gp(r,u),_!=null&&p.unshift(Wp(r,_,S)),_=gp(r,a),_!=null&&p.push(Wp(r,_,S))),r.tag===3)return p;r=r.return}return[]}function tF(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function RR(r,a,u,p,_){for(var S=a._reactName,x=[];u!==null&&u!==p;){var D=u,B=D.alternate,X=D.stateNode;if(D=D.tag,B!==null&&B===p)break;D!==5&&D!==26&&D!==27||X===null||(B=X,_?(X=gp(u,S),X!=null&&x.unshift(Wp(u,X,B))):_||(X=gp(u,S),X!=null&&x.push(Wp(u,X,B)))),u=u.return}x.length!==0&&r.push({event:a,listeners:x})}var nF=/\r\n?/g,iF=/\u0000|\uFFFD/g;function IR(r){return(typeof r=="string"?r:""+r).replace(nF,`
`).replace(iF,"")}function NR(r,a){return a=IR(a),IR(r)===a}function At(r,a,u,p,_,S){switch(u){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||Sd(r,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&Sd(r,""+p);break;case"className":Jy(r,"class",p);break;case"tabIndex":Jy(r,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Jy(r,u,p);break;case"style":NC(r,p,S);break;case"data":if(a!=="object"){Jy(r,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||u!=="href")){r.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=Qy(""+p),r.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(a!=="input"&&At(r,a,"name",_.name,_,null),At(r,a,"formEncType",_.formEncType,_,null),At(r,a,"formMethod",_.formMethod,_,null),At(r,a,"formTarget",_.formTarget,_,null)):(At(r,a,"encType",_.encType,_,null),At(r,a,"method",_.method,_,null),At(r,a,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=Qy(""+p),r.setAttribute(u,p);break;case"onClick":p!=null&&(r.onclick=yo);break;case"onScroll":p!=null&&Qe("scroll",r);break;case"onScrollEnd":p!=null&&Qe("scrollend",r);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":r.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){r.removeAttribute("xlink:href");break}u=Qy(""+p),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""+p):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":p===!0?r.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,p):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?r.setAttribute(u,p):r.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?r.removeAttribute(u):r.setAttribute(u,p);break;case"popover":Qe("beforetoggle",r),Qe("toggle",r),Ky(r,"popover",p);break;case"xlinkActuate":mo(r,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":mo(r,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":mo(r,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":mo(r,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":mo(r,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":mo(r,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":mo(r,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":mo(r,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":mo(r,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ky(r,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=MO.get(u)||u,Ky(r,u,p))}}function vA(r,a,u,p,_,S){switch(u){case"style":NC(r,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof p=="string"?Sd(r,p):(typeof p=="number"||typeof p=="bigint")&&Sd(r,""+p);break;case"onScroll":p!=null&&Qe("scroll",r);break;case"onScrollEnd":p!=null&&Qe("scrollend",r);break;case"onClick":p!=null&&(r.onclick=yo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!SC.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),a=u.slice(2,_?u.length-7:void 0),S=r[Ci]||null,S=S!=null?S[u]:null,typeof S=="function"&&r.removeEventListener(a,S,_),typeof p=="function")){typeof S!="function"&&S!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(a,p,_);break e}u in r?r[u]=p:p===!0?r.setAttribute(u,""):Ky(r,u,p)}}}function zn(r,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",r),Qe("load",r);var p=!1,_=!1,S;for(S in u)if(u.hasOwnProperty(S)){var x=u[S];if(x!=null)switch(S){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:At(r,a,S,x,u,null)}}_&&At(r,a,"srcSet",u.srcSet,u,null),p&&At(r,a,"src",u.src,u,null);return;case"input":Qe("invalid",r);var D=S=x=_=null,B=null,X=null;for(p in u)if(u.hasOwnProperty(p)){var te=u[p];if(te!=null)switch(p){case"name":_=te;break;case"type":x=te;break;case"checked":B=te;break;case"defaultChecked":X=te;break;case"value":S=te;break;case"defaultValue":D=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:At(r,a,p,te,u,null)}}CC(r,S,D,B,X,x,_,!1);return;case"select":Qe("invalid",r),p=x=S=null;for(_ in u)if(u.hasOwnProperty(_)&&(D=u[_],D!=null))switch(_){case"value":S=D;break;case"defaultValue":x=D;break;case"multiple":p=D;default:At(r,a,_,D,u,null)}a=S,u=x,r.multiple=!!p,a!=null?_d(r,!!p,a,!1):u!=null&&_d(r,!!p,u,!0);return;case"textarea":Qe("invalid",r),S=_=p=null;for(x in u)if(u.hasOwnProperty(x)&&(D=u[x],D!=null))switch(x){case"value":p=D;break;case"defaultValue":_=D;break;case"children":S=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:At(r,a,x,D,u,null)}RC(r,p,_,S);return;case"option":for(B in u)if(u.hasOwnProperty(B)&&(p=u[B],p!=null))switch(B){case"selected":r.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:At(r,a,B,p,u,null)}return;case"dialog":Qe("beforetoggle",r),Qe("toggle",r),Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":Qe("load",r);break;case"video":case"audio":for(p=0;p<Xp.length;p++)Qe(Xp[p],r);break;case"image":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"embed":case"source":case"link":Qe("error",r),Qe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in u)if(u.hasOwnProperty(X)&&(p=u[X],p!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:At(r,a,X,p,u,null)}return;default:if(D_(a)){for(te in u)u.hasOwnProperty(te)&&(p=u[te],p!==void 0&&vA(r,a,te,p,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(p=u[D],p!=null&&At(r,a,D,p,u,null))}function sF(r,a,u,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,S=null,x=null,D=null,B=null,X=null,te=null;for(j in u){var ie=u[j];if(u.hasOwnProperty(j)&&ie!=null)switch(j){case"checked":break;case"value":break;case"defaultValue":B=ie;default:p.hasOwnProperty(j)||At(r,a,j,null,p,ie)}}for(var W in p){var j=p[W];if(ie=u[W],p.hasOwnProperty(W)&&(j!=null||ie!=null))switch(W){case"type":S=j;break;case"name":_=j;break;case"checked":X=j;break;case"defaultChecked":te=j;break;case"value":x=j;break;case"defaultValue":D=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(137,a));break;default:j!==ie&&At(r,a,W,j,p,ie)}}N_(r,x,D,B,X,te,S,_);return;case"select":j=x=D=W=null;for(S in u)if(B=u[S],u.hasOwnProperty(S)&&B!=null)switch(S){case"value":break;case"multiple":j=B;default:p.hasOwnProperty(S)||At(r,a,S,null,p,B)}for(_ in p)if(S=p[_],B=u[_],p.hasOwnProperty(_)&&(S!=null||B!=null))switch(_){case"value":W=S;break;case"defaultValue":D=S;break;case"multiple":x=S;default:S!==B&&At(r,a,_,S,p,B)}a=D,u=x,p=j,W!=null?_d(r,!!u,W,!1):!!p!=!!u&&(a!=null?_d(r,!!u,a,!0):_d(r,!!u,u?[]:"",!1));return;case"textarea":j=W=null;for(D in u)if(_=u[D],u.hasOwnProperty(D)&&_!=null&&!p.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:At(r,a,D,null,p,_)}for(x in p)if(_=p[x],S=u[x],p.hasOwnProperty(x)&&(_!=null||S!=null))switch(x){case"value":W=_;break;case"defaultValue":j=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==S&&At(r,a,x,_,p,S)}xC(r,W,j);return;case"option":for(var Se in u)if(W=u[Se],u.hasOwnProperty(Se)&&W!=null&&!p.hasOwnProperty(Se))switch(Se){case"selected":r.selected=!1;break;default:At(r,a,Se,null,p,W)}for(B in p)if(W=p[B],j=u[B],p.hasOwnProperty(B)&&W!==j&&(W!=null||j!=null))switch(B){case"selected":r.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:At(r,a,B,W,p,j)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ie in u)W=u[Ie],u.hasOwnProperty(Ie)&&W!=null&&!p.hasOwnProperty(Ie)&&At(r,a,Ie,null,p,W);for(X in p)if(W=p[X],j=u[X],p.hasOwnProperty(X)&&W!==j&&(W!=null||j!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:At(r,a,X,W,p,j)}return;default:if(D_(a)){for(var Et in u)W=u[Et],u.hasOwnProperty(Et)&&W!==void 0&&!p.hasOwnProperty(Et)&&vA(r,a,Et,void 0,p,W);for(te in p)W=p[te],j=u[te],!p.hasOwnProperty(te)||W===j||W===void 0&&j===void 0||vA(r,a,te,W,p,j);return}}for(var V in u)W=u[V],u.hasOwnProperty(V)&&W!=null&&!p.hasOwnProperty(V)&&At(r,a,V,null,p,W);for(ie in p)W=p[ie],j=u[ie],!p.hasOwnProperty(ie)||W===j||W==null&&j==null||At(r,a,ie,W,p,j)}function MR(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rF(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var _=u[p],S=_.transferSize,x=_.initiatorType,D=_.duration;if(S&&D&&MR(x)){for(x=0,D=_.responseEnd,p+=1;p<u.length;p++){var B=u[p],X=B.startTime;if(X>D)break;var te=B.transferSize,ie=B.initiatorType;te&&MR(ie)&&(B=B.responseEnd,x+=te*(B<D?1:(D-X)/(B-X)))}if(--p,a+=8*(S+x)/(_.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var bA=null,_A=null;function X0(r){return r.nodeType===9?r:r.ownerDocument}function DR(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function kR(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function SA(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var AA=null;function oF(){var r=window.event;return r&&r.type==="popstate"?r===AA?!1:(AA=r,!0):(AA=null,!1)}var PR=typeof setTimeout=="function"?setTimeout:void 0,aF=typeof clearTimeout=="function"?clearTimeout:void 0,LR=typeof Promise=="function"?Promise:void 0,lF=typeof queueMicrotask=="function"?queueMicrotask:typeof LR<"u"?function(r){return LR.resolve(null).then(r).catch(cF)}:PR;function cF(r){setTimeout(function(){throw r})}function tl(r){return r==="head"}function OR(r,a){var u=a,p=0;do{var _=u.nextSibling;if(r.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"||u==="/&"){if(p===0){r.removeChild(_),Qd(a);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")Kp(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Kp(u);for(var S=u.firstChild;S;){var x=S.nextSibling,D=S.nodeName;S[fp]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=x}}else u==="body"&&Kp(r.ownerDocument.body);u=_}while(u);Qd(a)}function UR(r,a){var u=r;r=0;do{var p=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=p}while(u)}function EA(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":EA(u),R_(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function uF(r,a,u,p){for(;r.nodeType===1;){var _=u;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(p){if(!r[fp])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(S=r.getAttribute("rel"),S==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(S!==_.rel||r.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||r.getAttribute("title")!==(_.title==null?null:_.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(S=r.getAttribute("src"),(S!==(_.src==null?null:_.src)||r.getAttribute("type")!==(_.type==null?null:_.type)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&S&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var S=_.name==null?null:""+_.name;if(_.type==="hidden"&&r.getAttribute("name")===S)return r}else return r;if(r=Ps(r.nextSibling),r===null)break}return null}function dF(r,a,u){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Ps(r.nextSibling),r===null))return null;return r}function FR(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=Ps(r.nextSibling),r===null))return null;return r}function TA(r){return r.data==="$?"||r.data==="$~"}function wA(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function hF(r,a){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||u.readyState!=="loading")a();else{var p=function(){a(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),r._reactRetry=p}}function Ps(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var CA=null;function BR(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(a===0)return Ps(r.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}r=r.nextSibling}return null}function HR(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return r;a--}else u!=="/$"&&u!=="/&"||a++}r=r.previousSibling}return null}function GR(r,a,u){switch(a=X0(u),r){case"html":if(r=a.documentElement,!r)throw Error(n(452));return r;case"head":if(r=a.head,!r)throw Error(n(453));return r;case"body":if(r=a.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Kp(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);R_(r)}var Ls=new Map,zR=new Set;function W0(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ko=$.d;$.d={f:fF,r:pF,D:gF,C:mF,L:yF,m:vF,X:_F,S:bF,M:SF};function fF(){var r=ko.f(),a=B0();return r||a}function pF(r){var a=yd(r);a!==null&&a.tag===5&&a.type==="form"?r1(a):ko.r(r)}var Kd=typeof document>"u"?null:document;function VR(r,a,u){var p=Kd;if(p&&typeof a=="string"&&a){var _=xs(a);_='link[rel="'+r+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),zR.has(_)||(zR.add(_),r={rel:r,crossOrigin:u,href:a},p.querySelector(_)===null&&(a=p.createElement("link"),zn(a,"link",r),xn(a),p.head.appendChild(a)))}}function gF(r){ko.D(r),VR("dns-prefetch",r,null)}function mF(r,a){ko.C(r,a),VR("preconnect",r,a)}function yF(r,a,u){ko.L(r,a,u);var p=Kd;if(p&&r&&a){var _='link[rel="preload"][as="'+xs(a)+'"]';a==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+xs(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+xs(u.imageSizes)+'"]')):_+='[href="'+xs(r)+'"]';var S=_;switch(a){case"style":S=Jd(r);break;case"script":S=jd(r)}Ls.has(S)||(r=y({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:r,as:a},u),Ls.set(S,r),p.querySelector(_)!==null||a==="style"&&p.querySelector(Jp(S))||a==="script"&&p.querySelector(jp(S))||(a=p.createElement("link"),zn(a,"link",r),xn(a),p.head.appendChild(a)))}}function vF(r,a){ko.m(r,a);var u=Kd;if(u&&r){var p=a&&typeof a.as=="string"?a.as:"script",_='link[rel="modulepreload"][as="'+xs(p)+'"][href="'+xs(r)+'"]',S=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=jd(r)}if(!Ls.has(S)&&(r=y({rel:"modulepreload",href:r},a),Ls.set(S,r),u.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(jp(S)))return}p=u.createElement("link"),zn(p,"link",r),xn(p),u.head.appendChild(p)}}}function bF(r,a,u){ko.S(r,a,u);var p=Kd;if(p&&r){var _=vd(p).hoistableStyles,S=Jd(r);a=a||"default";var x=_.get(S);if(!x){var D={loading:0,preload:null};if(x=p.querySelector(Jp(S)))D.loading=5;else{r=y({rel:"stylesheet",href:r,"data-precedence":a},u),(u=Ls.get(S))&&xA(r,u);var B=x=p.createElement("link");xn(B),zn(B,"link",r),B._p=new Promise(function(X,te){B.onload=X,B.onerror=te}),B.addEventListener("load",function(){D.loading|=1}),B.addEventListener("error",function(){D.loading|=2}),D.loading|=4,K0(x,a,p)}x={type:"stylesheet",instance:x,count:1,state:D},_.set(S,x)}}}function _F(r,a){ko.X(r,a);var u=Kd;if(u&&r){var p=vd(u).hoistableScripts,_=jd(r),S=p.get(_);S||(S=u.querySelector(jp(_)),S||(r=y({src:r,async:!0},a),(a=Ls.get(_))&&RA(r,a),S=u.createElement("script"),xn(S),zn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function SF(r,a){ko.M(r,a);var u=Kd;if(u&&r){var p=vd(u).hoistableScripts,_=jd(r),S=p.get(_);S||(S=u.querySelector(jp(_)),S||(r=y({src:r,async:!0,type:"module"},a),(a=Ls.get(_))&&RA(r,a),S=u.createElement("script"),xn(S),zn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function qR(r,a,u,p){var _=(_=Ce.current)?W0(_):null;if(!_)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=Jd(u.href),u=vd(_).hoistableStyles,p=u.get(a),p||(p={type:"style",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Jd(u.href);var S=vd(_).hoistableStyles,x=S.get(r);if(x||(_=_.ownerDocument||_,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(r,x),(S=_.querySelector(Jp(r)))&&!S._p&&(x.instance=S,x.state.loading=5),Ls.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ls.set(r,u),S||AF(_,r,u,x.state))),a&&p===null)throw Error(n(528,""));return x}if(a&&p!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=jd(u),u=vd(_).hoistableScripts,p=u.get(a),p||(p={type:"script",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Jd(r){return'href="'+xs(r)+'"'}function Jp(r){return'link[rel="stylesheet"]['+r+"]"}function $R(r){return y({},r,{"data-precedence":r.precedence,precedence:null})}function AF(r,a,u,p){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=r.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),zn(a,"link",u),xn(a),r.head.appendChild(a))}function jd(r){return'[src="'+xs(r)+'"]'}function jp(r){return"script[async]"+r}function YR(r,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var p=r.querySelector('style[data-href~="'+xs(u.href)+'"]');if(p)return a.instance=p,xn(p),p;var _=y({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(r.ownerDocument||r).createElement("style"),xn(p),zn(p,"style",_),K0(p,u.precedence,r),a.instance=p;case"stylesheet":_=Jd(u.href);var S=r.querySelector(Jp(_));if(S)return a.state.loading|=4,a.instance=S,xn(S),S;p=$R(u),(_=Ls.get(_))&&xA(p,_),S=(r.ownerDocument||r).createElement("link"),xn(S);var x=S;return x._p=new Promise(function(D,B){x.onload=D,x.onerror=B}),zn(S,"link",p),a.state.loading|=4,K0(S,u.precedence,r),a.instance=S;case"script":return S=jd(u.src),(_=r.querySelector(jp(S)))?(a.instance=_,xn(_),_):(p=u,(_=Ls.get(S))&&(p=y({},u),RA(p,_)),r=r.ownerDocument||r,_=r.createElement("script"),xn(_),zn(_,"link",p),r.head.appendChild(_),a.instance=_);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,K0(p,u.precedence,r));return a.instance}function K0(r,a,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,S=_,x=0;x<p.length;x++){var D=p[x];if(D.dataset.precedence===a)S=D;else if(S!==_)break}S?S.parentNode.insertBefore(r,S.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(r,a.firstChild))}function xA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function RA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var J0=null;function XR(r,a,u){if(J0===null){var p=new Map,_=J0=new Map;_.set(u,p)}else _=J0,p=_.get(u),p||(p=new Map,_.set(u,p));if(p.has(r))return p;for(p.set(r,null),u=u.getElementsByTagName(r),_=0;_<u.length;_++){var S=u[_];if(!(S[fp]||S[Fn]||r==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var x=S.getAttribute(a)||"";x=r+x;var D=p.get(x);D?D.push(S):p.set(x,[S])}}return p}function WR(r,a,u){r=r.ownerDocument||r,r.head.insertBefore(u,a==="title"?r.querySelector("head > title"):null)}function EF(r,a,u){if(u===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function KR(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function TF(r,a,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var _=Jd(p.href),S=a.querySelector(Jp(_));if(S){a=S._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=j0.bind(r),a.then(r,r)),u.state.loading|=4,u.instance=S,xn(S);return}S=a.ownerDocument||a,p=$R(p),(_=Ls.get(_))&&xA(p,_),S=S.createElement("link"),xn(S);var x=S;x._p=new Promise(function(D,B){x.onload=D,x.onerror=B}),zn(S,"link",p),u.instance=S}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=j0.bind(r),a.addEventListener("load",u),a.addEventListener("error",u))}}var IA=0;function wF(r,a){return r.stylesheets&&r.count===0&&Z0(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var p=setTimeout(function(){if(r.stylesheets&&Z0(r,r.stylesheets),r.unsuspend){var S=r.unsuspend;r.unsuspend=null,S()}},6e4+a);0<r.imgBytes&&IA===0&&(IA=62500*rF());var _=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Z0(r,r.stylesheets),r.unsuspend)){var S=r.unsuspend;r.unsuspend=null,S()}},(r.imgBytes>IA?50:800)+a);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(p),clearTimeout(_)}}:null}function j0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Z0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Q0=null;function Z0(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Q0=new Map,a.forEach(CF,r),Q0=null,j0.call(r))}function CF(r,a){if(!(a.state.loading&4)){var u=Q0.get(r);if(u)var p=u.get(null);else{u=new Map,Q0.set(r,u);for(var _=r.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<_.length;S++){var x=_[S];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(u.set(x.dataset.precedence,x),p=x)}p&&u.set(null,p)}_=a.instance,x=_.getAttribute("data-precedence"),S=u.get(x)||p,S===p&&u.set(null,_),u.set(x,_),this.count++,p=j0.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),S?S.parentNode.insertBefore(_,S.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(_,r.firstChild)),a.state.loading|=4}}var Qp={$$typeof:k,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function xF(r,a,u,p,_,S,x,D,B){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=T_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=T_(0),this.hiddenUpdates=T_(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=S,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function JR(r,a,u,p,_,S,x,D,B,X,te,ie){return r=new xF(r,a,u,x,B,X,te,ie,D),a=1,S===!0&&(a|=24),S=Yi(3,null,null,a),r.current=S,S.stateNode=r,a=lS(),a.refCount++,r.pooledCache=a,a.refCount++,S.memoizedState={element:p,isDehydrated:u,cache:a},hS(S),r}function jR(r){return r?(r=Rd,r):Rd}function QR(r,a,u,p,_,S){_=jR(_),p.context===null?p.context=_:p.pendingContext=_,p=qa(a),p.payload={element:u},S=S===void 0?null:S,S!==null&&(p.callback=S),u=$a(r,p,a),u!==null&&(Di(u,r,a),Np(u,r,a))}function ZR(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<a?u:a}}function NA(r,a){ZR(r,a),(r=r.alternate)&&ZR(r,a)}function eI(r){if(r.tag===13||r.tag===31){var a=Ac(r,67108864);a!==null&&Di(a,r,67108864),NA(r,67108864)}}function tI(r){if(r.tag===13||r.tag===31){var a=ji();a=w_(a);var u=Ac(r,a);u!==null&&Di(u,r,a),NA(r,a)}}var ev=!0;function RF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=2,MA(r,a,u,p)}finally{$.p=S,G.T=_}}function IF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=8,MA(r,a,u,p)}finally{$.p=S,G.T=_}}function MA(r,a,u,p){if(ev){var _=DA(p);if(_===null)yA(r,a,p,tv,u),iI(r,p);else if(MF(_,r,a,u,p))p.stopPropagation();else if(iI(r,p),a&4&&-1<NF.indexOf(r)){for(;_!==null;){var S=yd(_);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var x=yc(S.pendingLanes);if(x!==0){var D=S;for(D.pendingLanes|=2,D.entangledLanes|=2;x;){var B=1<<31-Zn(x);D.entanglements[1]|=B,x&=~B}Dr(S),(dt&6)===0&&(U0=Re()+500,Yp(0))}}break;case 31:case 13:D=Ac(S,2),D!==null&&Di(D,S,2),B0(),NA(S,2)}if(S=DA(p),S===null&&yA(r,a,p,tv,u),S===_)break;_=S}_!==null&&p.stopPropagation()}else yA(r,a,p,null,u)}}function DA(r){return r=P_(r),kA(r)}var tv=null;function kA(r){if(tv=null,r=md(r),r!==null){var a=o(r);if(a===null)r=null;else{var u=a.tag;if(u===13){if(r=l(a),r!==null)return r;r=null}else if(u===31){if(r=c(a),r!==null)return r;r=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return tv=r,null}function nI(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hn()){case wi:return 2;case di:return 8;case Qn:case Rr:return 32;case qi:return 268435456;default:return 32}default:return 32}}var PA=!1,nl=null,il=null,sl=null,Zp=new Map,eg=new Map,rl=[],NF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iI(r,a){switch(r){case"focusin":case"focusout":nl=null;break;case"dragenter":case"dragleave":il=null;break;case"mouseover":case"mouseout":sl=null;break;case"pointerover":case"pointerout":Zp.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":eg.delete(a.pointerId)}}function tg(r,a,u,p,_,S){return r===null||r.nativeEvent!==S?(r={blockedOn:a,domEventName:u,eventSystemFlags:p,nativeEvent:S,targetContainers:[_]},a!==null&&(a=yd(a),a!==null&&eI(a)),r):(r.eventSystemFlags|=p,a=r.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),r)}function MF(r,a,u,p,_){switch(a){case"focusin":return nl=tg(nl,r,a,u,p,_),!0;case"dragenter":return il=tg(il,r,a,u,p,_),!0;case"mouseover":return sl=tg(sl,r,a,u,p,_),!0;case"pointerover":var S=_.pointerId;return Zp.set(S,tg(Zp.get(S)||null,r,a,u,p,_)),!0;case"gotpointercapture":return S=_.pointerId,eg.set(S,tg(eg.get(S)||null,r,a,u,p,_)),!0}return!1}function sI(r){var a=md(r.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){r.blockedOn=a,vC(r.priority,function(){tI(u)});return}}else if(a===31){if(a=c(u),a!==null){r.blockedOn=a,vC(r.priority,function(){tI(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function nv(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var u=DA(r.nativeEvent);if(u===null){u=r.nativeEvent;var p=new u.constructor(u.type,u);k_=p,u.target.dispatchEvent(p),k_=null}else return a=yd(u),a!==null&&eI(a),r.blockedOn=u,!1;a.shift()}return!0}function rI(r,a,u){nv(r)&&u.delete(a)}function DF(){PA=!1,nl!==null&&nv(nl)&&(nl=null),il!==null&&nv(il)&&(il=null),sl!==null&&nv(sl)&&(sl=null),Zp.forEach(rI),eg.forEach(rI)}function iv(r,a){r.blockedOn===a&&(r.blockedOn=null,PA||(PA=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,DF)))}var sv=null;function oI(r){sv!==r&&(sv=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){sv===r&&(sv=null);for(var a=0;a<r.length;a+=3){var u=r[a],p=r[a+1],_=r[a+2];if(typeof p!="function"){if(kA(p||u)===null)continue;break}var S=yd(u);S!==null&&(r.splice(a,3),a-=3,DS(S,{pending:!0,data:_,method:u.method,action:p},p,_))}}))}function Qd(r){function a(B){return iv(B,r)}nl!==null&&iv(nl,r),il!==null&&iv(il,r),sl!==null&&iv(sl,r),Zp.forEach(a),eg.forEach(a);for(var u=0;u<rl.length;u++){var p=rl[u];p.blockedOn===r&&(p.blockedOn=null)}for(;0<rl.length&&(u=rl[0],u.blockedOn===null);)sI(u),u.blockedOn===null&&rl.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var _=u[p],S=u[p+1],x=_[Ci]||null;if(typeof S=="function")x||oI(u);else if(x){var D=null;if(S&&S.hasAttribute("formAction")){if(_=S,x=S[Ci]||null)D=x.formAction;else if(kA(_)!==null)continue}else D=x.action;typeof D=="function"?u[p+1]=D:(u.splice(p,3),p-=3),oI(u)}}}function aI(){function r(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(x){return _=x})},focusReset:"manual",scroll:"manual"})}function a(){_!==null&&(_(),_=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,_=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),_!==null&&(_(),_=null)}}}function LA(r){this._internalRoot=r}rv.prototype.render=LA.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,p=ji();QR(u,p,r,a,null,null)},rv.prototype.unmount=LA.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;QR(r.current,2,null,r,null,null),B0(),a[gd]=null}};function rv(r){this._internalRoot=r}rv.prototype.unstable_scheduleHydration=function(r){if(r){var a=yC();r={blockedOn:null,target:r,priority:a};for(var u=0;u<rl.length&&a!==0&&a<rl[u].priority;u++);rl.splice(u,0,r),u===0&&sI(r)}};var lI=e.version;if(lI!=="19.2.4")throw Error(n(527,lI,"19.2.4"));$.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=f(a),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var kF={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ov=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ov.isDisabled&&ov.supportsFiber)try{gt=ov.inject(kF),_t=ov}catch{}}return ig.createRoot=function(r,a){if(!s(r))throw Error(n(299));var u=!1,p="",_=g1,S=m1,x=y1;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=JR(r,1,!1,null,null,u,p,null,_,S,x,aI),r[gd]=a.current,mA(r),new LA(a)},ig.hydrateRoot=function(r,a,u){if(!s(r))throw Error(n(299));var p=!1,_="",S=g1,x=m1,D=y1,B=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(B=u.formState)),a=JR(r,1,!0,a,u??null,p,_,B,S,x,D,aI),a.context=jR(null),u=a.current,p=ji(),p=w_(p),_=qa(p),_.callback=null,$a(u,_,p),u=p,a.current.lanes=u,hp(a,u),Dr(a),r[gd]=a.current,mA(r),new rv(a)},ig.version="19.2.4",ig}var bI;function YF(){if(bI)return BA.exports;bI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),BA.exports=$F(),BA.exports}var XF=YF();const WF=pw(XF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MD=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=i=>{const e=JF(i);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Z.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:l,...c},h)=>Z.createElement("svg",{ref:h,...jF,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:MD("lucide",s),...!o&&!QF(c)&&{"aria-hidden":"true"},...c},[...l.map(([f,g])=>Z.createElement(f,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=(i,e)=>{const t=Z.forwardRef(({className:n,...s},o)=>Z.createElement(ZF,{ref:o,iconNode:e,className:MD(`lucide-${KF(_I(i))}`,`lucide-${i}`,n),...s}));return t.displayName=_I(i),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],tB=Ye("arrow-left",eB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],mw=Ye("arrow-right",nB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],SI=Ye("award",iB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Sa=Ye("book-open",sB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],oB=Ye("book",rB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],DD=Ye("briefcase",aB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],kD=Ye("calendar",lB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hE=Ye("check",cB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],AI=Ye("chevron-left",uB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],fE=Ye("chevron-right",dB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],fB=Ye("circle-alert",hB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gB=Ye("circle-check-big",pB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yB=Ye("eye",mB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],bB=Ye("file-question-mark",vB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],EI=Ye("file-text",_B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],AB=Ye("gift",SB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],TB=Ye("globe",EB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],CB=Ye("heart",wB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],RB=Ye("highlighter",xB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],NB=Ye("house",IB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ac=Ye("loader-circle",MB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],PD=Ye("log-out",DB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],PB=Ye("maximize-2",kB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],TI=Ye("message-square",LB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],UB=Ye("minimize-2",OB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],pE=Ye("pen-tool",FB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],HB=Ye("pen",BB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],zB=Ye("play",GB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qB=Ye("plus",VB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],YB=Ye("quote",$B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],WB=Ye("refresh-cw",XB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],gE=Ye("search",KB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],yw=Ye("send",JB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],bs=Ye("sparkles",jB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],LD=Ye("star",QB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],VA=Ye("sticky-note",ZB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],t3=Ye("trending-up",e3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],wI=Ye("upload",n3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],OD=Ye("user",i3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],r3=Ye("wallet",s3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],yh=Ye("x",o3),av=({book:i,onClick:e,onRead:t})=>{const[n,s]=Z.useState(!1),o=i.isbn?`https://covers.openlibrary.org/b/isbn/${i.isbn}-L.jpg`:null;return T.jsxs("div",{className:"group relative flex flex-col w-full cursor-pointer",onClick:e,children:[T.jsxs("div",{className:"relative w-full aspect-[2/3] rounded-2xl overflow-hidden shadow-sm transition-all duration-500 group-hover:shadow-[0_20px_40px_-12px_rgba(0,0,0,0.15)] group-hover:-translate-y-2",children:[!n&&o?T.jsx("img",{src:o,alt:i.title,className:"w-full h-full object-cover",onError:()=>s(!0),loading:"lazy"}):T.jsxs("div",{className:"w-full h-full flex items-center justify-center relative overflow-hidden",style:{background:`linear-gradient(to bottom right, ${i.coverColor} 0%, #ffffff 150%)`},children:[T.jsx("div",{className:"absolute inset-0 opacity-10 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-black to-transparent"}),T.jsx("div",{className:"transform group-hover:scale-110 group-hover:rotate-3 transition-transform duration-700 ease-[cubic-bezier(0.34,1.56,0.64,1)]",children:T.jsx(Sa,{className:"text-black/20 w-16 h-16",strokeWidth:1.5})}),T.jsx("div",{className:"absolute bottom-4 left-4 right-4 text-center",children:T.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-black/40 mb-1",children:"Untitled"})})]}),T.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100",children:T.jsxs("button",{onClick:t,className:"bg-white/90 backdrop-blur-xl text-gray-900 px-5 py-2.5 rounded-full text-xs font-bold shadow-xl transform scale-90 group-hover:scale-100 transition-all duration-300 flex items-center gap-2 hover:bg-white",children:[T.jsx(zB,{size:12,className:"fill-current"})," READ"]})}),i.matchReason&&T.jsx("div",{className:"absolute top-2 left-2 z-10",children:T.jsxs("div",{className:"inline-flex items-center gap-1 bg-white/90 backdrop-blur-md px-2 py-1 rounded-md shadow-sm border border-white/50",children:[T.jsx(bs,{size:8,className:"text-blue-500 fill-blue-500"}),T.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wide text-gray-800",children:"Match"})]})})]}),T.jsxs("div",{className:"mt-3 space-y-1",children:[T.jsx("h3",{className:"font-serif font-bold text-gray-900 text-base leading-tight line-clamp-2 group-hover:text-blue-600 transition-colors",children:i.title}),T.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:i.author}),T.jsxs("div",{className:"flex items-center gap-3 pt-1",children:[i.reviewSnippet&&T.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:[T.jsx(t3,{size:8})," Buzz"]}),T.jsxs("div",{className:"flex items-center gap-0.5",children:[T.jsx(LD,{size:10,className:"text-yellow-400 fill-yellow-400"}),T.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:"4.8"})]})]})]})]})};var a3={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let l3,c3;function u3(){return{geminiUrl:l3,vertexUrl:c3}}function d3(i,e,t,n){var s,o;if(!(i!=null&&i.baseUrl)){const l=u3();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(o=l.geminiUrl)!==null&&o!==void 0?o:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pa{}function fe(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function v(i,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const h=i[c];if(Array.isArray(t))for(let f=0;f<h.length;f++){const g=h[f];v(g,e.slice(o+1),t[f])}else for(const f of h)v(f,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const h=i[c];v(h[0],e.slice(o+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function m(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const s=e[n];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in i){const l=i[o];return Array.isArray(l)?l.map(c=>m(c,e.slice(n+1),t)):t}else return t}else i=i[s]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function h3(i,e){for(const[t,n]of Object.entries(e)){const s=t.split("."),o=n.split("."),l=new Set;let c=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){c=h;break}if(c!==-1&&o.length>c)for(let h=c;h<o.length;h++){const f=o[h];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}mE(i,s,o,0,l)}}function mE(i,e,t,n,s){if(n>=e.length||typeof i!="object"||i===null)return;const o=e[n];if(o.endsWith("[]")){const l=o.slice(0,-2),c=i;if(l in c&&Array.isArray(c[l]))for(const h of c[l])mE(h,e,t,n+1,s)}else if(o==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const l=i,c=Object.keys(l).filter(f=>!f.startsWith("_")&&!s.has(f)),h={};for(const f of c)h[f]=l[f];for(const[f,g]of Object.entries(h)){const y=[];for(const b of t.slice(n))b==="*"?y.push(f):y.push(b);v(l,y,g)}for(const f of c)delete l[f]}}else{const l=i;o in l&&mE(l[o],e,t,n+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vw(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f3(i){const e={},t=m(i,["operationName"]);t!=null&&v(e,["operationName"],t);const n=m(i,["resourceName"]);return n!=null&&v(e,["_url","resourceName"],n),e}function p3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],m3(l)),e}function g3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],y3(l)),e}function m3(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>v3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function y3(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>b3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function v3(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],w3(t)),e}function b3(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],C3(t)),e}function _3(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function S3(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function A3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],E3(l)),e}function E3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function UD(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],T3(l)),e}function T3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function w3(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],vw(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function C3(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],vw(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var CI;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(CI||(CI={}));var xI;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(xI||(xI={}));var RI;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(RI||(RI={}));var ke;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(ke||(ke={}));var II;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(II||(II={}));var NI;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(NI||(NI={}));var MI;(function(i){i.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",i.HTTP_IN_QUERY="HTTP_IN_QUERY",i.HTTP_IN_HEADER="HTTP_IN_HEADER",i.HTTP_IN_PATH="HTTP_IN_PATH",i.HTTP_IN_BODY="HTTP_IN_BODY",i.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(MI||(MI={}));var DI;(function(i){i.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",i.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",i.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",i.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(DI||(DI={}));var kI;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(kI||(kI={}));var PI;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(PI||(PI={}));var LI;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(LI||(LI={}));var OI;(function(i){i.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH",i.MINIMAL="MINIMAL"})(OI||(OI={}));var UI;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(UI||(UI={}));var FI;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(FI||(FI={}));var BI;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(BI||(BI={}));var HI;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE",i.IMAGE_RECITATION="IMAGE_RECITATION",i.IMAGE_OTHER="IMAGE_OTHER"})(HI||(HI={}));var GI;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(GI||(GI={}));var zI;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(zI||(zI={}));var VI;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(VI||(VI={}));var qI;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(qI||(qI={}));var $I;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})($I||($I={}));var cb;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(cb||(cb={}));var YI;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(YI||(YI={}));var XI;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(XI||(XI={}));var WI;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(WI||(WI={}));var yE;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(yE||(yE={}));var KI;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V",i.TUNING_TASK_R2V="TUNING_TASK_R2V"})(KI||(KI={}));var JI;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",i.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(JI||(JI={}));var vE;(function(i){i.COLLECTION="COLLECTION"})(vE||(vE={}));var jI;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(jI||(jI={}));var QI;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(QI||(QI={}));var ZI;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(ZI||(ZI={}));var eN;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(eN||(eN={}));var tN;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(tN||(tN={}));var nN;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(nN||(nN={}));var iN;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(iN||(iN={}));var sN;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(sN||(sN={}));var rN;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(rN||(rN={}));var oN;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(oN||(oN={}));var aN;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(aN||(aN={}));var lN;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(lN||(lN={}));var cN;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(cN||(cN={}));var uN;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(uN||(uN={}));var dN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.STATE_PENDING="STATE_PENDING",i.STATE_ACTIVE="STATE_ACTIVE",i.STATE_FAILED="STATE_FAILED"})(dN||(dN={}));var hN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(hN||(hN={}));var fN;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED",i.REGISTERED="REGISTERED"})(fN||(fN={}));var pN;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(pN||(pN={}));var gN;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(gN||(gN={}));var mN;(function(i){i.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",i.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",i.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(mN||(mN={}));var yN;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.ACTIVITY_START="ACTIVITY_START",i.ACTIVITY_END="ACTIVITY_END"})(yN||(yN={}));var vN;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(vN||(vN={}));var bN;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(bN||(bN={}));var _N;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(_N||(_N={}));var SN;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(SN||(SN={}));var AN;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(AN||(AN={}));var EN;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(EN||(EN={}));var ch;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(ch||(ch={}));class bE{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class sg{get text(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const y=[];for(const b of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[A,w]of Object.entries(b))A!=="text"&&A!=="thought"&&A!=="thoughtSignature"&&(w!==null||w!==void 0)&&y.push(A);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;g=!0,f+=b.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const y of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[b,A]of Object.entries(y))b!=="inlineData"&&(A!==null||A!==void 0)&&g.push(b);y.inlineData&&typeof y.inlineData.data=="string"&&(f+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class TN{}class wN{}class x3{}class R3{}class I3{}class N3{}class CN{}class xN{}class RN{}class M3{}class ub{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new ub;let s;const o=e;return t?s=g3(o):s=p3(o),Object.assign(n,s),n}}class IN{}class NN{}class MN{}class DN{}class D3{}class k3{}class P3{}class bw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new bw,o=A3(e);return Object.assign(n,o),n}}class L3{}class O3{}class U3{}class kN{}class F3{get text(){var e,t,n;let s="",o=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[h,f]of Object.entries(c))h!=="text"&&h!=="thought"&&f!==null&&l.push(h);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;o=!0,s+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,t,n;let s="";const o=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,h]of Object.entries(l))c!=="inlineData"&&h!==null&&o.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class B3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class _w{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new _w,o=UD(e);return Object.assign(n,o),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ut(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function FD(i,e){const t=ut(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function BD(i){return Array.isArray(i)?i.map(e=>db(e)):[db(i)]}function db(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function HD(i){const e=db(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function GD(i){const e=db(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function PN(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function zD(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>PN(e)):[PN(i)]}function _E(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function LN(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function ON(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function ui(i){if(i==null)throw new Error("ContentUnion is required");return _E(i)?i:{role:"user",parts:zD(i)}}function Sw(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=ui(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=ui(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ui(t)):[ui(e)]}function js(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(LN(i)||ON(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ui(i)]}const e=[],t=[],n=_E(i[0]);for(const s of i){const o=_E(s);if(o!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(LN(s)||ON(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:zD(t)}),e}function H3(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(ke).includes(t[0].toUpperCase())?t[0].toUpperCase():ke.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(ke).includes(n.toUpperCase())?n.toUpperCase():ke.TYPE_UNSPECIFIED})}}function vh(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=i.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,i=o[1]):o[1].type==="null"&&(e.nullable=!0,i=o[0])),i.type instanceof Array&&H3(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(ke).includes(c.toUpperCase())?c.toUpperCase():ke.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=vh(c);else if(n.includes(l)){const h=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}h.push(vh(f))}e[l]=h}else if(s.includes(l)){const h={};for(const[f,g]of Object.entries(c))h[f]=vh(g);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Aw(i){return vh(i)}function Ew(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function Tw(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function sp(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=vh(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=vh(e.response));return i}function rp(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function G3(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function La(i,e){if(typeof e!="string")throw new Error("name must be a string");return G3(i,e,"cachedContents")}function VD(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function pc(i){return vw(i)}function z3(i){return i!=null&&typeof i=="object"&&"name"in i}function V3(i){return i!=null&&typeof i=="object"&&"video"in i}function q3(i){return i!=null&&typeof i=="object"&&"uri"in i}function qD(i){var e;let t;if(z3(i)&&(t=i.name),!(q3(i)&&(t=i.uri,t===void 0))&&!(V3(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function $D(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function YD(i){for(const e of["models","tunedModels","publisherModels"])if($3(i,e))return i[e];return[]}function $3(i,e){return i!==null&&typeof i=="object"&&e in i}function Y3(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function X3(i,e={}){const t=[],n=new Set;for(const s of i){const o=s.name;if(n.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);n.add(o);const l=Y3(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function XD(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(s>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function W3(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function WD(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return i;let o=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function op(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function KD(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K3(i){const e={},t=m(i,["responsesFile"]);t!=null&&v(e,["fileName"],t);const n=m(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>IH(l))),v(e,["inlinedResponses"],o)}const s=m(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["inlinedEmbedContentResponses"],o)}return e}function J3(i){const e={},t=m(i,["predictionsFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsDestination","outputUriPrefix"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigqueryDestination","outputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function j3(i){const e={},t=m(i,["format"]);t!=null&&v(e,["predictionsFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsDestination","outputUriPrefix"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigqueryDestination","outputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Tv(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata","displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["metadata","state"]);s!=null&&v(e,["state"],KD(s));const o=m(i,["metadata","createTime"]);o!=null&&v(e,["createTime"],o);const l=m(i,["metadata","endTime"]);l!=null&&v(e,["endTime"],l);const c=m(i,["metadata","updateTime"]);c!=null&&v(e,["updateTime"],c);const h=m(i,["metadata","model"]);h!=null&&v(e,["model"],h);const f=m(i,["metadata","output"]);return f!=null&&v(e,["dest"],K3(WD(f))),e}function SE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["state"]);s!=null&&v(e,["state"],KD(s));const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["createTime"]);l!=null&&v(e,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(e,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(e,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(e,["updateTime"],f);const g=m(i,["model"]);g!=null&&v(e,["model"],g);const y=m(i,["inputConfig"]);y!=null&&v(e,["src"],Q3(y));const b=m(i,["outputConfig"]);b!=null&&v(e,["dest"],J3(WD(b)));const A=m(i,["completionStats"]);return A!=null&&v(e,["completionStats"],A),e}function Q3(i){const e={},t=m(i,["instancesFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsSource","uris"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigquerySource","inputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function Z3(i,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(e,["fileName"]);n!=null&&v(t,["fileName"],n);const s=m(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>RH(i,l))),v(t,["requests","requests"],o)}return t}function eH(i){const e={},t=m(i,["format"]);t!=null&&v(e,["instancesFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsSource","uris"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigquerySource","inputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function tH(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function nH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function iH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function sH(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],rH(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function rH(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function JD(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>OH(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function oH(i,e){const t={},n=m(i,["displayName"]);if(e!==void 0&&n!=null&&v(e,["batch","displayName"],n),m(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function aH(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["dest"]);return e!==void 0&&s!=null&&v(e,["outputConfig"],j3(W3(s))),t}function UN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],Z3(i,XD(i,s)));const o=m(e,["config"]);return o!=null&&oH(o,t),t}function lH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],ut(i,n));const s=m(e,["src"]);s!=null&&v(t,["inputConfig"],eH(XD(i,s)));const o=m(e,["config"]);return o!=null&&aH(o,t),t}function cH(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["batch","displayName"],n),t}function uH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],yH(i,s));const o=m(e,["config"]);return o!=null&&cH(o,t),t}function dH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function hH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function fH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function pH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function gH(i,e){const t={},n=m(e,["contents"]);if(n!=null){let o=Sw(i,n);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["requests[]","request","content"],o)}const s=m(e,["config"]);return s!=null&&(v(t,["_self"],mH(s,t)),h3(t,{"requests[].*":"requests[].request.*"})),t}function mH(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function yH(i,e){const t={},n=m(e,["fileName"]);n!=null&&v(t,["file_name"],n);const s=m(e,["inlinedRequests"]);return s!=null&&v(t,["requests"],gH(i,s)),t}function vH(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function bH(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _H(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function SH(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],JD(ui(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Aw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let le=k;Array.isArray(le)&&(le=le.map(ue=>UH(ue))),v(t,["safetySettings"],le)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let le=rp(L);Array.isArray(le)&&(le=le.map(ue=>BH(sp(ue)))),v(t,["tools"],le)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],FH(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=m(e,["cachedContent"]);t!==void 0&&U!=null&&v(t,["cachedContent"],La(i,U));const F=m(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],Ew(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=m(e,["thinkingConfig"]);Q!=null&&v(n,["thinkingConfig"],Q);const ee=m(e,["imageConfig"]);ee!=null&&v(n,["imageConfig"],xH(ee));const se=m(e,["enableEnhancedCivicAnswers"]);if(se!=null&&v(n,["enableEnhancedCivicAnswers"],se),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function AH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>sH(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function EH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function TH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],op(i,n)),t}function wH(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function CH(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function xH(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function RH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["request","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let c=js(s);Array.isArray(c)&&(c=c.map(h=>JD(h))),v(t,["request","contents"],c)}const o=m(e,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(e,["config"]);return l!=null&&v(t,["request","generationConfig"],SH(i,l,m(t,["request"],{}))),t}function IH(i){const e={},t=m(i,["response"]);t!=null&&v(e,["response"],AH(t));const n=m(i,["error"]);return n!=null&&v(e,["error"],n),e}function NH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);if(e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),m(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function MH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);e!==void 0&&s!=null&&v(e,["_query","pageToken"],s);const o=m(i,["filter"]);return e!==void 0&&o!=null&&v(e,["_query","filter"],o),t}function DH(i){const e={},t=m(i,["config"]);return t!=null&&NH(t,e),e}function kH(i){const e={},t=m(i,["config"]);return t!=null&&MH(t,e),e}function PH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Tv(l))),v(e,["batchJobs"],o)}return e}function LH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>SE(l))),v(e,["batchJobs"],o)}return e}function OH(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],vH(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],bH(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],tH(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function UH(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function FH(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],_H(n)),e}function BH(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],wH(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],CH(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ca;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",i.PAGED_ITEM_DOCUMENTS="documents"})(Ca||(Ca={}));class ud{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HH extends Pa{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ud(Ca.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=UN(this.apiClient,e),n=t._url,s=fe("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,h=c.requests,f=[];for(const g of h){const y=Object.assign({},g);if(y.systemInstruction){const b=y.systemInstruction;delete y.systemInstruction;const A=y.request;A.systemInstruction=b,y.request=A}f.push(y)}return c.requests=f,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),n.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?n.dest=`${o.slice(0,-6)}/dest`:n.dest=`${o}_dest_${s}`;else if(l)n.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=lH(this.apiClient,e);return c=fe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>SE(g))}else{const f=UN(this.apiClient,e);return c=fe("{model}:batchGenerateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>Tv(g))}}async createEmbeddingsInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=uH(this.apiClient,e);return o=fe("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>Tv(h))}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=TH(this.apiClient,e);return c=fe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>SE(g))}else{const f=EH(this.apiClient,e);return c=fe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>Tv(g))}}async cancel(e){var t,n,s,o;let l="",c={};if(this.apiClient.isVertexAI()){const h=iH(this.apiClient,e);l=fe("batchPredictionJobs/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const h=nH(this.apiClient,e);l=fe("batches/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=kH(e);return c=fe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=LH(g),b=new kN;return Object.assign(b,y),b})}else{const f=DH(e);return c=fe("batches",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=PH(g),b=new kN;return Object.assign(b,y),b})}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=hH(this.apiClient,e);return c=fe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>pH(g))}else{const f=dH(this.apiClient,e);return c=fe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>fH(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GH(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function FN(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>u4(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function zH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let g=js(l);Array.isArray(g)&&(g=g.map(y=>FN(y))),v(e,["contents"],g)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],FN(ui(c)));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>h4(y))),v(e,["tools"],g)}const f=m(i,["toolConfig"]);if(e!==void 0&&f!=null&&v(e,["toolConfig"],d4(f)),m(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function VH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let y=js(l);Array.isArray(y)&&(y=y.map(b=>b)),v(e,["contents"],y)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],ui(c));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let y=h;Array.isArray(y)&&(y=y.map(b=>f4(b))),v(e,["tools"],y)}const f=m(i,["toolConfig"]);e!==void 0&&f!=null&&v(e,["toolConfig"],f);const g=m(i,["kmsKeyName"]);return e!==void 0&&g!=null&&v(e,["encryption_spec","kmsKeyName"],g),t}function qH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],FD(i,n));const s=m(e,["config"]);return s!=null&&zH(s,t),t}function $H(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],FD(i,n));const s=m(e,["config"]);return s!=null&&VH(s,t),t}function YH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],La(i,n)),t}function XH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],La(i,n)),t}function WH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function KH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function JH(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function jH(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function QH(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ZH(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function e4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],La(i,n)),t}function t4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],La(i,n)),t}function n4(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function i4(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function s4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function r4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function o4(i){const e={},t=m(i,["config"]);return t!=null&&s4(t,e),e}function a4(i){const e={},t=m(i,["config"]);return t!=null&&r4(t,e),e}function l4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function c4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function u4(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],JH(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],jH(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],GH(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function d4(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],QH(n)),e}function h4(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],n4(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],i4(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function f4(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>ZH(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function p4(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function g4(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function m4(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],La(i,n));const s=m(e,["config"]);return s!=null&&p4(s,t),t}function y4(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],La(i,n));const s=m(e,["config"]);return s!=null&&g4(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class v4 extends Pa{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ud(Ca.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=$H(this.apiClient,e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=qH(this.apiClient,e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=t4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=e4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=XH(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=KH(g),b=new MN;return Object.assign(b,y),b})}else{const f=YH(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=WH(g),b=new MN;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=y4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=m4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=a4(e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=c4(g),b=new DN;return Object.assign(b,y),b})}else{const f=o4(e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=l4(g),b=new DN;return Object.assign(b,y),b})}}}function hb(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function BN(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pe(i){return this instanceof Pe?(this.v=i,this):new Pe(i)}function Ar(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(A){return function(w){return Promise.resolve(w).then(A,y)}}function c(A,w){n[A]&&(s[A]=function(C){return new Promise(function(N,I){o.push([A,C,N,I])>1||h(A,C)})},w&&(s[A]=w(s[A])))}function h(A,w){try{f(n[A](w))}catch(C){b(o[0][3],C)}}function f(A){A.value instanceof Pe?Promise.resolve(A.value.v).then(g,y):b(o[0][2],A)}function g(A){h("next",A)}function y(A){h("throw",A)}function b(A,w){A(w),o.shift(),o.length&&h(o[0][0],o[0][1])}}function Er(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof BN=="function"?BN(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=i[o]&&function(l){return new Promise(function(c,h){l=i[o](l),s(c,h,l.done,l.value)})}}function s(o,l,c,h){Promise.resolve(h).then(function(f){o({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b4(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:jD(t)}function jD(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function _4(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function HN(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let o=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),o&&!jD(i[n])&&(o=!1),n++;o?e.push(...s):e.pop()}return e}class S4{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new A4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class A4{constructor(e,t,n,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),_4(o)}async sendMessage(e){var t;await this.sendPromise;const n=ui(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,c;const h=await s,f=(l=(o=h.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,g=h.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let b=[];g!=null&&(b=(c=g.slice(y))!==null&&c!==void 0?c:[]);const A=f?[f]:[];this.recordHistory(n,A,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=ui(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,n)}getHistory(e=!1){const t=e?HN(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Ar(this,arguments,function*(){var s,o,l,c,h,f;const g=[];try{for(var y=!0,b=Er(e),A;A=yield Pe(b.next()),s=A.done,!s;y=!0){c=A.value,y=!1;const w=c;if(b4(w)){const C=(f=(h=w.candidates)===null||h===void 0?void 0:h[0])===null||f===void 0?void 0:f.content;C!==void 0&&g.push(C)}yield yield Pe(w)}}catch(w){o={error:w}}finally{try{!y&&!s&&(l=b.return)&&(yield Pe(l.call(b)))}finally{if(o)throw o.error}}this.recordHistory(t,g)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(o=>o.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...HN(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fg extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Fg.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E4(i){const e={},t=m(i,["file"]);return t!=null&&v(e,["file"],t),e}function T4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function w4(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],qD(t)),e}function C4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function x4(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],qD(t)),e}function R4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function I4(i){const e={},t=m(i,["config"]);return t!=null&&R4(t,e),e}function N4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M4 extends Pa{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ud(Ca.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=I4(e);return o=fe("files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=N4(h),g=new L3;return Object.assign(g,f),g})}}async createInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=E4(e);return o=fe("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=T4(h),g=new O3;return Object.assign(g,f),g})}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=x4(e);return o=fe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=w4(e);return o=fe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=C4(h),g=new U3;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wv(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function D4(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>W4(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function k4(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function P4(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function L4(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function O4(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const C=m(i,["responseSchema"]);C!=null&&v(e,["responseSchema"],C);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const U=m(i,["topK"]);U!=null&&v(e,["topK"],U);const F=m(i,["topP"]);if(F!=null&&v(e,["topP"],F),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function U4(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function F4(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function B4(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Tw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],D4(ui(w)));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let U=rp(C);Array.isArray(U)&&(U=U.map(F=>J4(sp(F)))),v(e,["setup","tools"],U)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],K4(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function H4(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],O4(n));const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Tw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],ui(w));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let F=rp(C);Array.isArray(F)&&(F=F.map(K=>j4(sp(K)))),v(e,["setup","tools"],F)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],N);const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);e!==void 0&&O!=null&&v(e,["setup","proactivity"],O);const U=m(i,["explicitVadSignal"]);return e!==void 0&&U!=null&&v(e,["setup","explicitVadSignal"],U),t}function G4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ut(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],B4(s,t)),t}function z4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ut(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],H4(s,t)),t}function V4(i){const e={},t=m(i,["musicGenerationConfig"]);return t!=null&&v(e,["musicGenerationConfig"],t),e}function q4(i){const e={},t=m(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["weightedPrompts"],n)}return e}function $4(i){const e={},t=m(i,["media"]);if(t!=null){let f=BD(t);Array.isArray(f)&&(f=f.map(g=>wv(g))),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],wv(GD(n)));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],wv(HD(o)));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function Y4(i){const e={},t=m(i,["media"]);if(t!=null){let f=BD(t);Array.isArray(f)&&(f=f.map(g=>g)),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],GD(n));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],HD(o));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function X4(i){const e={},t=m(i,["setupComplete"]);t!=null&&v(e,["setupComplete"],t);const n=m(i,["serverContent"]);n!=null&&v(e,["serverContent"],n);const s=m(i,["toolCall"]);s!=null&&v(e,["toolCall"],s);const o=m(i,["toolCallCancellation"]);o!=null&&v(e,["toolCallCancellation"],o);const l=m(i,["usageMetadata"]);l!=null&&v(e,["usageMetadata"],Q4(l));const c=m(i,["goAway"]);c!=null&&v(e,["goAway"],c);const h=m(i,["sessionResumptionUpdate"]);h!=null&&v(e,["sessionResumptionUpdate"],h);const f=m(i,["voiceActivityDetectionSignal"]);f!=null&&v(e,["voiceActivityDetectionSignal"],f);const g=m(i,["voiceActivity"]);return g!=null&&v(e,["voiceActivity"],Z4(g)),e}function W4(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],k4(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],P4(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],wv(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function K4(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function J4(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],U4(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],F4(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function j4(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>L4(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function Q4(i){const e={},t=m(i,["promptTokenCount"]);t!=null&&v(e,["promptTokenCount"],t);const n=m(i,["cachedContentTokenCount"]);n!=null&&v(e,["cachedContentTokenCount"],n);const s=m(i,["candidatesTokenCount"]);s!=null&&v(e,["responseTokenCount"],s);const o=m(i,["toolUsePromptTokenCount"]);o!=null&&v(e,["toolUsePromptTokenCount"],o);const l=m(i,["thoughtsTokenCount"]);l!=null&&v(e,["thoughtsTokenCount"],l);const c=m(i,["totalTokenCount"]);c!=null&&v(e,["totalTokenCount"],c);const h=m(i,["promptTokensDetails"]);if(h!=null){let A=h;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["promptTokensDetails"],A)}const f=m(i,["cacheTokensDetails"]);if(f!=null){let A=f;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["cacheTokensDetails"],A)}const g=m(i,["candidatesTokensDetails"]);if(g!=null){let A=g;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["responseTokensDetails"],A)}const y=m(i,["toolUsePromptTokensDetails"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["toolUsePromptTokensDetails"],A)}const b=m(i,["trafficType"]);return b!=null&&v(e,["trafficType"],b),e}function Z4(i){const e={},t=m(i,["type"]);return t!=null&&v(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e5(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function t5(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],n5(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function n5(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function i5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let o=js(s);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["contents"],o)}return t}function s5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["tokensInfo"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["tokensInfo"],s)}return e}function r5(i){const e={},t=m(i,["values"]);t!=null&&v(e,["values"],t);const n=m(i,["statistics"]);return n!=null&&v(e,["statistics"],o5(n)),e}function o5(i){const e={},t=m(i,["truncated"]);t!=null&&v(e,["truncated"],t);const n=m(i,["token_count"]);return n!=null&&v(e,["tokenCount"],n),e}function t_(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>g6(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function a5(i){const e={},t=m(i,["controlType"]);t!=null&&v(e,["controlType"],t);const n=m(i,["enableControlImageComputation"]);return n!=null&&v(e,["computeControl"],n),e}function l5(i){const e={};if(m(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function c5(i,e){const t={},n=m(i,["systemInstruction"]);e!==void 0&&n!=null&&v(e,["systemInstruction"],ui(n));const s=m(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>tk(c))),v(e,["tools"],l)}const o=m(i,["generationConfig"]);return e!==void 0&&o!=null&&v(e,["generationConfig"],e6(o)),t}function u5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let l=js(s);Array.isArray(l)&&(l=l.map(c=>t_(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&l5(o),t}function d5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let l=js(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&c5(o,t),t}function h5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);n!=null&&v(e,["totalTokens"],n);const s=m(i,["cachedContentTokenCount"]);return s!=null&&v(e,["cachedContentTokenCount"],s),e}function f5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);return n!=null&&v(e,["totalTokens"],n),e}function p5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ut(i,n)),t}function g5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ut(i,n)),t}function m5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function y5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function v5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const C=m(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&v(e,["parameters","outputOptions","compressionQuality"],C);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["editMode"]);e!==void 0&&P!=null&&v(e,["parameters","editMode"],P);const k=m(i,["baseSteps"]);return e!==void 0&&k!=null&&v(e,["parameters","editConfig","baseSteps"],k),t}function b5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["referenceImages"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>S6(h))),v(t,["instances[0]","referenceImages"],c)}const l=m(e,["config"]);return l!=null&&v5(l,t),t}function _5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>n_(o))),v(e,["generatedImages"],s)}return e}function S5(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function A5(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["instances[]","task_type"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["instances[]","title"],s);const o=m(i,["outputDimensionality"]);e!==void 0&&o!=null&&v(e,["parameters","outputDimensionality"],o);const l=m(i,["mimeType"]);e!==void 0&&l!=null&&v(e,["instances[]","mimeType"],l);const c=m(i,["autoTruncate"]);return e!==void 0&&c!=null&&v(e,["parameters","autoTruncate"],c),t}function E5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let c=Sw(i,s);Array.isArray(c)&&(c=c.map(h=>h)),v(t,["requests[]","content"],c)}const o=m(e,["config"]);o!=null&&S5(o,t);const l=m(e,["model"]);return l!==void 0&&v(t,["requests[]","model"],ut(i,l)),t}function T5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let l=Sw(i,s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["instances[]","content"],l)}const o=m(e,["config"]);return o!=null&&A5(o,t),t}function w5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function C5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>r5(l))),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function x5(i){const e={},t=m(i,["endpoint"]);t!=null&&v(e,["name"],t);const n=m(i,["deployedModelId"]);return n!=null&&v(e,["deployedModelId"],n),e}function R5(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function I5(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function N5(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function M5(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function D5(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],t_(ui(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Aw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let le=k;Array.isArray(le)&&(le=le.map(ue=>A6(ue))),v(t,["safetySettings"],le)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let le=rp(L);Array.isArray(le)&&(le=le.map(ue=>I6(sp(ue)))),v(t,["tools"],le)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],R6(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=m(e,["cachedContent"]);t!==void 0&&U!=null&&v(t,["cachedContent"],La(i,U));const F=m(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],Ew(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=m(e,["thinkingConfig"]);Q!=null&&v(n,["thinkingConfig"],Q);const ee=m(e,["imageConfig"]);ee!=null&&v(n,["imageConfig"],r6(ee));const se=m(e,["enableEnhancedCivicAnswers"]);if(se!=null&&v(n,["enableEnhancedCivicAnswers"],se),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function k5(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],ui(s));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Aw(I));const P=m(e,["responseJsonSchema"]);P!=null&&v(n,["responseJsonSchema"],P);const k=m(e,["routingConfig"]);k!=null&&v(n,["routingConfig"],k);const L=m(e,["modelSelectionConfig"]);L!=null&&v(n,["modelConfig"],L);const O=m(e,["safetySettings"]);if(t!==void 0&&O!=null){let $=O;Array.isArray($)&&($=$.map(oe=>oe)),v(t,["safetySettings"],$)}const U=m(e,["tools"]);if(t!==void 0&&U!=null){let $=rp(U);Array.isArray($)&&($=$.map(oe=>tk(sp(oe)))),v(t,["tools"],$)}const F=m(e,["toolConfig"]);t!==void 0&&F!=null&&v(t,["toolConfig"],F);const K=m(e,["labels"]);t!==void 0&&K!=null&&v(t,["labels"],K);const q=m(e,["cachedContent"]);t!==void 0&&q!=null&&v(t,["cachedContent"],La(i,q));const Q=m(e,["responseModalities"]);Q!=null&&v(n,["responseModalities"],Q);const ee=m(e,["mediaResolution"]);ee!=null&&v(n,["mediaResolution"],ee);const se=m(e,["speechConfig"]);se!=null&&v(n,["speechConfig"],Ew(se));const le=m(e,["audioTimestamp"]);le!=null&&v(n,["audioTimestamp"],le);const ue=m(e,["thinkingConfig"]);ue!=null&&v(n,["thinkingConfig"],ue);const me=m(e,["imageConfig"]);if(me!=null&&v(n,["imageConfig"],o6(me)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const G=m(e,["modelArmorConfig"]);return t!==void 0&&G!=null&&v(t,["modelArmorConfig"],G),n}function GN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let l=js(s);Array.isArray(l)&&(l=l.map(c=>t_(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],D5(i,o,t)),t}function zN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["contents"]);if(s!=null){let l=js(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],k5(i,o,t)),t}function VN(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>t5(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function qN(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>g)),v(e,["candidates"],f)}const s=m(i,["createTime"]);s!=null&&v(e,["createTime"],s);const o=m(i,["modelVersion"]);o!=null&&v(e,["modelVersion"],o);const l=m(i,["promptFeedback"]);l!=null&&v(e,["promptFeedback"],l);const c=m(i,["responseId"]);c!=null&&v(e,["responseId"],c);const h=m(i,["usageMetadata"]);return h!=null&&v(e,["usageMetadata"],h),e}function P5(i,e){const t={};if(m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["aspectRatio"]);e!==void 0&&s!=null&&v(e,["parameters","aspectRatio"],s);const o=m(i,["guidanceScale"]);if(e!==void 0&&o!=null&&v(e,["parameters","guidanceScale"],o),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&v(e,["parameters","safetySetting"],l);const c=m(i,["personGeneration"]);e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c);const h=m(i,["includeSafetyAttributes"]);e!==void 0&&h!=null&&v(e,["parameters","includeSafetyAttributes"],h);const f=m(i,["includeRaiReason"]);e!==void 0&&f!=null&&v(e,["parameters","includeRaiReason"],f);const g=m(i,["language"]);e!==void 0&&g!=null&&v(e,["parameters","language"],g);const y=m(i,["outputMimeType"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","mimeType"],y);const b=m(i,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&v(e,["parameters","outputOptions","compressionQuality"],b),m(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=m(i,["imageSize"]);if(e!==void 0&&A!=null&&v(e,["parameters","sampleImageSize"],A),m(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function L5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const C=m(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&v(e,["parameters","outputOptions","compressionQuality"],C);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["imageSize"]);e!==void 0&&P!=null&&v(e,["parameters","sampleImageSize"],P);const k=m(i,["enhancePrompt"]);return e!==void 0&&k!=null&&v(e,["parameters","enhancePrompt"],k),t}function O5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&P5(o,t),t}function U5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&L5(o,t),t}function F5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>J5(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],ZD(s)),e}function B5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>n_(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],ek(s)),e}function H5(i,e){const t={},n=m(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n),m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=m(i,["durationSeconds"]);if(e!==void 0&&s!=null&&v(e,["parameters","durationSeconds"],s),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(i,["aspectRatio"]);e!==void 0&&o!=null&&v(e,["parameters","aspectRatio"],o);const l=m(i,["resolution"]);e!==void 0&&l!=null&&v(e,["parameters","resolution"],l);const c=m(i,["personGeneration"]);if(e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c),m(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(i,["negativePrompt"]);e!==void 0&&h!=null&&v(e,["parameters","negativePrompt"],h);const f=m(i,["enhancePrompt"]);if(e!==void 0&&f!=null&&v(e,["parameters","enhancePrompt"],f),m(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const g=m(i,["lastFrame"]);e!==void 0&&g!=null&&v(e,["instances[0]","lastFrame"],i_(g));const y=m(i,["referenceImages"]);if(e!==void 0&&y!=null){let b=y;Array.isArray(b)&&(b=b.map(A=>z6(A))),v(e,["instances[0]","referenceImages"],b)}if(m(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function G5(i,e){const t={},n=m(i,["numberOfVideos"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const o=m(i,["fps"]);e!==void 0&&o!=null&&v(e,["parameters","fps"],o);const l=m(i,["durationSeconds"]);e!==void 0&&l!=null&&v(e,["parameters","durationSeconds"],l);const c=m(i,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const h=m(i,["aspectRatio"]);e!==void 0&&h!=null&&v(e,["parameters","aspectRatio"],h);const f=m(i,["resolution"]);e!==void 0&&f!=null&&v(e,["parameters","resolution"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["pubsubTopic"]);e!==void 0&&y!=null&&v(e,["parameters","pubsubTopic"],y);const b=m(i,["negativePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","negativePrompt"],b);const A=m(i,["enhancePrompt"]);e!==void 0&&A!=null&&v(e,["parameters","enhancePrompt"],A);const w=m(i,["generateAudio"]);e!==void 0&&w!=null&&v(e,["parameters","generateAudio"],w);const C=m(i,["lastFrame"]);e!==void 0&&C!=null&&v(e,["instances[0]","lastFrame"],xr(C));const N=m(i,["referenceImages"]);if(e!==void 0&&N!=null){let k=N;Array.isArray(k)&&(k=k.map(L=>V6(L))),v(e,["instances[0]","referenceImages"],k)}const I=m(i,["mask"]);e!==void 0&&I!=null&&v(e,["instances[0]","mask"],G6(I));const P=m(i,["compressionQuality"]);return e!==void 0&&P!=null&&v(e,["parameters","compressionQuality"],P),t}function z5(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],Y5(l)),e}function V5(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],X5(l)),e}function q5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],i_(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],nk(l));const c=m(e,["source"]);c!=null&&W5(c,t);const h=m(e,["config"]);return h!=null&&H5(h,t),t}function $5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],xr(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],ik(l));const c=m(e,["source"]);c!=null&&K5(c,t);const h=m(e,["config"]);return h!=null&&G5(h,t),t}function Y5(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Q5(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function X5(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Z5(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function W5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],i_(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],nk(o)),t}function K5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],xr(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],ik(o)),t}function J5(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],a6(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);return s!=null&&v(e,["safetyAttributes"],ZD(s)),e}function n_(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],QD(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);s!=null&&v(e,["safetyAttributes"],ek(s));const o=m(i,["prompt"]);return o!=null&&v(e,["enhancedPrompt"],o),e}function j5(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["mask"],QD(t));const n=m(i,["labels"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["labels"],s)}return e}function Q5(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],B6(t)),e}function Z5(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],H6(t)),e}function e6(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const C=m(i,["responseSchema"]);C!=null&&v(e,["responseSchema"],C);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const U=m(i,["topK"]);U!=null&&v(e,["topK"],U);const F=m(i,["topP"]);if(F!=null&&v(e,["topP"],F),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function t6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ut(i,n)),t}function n6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ut(i,n)),t}function i6(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function s6(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function r6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function o6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);n!=null&&v(e,["imageSize"],n);const s=m(i,["personGeneration"]);s!=null&&v(e,["personGeneration"],s);const o=m(i,["outputMimeType"]);o!=null&&v(e,["imageOutputOptions","mimeType"],o);const l=m(i,["outputCompressionQuality"]);return l!=null&&v(e,["imageOutputOptions","compressionQuality"],l),e}function a6(i){const e={},t=m(i,["bytesBase64Encoded"]);t!=null&&v(e,["imageBytes"],pc(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function QD(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],pc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function i_(i){const e={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(i,["imageBytes"]);t!=null&&v(e,["bytesBase64Encoded"],pc(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function xr(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],pc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function l6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],$D(i,c)),n}function c6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],$D(i,c)),n}function u6(i,e){const t={},n=m(e,["config"]);return n!=null&&l6(i,n,t),t}function d6(i,e){const t={},n=m(e,["config"]);return n!=null&&c6(i,n,t),t}function h6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=YD(s);Array.isArray(o)&&(o=o.map(l=>AE(l))),v(e,["models"],o)}return e}function f6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=YD(s);Array.isArray(o)&&(o=o.map(l=>EE(l))),v(e,["models"],o)}return e}function p6(i){const e={},t=m(i,["maskMode"]);t!=null&&v(e,["maskMode"],t);const n=m(i,["segmentationClasses"]);n!=null&&v(e,["maskClasses"],n);const s=m(i,["maskDilation"]);return s!=null&&v(e,["dilation"],s),e}function AE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["version"]);o!=null&&v(e,["version"],o);const l=m(i,["_self"]);l!=null&&v(e,["tunedModelInfo"],N6(l));const c=m(i,["inputTokenLimit"]);c!=null&&v(e,["inputTokenLimit"],c);const h=m(i,["outputTokenLimit"]);h!=null&&v(e,["outputTokenLimit"],h);const f=m(i,["supportedGenerationMethods"]);f!=null&&v(e,["supportedActions"],f);const g=m(i,["temperature"]);g!=null&&v(e,["temperature"],g);const y=m(i,["maxTemperature"]);y!=null&&v(e,["maxTemperature"],y);const b=m(i,["topP"]);b!=null&&v(e,["topP"],b);const A=m(i,["topK"]);A!=null&&v(e,["topK"],A);const w=m(i,["thinking"]);return w!=null&&v(e,["thinking"],w),e}function EE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["versionId"]);o!=null&&v(e,["version"],o);const l=m(i,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>x5(b))),v(e,["endpoints"],y)}const c=m(i,["labels"]);c!=null&&v(e,["labels"],c);const h=m(i,["_self"]);h!=null&&v(e,["tunedModelInfo"],M6(h));const f=m(i,["defaultCheckpointId"]);f!=null&&v(e,["defaultCheckpointId"],f);const g=m(i,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(b=>b)),v(e,["checkpoints"],y)}return e}function g6(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],R5(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],I5(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],e5(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function m6(i){const e={},t=m(i,["productImage"]);return t!=null&&v(e,["image"],xr(t)),e}function y6(i,e){const t={},n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["baseSteps"]);e!==void 0&&s!=null&&v(e,["parameters","baseSteps"],s);const o=m(i,["outputGcsUri"]);e!==void 0&&o!=null&&v(e,["parameters","storageUri"],o);const l=m(i,["seed"]);e!==void 0&&l!=null&&v(e,["parameters","seed"],l);const c=m(i,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const h=m(i,["personGeneration"]);e!==void 0&&h!=null&&v(e,["parameters","personGeneration"],h);const f=m(i,["addWatermark"]);e!==void 0&&f!=null&&v(e,["parameters","addWatermark"],f);const g=m(i,["outputMimeType"]);e!==void 0&&g!=null&&v(e,["parameters","outputOptions","mimeType"],g);const y=m(i,["outputCompressionQuality"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","compressionQuality"],y);const b=m(i,["enhancePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","enhancePrompt"],b);const A=m(i,["labels"]);return e!==void 0&&A!=null&&v(e,["labels"],A),t}function v6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["source"]);s!=null&&_6(s,t);const o=m(e,["config"]);return o!=null&&y6(o,t),t}function b6(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>n_(s))),v(e,["generatedImages"],n)}return e}function _6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["personImage"]);e!==void 0&&s!=null&&v(e,["instances[0]","personImage","image"],xr(s));const o=m(i,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>m6(c))),v(e,["instances[0]","productImages"],l)}return t}function S6(i){const e={},t=m(i,["referenceImage"]);t!=null&&v(e,["referenceImage"],xr(t));const n=m(i,["referenceId"]);n!=null&&v(e,["referenceId"],n);const s=m(i,["referenceType"]);s!=null&&v(e,["referenceType"],s);const o=m(i,["maskImageConfig"]);o!=null&&v(e,["maskImageConfig"],p6(o));const l=m(i,["controlImageConfig"]);l!=null&&v(e,["controlImageConfig"],a5(l));const c=m(i,["styleImageConfig"]);c!=null&&v(e,["styleImageConfig"],c);const h=m(i,["subjectImageConfig"]);return h!=null&&v(e,["subjectImageConfig"],h),e}function ZD(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function ek(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function A6(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function E6(i){const e={},t=m(i,["image"]);return t!=null&&v(e,["image"],xr(t)),e}function T6(i,e){const t={},n=m(i,["mode"]);e!==void 0&&n!=null&&v(e,["parameters","mode"],n);const s=m(i,["maxPredictions"]);e!==void 0&&s!=null&&v(e,["parameters","maxPredictions"],s);const o=m(i,["confidenceThreshold"]);e!==void 0&&o!=null&&v(e,["parameters","confidenceThreshold"],o);const l=m(i,["maskDilation"]);e!==void 0&&l!=null&&v(e,["parameters","maskDilation"],l);const c=m(i,["binaryColorThreshold"]);e!==void 0&&c!=null&&v(e,["parameters","binaryColorThreshold"],c);const h=m(i,["labels"]);return e!==void 0&&h!=null&&v(e,["labels"],h),t}function w6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["source"]);s!=null&&x6(s,t);const o=m(e,["config"]);return o!=null&&T6(o,t),t}function C6(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>j5(s))),v(e,["generatedMasks"],n)}return e}function x6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],xr(s));const o=m(i,["scribbleImage"]);return e!==void 0&&o!=null&&v(e,["instances[0]","scribble"],E6(o)),t}function R6(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],N5(n)),e}function I6(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],i6(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],s6(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function tk(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>M5(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function N6(i){const e={},t=m(i,["baseModel"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function M6(i){const e={},t=m(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function D6(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function k6(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function P6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","name"],ut(i,n));const s=m(e,["config"]);return s!=null&&D6(s,t),t}function L6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["config"]);return s!=null&&k6(s,t),t}function O6(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["safetyFilterLevel"]);e!==void 0&&s!=null&&v(e,["parameters","safetySetting"],s);const o=m(i,["personGeneration"]);e!==void 0&&o!=null&&v(e,["parameters","personGeneration"],o);const l=m(i,["includeRaiReason"]);e!==void 0&&l!=null&&v(e,["parameters","includeRaiReason"],l);const c=m(i,["outputMimeType"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","mimeType"],c);const h=m(i,["outputCompressionQuality"]);e!==void 0&&h!=null&&v(e,["parameters","outputOptions","compressionQuality"],h);const f=m(i,["enhanceInputImage"]);e!==void 0&&f!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=m(i,["imagePreservationFactor"]);e!==void 0&&g!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["numberOfImages"]);e!==void 0&&b!=null&&v(e,["parameters","sampleCount"],b);const A=m(i,["mode"]);return e!==void 0&&A!=null&&v(e,["parameters","mode"],A),t}function U6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ut(i,n));const s=m(e,["image"]);s!=null&&v(t,["instances[0]","image"],xr(s));const o=m(e,["upscaleFactor"]);o!=null&&v(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=m(e,["config"]);return l!=null&&O6(l,t),t}function F6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>n_(o))),v(e,["generatedImages"],s)}return e}function B6(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],pc(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function H6(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],pc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function G6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["_self"],xr(t));const n=m(i,["maskMode"]);return n!=null&&v(e,["maskMode"],n),e}function z6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],i_(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function V6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],xr(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function nk(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["encodedVideo"],pc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["encoding"],s),e}function ik(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["bytesBase64Encoded"],pc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q6(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["displayName"],n),t}function $6(i){const e={},t=m(i,["config"]);return t!=null&&q6(t,e),e}function Y6(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function X6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&Y6(n,e),e}function W6(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function K6(i,e){const t={},n=m(i,["customMetadata"]);if(e!==void 0&&n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["customMetadata"],o)}const s=m(i,["chunkingConfig"]);return e!==void 0&&s!=null&&v(e,["chunkingConfig"],s),t}function J6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],Q6(l)),e}function j6(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["fileName"]);n!=null&&v(e,["fileName"],n);const s=m(i,["config"]);return s!=null&&K6(s,e),e}function Q6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function Z6(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function eG(i){const e={},t=m(i,["config"]);return t!=null&&Z6(t,e),e}function tG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["fileSearchStores"],o)}return e}function sk(i,e){const t={},n=m(i,["mimeType"]);e!==void 0&&n!=null&&v(e,["mimeType"],n);const s=m(i,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const o=m(i,["customMetadata"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>h)),v(e,["customMetadata"],c)}const l=m(i,["chunkingConfig"]);return e!==void 0&&l!=null&&v(e,["chunkingConfig"],l),t}function nG(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["config"]);return n!=null&&sk(n,e),e}function iG(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sG="Content-Type",rG="X-Server-Timeout",oG="User-Agent",TE="x-goog-api-client",aG="1.38.0",lG=`google-genai-sdk/${aG}`,cG="v1beta1",uG="v1beta";class dG{constructor(e){var t,n,s;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:cG}else{if(!this.clientOptions.apiKey)throw new Fg({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:uG,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===vE.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))s.searchParams.append(l,String(c));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))typeof o=="object"?n[s]=Object.assign(Object.assign({},n[s]),o):o!==void 0&&(n[s]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>o.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&hG(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await $N(s),new bE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await $N(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Ar(this,arguments,function*(){var n;const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const c="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:g}=yield Pe(s.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const y=o.decode(g,{stream:!0});try{const w=JSON.parse(y);if("error"in w){const C=JSON.parse(JSON.stringify(w.error)),N=C.status,I=C.code,P=`got status: ${N}. ${JSON.stringify(w)}`;if(I>=400&&I<600)throw new Fg({message:P,status:I})}}catch(w){if(w.name==="ApiError")throw w}l+=y;let b=-1,A=0;for(;;){b=-1,A=0;for(const N of h){const I=l.indexOf(N);I!==-1&&(b===-1||I<b)&&(b=I,A=N.length)}if(b===-1)break;const w=l.substring(0,b);l=l.substring(b+A);const C=w.trim();if(C.startsWith(c)){const N=C.substring(c.length).trim();try{const I=new Response(N,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pe(new bE(I))}catch(I){throw new Error(`exception parsing stream chunk ${N}. ${I}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=lG+" "+this.clientOptions.userAgentExtra;return e[oG]=t,e[TE]=t,e[sG]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))n.append(s,o);e.timeout&&e.timeout>0&&n.append(rG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);s.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const h={file:s},f=this.getFileName(e),g=fe("upload/v1beta/files",h._url),y=await this.fetchUploadUrl(g,s.sizeBytes,s.mimeType,f,h,t==null?void 0:t.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,n){var s;const o=this.clientOptions.uploader,l=await o.stat(t),c=String(l.size),h=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(t),y={};n!=null&&sk(n,y);const b=await this.fetchUploadUrl(f,c,h,g,y,n==null?void 0:n.httpOptions);return o.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,s,o,l){var c;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},s?{"X-Goog-Upload-File-Name":s}:{})};const f=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:h});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const g=(c=f==null?void 0:f.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function $N(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new Fg({message:s,status:t}):new Error(s)}}function hG(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const o=JSON.parse(i.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(o,l){const c=Object.assign({},o);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const f=l[h],g=c[h];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[h]=n(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[h]=f)}return c}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fG="mcp_used/unknown";let pG=!1;function rk(i){for(const e of i)if(gG(e)||typeof e=="object"&&"inputSchema"in e)return!0;return pG}function ok(i){var e;const t=(e=i[TE])!==null&&e!==void 0?e:"";i[TE]=(t+` ${fG}`).trimStart()}function gG(i){return i!==null&&typeof i=="object"&&i instanceof ww}function mG(i){return Ar(this,arguments,function*(t,n=100){let s,o=0;for(;o<n;){const l=yield Pe(t.listTools({cursor:s}));for(const c of l.tools)yield yield Pe(c),o++;if(!l.nextCursor)break;s=l.nextCursor}})}class ww{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new ww(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const o={},l=[];for(const g of this.mcpClients)try{for(var c=!0,h=(t=void 0,Er(mG(g))),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const y=s;l.push(y);const b=y.name;if(o[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);o[b]=g}}catch(y){t={error:y}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),X3(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function yG(i,e,t){const n=new B3;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(n,s),e(n)}class vG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=SG(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(k=>{f=k}),y=e.callbacks,b=function(){f({})},A=this.apiClient,w={onopen:b,onmessage:k=>{yG(A,y.onmessage,k)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(k){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(k){}},C=this.webSocketFactory.create(h,_G(l),w);C.connect(),await g;const P={setup:{model:ut(this.apiClient,e.model)}};return C.send(JSON.stringify(P)),new bG(C,this.apiClient)}}class bG{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=q4(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=V4(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ch.PLAY)}pause(){this.sendPlaybackControl(ch.PAUSE)}stop(){this.sendPlaybackControl(ch.STOP)}resetContext(){this.sendPlaybackControl(ch.RESET_CONTEXT)}close(){this.conn.close()}}function _G(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function SG(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AG="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function EG(i,e,t){const n=new F3;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const o=JSON.parse(s);if(i.isVertexAI()){const l=X4(o);Object.assign(n,l)}else Object.assign(n,o);e(n)}class TG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new vG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,o,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const y=this.apiClient.getHeaders();e.config&&e.config.tools&&rk(e.config.tools)&&ok(y);const b=RG(y);if(this.apiClient.isVertexAI()){const q=this.apiClient.getProject(),Q=this.apiClient.getLocation(),ee=this.apiClient.getApiKey(),se=!!q&&!!Q||!!ee;this.apiClient.getCustomBaseUrl()&&!se?g=h:(g=`${h}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,g))}else{const q=this.apiClient.getApiKey();let Q="BidiGenerateContent",ee="key";q!=null&&q.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Q="BidiGenerateContentConstrained",ee="access_token"),g=`${h}/ws/google.ai.generativelanguage.${f}.GenerativeService.${Q}?${ee}=${q}`}let A=()=>{};const w=new Promise(q=>{A=q}),C=e.callbacks,N=function(){var q;(q=C==null?void 0:C.onopen)===null||q===void 0||q.call(C),A({})},I=this.apiClient,P={onopen:N,onmessage:q=>{EG(I,C.onmessage,q)},onerror:(t=C==null?void 0:C.onerror)!==null&&t!==void 0?t:function(q){},onclose:(n=C==null?void 0:C.onclose)!==null&&n!==void 0?n:function(q){}},k=this.webSocketFactory.create(g,xG(b),P);k.connect(),await w;let L=ut(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const q=this.apiClient.getProject(),Q=this.apiClient.getLocation();q&&Q&&(L=`projects/${q}/locations/${Q}/`+L)}let O={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[cb.AUDIO]}:e.config.responseModalities=[cb.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const q of U)if(this.isCallableTool(q)){const Q=q;F.push(await Q.tool())}else F.push(q);F.length>0&&(e.config.tools=F);const K={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=z4(this.apiClient,K):O=G4(this.apiClient,K),delete O.config,k.send(JSON.stringify(O)),new CG(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const wG={turnComplete:!0};class CG{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=js(t.turns),e.isVertexAI()||(n=n.map(s=>t_(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const o of n){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(AG)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},wG),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Y4(e)}:t={realtimeInput:$4(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function xG(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function RG(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YN=10;function XN(i){var e,t,n;if(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i==null?void 0:i.tools)!==null&&t!==void 0?t:[])if(bh(l)){s=!0;break}if(!s)return!0;const o=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function bh(i){return"callTool"in i&&typeof i.callTool=="function"}function IG(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>bh(s)))!==null&&n!==void 0?n:!1}function WN(i){var e;const t=[];return!((e=i==null?void 0:i.config)===null||e===void 0)&&e.tools&&i.config.tools.forEach((n,s)=>{if(bh(n))return;const o=n;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(s)}),t}function KN(i){var e;return!(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NG extends Pa{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,o,l,c;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!IG(t)||XN(t.config))return await this.generateContentInternal(h);const f=WN(t);if(f.length>0){const C=f.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${C}.`)}let g,y;const b=js(h.contents),A=(o=(s=(n=h.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:YN;let w=0;for(;w<A&&(g=await this.generateContentInternal(h),!(!g.functionCalls||g.functionCalls.length===0));){const C=g.candidates[0].content,N=[];for(const I of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(bh(I)){const k=await I.callTool(g.functionCalls);N.push(...k)}w++,y={role:"user",parts:N},h.contents=js(h.contents),h.contents.push(C),h.contents.push(y),KN(h.config)&&(b.push(C),b.push(y))}return KN(h.config)&&(g.automaticFunctionCallingHistory=b),g},this.generateContentStream=async t=>{var n,s,o,l,c;if(this.maybeMoveToResponseJsonSchem(t),XN(t.config)){const y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}const h=WN(t);if(h.length>0){const y=h.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(s=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,g=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(f&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let o;const l=[];if(n!=null&&n.generatedImages)for(const h of n.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((s=h==null?void 0:h.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=h==null?void 0:h.safetyAttributes:l.push(h);let c;return o?c={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ud(Ca.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var n,s,o,l,c,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((h=(c=t.source)===null||c===void 0?void 0:c.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async h=>bh(h)?await h.tool():h)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&rk(e.config.tools)){const h=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let f=Object.assign({},h);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),ok(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var t,n,s;const o=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(bh(l)){const c=l,h=await c.tool();for(const f of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,c)}}return o}async processAfcStream(e){var t,n,s;const o=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:YN;let l=!1,c=0;const h=await this.initAfcToolsMap(e);return(function(f,g,y){return Ar(this,arguments,function*(){for(var b,A,w,C,N,I;c<o;){l&&(c++,l=!1);const O=yield Pe(f.processParamsMaybeAddMcpUsage(y)),U=yield Pe(f.generateContentStreamInternal(O)),F=[],K=[];try{for(var P=!0,k=(A=void 0,Er(U)),L;L=yield Pe(k.next()),b=L.done,!b;P=!0){C=L.value,P=!1;const q=C;if(yield yield Pe(q),q.candidates&&(!((N=q.candidates[0])===null||N===void 0)&&N.content)){K.push(q.candidates[0].content);for(const Q of(I=q.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(c<o&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Q.functionCall.name)){const ee=yield Pe(g.get(Q.functionCall.name).callTool([Q.functionCall]));F.push(...ee)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(q){A={error:q}}finally{try{!P&&!b&&(w=k.return)&&(yield Pe(w.call(k)))}finally{if(A)throw A.error}}if(F.length>0){l=!0;const q=new sg;q.candidates=[{content:{role:"user",parts:F}}],yield yield Pe(q);const Q=[];Q.push(...K),Q.push({role:"user",parts:F});const ee=js(y.contents).concat(Q);y.contents=ee}else break}})})(this,h,e)}async generateContentInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=zN(this.apiClient,e);return c=fe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=qN(g),b=new sg;return Object.assign(b,y),b})}else{const f=GN(this.apiClient,e);return c=fe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=VN(g),b=new sg;return Object.assign(b,y),b})}}async generateContentStreamInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=zN(this.apiClient,e);return c=fe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(y){return Ar(this,arguments,function*(){var b,A,w,C;try{for(var N=!0,I=Er(y),P;P=yield Pe(I.next()),b=P.done,!b;N=!0){C=P.value,N=!1;const k=C,L=qN(yield Pe(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new sg;Object.assign(O,L),yield yield Pe(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Pe(w.call(I)))}finally{if(A)throw A.error}}})})}else{const f=GN(this.apiClient,e);return c=fe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(y){return Ar(this,arguments,function*(){var b,A,w,C;try{for(var N=!0,I=Er(y),P;P=yield Pe(I.next()),b=P.done,!b;N=!0){C=P.value,N=!1;const k=C,L=VN(yield Pe(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new sg;Object.assign(O,L),yield yield Pe(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Pe(w.call(I)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=T5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=C5(g),b=new TN;return Object.assign(b,y),b})}else{const f=E5(this.apiClient,e);return c=fe("{model}:batchEmbedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=w5(g),b=new TN;return Object.assign(b,y),b})}}async generateImagesInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=U5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=B5(g),b=new wN;return Object.assign(b,y),b})}else{const f=O5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=F5(g),b=new wN;return Object.assign(b,y),b})}}async editImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=b5(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=_5(h),g=new x3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=U6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=F6(h),g=new R3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=v6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=b6(h),g=new I3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=w6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=C6(h),g=new N3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=n6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>EE(g))}else{const f=t6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>AE(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=d6(this.apiClient,e);return c=fe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=f6(g),b=new CN;return Object.assign(b,y),b})}else{const f=u6(this.apiClient,e);return c=fe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=h6(g),b=new CN;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=L6(this.apiClient,e);return c=fe("{model}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>EE(g))}else{const f=P6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>AE(g))}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=g5(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=y5(g),b=new xN;return Object.assign(b,y),b})}else{const f=p5(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=m5(g),b=new xN;return Object.assign(b,y),b})}}async countTokens(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=d5(this.apiClient,e);return c=fe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=f5(g),b=new RN;return Object.assign(b,y),b})}else{const f=u5(this.apiClient,e);return c=fe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=h5(g),b=new RN;return Object.assign(b,y),b})}}async computeTokens(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=i5(this.apiClient,e);return o=fe("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=s5(h),g=new M3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=$5(this.apiClient,e);return c=fe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const y=V5(g),b=new ub;return Object.assign(b,y),b})}else{const f=q5(this.apiClient,e);return c=fe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>{const y=z5(g),b=new ub;return Object.assign(b,y),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MG extends Pa{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=S3(e);return c=fe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l}else{const f=_3(e);return c=fe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=f3(e);return o=fe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DG(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function kG(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>zG(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function PG(i,e,t){const n={},s=m(e,["expireTime"]);t!==void 0&&s!=null&&v(t,["expireTime"],s);const o=m(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&v(t,["newSessionExpireTime"],o);const l=m(e,["uses"]);t!==void 0&&l!=null&&v(t,["uses"],l);const c=m(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&v(t,["bidiGenerateContentSetup"],GG(i,c));const h=m(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&v(t,["fieldMask"],h),n}function LG(i,e){const t={},n=m(e,["config"]);return n!=null&&v(t,["config"],PG(i,n,t)),t}function OG(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function UG(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function FG(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function BG(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function HG(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Tw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],kG(ui(w)));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let U=rp(C);Array.isArray(U)&&(U=U.map(F=>qG(sp(F)))),v(e,["setup","tools"],U)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],VG(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function GG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ut(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],HG(s,t)),t}function zG(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],OG(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],UG(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],DG(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function VG(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function qG(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],FG(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],BG(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $G(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(o=>`${t}.${o}`);e.push(...s)}else e.push(t)}return e.join(",")}function YG(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const o=n.setup;typeof o=="object"&&o!==null?(i.bidiGenerateContentSetup=o,t=o):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const o=$G(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?i.fieldMask=o:delete i.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(f=>l.includes(f)?`generationConfig.${f}`:f));const h=[];o&&h.push(o),c.length>0&&h.push(...c),h.length>0?i.fieldMask=h.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class XG extends Pa{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=LG(this.apiClient,e);o=fe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=YG(c,e.config);return s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WG(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function KG(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&WG(n,e),e}function JG(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function jG(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function QG(i){const e={},t=m(i,["parent"]);t!=null&&v(e,["_url","parent"],t);const n=m(i,["config"]);return n!=null&&jG(n,e),e}function ZG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ez extends Pa{constructor(e){super(),this.apiClient=e,this.list=async t=>new ud(Ca.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=JG(e);return o=fe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KG(e);s=fe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=QG(e);return o=fe("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=ZG(h),g=new D3;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tz extends Pa{constructor(e,t=new ez(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new ud(Ca.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=$6(e);return o=fe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=W6(e);return o=fe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=X6(e);s=fe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=eG(e);return o=fe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=tG(h),g=new k3;return Object.assign(g,f),g})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=nG(e);return o=fe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=iG(h),g=new P3;return Object.assign(g,f),g})}}async importFile(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=j6(e);return o=fe("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=J6(h),g=new bw;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ak=function(){const{crypto:i}=globalThis;if(i!=null&&i.randomUUID)return ak=i.randomUUID.bind(i),i.randomUUID();const e=new Uint8Array(1),t=i?()=>i.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const nz=()=>ak();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wE(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const CE=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const e=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(e.stack=i.stack),i.cause&&!e.cause&&(e.cause=i.cause),i.name&&(e.name=i.name),e}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zs extends Error{}class Ei extends Zs{constructor(e,t,n,s){super(`${Ei.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new s_({message:n,cause:CE(t)});const o=t;return e===400?new ck(e,o,n,s):e===401?new uk(e,o,n,s):e===403?new dk(e,o,n,s):e===404?new hk(e,o,n,s):e===409?new fk(e,o,n,s):e===422?new pk(e,o,n,s):e===429?new gk(e,o,n,s):e>=500?new mk(e,o,n,s):new Ei(e,o,n,s)}}class xE extends Ei{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class s_ extends Ei{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class lk extends s_{constructor({message:e}={}){super({message:e??"Request timed out."})}}class ck extends Ei{}class uk extends Ei{}class dk extends Ei{}class hk extends Ei{}class fk extends Ei{}class pk extends Ei{}class gk extends Ei{}class mk extends Ei{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iz=/^[a-z][a-z0-9+.-]*:/i,sz=i=>iz.test(i);let RE=i=>(RE=Array.isArray,RE(i));const rz=RE;let oz=rz;const JN=oz;function az(i){if(!i)return!0;for(const e in i)return!1;return!0}function lz(i,e){return Object.prototype.hasOwnProperty.call(i,e)}const cz=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Zs(`${i} must be an integer`);if(e<0)throw new Zs(`${i} must be a positive integer`);return e},uz=i=>{try{return JSON.parse(i)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dz=i=>new Promise(e=>setTimeout(e,i));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eh="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hz(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const fz=()=>{var i,e,t,n,s;const o=hz();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":QN(Deno.build.os),"X-Stainless-Arch":jN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(i=Deno.version)===null||i===void 0?void 0:i.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":QN((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":jN((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=pz();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function pz(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,o=n[2]||0,l=n[3]||0;return{browser:e,version:`${s}.${o}.${l}`}}}return null}const jN=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",QN=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let lv;const gz=()=>lv??(lv=fz());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mz(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function yk(...i){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...i)}function yz(i){let e=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return yk({start(){},async pull(t){const{done:n,value:s}=await e.next();n?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function vk(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function vz(i){var e,t;if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await((t=(e=i[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=i.getReader(),s=n.cancel();n.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bz=({headers:i,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bk=()=>{var i;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((i=e==null?void 0:e.versions)===null||i===void 0?void 0:i.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function qA(i,e,t){return bk(),new File(i,e??"unknown_file",t)}function _z(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const Sz=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _k=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",Az=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&_k(i),Ez=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function Tz(i,e,t){if(bk(),i=await i,Az(i))return i instanceof File?i:qA([await i.arrayBuffer()],i.name);if(Ez(i)){const s=await i.blob();return e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()),qA(await IE(s),e,t)}const n=await IE(i);if(e||(e=_z(i)),!(t!=null&&t.type)){const s=n.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return qA(n,e,t)}async function IE(i){var e,t,n,s,o;let l=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)l.push(i);else if(_k(i))l.push(i instanceof Blob?i:await i.arrayBuffer());else if(Sz(i))try{for(var c=!0,h=Er(i),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const g=s;l.push(...await IE(g))}}catch(g){t={error:g}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}else{const g=(o=i==null?void 0:i.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof i}${g?`; constructor: ${g}`:""}${wz(i)}`)}return l}function wz(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sk{constructor(e){this._client=e}}Sk._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ak(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const ZN=Object.freeze(Object.create(null)),Cz=(i=Ak)=>(function(t,...n){if(t.length===1)return t[0];let s=!1;const o=[],l=t.reduce((g,y,b)=>{var A,w,C;/[?#]/.test(y)&&(s=!0);const N=n[b];let I=(s?encodeURIComponent:i)(""+N);return b!==n.length&&(N==null||typeof N=="object"&&N.toString===((C=Object.getPrototypeOf((w=Object.getPrototypeOf((A=N.hasOwnProperty)!==null&&A!==void 0?A:ZN))!==null&&w!==void 0?w:ZN))===null||C===void 0?void 0:C.toString))&&(I=N+"",o.push({start:g.length+y.length,length:I.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),g+y+(b===n.length?"":I)},""),c=l.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=h.exec(c))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((g,y)=>g.start-y.start),o.length>0){let g=0;const y=o.reduce((b,A)=>{const w=" ".repeat(A.start-g),C="^".repeat(A.length);return g=A.start+A.length,b+w+C},"");throw new Zs(`Path parameters result in path with invalid segments:
${o.map(b=>b.error).join(`
`)}
${l}
${y}`)}return l}),cv=Cz(Ak);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ek extends Sk{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,o=hb(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new Zs("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new Zs("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(cv`/${s}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(cv`/${s}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(cv`/${s}/interactions/${e}/cancel`,n)}get(e,t={},n){var s;const o=t??{},{api_version:l=this._client.apiVersion}=o,c=hb(o,["api_version"]);return this._client.get(cv`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}Ek._key=Object.freeze(["interactions"]);class Tk extends Ek{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xz(i){let e=0;for(const s of i)e+=s.length;const t=new Uint8Array(e);let n=0;for(const s of i)t.set(s,n),n+=s.length;return t}let uv;function Cw(i){let e;return(uv??(e=new globalThis.TextEncoder,uv=e.encode.bind(e)))(i)}let dv;function eM(i){let e;return(dv??(e=new globalThis.TextDecoder,dv=e.decode.bind(e)))(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r_{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Cw(e):e;this.buffer=xz([this.buffer,t]);const n=[];let s;for(;(s=Rz(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(eM(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=eM(this.buffer.subarray(0,o));n.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}r_.NEWLINE_CHARS=new Set([`
`,"\r"]);r_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Rz(i,e){for(let s=e??0;s<i.length;s++){if(i[s]===10)return{preceding:s,index:s+1,carriage:!1};if(i[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Iz(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fb={off:0,error:200,warn:300,info:400,debug:500},tM=(i,e,t)=>{if(i){if(lz(fb,i))return i;vi(t).warn(`${e} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(fb))}`)}};function ug(){}function hv(i,e,t){return!e||fb[i]>fb[t]?ug:e[i].bind(e)}const Nz={error:ug,warn:ug,info:ug,debug:ug};let nM=new WeakMap;function vi(i){var e;const t=i.logger,n=(e=i.logLevel)!==null&&e!==void 0?e:"off";if(!t)return Nz;const s=nM.get(t);if(s&&s[0]===n)return s[1];const o={error:hv("error",t,n),warn:hv("warn",t,n),info:hv("info",t,n),debug:hv("debug",t,n)};return nM.set(t,[n,o]),o}const Oc=i=>(i.options&&(i.options=Object.assign({},i.options),delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uh{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const o=n?vi(n):console;function l(){return Ar(this,arguments,function*(){var h,f,g,y;if(s)throw new Zs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=Er(Mz(e,t)),C;C=yield Pe(w.next()),h=C.done,!h;A=!0){y=C.value,A=!1;const N=y;if(!b)if(N.data.startsWith("[DONE]")){b=!0;continue}else try{yield yield Pe(JSON.parse(N.data))}catch(I){throw o.error("Could not parse message into JSON:",N.data),o.error("From chunk:",N.raw),I}}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Pe(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(wE(N))return yield Pe(void 0);throw N}finally{b||t.abort()}})}return new uh(l,t,n)}static fromReadableStream(e,t,n){let s=!1;function o(){return Ar(this,arguments,function*(){var h,f,g,y;const b=new r_,A=vk(e);try{for(var w=!0,C=Er(A),N;N=yield Pe(C.next()),h=N.done,!h;w=!0){y=N.value,w=!1;const I=y;for(const P of b.decode(I))yield yield Pe(P)}}catch(I){f={error:I}}finally{try{!w&&!h&&(g=C.return)&&(yield Pe(g.call(C)))}finally{if(f)throw f.error}}for(const I of b.flush())yield yield Pe(I)})}function l(){return Ar(this,arguments,function*(){var h,f,g,y;if(s)throw new Zs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=Er(o()),C;C=yield Pe(w.next()),h=C.done,!h;A=!0){y=C.value,A=!1;const N=y;b||N&&(yield yield Pe(JSON.parse(N)))}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Pe(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(wE(N))return yield Pe(void 0);throw N}finally{b||t.abort()}})}return new uh(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){const l=n.next();e.push(l),t.push(l)}return o.shift()}});return[new uh(()=>s(e),this.controller,this.client),new uh(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return yk({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:o}=await t.next();if(o)return n.close();const l=Cw(JSON.stringify(s)+`
`);n.enqueue(l)}catch(s){n.error(s)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function Mz(i,e){return Ar(this,arguments,function*(){var n,s,o,l;if(!i.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Zs("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Zs("Attempted to iterate over a response with no body");const c=new kz,h=new r_,f=vk(i.body);try{for(var g=!0,y=Er(Dz(f)),b;b=yield Pe(y.next()),n=b.done,!n;g=!0){l=b.value,g=!1;const A=l;for(const w of h.decode(A)){const C=c.decode(w);C&&(yield yield Pe(C))}}}catch(A){s={error:A}}finally{try{!g&&!n&&(o=y.return)&&(yield Pe(o.call(y)))}finally{if(s)throw s.error}}for(const A of h.flush()){const w=c.decode(A);w&&(yield yield Pe(w))}})}function Dz(i){return Ar(this,arguments,function*(){var t,n,s,o;let l=new Uint8Array;try{for(var c=!0,h=Er(i),f;f=yield Pe(h.next()),t=f.done,!t;c=!0){o=f.value,c=!1;const g=o;if(g==null)continue;const y=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?Cw(g):g;let b=new Uint8Array(l.length+y.length);b.set(l),b.set(y,l.length),l=b;let A;for(;(A=Iz(l))!==-1;)yield yield Pe(l.slice(0,A)),l=l.slice(A)}}catch(g){n={error:g}}finally{try{!c&&!t&&(s=h.return)&&(yield Pe(s.call(h)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Pe(l))})}class kz{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=Pz(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function Pz(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Lz(i,e){const{response:t,requestLogID:n,retryOfRequestLogID:s,startTime:o}=e,l=await(async()=>{var c;if(e.options.stream)return vi(i).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,i):uh.fromSSEResponse(t,e.controller,i);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type"),f=(c=h==null?void 0:h.split(";")[0])===null||c===void 0?void 0:c.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await t.json():await t.text()})();return vi(i).debug(`[${n}] response parsed`,Oc({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-o})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xw extends Promise{constructor(e,t,n=Lz){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new xw(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wk=Symbol("brand.privateNullableHeaders");function*Oz(i){if(!i)return;if(wk in i){const{values:n,nulls:s}=i;yield*n.entries();for(const o of s)yield[o,null];return}let e=!1,t;i instanceof Headers?t=i.entries():JN(i)?t=i:(e=!0,t=Object.entries(i??{}));for(let n of t){const s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=JN(n[1])?n[1]:[n[1]];let l=!1;for(const c of o)c!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,c])}}const rg=i=>{const e=new Headers,t=new Set;for(const n of i){const s=new Set;for(const[o,l]of Oz(n)){const c=o.toLowerCase();s.has(c)||(e.delete(o),s.add(c)),l===null?(e.delete(o),t.add(c)):(e.append(o,l),t.delete(c))}}return{[wk]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $A=i=>{var e,t,n,s,o,l;if(typeof globalThis.process<"u")return(n=(t=(e=a3)===null||e===void 0?void 0:e[i])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||o===void 0?void 0:o.call(s,i))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ck;class o_{constructor(e){var t,n,s,o,l,c,h,{baseURL:f=$A("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:g=(t=$A("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:y="v1beta"}=e,b=hb(e,["baseURL","apiKey","apiVersion"]);const A=Object.assign(Object.assign({apiKey:g,apiVersion:y},b),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=A.baseURL,this.timeout=(n=A.timeout)!==null&&n!==void 0?n:o_.DEFAULT_TIMEOUT,this.logger=(s=A.logger)!==null&&s!==void 0?s:console;const w="warn";this.logLevel=w,this.logLevel=(l=(o=tM(A.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:tM($A("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:w,this.fetchOptions=A.fetchOptions,this.maxRetries=(c=A.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(h=A.fetch)!==null&&h!==void 0?h:mz(),this.encoder=bz,this._options=A,this.apiKey=g,this.apiVersion=y,this.clientAdapter=A.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=rg([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return rg([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return rg([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new Zs(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${eh}`}defaultIdempotencyKey(){return`stainless-node-retry-${nz()}`}makeStatusError(e,t,n,s){return Ei.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,o=sz(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return az(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new xw(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,o,l;const c=await e,h=(s=c.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=h),await this.prepareOptions(c);const{req:f,url:g,timeout:y}=await this.buildRequest(c,{retryCount:h-t});await this.prepareRequest(f,{url:g,options:c});const b="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),A=n===void 0?"":`, retryOf: ${n}`,w=Date.now();if(vi(this).debug(`[${b}] sending request`,Oc({retryOfRequestLogID:n,method:c.method,url:g,options:c,headers:f.headers})),!((o=c.signal)===null||o===void 0)&&o.aborted)throw new xE;const C=new AbortController,N=await this.fetchWithTimeout(g,f,y,C).catch(CE),I=Date.now();if(N instanceof globalThis.Error){const k=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new xE;const L=wE(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return vi(this).info(`[${b}] connection ${L?"timed out":"failed"} - ${k}`),vi(this).debug(`[${b}] connection ${L?"timed out":"failed"} (${k})`,Oc({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),this.retryRequest(c,t,n??b);throw vi(this).info(`[${b}] connection ${L?"timed out":"failed"} - error; no more retries left`),vi(this).debug(`[${b}] connection ${L?"timed out":"failed"} (error; no more retries left)`,Oc({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),L?new lk:new s_({cause:N})}const P=`[${b}${A}] ${f.method} ${g} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${I-w}ms`;if(!N.ok){const k=await this.shouldRetry(N);if(t&&k){const q=`retrying, ${t} attempts remaining`;return await vz(N.body),vi(this).info(`${P} - ${q}`),vi(this).debug(`[${b}] response error (${q})`,Oc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),this.retryRequest(c,t,n??b,N.headers)}const L=k?"error; no more retries left":"error; not retryable";vi(this).info(`${P} - ${L}`);const O=await N.text().catch(q=>CE(q).message),U=uz(O),F=U?void 0:O;throw vi(this).debug(`[${b}] response error (${L})`,Oc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,message:F,durationMs:Date.now()-w})),this.makeStatusError(N.status,U,F,N.headers)}return vi(this).info(P),vi(this).debug(`[${b}] response start`,Oc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),{response:N,options:c,controller:C,requestLogID:b,retryOfRequestLogID:n,startTime:w}}async fetchWithTimeout(e,t,n,s){const o=t||{},{signal:l,method:c}=o,h=hb(o,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const f=setTimeout(()=>s.abort(),n),g=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,y=Object.assign(Object.assign(Object.assign({signal:s.signal},g?{duplex:"half"}:{}),{method:"GET"}),h);c&&(y.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,y)}finally{clearTimeout(f)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,s){var o;let l;const c=s==null?void 0:s.get("retry-after-ms");if(c){const f=parseFloat(c);Number.isNaN(f)||(l=f)}const h=s==null?void 0:s.get("retry-after");if(h&&!l){const f=parseFloat(h);Number.isNaN(f)?l=Date.parse(h)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,f)}return await dz(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,s,o;const l=Object.assign({},e),{method:c,path:h,query:f,defaultBaseURL:g}=l,y=this.buildURL(h,f,g);"timeout"in l&&cz("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:b,body:A}=this.buildBody({options:l}),w=await this.buildHeaders({options:e,method:c,bodyHeaders:b,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:w},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&A instanceof globalThis.ReadableStream&&{duplex:"half"}),A&&{body:A}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:y,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=rg([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),gz()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=rg([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:yz(e)}:this.encoder({body:e,headers:n})}}o_.DEFAULT_TIMEOUT=6e4;class Un extends o_{constructor(){super(...arguments),this.interactions=new Tk(this)}}Ck=Un;Un.GeminiNextGenAPIClient=Ck;Un.GeminiNextGenAPIClientError=Zs;Un.APIError=Ei;Un.APIConnectionError=s_;Un.APIConnectionTimeoutError=lk;Un.APIUserAbortError=xE;Un.NotFoundError=hk;Un.ConflictError=fk;Un.RateLimitError=gk;Un.BadRequestError=ck;Un.AuthenticationError=uk;Un.InternalServerError=mk;Un.PermissionDeniedError=dk;Un.UnprocessableEntityError=pk;Un.toFile=Tz;Un.Interactions=Tk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Fz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Bz(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function Hz(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function Gz(i,e,t){const n={};if(m(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(i,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&v(e,["displayName"],s),m(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=m(i,["epochCount"]);e!==void 0&&o!=null&&v(e,["tuningTask","hyperparameters","epochCount"],o);const l=m(i,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=m(i,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const h=m(i,["learningRate"]);if(e!==void 0&&h!=null&&v(e,["tuningTask","hyperparameters","learningRate"],h),m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function zz(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec"],iM(A))}else if(s==="PREFERENCE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec"],iM(A))}const o=m(i,["tunedModelDisplayName"]);e!==void 0&&o!=null&&v(e,["tunedModelDisplayName"],o);const l=m(i,["description"]);e!==void 0&&l!=null&&v(e,["description"],l);let c=m(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],A)}else if(c==="PREFERENCE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],A)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],A)}else if(h==="PREFERENCE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],A)}let f=m(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],A)}else if(f==="PREFERENCE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],A)}let g=m(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],A)}else if(g==="PREFERENCE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],A)}if(m(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["beta"]);return e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),n}function Vz(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&eV(o);const l=m(i,["config"]);return l!=null&&Gz(l,t),t}function qz(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&tV(o,t,e);const l=m(i,["config"]);return l!=null&&zz(l,t,e),t}function $z(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Yz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Xz(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function Wz(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function Kz(i,e){const t={},n=m(i,["config"]);return n!=null&&Xz(n,t),t}function Jz(i,e){const t={},n=m(i,["config"]);return n!=null&&Wz(n,t),t}function jz(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>xk(c))),v(t,["tuningJobs"],l)}return t}function Qz(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>NE(c))),v(t,["tuningJobs"],l)}return t}function Zz(i,e){const t={},n=m(i,["name"]);n!=null&&v(t,["model"],n);const s=m(i,["name"]);return s!=null&&v(t,["endpoint"],s),t}function eV(i,e){const t={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(i,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(t,["examples","examples"],s)}return t}function tV(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=m(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(m(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function xk(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],VD(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["tuningTask","startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["tuningTask","completeTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["description"]);g!=null&&v(t,["description"],g);const y=m(i,["baseModel"]);y!=null&&v(t,["baseModel"],y);const b=m(i,["_self"]);return b!=null&&v(t,["tunedModel"],Zz(b)),t}function NE(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],VD(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["error"]);g!=null&&v(t,["error"],g);const y=m(i,["description"]);y!=null&&v(t,["description"],y);const b=m(i,["baseModel"]);b!=null&&v(t,["baseModel"],b);const A=m(i,["tunedModel"]);A!=null&&v(t,["tunedModel"],A);const w=m(i,["preTunedModel"]);w!=null&&v(t,["preTunedModel"],w);const C=m(i,["supervisedTuningSpec"]);C!=null&&v(t,["supervisedTuningSpec"],C);const N=m(i,["preferenceOptimizationSpec"]);N!=null&&v(t,["preferenceOptimizationSpec"],N);const I=m(i,["tuningDataStats"]);I!=null&&v(t,["tuningDataStats"],I);const P=m(i,["encryptionSpec"]);P!=null&&v(t,["encryptionSpec"],P);const k=m(i,["partnerModelTuningSpec"]);k!=null&&v(t,["partnerModelTuningSpec"],k);const L=m(i,["customBaseModel"]);L!=null&&v(t,["customBaseModel"],L);const O=m(i,["experiment"]);O!=null&&v(t,["experiment"],O);const U=m(i,["labels"]);U!=null&&v(t,["labels"],U);const F=m(i,["outputUri"]);F!=null&&v(t,["outputUri"],F);const K=m(i,["pipelineJob"]);K!=null&&v(t,["pipelineJob"],K);const q=m(i,["serviceAccount"]);q!=null&&v(t,["serviceAccount"],q);const Q=m(i,["tunedModelDisplayName"]);Q!=null&&v(t,["tunedModelDisplayName"],Q);const ee=m(i,["veoTuningSpec"]);return ee!=null&&v(t,["veoTuningSpec"],ee),t}function nV(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(i,["done"]);l!=null&&v(t,["done"],l);const c=m(i,["error"]);return c!=null&&v(t,["error"],c),t}function iM(i,e){const t={},n=m(i,["gcsUri"]);n!=null&&v(t,["validationDatasetUri"],n);const s=m(i,["vertexDatasetResource"]);return s!=null&&v(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iV extends Pa{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ud(Ca.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),o=await this.tuneMldevInternal(s);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:yE.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Yz(e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>NE(g))}else{const f=$z(e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>xk(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Jz(e);return c=fe("tuningJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Qz(g),b=new IN;return Object.assign(b,y),b})}else{const f=Kz(e);return c=fe("tunedModels",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=jz(g),b=new IN;return Object.assign(b,y),b})}}async cancel(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Fz(e);return c=fe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Hz(g),b=new NN;return Object.assign(b,y),b})}else{const f=Uz(e);return c=fe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Bz(g),b=new NN;return Object.assign(b,y),b})}}async tuneInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=qz(e,e);return o=fe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>NE(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Vz(e);return o=fe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>nV(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sV{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const rV=1024*1024*8,oV=3,aV=1e3,lV=2,pb="x-goog-upload-status";async function cV(i,e,t){var n;const s=await Rk(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[pb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function uV(i,e,t){var n;const s=await Rk(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[pb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=UD(o),c=new _w;return Object.assign(c,l),c}async function Rk(i,e,t){var n,s;let o=0,l=0,c=new bE(new Response),h="upload";for(o=i.size;l<o;){const f=Math.min(rV,o-l),g=i.slice(l,l+f);l+f>=o&&(h+=", finalize");let y=0,b=aV;for(;y<oV&&(c=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[pb]));)y++,await hV(b),b=b*lV;if(l+=f,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[pb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function dV(i){return{size:i.size,type:i.type}}function hV(i){return new Promise(e=>setTimeout(e,i))}class fV{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cV(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uV(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dV(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pV{create(e,t,n){return new gV(e,t,n)}}class gV{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sM="x-goog-api-key";class mV{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(sM)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(sM,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yV="gl-node/";class vV{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Un({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=d3(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new mV(this.apiKey);this.apiClient=new dG({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:yV+"web",uploader:new fV,downloader:new sV}),this.models=new NG(this.apiClient),this.live=new TG(this.apiClient,s,new pV),this.batches=new HH(this.apiClient),this.chats=new S4(this.models,this.apiClient),this.caches=new v4(this.apiClient),this.files=new M4(this.apiClient),this.operations=new MG(this.apiClient),this.authTokens=new XG(this.apiClient),this.tunings=new iV(this.apiClient),this.fileSearchStores=new tz(this.apiClient)}}var bV={};const _V="https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.3",rM=bV.HF_TOKEN,gc=async(i,e)=>{var s;if(!rM)throw new Error("No Fallback Key");const t=await fetch(_V,{method:"POST",headers:{Authorization:`Bearer ${rM}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:`<s>[INST] ${i} 

 ${e} [/INST]`,parameters:{max_new_tokens:1024,temperature:.7,return_full_text:!1}})});if(!t.ok)throw new Error("Fallback API Failed");return((s=(await t.json())[0])==null?void 0:s.generated_text)||""},Ik=i=>{try{const e=i.match(/\[.*\]/s)||i.match(/\{.*\}/s);return e?JSON.parse(e[0]):null}catch{return null}},SV=async i=>{try{const t=await gc("You are a book search engine. Return a JSON array of 5 books matching the query. properties: title, author, description, publishedYear, coverColor (hex), isbn (13 digit).",`Search for: ${i}`),n=Ik(t);if(n&&Array.isArray(n))return n.map((s,o)=>({...s,id:`fallback-${Date.now()}-${o}`,categories:s.categories||["General"],isLocal:!1}));throw new Error("Parse failed")}catch{return[{id:"offline-1",title:"The Offline Library",author:"System Backup",description:"We could not reach our AI services, but here is a classic placeholder.",publishedYear:"2024",categories:["System"],coverColor:"#e2e8f0",isbn:"9780141439518",isLocal:!1}]}},AV=async(i,e)=>{try{const n=await gc("You are a helpful book concierge named Suitcase (Backup Mode). Reply kindly. If asked for books, provide a JSON object with 'reply' (string) and 'suggestions' (array of books with title, author, isbn).",i),s=Ik(n);return s&&s.reply?{reply:s.reply,suggestions:Array.isArray(s.suggestions)?s.suggestions.map((o,l)=>({...o,id:`fb-con-${l}`,coverColor:"#cbd5e1",isLocal:!1,categories:[]})):[]}:{reply:n,suggestions:[]}}catch{return{reply:"I'm having trouble connecting to the cloud, but I'm here listening.",suggestions:[]}}},EV=async i=>[{id:"off-1",title:"The Great Gatsby",author:"F. Scott Fitzgerald",description:"A classic of the Jazz Age.",publishedYear:"1925",categories:["Classic"],coverColor:"#fef3c7",isbn:"9780743273565",matchReason:"Timeless classic",isLocal:!1},{id:"off-2",title:"1984",author:"George Orwell",description:"Dystopian social science fiction.",publishedYear:"1949",categories:["Sci-Fi"],coverColor:"#f3f4f6",isbn:"9780451524935",matchReason:"Essential reading",isLocal:!1},{id:"off-3",title:"Dune",author:"Frank Herbert",description:"Epic science fiction.",publishedYear:"1965",categories:["Sci-Fi"],coverColor:"#fed7aa",isbn:"9780441013593",matchReason:"Masterpiece",isLocal:!1},{id:"off-4",title:"Sapiens",author:"Yuval Noah Harari",description:"A brief history of humankind.",publishedYear:"2011",categories:["History"],coverColor:"#e0f2fe",isbn:"9780062316097",matchReason:"Thought provoking",isLocal:!1}],TV=async(i,e)=>[{id:"rev-1",reviewerName:"Offline Reader",rating:5,text:"This book is a masterpiece!",date:"Today",avatarColor:"#3b82f6"},{id:"rev-2",reviewerName:"Bookworm",rating:4,text:"Really enjoyed the plot twists.",date:"Yesterday",avatarColor:"#ef4444"}],wV=async(i,e,t)=>{try{const n=`You are a literary assistant discussing "${i}". Keep answers short.`;return await gc(n,e)}catch{return"I can't analyze this book right now due to connection issues."}},CV=async i=>{try{return await gc("Translate the following text to English.",i)}catch{return"Translation service unavailable."}},xV=async(i,e)=>{try{const t=`Explain the context of this text from "${e}".`;return await gc(t,i)}catch{return"Context service unavailable."}},RV=async(i,e,t=1)=>{try{const n=`Write Chapter ${t} of "${i}" by ${e}. HTML format <p>.`;return await gc(n,"Generate chapter content.")||"<p>Content generation failed.</p>"}catch{return`
            <h3>Chapter ${t}</h3>
            <p>We are currently unable to generate the full text for <strong>${i}</strong> due to high demand on our AI services.</p>
            <p>Please try again later or upload a local PDF copy of this book to continue reading.</p>
        `}},IV=async i=>{try{return await gc(`Summarize "${i}".`,"Summary:")}catch{return"Summary unavailable offline."}},NV=async i=>{try{return await gc(`Recap the plot of "${i}".`,"Recap:")}catch{return"Recap unavailable offline."}},fo=new vV({apiKey:"AIzaSyDKkxTYId1SXW4k0skhK-P6x2CY62MWRmc"}),po="gemini-2.5-flash",a_=i=>{if(!i)return[];try{return JSON.parse(i)}catch{const t=i.replace(/```json\n?|```/g,"").trim();try{return JSON.parse(t)}catch(n){return console.error("Failed to parse Gemini JSON",n),[]}}},MV=async i=>{try{const e={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING,description:"A pastel hex color code matching the book vibe"},isbn:{type:ke.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10 to fetch cover image."}},required:["title","author","description","publishedYear","categories","coverColor","isbn"]},t={type:ke.ARRAY,items:e},n=`
      You are the search engine for the world's largest digital library.
      The user is searching for: "${i}".
      
      Instructions:
      1. If the query specifies a particular book title (e.g., "The Great Gatsby"), return that specific book first.
      2. If the query is a genre or topic (e.g., "Sci-Fi", "Cooking"), return 6 popular, high-quality books in that category.
      3. If the query is nonsense, random characters, or matches no known books (e.g., "asdfghjkl"), return an EMPTY array [].
      4. CRITICAL: Provide a valid real-world 'isbn' (ISBN-13 preferred) for every book so we can display the cover.
      
      For 'description', write a compelling 2-sentence hook.
      For 'coverColor', generate a unique, aesthetic pastel hex code for each book as a fallback.
    `,s=await fo.models.generateContent({model:po,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return a_(s.text).map((l,c)=>({id:`gemini-search-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],fileUrl:void 0}))}catch(e){return console.warn("Gemini Search Error, switching to fallback:",e),SV(i)}},DV=async(i,e)=>{try{const t={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING},isbn:{type:ke.STRING,description:"Valid ISBN-13."},matchReason:{type:ke.STRING,description:"Why this recommendation fits the conversation."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},n={type:ke.OBJECT,properties:{reply:{type:ke.STRING,description:"Your conversational response to the user."},suggestions:{type:ke.ARRAY,items:t,description:"List of 1-3 books if relevant to the user's request. Can be empty if the user is just chatting."}},required:["reply","suggestions"]},s=`
            You are a sophisticated, warm, and highly knowledgeable literary concierge named "Suitcase".
            Your goal is to have a natural conversation with the user to help them find the perfect book.
            
            Conversation History:
            ${JSON.stringify(e.slice(-6))}
            
            Current User Input: "${i}"
            
            Instructions:
            1. Respond conversationally to the user's input. Be witty and helpful.
            2. If the user is asking for books, feeling a certain way, or discussing genres, provide 1-3 highly curated recommendations.
            3. If the user is just saying hello or asking a general question, reply without suggestions.
            4. 'matchReason' should be a personalized sentence about why you picked this book for them.
        `,o=await fo.models.generateContent({model:po,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=a_(o.text),c=(l.suggestions||[]).map((h,f)=>({id:`concierge-${Date.now()}-${f}`,title:h.title,author:h.author,coverColor:h.coverColor||"#E2E8F0",isbn:h.isbn,description:h.description,isLocal:!1,publishedYear:h.publishedYear,categories:h.categories||[],matchReason:h.matchReason,fileUrl:void 0}));return{reply:l.reply||"I'm pondering that thought...",suggestions:c}}catch(t){return console.warn("Concierge Error, using fallback",t),AV(i)}},YA=async i=>{try{const e={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING},isbn:{type:ke.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10."},matchReason:{type:ke.STRING,description:"Why this fits the user's preferences."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},t={type:ke.ARRAY,items:e},n=`
        The user loves these genres: ${i.genres.join(", ")}.
        Their reading goal is: ${i.readingGoal}.
        
        Recommend 4 diverse, highly-rated books that fit this profile.
        Use soft, elegant colors for coverColor as fallback.
        CRITICAL: Provide a valid 'isbn' for each book for cover lookup.
      `,s=await fo.models.generateContent({model:po,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return a_(s.text).map((l,c)=>({id:`gemini-onboarding-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],matchReason:l.matchReason,fileUrl:void 0}))}catch(e){return console.warn("Gemini Onboarding Error, using fallback:",e),EV()}},kV=async(i,e)=>{try{const t={type:ke.OBJECT,properties:{reviewerName:{type:ke.STRING},rating:{type:ke.NUMBER},text:{type:ke.STRING},date:{type:ke.STRING}},required:["reviewerName","rating","text","date"]},n={type:ke.ARRAY,items:t},s=`
      Generate 4 realistic user reviews for "${i}" by ${e}.
      Style: Goodreads or Amazon reviews. 
      Mix of lengths. Some detailed, some short. 
      Vary the ratings (mostly positive but maybe one critical).
    `,o=await fo.models.generateContent({model:po,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=a_(o.text),c=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"];return l.map((h,f)=>({id:`review-${f}`,reviewerName:h.reviewerName,rating:h.rating,text:h.text,date:h.date,avatarColor:c[f%c.length]}))}catch(t){return console.warn("Review Gen Error, using fallback:",t),TV()}},Nk=async(i,e,t)=>{try{const n=`
            You are an expert literary scholar and reading companion.
            Context: The user is currently reading "${i}".
            
            Previous Conversation:
            ${JSON.stringify(t.slice(-5))}
            
            User Question: "${e}"
            
            Answer concisely but deeply. If they ask about plot, be careful with spoilers unless asked.
        `;return(await fo.models.generateContent({model:po,contents:n})).text||"I couldn't generate a response."}catch{return wV(i,e)}},PV=async(i,e="English")=>{try{const t=`Translate the following literary text to ${e}. Preserve the tone and style: "${i}"`;return(await fo.models.generateContent({model:po,contents:t})).text||"Translation failed."}catch{return CV(i)}},LV=async(i,e)=>{try{const t=`The user is reading "${e}" and highlighted this text: "${i}".
        Explain this excerpt in simple terms. Provide necessary context, historical background, or define archaic words.`;return(await fo.models.generateContent({model:po,contents:t})).text||"Could not explain context."}catch{return xV(i,e)}},OV=async(i,e,t=1)=>{try{const n=`
          The user wants to read **Chapter ${t}** of the book "${i}" by ${e}.
          
          Instructions:
          1. Write the FULL text for **Chapter ${t}**. 
          2. If it is a public domain book, provide the exact text.
          3. If it is copyrighted, write a very detailed, high-fidelity narrative adaptation that covers all events, dialogue, and descriptions of the chapter so the user can read it like a real book.
          4. Length: Write at least 800-1200 words. Do not be brief.
          5. Formatting: Use clean HTML. Use <h3> for the Chapter Title. Use <p> for paragraphs.
          
          Do NOT use markdown code blocks. Just return the HTML string.
        `;let o=(await fo.models.generateContent({model:po,contents:n})).text||"<p>Content unavailable.</p>";return o=o.replace(/```html|```/g,"").trim(),o}catch{return RV(i,e,t)}},UV=async i=>{try{const e=`Provide a comprehensive summary of the book "${i}". Cover the main plot points, themes, and character arcs.`;return(await fo.models.generateContent({model:po,contents:e})).text||"Summary unavailable."}catch{return IV(i)}},FV=async i=>{try{const e=`The user is reading "${i}" and has forgotten what happened previously. Provide a quick recap of the beginning/setup of the book to jog their memory.`;return(await fo.models.generateContent({model:po,contents:e})).text||"Recap unavailable."}catch{return NV(i)}},BV=({book:i,onClose:e,onRead:t})=>{const[n,s]=Z.useState([]),[o,l]=Z.useState(!1),[c,h]=Z.useState("reviews"),[f,g]=Z.useState(""),[y,b]=Z.useState([]),[A,w]=Z.useState(!1),C=Z.useRef(null);Z.useEffect(()=>{const I=async()=>{l(!0);const P=await kV(i.title,i.author);s(P),l(!1)};c==="reviews"&&n.length===0&&I()},[i,c]),Z.useEffect(()=>{var I;(I=C.current)==null||I.scrollIntoView({behavior:"smooth"})},[y]);const N=async I=>{if(I.preventDefault(),!f.trim())return;const P=f;g("");const k=[...y,{role:"user",text:P}];b(k),w(!0);try{const L=await Nk(i.title,P,k);b(O=>[...O,{role:"model",text:L}])}catch(L){console.error(L)}finally{w(!1)}};return T.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 animate-spring",children:[T.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:e}),T.jsxs("div",{className:"relative w-full max-w-4xl bg-[#FBFBFD] h-[85vh] rounded-[2rem] shadow-2xl overflow-hidden flex flex-col md:flex-row animate-[scale-up_0.4s_cubic-bezier(0.16,1,0.3,1)]",children:[T.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-gray-100 flex flex-col",children:[T.jsxs("div",{className:"relative h-64 md:h-1/2 w-full flex items-center justify-center overflow-hidden",style:{backgroundColor:i.coverColor},children:[T.jsx("button",{onClick:e,className:"absolute top-4 left-4 p-2 bg-black/10 hover:bg-black/20 text-white rounded-full backdrop-blur-lg transition-colors z-10 md:hidden",children:T.jsx(yh,{size:20})}),T.jsx(Sa,{className:"text-white/80 w-24 h-24 drop-shadow-lg transform hover:scale-105 transition-transform duration-700"}),i.matchReason&&T.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:T.jsxs("div",{className:"bg-white/90 backdrop-blur p-4 rounded-2xl shadow-lg border border-white/50",children:[T.jsxs("p",{className:"text-[10px] uppercase font-bold text-blue-600 mb-1 flex items-center gap-1",children:[T.jsx(bs,{size:10})," Why this book?"]}),T.jsxs("p",{className:"text-xs text-gray-700 font-medium leading-relaxed",children:['"',i.matchReason,'"']})]})})]}),T.jsxs("div",{className:"p-8 flex flex-col flex-1 bg-white",children:[T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 mb-2 leading-tight",children:i.title}),T.jsx("p",{className:"text-lg text-gray-500 font-medium mb-6",children:i.author}),T.jsx("div",{className:"mt-auto space-y-3",children:T.jsxs("button",{onClick:t,className:"w-full bg-[#1D1D1F] text-white py-4 rounded-2xl font-semibold hover:bg-black transition-transform active:scale-95 flex items-center justify-center gap-2 shadow-lg",children:[T.jsx(Sa,{size:18}),"Read"]})})]})]}),T.jsxs("div",{className:"flex-1 flex flex-col bg-[#F5F5F7]",children:[T.jsx("div",{className:"p-6 md:p-8 pb-0 shrink-0",children:T.jsxs("div",{className:"flex justify-between items-start mb-6",children:[T.jsx("div",{className:"flex bg-gray-200/50 p-1 rounded-full relative",children:["reviews","details","chat"].map(I=>T.jsx("button",{onClick:()=>h(I),className:`px-6 py-2 rounded-full text-sm font-semibold transition-all duration-300 relative z-10 ${c===I?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:I.charAt(0).toUpperCase()+I.slice(1)},I))}),T.jsx("button",{onClick:e,className:"hidden md:block p-2 text-gray-400 hover:text-gray-900 bg-white rounded-full shadow-sm hover:shadow transition-all",children:T.jsx(yh,{size:20})})]})}),T.jsxs("div",{className:"flex-1 overflow-y-auto px-6 md:px-8 pb-8",children:[c==="reviews"&&T.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"flex items-center justify-between mb-6",children:[T.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Critics & Readers"}),T.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-gray-500 bg-white px-3 py-1.5 rounded-full shadow-sm",children:[T.jsx(bs,{size:12,className:"text-blue-500"})," Smart Summary"]})]}),i.reviewSnippet&&T.jsxs("div",{className:"mb-8 p-6 bg-blue-50/50 rounded-3xl border border-blue-100/50",children:[T.jsx(YB,{className:"text-blue-200 mb-2 w-8 h-8"}),T.jsx("p",{className:"text-lg font-serif text-gray-800 italic leading-relaxed",children:i.reviewSnippet})]}),o?T.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[T.jsx(ac,{className:"animate-spin text-gray-400 w-8 h-8 mb-4"}),T.jsx("p",{className:"text-gray-400 text-sm",children:"Aggregating reviews..."})]}):T.jsx("div",{className:"grid gap-4",children:n.map(I=>T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-white hover:border-blue-100 transition-colors",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[T.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-sm",style:{backgroundColor:I.avatarColor},children:I.reviewerName.charAt(0)}),T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-bold text-gray-900",children:I.reviewerName}),T.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(P=>T.jsx(LD,{size:10,className:`${P<=I.rating?"text-yellow-400 fill-yellow-400":"text-gray-200"}`},P))})]}),T.jsx("span",{className:"ml-auto text-xs font-medium text-gray-400 bg-gray-50 px-2 py-1 rounded-md",children:I.date})]}),T.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:['"',I.text,'"']})]},I.id))})]}),c==="details"&&T.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"bg-white p-8 rounded-[2rem] shadow-sm",children:[T.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Synopsis"}),T.jsx("p",{className:"text-gray-700 leading-loose font-serif text-lg",children:i.description||"No description provided."})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[T.jsx(kD,{size:18}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Published"})]}),T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.publishedYear||"Unknown"})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[T.jsx(OD,{size:18}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Rights"})]}),T.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Public Domain"})]})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Categories"}),T.jsx("div",{className:"flex flex-wrap gap-2",children:i.categories.map(I=>T.jsx("span",{className:"px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-full text-sm font-medium shadow-sm",children:I},I))})]})]}),c==="chat"&&T.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 pr-2 min-h-[300px]",children:[y.length===0&&T.jsxs("div",{className:"text-center py-12",children:[T.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:T.jsx(bs,{className:"w-8 h-8 text-blue-500"})}),T.jsx("h4",{className:"text-gray-900 font-bold text-lg mb-1",children:"Book Companion"}),T.jsx("p",{className:"text-gray-500 text-sm",children:"Ask about themes, characters, or plot points."})]}),y.map((I,P)=>T.jsx("div",{className:`flex ${I.role==="user"?"justify-end":"justify-start"}`,children:T.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm leading-relaxed shadow-sm ${I.role==="user"?"bg-blue-600 text-white rounded-br-sm":"bg-white text-gray-800 rounded-bl-sm border border-gray-100"}`,children:I.text})},P)),A&&T.jsx("div",{className:"flex justify-start",children:T.jsx("div",{className:"bg-white border border-gray-100 p-4 rounded-2xl rounded-bl-sm shadow-sm",children:T.jsx(ac,{size:16,className:"animate-spin text-gray-400"})})}),T.jsx("div",{ref:C})]}),T.jsxs("form",{onSubmit:N,className:"relative mt-auto",children:[T.jsx("input",{type:"text",placeholder:"Ask a question...",className:"w-full pl-6 pr-14 py-4 bg-white border-0 shadow-lg shadow-gray-200/50 rounded-full focus:ring-2 focus:ring-blue-500 outline-none text-base font-medium placeholder:text-gray-400 transition-all",value:f,onChange:I=>g(I.target.value)}),T.jsx("button",{type:"submit",disabled:!f.trim()||A,className:"absolute right-2 top-2 p-2.5 bg-black text-white rounded-full hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-90",children:T.jsx(yw,{size:18})})]})]})]})]})]})]})},bi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ME=[.001,0,0,.001,0,0],XA=1.35,ms={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ro={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Bg="pdfjs_internal_editor_",Oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},tt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Mk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Vn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Lg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},cn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},th={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Iy={ERRORS:0,WARNINGS:1,INFOS:5},ep={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},fv={moveTo:0,lineTo:1,curveTo:2,closePath:3},Dk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let l_=Iy.WARNINGS;function HV(i){Number.isInteger(i)&&(l_=i)}function GV(){return l_}function c_(i){l_>=Iy.INFOS&&console.info(`Info: ${i}`)}function Ue(i){l_>=Iy.WARNINGS&&console.warn(`Warning: ${i}`)}function Ut(i){throw new Error(i)}function it(i,e){i||Ut(e)}function zV(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Rw(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const s=i.match(/\./g);(s==null?void 0:s.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=XV(i)}catch{}}const n=e?URL.parse(i,e):URL.parse(i);return zV(n)?n:null}function Iw(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&Rw(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ve(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const dd=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class oM extends dd{constructor(e,t){super(e,"PasswordException"),this.code=t}}class WA extends dd{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class gb extends dd{constructor(e){super(e,"InvalidPDFException")}}class Hg extends dd{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class VV extends dd{constructor(e){super(e,"FormatError")}}class xa extends dd{constructor(e){super(e,"AbortException")}}function kk(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&Ut("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),l=i.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function Ny(i){typeof i!="string"&&Ut("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function qV(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function $V(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function YV(){try{return new Function(""),!0}catch{return!1}}class On{static get isLittleEndian(){return Ve(this,"isLittleEndian",$V())}static get isEvalSupported(){return Ve(this,"isEvalSupported",YV())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ve(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const KA=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Ta,Cv,DE;class be{static makeHexColor(e,t,n){return`#${KA[e]}${KA[t]}${KA[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5];for(let g=0;g<6;g+=2){const y=e[n+g],b=e[n+g+1];e[n+g]=y*s+b*l+h,e[n+g+1]=y*o+b*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],g=e[0],y=e[1],b=e[2],A=e[3];let w=s*g+h,C=w,N=s*b+h,I=N,P=c*y+f,k=P,L=c*A+f,O=L;if(o!==0||l!==0){const U=o*g,F=o*b,K=l*y,q=l*A;w+=K,I+=K,N+=q,C+=q,P+=U,O+=U,L+=F,k+=F}n[0]=Math.min(n[0],w,N,C,I),n[1]=Math.min(n[1],P,L,k,O),n[2]=Math.max(n[2],w,N,C,I),n[3]=Math.max(n[3],P,L,k,O)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],l=e[3],c=n**2+s**2,h=n*o+s*l,f=o**2+l**2,g=(c+f)/2,y=Math.sqrt(g**2-(c*f-h**2));t[0]=Math.sqrt(g+y||1),t[1]=Math.sqrt(g-y||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[n,o,s,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static bezierBoundingBox(e,t,n,s,o,l,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),M(this,Ta,DE).call(this,e,n,o,c,t,s,l,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),M(this,Ta,DE).call(this,e,n,o,c,t,s,l,h,3*(-t+3*(s-l)+h),6*(t-2*s+l),3*(s-t),f)}}Ta=new WeakSet,Cv=function(e,t,n,s,o,l,c,h,f,g){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*e+3*f*t)+3*b*n)+A*s,C=y*(y*(y*o+3*f*l)+3*b*c)+A*h;g[0]=Math.min(g[0],w),g[1]=Math.min(g[1],C),g[2]=Math.max(g[2],w),g[3]=Math.max(g[3],C)},DE=function(e,t,n,s,o,l,c,h,f,g,y,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&M(this,Ta,Cv).call(this,e,t,n,s,o,l,c,h,-y/g,b);return}const A=g**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),C=2*f;M(this,Ta,Cv).call(this,e,t,n,s,o,l,c,h,(-g+w)/C,b),M(this,Ta,Cv).call(this,e,t,n,s,o,l,c,h,(-g-w)/C,b)},R(be,Ta);function XV(i){return decodeURIComponent(escape(i))}let JA=null,aM=null;function Pk(i){return JA||(JA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aM=new Map([["","t"]])),i.replaceAll(JA,(e,t,n)=>t?t.normalize("NFKC"):aM.get(n))}function Nw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),kk(i)}const Mw="pdfjs_internal_id_";function WV(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!i(n)&&!Number.isInteger(n)||!e(s))return!1;const l=o.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function li(i,e,t){return Math.min(Math.max(i,e),t)}function Lk(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(kk(i))}function KV(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):Ny(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});class Gg{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){var h;if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(Gg.shouldBuildText(c))(h=o==null?void 0:o.attributes)!=null&&h.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const f of o.children)s(f)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Dw{static setupStorage(e,t,n,s,o){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var y,b;const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(l),e.viewport){const A=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=A}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const A=document.createTextNode(s.value);l.append(A),c&&Gg.shouldBuildText(s.name)&&f.push(A)}return{textDivs:f}}const g=[[s,-1,l]];for(;g.length>0;){const[A,w,C]=g.at(-1);if(w+1===A.children.length){g.pop();continue}const N=A.children[++g.at(-1)[1]];if(N===null)continue;const{name:I}=N;if(I==="#text"){const k=document.createTextNode(N.value);f.push(k),C.append(k);continue}const P=(y=N==null?void 0:N.attributes)!=null&&y.xmlns?document.createElementNS(N.attributes.xmlns,I):document.createElement(I);if(C.append(P),N.attributes&&this.setAttributes({html:P,element:N,storage:t,intent:o,linkService:n}),((b=N.children)==null?void 0:b.length)>0)g.push([N,-1,P]);else if(N.value){const k=document.createTextNode(N.value);c&&Gg.shouldBuildText(I)&&f.push(k),P.append(k)}}for(const A of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Po="http://www.w3.org/2000/svg",Gc=class Gc{};ce(Gc,"CSS",96),ce(Gc,"PDF",72),ce(Gc,"PDF_TO_CSS_UNITS",Gc.CSS/Gc.PDF);let Ra=Gc;async function ap(i,e="text"){if(dg(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class My{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let g,y,b,A;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,y=0,b=0,A=1;break;case 90:g=0,y=1,b=1,A=0;break;case 270:g=0,y=-1,b=-1,A=0;break;case 0:g=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(b=-b,A=-A);let w,C,N,I;g===0?(w=Math.abs(f-e[1])*n+o,C=Math.abs(h-e[0])*n+l,N=(e[3]-e[1])*n,I=(e[2]-e[0])*n):(w=Math.abs(h-e[0])*n+o,C=Math.abs(f-e[1])*n+l,N=(e[2]-e[0])*n,I=(e[3]-e[1])*n),this.transform=[g*n,y*n,b*n,A*n,w-g*n*h-b*n*f,C-y*n*h-A*n*f],this.width=N,this.height=I}get rawDims(){const e=this.viewBox;return Ve(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new My({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return be.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];be.applyTransform(t,this.transform);const n=[e[2],e[3]];return be.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return be.applyInverseTransform(n,this.transform),n}}class u_ extends dd{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Dy(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function d_(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function Ok(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function Uk(i,e="document.pdf"){if(typeof i!="string")return e;if(Dy(i))return Ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class lM{constructor(){ce(this,"started",Object.create(null));ce(this,"times",[])}time(e){e in this.started&&Ue(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ue(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function dg(i,e){const t=e?URL.parse(i,e):URL.parse(i);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function As(i){i.preventDefault()}function Jt(i){i.preventDefault(),i.stopPropagation()}function JV(i){console.log("Deprecated API usage: "+i)}var Kg;class zg{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;d(this,Kg)||E(this,Kg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=d(this,Kg).exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let g=parseInt(t[8],10);g=g>=0&&g<=23?g:0;let y=parseInt(t[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=g,c+=y):f==="+"&&(l-=g,c-=y),new Date(Date.UTC(n,s,o,l,c,h))}}Kg=new WeakMap,R(zg,Kg);function Fk(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new My({viewBox:o,userUnit:1,scale:e,rotation:t})}function lp(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ue(`Not a valid color format: "${i}"`),[0,0,0])}function jV(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,lp(n))}e.remove()}function Kt(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform();return[e,t,n,s,o,l]}function kr(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform().invertSelf();return[e,t,n,s,o,l]}function uc(i,e,t=!1,n=!0){if(e instanceof My){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:l}=i,c=On.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,g=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(l.width=g,l.height=y):(l.width=y,l.height=g)}n&&i.setAttribute("data-main-rotation",e.rotation)}class Tr{constructor(){const{pixelRatio:e}=Tr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let l=1/0,c=1/0,h=1/0;n=Tr.capPixels(n,o),n>0&&(l=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const mb=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class QV{static get isDarkMode(){var e;return Ve(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class Bk{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Ve(this,"commentForegroundColor",lp(n))}}function Hk(i,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return i=Math.round(i*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[i,e,t]}function cM(i,e){const t=i[0]/255,n=i[1]/255,s=i[2]/255,o=Math.max(t,n,s),l=Math.min(t,n,s),c=(o+l)/2;if(o===l)e[0]=e[1]=0;else{const h=o-l;switch(e[1]=c<.5?h/(o+l):h/(2-o-l),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function kE(i,e){const t=i[0],n=i[1],s=i[2],o=(1-Math.abs(2*s-1))*n,l=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=o+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=l+c;break}}function uM(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function dM(i,e,t){kE(i,t),t.map(uM);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];kE(e,t),t.map(uM);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const hM=new Map;function Gk(i,e){const t=i[0]+i[1]*256+i[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=hM.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),l=s.subarray(3,6);cM(i,l);const c=s.subarray(6,9);cM(e,c);const h=c[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),dM(l,c,o)<f){let g,y;h?(g=l[2],y=1):(g=0,y=l[2]);const b=.005;for(;y-g>b;){const A=l[2]=(g+y)/2;h===dM(l,c,o)<f?g=A:y=A}l[2]=h?y:g}return kE(l,o),n=be.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),hM.set(t,n),n}function kw({html:i,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof i=="string"){const o=document.createElement("p");o.dir=e||"auto";const l=i.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const f=l[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else Dw.render({xfaHtml:i,div:s,intent:"richText"});s.firstChild.classList.add("richText",t),n.append(s)}var fl,pl,Fs,Bs,Jg,gl,xh,Rh,jg,Ob,zk,jn,Vk,qk,nh,hg;const Uo=class Uo{constructor(e){R(this,jn);R(this,fl,null);R(this,pl,null);R(this,Fs);R(this,Bs,null);R(this,Jg,null);R(this,gl,null);R(this,xh,null);R(this,Rh,null);E(this,Fs,e),d(Uo,jg)||E(Uo,jg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=E(this,fl,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=d(this,Fs)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",As,{signal:t}),e.addEventListener("pointerdown",M(Uo,Ob,zk),{signal:t}));const n=E(this,Bs,document.createElement("div"));n.className="buttons",e.append(n);const s=d(this,Fs).toolbarPosition;if(s){const{style:o}=e,l=d(this,Fs)._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return d(this,fl)}hide(){var e;d(this,fl).classList.add("hidden"),(e=d(this,pl))==null||e.hideDropdown()}show(){var e,t;d(this,fl).classList.remove("hidden"),(e=d(this,Jg))==null||e.shown(),(t=d(this,gl))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=d(this,Fs),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",d(Uo,jg)[e]),M(this,jn,nh).call(this,n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),d(this,Bs).append(n)}async addAltText(e){const t=await e.render();M(this,jn,nh).call(this,t),d(this,Bs).append(t,d(this,jn,hg)),E(this,Jg,e)}addComment(e,t=null){if(d(this,gl))return;const n=e.renderForToolbar();if(!n)return;M(this,jn,nh).call(this,n);const s=E(this,xh,d(this,jn,hg));t?(d(this,Bs).insertBefore(n,t),d(this,Bs).insertBefore(s,t)):d(this,Bs).append(n,s),E(this,gl,e),e.toolbar=this}addColorPicker(e){if(d(this,pl))return;E(this,pl,e);const t=e.renderButton();M(this,jn,nh).call(this,t),d(this,Bs).append(t,d(this,jn,hg))}async addEditSignatureButton(e){const t=E(this,Rh,await e.renderEditButton(d(this,Fs)));M(this,jn,nh).call(this,t),d(this,Bs).append(t,d(this,jn,hg))}removeButton(e){var t,n;switch(e){case"comment":(t=d(this,gl))==null||t.removeToolbarCommentButton(),E(this,gl,null),(n=d(this,xh))==null||n.remove(),E(this,xh,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,n){const s=d(this,Bs).querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){d(this,Rh)&&(d(this,Rh).title=e)}remove(){var e;d(this,fl).remove(),(e=d(this,pl))==null||e.destroy(),E(this,pl,null)}};fl=new WeakMap,pl=new WeakMap,Fs=new WeakMap,Bs=new WeakMap,Jg=new WeakMap,gl=new WeakMap,xh=new WeakMap,Rh=new WeakMap,jg=new WeakMap,Ob=new WeakSet,zk=function(e){e.stopPropagation()},jn=new WeakSet,Vk=function(e){d(this,Fs)._focusEventsAllowed=!1,Jt(e)},qk=function(e){d(this,Fs)._focusEventsAllowed=!0,Jt(e)},nh=function(e){const t=d(this,Fs)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",M(this,jn,Vk).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",M(this,jn,qk).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",As,{signal:t}),!0)},hg=function(){const e=document.createElement("div");return e.className="divider",e},R(Uo,Ob),R(Uo,jg,null);let PE=Uo;var Qg,$c,Bo,Da,$k,Yk,LE;class ZV{constructor(e){R(this,Da);R(this,Qg,null);R(this,$c,null);R(this,Bo);E(this,Bo,e)}show(e,t,n){const[s,o]=M(this,Da,Yk).call(this,t,n),{style:l}=d(this,$c)||E(this,$c,M(this,Da,$k).call(this));e.append(d(this,$c)),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){d(this,$c).remove()}}Qg=new WeakMap,$c=new WeakMap,Bo=new WeakMap,Da=new WeakSet,$k=function(){const e=E(this,$c,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=d(this,Bo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",As,{signal:t});const n=E(this,Qg,document.createElement("div"));return n.className="buttons",e.append(n),d(this,Bo).hasCommentManager()&&M(this,Da,LE).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{d(this,Bo).commentSelection("floating_button")}),M(this,Da,LE).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{d(this,Bo).highlightSelection("floating_button")}),e},Yk=function(e,t){let n=0,s=0;for(const o of e){const l=o.y+o.height;if(l<n)continue;const c=o.x+(t?o.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]},LE=function(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=d(this,Bo)._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",As,{signal:c}),o.addEventListener("click",s,{signal:c})),d(this,Qg).append(o)};function Xk(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}var Ub;class eq{constructor(){R(this,Ub,0)}get id(){return`${Bg}${Sn(this,Ub)._++}`}}Ub=new WeakMap;var Ih,Zg,ni,Nh,xv;const lC=class lC{constructor(){R(this,Nh);R(this,Ih,Nw());R(this,Zg,0);R(this,ni,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ve(this,"_isSVGFittingCanvas",o)}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return M(this,Nh,xv).call(this,`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return M(this,Nh,xv).call(this,e,e)}async getFromBlob(e,t){const n=await t;return M(this,Nh,xv).call(this,e,n)}async getFromId(e){d(this,ni)||E(this,ni,new Map);const t=d(this,ni).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){d(this,ni)||E(this,ni,new Map);let n=d(this,ni).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${d(this,Ih)}_${Sn(this,Zg)._++}`,refCounter:1,isSvg:!1},d(this,ni).set(e,n),d(this,ni).set(n.id,n),n}getSvgUrl(e){const t=d(this,ni).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;d(this,ni)||E(this,ni,new Map);const t=d(this,ni).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const o=new OffscreenCanvas(n.width,n.height);o.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=o.convertToBlob()}(s=n.close)==null||s.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${d(this,Ih)}_`)}};Ih=new WeakMap,Zg=new WeakMap,ni=new WeakMap,Nh=new WeakSet,xv=async function(e,t){d(this,ni)||E(this,ni,new Map);let n=d(this,ni).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${d(this,Ih)}_${Sn(this,Zg)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(n.url=t,s=await ap(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=lC._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},l.onload=async()=>{const y=n.svgUrl=l.result;c.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},c.onerror=l.onerror=g});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Ue(s),n=null}return d(this,ni).set(e,n),n&&d(this,ni).set(n.id,n),n};let OE=lC;var un,ml,em,Wt;class tq{constructor(e=128){R(this,un,[]);R(this,ml,!1);R(this,em);R(this,Wt,-1);E(this,em,e)}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),d(this,ml))return;const h={cmd:e,undo:t,post:n,type:o};if(d(this,Wt)===-1){d(this,un).length>0&&(d(this,un).length=0),E(this,Wt,0),d(this,un).push(h);return}if(l&&d(this,un)[d(this,Wt)].type===o){c&&(h.undo=d(this,un)[d(this,Wt)].undo),d(this,un)[d(this,Wt)]=h;return}const f=d(this,Wt)+1;f===d(this,em)?d(this,un).splice(0,1):(E(this,Wt,f),f<d(this,un).length&&d(this,un).splice(f)),d(this,un).push(h)}undo(){if(d(this,Wt)===-1)return;E(this,ml,!0);const{undo:e,post:t}=d(this,un)[d(this,Wt)];e(),t==null||t(),E(this,ml,!1),E(this,Wt,d(this,Wt)-1)}redo(){if(d(this,Wt)<d(this,un).length-1){E(this,Wt,d(this,Wt)+1),E(this,ml,!0);const{cmd:e,post:t}=d(this,un)[d(this,Wt)];e(),t==null||t(),E(this,ml,!1)}}hasSomethingToUndo(){return d(this,Wt)!==-1}hasSomethingToRedo(){return d(this,Wt)<d(this,un).length-1}cleanType(e){if(d(this,Wt)!==-1){for(let t=d(this,Wt);t>=0;t--)if(d(this,un)[t].type!==e){d(this,un).splice(t+1,d(this,Wt)-t),E(this,Wt,t);return}d(this,un).length=0,E(this,Wt,-1)}}destroy(){E(this,un,null)}}un=new WeakMap,ml=new WeakMap,em=new WeakMap,Wt=new WeakMap;var Fb,Wk;class ky{constructor(e){R(this,Fb);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=On.platform;for(const[n,s,o={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(M(this,Fb,Wk).call(this,t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),o||Jt(t))}}Fb=new WeakSet,Wk=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Bb=class Bb{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return jV(e),Ve(this,"_colors",e)}convert(e){const t=lp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,l)=>o===t[l]))return Bb._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?be.makeHexColor(...t):e}};ce(Bb,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let UE=Bb;var Mh,Zi,Dh,tn,En,kh,Hs,Ph,Gs,ii,yl,vl,Lh,bl,Or,zs,Yc,tm,nm,Oh,im,Ur,_l,Uh,Sl,Fr,Hb,Al,Fh,sm,El,Xc,Bh,Tl,rm,vn,vt,Ho,wl,Cl,om,Hh,am,xl,Br,Go,lm,cm,Vs,he,Rv,FE,Kk,Jk,fg,jk,Qk,Zk,BE,eP,HE,GE,tP,fi,Lo,nP,iP,zE,sP,pg,VE;const fh=class fh{constructor(e,t,n,s,o,l,c,h,f,g,y,b,A,w,C,N){R(this,he);R(this,Mh,new AbortController);R(this,Zi,null);R(this,Dh,null);R(this,tn,new Map);R(this,En,new Map);R(this,kh,null);R(this,Hs,null);R(this,Ph,null);R(this,Gs,new tq);R(this,ii,null);R(this,yl,null);R(this,vl,null);R(this,Lh,0);R(this,bl,new Set);R(this,Or,null);R(this,zs,null);R(this,Yc,new Set);ce(this,"_editorUndoBar",null);R(this,tm,!1);R(this,nm,!1);R(this,Oh,!1);R(this,im,null);R(this,Ur,null);R(this,_l,null);R(this,Uh,null);R(this,Sl,!1);R(this,Fr,null);R(this,Hb,new eq);R(this,Al,!1);R(this,Fh,!1);R(this,sm,!1);R(this,El,null);R(this,Xc,null);R(this,Bh,null);R(this,Tl,null);R(this,rm,null);R(this,vn,Oe.NONE);R(this,vt,new Set);R(this,Ho,null);R(this,wl,null);R(this,Cl,null);R(this,om,null);R(this,Hh,null);R(this,am,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});R(this,xl,[0,0]);R(this,Br,null);R(this,Go,null);R(this,lm,null);R(this,cm,null);R(this,Vs,null);const I=this._signal=d(this,Mh).signal;E(this,Go,e),E(this,lm,t),E(this,cm,n),E(this,kh,s),E(this,ii,o),E(this,wl,l),E(this,Hh,h),this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:I}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:I}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:I}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:I}),c._on("setpreference",this.onSetPreference.bind(this),{signal:I}),c._on("switchannotationeditorparams",P=>this.updateParams(P.type,P.value),{signal:I}),window.addEventListener("pointerdown",()=>{E(this,Fh,!0)},{capture:!0,signal:I}),window.addEventListener("pointerup",()=>{E(this,Fh,!1)},{capture:!0,signal:I}),M(this,he,jk).call(this),M(this,he,tP).call(this),M(this,he,BE).call(this),E(this,Hs,h.annotationStorage),E(this,im,h.filterFactory),E(this,Cl,f),E(this,Uh,g||null),E(this,tm,y),E(this,nm,b),E(this,Oh,A),E(this,rm,w||null),this.viewParameters={realScale:Ra.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=C||null,this._supportsPinchToZoom=N!==!1,o==null||o.setSidebarUiManager(this)}static get _keyboardManager(){const e=fh.prototype,t=l=>d(l,Go).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new ky([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Go).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Go).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}destroy(){var e,t,n,s,o,l,c,h,f;(e=d(this,Vs))==null||e.resolve(),E(this,Vs,null),(t=d(this,Mh))==null||t.abort(),E(this,Mh,null),this._signal=null;for(const g of d(this,En).values())g.destroy();d(this,En).clear(),d(this,tn).clear(),d(this,Yc).clear(),(n=d(this,Tl))==null||n.clear(),E(this,Zi,null),d(this,vt).clear(),d(this,Gs).destroy(),(s=d(this,kh))==null||s.destroy(),(o=d(this,ii))==null||o.destroy(),(l=d(this,wl))==null||l.destroy(),(c=d(this,Fr))==null||c.hide(),E(this,Fr,null),(h=d(this,Bh))==null||h.destroy(),E(this,Bh,null),E(this,Dh,null),d(this,Ur)&&(clearTimeout(d(this,Ur)),E(this,Ur,null)),d(this,Br)&&(clearTimeout(d(this,Br)),E(this,Br,null)),(f=this._editorUndoBar)==null||f.destroy(),E(this,Hh,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return d(this,rm)}get useNewAltTextFlow(){return d(this,nm)}get useNewAltTextWhenAddingImage(){return d(this,Oh)}get hcmFilter(){return Ve(this,"hcmFilter",d(this,Cl)?d(this,im).addHCMFilter(d(this,Cl).foreground,d(this,Cl).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(d(this,Go)).direction)}get _highlightColors(){return Ve(this,"_highlightColors",d(this,Uh)?new Map(d(this,Uh).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ve(this,"highlightColors",null);const t=new Map,n=!!d(this,Cl);for(const[s,o]of e){const l=s.endsWith("_HCM");if(n&&l){t.set(s.replace("_HCM",""),o);continue}!n&&!l&&t.set(s,o)}return Ve(this,"highlightColors",t)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),E(this,vl,e)}setMainHighlightColorPicker(e){E(this,Bh,e)}editAltText(e,t=!1){var n;(n=d(this,kh))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!d(this,ii)}editComment(e,t,n,s){var o;(o=d(this,ii))==null||o.showDialog(this,e,t,n,s)}selectComment(e,t){const n=d(this,En).get(e),s=n==null?void 0:n.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=d(this,ii))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=d(this,ii))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=d(this,ii))==null||t.removeComments([e.uid])}toggleComment(e,t,n=void 0){var s;(s=d(this,ii))==null||s.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){var n;return e&&((n=d(this,ii))==null?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=d(this,ii))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(d(this,En).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){var t;(t=d(this,wl))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return d(this,wl)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":E(this,Oh,t);break}}onPageChanging({pageNumber:e}){E(this,Lh,e-1)}focusMainContainer(){d(this,Go).focus()}findParent(e,t){for(const n of d(this,En).values()){const{x:s,y:o,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){d(this,lm).classList.toggle("noUserSelect",e)}addShouldRescale(e){d(this,Yc).add(e)}removeShouldRescale(e){d(this,Yc).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Ra.PDF_TO_CSS_UNITS;for(const n of d(this,Yc))n.onScaleChanging();(t=d(this,vl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c}=n,h=n.toString(),g=M(this,he,Rv).call(this,n).closest(".textLayer"),y=this.getSelectionBoxes(g);if(!y)return;n.empty();const b=M(this,he,FE).call(this,g),A=d(this,vn)===Oe.NONE,w=()=>{const C=b==null?void 0:b.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:y,anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c,text:h});A&&this.showAllEditors("highlight",!0,!0),t&&(C==null||C.editComment())};if(A){this.switchToMode(Oe.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!d(this,Hs))return null;const t=`${Bg}${e}`,n=d(this,Hs).getRawValue(t);return n&&d(this,Hs).remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&d(this,Hs)&&!d(this,Hs).has(e.id)&&d(this,Hs).setValue(e.id,e)}a11yAlert(e,t=null){const n=d(this,cm);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,d(this,Sl)&&(E(this,Sl,!1),M(this,he,fg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of d(this,vt))if(t.div.contains(e)){E(this,Xc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!d(this,Xc))return;const[e,t]=d(this,Xc);E(this,Xc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){M(this,he,BE).call(this),M(this,he,HE).call(this)}removeEditListeners(){M(this,he,eP).call(this),M(this,he,GE).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of d(this,zs))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of d(this,zs))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=d(this,Zi))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of d(this,vt)){const o=s.serialize(!0);o&&t.push(o)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of d(this,zs))if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){Ue(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)M(this,he,zE).call(this,h);M(this,he,VE).call(this,o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){Ue(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),d(this,vn)!==Oe.NONE&&!this.isEditorHandlingKeyboard&&fh._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,d(this,Sl)&&(E(this,Sl,!1),M(this,he,fg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(M(this,he,Qk).call(this),M(this,he,HE).call(this),M(this,he,fi).call(this,{isEditing:d(this,vn)!==Oe.NONE,isEmpty:M(this,he,pg).call(this),hasSomethingToUndo:d(this,Gs).hasSomethingToUndo(),hasSomethingToRedo:d(this,Gs).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,he,Zk).call(this),M(this,he,GE).call(this),M(this,he,fi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!d(this,zs)){E(this,zs,e);for(const t of d(this,zs))M(this,he,Lo).call(this,t.defaultPropertiesToUpdate)}}getId(){return d(this,Hb).id}get currentLayer(){return d(this,En).get(d(this,Lh))}getLayer(e){return d(this,En).get(e)}get currentPageIndex(){return d(this,Lh)}addLayer(e){d(this,En).set(e.pageIndex,e),d(this,Al)?e.enable():e.disable()}removeLayer(e){d(this,En).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){var l,c,h,f,g,y;if(d(this,vn)!==e&&!(d(this,Vs)&&(await d(this,Vs).promise,!d(this,Vs)))){if(E(this,Vs,Promise.withResolvers()),(l=d(this,vl))==null||l.commitOrRemove(),d(this,vn)===Oe.POPUP&&((c=d(this,ii))==null||c.hideSidebar()),(h=d(this,ii))==null||h.destroyPopup(),E(this,vn,e),e===Oe.NONE){this.setEditingState(!1),M(this,he,iP).call(this);for(const b of d(this,tn).values())b.hideStandaloneCommentButton();(f=this._editorUndoBar)==null||f.hide(),this.toggleComment(null),d(this,Vs).resolve();return}for(const b of d(this,tn).values())b.addStandaloneCommentButton();e===Oe.SIGNATURE&&await((g=d(this,wl))==null?void 0:g.loadSignatures()),this.setEditingState(!0),await M(this,he,nP).call(this),this.unselectAll();for(const b of d(this,En).values())b.updateMode(e);if(e===Oe.POPUP){d(this,Dh)||E(this,Dh,await d(this,Hh).getAnnotationsByType(new Set(d(this,zs).map(w=>w._editorType))));const b=new Set,A=[];for(const w of d(this,tn).values()){const{annotationElementId:C,hasComment:N,deleted:I}=w;C&&b.add(C),N&&!I&&A.push(w.getData())}for(const w of d(this,Dh)){const{id:C,popupRef:N,contentsObj:I}=w;N&&(I!=null&&I.str)&&!b.has(C)&&!d(this,bl).has(C)&&A.push(w)}(y=d(this,ii))==null||y.showSidebar(A)}if(!t){n&&this.addNewEditorFromKeyboard(),d(this,Vs).resolve();return}for(const b of d(this,tn).values())b.uid===t?(this.setSelected(b),o?b.editComment():s?b.enterInEditMode():b.focus()):b.unselect();d(this,Vs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==d(this,vn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(d(this,zs)){switch(e){case tt.CREATE:this.currentLayer.addNewEditor(t);return;case tt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d(this,om)||E(this,om,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of d(this,vt))n.updateParams(e,t);else for(const n of d(this,zs))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var o;for(const l of d(this,tn).values())l.editorType===e&&l.show(t);(((o=d(this,om))==null?void 0:o.get(tt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&M(this,he,Lo).call(this,[[tt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(d(this,sm)!==e){E(this,sm,e);for(const t of d(this,En).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of d(this,tn).values())t.pageIndex===e&&(yield t)}getEditor(e){return d(this,tn).get(e)}addEditor(e){d(this,tn).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(d(this,Ur)&&clearTimeout(d(this,Ur)),E(this,Ur,setTimeout(()=>{this.focusMainContainer(),E(this,Ur,null)},0))),d(this,tn).delete(e.id),e.annotationElementId&&((t=d(this,Tl))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!d(this,bl).has(e.annotationElementId))&&((n=d(this,Hs))==null||n.remove(e.id))}addDeletedAnnotationElement(e){d(this,bl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return d(this,bl).has(e)}removeDeletedAnnotationElement(e){d(this,bl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){d(this,Zi)!==e&&(E(this,Zi,e),e&&M(this,he,Lo).call(this,e.propertiesToUpdate))}updateUI(e){d(this,he,sP)===e&&M(this,he,Lo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){M(this,he,Lo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(d(this,vt).has(e)){d(this,vt).delete(e),e.unselect(),M(this,he,fi).call(this,{hasSelectedEditor:this.hasSelection});return}d(this,vt).add(e),e.select(),M(this,he,Lo).call(this,e.propertiesToUpdate),M(this,he,fi).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=d(this,vl))==null||t.commitOrRemove();for(const n of d(this,vt))n!==e&&n.unselect();d(this,vt).clear(),d(this,vt).add(e),e.select(),M(this,he,Lo).call(this,e.propertiesToUpdate),M(this,he,fi).call(this,{hasSelectedEditor:!0})}isSelected(e){return d(this,vt).has(e)}get firstSelectedEditor(){return d(this,vt).values().next().value}unselect(e){e.unselect(),d(this,vt).delete(e),M(this,he,fi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return d(this,vt).size!==0}get isEnterHandled(){return d(this,vt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;d(this,Gs).undo(),M(this,he,fi).call(this,{hasSomethingToUndo:d(this,Gs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,he,pg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){d(this,Gs).redo(),M(this,he,fi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(this,Gs).hasSomethingToRedo(),isEmpty:M(this,he,pg).call(this)})}addCommands(e){d(this,Gs).add(e),M(this,he,fi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,he,pg).call(this)})}cleanUndoStack(e){d(this,Gs).cleanType(e)}delete(){var o;this.commitOrRemove();const e=(o=this.currentLayer)==null?void 0:o.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...d(this,vt)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(s,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},s=()=>{for(const l of t)M(this,he,zE).call(this,l)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=d(this,Zi))==null||e.commitOrRemove()}hasSomethingToControl(){return d(this,Zi)||this.hasSelection}selectAll(){for(const e of d(this,vt))e.commit();M(this,he,VE).call(this,d(this,tn).values())}unselectAll(){var e;if(!(d(this,Zi)&&(d(this,Zi).commitOrRemove(),d(this,vn)!==Oe.NONE))&&!((e=d(this,vl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of d(this,vt))t.unselect();d(this,vt).clear(),M(this,he,fi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;d(this,xl)[0]+=e,d(this,xl)[1]+=t;const[s,o]=d(this,xl),l=[...d(this,vt)],c=1e3;d(this,Br)&&clearTimeout(d(this,Br)),E(this,Br,setTimeout(()=>{E(this,Br,null),d(this,xl)[0]=d(this,xl)[1]=0,this.addCommands({cmd:()=>{for(const h of l)d(this,tn).has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of l)d(this,tn).has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c));for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),E(this,Or,new Map);for(const e of d(this,vt))d(this,Or).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!d(this,Or))return!1;this.disableUserSelect(!1);const e=d(this,Or);E(this,Or,null);let t=!1;for(const[{x:s,y:o,pageIndex:l},c]of e)c.newX=s,c.newY=o,c.newPageIndex=l,t||(t=s!==c.savedX||o!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(s,o,l,c)=>{if(d(this,tn).has(s.id)){const h=d(this,En).get(c);h?s._setParentAndPosition(h,o,l):(s.pageIndex=c,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:c}]of e)n(s,o,l,c)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:c}]of e)n(s,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(d(this,Or))for(const n of d(this,Or).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||d(this,vt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return d(this,Zi)===e}getActive(){return d(this,Zi)}getMode(){return d(this,vn)}isEditingMode(){return d(this,vn)!==Oe.NONE}get imageManager(){return Ve(this,"imageManager",new OE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,g=t.rangeCount;f<g;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,g,y,b)=>({x:(g-s)/l,y:1-(f+y-n)/o,width:b/l,height:y/o});break;case"180":c=(f,g,y,b)=>({x:1-(f+y-n)/o,y:1-(g+b-s)/l,width:y/o,height:b/l});break;case"270":c=(f,g,y,b)=>({x:1-(g+b-s)/l,y:(f-n)/o,width:b/l,height:y/o});break;default:c=(f,g,y,b)=>({x:(f-n)/o,y:(g-s)/l,width:y/o,height:b/l});break}const h=[];for(let f=0,g=t.rangeCount;f<g;f++){const y=t.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:C}of y.getClientRects())w===0||C===0||h.push(c(b,A,w,C))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(d(this,Ph)||E(this,Ph,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=d(this,Ph))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=d(this,Ph))==null?void 0:s.get(e.data.id);if(!t)return;const n=d(this,Hs).getRawValue(t);n&&(d(this,vn)===Oe.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var o;const s=(o=d(this,Tl))==null?void 0:o.get(e);s&&(s.setCanvas(t,n),d(this,Tl).delete(e))}addMissingCanvas(e,t){(d(this,Tl)||E(this,Tl,new Map)).set(e,t)}};Mh=new WeakMap,Zi=new WeakMap,Dh=new WeakMap,tn=new WeakMap,En=new WeakMap,kh=new WeakMap,Hs=new WeakMap,Ph=new WeakMap,Gs=new WeakMap,ii=new WeakMap,yl=new WeakMap,vl=new WeakMap,Lh=new WeakMap,bl=new WeakMap,Or=new WeakMap,zs=new WeakMap,Yc=new WeakMap,tm=new WeakMap,nm=new WeakMap,Oh=new WeakMap,im=new WeakMap,Ur=new WeakMap,_l=new WeakMap,Uh=new WeakMap,Sl=new WeakMap,Fr=new WeakMap,Hb=new WeakMap,Al=new WeakMap,Fh=new WeakMap,sm=new WeakMap,El=new WeakMap,Xc=new WeakMap,Bh=new WeakMap,Tl=new WeakMap,rm=new WeakMap,vn=new WeakMap,vt=new WeakMap,Ho=new WeakMap,wl=new WeakMap,Cl=new WeakMap,om=new WeakMap,Hh=new WeakMap,am=new WeakMap,xl=new WeakMap,Br=new WeakMap,Go=new WeakMap,lm=new WeakMap,cm=new WeakMap,Vs=new WeakMap,he=new WeakSet,Rv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},FE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of d(this,En).values())if(n.hasTextLayer(e))return n;return null},Kk=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=M(this,he,Rv).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(d(this,Fr)||E(this,Fr,new ZV(this)),d(this,Fr).show(n,s,this.direction==="ltr"))},Jk=function(){var o,l,c;const e=document.getSelection();if(!e||e.isCollapsed){d(this,Ho)&&((o=d(this,Fr))==null||o.hide(),E(this,Ho,null),M(this,he,fi).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===d(this,Ho))return;const s=M(this,he,Rv).call(this,e).closest(".textLayer");if(!s){d(this,Ho)&&((l=d(this,Fr))==null||l.hide(),E(this,Ho,null),M(this,he,fi).call(this,{hasSelectedText:!1}));return}if((c=d(this,Fr))==null||c.hide(),E(this,Ho,t),M(this,he,fi).call(this,{hasSelectedText:!0}),!(d(this,vn)!==Oe.HIGHLIGHT&&d(this,vn)!==Oe.NONE)&&(d(this,vn)===Oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),E(this,Sl,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=d(this,vn)===Oe.HIGHLIGHT?M(this,he,FE).call(this,s):null;if(h==null||h.toggleDrawing(),d(this,Fh)){const f=new AbortController,g=this.combinedSignal(f),y=b=>{b.type==="pointerup"&&b.button!==0||(f.abort(),h==null||h.toggleDrawing(!0),b.type==="pointerup"&&M(this,he,fg).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:g}),window.addEventListener("blur",y,{signal:g})}else h==null||h.toggleDrawing(!0),M(this,he,fg).call(this,"main_toolbar")}},fg=function(e=""){d(this,vn)===Oe.HIGHLIGHT?this.highlightSelection(e):d(this,tm)&&M(this,he,Kk).call(this)},jk=function(){document.addEventListener("selectionchange",M(this,he,Jk).bind(this),{signal:this._signal})},Qk=function(){if(d(this,_l))return;E(this,_l,new AbortController);const e=this.combinedSignal(d(this,_l));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Zk=function(){var e;(e=d(this,_l))==null||e.abort(),E(this,_l,null)},BE=function(){if(d(this,El))return;E(this,El,new AbortController);const e=this.combinedSignal(d(this,El));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},eP=function(){var e;(e=d(this,El))==null||e.abort(),E(this,El,null)},HE=function(){if(d(this,yl))return;E(this,yl,new AbortController);const e=this.combinedSignal(d(this,yl));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},GE=function(){var e;(e=d(this,yl))==null||e.abort(),E(this,yl,null)},tP=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},fi=function(e){Object.entries(e).some(([n,s])=>d(this,am)[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(this,am),e)}),d(this,vn)===Oe.HIGHLIGHT&&e.hasSelectedEditor===!1&&M(this,he,Lo).call(this,[[tt.HIGHLIGHT_FREE,!0]]))},Lo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},nP=async function(){if(!d(this,Al)){E(this,Al,!0);const e=[];for(const t of d(this,En).values())e.push(t.enable());await Promise.all(e);for(const t of d(this,tn).values())t.enable()}},iP=function(){if(this.unselectAll(),d(this,Al)){E(this,Al,!1);for(const e of d(this,En).values())e.disable();for(const e of d(this,tn).values())e.disable()}},zE=function(e){const t=d(this,En).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},sP=function(){let e=null;for(e of d(this,vt));return e},pg=function(){if(d(this,tn).size===0)return!0;if(d(this,tn).size===1)for(const e of d(this,tn).values())return e.isEmpty();return!1},VE=function(e){for(const t of d(this,vt))t.unselect();d(this,vt).clear();for(const t of e)t.isEmpty()||(d(this,vt).add(t),t.select());M(this,he,fi).call(this,{hasSelectedEditor:this.hasSelection})},ce(fh,"TRANSLATE_SMALL",1),ce(fh,"TRANSLATE_BIG",10);let dc=fh;var In,Hr,ar,Gh,Gr,es,zh,zr,Li,zo,Wc,Vr,Rl,Sr,gg,Iv;const pi=class pi{constructor(e){R(this,Sr);R(this,In,null);R(this,Hr,!1);R(this,ar,null);R(this,Gh,null);R(this,Gr,null);R(this,es,null);R(this,zh,!1);R(this,zr,null);R(this,Li,null);R(this,zo,null);R(this,Wc,null);R(this,Vr,!1);E(this,Li,e),E(this,Vr,e._uiManager.useNewAltTextFlow),d(pi,Rl)||E(pi,Rl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){pi._l10n??(pi._l10n=e)}async render(){const e=E(this,ar,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=E(this,Gh,document.createElement("span"));e.append(t),d(this,Vr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",d(pi,Rl).missing),t.setAttribute("data-l10n-id",d(pi,Rl)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=d(this,Li)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),d(this,Li)._uiManager.editAltText(d(this,Li)),d(this,Vr)&&d(this,Li)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:d(this,Sr,gg)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(E(this,zh,!0),s(o))},{signal:n}),await M(this,Sr,Iv).call(this),e}finish(){d(this,ar)&&(d(this,ar).focus({focusVisible:d(this,zh)}),E(this,zh,!1))}isEmpty(){return d(this,Vr)?d(this,In)===null:!d(this,In)&&!d(this,Hr)}hasData(){return d(this,Vr)?d(this,In)!==null||!!d(this,zo):this.isEmpty()}get guessedText(){return d(this,zo)}async setGuessedText(e){d(this,In)===null&&(E(this,zo,e),E(this,Wc,await pi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),M(this,Sr,Iv).call(this))}toggleAltTextBadge(e=!1){var t;if(!d(this,Vr)||d(this,In)){(t=d(this,zr))==null||t.remove(),E(this,zr,null);return}if(!d(this,zr)){const n=E(this,zr,document.createElement("div"));n.className="noAltTextBadge",d(this,Li).div.append(n)}d(this,zr).classList.toggle("hidden",!e)}serialize(e){let t=d(this,In);return!e&&d(this,zo)===t&&(t=d(this,Wc)),{altText:t,decorative:d(this,Hr),guessedText:d(this,zo),textWithDisclaimer:d(this,Wc)}}get data(){return{altText:d(this,In),decorative:d(this,Hr)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(E(this,zo,n),E(this,Wc,s)),!(d(this,In)===e&&d(this,Hr)===t)&&(o||(E(this,In,e),E(this,Hr,t)),M(this,Sr,Iv).call(this))}toggle(e=!1){d(this,ar)&&(!e&&d(this,es)&&(clearTimeout(d(this,es)),E(this,es,null)),d(this,ar).disabled=!e)}shown(){d(this,Li)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:d(this,Sr,gg)}})}destroy(){var e,t;(e=d(this,ar))==null||e.remove(),E(this,ar,null),E(this,Gh,null),E(this,Gr,null),(t=d(this,zr))==null||t.remove(),E(this,zr,null)}};In=new WeakMap,Hr=new WeakMap,ar=new WeakMap,Gh=new WeakMap,Gr=new WeakMap,es=new WeakMap,zh=new WeakMap,zr=new WeakMap,Li=new WeakMap,zo=new WeakMap,Wc=new WeakMap,Vr=new WeakMap,Rl=new WeakMap,Sr=new WeakSet,gg=function(){return d(this,In)&&"added"||d(this,In)===null&&this.guessedText&&"review"||"missing"},Iv=async function(){var s,o,l;const e=d(this,ar);if(!e)return;if(d(this,Vr)){if(e.classList.toggle("done",!!d(this,In)),e.setAttribute("data-l10n-id",d(pi,Rl)[d(this,Sr,gg)]),(s=d(this,Gh))==null||s.setAttribute("data-l10n-id",d(pi,Rl)[`${d(this,Sr,gg)}-label`]),!d(this,In)){(o=d(this,Gr))==null||o.remove();return}}else{if(!d(this,In)&&!d(this,Hr)){e.classList.remove("done"),(l=d(this,Gr))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=d(this,Gr);if(!t){E(this,Gr,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${d(this,Li).id}`;const c=100,h=d(this,Li)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(d(this,es)),E(this,es,null)},{once:!0}),e.addEventListener("mouseenter",()=>{E(this,es,setTimeout(()=>{E(this,es,null),d(this,Gr).classList.add("show"),d(this,Li)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:h}),e.addEventListener("mouseleave",()=>{var f;d(this,es)&&(clearTimeout(d(this,es)),E(this,es,null)),(f=d(this,Gr))==null||f.classList.remove("show")},{signal:h})}d(this,Hr)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=d(this,In)),t.parentNode||e.append(t);const n=d(this,Li).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},R(pi,Rl,null),ce(pi,"_l10n",null);let yb=pi;var qn,qs,Kc,Ft,um,Jc,lr,jc,Qc,Zc,dm,qE;class pv{constructor(e){R(this,dm);R(this,qn,null);R(this,qs,null);R(this,Kc,!1);R(this,Ft,null);R(this,um,null);R(this,Jc,null);R(this,lr,null);R(this,jc,null);R(this,Qc,!1);R(this,Zc,null);E(this,Ft,e)}renderForToolbar(){const e=E(this,qs,document.createElement("button"));return e.className="comment",M(this,dm,qE).call(this,e,!1)}renderForStandalone(){const e=E(this,qn,document.createElement("button"));e.className="annotationCommentButton";const t=d(this,Ft).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(d(this,Ft)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=d(this,Ft).commentButtonColor;s&&(n.backgroundColor=s)}return M(this,dm,qE).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=d(this,qn)??d(this,qs))==null||e.focus()},0)}onUpdatedColor(){if(!d(this,qn))return;const e=d(this,Ft).commentButtonColor;e&&(d(this,qn).style.backgroundColor=e),d(this,Ft)._uiManager.updatePopupColor(d(this,Ft))}get commentButtonWidth(){var e;return(((e=d(this,qn))==null?void 0:e.getBoundingClientRect().width)??0)/d(this,Ft).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(d(this,Zc))return d(this,Zc);if(!d(this,qn))return null;const{x:e,y:t,height:n}=d(this,qn).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,Ft).parent.boundingClientRect;return[(e-s)/l,(t+n-o)/c]}set commentPopupPositionInLayer(e){E(this,Zc,e)}hasDefaultPopupPosition(){return d(this,Zc)===null}removeStandaloneCommentButton(){var e;(e=d(this,qn))==null||e.remove(),E(this,qn,null)}removeToolbarCommentButton(){var e;(e=d(this,qs))==null||e.remove(),E(this,qs,null)}setCommentButtonStates({selected:e,hasPopup:t}){d(this,qn)&&(d(this,qn).classList.toggle("selected",e),d(this,qn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=d(this,Ft).commentButtonPosition;const{width:g,height:y,x:b,y:A}=d(this,Ft);n=b+n*g,s=A+s*y}const o=d(this,Ft).parent.boundingClientRect,{x:l,y:c,width:h,height:f}=o;d(this,Ft)._uiManager.editComment(d(this,Ft),l+n*h,c+s*f,{...e,parentDimensions:o})}finish(){d(this,qs)&&(d(this,qs).focus({focusVisible:d(this,Kc)}),E(this,Kc,!1))}isDeleted(){return d(this,Qc)||d(this,lr)===""}isEmpty(){return d(this,lr)===null}hasBeenEdited(){return this.isDeleted()||d(this,lr)!==d(this,um)}serialize(){return this.data}get data(){return{text:d(this,lr),richText:d(this,Jc),date:d(this,jc),deleted:this.isDeleted()}}set data(e){if(e!==d(this,lr)&&E(this,Jc,null),e===null){E(this,lr,""),E(this,Qc,!0);return}E(this,lr,e),E(this,jc,new Date),E(this,Qc,!1)}setInitialText(e,t=null){E(this,um,e),this.data=e,E(this,jc,null),E(this,Jc,t)}shown(){}destroy(){var e,t;(e=d(this,qs))==null||e.remove(),E(this,qs,null),(t=d(this,qn))==null||t.remove(),E(this,qn,null),E(this,lr,""),E(this,Jc,null),E(this,jc,null),E(this,Ft,null),E(this,Kc,!1),E(this,Qc,!1)}}qn=new WeakMap,qs=new WeakMap,Kc=new WeakMap,Ft=new WeakMap,um=new WeakMap,Jc=new WeakMap,lr=new WeakMap,jc=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,dm=new WeakSet,qE=function(e,t){if(!d(this,Ft)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[d(this,Ft)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=d(this,Ft)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",As,{signal:n}),t&&(e.addEventListener("focusin",o=>{d(this,Ft)._focusEventsAllowed=!1,Jt(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{d(this,Ft)._focusEventsAllowed=!0,Jt(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===d(this,qs)?this.edit():d(this,Ft).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(E(this,Kc,!0),s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{d(this,Ft).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{d(this,Ft).toggleComment(!1,!1)},{signal:n}),e};var Vh,eu,hm,fm,pm,gm,mm,Vo,tu,qo,nu,$o,hc,rP,oP,aP;const cC=class cC{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){R(this,hc);R(this,Vh);R(this,eu,!1);R(this,hm,null);R(this,fm);R(this,pm);R(this,gm);R(this,mm);R(this,Vo,null);R(this,tu);R(this,qo,null);R(this,nu);R(this,$o,null);E(this,Vh,e),E(this,hm,n),E(this,fm,t),E(this,pm,s),E(this,gm,o),E(this,mm,l),E(this,nu,new AbortController),E(this,tu,AbortSignal.any([c,d(this,nu).signal])),e.addEventListener("touchstart",M(this,hc,rP).bind(this),{passive:!1,signal:d(this,tu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Tr.pixelRatio}destroy(){var e,t;(e=d(this,nu))==null||e.abort(),E(this,nu,null),(t=d(this,Vo))==null||t.abort(),E(this,Vo,null)}};Vh=new WeakMap,eu=new WeakMap,hm=new WeakMap,fm=new WeakMap,pm=new WeakMap,gm=new WeakMap,mm=new WeakMap,Vo=new WeakMap,tu=new WeakMap,qo=new WeakMap,nu=new WeakMap,$o=new WeakMap,hc=new WeakSet,rP=function(e){var s,o,l;if((s=d(this,fm))!=null&&s.call(this))return;if(e.touches.length===1){if(d(this,Vo))return;const c=E(this,Vo,new AbortController),h=AbortSignal.any([d(this,tu),c.signal]),f=d(this,Vh),g={capture:!0,signal:h,passive:!1},y=b=>{var A;b.pointerType==="touch"&&((A=d(this,Vo))==null||A.abort(),E(this,Vo,null))};f.addEventListener("pointerdown",b=>{b.pointerType==="touch"&&(Jt(b),y(b))},g),f.addEventListener("pointerup",y,g),f.addEventListener("pointercancel",y,g);return}if(!d(this,$o)){E(this,$o,new AbortController);const c=AbortSignal.any([d(this,tu),d(this,$o).signal]),h=d(this,Vh),f={signal:c,capture:!1,passive:!1};h.addEventListener("touchmove",M(this,hc,oP).bind(this),f);const g=M(this,hc,aP).bind(this);h.addEventListener("touchend",g,f),h.addEventListener("touchcancel",g,f),f.capture=!0,h.addEventListener("pointerdown",Jt,f),h.addEventListener("pointermove",Jt,f),h.addEventListener("pointercancel",Jt,f),h.addEventListener("pointerup",Jt,f),(o=d(this,pm))==null||o.call(this)}if(Jt(e),e.touches.length!==2||(l=d(this,hm))!=null&&l.call(this)){E(this,qo,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),E(this,qo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},oP=function(e){var L;if(!d(this,qo)||e.touches.length!==2)return;Jt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:l,screenY:c}=n,h=d(this,qo),{touch0X:f,touch0Y:g,touch1X:y,touch1Y:b}=h,A=y-f,w=b-g,C=l-s,N=c-o,I=Math.hypot(C,N)||1,P=Math.hypot(A,w)||1;if(!d(this,eu)&&Math.abs(P-I)<=cC.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,!d(this,eu)){E(this,eu,!0);return}const k=[(s+l)/2,(o+c)/2];(L=d(this,gm))==null||L.call(this,k,P,I)},aP=function(e){var t;e.touches.length>=2||(d(this,$o)&&(d(this,$o).abort(),E(this,$o,null),(t=d(this,mm))==null||t.call(this)),d(this,qo)&&(Jt(e),E(this,qo,null),E(this,eu,!1)))};let Vg=cC;var iu,cr,Yt,Dt,Yo,qh,Il,ym,$n,su,Xo,qr,Nl,vm,ru,ts,bm,ou,Wo,$r,$h,Yh,$s,au,_m,Gb,Ne,$E,Sm,YE,Nv,lP,cP,XE,Mv,WE,uP,dP,hP,KE,fP,JE,pP,gP,mP,jE,mg;const Fe=class Fe{constructor(e){R(this,Ne);R(this,iu,null);R(this,cr,null);R(this,Yt,null);R(this,Dt,null);R(this,Yo,null);R(this,qh,!1);R(this,Il,null);R(this,ym,"");R(this,$n,null);R(this,su,null);R(this,Xo,null);R(this,qr,null);R(this,Nl,null);R(this,vm,"");R(this,ru,!1);R(this,ts,null);R(this,bm,!1);R(this,ou,!1);R(this,Wo,!1);R(this,$r,null);R(this,$h,0);R(this,Yh,0);R(this,$s,null);R(this,au,null);ce(this,"isSelected",!1);ce(this,"_isCopy",!1);ce(this,"_editToolbar",null);ce(this,"_initialOptions",Object.create(null));ce(this,"_initialData",null);ce(this,"_isVisible",!0);ce(this,"_uiManager",null);ce(this,"_focusEventsAllowed",!0);R(this,_m,!1);R(this,Gb,Fe._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Fe.prototype._resizeWithKeyboard,t=dc.TRANSLATE_SMALL,n=dc.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new ky([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Fe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new nq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Fe._l10n??(Fe._l10n=e),Fe._l10nResizer||(Fe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Fe._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Fe._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ut("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return d(this,_m)}set _isDraggable(e){var t;E(this,_m,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=d(this,Gb)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(M(this,Ne,mg).call(this),(t=d(this,qr))==null||t.remove(),E(this,qr,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(d(this,ru)?E(this,ru,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}translate(e,t){M(this,Ne,$E).call(this,this.parentDimensions,e,t)}translateInPage(e,t){d(this,ts)||E(this,ts,[this.x,this.y,this.width,this.height]),M(this,Ne,$E).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){d(this,ts)||E(this,ts,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!d(this,ts)&&(d(this,ts)[0]!==this.x||d(this,ts)[1]!==this.y)}get _hasBeenResized(){return!!d(this,ts)&&(d(this,ts)[2]!==this.width||d(this,ts)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Fe,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=n,h*=s,o*=n,l*=s,this._mustFixPosition)switch(e){case 0:o=li(o,0,n-c),l=li(l,0,s-h);break;case 90:o=li(o,0,n-h),l=li(l,c,s);break;case 180:o=li(o,c,n),l=li(l,h,s);break;case 270:o=li(o,h,n),l=li(l,0,s-c);break}this.x=o/=n,this.y=l/=s;const[f,g]=this.getBaseTranslation();o+=f,l+=g,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return M(n=Fe,Sm,YE).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return M(n=Fe,Sm,YE).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=d(this,Yt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||d(this,ou))return this._editToolbar;this._editToolbar=new PE(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=d(this,Yt))==null||t.destroy()}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return d(this,Yt)||(yb.initialize(Fe._l10n),E(this,Yt,new yb(this)),d(this,iu)&&(d(this,Yt).data=d(this,iu),E(this,iu,null))),d(this,Yt)}get altTextData(){var e;return(e=d(this,Yt))==null?void 0:e.data}set altTextData(e){d(this,Yt)&&(d(this,Yt).data=e)}get guessedAltText(){var e;return(e=d(this,Yt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=d(this,Yt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=d(this,Yt))==null?void 0:t.serialize(e)}hasAltText(){return!!d(this,Yt)&&!d(this,Yt).isEmpty()}hasAltTextData(){var e;return((e=d(this,Yt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=d(this,Dt))==null||e.focusButton()}addCommentButton(){return d(this,Dt)||E(this,Dt,new pv(this))}addStandaloneCommentButton(){if(d(this,Yo)){this._uiManager.isEditingMode()&&d(this,Yo).classList.remove("hidden");return}this.hasComment&&(E(this,Yo,d(this,Dt).renderForStandalone()),this.div.append(d(this,Yo)))}removeStandaloneCommentButton(){d(this,Dt).removeStandaloneCommentButton(),E(this,Yo,null)}hideStandaloneCommentButton(){var e;(e=d(this,Yo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=d(this,Dt);return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){d(this,Dt)||E(this,Dt,new pv(this)),d(this,Dt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(d(this,Dt)||E(this,Dt,new pv(this)),d(this,Dt).setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=d(this,Dt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=d(this,Dt))==null?void 0:e.isDeleted()}get hasComment(){return!!d(this,Dt)&&!d(this,Dt).isEmpty()&&!d(this,Dt).isDeleted()}async editComment(e){d(this,Dt)||E(this,Dt,new pv(this)),d(this,Dt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){d(this,Dt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,c=l+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){d(this,Dt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var l;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=d(this,qh)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),M(this,Ne,JE).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),Xk(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(d(this,au)||E(this,au,new Vg({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,Ne,uP).bind(this),onPinching:M(this,Ne,dP).bind(this),onPinchEnd:M(this,Ne,hP).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(l=this._uiManager._editorUndoBar)==null||l.hide(),e}pointerdown(e){const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(E(this,ru,!0),this._isDraggable){M(this,Ne,fP).call(this,e);return}M(this,Ne,KE).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){d(this,$r)&&clearTimeout(d(this,$r)),E(this,$r,setTimeout(()=>{var e;E(this,$r,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,g=t/s,y=this.x*o,b=this.y*l,A=this.width*o,w=this.height*l;switch(n){case 0:return[y+f+c,l-b-g-w+h,y+f+A+c,l-b-g+h];case 90:return[y+g+c,l-b+f+h,y+g+w+c,l-b+f+A+h];case 180:return[y-f-A+c,l-b+g+h,y-f+c,l-b+g+w+h];case 270:return[y-g-w+c,l-b-f-A+h,y-g+c,l-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,l]=e,c=o-n,h=l-s;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Fe._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=d(this,Dt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:l},uid:c,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:f,modificationDate:n||g,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),E(this,ou,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),E(this,ou,!1),!0):!1}isInEditMode(){return d(this,ou)}shouldGetKeyboardEvents(){return d(this,Wo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return t<l&&s>0&&e<o&&n>0}rebuild(){M(this,Ne,JE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,E(s,iu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[o,l]=s.pageDimensions,[c,h,f,g]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/o,s.y=h/l,s.width=f/o,s.height=g/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=d(this,Nl))==null||e.abort(),E(this,Nl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(this,$r)&&(clearTimeout(d(this,$r)),E(this,$r,null)),M(this,Ne,mg).call(this),this.removeEditToolbar(),d(this,$s)){for(const n of d(this,$s).values())clearTimeout(n);E(this,$s,null)}this.parent=null,(t=d(this,au))==null||t.destroy(),E(this,au,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,Ne,lP).call(this),d(this,$n).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,l]=this.getPDFRect();return[Fe._round(n+(o-n)*e),Fe._round(s+(l-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return d(this,Dt).commentPopupPositionInLayer}set commentPopupPosition(e){d(this,Dt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return d(this,Dt).hasDefaultPopupPosition()}get commentButtonWidth(){return d(this,Dt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){d(this,Dt).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),E(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=d(this,$n).children;if(!d(this,cr)){E(this,cr,Array.from(t));const l=M(this,Ne,pP).bind(this),c=M(this,Ne,gP).bind(this),h=this._uiManager._signal;for(const f of d(this,cr)){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",M(this,Ne,mP).bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",Fe._l10nResizer[g])}}const n=d(this,cr)[0];let s=0;for(const l of t){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(d(this,cr).length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)d(this,$n).append(d(this,$n).firstChild);else if(o>s)for(let c=0;c<o-s;c++)d(this,$n).firstChild.before(d(this,$n).lastChild);let l=0;for(const c of t){const f=d(this,cr)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Fe._l10nResizer[f])}}M(this,Ne,jE).call(this,0),E(this,Wo,!0),d(this,$n).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){d(this,Wo)&&M(this,Ne,WE).call(this,d(this,vm),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,Ne,mg).call(this),this.div.focus()}select(){var e,t,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,o;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((o=this._editToolbar)==null||o.show())});return}(t=this._editToolbar)==null||t.show(),(n=d(this,Yt))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,s,o;this.isSelected&&(this.isSelected=!1,(e=d(this,$n))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(o=d(this,Yt))==null||o.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return d(this,bm)}set isEditing(e){E(this,bm,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){d(this,$s)||E(this,$s,new Map);const{action:n}=e;let s=d(this,$s).get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),d(this,$s).delete(n),d(this,$s).size===0&&E(this,$s,null)},Fe._telemetryTimeout),d(this,$s).set(n,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),E(this,qh,!1)}disable(){this.div&&(this.div.tabIndex=-1),E(this,qh,!0)}updateFakeAnnotationElement(e){if(!d(this,qr)&&!this.deleted){E(this,qr,e.addFakeAnnotation(this));return}if(this.deleted){d(this,qr).remove(),E(this,qr,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&d(this,qr).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};iu=new WeakMap,cr=new WeakMap,Yt=new WeakMap,Dt=new WeakMap,Yo=new WeakMap,qh=new WeakMap,Il=new WeakMap,ym=new WeakMap,$n=new WeakMap,su=new WeakMap,Xo=new WeakMap,qr=new WeakMap,Nl=new WeakMap,vm=new WeakMap,ru=new WeakMap,ts=new WeakMap,bm=new WeakMap,ou=new WeakMap,Wo=new WeakMap,$r=new WeakMap,$h=new WeakMap,Yh=new WeakMap,$s=new WeakMap,au=new WeakMap,_m=new WeakMap,Gb=new WeakMap,Ne=new WeakSet,$E=function([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Sm=new WeakSet,YE=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Nv=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},lP=function(){if(d(this,$n))return;E(this,$n,document.createElement("div")),d(this,$n).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");d(this,$n).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",M(this,Ne,cP).bind(this,n),{signal:t}),s.addEventListener("contextmenu",As,{signal:t}),s.tabIndex=-1}this.div.prepend(d(this,$n))},cP=function(e,t){var g;t.preventDefault();const{isMac:n}=On.platform;if(t.button!==0||t.ctrlKey&&n)return;(g=d(this,Yt))==null||g.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,E(this,su,[t.screenX,t.screenY]);const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,Ne,WE).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Jt,{passive:!1,signal:l}),window.addEventListener("contextmenu",As,{signal:l}),E(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{var y;o.abort(),this.parent.togglePointerEvents(!0),(y=d(this,Yt))==null||y.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,M(this,Ne,Mv).call(this)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},XE=function(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Mv=function(){if(!d(this,Xo))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=d(this,Xo);E(this,Xo,null);const o=this.x,l=this.y,c=this.width,h=this.height;o===e&&l===t&&c===n&&h===s||this.addCommands({cmd:M(this,Ne,XE).bind(this,o,l,c,h),undo:M(this,Ne,XE).bind(this,e,t,n,s),mustExec:!0})},WE=function(e,t){const[n,s]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=Fe.MIN_SIZE/n,g=Fe.MIN_SIZE/s,y=M(this,Ne,Nv).call(this,this.rotation),b=(G,$)=>[y[0]*G+y[2]*$,y[1]*G+y[3]*$],A=M(this,Ne,Nv).call(this,360-this.rotation),w=(G,$)=>[A[0]*G+A[2]*$,A[1]*G+A[3]*$];let C,N,I=!1,P=!1;switch(e){case"topLeft":I=!0,C=(G,$)=>[0,0],N=(G,$)=>[G,$];break;case"topMiddle":C=(G,$)=>[G/2,0],N=(G,$)=>[G/2,$];break;case"topRight":I=!0,C=(G,$)=>[G,0],N=(G,$)=>[0,$];break;case"middleRight":P=!0,C=(G,$)=>[G,$/2],N=(G,$)=>[0,$/2];break;case"bottomRight":I=!0,C=(G,$)=>[G,$],N=(G,$)=>[0,0];break;case"bottomMiddle":C=(G,$)=>[G/2,$],N=(G,$)=>[G/2,0];break;case"bottomLeft":I=!0,C=(G,$)=>[0,$],N=(G,$)=>[G,0];break;case"middleLeft":P=!0,C=(G,$)=>[0,$/2],N=(G,$)=>[G,$/2];break}const k=C(c,h),L=N(c,h);let O=b(...L);const U=Fe._round(o+O[0]),F=Fe._round(l+O[1]);let K=1,q=1,Q,ee;if(t.fromKeyboard)({deltaX:Q,deltaY:ee}=t);else{const{screenX:G,screenY:$}=t,[oe,pe]=d(this,su);[Q,ee]=this.screenToPageTranslation(G-oe,$-pe),d(this,su)[0]=G,d(this,su)[1]=$}if([Q,ee]=w(Q/n,ee/s),I){const G=Math.hypot(c,h);K=q=Math.max(Math.min(Math.hypot(L[0]-k[0]-Q,L[1]-k[1]-ee)/G,1/c,1/h),f/c,g/h)}else P?K=li(Math.abs(L[0]-k[0]-Q),f,1)/c:q=li(Math.abs(L[1]-k[1]-ee),g,1)/h;const se=Fe._round(c*K),le=Fe._round(h*q);O=b(...N(se,le));const ue=U-O[0],me=F-O[1];d(this,ts)||E(this,ts,[this.x,this.y,this.width,this.height]),this.width=se,this.height=le,this.x=ue,this.y=me,this.setDims(),this.fixAndSetPosition(),this._onResizing()},uP=function(){var e;E(this,Xo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=d(this,Yt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},dP=function(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const l=M(this,Ne,Nv).call(this,this.rotation),c=(U,F)=>[l[0]*U+l[2]*F,l[1]*U+l[3]*F],[h,f]=this.parentDimensions,g=this.x,y=this.y,b=this.width,A=this.height,w=Fe.MIN_SIZE/h,C=Fe.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),w/b,C/A);const N=Fe._round(b*o),I=Fe._round(A*o);if(N===b&&I===A)return;d(this,ts)||E(this,ts,[g,y,b,A]);const P=c(b/2,A/2),k=Fe._round(g+P[0]),L=Fe._round(y+P[1]),O=c(N/2,I/2);this.x=k-O[0],this.y=L-O[1],this.width=N,this.height=I,this.setDims(),this.fixAndSetPosition(),this._onResizing()},hP=function(){var e;(e=d(this,Yt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),M(this,Ne,Mv).call(this)},KE=function(e){const{isMac:t}=On.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},fP=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),E(this,Il,null),E(this,ru,!1),this._uiManager.endDragSession()||M(this,Ne,KE).call(this,f),n&&this._onStopDragging()};t&&(E(this,$h,e.clientX),E(this,Yh,e.clientY),E(this,Il,e.pointerId),E(this,ym,e.pointerType),window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:y,pointerId:b}=f;if(b!==d(this,Il)){Jt(f);return}const[A,w]=this.screenToPageTranslation(g-d(this,$h),y-d(this,Yh));E(this,$h,g),E(this,Yh,y),this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",Jt,l),window.addEventListener("pointerdown",f=>{f.pointerType===d(this,ym)&&(d(this,au)||f.isPrimary)&&c(f),Jt(f)},l));const h=f=>{if(!d(this,Il)||d(this,Il)===f.pointerId){c(f);return}Jt(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})},JE=function(){if(d(this,Nl)||!this.div)return;E(this,Nl,new AbortController);const e=this._uiManager.combinedSignal(d(this,Nl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},pP=function(e){Fe._resizerKeyboardManager.exec(this,e)},gP=function(e){var t;d(this,Wo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==d(this,$n)&&M(this,Ne,mg).call(this)},mP=function(e){E(this,vm,d(this,Wo)?e:"")},jE=function(e){if(d(this,cr))for(const t of d(this,cr))t.tabIndex=e},mg=function(){E(this,Wo,!1),M(this,Ne,jE).call(this,-1),M(this,Ne,Mv).call(this)},R(Fe,Sm),ce(Fe,"_l10n",null),ce(Fe,"_l10nResizer",null),ce(Fe,"_borderLineWidth",-1),ce(Fe,"_colorManager",new UE),ce(Fe,"_zIndex",1),ce(Fe,"_telemetryTimeout",1e3);let Bt=Fe;class nq extends Bt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const fM=3285377520,Os=4294901760,Pr=65535;class yP{constructor(e){this.h1=e?e&4294967295:fM,this.h2=e?e&4294967295:fM}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let C=0,N=e.length;C<N;C++){const I=e.charCodeAt(C);I<=255?t[n++]=I:(t[n++]=I>>>8,t[n++]=I&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,g=this.h2;const y=3432918353,b=461845907,A=y&Pr,w=b&Pr;for(let C=0;C<s;C++)C&1?(c=l[C],c=c*y&Os|c*A&Pr,c=c<<15|c>>>17,c=c*b&Os|c*w&Pr,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[C],h=h*y&Os|h*A&Pr,h=h<<15|h>>>17,h=h*b&Os|h*w&Pr,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*y&Os|c*A&Pr,c=c<<15|c>>>17,c=c*b&Os|c*w&Pr,s&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Os|e*36045&Pr,t=t*4283543511&Os|((t<<16|e>>>16)*2950163797&Os)>>>16,e^=t>>>1,e=e*444984403&Os|e*60499&Pr,t=t*3301882366&Os|((t<<16|e>>>16)*3120437893&Os)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const QE=Object.freeze({map:null,hash:"",transfer:void 0});var lu,cu,Ko,Yn,zb,vP;class Pw{constructor(){R(this,zb);R(this,lu,!1);R(this,cu,null);R(this,Ko,null);R(this,Yn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=d(this,Yn).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return d(this,Yn).get(e)}remove(e){const t=d(this,Yn).get(e);if(t!==void 0&&(t instanceof Bt&&d(this,Ko).delete(t.annotationElementId),d(this,Yn).delete(e),d(this,Yn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of d(this,Yn).values())if(n instanceof Bt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=d(this,Yn).get(e);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(t))n[o]!==l&&(s=!0,n[o]=l);else s=!0,d(this,Yn).set(e,t);s&&M(this,zb,vP).call(this),t instanceof Bt&&((d(this,Ko)||E(this,Ko,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return d(this,Yn).has(e)}get size(){return d(this,Yn).size}resetModified(){d(this,lu)&&(E(this,lu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new bP(this)}get serializable(){if(d(this,Yn).size===0)return QE;const e=new Map,t=new yP,n=[],s=Object.create(null);let o=!1;for(const[l,c]of d(this,Yn)){const h=c instanceof Bt?c.serialize(!1,s):c;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),o||(o=!!h.bitmap))}if(o)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:QE}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of d(this,Yn).values()){if(!(o instanceof Bt)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const h=e[c]||(e[c]=new Map);for(const[f,g]of Object.entries(l)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(g)??0;y.set(g,b+1)}}if((s>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,l]of t)e[o]=l.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){E(this,cu,null)}updateEditor(e,t){var s;const n=(s=d(this,Ko))==null?void 0:s.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=d(this,Ko))==null?void 0:t.get(e))||null}get modifiedIds(){if(d(this,cu))return d(this,cu);const e=[];if(d(this,Ko))for(const t of d(this,Ko).values())t.serialize()&&e.push(t.annotationElementId);return E(this,cu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return d(this,Yn).entries()}}lu=new WeakMap,cu=new WeakMap,Ko=new WeakMap,Yn=new WeakMap,zb=new WeakSet,vP=function(){d(this,lu)||(E(this,lu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Am;class bP extends Pw{constructor(t){super();R(this,Am);const{map:n,hash:s,transfer:o}=t.serializable,l=structuredClone(n,o?{transfer:o}:null);E(this,Am,{map:l,hash:s,transfer:o})}get print(){Ut("Should not call PrintAnnotationStorage.print")}get serializable(){return d(this,Am)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}Am=new WeakMap;var Xh;class iq{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){R(this,Xh,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),d(this,Xh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||d(this,Xh).has(e.loadedName))){if(it(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:l}=e,c=new FontFace(s,o,l);this.addNativeFontFace(c);try{await c.load(),d(this,Xh).add(s),n==null||n(e)}catch{Ue(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Ut("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Ue(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ve(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ve(this,"isSyncFontLoadingSupported",bi||On.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(it(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ve(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,O){return L.charCodeAt(O)<<24|L.charCodeAt(O+1)<<16|L.charCodeAt(O+2)<<8|L.charCodeAt(O+3)&255}function s(L,O,U,F){const K=L.substring(0,O),q=L.substring(O+U);return K+F+q}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(L,O){if(++f>30){Ue("Load test font never loaded."),O();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,L,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=s(b,976,y.length,y);const w=16,C=1482184792;let N=n(b,w);for(o=0,l=y.length-3;o<l;o+=4)N=N-C+n(y,o)|0;o<y.length&&(N=N-C+n(y+"XXX",o)|0),b=s(b,w,4,qV(N));const I=`url(data:font/opentype;base64,${btoa(b)});`,P=`@font-face {font-family:"${y}";src:${I}}`;this.insertRule(P);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const L of[e.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=L,k.append(O)}this._document.body.append(k),g(y,()=>{k.remove(),t.complete()})}}Xh=new WeakMap;var Tt;class sq{constructor(e,t=null,n,s){R(this,Tt);this.compiledGlyphs=Object.create(null),E(this,Tt,e),this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Lk(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Ue(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return d(this,Tt).black}get bold(){return d(this,Tt).bold}get disableFontFace(){return d(this,Tt).disableFontFace??!1}get fontExtraProperties(){return d(this,Tt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return d(this,Tt).isInvalidPDFjsFont}get isType3Font(){return d(this,Tt).isType3Font}get italic(){return d(this,Tt).italic}get missingFile(){return d(this,Tt).missingFile}get remeasure(){return d(this,Tt).remeasure}get vertical(){return d(this,Tt).vertical}get ascent(){return d(this,Tt).ascent}get defaultWidth(){return d(this,Tt).defaultWidth}get descent(){return d(this,Tt).descent}get bbox(){return d(this,Tt).bbox}get fontMatrix(){return d(this,Tt).fontMatrix}get fallbackName(){return d(this,Tt).fallbackName}get loadedName(){return d(this,Tt).loadedName}get mimetype(){return d(this,Tt).mimetype}get name(){return d(this,Tt).name}get data(){return d(this,Tt).data}clearData(){d(this,Tt).clearData()}get cssFontInfo(){return d(this,Tt).cssFontInfo}get systemFontInfo(){return d(this,Tt).systemFontInfo}get defaultVMetrics(){return d(this,Tt).defaultVMetrics}}Tt=new WeakMap;function rq(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(bi)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function oq(i){if(bi&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Ny(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function gv(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const ZE=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,aq=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",_P=WV.bind(null,ZE,aq);var Jo,Vb;class lq{constructor(){R(this,Jo,new Map);R(this,Vb,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};d(this,Vb).then(()=>{for(const[s]of d(this,Jo))s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:o}=n;if(o.aborted){Ue("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}d(this,Jo).set(t,s)}removeEventListener(e,t){const n=d(this,Jo).get(t);n==null||n(),d(this,Jo).delete(t)}terminate(){for(const[,e]of d(this,Jo))e==null||e();d(this,Jo).clear()}}Jo=new WeakMap,Vb=new WeakMap;const mv={DATA:1,ERROR:2},yn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function pM(){}function ki(i){if(i instanceof xa||i instanceof gb||i instanceof oM||i instanceof Hg||i instanceof WA)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||Ut('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new xa(i.message);case"InvalidPDFException":return new gb(i.message);case"PasswordException":return new oM(i.message,i.code);case"ResponseException":return new Hg(i.message,i.status,i.missing);case"UnknownErrorException":return new WA(i.message,i.details)}return new WA(i.message,i.toString())}var Wh,Qs,SP,AP,EP,Dv;class yg{constructor(e,t,n){R(this,Qs);R(this,Wh,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,Qs,SP).bind(this),{signal:d(this,Wh).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,h.postMessage({sourceName:l,targetName:c,stream:yn.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{it(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:yn.CANCEL,streamId:o,reason:ki(f)}),g.promise}},n)}destroy(){var e;(e=d(this,Wh))==null||e.abort(),E(this,Wh,null)}}Wh=new WeakMap,Qs=new WeakSet,SP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){M(this,Qs,EP).call(this,e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===mv.DATA)s.resolve(e.data);else if(e.callback===mv.ERROR)s.reject(ki(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(l){o.postMessage({sourceName:n,targetName:s,callback:mv.DATA,callbackId:e.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:s,callback:mv.ERROR,callbackId:e.callbackId,reason:ki(l)})});return}if(e.streamId){M(this,Qs,AP).call(this,e);return}t(e.data)},AP=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(f,g=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:yn.ENQUEUE,streamId:t,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:yn.CLOSE,streamId:t}),delete l.streamSinks[t])},error(f){it(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:yn.ERROR,streamId:t,reason:ki(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:yn.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:yn.START_COMPLETE,streamId:t,reason:ki(f)})})},EP=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case yn.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(ki(e.reason));break;case yn.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(ki(e.reason));break;case yn.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:yn.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||pM).then(function(){o.postMessage({sourceName:n,targetName:s,stream:yn.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:yn.PULL_COMPLETE,streamId:t,reason:ki(f)})});break;case yn.ENQUEUE:if(it(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case yn.CLOSE:if(it(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),M(this,Qs,Dv).call(this,l,t);break;case yn.ERROR:it(l,"error should have stream controller"),l.controller.error(ki(e.reason)),M(this,Qs,Dv).call(this,l,t);break;case yn.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(ki(e.reason)),M(this,Qs,Dv).call(this,l,t);break;case yn.CANCEL:if(!c)break;const h=ki(e.reason);Promise.try(c.onCancel||pM,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:yn.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:yn.CANCEL_COMPLETE,streamId:t,reason:ki(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Dv=async function(e,t){var n,s,o;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(s=e.pullCall)==null?void 0:s.promise,(o=e.cancelCall)==null?void 0:o.promise]),delete this.streamControllers[t]};var Em;class TP{constructor({enableHWA:e=!1}){R(this,Em,!1);E(this,Em,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!d(this,Em)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ut("Abstract method `_createCanvas` called.")}}Em=new WeakMap;class cq extends TP{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class wP{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ut("Abstract method `_fetch` called.")}}class gM extends wP{async _fetch(e){const t=await ap(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Ny(t)}}class CP{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}var uu,Kh,jo,Qo,si,du,hu,ge,ti,vg,ih,kv,sh,xP,eT,rh,bg,_g,tT,Sg;class uq extends CP{constructor({docId:t,ownerDocument:n=globalThis.document}){super();R(this,ge);R(this,uu);R(this,Kh);R(this,jo);R(this,Qo);R(this,si);R(this,du);R(this,hu,0);E(this,Qo,t),E(this,si,n)}addFilter(t){if(!t)return"none";let n=d(this,ge,ti).get(t);if(n)return n;const[s,o,l]=M(this,ge,kv).call(this,t),c=t.length===1?s:`${s}${o}${l}`;if(n=d(this,ge,ti).get(c),n)return d(this,ge,ti).set(t,n),n;const h=`g_${d(this,Qo)}_transfer_map_${Sn(this,hu)._++}`,f=M(this,ge,sh).call(this,h);d(this,ge,ti).set(t,f),d(this,ge,ti).set(c,f);const g=M(this,ge,rh).call(this,h);return M(this,ge,_g).call(this,s,o,l,g),f}addHCMFilter(t,n){var w;const s=`${t}-${n}`,o="base";let l=d(this,ge,vg).get(o);if((l==null?void 0:l.key)===s||(l?((w=l.filter)==null||w.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},d(this,ge,vg).set(o,l)),!t||!n))return l.url;const c=M(this,ge,Sg).call(this,t);t=be.makeHexColor(...c);const h=M(this,ge,Sg).call(this,n);if(n=be.makeHexColor(...h),d(this,ge,ih).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const f=new Array(256);for(let C=0;C<=255;C++){const N=C/255;f[C]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const g=f.join(","),y=`g_${d(this,Qo)}_hcm_filter`,b=l.filter=M(this,ge,rh).call(this,y);M(this,ge,_g).call(this,g,g,g,b),M(this,ge,eT).call(this,b);const A=(C,N)=>{const I=c[C]/255,P=h[C]/255,k=new Array(N+1);for(let L=0;L<=N;L++)k[L]=I+L/N*(P-I);return k.join(",")};return M(this,ge,_g).call(this,A(0,5),A(1,5),A(2,5),b),l.url=M(this,ge,sh).call(this,y),l.url}addAlphaFilter(t){let n=d(this,ge,ti).get(t);if(n)return n;const[s]=M(this,ge,kv).call(this,[t]),o=`alpha_${s}`;if(n=d(this,ge,ti).get(o),n)return d(this,ge,ti).set(t,n),n;const l=`g_${d(this,Qo)}_alpha_map_${Sn(this,hu)._++}`,c=M(this,ge,sh).call(this,l);d(this,ge,ti).set(t,c),d(this,ge,ti).set(o,c);const h=M(this,ge,rh).call(this,l);return M(this,ge,tT).call(this,s,h),c}addLuminosityFilter(t){let n=d(this,ge,ti).get(t||"luminosity");if(n)return n;let s,o;if(t?([s]=M(this,ge,kv).call(this,[t]),o=`luminosity_${s}`):o="luminosity",n=d(this,ge,ti).get(o),n)return d(this,ge,ti).set(t,n),n;const l=`g_${d(this,Qo)}_luminosity_map_${Sn(this,hu)._++}`,c=M(this,ge,sh).call(this,l);d(this,ge,ti).set(t,c),d(this,ge,ti).set(o,c);const h=M(this,ge,rh).call(this,l);return M(this,ge,xP).call(this,h),t&&M(this,ge,tT).call(this,s,h),c}addHighlightHCMFilter(t,n,s,o,l){var P;const c=`${n}-${s}-${o}-${l}`;let h=d(this,ge,vg).get(t);if((h==null?void 0:h.key)===c||(h?((P=h.filter)==null||P.remove(),h.key=c,h.url="none",h.filter=null):(h={key:c,url:"none",filter:null},d(this,ge,vg).set(t,h)),!n||!s))return h.url;const[f,g]=[n,s].map(M(this,ge,Sg).bind(this));let y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),b=Math.round(.2126*g[0]+.7152*g[1]+.0722*g[2]),[A,w]=[o,l].map(M(this,ge,Sg).bind(this));b<y&&([y,b,A,w]=[b,y,w,A]),d(this,ge,ih).style.color="";const C=(k,L,O)=>{const U=new Array(256),F=(b-y)/O,K=k/255,q=(L-k)/(255*O);let Q=0;for(let ee=0;ee<=O;ee++){const se=Math.round(y+ee*F),le=K+ee*q;for(let ue=Q;ue<=se;ue++)U[ue]=le;Q=se+1}for(let ee=Q;ee<256;ee++)U[ee]=U[Q-1];return U.join(",")},N=`g_${d(this,Qo)}_hcm_${t}_filter`,I=h.filter=M(this,ge,rh).call(this,N);return M(this,ge,eT).call(this,I),M(this,ge,_g).call(this,C(A[0],w[0],5),C(A[1],w[1],5),C(A[2],w[2],5),I),h.url=M(this,ge,sh).call(this,N),h.url}destroy(t=!1){var n,s,o,l;t&&((n=d(this,du))!=null&&n.size)||((s=d(this,jo))==null||s.parentNode.parentNode.remove(),E(this,jo,null),(o=d(this,Kh))==null||o.clear(),E(this,Kh,null),(l=d(this,du))==null||l.clear(),E(this,du,null),E(this,hu,0))}}uu=new WeakMap,Kh=new WeakMap,jo=new WeakMap,Qo=new WeakMap,si=new WeakMap,du=new WeakMap,hu=new WeakMap,ge=new WeakSet,ti=function(){return d(this,Kh)||E(this,Kh,new Map)},vg=function(){return d(this,du)||E(this,du,new Map)},ih=function(){if(!d(this,jo)){const t=d(this,si).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=d(this,si).createElementNS(Po,"svg");s.setAttribute("width",0),s.setAttribute("height",0),E(this,jo,d(this,si).createElementNS(Po,"defs")),t.append(s),s.append(d(this,jo)),d(this,si).body.append(t)}return d(this,jo)},kv=function(t){if(t.length===1){const f=t[0],g=new Array(256);for(let b=0;b<256;b++)g[b]=f[b]/255;const y=g.join(",");return[y,y,y]}const[n,s,o]=t,l=new Array(256),c=new Array(256),h=new Array(256);for(let f=0;f<256;f++)l[f]=n[f]/255,c[f]=s[f]/255,h[f]=o[f]/255;return[l.join(","),c.join(","),h.join(",")]},sh=function(t){if(d(this,uu)===void 0){E(this,uu,"");const n=d(this,si).URL;n!==d(this,si).baseURI&&(Dy(n)?Ue('#createUrl: ignore "data:"-URL for performance reasons.'):E(this,uu,Iw(n,"")))}return`url(${d(this,uu)}#${t})`},xP=function(t){const n=d(this,si).createElementNS(Po,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},eT=function(t){const n=d(this,si).createElementNS(Po,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},rh=function(t){const n=d(this,si).createElementNS(Po,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),d(this,ge,ih).append(n),n},bg=function(t,n,s){const o=d(this,si).createElementNS(Po,n);o.setAttribute("type","discrete"),o.setAttribute("tableValues",s),t.append(o)},_g=function(t,n,s,o){const l=d(this,si).createElementNS(Po,"feComponentTransfer");o.append(l),M(this,ge,bg).call(this,l,"feFuncR",t),M(this,ge,bg).call(this,l,"feFuncG",n),M(this,ge,bg).call(this,l,"feFuncB",s)},tT=function(t,n){const s=d(this,si).createElementNS(Po,"feComponentTransfer");n.append(s),M(this,ge,bg).call(this,s,"feFuncA",t)},Sg=function(t){return d(this,ge,ih).style.color=t,lp(getComputedStyle(d(this,ge,ih)).getPropertyValue("color"))};class RP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ut("Abstract method `_fetch` called.")}}class mM extends RP{async _fetch(e){const t=await ap(e,"arraybuffer");return new Uint8Array(t)}}class IP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Ut("Abstract method `_fetch` called.")}}class yM extends IP{async _fetch(e){const t=await ap(e,"arraybuffer");return new Uint8Array(t)}}bi&&Ue("Please use the `legacy` build in Node.js environments.");async function Lw(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class dq extends CP{}class hq extends TP{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class fq extends wP{async _fetch(e){return Lw(e)}}class pq extends RP{async _fetch(e){return Lw(e)}}class gq extends IP{async _fetch(e){return Lw(e)}}const Zd="__forcedDependency",{floor:vM,ceil:bM}=Math;function yv(i,e,t,n,s,o){i[e*4+0]=Math.min(i[e*4+0],t),i[e*4+1]=Math.min(i[e*4+1],n),i[e*4+2]=Math.max(i[e*4+2],s),i[e*4+3]=Math.max(i[e*4+3],o)}const nT=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Jh,Ml;class mq{constructor(e,t){R(this,Jh);R(this,Ml);E(this,Jh,e),E(this,Ml,t)}get length(){return d(this,Jh).length}isEmpty(e){return d(this,Jh)[e]===nT}minX(e){return d(this,Ml)[e*4+0]/256}minY(e){return d(this,Ml)[e*4+1]/256}maxX(e){return(d(this,Ml)[e*4+2]+1)/256}maxY(e){return(d(this,Ml)[e*4+3]+1)/256}}Jh=new WeakMap,Ml=new WeakMap;const vv=(i,e)=>{if(!i)return;let t=i.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},i.set(e,t)),t};var Oi,Ui,fu,ur,pu,Zo,bt,wt,ea,Fi,Tm,jh,gu,mu,ta,ri,Yr,wm,iT;class yq{constructor(e,t,n=!1){R(this,wm);R(this,Oi,{__proto__:null});R(this,Ui,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Zd]:[]});R(this,fu,new Map);R(this,ur,[]);R(this,pu,[]);R(this,Zo,[[1,0,0,1,0,0]]);R(this,bt,[-1/0,-1/0,1/0,1/0]);R(this,wt,new Float64Array([1/0,1/0,-1/0,-1/0]));R(this,ea,-1);R(this,Fi,new Set);R(this,Tm,new Map);R(this,jh,new Map);R(this,gu);R(this,mu);R(this,ta);R(this,ri);R(this,Yr);E(this,gu,e.width),E(this,mu,e.height),M(this,wm,iT).call(this,t),n&&E(this,Yr,new Map)}growOperationsCount(e){e>=d(this,ri).length&&M(this,wm,iT).call(this,e,d(this,ri))}save(e){return E(this,Oi,{__proto__:d(this,Oi)}),E(this,Ui,{__proto__:d(this,Ui),transform:{__proto__:d(this,Ui).transform},moveText:{__proto__:d(this,Ui).moveText},sameLineText:{__proto__:d(this,Ui).sameLineText},[Zd]:{__proto__:d(this,Ui)[Zd]}}),E(this,bt,{__proto__:d(this,bt)}),d(this,ur).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(d(this,Oi));if(t===null)return this;E(this,Oi,t),E(this,Ui,Object.getPrototypeOf(d(this,Ui))),E(this,bt,Object.getPrototypeOf(d(this,bt)));const n=d(this,ur).pop();return n!==void 0&&((s=vv(d(this,Yr),e))==null||s.dependencies.add(n),d(this,ri)[e]=d(this,ri)[n]),this}recordOpenMarker(e){return d(this,ur).push(e),this}getOpenMarker(){return d(this,ur).length===0?null:d(this,ur).at(-1)}recordCloseMarker(e){var n;const t=d(this,ur).pop();return t!==void 0&&((n=vv(d(this,Yr),e))==null||n.dependencies.add(t),d(this,ri)[e]=d(this,ri)[t]),this}beginMarkedContent(e){return d(this,pu).push(e),this}endMarkedContent(e){var n;const t=d(this,pu).pop();return t!==void 0&&((n=vv(d(this,Yr),e))==null||n.dependencies.add(t),d(this,ri)[e]=d(this,ri)[t]),this}pushBaseTransform(e){return d(this,Zo).push(be.multiplyByDOMMatrix(d(this,Zo).at(-1),e.getTransform())),this}popBaseTransform(){return d(this,Zo).length>1&&d(this,Zo).pop(),this}recordSimpleData(e,t){return d(this,Oi)[e]=t,this}recordIncrementalData(e,t){return d(this,Ui)[e].push(t),this}resetIncrementalData(e,t){return d(this,Ui)[e].length=0,this}recordNamedData(e,t){return d(this,fu).set(e,t),this}recordSimpleDataFromNamed(e,t,n){d(this,Oi)[e]=d(this,fu).get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Zd,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in d(this,Oi)&&this.recordFutureForcedDependency(t,d(this,Oi)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of d(this,Fi))this.recordFutureForcedDependency(Zd,e);return this}resetBBox(e){return d(this,ea)!==e&&(E(this,ea,e),d(this,wt)[0]=1/0,d(this,wt)[1]=1/0,d(this,wt)[2]=-1/0,d(this,wt)[3]=-1/0),this}recordClipBox(e,t,n,s,o,l){const c=be.multiplyByDOMMatrix(d(this,Zo).at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];be.axialAlignedBoundingBox([n,o,s,l],c,h);const f=be.intersect(d(this,bt),h);return f?(d(this,bt)[0]=f[0],d(this,bt)[1]=f[1],d(this,bt)[2]=f[2],d(this,bt)[3]=f[3]):(d(this,bt)[0]=d(this,bt)[1]=1/0,d(this,bt)[2]=d(this,bt)[3]=-1/0),this}recordBBox(e,t,n,s,o,l){const c=d(this,bt);if(c[0]===1/0)return this;const h=be.multiplyByDOMMatrix(d(this,Zo).at(-1),t.getTransform());if(c[0]===-1/0)return be.axialAlignedBoundingBox([n,o,s,l],h,d(this,wt)),this;const f=[1/0,1/0,-1/0,-1/0];return be.axialAlignedBoundingBox([n,o,s,l],h,f),d(this,wt)[0]=Math.min(d(this,wt)[0],Math.max(f[0],c[0])),d(this,wt)[1]=Math.min(d(this,wt)[1],Math.max(f[1],c[1])),d(this,wt)[2]=Math.max(d(this,wt)[2],Math.min(f[2],c[2])),d(this,wt)[3]=Math.max(d(this,wt)[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,l=0,c){const h=n.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&d(this,jh).get(n),f!==!1&&(g=[0,0,0,0],be.axialAlignedBoundingBox(h,n.fontMatrix,g),(s!==1||o!==0||l!==0)&&be.scaleMinMax([s,0,0,-s,o,l],g),f)))return this.recordBBox(e,t,g[0],g[2],g[1],g[3]);if(!c)return this.recordFullPageBBox(e);const y=c();return h&&g&&f===void 0&&(f=g[0]<=o-y.actualBoundingBoxLeft&&g[2]>=o+y.actualBoundingBoxRight&&g[1]<=l-y.actualBoundingBoxAscent&&g[3]>=l+y.actualBoundingBoxDescent,d(this,jh).set(n,f),f)?this.recordBBox(e,t,g[0],g[2],g[1],g[3]):this.recordBBox(e,t,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(e){return d(this,wt)[0]=Math.max(0,d(this,bt)[0]),d(this,wt)[1]=Math.max(0,d(this,bt)[1]),d(this,wt)[2]=Math.min(d(this,gu),d(this,bt)[2]),d(this,wt)[3]=Math.min(d(this,mu),d(this,bt)[3]),this}getSimpleIndex(e){return d(this,Oi)[e]}recordDependencies(e,t){const n=d(this,Fi),s=d(this,Oi),o=d(this,Ui);for(const l of t)l in d(this,Oi)?n.add(s[l]):l in o&&o[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return d(this,fu).has(t)&&d(this,Fi).add(d(this,fu).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Zd]),d(this,Yr)){const n=vv(d(this,Yr),e),{dependencies:s}=n;d(this,Fi).forEach(s.add,s),d(this,ur).forEach(s.add,s),d(this,pu).forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(d(this,ea)===e){const n=vM(d(this,wt)[0]*256/d(this,gu)),s=vM(d(this,wt)[1]*256/d(this,mu)),o=bM(d(this,wt)[2]*256/d(this,gu)),l=bM(d(this,wt)[3]*256/d(this,mu));yv(d(this,ta),e,n,s,o,l);for(const c of d(this,Fi))c!==e&&yv(d(this,ta),c,n,s,o,l);for(const c of d(this,ur))c!==e&&yv(d(this,ta),c,n,s,o,l);for(const c of d(this,pu))c!==e&&yv(d(this,ta),c,n,s,o,l);t||(d(this,Fi).clear(),E(this,ea,-1))}return this}recordShowTextOperation(e,t=!1){const n=Array.from(d(this,Fi));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return d(this,ea)===e&&(E(this,ea,-1),d(this,bt)[0]=Math.max(d(this,bt)[0],d(this,wt)[0]),d(this,bt)[1]=Math.max(d(this,bt)[1],d(this,wt)[1]),d(this,bt)[2]=Math.min(d(this,bt)[2],d(this,wt)[2]),d(this,bt)[3]=Math.min(d(this,bt)[3],d(this,wt)[3]),t||d(this,Fi).clear()),this}_takePendingDependencies(){const e=d(this,Fi);return E(this,Fi,new Set),e}_extractOperation(e){const t=d(this,Tm).get(e);return d(this,Tm).delete(e),t}_pushPendingDependencies(e){for(const t of e)d(this,Fi).add(t)}take(){return d(this,jh).clear(),new mq(d(this,ri),d(this,ta))}takeDebugMetadata(){return d(this,Yr)}}Oi=new WeakMap,Ui=new WeakMap,fu=new WeakMap,ur=new WeakMap,pu=new WeakMap,Zo=new WeakMap,bt=new WeakMap,wt=new WeakMap,ea=new WeakMap,Fi=new WeakMap,Tm=new WeakMap,jh=new WeakMap,gu=new WeakMap,mu=new WeakMap,ta=new WeakMap,ri=new WeakMap,Yr=new WeakMap,wm=new WeakSet,iT=function(e,t){const n=new ArrayBuffer(e*4);E(this,ta,new Uint8ClampedArray(n)),E(this,ri,new Uint32Array(n)),t&&t.length>0?(d(this,ri).set(t),d(this,ri).fill(nT,t.length)):d(this,ri).fill(nT)};var kt,nn,dr,Qh,Zh;const uC=class uC{constructor(e,t,n){R(this,kt);R(this,nn);R(this,dr);R(this,Qh,0);R(this,Zh,0);if(e instanceof uC&&d(e,dr)===!!n)return e;E(this,kt,e),E(this,nn,t),E(this,dr,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Sn(this,Zh)._++,d(this,kt).save(d(this,nn)),this}restore(e){return d(this,Zh)>0&&(d(this,kt).restore(d(this,nn)),Sn(this,Zh)._--),this}recordOpenMarker(e){return Sn(this,Qh)._++,this}getOpenMarker(){return d(this,Qh)>0?d(this,nn):d(this,kt).getOpenMarker()}recordCloseMarker(e){return Sn(this,Qh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return d(this,kt).pushBaseTransform(e),this}popBaseTransform(){return d(this,kt).popBaseTransform(),this}recordSimpleData(e,t){return d(this,kt).recordSimpleData(e,d(this,nn)),this}recordIncrementalData(e,t){return d(this,kt).recordIncrementalData(e,d(this,nn)),this}resetIncrementalData(e,t){return d(this,kt).resetIncrementalData(e,d(this,nn)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return d(this,kt).recordSimpleDataFromNamed(e,t,d(this,nn)),this}recordFutureForcedDependency(e,t){return d(this,kt).recordFutureForcedDependency(e,d(this,nn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return d(this,kt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return d(this,kt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return d(this,dr)||d(this,kt).resetBBox(d(this,nn)),this}recordClipBox(e,t,n,s,o,l){return d(this,dr)||d(this,kt).recordClipBox(d(this,nn),t,n,s,o,l),this}recordBBox(e,t,n,s,o,l){return d(this,dr)||d(this,kt).recordBBox(d(this,nn),t,n,s,o,l),this}recordCharacterBBox(e,t,n,s,o,l,c){return d(this,dr)||d(this,kt).recordCharacterBBox(d(this,nn),t,n,s,o,l,c),this}recordFullPageBBox(e){return d(this,dr)||d(this,kt).recordFullPageBBox(d(this,nn)),this}getSimpleIndex(e){return d(this,kt).getSimpleIndex(e)}recordDependencies(e,t){return d(this,kt).recordDependencies(d(this,nn),t),this}recordNamedDependency(e,t){return d(this,kt).recordNamedDependency(d(this,nn),t),this}recordOperation(e){return d(this,kt).recordOperation(d(this,nn),!0),this}recordShowTextOperation(e){return d(this,kt).recordShowTextOperation(d(this,nn),!0),this}bboxToClipBoxDropOperation(e){return d(this,dr)||d(this,kt).bboxToClipBoxDropOperation(d(this,nn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};kt=new WeakMap,nn=new WeakMap,dr=new WeakMap,Qh=new WeakMap,Zh=new WeakMap;let vb=uC;const Us={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Kn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function sT(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class Ow{isModifyingCurrentTransform(){return!1}getPattern(){Ut("Abstract method `getPattern` called.")}}class vq extends Ow{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===Kn.STROKE||s===Kn.FILL){const l=t.current.getClippedPathBoundingBox(s,Kt(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=be.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...t.baseTransform),this.matrix&&g.transform(...this.matrix),sT(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=e.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);o.setTransform(y)}else sT(e,this._bbox),o=this._createGradient(e);return o}}function jA(i,e,t,n,s,o,l,c){const h=e.coords,f=e.colors,g=i.data,y=i.width*4;let b;h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b),h[n+1]>h[s+1]&&(b=n,n=s,s=b,b=l,l=c,c=b),h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b);const A=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,C=(h[n]+e.offsetX)*e.scaleX,N=(h[n+1]+e.offsetY)*e.scaleY,I=(h[s]+e.offsetX)*e.scaleX,P=(h[s+1]+e.offsetY)*e.scaleY;if(w>=P)return;const k=f[o],L=f[o+1],O=f[o+2],U=f[l],F=f[l+1],K=f[l+2],q=f[c],Q=f[c+1],ee=f[c+2],se=Math.round(w),le=Math.round(P);let ue,me,G,$,oe,pe,Me,H;for(let J=se;J<=le;J++){if(J<N){const Ee=J<w?0:(w-J)/(w-N);ue=A-(A-C)*Ee,me=k-(k-U)*Ee,G=L-(L-F)*Ee,$=O-(O-K)*Ee}else{let Ee;J>P?Ee=1:N===P?Ee=0:Ee=(N-J)/(N-P),ue=C-(C-I)*Ee,me=U-(U-q)*Ee,G=F-(F-Q)*Ee,$=K-(K-ee)*Ee}let re;J<w?re=0:J>P?re=1:re=(w-J)/(w-P),oe=A-(A-I)*re,pe=k-(k-q)*re,Me=L-(L-Q)*re,H=O-(O-ee)*re;const de=Math.round(Math.min(ue,oe)),_e=Math.round(Math.max(ue,oe));let Ce=y*J+de*4;for(let Ee=de;Ee<=_e;Ee++)re=(ue-Ee)/(ue-oe),re<0?re=0:re>1&&(re=1),g[Ce++]=me-(me-pe)*re|0,g[Ce++]=G-(G-Me)*re|0,g[Ce++]=$-($-H)*re|0,g[Ce++]=255}}function bq(i,e,t){const n=e.coords,s=e.colors;let o,l;switch(e.type){case"lattice":const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let g=o*c;for(let y=0;y<f;y++,g++)jA(i,t,n[g],n[g+1],n[g+c],s[g],s[g+1],s[g+c]),jA(i,t,n[g+c+1],n[g+1],n[g+c],s[g+c+1],s[g+1],s[g+c])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)jA(i,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class _q extends Ow{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*e[1]*1.1)),3e3),A=f/y,w=g/b,C={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/A,scaleY:1/w},N=y+4,I=b+4,P=n.getCanvas("mesh",N,I),k=P.context,L=k.createImageData(y,b);if(t){const U=L.data;for(let F=0,K=U.length;F<K;F+=4)U[F]=t[0],U[F+1]=t[1],U[F+2]=t[2],U[F+3]=255}for(const U of this._figures)bq(L,U,C);return k.putImageData(L,2,2),{canvas:P.canvas,offsetX:c-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){sT(e,this._bbox);const o=new Float32Array(2);if(s===Kn.SHADING)be.singularValueDecompose2dScale(Kt(e),o);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;be.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else be.singularValueDecompose2dScale(t.baseTransform,o);const l=this._createMeshCanvas(o,s===Kn.SHADING?null:this._background,t.cachedCanvases);return s!==Kn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class Sq extends Ow{getPattern(){return"hotpink"}}function Aq(i){switch(i[0]){case"RadialAxial":return new vq(i);case"Mesh":return new _q(i);case"Dummy":return new Sq}throw new Error(`Unknown IR type: ${i[0]}`)}const _M={COLORED:1,UNCOLORED:2},qb=class qb{constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){var pe,Me;const{bbox:n,operatorList:s,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),c_("TilingType: "+l);const y=n[0],b=n[1],A=n[2],w=n[3],C=A-y,N=w-b,I=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,I);const[P,k]=I;be.singularValueDecompose2dScale(this.baseTransform,I);const L=P*I[0],O=k*I[1];let U=C,F=N,K=!1,q=!1;const Q=Math.ceil(f*L),ee=Math.ceil(g*O),se=Math.ceil(C*L),le=Math.ceil(N*O);Q>=se?U=f:K=!0,ee>=le?F=g:q=!0;const ue=this.getSizeAndScale(U,this.ctx.canvas.width,L),me=this.getSizeAndScale(F,this.ctx.canvas.height,O),G=e.cachedCanvases.getCanvas("pattern",ue.size,me.size),$=G.context,oe=h.createCanvasGraphics($,t);if(oe.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(oe,o,c),$.translate(-ue.scale*y,-me.scale*b),oe.transform(0,ue.scale,0,0,me.scale,0,0),$.save(),(pe=oe.dependencyTracker)==null||pe.save(),this.clipBbox(oe,y,b,A,w),oe.baseTransform=Kt(oe.ctx),oe.executeOperatorList(s),oe.endDrawing(),(Me=oe.dependencyTracker)==null||Me.restore(),$.restore(),K||q){const H=G.canvas;K&&(U=f),q&&(F=g);const J=this.getSizeAndScale(U,this.ctx.canvas.width,L),re=this.getSizeAndScale(F,this.ctx.canvas.height,O),de=J.size,_e=re.size,Ce=e.cachedCanvases.getCanvas("pattern-workaround",de,_e),Ee=Ce.context,st=K?Math.floor(C/f):0,Je=q?Math.floor(N/g):0;for(let It=0;It<=st;It++)for(let Xe=0;Xe<=Je;Xe++)Ee.drawImage(H,de*It,_e*Xe,de,_e,0,0,de,_e);return{canvas:Ce.canvas,scaleX:J.scale,scaleY:re.scale,offsetX:y,offsetY:b}}return{canvas:G.canvas,scaleX:ue.scale,scaleY:me.scale,offsetX:y,offsetY:b}}getSizeAndScale(e,t,n){const s=Math.max(qb.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const l=s-t,c=o-n;e.ctx.rect(t,n,l,c),be.axialAlignedBoundingBox([t,n,s,o],Kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case _M.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=l,s.strokeStyle=o.strokeColor=c;break;case _M.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new VV(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let l=n;s!==Kn.SHADING&&(l=be.transform(l,t.baseTransform),this.matrix&&(l=be.transform(l,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}};ce(qb,"MAX_PATTERN_SIZE",3e3);let rT=qb;function Eq({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=On.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],g=n>>3,y=n&7,b=i.length;t=new Uint32Array(t.buffer);let A=0;for(let w=0;w<s;w++){for(const N=e+g;e<N;e++){const I=e<b?i[e]:255;t[A++]=I&128?f:h,t[A++]=I&64?f:h,t[A++]=I&32?f:h,t[A++]=I&16?f:h,t[A++]=I&8?f:h,t[A++]=I&4?f:h,t[A++]=I&2?f:h,t[A++]=I&1?f:h}if(y===0)continue;const C=e<b?i[e++]:255;for(let N=0;N<y;N++)t[A++]=C&1<<7-N?f:h}return{srcPos:e,destPos:A}}const SM=16,AM=100,Tq=15,EM=10,zi=16,QA=new DOMMatrix,ys=new Float32Array(2),dh=new Float32Array([1/0,1/0,-1/0,-1/0]);function wq(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,s,o,l,c){e.transform(t,n,s,o,l,c),this.__originalTransform(t,n,s,o,l,c)},i.setTransform=function(t,n,s,o,l,c){e.setTransform(t,n,s,o,l,c),this.__originalSetTransform(t,n,s,o,l,c)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,o,l,c){e.bezierCurveTo(t,n,s,o,l,c),this.__originalBezierCurveTo(t,n,s,o,l,c)},i.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Cq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function bv(i,e,t,n,s,o,l,c,h,f){const[g,y,b,A,w,C]=Kt(i);if(y===0&&b===0){const P=l*g+w,k=Math.round(P),L=c*A+C,O=Math.round(L),U=(l+h)*g+w,F=Math.abs(Math.round(U)-k)||1,K=(c+f)*A+C,q=Math.abs(Math.round(K)-O)||1;return i.setTransform(Math.sign(g),0,0,Math.sign(A),k,O),i.drawImage(e,t,n,s,o,0,0,F,q),i.setTransform(g,y,b,A,w,C),[F,q]}if(g===0&&A===0){const P=c*b+w,k=Math.round(P),L=l*y+C,O=Math.round(L),U=(c+f)*b+w,F=Math.abs(Math.round(U)-k)||1,K=(l+h)*y+C,q=Math.abs(Math.round(K)-O)||1;return i.setTransform(0,Math.sign(y),Math.sign(b),0,k,O),i.drawImage(e,t,n,s,o,0,0,q,F),i.setTransform(g,y,b,A,w,C),[q,F]}i.drawImage(e,t,n,s,o,l,c,h,f);const N=Math.hypot(g,y),I=Math.hypot(b,A);return[N*h,I*f]}class TM{constructor(e,t,n){ce(this,"alphaIsShape",!1);ce(this,"fontSize",0);ce(this,"fontSizeScale",1);ce(this,"textMatrix",null);ce(this,"textMatrixScale",1);ce(this,"fontMatrix",ME);ce(this,"leading",0);ce(this,"x",0);ce(this,"y",0);ce(this,"lineX",0);ce(this,"lineY",0);ce(this,"charSpacing",0);ce(this,"wordSpacing",0);ce(this,"textHScale",1);ce(this,"textRenderingMode",Vn.FILL);ce(this,"textRise",0);ce(this,"fillColor","#000000");ce(this,"strokeColor","#000000");ce(this,"patternFill",!1);ce(this,"patternStroke",!1);ce(this,"fillAlpha",1);ce(this,"strokeAlpha",1);ce(this,"lineWidth",1);ce(this,"activeSMask",null);ce(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=dh.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Kn.FILL,t=null){const n=this.minMax.slice();if(e===Kn.STROKE){t||Ut("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(t,ys);const s=ys[0]*this.lineWidth/2,o=ys[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(dh,0)}getClippedPathBoundingBox(e=Kn.FILL,t=null){return be.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function wM(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%zi,o=(t-s)/zi,l=s===0?o:o+1,c=i.createImageData(n,zi);let h=0,f;const g=e.data,y=c.data;let b,A,w,C;if(e.kind===Lg.GRAYSCALE_1BPP){const N=g.byteLength,I=new Uint32Array(y.buffer,0,y.byteLength>>2),P=I.length,k=n+7>>3,L=4294967295,O=On.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(w=b<o?zi:s,f=0,A=0;A<w;A++){const U=N-h;let F=0;const K=U>k?n:U*8-7,q=K&-8;let Q=0,ee=0;for(;F<q;F+=8)ee=g[h++],I[f++]=ee&128?L:O,I[f++]=ee&64?L:O,I[f++]=ee&32?L:O,I[f++]=ee&16?L:O,I[f++]=ee&8?L:O,I[f++]=ee&4?L:O,I[f++]=ee&2?L:O,I[f++]=ee&1?L:O;for(;F<K;F++)Q===0&&(ee=g[h++],Q=128),I[f++]=ee&Q?L:O,Q>>=1}for(;f<P;)I[f++]=0;i.putImageData(c,0,b*zi)}}else if(e.kind===Lg.RGBA_32BPP){for(A=0,C=n*zi*4,b=0;b<o;b++)y.set(g.subarray(h,h+C)),h+=C,i.putImageData(c,0,A),A+=zi;b<l&&(C=n*s*4,y.set(g.subarray(h,h+C)),i.putImageData(c,0,A))}else if(e.kind===Lg.RGB_24BPP)for(w=zi,C=n*w,b=0;b<l;b++){for(b>=o&&(w=s,C=n*w),f=0,A=C;A--;)y[f++]=g[h++],y[f++]=g[h++],y[f++]=g[h++],y[f++]=255;i.putImageData(c,0,b*zi)}else throw new Error(`bad image kind: ${e.kind}`)}function CM(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%zi,o=(t-s)/zi,l=s===0?o:o+1,c=i.createImageData(n,zi);let h=0;const f=e.data,g=c.data;for(let y=0;y<l;y++){const b=y<o?zi:s;({srcPos:h}=Eq({src:f,srcPos:h,dest:g,width:n,height:b,nonBlackColor:0})),i.putImageData(c,0,y*zi)}}function og(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function _v(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function xM(i,e){if(e)return!0;be.singularValueDecompose2dScale(i,ys);const t=Math.fround(Tr.pixelRatio*Ra.PDF_TO_CSS_UNITS);return ys[0]<=t&&ys[1]<=t}const xq=["butt","round","square"],Rq=["miter","round","bevel"],Iq={},RM={};var Cr,oT,aT,lT;const dC=class dC{constructor(e,t,n,s,o,{optionalContentConfig:l,markedContentStack:c=null},h,f,g){R(this,Cr);this.ctx=e,this.current=new TM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Cq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(e,t,n=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Kt(this.compositeCtx))}this.ctx.save(),_v(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Kt(this.ctx)}executeOperatorList(e,t,n,s,o){var I;const l=e.argsArray,c=e.fnArray;let h=t||0;const f=l.length;if(f===h)return h;const g=f-h>EM&&typeof n=="function",y=g?Date.now()+Tq:0;let b=0;const A=this.commonObjs,w=this.objs;let C,N;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(C=c[h],N=l[h]??null,C!==ep.dependency)N===null?this[C](h):this[C](h,...N);else for(const P of N){(I=this.dependencyTracker)==null||I.recordNamedData(P,h);const k=P.startsWith("g_")?A:w;if(!k.has(P))return k.get(P,n),h}if(h++,h===f)return h;if(g&&++b>EM){if(Date.now()>y)return n(),h;b=0}}}endDrawing(){M(this,Cr,oT).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),M(this,Cr,aT).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",g,y;for(;o>2&&c>1||l>2&&h>1;){let b=c,A=h;o>2&&c>1&&(b=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/b),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),g=this.cachedCanvases.getCanvas(f,b,A),y=g.context,y.clearRect(0,0,b,A),y.drawImage(e,0,0,c,h,0,0,b,A),e=g.canvas,c=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){var Q,ee;const n=this.ctx,{width:s,height:o}=t,l=this.current.fillColor,c=this.current.patternFill,h=Kt(n);let f,g,y,b;if((t.bitmap||t.data)&&t.count>1){const se=t.bitmap||t.data.buffer;g=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(se),f||(f=new Map,this._cachedBitmapsMap.set(se,f));const le=f.get(g);if(le&&!c){const ue=Math.round(Math.min(h[0],h[2])+h[4]),me=Math.round(Math.min(h[1],h[3])+h[5]);return(Q=this.dependencyTracker)==null||Q.recordDependencies(e,Us.transformAndFill),{canvas:le,offsetX:ue,offsetY:me}}y=le}y||(b=this.cachedCanvases.getCanvas("maskCanvas",s,o),CM(b.context,t));let A=be.transform(h,[1/s,0,0,-1/o,0,0]);A=be.transform(A,[1,0,0,1,0,-o]);const w=dh.slice();be.axialAlignedBoundingBox([0,0,s,o],A,w);const[C,N,I,P]=w,k=Math.round(I-C)||1,L=Math.round(P-N)||1,O=this.cachedCanvases.getCanvas("fillCanvas",k,L),U=O.context,F=C,K=N;U.translate(-F,-K),U.transform(...A),y||(y=this._scaleImage(b.canvas,kr(U)),y=y.img,f&&c&&f.set(g,y)),U.imageSmoothingEnabled=xM(Kt(U),t.interpolate),bv(U,y,0,0,y.width,y.height,0,0,s,o),U.globalCompositeOperation="source-in";const q=be.transform(kr(U),[1,0,0,1,-F,-K]);return U.fillStyle=c?l.getPattern(n,this,q,Kn.FILL,e):l,U.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),(ee=this.dependencyTracker)==null||ee.recordDependencies(e,Us.transformAndFill),{canvas:O.canvas,offsetX:Math.round(F),offsetY:Math.round(K)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=xq[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Rq[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var o;(o=this.dependencyTracker)==null||o.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,s,o,l,c;for(const[h,f]of t)switch(h){case"LW":this.setLineWidth(e,f);break;case"LC":this.setLineCap(e,f);break;case"LJ":this.setLineJoin(e,f);break;case"ML":this.setMiterLimit(e,f);break;case"D":this.setDash(e,f[0],f[1]);break;case"RI":this.setRenderingIntent(e,f);break;case"FL":this.setFlatness(e,f);break;case"Font":this.setFont(e,f[0],f[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=f;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=f;break;case"BM":(o=this.dependencyTracker)==null||o.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=f;break;case"SMask":(l=this.dependencyTracker)==null||l.recordSimpleData("SMask",e),this.current.activeSMask=f?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(c=this.dependencyTracker)==null||c.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(f);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),og(this.suspendedCtx,l),wq(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),og(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],l=s[1],c=s[2]-o,h=s[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,l,c,h,f,g,y){let b=e.canvas,A=h-g,w=f-y;if(l)if(A<0||w<0||A+n>b.width||w+s>b.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,s),I=N.context;I.drawImage(b,-A,-w),I.globalCompositeOperation="destination-atop",I.fillStyle=l,I.fillRect(0,0,n,s),I.globalCompositeOperation="source-over",b=N.canvas,A=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(A,w,n,s),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(A,w,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const C=new Path2D;C.rect(h,f,n,s),t.clip(C),t.globalCompositeOperation="destination-in",t.drawImage(b,A,w,n,s,h,f,n,s),t.restore()}save(e){var n;this.inSMaskMode&&og(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&og(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,l,c){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||(o=n[0]=new Path2D),this[t](e,o);return}if(this.dependencyTracker!==null){const l=t===ep.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const l=n[0]=new Path2D;for(let c=0,h=o.length;c<h;)switch(o[c++]){case fv.moveTo:l.moveTo(o[c++],o[c++]);break;case fv.lineTo:l.lineTo(o[c++],o[c++]);break;case fv.curveTo:l.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);break;case fv.closePath:l.closePath();break;default:Ue(`Unrecognized drawing path operator: ${o[c-1]}`);break}o=l}be.axialAlignedBoundingBox(s,Kt(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var l;const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const c=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,kr(s),Kn.STROKE,e),c){const h=new Path2D;h.addPath(t,s.getTransform().invertSelf().multiplySelf(c)),t=h}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(l=this.dependencyTracker)==null||l.recordDependencies(e,Us.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Kn.STROKE,Kt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var f,g,y;const s=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const b=o.isModifyingCurrentTransform()?s.getTransform():null;if((f=this.dependencyTracker)==null||f.save(e),s.save(),s.fillStyle=o.getPattern(s,this,kr(s),Kn.FILL,e),b){const A=new Path2D;A.addPath(t,s.getTransform().invertSelf().multiplySelf(b)),t=A}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(g=this.dependencyTracker)==null||g.recordDependencies(e,Us.fill),c&&(s.restore(),(y=this.dependencyTracker)==null||y.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,Us.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Iq}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=RM}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:g}of t)g&&s.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var y,b;(y=this.dependencyTracker)==null||y.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||ME,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Ue("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=((b=s.systemFontInfo)==null?void 0:b.css)||`"${l}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let g=n;n<SM?g=SM:n>AM&&(g=AM),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${h} ${g}px ${c}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,s,o,l){var I,P,k,L;const c=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=g&Vn.FILL_STROKE_MASK,A=!!(g&Vn.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,C=h.patternStroke&&!f.missingFile;let N;if((f.disableFontFace||A||w||C)&&!f.missingFile&&(N=f.getPathGenerator(this.commonObjs,t)),N&&(f.disableFontFace||w||C)){c.save(),c.translate(n,s),c.scale(y,-y),(I=this.dependencyTracker)==null||I.recordCharacterBBox(e,c,f);let O;if(b===Vn.FILL||b===Vn.FILL_STROKE)if(o){O=c.getTransform(),c.setTransform(...o);const U=M(this,Cr,lT).call(this,N,O,o);c.fill(U)}else c.fill(N);if(b===Vn.STROKE||b===Vn.FILL_STROKE)if(l){O||(O=c.getTransform()),c.setTransform(...l);const{a:U,b:F,c:K,d:q}=O,Q=be.inverseTransform(l),ee=be.transform([U,F,K,q,0,0],Q);be.singularValueDecompose2dScale(ee,ys),c.lineWidth*=Math.max(ys[0],ys[1])/y,c.stroke(M(this,Cr,lT).call(this,N,O,l))}else c.lineWidth/=y,c.stroke(N);c.restore()}else(b===Vn.FILL||b===Vn.FILL_STROKE)&&(c.fillText(t,n,s),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t))),(b===Vn.STROKE||b===Vn.FILL_STROKE)&&(this.dependencyTracker&&((k=this.dependencyTracker)==null||k.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t)).recordDependencies(e,Us.stroke)),c.strokeText(t,n,s));A&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Kt(c),x:n,y:s,fontSize:y,path:N}),(L=this.dependencyTracker)==null||L.recordCharacterBBox(e,c,f,y,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ve(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var K,q,Q,ee;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Us.showText).resetBBox(e),this.current.textRenderingMode&Vn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),(K=this.dependencyTracker)==null||K.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){(q=this.dependencyTracker)==null||q.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,y=n.textHScale*g,b=t.length,A=s.vertical,w=A?1:-1,C=s.defaultVMetrics,N=o*n.fontMatrix[0],I=n.textRenderingMode===Vn.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),g>0?l.scale(y,-1):l.scale(y,1);let P,k;if(n.patternFill){l.save();const se=n.fillColor.getPattern(l,this,kr(l),Kn.FILL,e);P=Kt(l),l.restore(),l.fillStyle=se}if(n.patternStroke){l.save();const se=n.strokeColor.getPattern(l,this,kr(l),Kn.STROKE,e);k=Kt(l),l.restore(),l.strokeStyle=se}let L=n.lineWidth;const O=n.textMatrixScale;if(O===0||L===0){const se=n.textRenderingMode&Vn.FILL_STROKE_MASK;(se===Vn.STROKE||se===Vn.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=O;if(c!==1&&(l.scale(c,c),L/=c),l.lineWidth=L,s.isInvalidPDFjsFont){const se=[];let le=0;for(const me of t)se.push(me.unicode),le+=me.width;const ue=se.join("");if(l.fillText(ue,0,0),this.dependencyTracker!==null){const me=l.measureText(ue);this.dependencyTracker.recordBBox(e,this.ctx,-me.actualBoundingBoxLeft,me.actualBoundingBoxRight,-me.actualBoundingBoxAscent,me.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=le*N*y,l.restore(),this.compose();return}let U=0,F;for(F=0;F<b;++F){const se=t[F];if(typeof se=="number"){U+=w*se*o/1e3;continue}let le=!1;const ue=(se.isSpace?f:0)+h,me=se.fontChar,G=se.accent;let $,oe,pe=se.width;if(A){const J=se.vmetric||C,re=-(se.vmetric?J[1]:pe*.5)*N,de=J[2]*N;pe=J?-J[0]:pe,$=re/c,oe=(U+de)/c}else $=U/c,oe=0;let Me;if(s.remeasure&&pe>0){Me=l.measureText(me);const J=Me.width*1e3/o*c;if(pe<J&&this.isFontSubpixelAAEnabled){const re=pe/J;le=!0,l.save(),l.scale(re,1),$/=re}else pe!==J&&($+=(pe-J)/2e3*o/c)}if(this.contentVisible&&(se.isInFont||s.missingFile)){if(I&&!G)l.fillText(me,$,oe),(Q=this.dependencyTracker)==null||Q.recordCharacterBBox(e,l,Me?{bbox:null}:s,o/c,$,oe,()=>Me??l.measureText(me));else if(this.paintChar(e,me,$,oe,P,k),G){const J=$+o*G.offset.x/c,re=oe-o*G.offset.y/c;this.paintChar(e,G.fontChar,J,re,P,k)}}const H=A?pe*N-ue*g:pe*N+ue*g;U+=H,le&&l.restore()}A?n.y-=U:n.x+=U*y,l.restore(),this.compose(),(ee=this.dependencyTracker)==null||ee.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,l=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,y=s.textHScale*c,b=s.fontMatrix||ME,A=t.length,w=s.textRenderingMode===Vn.INVISIBLE;let C,N,I,P;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(y,c);const k=this.dependencyTracker;for(this.dependencyTracker=k?new vb(k,e):null,C=0;C<A;++C){if(N=t[C],typeof N=="number"){P=h*N*l/1e3,this.ctx.translate(P,0),s.x+=P*y;continue}const L=(N.isSpace?g:0)+f,O=o.charProcOperatorList[N.operatorListId];O?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...b),this.executeOperatorList(O),this.restore()):Ue(`Type3 character "${N.operatorListId}" is not available.`);const U=[N.width,0];be.applyTransform(U,b),I=U[0]*l+L,n.translate(I,0),s.x+=I*y}n.restore(),k&&(this.dependencyTracker=k)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,l,c){var f;const h=new Path2D;h.rect(s,o,l-s,c-o),this.ctx.clip(h),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,s,l,o,c).recordClipBox(e,this.ctx,s,l,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Kt(this.ctx),o={createCanvasGraphics:(l,c)=>new dC(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new vb(this.dependencyTracker,c,!0):null)};n=new rT(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=Aq(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){var l;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,kr(n),Kn.SHADING,e);const o=kr(n);if(o){const{width:c,height:h}=n.canvas,f=dh.slice();be.axialAlignedBoundingBox([0,0,c,h],o,f);const[g,y,b,A]=f;this.ctx.fillRect(g,y,b-g,A-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(l=this.dependencyTracker)==null||l.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Us.transform).recordDependencies(e,Us.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Ut("Should not call beginInlineImage")}beginImageData(){Ut("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Kt(this.ctx),n)){be.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[o,l,c,h]=n,f=new Path2D;f.rect(o,l,c-o,h-l),this.ctx.clip(f),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,o,c,l,h),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var k;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||c_("TODO: Support non-isolated groups."),t.knockout&&Ue("Knockout groups not supported.");const s=Kt(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=dh.slice();be.axialAlignedBoundingBox(t.bbox,Kt(n),o);const l=[0,0,n.canvas.width,n.canvas.height];o=be.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),g=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,g),A=b.context;A.translate(-c,-h),A.transform(...s);let w=new Path2D;const[C,N,I,P]=t.bbox;if(w.rect(C,N,I-C,P-N),t.matrix){const L=new Path2D;L.addPath(w,new DOMMatrix(t.matrix)),w=L}A.clip(w),t.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),og(n,A),this.ctx=A,(k=this.dependencyTracker)==null||k.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var o;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(o=this.dependencyTracker)==null||o.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Kt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...l);const c=dh.slice();be.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],l,c),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(e,t,n,s,o,l){if(M(this,Cr,oT).call(this),_v(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,be.singularValueDecompose2dScale(Kt(this.ctx),ys);const{viewportScale:f}=this,g=Math.ceil(c*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(ys[0],0,0,-ys[1],0,h*ys[1]),_v(this.ctx)}else{_v(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new TM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),M(this,Cr,aT).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var c;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,l,c){var y,b,A;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Kt(h);h.transform(n,s,o,l,0,0);const g=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),(y=this.dependencyTracker)==null||y.resetBBox(e);for(let w=0,C=c.length;w<C;w+=2){const N=be.transform(f,[n,s,o,l,c[w],c[w+1]]);h.drawImage(g.canvas,N[4],N[5]),(b=this.dependencyTracker)==null||b.recordBBox(e,this.ctx,N[4],N[4]+g.canvas.width,N[5],N[5]+g.canvas.height)}h.restore(),this.compose(),(A=this.dependencyTracker)==null||A.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var l,c,h;if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;(l=this.dependencyTracker)==null||l.resetBBox(e).recordDependencies(e,Us.transformAndFill);for(const f of t){const{data:g,width:y,height:b,transform:A}=f,w=this.cachedCanvases.getCanvas("maskCanvas",y,b),C=w.context;C.save();const N=this.getObject(e,g,f);CM(C,N),C.globalCompositeOperation="source-in",C.fillStyle=o?s.getPattern(C,this,kr(n),Kn.FILL,e):s,C.fillRect(0,0,y,b),C.restore(),n.save(),n.transform(...A),n.scale(1,-1),bv(n,w.canvas,0,0,y,b,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,n,0,y,0,b),n.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Ue("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let g=0,y=o.length;g<y;g+=2)f.push({transform:[n,0,0,s,o[g],o[g+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e,t){var f;if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const y=this.cachedCanvases.getCanvas("inlineImage",n,s).context;wM(y,t),c=this.applyTransferMapsToCanvas(y)}const h=this._scaleImage(c,kr(o));o.imageSmoothingEnabled=xM(Kt(o),t.interpolate),(f=this.dependencyTracker)==null||f.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,Us.imageXObject).recordOperation(e),bv(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var l,c,h;if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const f=t.width,g=t.height,b=this.cachedCanvases.getCanvas("inlineImage",f,g).context;wM(b,t),o=this.applyTransferMapsToCanvas(b)}(l=this.dependencyTracker)==null||l.resetBBox(e);for(const f of n)s.save(),s.transform(...f.transform),s.scale(1,-1),bv(s,o,f.x,f.y,f.w,f.h,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,s,0,1,-1,0),s.restore();(h=this.dependencyTracker)==null||h.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Us.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var l,c;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===RM?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,(l=this.dependencyTracker)==null||l.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(c=this.dependencyTracker)==null||c.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)l=c=1/h;else{const g=h*e;l=c=g<1?1/g:1}else if(e===0)l=1/h,c=1/f;else{const g=h*e,y=f*e;l=g<1?1/g:1,c=y<1?1/y:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),g=Math.hypot(s,o);if(e===0)l=g/h,c=f/h;else{const y=e*h;l=g>y?g/y:1,c=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,l),QA.a=1/o,QA.d=1/l;const h=new Path2D;if(h.addPath(e,QA),c.length>0){const f=Math.max(o,l);n.setLineDash(c.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Cr=new WeakSet,oT=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},aT=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},lT=function(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s};let _h=dC;for(const i in ep)_h.prototype[i]!==void 0&&(_h.prototype[ep[i]]=_h.prototype[i]);var ef,tf,Cm,nf,Pv;const ph=class ph{constructor(e){R(this,nf);R(this,ef);R(this,tf);R(this,Cm);E(this,ef,e),E(this,tf,new DataView(d(this,ef))),E(this,Cm,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const f of ph.strings){const g=t.encode(e[f]);n[f]=g,s+=4+g.length}const o=new ArrayBuffer(s),l=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of ph.strings){const g=n[f],y=g.length;c.setUint32(h,y),l.set(g,h+4),h+=4+y}return it(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}get fontFamily(){return M(this,nf,Pv).call(this,0)}get fontWeight(){return M(this,nf,Pv).call(this,1)}get italicAngle(){return M(this,nf,Pv).call(this,2)}};ef=new WeakMap,tf=new WeakMap,Cm=new WeakMap,nf=new WeakSet,Pv=function(e){it(e<ph.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=d(this,tf).getUint32(t)+4;const n=d(this,tf).getUint32(t);return d(this,Cm).decode(new Uint8Array(d(this,ef),t+4,n))},ce(ph,"strings",["fontFamily","fontWeight","italicAngle"]);let bb=ph;var Dl,Xr,yu,vu,Ag;const gh=class gh{constructor(e){R(this,vu);R(this,Dl);R(this,Xr);R(this,yu);E(this,Dl,e),E(this,Xr,new DataView(d(this,Dl))),E(this,yu,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const b of gh.strings){const A=t.encode(e[b]);n[b]=A,s+=4+A.length}s+=4;let o,l,c=1+s;e.style&&(o=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+o.length+4+l.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;g.setUint8(y++,e.guessFallback?1:0),g.setUint32(y,0),y+=4,s=0;for(const b of gh.strings){const A=n[b],w=A.length;s+=4+w,g.setUint32(y,w),f.set(A,y+4),y+=4+w}return g.setUint32(y-s-4,s),e.style&&(g.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,g.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),it(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}get guessFallback(){return d(this,Xr).getUint8(0)!==0}get css(){return M(this,vu,Ag).call(this,0)}get loadedName(){return M(this,vu,Ag).call(this,1)}get baseFontName(){return M(this,vu,Ag).call(this,2)}get src(){return M(this,vu,Ag).call(this,3)}get style(){let e=1;e+=4+d(this,Xr).getUint32(e);const t=d(this,Xr).getUint32(e),n=d(this,yu).decode(new Uint8Array(d(this,Dl),e+4,t));e+=4+t;const s=d(this,Xr).getUint32(e),o=d(this,yu).decode(new Uint8Array(d(this,Dl),e+4,s));return{style:n,weight:o}}};Dl=new WeakMap,Xr=new WeakMap,yu=new WeakMap,vu=new WeakSet,Ag=function(e){it(e<gh.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=d(this,Xr).getUint32(t)+4;const n=d(this,Xr).getUint32(t);return d(this,yu).decode(new Uint8Array(d(this,Dl),t+4,n))},ce(gh,"strings",["css","loadedName","baseFontName","src"]);let _b=gh;var sf,rf,of,af,ns,Wr,xm,Ct,on,rr,Lv,Eg;const He=class He{constructor({data:e,extra:t}){R(this,on);R(this,Wr);R(this,xm);R(this,Ct);E(this,Wr,e),E(this,xm,new TextDecoder),E(this,Ct,new DataView(d(this,Wr))),t&&Object.assign(this,t)}get black(){return M(this,on,rr).call(this,0)}get bold(){return M(this,on,rr).call(this,1)}get disableFontFace(){return M(this,on,rr).call(this,2)}get fontExtraProperties(){return M(this,on,rr).call(this,3)}get isInvalidPDFjsFont(){return M(this,on,rr).call(this,4)}get isType3Font(){return M(this,on,rr).call(this,5)}get italic(){return M(this,on,rr).call(this,6)}get missingFile(){return M(this,on,rr).call(this,7)}get remeasure(){return M(this,on,rr).call(this,8)}get vertical(){return M(this,on,rr).call(this,9)}get ascent(){return M(this,on,Lv).call(this,0)}get defaultWidth(){return M(this,on,Lv).call(this,1)}get descent(){return M(this,on,Lv).call(this,2)}get bbox(){let e=d(He,rf);if(d(this,Ct).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(d(this,Ct).getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=d(He,of);if(d(this,Ct).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(d(this,Ct).getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=d(He,af);if(d(this,Ct).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(d(this,Ct).getInt16(e,!0)),e+=2;return n}get fallbackName(){return M(this,on,Eg).call(this,0)}get loadedName(){return M(this,on,Eg).call(this,1)}get mimetype(){return M(this,on,Eg).call(this,2)}get name(){return M(this,on,Eg).call(this,3)}get data(){let e=d(He,ns);const t=d(this,Ct).getUint32(e);e+=4+t;const n=d(this,Ct).getUint32(e);e+=4+n;const s=d(this,Ct).getUint32(e);e+=4+s;const o=d(this,Ct).getUint32(e);if(o!==0)return new Uint8Array(d(this,Wr),e+4,o)}clearData(){let e=d(He,ns);const t=d(this,Ct).getUint32(e);e+=4+t;const n=d(this,Ct).getUint32(e);e+=4+n;const s=d(this,Ct).getUint32(e);e+=4+s;const o=d(this,Ct).getUint32(e);new Uint8Array(d(this,Wr),e+4,o).fill(0),d(this,Ct).setUint32(e,0)}get cssFontInfo(){let e=d(He,ns);const t=d(this,Ct).getUint32(e);e+=4+t;const n=d(this,Ct).getUint32(e);e+=4+n;const s=d(this,Ct).getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(d(this,Wr),e+4,s)),new bb(o.buffer)}get systemFontInfo(){let e=d(He,ns);const t=d(this,Ct).getUint32(e);e+=4+t;const n=d(this,Ct).getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Wr),e+4,n)),new _b(s.buffer)}static write(e){const t=e.systemFontInfo?_b.write(e.systemFontInfo):null,n=e.cssFontInfo?bb.write(e.cssFontInfo):null,s=new TextEncoder,o={};let l=0;for(const C of He.strings)o[C]=s.encode(e[C]),l+=4+o[C].length;const c=d(He,ns)+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;const b=He.bools.length;let A=0,w=0;for(let C=0;C<b;C++){const N=e[He.bools[C]];A|=(N===void 0?0:N?2:1)<<w,w+=2,(w===8||C===b-1)&&(g.setUint8(y++,A),A=0,w=0)}it(y===d(He,sf),"FontInfo.write: Boolean properties offset mismatch");for(const C of He.numbers)g.setFloat64(y,e[C]),y+=8;if(it(y===d(He,rf),"FontInfo.write: Number properties offset mismatch"),e.bbox){g.setUint8(y++,4);for(const C of e.bbox)g.setInt16(y,C,!0),y+=2}else g.setUint8(y++,0),y+=8;if(it(y===d(He,of),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){g.setUint8(y++,6);for(const C of e.fontMatrix)g.setFloat64(y,C,!0),y+=8}else g.setUint8(y++,0),y+=48;if(it(y===d(He,af),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){g.setUint8(y++,1);for(const C of e.defaultVMetrics)g.setInt16(y,C,!0),y+=2}else g.setUint8(y++,0),y+=6;it(y===d(He,ns),"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(d(He,ns),0),y+=4;for(const C of He.strings){const N=o[C],I=N.length;g.setUint32(y,I),f.set(N,y+4),y+=4+I}if(g.setUint32(d(He,ns),y-d(He,ns)-4),!t)g.setUint32(y,0),y+=4;else{const C=t.byteLength;g.setUint32(y,C),it(y+4+C<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),y+4),y+=4+C}if(!n)g.setUint32(y,0),y+=4;else{const C=n.byteLength;g.setUint32(y,C),it(y+4+C<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),y+4),y+=4+C}return e.data===void 0?(g.setUint32(y,0),y+=4):(g.setUint32(y,e.data.length),f.set(e.data,y+4),y+=4+e.data.length),it(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}};sf=new WeakMap,rf=new WeakMap,of=new WeakMap,af=new WeakMap,ns=new WeakMap,Wr=new WeakMap,xm=new WeakMap,Ct=new WeakMap,on=new WeakSet,rr=function(e){it(e<He.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=d(this,Ct).getUint8(t)>>n&3;return s===0?void 0:s===2},Lv=function(e){return it(e<He.numbers.length,"Invalid number index"),d(this,Ct).getFloat64(d(He,sf)+e*8)},Eg=function(e){it(e<He.strings.length,"Invalid string index");let t=d(He,ns)+4;for(let o=0;o<e;o++)t+=d(this,Ct).getUint32(t)+4;const n=d(this,Ct).getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Wr),t+4,n)),d(this,xm).decode(s)},ce(He,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),ce(He,"numbers",["ascent","defaultWidth","descent"]),ce(He,"strings",["fallbackName","loadedName","mimetype","name"]),R(He,sf,Math.ceil(He.bools.length*2/8)),R(He,rf,d(He,sf)+He.numbers.length*8),R(He,of,d(He,rf)+1+8),R(He,af,d(He,of)+1+48),R(He,ns,d(He,af)+1+6);let cT=He;var Rm,Im;class Ks{static get workerPort(){return d(this,Rm)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");E(this,Rm,e)}static get workerSrc(){return d(this,Im)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");E(this,Im,e)}}Rm=new WeakMap,Im=new WeakMap,R(Ks,Rm,null),R(Ks,Im,"");var lf,Nm;class Nq{constructor({parsedData:e,rawData:t}){R(this,lf);R(this,Nm);E(this,lf,e),E(this,Nm,t)}getRaw(){return d(this,Nm)}get(e){return d(this,lf).get(e)??null}[Symbol.iterator](){return d(this,lf).entries()}}lf=new WeakMap,Nm=new WeakMap;const oh=Symbol("INTERNAL");var Mm,Dm,km,cf;class Mq{constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){R(this,Mm,!1);R(this,Dm,!1);R(this,km,!1);R(this,cf,!0);E(this,Mm,!!(e&ms.DISPLAY)),E(this,Dm,!!(e&ms.PRINT)),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(d(this,km))return d(this,cf);if(!d(this,cf))return!1;const{print:e,view:t}=this.usage;return d(this,Mm)?(t==null?void 0:t.viewState)!=="OFF":d(this,Dm)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==oh&&Ut("Internal method `_setVisible` called."),E(this,km,n),E(this,cf,t)}}Mm=new WeakMap,Dm=new WeakMap,km=new WeakMap,cf=new WeakMap;var kl,xt,uf,df,Pm,uT;class Dq{constructor(e,t=ms.DISPLAY){R(this,Pm);R(this,kl,null);R(this,xt,new Map);R(this,uf,null);R(this,df,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,E(this,df,e.order);for(const n of e.groups)d(this,xt).set(n.id,new Mq(t,n));if(e.baseState==="OFF")for(const n of d(this,xt).values())n._setVisible(oh,!1);for(const n of e.on)d(this,xt).get(n)._setVisible(oh,!0);for(const n of e.off)d(this,xt).get(n)._setVisible(oh,!1);E(this,uf,this.getHash())}}isVisible(e){if(d(this,xt).size===0)return!0;if(!e)return c_("Optional content group not defined."),!0;if(e.type==="OCG")return d(this,xt).has(e.id)?d(this,xt).get(e.id).visible:(Ue(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return M(this,Pm,uT).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!d(this,xt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(d(this,xt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!d(this,xt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!d(this,xt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!d(this,xt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!d(this,xt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!d(this,xt).has(t))return Ue(`Optional content group not found: ${t}`),!0;if(d(this,xt).get(t).visible)return!1}return!0}return Ue(`Unknown optional content policy ${e.policy}.`),!0}return Ue(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var o;const s=d(this,xt).get(e);if(!s){Ue(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const l of s.rbGroups)for(const c of l)c!==e&&((o=d(this,xt).get(c))==null||o._setVisible(oh,!1,!0));s._setVisible(oh,!!t,!0),E(this,kl,null)}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=d(this,xt).get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}E(this,kl,null)}get hasInitialVisibility(){return d(this,uf)===null||this.getHash()===d(this,uf)}getOrder(){return d(this,xt).size?d(this,df)?d(this,df).slice():[...d(this,xt).keys()]:null}getGroup(e){return d(this,xt).get(e)||null}getHash(){if(d(this,kl)!==null)return d(this,kl);const e=new yP;for(const[t,n]of d(this,xt))e.update(`${t}:${n.visible}`);return E(this,kl,e.hexdigest())}[Symbol.iterator](){return d(this,xt).entries()}}kl=new WeakMap,xt=new WeakMap,uf=new WeakMap,df=new WeakMap,Pm=new WeakSet,uT=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let l;if(Array.isArray(o))l=M(this,Pm,uT).call(this,o);else if(d(this,xt).has(o))l=d(this,xt).get(o).visible;else return Ue(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class kq{constructor(e,{disableRange:t=!1,disableStream:n=!1}){it(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(o==null?void 0:o.length)>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});it(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,s,o;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(o=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||o.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){it(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Pq(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Lq(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Pq{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=d_(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Lq{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Oq(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let g=c(t);return g=unescape(g),g=h(g),g=f(g),o(g)}if(t=l(i),t){const g=f(t);return o(g)}if(t=n("filename","i").exec(i),t){t=t[1];let g=c(t);return g=f(g),o(g)}function n(g,y){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function s(g,y){if(g){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(g,{fatal:!0}),A=Ny(y);y=b.decode(A),e=!1}catch{}}return y}function o(g){return e&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),e&&(g=s("iso-8859-1",g))),g}function l(g){const y=[];let b;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(g))!==null;){let[,C,N,I]=b;if(C=parseInt(C,10),C in y){if(C===0)break;continue}y[C]=[N,I]}const w=[];for(let C=0;C<y.length&&C in y;++C){let[N,I]=y[C];I=c(I),N&&(I=unescape(I),C===0&&(I=h(I))),w.push(I)}return w.join("")}function c(g){if(g.startsWith('"')){const y=g.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}g=y.join('"')}return g}function h(g){const y=g.indexOf("'");if(y===-1)return g;const b=g.slice(0,y),w=g.slice(y+1).replace(/^[^']*'/,"");return s(b,w)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,N){return String.fromCharCode(parseInt(N,16))}),s(b,w);try{w=atob(w)}catch{}return s(b,w)})}return""}function NP(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function h_(i){var e;return((e=URL.parse(i))==null?void 0:e.origin)??null}function MP({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function DP(i){const e=i.get("Content-Disposition");if(e){let t=Oq(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(d_(t))return t}return null}function Py(i,e){return new Hg(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function kP(i){return i===200||i===206}function PP(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function LP(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Ue(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Uq{constructor(e){ce(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=NP(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Fq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Bq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Fq{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,PP(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=h_(o.url),!kP(o.status))throw Py(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=MP({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=DP(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new xa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:LP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Bq{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,PP(o,this._withCredentials,this._abortController)).then(c=>{const h=h_(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!kP(c.status))throw Py(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:LP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const ZA=200,eE=206;function Hq(i){const e=i.response;return typeof e!="string"?e:Ny(e).buffer}class Gq{constructor({url:e,httpHeaders:t,withCredentials:n}){ce(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=NP(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,l]of this.headers)t.setRequestHeader(o,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=eE):s.expectedStatus=ZA,t.responseType="arraybuffer",it(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var s;const n=this.pendingRequests[e];n&&((s=n.onProgress)==null||s.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||ZA;if(!(o===ZA&&n.expectedStatus===eE)&&o!==n.expectedStatus){n.onError(s.status);return}const c=Hq(s);if(o===eE){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(Ue('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class zq{constructor(e){this._source=e,this._manager=new Gq(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return it(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Vq(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new qq(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Vq{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=h_(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=MP({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=DP(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Py(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class qq{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=h_((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Py(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const $q=/^[a-z][a-z0-9\-+.]+:/i;function Yq(i){if($q.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class Xq{constructor(e){this.source=e,this.url=Yq(e.url),it(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Wq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Kq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Wq{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Py(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new xa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Kq{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ag=Symbol("INITIAL_DATA");var is,Lm,dT;class OP{constructor(){R(this,Lm);R(this,is,Object.create(null))}get(e,t=null){if(t){const s=M(this,Lm,dT).call(this,e);return s.promise.then(()=>t(s.data)),null}const n=d(this,is)[e];if(!n||n.data===ag)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=d(this,is)[e];return!!t&&t.data!==ag}delete(e){const t=d(this,is)[e];return!t||t.data===ag?!1:(delete d(this,is)[e],!0)}resolve(e,t=null){const n=M(this,Lm,dT).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in d(this,is)){const{data:n}=d(this,is)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}E(this,is,Object.create(null))}*[Symbol.iterator](){for(const e in d(this,is)){const{data:t}=d(this,is)[e];t!==ag&&(yield[e,t])}}}is=new WeakMap,Lm=new WeakSet,dT=function(e){var t;return(t=d(this,is))[e]||(t[e]={...Promise.withResolvers(),data:ag})};const Jq=1e5,IM=30;var ID,Pl,Bi,Om,Um,bu,na,Fm,Bm,_u,hf,ff,Ll,pf,Hm,gf,Su,Gm,zm,rn,mf,Au,Vm,Ol,yf,ka,UP,FP,hT,Ss,Ov,fT,BP,HP;let qg=(rn=class{constructor({textContentSource:e,container:t,viewport:n}){R(this,ka);R(this,Pl,Promise.withResolvers());R(this,Bi,null);R(this,Om,!1);R(this,Um,!!((ID=globalThis.FontInspector)!=null&&ID.enabled));R(this,bu,null);R(this,na,null);R(this,Fm,0);R(this,Bm,0);R(this,_u,null);R(this,hf,null);R(this,ff,0);R(this,Ll,0);R(this,pf,Object.create(null));R(this,Hm,[]);R(this,gf,null);R(this,Su,[]);R(this,Gm,new WeakMap);R(this,zm,null);var h;if(e instanceof ReadableStream)E(this,gf,e);else if(typeof e=="object")E(this,gf,new ReadableStream({start(f){f.enqueue(e),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');E(this,Bi,E(this,hf,t)),E(this,Ll,n.scale*Tr.pixelRatio),E(this,ff,n.rotation),E(this,na,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:o,pageX:l,pageY:c}=n.rawDims;E(this,zm,[1,0,0,-1,-l,c+o]),E(this,Bm,s),E(this,Fm,o),M(h=rn,Ss,BP).call(h),uc(t,n),d(this,Pl).promise.finally(()=>{d(rn,yf).delete(this),E(this,na,null),E(this,pf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=On.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{d(this,_u).read().then(({value:t,done:n})=>{if(n){d(this,Pl).resolve();return}d(this,bu)??E(this,bu,t.lang),Object.assign(d(this,pf),t.styles),M(this,ka,UP).call(this,t.items),e()},d(this,Pl).reject)};return E(this,_u,d(this,gf).getReader()),d(rn,yf).add(this),e(),d(this,Pl).promise}update({viewport:e,onBefore:t=null}){var o;const n=e.scale*Tr.pixelRatio,s=e.rotation;if(s!==d(this,ff)&&(t==null||t(),E(this,ff,s),uc(d(this,hf),{rotation:s})),n!==d(this,Ll)){t==null||t(),E(this,Ll,n);const l={div:null,properties:null,ctx:M(o=rn,Ss,Ov).call(o,d(this,bu))};for(const c of d(this,Su))l.properties=d(this,Gm).get(c),l.div=c,M(this,ka,hT).call(this,l)}}cancel(){var t;const e=new xa("TextLayer task cancelled.");(t=d(this,_u))==null||t.cancel(e).catch(()=>{}),E(this,_u,null),d(this,Pl).reject(e)}get textDivs(){return d(this,Su)}get textContentItemsStr(){return d(this,Hm)}static cleanup(){if(!(d(this,yf).size>0)){d(this,mf).clear();for(const{canvas:e}of d(this,Au).values())e.remove();d(this,Au).clear()}}},Pl=new WeakMap,Bi=new WeakMap,Om=new WeakMap,Um=new WeakMap,bu=new WeakMap,na=new WeakMap,Fm=new WeakMap,Bm=new WeakMap,_u=new WeakMap,hf=new WeakMap,ff=new WeakMap,Ll=new WeakMap,pf=new WeakMap,Hm=new WeakMap,gf=new WeakMap,Su=new WeakMap,Gm=new WeakMap,zm=new WeakMap,mf=new WeakMap,Au=new WeakMap,Vm=new WeakMap,Ol=new WeakMap,yf=new WeakMap,ka=new WeakSet,UP=function(e){var s,o;if(d(this,Om))return;(o=d(this,na)).ctx??(o.ctx=M(s=rn,Ss,Ov).call(s,d(this,bu)));const t=d(this,Su),n=d(this,Hm);for(const l of e){if(t.length>Jq){Ue("Ignoring additional textDivs for performance reasons."),E(this,Om,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=d(this,Bi);E(this,Bi,document.createElement("span")),d(this,Bi).classList.add("markedContent"),l.id&&d(this,Bi).setAttribute("id",`${l.id}`),c.append(d(this,Bi))}else l.type==="endMarkedContent"&&E(this,Bi,d(this,Bi).parentNode);continue}n.push(l.str),M(this,ka,FP).call(this,l)}},FP=function(e){var C;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};d(this,Su).push(t);const s=be.transform(d(this,zm),e.transform);let o=Math.atan2(s[1],s[0]);const l=d(this,pf)[e.fontName];l.vertical&&(o+=Math.PI/2);let c=d(this,Um)&&l.fontSubstitution||l.fontFamily;c=rn.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*M(C=rn,Ss,HP).call(C,c,l,d(this,bu));let g,y;o===0?(g=s[4],y=s[5]-f):(g=s[4]+f*Math.sin(o),y=s[5]-f*Math.cos(o));const b="calc(var(--total-scale-factor) *",A=t.style;d(this,Bi)===d(this,hf)?(A.left=`${(100*g/d(this,Bm)).toFixed(2)}%`,A.top=`${(100*y/d(this,Fm)).toFixed(2)}%`):(A.left=`${b}${g.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(d(rn,Ol)*h).toFixed(2)}px)`,A.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,d(this,Um)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),I=Math.abs(e.transform[3]);N!==I&&Math.max(N,I)/Math.min(N,I)>1.5&&(w=!0)}if(w&&(n.canvasWidth=l.vertical?e.height:e.width),d(this,Gm).set(t,n),d(this,na).div=t,d(this,na).properties=n,M(this,ka,hT).call(this,d(this,na)),n.hasText&&d(this,Bi).append(t),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),d(this,Bi).append(N)}},hT=function(e){var c;const{div:t,properties:n,ctx:s}=e,{style:o}=t;let l="";if(d(rn,Ol)>1&&(l=`scale(${1/d(rn,Ol)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=o,{canvasWidth:f,fontSize:g}=n;M(c=rn,Ss,fT).call(c,s,g*d(this,Ll),h);const{width:y}=s.measureText(t.textContent);y>0&&(l=`scaleX(${f*d(this,Ll)/y}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(o.transform=l)},Ss=new WeakSet,Ov=function(e=null){let t=d(this,Au).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),d(this,Au).set(e,t),d(this,Vm).set(t,{size:0,family:""})}return t},fT=function(e,t,n){const s=d(this,Vm).get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)},BP=function(){if(d(this,Ol)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),E(this,Ol,e.getBoundingClientRect().height),e.remove()},HP=function(e,t,n){const s=d(this,mf).get(e);if(s)return s;const o=M(this,Ss,Ov).call(this,n);o.canvas.width=o.canvas.height=IM,M(this,Ss,fT).call(this,o,IM,e);const l=o.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(On.platform.isFirefox&&Ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),d(this,mf).set(e,f),f},R(rn,Ss),R(rn,mf,new Map),R(rn,Au,new Map),R(rn,Vm,new WeakMap),R(rn,Ol,null),R(rn,yf,new Set),rn);const jq=100;function Uw(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new pT,{docId:t}=e,n=i.url?rq(i.url):null,s=i.data?oq(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,h=i.range instanceof Fw?i.range:null,f=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let g=i.worker instanceof tp?i.worker:null;const y=i.verbosity,b=typeof i.docBaseUrl=="string"&&!Dy(i.docBaseUrl)?i.docBaseUrl:null,A=gv(i.cMapUrl),w=i.cMapPacked!==!1,C=i.CMapReaderFactory||(bi?fq:gM),N=gv(i.iccUrl),I=gv(i.standardFontDataUrl),P=i.StandardFontDataFactory||(bi?pq:mM),k=gv(i.wasmUrl),L=i.WasmFactory||(bi?gq:yM),O=i.stopAtErrors!==!0,U=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,F=i.isEvalSupported!==!1,K=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!bi,q=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!bi&&(On.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,ee=typeof i.disableFontFace=="boolean"?i.disableFontFace:bi,se=i.fontExtraProperties===!0,le=i.enableXfa===!0,ue=i.ownerDocument||globalThis.document,me=i.disableRange===!0,G=i.disableStream===!0,$=i.disableAutoFetch===!0,oe=i.pdfBug===!0,pe=i.CanvasFactory||(bi?hq:cq),Me=i.FilterFactory||(bi?dq:uq),H=i.enableHWA===!0,J=i.useWasm!==!1,re=h?h.length:i.length??NaN,de=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!bi&&!ee,_e=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(C===gM&&P===mM&&L===yM&&A&&I&&k&&dg(A,document.baseURI)&&dg(I,document.baseURI)&&dg(k,document.baseURI)),Ce=null;HV(y);const Ee={canvasFactory:new pe({ownerDocument:ue,enableHWA:H}),filterFactory:new Me({docId:t,ownerDocument:ue}),cMapReaderFactory:_e?null:new C({baseUrl:A,isCompressed:w}),standardFontDataFactory:_e?null:new P({baseUrl:I}),wasmFactory:_e?null:new L({baseUrl:k})};g||(g=tp.create({verbosity:y,port:Ks.workerPort}),e._worker=g);const st={docId:t,apiVersion:"5.4.296",data:s,password:c,disableAutoFetch:$,rangeChunkSize:f,length:re,docBaseUrl:b,enableXfa:le,evaluatorOptions:{maxImageSize:U,disableFontFace:ee,ignoreErrors:O,isEvalSupported:F,isOffscreenCanvasSupported:K,isImageDecoderSupported:q,canvasMaxAreaInBytes:Q,fontExtraProperties:se,useSystemFonts:de,useWasm:J,useWorkerFetch:_e,cMapUrl:A,iccUrl:N,standardFontDataUrl:I,wasmUrl:k}},Je={ownerDocument:ue,pdfBug:oe,styleElement:Ce,loadingParams:{disableAutoFetch:$,enableXfa:le}};return g.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const It=g.messageHandler.sendWithPromise("GetDocRequest",st,s?[s.buffer]:null);let Xe;if(h)Xe=new kq(h,{disableRange:me,disableStream:G});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Cn=dg(n)?Uq:bi?Xq:zq;Xe=new Cn({url:n,length:re,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:me,disableStream:G})}return It.then(Cn=>{if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const rt=new yg(t,Cn,g.port),We=new e8(rt,e,Xe,Je,Ee,H);e._transport=We,rt.send("Ready",null)})}).catch(e._capability.reject),e}var $b;const Yb=class Yb{constructor(){ce(this,"_capability",Promise.withResolvers());ce(this,"_transport",null);ce(this,"_worker",null);ce(this,"docId",`d${Sn(Yb,$b)._++}`);ce(this,"destroyed",!1);ce(this,"onPassword",null);ce(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(o){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,o}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};$b=new WeakMap,R(Yb,$b,0);let pT=Yb;var Eu,qm,$m,Ym,Xm,ND;let Fw=(ND=class{constructor(e,t,n=!1,s=null){R(this,Eu,Promise.withResolvers());R(this,qm,[]);R(this,$m,[]);R(this,Ym,[]);R(this,Xm,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){d(this,Xm).push(e)}addProgressListener(e){d(this,Ym).push(e)}addProgressiveReadListener(e){d(this,$m).push(e)}addProgressiveDoneListener(e){d(this,qm).push(e)}onDataRange(e,t){for(const n of d(this,Xm))n(e,t)}onDataProgress(e,t){d(this,Eu).promise.then(()=>{for(const n of d(this,Ym))n(e,t)})}onDataProgressiveRead(e){d(this,Eu).promise.then(()=>{for(const t of d(this,$m))t(e)})}onDataProgressiveDone(){d(this,Eu).promise.then(()=>{for(const e of d(this,qm))e()})}transportReady(){d(this,Eu).resolve()}requestDataRange(e,t){Ut("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Eu=new WeakMap,qm=new WeakMap,$m=new WeakMap,Ym=new WeakMap,Xm=new WeakMap,ND);class Qq{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ia,Tu,Tg;class Zq{constructor(e,t,n,s=!1){R(this,Tu);R(this,ia,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new lM:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new OP,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new My({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=ro.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){var q,Q,ee;(q=this._stats)==null||q.time("Overall");const C=this._transport.getRenderingIntent(s,o,y,b),{renderingIntent:N,cacheKey:I}=C;E(this,ia,!1),h||(h=this._transport.getOptionalContentConfig(N));let P=this._intentStates.get(I);P||(P=Object.create(null),this._intentStates.set(I,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);const k=!!(N&ms.PRINT);P.displayReadyCapability||(P.displayReadyCapability=Promise.withResolvers(),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Q=this._stats)==null||Q.time("Page Request"),this._pumpOperatorList(C));const L=!!(this._pdfBug&&((ee=globalThis.StepperManager)!=null&&ee.enabled)),O=!this.recordedBBoxes&&(A||L),U=se=>{var le,ue;if(P.renderTasks.delete(F),O){const me=(le=F.gfx)==null?void 0:le.dependencyTracker.take();me&&(F.stepper&&F.stepper.setOperatorBBoxes(me,F.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=me))}k&&E(this,ia,!0),M(this,Tu,Tg).call(this),se?(F.capability.reject(se),this._abortOperatorList({intentState:P,reason:se instanceof Error?se:new Error(se)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ue=globalThis.Stats)!=null&&ue.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},F=new gT({callback:U,params:{canvas:t,canvasContext:e,dependencyTracker:O?new yq(t,P.operatorList.length,L):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:w});(P.renderTasks||(P.renderTasks=new Set)).add(F);const K=F.task;return Promise.all([P.displayReadyCapability.promise,h]).then(([se,le])=>{var ue;if(this.destroyed){U();return}if((ue=this._stats)==null||ue.time("Rendering"),!(le.renderingIntent&N))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:se,optionalContentConfig:le}),F.operatorListChanged()}).catch(U),K}getOperatorList({intent:e="display",annotationMode:t=ro.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){var f;function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Gg.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){l.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??(c.lang=h.lang),Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),E(this,ia,!1),Promise.all(e)}cleanup(e=!1){E(this,ia,!0);const t=M(this,Tu,Tg).call(this);return e&&t&&this._stats&&(this._stats=new lM),t}_startRenderPage(e,t){var s,o;const n=this._intentStates.get(t);n&&((s=this._stats)==null||s.timeEnd("Page Request"),(o=n.displayReadyCapability)==null||o.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&M(this,Tu,Tg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},l).getReader(),f=this._intentStates.get(t);f.streamReader=h;const g=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),g())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();M(this,Tu,Tg).call(this)}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};g()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof u_){let s=jq;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new xa(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}ia=new WeakMap,Tu=new WeakSet,Tg=function(){if(!d(this,ia)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),E(this,ia,!1),!0};var Ul,hr,sa,wu,Xb,Cu,xu,_i,Uv,GP,zP,wg,vf,Fv;const $t=class $t{constructor({name:e=null,port:t=null,verbosity:n=GV()}={}){R(this,_i);R(this,Ul,Promise.withResolvers());R(this,hr,null);R(this,sa,null);R(this,wu,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(d($t,xu).has(t))throw new Error("Cannot use more than one PDFWorker per port.");d($t,xu).set(t,this),M(this,_i,GP).call(this,t)}else M(this,_i,zP).call(this)}get promise(){return d(this,Ul).promise}get port(){return d(this,sa)}get messageHandler(){return d(this,hr)}destroy(){var e,t;this.destroyed=!0,(e=d(this,wu))==null||e.terminate(),E(this,wu,null),d($t,xu).delete(d(this,sa)),E(this,sa,null),(t=d(this,hr))==null||t.destroy(),E(this,hr,null)}static create(e){const t=d(this,xu).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new $t(e)}static get workerSrc(){if(Ks.workerSrc)return Ks.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>d(this,vf,Fv)?d(this,vf,Fv):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ul=new WeakMap,hr=new WeakMap,sa=new WeakMap,wu=new WeakMap,Xb=new WeakMap,Cu=new WeakMap,xu=new WeakMap,_i=new WeakSet,Uv=function(){d(this,Ul).resolve(),d(this,hr).send("configure",{verbosity:this.verbosity})},GP=function(e){E(this,sa,e),E(this,hr,new yg("main","worker",e)),d(this,hr).on("ready",()=>{}),M(this,_i,Uv).call(this)},zP=function(){if(d($t,Cu)||d($t,vf,Fv)){M(this,_i,wg).call(this);return}let{workerSrc:e}=$t;try{$t._isSameOrigin(window.location,e)||(e=$t._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new yg("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?d(this,Ul).reject(new Error("Worker was destroyed")):M(this,_i,wg).call(this)},o=new AbortController;t.addEventListener("error",()=>{d(this,wu)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}E(this,hr,n),E(this,sa,t),E(this,wu,t),M(this,_i,Uv).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{M(this,_i,wg).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{c_("The worker has been disabled.")}M(this,_i,wg).call(this)},wg=function(){d($t,Cu)||(Ue("Setting up fake worker."),E($t,Cu,!0)),$t._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){d(this,Ul).reject(new Error("Worker was destroyed"));return}const t=new lq;E(this,sa,t);const n=`fake${Sn($t,Xb)._++}`,s=new yg(n+"_worker",n,t);e.setup(s,t),E(this,hr,new yg(n,n+"_worker",t)),M(this,_i,Uv).call(this)}).catch(e=>{d(this,Ul).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},vf=new WeakSet,Fv=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},R($t,vf),R($t,Xb,0),R($t,Cu,!1),R($t,xu,new WeakMap),bi&&(E($t,Cu,!0),Ks.workerSrc||(Ks.workerSrc="./pdf.worker.mjs")),$t._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},$t._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},$t.fromPort=e=>{if(JV("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return $t.create(e)};let tp=$t;var ra,Kr,bf,_f,oa,Ru,Cg;class e8{constructor(e,t,n,s,o,l){R(this,Ru);R(this,ra,new Map);R(this,Kr,new Map);R(this,bf,new Map);R(this,_f,new Map);R(this,oa,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new OP,this.fontLoader=new iq({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new Pw)}getRenderingIntent(e,t=ro.ENABLE,n=null,s=!1,o=!1){let l=ms.DISPLAY,c=QE;switch(e){case"any":l=ms.ANY;break;case"display":break;case"print":l=ms.PRINT;break;default:Ue(`getRenderingIntent - invalid intent: ${e}`)}const h=l&ms.PRINT&&n instanceof bP?n:this.annotationStorage;switch(t){case ro.DISABLE:l+=ms.ANNOTATIONS_DISABLE;break;case ro.ENABLE:break;case ro.ENABLE_FORMS:l+=ms.ANNOTATIONS_FORMS;break;case ro.ENABLE_STORAGE:l+=ms.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Ue(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=ms.IS_EDITING),o&&(l+=ms.OPLIST);const{ids:f,hash:g}=h.modifiedIds,y=[l,c.hash,g];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=d(this,oa))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of d(this,Kr).values())e.push(s._destroy());d(this,Kr).clear(),d(this,bf).clear(),d(this,_f).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,o;this.commonObjs.clear(),this.fontLoader.clear(),d(this,ra).clear(),this.filterFactory.destroy(),qg.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new xa("Worker was terminated.")),(o=this.messageHandler)==null||o.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{it(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}it(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:l}=this._fullReader;return(!s||!o)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var f;(f=t.onProgress)==null||f.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{it(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){s.close();return}it(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Qq(n,this))}),e.on("DocException",n=>{t._capability.reject(ki(n))}),e.on("PasswordRequest",n=>{E(this,oa,Promise.withResolvers());try{if(!t.onPassword)throw ki(n);const s=o=>{o instanceof Error?d(this,oa).reject(o):d(this,oa).resolve({password:o})};t.onPassword(s,n.code)}catch(s){d(this,oa).reject(s)}return d(this,oa).promise}),e.on("DataLoaded",n=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;d(this,Kr).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const y=o.error;Ue(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=new cT(o),h=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,f=new sq(c,h,o.extra,o.charProcOperatorList);this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&f.clearData(),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:g}=o;it(g,"The imageRef must be defined.");for(const y of d(this,Kr).values())for(const[,b]of y.objs)if((b==null?void 0:b.ref)===g)return b.dataLen?(this.commonObjs.resolve(n,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,l])=>{var h;if(this.destroyed)return;const c=d(this,Kr).get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=d(this,bf).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&d(this,_f).set(o.refStr,e);const l=new Zq(t,o,this,this._params.pdfBug);return d(this,Kr).set(t,l),l});return d(this,bf).set(t,s),s}getPageIndex(e){return ZE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return M(this,Ru,Cg).call(this,"GetFieldObjects")}hasJSActions(){return M(this,Ru,Cg).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return M(this,Ru,Cg).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return M(this,Ru,Cg).call(this,"GetOptionalContentConfig").then(t=>new Dq(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=d(this,ra).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>{var o,l;return{info:s[0],metadata:s[1]?new Nq(s[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return d(this,ra).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of d(this,Kr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),d(this,ra).clear(),this.filterFactory.destroy(!0),qg.cleanup()}}cachedPageNumber(e){if(!ZE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return d(this,_f).get(t)??null}}ra=new WeakMap,Kr=new WeakMap,bf=new WeakMap,_f=new WeakMap,oa=new WeakMap,Ru=new WeakSet,Cg=function(e,t=null){const n=d(this,ra).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return d(this,ra).set(e,s),s};var Fl;class t8{constructor(e){R(this,Fl,null);ce(this,"onContinue",null);ce(this,"onError",null);E(this,Fl,e)}get promise(){return d(this,Fl).capability.promise}cancel(e=0){d(this,Fl).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=d(this,Fl).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=d(this,Fl);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Fl=new WeakMap;var Bl,Iu;const zc=class zc{constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){R(this,Bl,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new t8(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=A,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var h,f;if(this.cancelled)return;if(this._canvas){if(d(zc,Iu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");d(zc,Iu).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new _h(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(e=null,t=0){var n,s,o;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),d(this,Bl)&&(window.cancelAnimationFrame(d(this,Bl)),E(this,Bl,null)),d(zc,Iu).delete(this._canvas),e||(e=new u_(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(o=(s=this.task).onError)==null||o.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?E(this,Bl,window.requestAnimationFrame(()=>{E(this,Bl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),d(zc,Iu).delete(this._canvas),this.callback())))}};Bl=new WeakMap,Iu=new WeakMap,R(zc,Iu,new WeakSet);let gT=zc;const Bw="5.4.296",VP="f56dc8601";var ss,Nu,Sf,Tn,Wm,Af,aa,Km,Hl,fr,Jm,Rt,mT,yT,vT,Uc,qP,ll;const Pi=class Pi{constructor({editor:e=null,uiManager:t=null}){R(this,Rt);R(this,ss,null);R(this,Nu,null);R(this,Sf);R(this,Tn,null);R(this,Wm,!1);R(this,Af,!1);R(this,aa,null);R(this,Km);R(this,Hl,null);R(this,fr,null);var n,s;e?(E(this,Af,!1),E(this,aa,e)):E(this,Af,!0),E(this,fr,(e==null?void 0:e._uiManager)||t),E(this,Km,d(this,fr)._eventBus),E(this,Sf,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((s=d(this,fr))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),d(Pi,Jm)||E(Pi,Jm,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ve(this,"_keyboardManager",new ky([[["Escape","mac+Escape"],Pi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Pi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Pi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Pi.prototype._moveToPrevious],[["Home","mac+Home"],Pi.prototype._moveToBeginning],[["End","mac+End"],Pi.prototype._moveToEnd]]))}renderButton(){const e=E(this,ss,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",d(this,aa)&&(e.ariaControls=`${d(this,aa).id}_colorpicker_dropdown`);const t=d(this,fr)._signal;e.addEventListener("click",M(this,Rt,Uc).bind(this),{signal:t}),e.addEventListener("keydown",M(this,Rt,vT).bind(this),{signal:t});const n=E(this,Nu,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=d(this,Sf),e.append(n),e}renderMainDropdown(){const e=E(this,Tn,M(this,Rt,mT).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===d(this,ss)){M(this,Rt,Uc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&M(this,Rt,yT).call(this,t,e)}_moveToNext(e){var t,n;if(!d(this,Rt,ll)){M(this,Rt,Uc).call(this,e);return}if(e.target===d(this,ss)){(t=d(this,Tn).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=d(this,Tn))==null?void 0:t.firstChild)||e.target===d(this,ss)){d(this,Rt,ll)&&this._hideDropdownFromKeyboard();return}d(this,Rt,ll)||M(this,Rt,Uc).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!d(this,Rt,ll)){M(this,Rt,Uc).call(this,e);return}(t=d(this,Tn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!d(this,Rt,ll)){M(this,Rt,Uc).call(this,e);return}(t=d(this,Tn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=d(this,Tn))==null||e.classList.add("hidden"),d(this,ss).ariaExpanded="false",(t=d(this,Hl))==null||t.abort(),E(this,Hl,null)}_hideDropdownFromKeyboard(){var e;if(!d(this,Af)){if(!d(this,Rt,ll)){(e=d(this,aa))==null||e.unselect();return}this.hideDropdown(),d(this,ss).focus({preventScroll:!0,focusVisible:d(this,Wm)})}}updateColor(e){if(d(this,Nu)&&(d(this,Nu).style.backgroundColor=e),!d(this,Tn))return;const t=d(this,fr).highlightColors.values();for(const n of d(this,Tn).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=d(this,ss))==null||e.remove(),E(this,ss,null),E(this,Nu,null),(t=d(this,Tn))==null||t.remove(),E(this,Tn,null)}};ss=new WeakMap,Nu=new WeakMap,Sf=new WeakMap,Tn=new WeakMap,Wm=new WeakMap,Af=new WeakMap,aa=new WeakMap,Km=new WeakMap,Hl=new WeakMap,fr=new WeakMap,Jm=new WeakMap,Rt=new WeakSet,mT=function(){const e=document.createElement("div"),t=d(this,fr)._signal;e.addEventListener("contextmenu",As,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),d(this,aa)&&(e.id=`${d(this,aa).id}_colorpicker_dropdown`);for(const[n,s]of d(this,fr).highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",d(Pi,Jm)[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.ariaSelected=s===d(this,Sf),o.addEventListener("click",M(this,Rt,yT).bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",M(this,Rt,vT).bind(this),{signal:t}),e},yT=function(e,t){t.stopPropagation(),d(this,Km).dispatch("switchannotationeditorparams",{source:this,type:tt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},vT=function(e){Pi._keyboardManager.exec(this,e)},Uc=function(e){if(d(this,Rt,ll)){this.hideDropdown();return}if(E(this,Wm,e.detail===0),d(this,Hl)||(E(this,Hl,new AbortController),window.addEventListener("pointerdown",M(this,Rt,qP).bind(this),{signal:d(this,fr).combinedSignal(d(this,Hl))})),d(this,ss).ariaExpanded="true",d(this,Tn)){d(this,Tn).classList.remove("hidden");return}const t=E(this,Tn,M(this,Rt,mT).call(this));d(this,ss).append(t)},qP=function(e){var t;(t=d(this,Tn))!=null&&t.contains(e.target)||this.hideDropdown()},ll=function(){return d(this,Tn)&&!d(this,Tn).classList.contains("hidden")},R(Pi,Jm,null);let $g=Pi;var Jr,jm,Ef,Qm;const Vc=class Vc{constructor(e){R(this,Jr,null);R(this,jm,null);R(this,Ef,null);E(this,jm,e),E(this,Ef,e._uiManager),d(Vc,Qm)||E(Vc,Qm,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(d(this,Jr))return d(this,Jr);const{editorType:e,colorType:t,colorValue:n}=d(this,jm),s=E(this,Jr,document.createElement("input"));return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",d(Vc,Qm)[e]),s.addEventListener("input",()=>{d(this,Ef).updateParams(t,s.value)},{signal:d(this,Ef)._signal}),s}update(e){d(this,Jr)&&(d(this,Jr).value=e)}destroy(){var e;(e=d(this,Jr))==null||e.remove(),E(this,Jr,null)}hideDropdown(){}};Jr=new WeakMap,jm=new WeakMap,Ef=new WeakMap,Qm=new WeakMap,R(Vc,Qm,null);let Sb=Vc;function NM(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function lg(i){return Math.max(0,Math.min(255,255*i))}class MM{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=lg(e),[e,e,e]}static G_HTML([e]){const t=NM(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(lg)}static RGB_HTML(e){return`#${e.map(NM).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[lg(1-Math.min(1,e+s)),lg(1-Math.min(1,n+s)),lg(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,l=1-n,c=Math.min(s,o,l);return["CMYK",s,o,l,c]}}class n8{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ut("Abstract method `_createSVG` called.")}}class Yg extends n8{_createSVG(e){return document.createElementNS(Po,e)}}const i8=9,id=new WeakSet,s8=new Date().getTimezoneOffset()*60*1e3;class DM{static create(e){switch(e.data.annotationType){case cn.LINK:return new Hw(e);case cn.TEXT:return new o8(e);case cn.WIDGET:switch(e.data.fieldType){case"Tx":return new a8(e);case"Btn":return e.data.radioButton?new XP(e):e.data.checkBox?new c8(e):new u8(e);case"Ch":return new d8(e);case"Sig":return new l8(e)}return new hd(e);case cn.POPUP:return new _T(e);case cn.FREETEXT:return new QP(e);case cn.LINE:return new f8(e);case cn.SQUARE:return new p8(e);case cn.CIRCLE:return new g8(e);case cn.POLYLINE:return new ZP(e);case cn.CARET:return new y8(e);case cn.INK:return new Gw(e);case cn.POLYGON:return new m8(e);case cn.HIGHLIGHT:return new e2(e);case cn.UNDERLINE:return new v8(e);case cn.SQUIGGLY:return new b8(e);case cn.STRIKEOUT:return new _8(e);case cn.STAMP:return new t2(e);case cn.FILEATTACHMENT:return new S8(e);default:return new jt(e)}}}var Mu,Tf,Ys,Zm,bT;const hC=class hC{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){R(this,Zm);R(this,Mu,null);R(this,Tf,!1);R(this,Ys,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return hC._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:e}=this,t=(n=this.annotationStorage)==null?void 0:n.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var c;const e=(c=this.annotationStorage)==null?void 0:c.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,l=-1/0;if((t==null?void 0:t.length)>=8){for(let h=0;h<t.length;h+=8)t[h+1]>l?(l=t[h+1],o=t[h+2]):t[h+1]===l&&(o=Math.max(o,t[h+2]));return[o,l]}if((n==null?void 0:n.length)>=1){for(const h of n)for(let f=0,g=h.length;f<g;f+=2)h[f+1]>l?(l=h[f+1],o=h[f]):h[f+1]===l&&(o=Math.max(o,h[f]));if(o!==1/0)return[o,l]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-l)/s,e}get commentText(){var t,n,s;const{data:e}=this;return((n=(t=this.annotationStorage.getRawValue(`${Bg}${e.id}`))==null?void 0:t.popup)==null?void 0:n.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Bg}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=d(this,Ys))==null?void 0:e.popup)||this.popup)==null||t.remove(),E(this,Ys,this.popup=null)}updateEdited(e){var o;if(!this.container)return;e.rect&&(d(this,Mu)||E(this,Mu,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&M(this,Zm,bT).call(this,t);let s=((o=d(this,Ys))==null?void 0:o.popup)||this.popup;!s&&(n!=null&&n.text)&&(this._createPopup(n),s=d(this,Ys).popup),s&&(s.updateEdited(e),n!=null&&n.deleted&&(s.remove(),E(this,Ys,null),this.popup=null))}resetEdited(){var e;d(this,Mu)&&(M(this,Zm,bT).call(this,d(this,Mu).rect),(e=d(this,Ys))==null||e.popup.resetEdited(),E(this,Mu,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof hd)&&!(this instanceof Hw)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof _T){const{rotation:C}=t;return!t.hasOwnCanvas&&C!==0&&this.setRotation(C,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const C=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(C>0||N>0){const P=`calc(${C}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;l.borderRadius=P}else if(this instanceof XP){const P=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=P}switch(t.borderStyle.style){case th.SOLID:l.borderStyle="solid";break;case th.DASHED:l.borderStyle="dashed";break;case th.BEVELED:Ue("Unimplemented border style: beveled");break;case th.INSET:Ue("Unimplemented border style: inset");break;case th.UNDERLINE:l.borderBottomStyle="solid";break}const I=t.borderColor||null;I?(E(this,Tf,!0),l.borderColor=be.makeHexColor(I[0]|0,I[1]|0,I[2]|0)):l.borderWidth=0}const f=be.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:y,pageX:b,pageY:A}=s.rawDims;l.left=`${100*(f[0]-b)/g}%`,l.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(l.width=`${100*c/g}%`,l.height=`${100*h/y}%`):this.setRotation(w,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:l}=this;e%180!==0&&([o,l]=[l,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*l/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],l=o[0],c=o.slice(1);s.target.style[n]=MM[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:MM[`${l}_rgb`](c)})};return Ve(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const o=e[s]||n[s];o==null||o(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:o},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(C=>Math.fround(C));if(e.length===8){const[C,N,I,P]=e.subarray(2,6);if(s===C&&o===N&&t===I&&n===P)return}const{style:l}=this.container;let c;if(d(this,Tf)){const{borderColor:C,borderWidth:N}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${C}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:g}=this,y=g.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=g.createElement("defs");y.append(b);const A=g.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let C=2,N=e.length;C<N;C+=8){const I=e[C],P=e[C+1],k=e[C+2],L=e[C+3],O=g.createElement("rect"),U=(k-t)/h,F=(o-P)/f,K=(I-k)/h,q=(P-L)/f;O.setAttribute("x",U),O.setAttribute("y",F),O.setAttribute("width",K),O.setAttribute("height",q),A.append(O),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${U}" y="${F}" width="${K}" height="${q}"/>`)}d(this,Tf)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate);const o=E(this,Ys,new _T({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(d(this,Ys)||this.popup||this.data.popupRef)}get extraPopupElement(){return d(this,Ys)}render(){Ut("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:l,exportValues:c}of s){if(o===-1||l===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!id.has(f)){Ue(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==t&&id.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Mu=new WeakMap,Tf=new WeakMap,Ys=new WeakMap,Zm=new WeakSet,bT=function(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(l-e[3]+h)/l}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(s)};let jt=hC;class r8 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var vs,Fc,$P,YP;class Hw extends jt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});R(this,vs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let o=!1;return t.url?(n.addLinkAttributes(s,t.url,t.newWindow),o=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),o=!0):t.attachment?(M(this,vs,$P).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),o=!0):t.setOCGState?(M(this,vs,YP).call(this,s,t.setOCGState,t.overlaidText),o=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),o=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),o=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),o=!0):this.isTooltipOnly&&!o&&(this._bindLink(s,""),o=!0)),this.container.classList.add("linkAnnotation"),o&&this.container.append(s),this.container}_bindLink(t,n,s=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,vs,Fc).call(this),s&&(t.title=s)}_bindNamedAction(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),s&&(t.title=s),M(this,vs,Fc).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(n.actions)){const l=s.get(o);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:o}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),M(this,vs,Fc).call(this)}_bindResetFormAction(t,n){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),M(this,vs,Fc).call(this),!this._fieldObjects){Ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var y;s==null||s();const{fields:o,refs:l,include:c}=n,h=[];if(o.length!==0||l.length!==0){const b=new Set(l);for(const A of o){const w=this._fieldObjects[A]||[];for(const{id:C}of w)b.add(C)}for(const A of Object.values(this._fieldObjects))for(const w of A)b.has(w.id)===c&&h.push(w)}else for(const b of Object.values(this._fieldObjects))h.push(...b);const f=this.annotationStorage,g=[];for(const b of h){const{id:A}=b;switch(g.push(A),b.type){case"text":{const C=b.defaultValue||"";f.setValue(A,{value:C});break}case"checkbox":case"radiobutton":{const C=b.defaultValue===b.exportValues;f.setValue(A,{value:C});break}case"combobox":case"listbox":{const C=b.defaultValue||"";f.setValue(A,{value:C});break}default:continue}const w=document.querySelector(`[data-element-id="${A}"]`);if(w){if(!id.has(w)){Ue(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:g,name:"ResetForm"}})),!1}}}vs=new WeakSet,Fc=function(){this.container.setAttribute("data-internal-link","")},$P=function(t,n,s="",o=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:s&&(t.title=s),t.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(n.content,n.filename,o),!1},M(this,vs,Fc).call(this)},YP=function(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),s&&(t.title=s),M(this,vs,Fc).call(this)};class o8 extends jt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class hd extends jt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return On.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}}))})}_setEventListeners(e,t,n,s){var o,l,c;for(const[h,f]of n)(f==="Action"||(o=this.data.actions)!=null&&o[f])&&((f==="Focus"||f==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,h,f,s),f==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):f==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":be.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||i8,o=e.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(XA*s))||1,y=f/g;l=Math.min(s,h(y/XA))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,h(f/XA))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=be.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class a8 extends hd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),o.setValue(l.id,{[s]:n})}render(){var s,o;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&c.length>h&&(c=c.slice(0,h));let f=l.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const g={userValue:c,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=f??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",f??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),id.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:y,datetimeType:b,timeStep:A}=this.data,w=!!b&&this.enableScripting;y&&(n.title=y),this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",N=>{e.setValue(t,{value:N.target.value}),this.setPropertyOnSiblings(n,"value",N.target.value,"value"),g.formattedValue=null}),n.addEventListener("resetform",N=>{const I=this.data.defaultFieldValue??"";n.value=g.userValue=I,g.formattedValue=null});let C=N=>{const{formattedValue:I}=g;I!=null&&(N.target.value=I),N.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",I=>{var k;if(g.focused)return;const{target:P}=I;if(w&&(P.type=b,A&&(P.step=A)),g.userValue){const L=g.userValue;if(w)if(b==="time"){const O=new Date(L),U=[O.getHours(),O.getMinutes(),O.getSeconds()];P.value=U.map(F=>F.toString().padStart(2,"0")).join(":")}else P.value=new Date(L-s8).toISOString().split(b==="date"?"T":".",1)[0];else P.value=L}g.lastCommittedValue=P.value,g.commitKey=1,(k=this.data.actions)!=null&&k.Focus||(g.focused=!0)}),n.addEventListener("updatefromsandbox",I=>{this.showElementAndHideCanvas(I.target);const P={value(k){g.userValue=k.detail.value??"",w||e.setValue(t,{value:g.userValue.toString()}),k.target.value=g.userValue},formattedValue(k){const{formattedValue:L}=k.detail;g.formattedValue=L,L!=null&&k.target!==document.activeElement&&(k.target.value=L);const O={formattedValue:L};w&&(O.value=L),e.setValue(t,O)},selRange(k){k.target.setSelectionRange(...k.detail.selRange)},charLimit:k=>{var F;const{charLimit:L}=k.detail,{target:O}=k;if(L===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",L);let U=g.userValue;!U||U.length<=L||(U=U.slice(0,L),O.value=g.userValue=U,e.setValue(t,{value:U}),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:U,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(P,I)}),n.addEventListener("keydown",I=>{var L;g.commitKey=1;let P=-1;if(I.key==="Escape"?P=0:I.key==="Enter"&&!this.data.multiLine?P=2:I.key==="Tab"&&(g.commitKey=3),P===-1)return;const{value:k}=I.target;g.lastCommittedValue!==k&&(g.lastCommittedValue=k,g.userValue=k,(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:P,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}}))});const N=C;C=null,n.addEventListener("blur",I=>{var L,O;if(!g.focused||!I.relatedTarget)return;(L=this.data.actions)!=null&&L.Blur||(g.focused=!1);const{target:P}=I;let{value:k}=P;if(w){if(k&&b==="time"){const U=k.split(":").map(F=>parseInt(F,10));k=new Date(2e3,0,1,U[0],U[1],U[2]||0).valueOf(),P.step=""}else k.includes("T")||(k=`${k}T00:00`),k=new Date(k).valueOf();P.type="text"}g.userValue=k,g.lastCommittedValue!==k&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:g.commitKey,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}})),N(I)}),(o=this.data.actions)!=null&&o.Keystroke&&n.addEventListener("beforeinput",I=>{var q;g.lastCommittedValue=null;const{data:P,target:k}=I,{value:L,selectionStart:O,selectionEnd:U}=k;let F=O,K=U;switch(I.inputType){case"deleteWordBackward":{const Q=L.substring(0,O).match(/\w*[^\w]*$/);Q&&(F-=Q[0].length);break}case"deleteWordForward":{const Q=L.substring(O).match(/^[^\w]*\w*/);Q&&(K+=Q[0].length);break}case"deleteContentBackward":O===U&&(F-=1);break;case"deleteContentForward":O===U&&(K+=1);break}I.preventDefault(),(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:L,change:P||"",willCommit:!1,selStart:F,selEnd:K}})}),this._setEventListeners(n,g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.value)}if(C&&n.addEventListener("blur",C),this.data.comb){const I=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${I}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class l8 extends hd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class c8 extends hd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return id.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n)){const g=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=g),e.setValue(f.id,{value:g})}e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class XP extends hd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(id.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=g&&y.id===n;y.domElement&&(y.domElement.checked=b),e.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class u8 extends Hw{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class d8 extends hd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");id.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const y=this.data.defaultFieldValue;for(const b of s.options)b.selected=b.value===y});for(const g of this.data.options){const y=document.createElement("option");y.textContent=g.displayValue,y.value=g.exportValue,n.value.includes(g.exportValue)&&(y.setAttribute("selected",!0),o=!1),s.append(y)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),l=()=>{g.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=g=>{const y=g?"value":"textContent",{options:b,multiple:A}=s;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=c(!1);const f=g=>{const y=g.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const y={value(b){l==null||l();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const C of s.options)C.selected=w.has(C.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(b){s.multiple=!0},remove(b){const A=s.options,w=b.detail.remove;A[w].selected=!1,s.remove(w),A.length>0&&Array.prototype.findIndex.call(A,N=>N.selected)===-1&&(A[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},clear(b){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(b){const{index:A,displayValue:w,exportValue:C}=b.detail.insert,N=s.children[A],I=document.createElement("option");I.textContent=w,I.value=C,N?N.before(I):s.append(I),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},items(b){const{items:A}=b.detail;for(;s.length!==0;)s.remove(0);for(const w of A){const{displayValue:C,exportValue:N}=w,I=document.createElement("option");I.textContent=C,I.value=N,s.append(I)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,g)}),s.addEventListener("input",g=>{var A;const y=c(!0),b=c(!1);e.setValue(t,{value:y}),g.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var ey,ST;class _T extends jt{constructor(t){const{data:n,elements:s,parent:o}=t,l=!!o._commentManager;super(t,{isRenderable:!l&&jt._hasPopupData(n)});R(this,ey);if(this.elements=s,l&&jt._hasPopupData(n)){const c=this.popup=M(this,ey,ST).call(this);for(const h of s)h.popup=c}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const n=this.popup=M(this,ey,ST).call(this),s=[];for(const o of this.elements)o.popup=n,o.container.ariaHasPopup="dialog",s.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(o=>`${Mw}${o}`).join(",")),this.container}}ey=new WeakSet,ST=function(){return new h8({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var rs,Gl,Wb,Kb,wf,Cf,sn,jr,zl,Du,xf,Rf,Qr,os,la,ca,Nn,ua,Vl,ty,da,If,ku,ql,oi,$l,$e,Bv,AT,ET,TT,Hv,wT,WP,KP,JP,jP,Gv,zv,CT;class h8{constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:g,open:y,commentManager:b=null}){R(this,$e);R(this,rs,null);R(this,Gl,M(this,$e,JP).bind(this));R(this,Wb,M(this,$e,CT).bind(this));R(this,Kb,M(this,$e,zv).bind(this));R(this,wf,M(this,$e,Gv).bind(this));R(this,Cf,null);R(this,sn,null);R(this,jr,null);R(this,zl,null);R(this,Du,null);R(this,xf,null);R(this,Rf,null);R(this,Qr,!1);R(this,os,null);R(this,la,null);R(this,ca,null);R(this,Nn,null);R(this,ua,null);R(this,Vl,null);R(this,ty,null);R(this,da,null);R(this,If,null);R(this,ku,null);R(this,ql,!1);R(this,oi,null);R(this,$l,null);E(this,sn,e),E(this,If,s),E(this,jr,l),E(this,da,c),E(this,xf,h),E(this,Cf,t),E(this,ty,f),E(this,Rf,g),E(this,Du,n),E(this,rs,b),E(this,oi,n[0]),E(this,zl,zg.toDateObject(o)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup()),b?this.renderCommentButton():(M(this,$e,Bv).call(this),d(this,sn).hidden=!0,y&&M(this,$e,Gv).call(this))}renderCommentButton(){if(d(this,Nn)||(d(this,ua)||M(this,$e,AT).call(this),!d(this,ua)))return;const{signal:e}=E(this,la,new AbortController),t=!!d(this,oi).extraPopupElement,n=()=>{d(this,rs).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{d(this,rs).toggleCommentPopup(this,!1,!0,!t)},o=()=>{d(this,rs).toggleCommentPopup(this,!1,!1)};if(t){E(this,Nn,d(this,oi).container);for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",d(this,Gl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=E(this,Nn,document.createElement("button"));l.className="annotationCommentButton";const c=d(this,oi).container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),M(this,$e,TT).call(this),M(this,$e,ET).call(this),l.addEventListener("keydown",d(this,Gl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),c.after(l)}}get commentButtonColor(){const{color:e,opacity:t}=d(this,oi).commentData;return e?d(this,xf)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=d(this,Nn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=d(this,oi).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return d(this,Nn)}get comment(){return d(this,$l)||E(this,$l,d(this,oi).commentText),d(this,$l)}set comment(e){e!==this.comment&&(d(this,oi).commentText=E(this,$l,e))}get parentBoundingClientRect(){return d(this,oi).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){d(this,Nn)&&(d(this,Nn).classList.toggle("selected",e),d(this,Nn).ariaExpanded=t)}setSelectedCommentButton(e){d(this,Nn).classList.toggle("selected",e)}get commentPopupPosition(){if(d(this,Vl))return d(this,Vl);const{x:e,y:t,height:n}=d(this,Nn).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,oi).layer.getBoundingClientRect();return[(e-s)/l,(t+n-o)/c]}set commentPopupPosition(e){E(this,Vl,e)}hasDefaultPopupPosition(){return d(this,Vl)===null}get commentButtonPosition(){return d(this,ua)}get commentButtonWidth(){return d(this,Nn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=d(this,Vl)||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:l,width:c,height:h}=s;d(this,rs).showDialog(null,this,o+t*c,l+n*h,{...e,parentDimensions:s})}render(){var n,s;if(d(this,os))return;const e=E(this,os,document.createElement("div"));if(e.className="popup",d(this,Cf)){const o=e.style.outlineColor=be.makeHexColor(...d(this,Cf));e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=d(this,If))!=null&&n.str){const o=document.createElement("span");o.className="title",t.append(o),{dir:o.dir,str:o.textContent}=d(this,If)}if(e.append(t),d(this,zl)){const o=document.createElement("time");o.className="popupDate",o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:d(this,zl).valueOf()})),o.dateTime=d(this,zl).toISOString(),t.append(o)}kw({html:d(this,$e,Hv)||d(this,jr).str,dir:(s=d(this,jr))==null?void 0:s.dir,className:"popupContent"},e),d(this,sn).append(e)}updateEdited({rect:e,popup:t,deleted:n}){var s;if(d(this,rs)){n?(this.remove(),E(this,$l,null)):t&&(t.deleted?this.remove():(M(this,$e,TT).call(this),E(this,$l,t.text))),e&&(E(this,ua,null),M(this,$e,AT).call(this),M(this,$e,ET).call(this));return}if(n||t!=null&&t.deleted){this.remove();return}M(this,$e,Bv).call(this),d(this,ku)||E(this,ku,{contentsObj:d(this,jr),richText:d(this,da)}),e&&E(this,ca,null),t&&t.text&&(E(this,da,M(this,$e,KP).call(this,t.text)),E(this,zl,zg.toDateObject(t.date)),E(this,jr,null)),(s=d(this,os))==null||s.remove(),E(this,os,null)}resetEdited(){var e;d(this,ku)&&({contentsObj:Sn(this,jr)._,richText:Sn(this,da)._}=d(this,ku),E(this,ku,null),(e=d(this,os))==null||e.remove(),E(this,os,null),E(this,ca,null))}remove(){var e,t,n;if((e=d(this,la))==null||e.abort(),E(this,la,null),(t=d(this,os))==null||t.remove(),E(this,os,null),E(this,ql,!1),E(this,Qr,!1),(n=d(this,Nn))==null||n.remove(),E(this,Nn,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){E(this,ql,this.isVisible),d(this,ql)&&(d(this,sn).hidden=!0)}maybeShow(){d(this,rs)||(M(this,$e,Bv).call(this),d(this,ql)&&(d(this,os)||M(this,$e,zv).call(this),E(this,ql,!1),d(this,sn).hidden=!1))}get isVisible(){return d(this,rs)?!1:d(this,sn).hidden===!1}}rs=new WeakMap,Gl=new WeakMap,Wb=new WeakMap,Kb=new WeakMap,wf=new WeakMap,Cf=new WeakMap,sn=new WeakMap,jr=new WeakMap,zl=new WeakMap,Du=new WeakMap,xf=new WeakMap,Rf=new WeakMap,Qr=new WeakMap,os=new WeakMap,la=new WeakMap,ca=new WeakMap,Nn=new WeakMap,ua=new WeakMap,Vl=new WeakMap,ty=new WeakMap,da=new WeakMap,If=new WeakMap,ku=new WeakMap,ql=new WeakMap,oi=new WeakMap,$l=new WeakMap,$e=new WeakSet,Bv=function(){var t;if(d(this,la))return;E(this,la,new AbortController);const{signal:e}=d(this,la);for(const n of this.trigger)n.addEventListener("click",d(this,wf),{signal:e}),n.addEventListener("pointerenter",d(this,Kb),{signal:e}),n.addEventListener("pointerleave",d(this,Wb),{signal:e}),n.classList.add("popupTriggerArea");for(const n of d(this,Du))(t=n.container)==null||t.addEventListener("keydown",d(this,Gl),{signal:e})},AT=function(){const e=d(this,Du).find(t=>t.hasCommentButton);e&&E(this,ua,e._normalizePoint(e.commentButtonPosition))},ET=function(){if(d(this,oi).extraPopupElement&&!d(this,oi).editor)return;this.renderCommentButton();const[e,t]=d(this,ua),{style:n}=d(this,Nn);n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`},TT=function(){d(this,oi).extraPopupElement||(this.renderCommentButton(),d(this,Nn).style.backgroundColor=this.commentButtonColor||"")},Hv=function(){const e=d(this,da),t=d(this,jr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&d(this,da).html||null},wT=function(){var e,t,n;return((n=(t=(e=d(this,$e,Hv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},WP=function(){var e,t,n;return((n=(t=(e=d(this,$e,Hv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},KP=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:d(this,$e,WP),fontSize:d(this,$e,wT)?`calc(${d(this,$e,wT)}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n},JP=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&d(this,Qr))&&M(this,$e,Gv).call(this)},jP=function(){if(d(this,ca)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=d(this,xf);let l=!!d(this,Rf),c=l?d(this,Rf):d(this,ty);for(const w of d(this,Du))if(!c||be.intersect(w.data.rect,c)!==null){c=w.data.rect,l=!0;break}const h=be.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),g=l?c[2]-c[0]+5:0,y=h[0]+g,b=h[1];E(this,ca,[100*(y-s)/t,100*(b-o)/n]);const{style:A}=d(this,sn);A.left=`${d(this,ca)[0]}%`,A.top=`${d(this,ca)[1]}%`},Gv=function(){if(d(this,rs)){d(this,rs).toggleCommentPopup(this,!1);return}E(this,Qr,!d(this,Qr)),d(this,Qr)?(M(this,$e,zv).call(this),d(this,sn).addEventListener("click",d(this,wf)),d(this,sn).addEventListener("keydown",d(this,Gl))):(M(this,$e,CT).call(this),d(this,sn).removeEventListener("click",d(this,wf)),d(this,sn).removeEventListener("keydown",d(this,Gl)))},zv=function(){d(this,os)||this.render(),this.isVisible?d(this,Qr)&&d(this,sn).classList.add("focused"):(M(this,$e,jP).call(this),d(this,sn).hidden=!1,d(this,sn).style.zIndex=parseInt(d(this,sn).style.zIndex)+1e3)},CT=function(){d(this,sn).classList.remove("focused"),!(d(this,Qr)||!this.isVisible)&&(d(this,sn).hidden=!0,d(this,sn).style.zIndex=parseInt(d(this,sn).style.zIndex)-1e3)};class QP extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ny;class f8 extends jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,ny,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=E(this,ny,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,ny)}addHighlightArea(){this.container.classList.add("highlightArea")}}ny=new WeakMap;var iy;class p8 extends jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,iy,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=E(this,iy,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,iy)}addHighlightArea(){this.container.classList.add("highlightArea")}}iy=new WeakMap;var sy;class g8 extends jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,sy,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=E(this,sy,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",s/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,sy)}addHighlightArea(){this.container.classList.add("highlightArea")}}sy=new WeakMap;var ry;class ZP extends jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,ry,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:s,popupRef:o},width:l,height:c}=this;if(!n)return this.container;const h=this.svgFactory.create(l,c,!0);let f=[];for(let y=0,b=n.length;y<b;y+=2){const A=n[y]-t[0],w=t[3]-n[y+1];f.push(`${A},${w}`)}f=f.join(" ");const g=E(this,ry,this.svgFactory.createElement(this.svgElementName));return g.setAttribute("points",f),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),h.append(g),this.container.append(h),!o&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,ry)}addHighlightArea(){this.container.classList.add("highlightArea")}}ry=new WeakMap;class m8 extends ZP{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class y8 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var oy,Pu,ay,xT;class Gw extends jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,ay);R(this,oy,null);R(this,Pu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Oe.HIGHLIGHT:Oe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:s,borderStyle:o,popupRef:l}}=this,{transform:c,width:h,height:f}=M(this,ay,xT).call(this,n,t),g=this.svgFactory.create(h,f,!0),y=E(this,oy,this.svgFactory.createElement("svg:g"));g.append(y),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",c);for(let b=0,A=s.length;b<A;b++){const w=this.svgFactory.createElement(this.svgElementName);d(this,Pu).push(w),w.setAttribute("points",s[b].join(",")),y.append(w)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(g),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:s,rect:o}=t,l=d(this,oy);if(n>=0&&l.setAttribute("stroke-width",n||1),s)for(let c=0,h=d(this,Pu).length;c<h;c++)d(this,Pu)[c].setAttribute("points",s[c].join(","));if(o){const{transform:c,width:h,height:f}=M(this,ay,xT).call(this,this.data.rotation,o);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${f}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return d(this,Pu)}addHighlightArea(){this.container.classList.add("highlightArea")}}oy=new WeakMap,Pu=new WeakMap,ay=new WeakSet,xT=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class e2 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Oe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class v8 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class b8 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class _8 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class t2 extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ly,cy,RT;class S8 extends jt{constructor(t){var s;super(t,{isRenderable:!0});R(this,cy);R(this,ly,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",M(this,cy,RT).bind(this)),E(this,ly,s);const{isMac:o}=On.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(o?l.metaKey:l.ctrlKey)&&M(this,cy,RT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return d(this,ly)}addHighlightArea(){this.container.classList.add("highlightArea")}}ly=new WeakMap,cy=new WeakSet,RT=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Nf,Lu,Mf,Yl,uy,Ou,fc,IT,NT,Df;let zw=(Df=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:g}){R(this,fc);R(this,Nf,null);R(this,Lu,null);R(this,Mf,null);R(this,Yl,new Map);R(this,uy,null);R(this,Ou,null);this.div=e,E(this,Nf,t),E(this,Lu,n),E(this,uy,c||null),E(this,Ou,f||null),E(this,Mf,g||new Pw),this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return d(this,Yl).size>0}async render(e){var l,c,h;const{annotations:t}=e,n=this.div;uc(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:d(this,Ou),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Yg,annotationStorage:d(this,Mf),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const f of t){if(f.noHTML)continue;const g=f.annotationType===cn.POPUP;if(g){const A=s.get(f.id);if(!A)continue;o.elements=A}else if(f.rect[2]===f.rect[0]||f.rect[3]===f.rect[1])continue;o.data=f;const y=DM.create(o);if(!y.isRenderable)continue;if(!g&&f.popupRef){const A=s.get(f.popupRef);A?A.push(y):s.set(f.popupRef,[y])}const b=y.render();f.hidden&&(b.style.visibility="hidden"),await M(this,fc,IT).call(this,b,f.id,o.elements),(c=(l=y.extraPopupElement)==null?void 0:l.popup)==null||c.renderCommentButton(),y._isEditable&&(d(this,Yl).set(y.data.id,y),(h=this._annotationEditorUIManager)==null||h.renderAnnotationElement(y))}M(this,fc,NT).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:d(this,Ou),svgFactory:new Yg,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=Df._defaultBorderStyle),t.data=n;const s=DM.create(t);if(!s.isRenderable)continue;const o=s.render();await M(this,fc,IT).call(this,o,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,uc(t,{rotation:e.rotation}),M(this,fc,NT).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(d(this,Yl).values())}getEditableAnnotation(e){return d(this,Yl).get(e)}addFakeAnnotation(e){var c;const{div:t}=this,{id:n,rotation:s}=e,o=new r8({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:d(this,Ou),annotationStorage:d(this,Mf)}),l=o.render();return t.append(l),(c=d(this,Nf))==null||c.moveElementInDOM(t,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Ve(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:th.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Nf=new WeakMap,Lu=new WeakMap,Mf=new WeakMap,Yl=new WeakMap,uy=new WeakMap,Ou=new WeakMap,fc=new WeakSet,IT=async function(e,t,n){var c,h;const s=e.firstChild||e,o=s.id=`${Mw}${t}`,l=await((c=d(this,uy))==null?void 0:c.getAriaAttributes(o));if(l)for(const[f,g]of l)s.setAttribute(f,g);n?n.at(-1).container.after(e):(this.div.append(e),(h=d(this,Nf))==null||h.moveElementInDOM(this.div,e,s,!1))},NT=function(){var t;if(!d(this,Lu))return;const e=this.div;for(const[n,s]of d(this,Lu)){const o=e.querySelector(`[data-annotation-id="${n}"]`);if(!o)continue;s.className="annotationContent";const{firstChild:l}=o;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):o.append(s);const c=d(this,Yl).get(n);c&&(c._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,o.id,s),c._hasNoCanvas=!1):c.canvas=s)}d(this,Lu).clear()},Df);const Sv=/\r\n?|\n/g;var as,dy,Uu,ls,bn,n2,i2,s2,Vv,wa,qv,$v,r2,DT,o2;const Vt=class Vt extends Bt{constructor(t){super({...t,name:"freeTextEditor"});R(this,bn);R(this,as,"");R(this,dy,`${this.id}-editor`);R(this,Uu,null);R(this,ls);ce(this,"_colorPicker",null);this.color=t.color||Vt._defaultColor||Bt._defaultLineColor,E(this,ls,t.fontSize||Vt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Vt.prototype,n=l=>l.isEmpty(),s=dc.TRANSLATE_SMALL,o=dc.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new ky([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-o,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[o,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-o],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,o],checker:n}]]))}static initialize(t,n){Bt.initialize(t,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case tt.FREETEXT_SIZE:Vt._defaultFontSize=n;break;case tt.FREETEXT_COLOR:Vt._defaultColor=n;break}}updateParams(t,n){switch(t){case tt.FREETEXT_SIZE:M(this,bn,n2).call(this,n);break;case tt.FREETEXT_COLOR:M(this,bn,i2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[tt.FREETEXT_SIZE,Vt._defaultFontSize],[tt.FREETEXT_COLOR,Vt._defaultColor||Bt._defaultLineColor]]}get propertiesToUpdate(){return[[tt.FREETEXT_SIZE,d(this,ls)],[tt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Sb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return tt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Vt._internalPadding*t,-(Vt._internalPadding+d(this,ls))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),E(this,Uu,new AbortController);const t=this._uiManager.combinedSignal(d(this,Uu));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,dy)),this._isDraggable=!0,(t=d(this,Uu))==null||t.abort(),E(this,Uu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=d(this,as),n=E(this,as,M(this,bn,s2).call(this).trimEnd());if(t===n)return;const s=o=>{if(E(this,as,o),!o){this.remove();return}M(this,bn,$v).call(this),this._uiManager.rebuild(this),M(this,bn,Vv).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(t)},mustExec:!1}),M(this,bn,Vv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Vt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,dy)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${d(this,ls)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[o,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[h,f]=this.getInitialTranslation();[h,f]=this.pageTranslationToScreen(h,f);const[g,y]=this.pageDimensions,[b,A]=this.pageTranslation;let w,C;switch(this.rotation){case 0:w=t+(c[0]-b)/g,C=n+this.height-(c[1]-A)/y;break;case 90:w=t+(c[0]-b)/g,C=n-(c[1]-A)/y,[h,f]=[f,-h];break;case 180:w=t-this.width+(c[0]-b)/g,C=n-(c[1]-A)/y,[h,f]=[-h,-f];break;case 270:w=t+(c[0]-b-this.height*y)/g,C=n+(c[1]-A-this.width*g)/y,[h,f]=[-f,h];break}this.setAt(w*o,C*l,h,f)}else this._moveAfterPaste(t,n);M(this,bn,$v).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,C,N;const n=t.clipboardData||window.clipboardData,{types:s}=n;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const o=M(w=Vt,wa,DT).call(w,n.getData("text")||"").replaceAll(Sv,`
`);if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!o.includes(`
`)){c.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=c,g=[],y=[];if(h.nodeType===Node.TEXT_NODE){const I=h.parentElement;if(y.push(h.nodeValue.slice(f).replaceAll(Sv,"")),I!==this.editorDiv){let P=g;for(const k of this.editorDiv.childNodes){if(k===I){P=y;continue}P.push(M(C=Vt,wa,qv).call(C,k))}}g.push(h.nodeValue.slice(0,f).replaceAll(Sv,""))}else if(h===this.editorDiv){let I=g,P=0;for(const k of this.editorDiv.childNodes)P++===f&&(I=y),I.push(M(N=Vt,wa,qv).call(N,k))}E(this,as,`${g.join(`
`)}${o}${y.join(`
`)}`),M(this,bn,$v).call(this);const b=new Range;let A=Math.sumPrecise(g.map(I=>I.length));for(const{firstChild:I}of this.editorDiv.childNodes)if(I.nodeType===Node.TEXT_NODE){const P=I.nodeValue.length;if(A<=P){b.setStart(I,A),b.setEnd(I,A);break}A-=P}l.removeAllRanges(),l.addRange(b)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Vt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,s){var c;let o=null;if(t instanceof QP){const{data:{defaultAppearanceData:{fontSize:h,fontColor:f},rect:g,rotation:y,id:b,popupRef:A,richText:w,contentsObj:C,creationDate:N,modificationDate:I},textContent:P,textPosition:k,parent:{page:{pageNumber:L}}}=t;if(!P||P.length===0)return null;o=t={annotationType:Oe.FREETEXT,color:Array.from(f),fontSize:h,value:P.join(`
`),position:k,pageIndex:L-1,rect:g.slice(0),rotation:y,annotationElementId:b,id:b,deleted:!1,popupRef:A,comment:(C==null?void 0:C.str)||null,richText:w,creationDate:N,modificationDate:I}}const l=await super.deserialize(t,n,s);return E(l,ls,t.fontSize),l.color=be.makeHexColor(...t.color),E(l,as,M(c=Vt,wa,DT).call(c,t.value)),l._initialData=o,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Bt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:n,fontSize:d(this,ls),value:M(this,bn,r2).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!M(this,bn,o2).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:s}=n;s.fontSize=`calc(${d(this,ls)}px * var(--total-scale-factor))`,s.color=this.color,n.replaceChildren();for(const o of d(this,as).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:d(this,as)}}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};as=new WeakMap,dy=new WeakMap,Uu=new WeakMap,ls=new WeakMap,bn=new WeakSet,n2=function(t){const n=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--total-scale-factor))`,this.translate(0,-(o-d(this,ls))*this.parentScale),E(this,ls,o),M(this,bn,Vv).call(this)},s=d(this,ls);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i2=function(t){const n=o=>{this.color=o,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},s2=function(){var s;const t=[];this.editorDiv.normalize();let n=null;for(const o of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&o.nodeName==="BR"||(t.push(M(s=Vt,wa,qv).call(s,o)),n=o);return t.join(`
`)},Vv=function(){const[t,n]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:o,div:l}=this,c=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",o.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/n):(this.width=s.height/t,this.height=s.width/n),this.fixAndSetPosition()},wa=new WeakSet,qv=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Sv,"")},$v=function(){if(this.editorDiv.replaceChildren(),!!d(this,as))for(const t of d(this,as).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},r2=function(){return d(this,as).replaceAll(""," ")},DT=function(t){return t.replaceAll(" ","")},o2=function(t){const{value:n,fontSize:s,color:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==s||t.color.some((c,h)=>c!==o[h])||t.pageIndex!==l},R(Vt,wa),ce(Vt,"_freeTextDefaultContent",""),ce(Vt,"_internalPadding",0),ce(Vt,"_defaultColor",null),ce(Vt,"_defaultFontSize",10),ce(Vt,"_type","freetext"),ce(Vt,"_editorType",Oe.FREETEXT);let MT=Vt;class ve{toSVGPath(){Ut("Abstract method `toSVGPath` must be implemented.")}get box(){Ut("Abstract getter `box` must be implemented.")}serialize(e,t){Ut("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*o;return l}static _rescaleAndSwap(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*o;return l}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+l)/6,(n+o)/2,(s+l)/2]}}ce(ve,"PRECISION",1e-4);var cs,pr,kf,Pf,Zr,Ke,Fu,Bu,hy,fy,Lf,Of,Xl,py,Jb,jb,wn,xg,a2,l2,c2,u2,d2,h2;const Fo=class Fo{constructor({x:e,y:t},n,s,o,l,c=0){R(this,wn);R(this,cs);R(this,pr,[]);R(this,kf);R(this,Pf);R(this,Zr,[]);R(this,Ke,new Float32Array(18));R(this,Fu);R(this,Bu);R(this,hy);R(this,fy);R(this,Lf);R(this,Of);R(this,Xl,[]);E(this,cs,n),E(this,Of,o*s),E(this,Pf,l),d(this,Ke).set([NaN,NaN,NaN,NaN,e,t],6),E(this,kf,c),E(this,fy,d(Fo,py)*s),E(this,hy,d(Fo,jb)*s),E(this,Lf,s),d(this,Xl).push(e,t)}isEmpty(){return isNaN(d(this,Ke)[8])}add({x:e,y:t}){var q;E(this,Fu,e),E(this,Bu,t);const[n,s,o,l]=d(this,cs);let[c,h,f,g]=d(this,Ke).subarray(8,12);const y=e-f,b=t-g,A=Math.hypot(y,b);if(A<d(this,hy))return!1;const w=A-d(this,fy),C=w/A,N=C*y,I=C*b;let P=c,k=h;c=f,h=g,f+=N,g+=I,(q=d(this,Xl))==null||q.push(e,t);const L=-I/w,O=N/w,U=L*d(this,Of),F=O*d(this,Of);return d(this,Ke).set(d(this,Ke).subarray(2,8),0),d(this,Ke).set([f+U,g+F],4),d(this,Ke).set(d(this,Ke).subarray(14,18),12),d(this,Ke).set([f-U,g-F],16),isNaN(d(this,Ke)[6])?(d(this,Zr).length===0&&(d(this,Ke).set([c+U,h+F],2),d(this,Zr).push(NaN,NaN,NaN,NaN,(c+U-n)/o,(h+F-s)/l),d(this,Ke).set([c-U,h-F],14),d(this,pr).push(NaN,NaN,NaN,NaN,(c-U-n)/o,(h-F-s)/l)),d(this,Ke).set([P,k,c,h,f,g],6),!this.isEmpty()):(d(this,Ke).set([P,k,c,h,f,g],6),Math.abs(Math.atan2(k-h,P-c)-Math.atan2(I,N))<Math.PI/2?([c,h,f,g]=d(this,Ke).subarray(2,6),d(this,Zr).push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+g)/2-s)/l),[c,h,P,k]=d(this,Ke).subarray(14,18),d(this,pr).push(NaN,NaN,NaN,NaN,((P+c)/2-n)/o,((k+h)/2-s)/l),!0):([P,k,c,h,f,g]=d(this,Ke).subarray(0,6),d(this,Zr).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),[f,g,c,h,P,k]=d(this,Ke).subarray(12,18),d(this,pr).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=d(this,Zr),t=d(this,pr);if(isNaN(d(this,Ke)[6])&&!this.isEmpty())return M(this,wn,a2).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);M(this,wn,c2).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return M(this,wn,l2).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,o,l){return new f2(e,t,n,s,o,l)}getOutlines(){var y;const e=d(this,Zr),t=d(this,pr),n=d(this,Ke),[s,o,l,c]=d(this,cs),h=new Float32Array((((y=d(this,Xl))==null?void 0:y.length)??0)+2);for(let b=0,A=h.length-2;b<A;b+=2)h[b]=(d(this,Xl)[b]-s)/l,h[b+1]=(d(this,Xl)[b+1]-o)/c;if(h[h.length-2]=(d(this,Fu)-s)/l,h[h.length-1]=(d(this,Bu)-o)/c,isNaN(n[6])&&!this.isEmpty())return M(this,wn,u2).call(this,h);const f=new Float32Array(d(this,Zr).length+24+d(this,pr).length);let g=e.length;for(let b=0;b<g;b+=2){if(isNaN(e[b])){f[b]=f[b+1]=NaN;continue}f[b]=e[b],f[b+1]=e[b+1]}g=M(this,wn,h2).call(this,f,g);for(let b=t.length-6;b>=6;b-=6)for(let A=0;A<6;A+=2){if(isNaN(t[b+A])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=t[b+A],f[g+1]=t[b+A+1],g+=2}return M(this,wn,d2).call(this,f,g),this.newFreeDrawOutline(f,h,d(this,cs),d(this,Lf),d(this,kf),d(this,Pf))}};cs=new WeakMap,pr=new WeakMap,kf=new WeakMap,Pf=new WeakMap,Zr=new WeakMap,Ke=new WeakMap,Fu=new WeakMap,Bu=new WeakMap,hy=new WeakMap,fy=new WeakMap,Lf=new WeakMap,Of=new WeakMap,Xl=new WeakMap,py=new WeakMap,Jb=new WeakMap,jb=new WeakMap,wn=new WeakSet,xg=function(){const e=d(this,Ke).subarray(4,6),t=d(this,Ke).subarray(16,18),[n,s,o,l]=d(this,cs);return[(d(this,Fu)+(e[0]-t[0])/2-n)/o,(d(this,Bu)+(e[1]-t[1])/2-s)/l,(d(this,Fu)+(t[0]-e[0])/2-n)/o,(d(this,Bu)+(t[1]-e[1])/2-s)/l]},a2=function(){const[e,t,n,s]=d(this,cs),[o,l,c,h]=M(this,wn,xg).call(this);return`M${(d(this,Ke)[2]-e)/n} ${(d(this,Ke)[3]-t)/s} L${(d(this,Ke)[4]-e)/n} ${(d(this,Ke)[5]-t)/s} L${o} ${l} L${c} ${h} L${(d(this,Ke)[16]-e)/n} ${(d(this,Ke)[17]-t)/s} L${(d(this,Ke)[14]-e)/n} ${(d(this,Ke)[15]-t)/s} Z`},l2=function(e){const t=d(this,pr);e.push(`L${t[4]} ${t[5]} Z`)},c2=function(e){const[t,n,s,o]=d(this,cs),l=d(this,Ke).subarray(4,6),c=d(this,Ke).subarray(16,18),[h,f,g,y]=M(this,wn,xg).call(this);e.push(`L${(l[0]-t)/s} ${(l[1]-n)/o} L${h} ${f} L${g} ${y} L${(c[0]-t)/s} ${(c[1]-n)/o}`)},u2=function(e){const t=d(this,Ke),[n,s,o,l]=d(this,cs),[c,h,f,g]=M(this,wn,xg).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/l],0),this.newFreeDrawOutline(y,e,d(this,cs),d(this,Lf),d(this,kf),d(this,Pf))},d2=function(e,t){const n=d(this,pr);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},h2=function(e,t){const n=d(this,Ke).subarray(4,6),s=d(this,Ke).subarray(16,18),[o,l,c,h]=d(this,cs),[f,g,y,b]=M(this,wn,xg).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-l)/h],t),t+=24},R(Fo,py,8),R(Fo,Jb,2),R(Fo,jb,d(Fo,py)+d(Fo,Jb));let Ab=Fo;var Uf,Hu,ha,gy,us,my,dn,Qb,p2;class f2 extends ve{constructor(t,n,s,o,l,c){super();R(this,Qb);R(this,Uf);R(this,Hu,new Float32Array(4));R(this,ha);R(this,gy);R(this,us);R(this,my);R(this,dn);E(this,dn,t),E(this,us,n),E(this,Uf,s),E(this,my,o),E(this,ha,l),E(this,gy,c),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],M(this,Qb,p2).call(this,c);const[h,f,g,y]=d(this,Hu);for(let b=0,A=t.length;b<A;b+=2)t[b]=(t[b]-h)/g,t[b+1]=(t[b+1]-f)/y;for(let b=0,A=n.length;b<A;b+=2)n[b]=(n[b]-h)/g,n[b+1]=(n[b+1]-f)/y}toSVGPath(){const t=[`M${d(this,dn)[4]} ${d(this,dn)[5]}`];for(let n=6,s=d(this,dn).length;n<s;n+=6){if(isNaN(d(this,dn)[n])){t.push(`L${d(this,dn)[n+4]} ${d(this,dn)[n+5]}`);continue}t.push(`C${d(this,dn)[n]} ${d(this,dn)[n+1]} ${d(this,dn)[n+2]} ${d(this,dn)[n+3]} ${d(this,dn)[n+4]} ${d(this,dn)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,s,o],l){const c=s-t,h=o-n;let f,g;switch(l){case 0:f=ve._rescale(d(this,dn),t,o,c,-h),g=ve._rescale(d(this,us),t,o,c,-h);break;case 90:f=ve._rescaleAndSwap(d(this,dn),t,n,c,h),g=ve._rescaleAndSwap(d(this,us),t,n,c,h);break;case 180:f=ve._rescale(d(this,dn),s,n,-c,h),g=ve._rescale(d(this,us),s,n,-c,h);break;case 270:f=ve._rescaleAndSwap(d(this,dn),s,o,-c,-h),g=ve._rescaleAndSwap(d(this,us),s,o,-c,-h);break}return{outline:Array.from(f),points:[Array.from(g)]}}get box(){return d(this,Hu)}newOutliner(t,n,s,o,l,c=0){return new Ab(t,n,s,o,l,c)}getNewOutline(t,n){const[s,o,l,c]=d(this,Hu),[h,f,g,y]=d(this,Uf),b=l*g,A=c*y,w=s*g+h,C=o*y+f,N=this.newOutliner({x:d(this,us)[0]*b+w,y:d(this,us)[1]*A+C},d(this,Uf),d(this,my),t,d(this,gy),n??d(this,ha));for(let I=2;I<d(this,us).length;I+=2)N.add({x:d(this,us)[I]*b+w,y:d(this,us)[I+1]*A+C});return N.getOutlines()}}Uf=new WeakMap,Hu=new WeakMap,ha=new WeakMap,gy=new WeakMap,us=new WeakMap,my=new WeakMap,dn=new WeakMap,Qb=new WeakSet,p2=function(t){const n=d(this,dn);let s=n[4],o=n[5];const l=[s,o,s,o];let c=s,h=o,f=s,g=o;const y=t?Math.max:Math.min,b=new Float32Array(4);for(let w=6,C=n.length;w<C;w+=6){const N=n[w+4],I=n[w+5];isNaN(n[w])?(be.pointBoundingBox(N,I,l),h>I?(c=N,h=I):h===I&&(c=y(c,N)),g<I?(f=N,g=I):g===I&&(f=y(f,N))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,be.bezierBoundingBox(s,o,...n.slice(w,w+6),b),be.rectBoundingBox(b[0],b[1],b[2],b[3],l),h>b[1]?(c=b[0],h=b[1]):h===b[1]&&(c=y(c,b[0])),g<b[3]?(f=b[2],g=b[3]):g===b[3]&&(f=y(f,b[2]))),s=N,o=I}const A=d(this,Hu);A[0]=l[0]-d(this,ha),A[1]=l[1]-d(this,ha),A[2]=l[2]-l[0]+2*d(this,ha),A[3]=l[3]-l[1]+2*d(this,ha),this.firstPoint=[c,h],this.lastPoint=[f,g]};var yy,vy,by,Wl,gr,Ai,g2,Yv,m2,y2,PT;class kT{constructor(e,t=0,n=0,s=!0){R(this,Ai);R(this,yy);R(this,vy);R(this,by);R(this,Wl,[]);R(this,gr,[]);const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:C,y:N,width:I,height:P}of e){const k=Math.floor((C-t)/l)*l,L=Math.ceil((C+I+t)/l)*l,O=Math.floor((N-t)/l)*l,U=Math.ceil((N+P+t)/l)*l,F=[k,O,U,!0],K=[L,O,U,!1];d(this,Wl).push(F,K),be.rectBoundingBox(k,O,L,U,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,g=o[1]-n;let y=s?-1/0:1/0,b=1/0;const A=d(this,Wl).at(s?-1:-2),w=[A[0],A[2]];for(const C of d(this,Wl)){const[N,I,P,k]=C;!k&&s?I<b?(b=I,y=N):I===b&&(y=Math.max(y,N)):k&&!s&&(I<b?(b=I,y=N):I===b&&(y=Math.min(y,N))),C[0]=(N-f)/c,C[1]=(I-g)/h,C[2]=(P-g)/h}E(this,yy,new Float32Array([f,g,c,h])),E(this,vy,[y,b]),E(this,by,w)}getOutlines(){d(this,Wl).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of d(this,Wl))t[3]?(e.push(...M(this,Ai,PT).call(this,t)),M(this,Ai,m2).call(this,t)):(M(this,Ai,y2).call(this,t),e.push(...M(this,Ai,PT).call(this,t)));return M(this,Ai,g2).call(this,e)}}yy=new WeakMap,vy=new WeakMap,by=new WeakMap,Wl=new WeakMap,gr=new WeakMap,Ai=new WeakSet,g2=function(e){const t=[],n=new Set;for(const l of e){const[c,h,f]=l;t.push([c,h,l],[c,f,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],f=t[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[c,h,f,g,y]=l;n.delete(l);let b=c,A=h;for(o=[c,f],s.push(o);;){let w;if(n.has(g))w=g;else if(n.has(y))w=y;else break;n.delete(w),[c,h,f,g,y]=w,b!==c&&(o.push(b,A,c,A===h?h:f),b=c),A=A===h?f:h}o.push(b,A)}return new A8(s,d(this,yy),d(this,vy),d(this,by))},Yv=function(e){const t=d(this,gr);let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,l=t[o][0];if(l===e)return o;l<e?n=o+1:s=o-1}return s+1},m2=function([,e,t]){const n=M(this,Ai,Yv).call(this,e);d(this,gr).splice(n,0,[e,t])},y2=function([,e,t]){const n=M(this,Ai,Yv).call(this,e);for(let s=n;s<d(this,gr).length;s++){const[o,l]=d(this,gr)[s];if(o!==e)break;if(o===e&&l===t){d(this,gr).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=d(this,gr)[s];if(o!==e)break;if(o===e&&l===t){d(this,gr).splice(s,1);return}}},PT=function(e){const[t,n,s]=e,o=[[t,n,s]],l=M(this,Ai,Yv).call(this,s);for(let c=0;c<l;c++){const[h,f]=d(this,gr)[c];for(let g=0,y=o.length;g<y;g++){const[,b,A]=o[g];if(!(f<=b||A<=h)){if(b>=h){if(A>f)o[g][1]=f;else{if(y===1)return[];o.splice(g,1),g--,y--}continue}o[g][2]=h,A>f&&o.push([t,f,A])}}}return o};var _y,Ff;class A8 extends ve{constructor(t,n,s,o){super();R(this,_y);R(this,Ff);E(this,Ff,t),E(this,_y,n),this.firstPoint=s,this.lastPoint=o}toSVGPath(){const t=[];for(const n of d(this,Ff)){let[s,o]=n;t.push(`M${s} ${o}`);for(let l=2;l<n.length;l+=2){const c=n[l],h=n[l+1];c===s?(t.push(`V${h}`),o=h):h===o&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,n,s,o],l){const c=[],h=s-t,f=o-n;for(const g of d(this,Ff)){const y=new Array(g.length);for(let b=0;b<g.length;b+=2)y[b]=t+g[b]*h,y[b+1]=o-g[b+1]*f;c.push(y)}return c}get box(){return d(this,_y)}get classNamesForOutlining(){return["highlightOutline"]}}_y=new WeakMap,Ff=new WeakMap;class LT extends Ab{newFreeDrawOutline(e,t,n,s,o,l){return new E8(e,t,n,s,o,l)}}class E8 extends f2{newOutliner(e,t,n,s,o,l=0){return new LT(e,t,n,s,o,l)}}var Bf,Sy,fa,Gu,Ay,Hi,Ey,Ty,zu,ds,hs,Xn,Hf,Gf,ai,zf,Xs,wy,qe,OT,Xv,v2,b2,_2,UT,Bc,Js,ah,S2,Wv,Kv,A2,E2,T2,w2,C2;const ht=class ht extends Bt{constructor(t){super({...t,name:"highlightEditor"});R(this,qe);R(this,Bf,null);R(this,Sy,0);R(this,fa);R(this,Gu,null);R(this,Ay,null);R(this,Hi,null);R(this,Ey,null);R(this,Ty,0);R(this,zu,null);R(this,ds,null);R(this,hs,null);R(this,Xn,!1);R(this,Hf,null);R(this,Gf,null);R(this,ai,null);R(this,zf,"");R(this,Xs);R(this,wy,"");this.color=t.color||ht._defaultColor,E(this,Xs,t.thickness||ht._defaultThickness),this.opacity=t.opacity||ht._defaultOpacity,E(this,fa,t.boxes||null),E(this,wy,t.methodOfCreation||""),E(this,zf,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(E(this,Xn,!0),M(this,qe,Xv).call(this,t),M(this,qe,Bc).call(this)):d(this,fa)&&(E(this,Bf,t.anchorNode),E(this,Sy,t.anchorOffset),E(this,Ey,t.focusNode),E(this,Ty,t.focusOffset),M(this,qe,OT).call(this),M(this,qe,Bc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=ht.prototype;return Ve(this,"_keyboardManager",new ky([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:d(this,Xn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:d(this,Xs),methodOfCreation:d(this,wy)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var s;Bt.initialize(t,n),ht._defaultColor||(ht._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case tt.HIGHLIGHT_COLOR:ht._defaultColor=n;break;case tt.HIGHLIGHT_THICKNESS:ht._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return d(this,Gf)}get commentButtonPosition(){return d(this,Hf)}updateParams(t,n){switch(t){case tt.HIGHLIGHT_COLOR:M(this,qe,v2).call(this,n);break;case tt.HIGHLIGHT_THICKNESS:M(this,qe,b2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[tt.HIGHLIGHT_COLOR,ht._defaultColor],[tt.HIGHLIGHT_THICKNESS,ht._defaultThickness]]}get propertiesToUpdate(){return[[tt.HIGHLIGHT_COLOR,this.color||ht._defaultColor],[tt.HIGHLIGHT_THICKNESS,d(this,Xs)||ht._defaultThickness],[tt.HIGHLIGHT_FREE,d(this,Xn)]]}onUpdatedColor(){var t,n;(t=this.parent)==null||t.drawLayer.updateProperties(d(this,hs),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=d(this,Ay))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",E(this,Ay,new $g({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,qe,Kv).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,M(this,qe,Kv).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){M(this,qe,UT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,qe,Bc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?M(this,qe,UT).call(this):t&&(M(this,qe,Bc).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var o,l,c;const{drawLayer:n}=this.parent;let s;d(this,Xn)?(t=(t-this.rotation+360)%360,s=M(o=ht,Js,ah).call(o,d(this,ds).box,t)):s=M(l=ht,Js,ah).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(d(this,hs),{bbox:s,root:{"data-main-rotation":t}}),n.updateProperties(d(this,ai),{bbox:M(c=ht,Js,ah).call(c,d(this,Hi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();d(this,zf)&&(t.setAttribute("aria-label",d(this,zf)),t.setAttribute("role","mark")),d(this,Xn)?t.classList.add("free"):this.div.addEventListener("keydown",M(this,qe,S2).bind(this),{signal:this._uiManager._signal});const n=E(this,zu,document.createElement("div"));return t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=d(this,Gu),this.setDims(this.width,this.height),Xk(this,d(this,zu),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ai),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ai),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:M(this,qe,Wv).call(this,!0);break;case 1:case 3:M(this,qe,Wv).call(this,!1);break}}select(){var t;super.select(),d(this,ai)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,ai),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),d(this,ai)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,ai),{rootClass:{selected:!1}}),d(this,Xn)||M(this,qe,Wv).call(this,!1))}get _mustFixPosition(){return!d(this,Xn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(d(this,hs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(d(this,ai),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:s,x:o,y:l}){const{x:c,y:h,width:f,height:g}=s.getBoundingClientRect(),y=new AbortController,b=t.combinedSignal(y),A=w=>{y.abort(),M(this,Js,w2).call(this,t,w)};window.addEventListener("blur",A,{signal:b}),window.addEventListener("pointerup",A,{signal:b}),window.addEventListener("pointerdown",Jt,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",As,{signal:b}),s.addEventListener("pointermove",M(this,Js,T2).bind(this,t),{signal:b}),this._freeHighlight=new LT({x:o,y:l},[c,h,f,g],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,s){var C,N,I,P;let o=null;if(t instanceof e2){const{data:{quadPoints:k,rect:L,rotation:O,id:U,color:F,opacity:K,popupRef:q,richText:Q,contentsObj:ee,creationDate:se,modificationDate:le},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Oe.HIGHLIGHT,color:Array.from(F),opacity:K,quadPoints:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:U,id:U,deleted:!1,popupRef:q,richText:Q,comment:(ee==null?void 0:ee.str)||null,creationDate:se,modificationDate:le}}else if(t instanceof Gw){const{data:{inkLists:k,rect:L,rotation:O,id:U,color:F,borderStyle:{rawWidth:K},popupRef:q,richText:Q,contentsObj:ee,creationDate:se,modificationDate:le},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Oe.HIGHLIGHT,color:Array.from(F),thickness:K,inkLists:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:U,id:U,deleted:!1,popupRef:q,richText:Q,comment:(ee==null?void 0:ee.str)||null,creationDate:se,modificationDate:le}}const{color:l,quadPoints:c,inkLists:h,opacity:f}=t,g=await super.deserialize(t,n,s);g.color=be.makeHexColor(...l),g.opacity=f||1,h&&E(g,Xs,t.thickness),g._initialData=o,t.comment&&g.setCommentData(t);const[y,b]=g.pageDimensions,[A,w]=g.pageTranslation;if(c){const k=E(g,fa,[]);for(let L=0;L<c.length;L+=8)k.push({x:(c[L]-A)/y,y:1-(c[L+1]-w)/b,width:(c[L+2]-c[L])/y,height:(c[L+1]-c[L+5])/b});M(C=g,qe,OT).call(C),M(N=g,qe,Bc).call(N),g.rotate(g.rotation)}else if(h){E(g,Xn,!0);const k=h[0],L={x:k[0]-A,y:b-(k[1]-w)},O=new LT(L,[0,0,y,b],1,d(g,Xs)/2,!0,.001);for(let K=0,q=k.length;K<q;K+=2)L.x=k[K]-A,L.y=b-(k[K+1]-w),O.add(L);const{id:U,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:O.toSVGPath()}},!0,!0);M(I=g,qe,Xv).call(I,{highlightOutlines:O.getOutlines(),highlightId:U,clipPathId:F}),M(P=g,qe,Bc).call(P),g.rotate(g.parentRotation)}return g}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=Bt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:n,opacity:this.opacity,thickness:d(this,Xs),quadPoints:M(this,qe,A2).call(this),outlines:M(this,qe,E2).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!M(this,qe,C2).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Bf=new WeakMap,Sy=new WeakMap,fa=new WeakMap,Gu=new WeakMap,Ay=new WeakMap,Hi=new WeakMap,Ey=new WeakMap,Ty=new WeakMap,zu=new WeakMap,ds=new WeakMap,hs=new WeakMap,Xn=new WeakMap,Hf=new WeakMap,Gf=new WeakMap,ai=new WeakMap,zf=new WeakMap,Xs=new WeakMap,wy=new WeakMap,qe=new WeakSet,OT=function(){const t=new kT(d(this,fa),.001);E(this,ds,t.getOutlines()),[this.x,this.y,this.width,this.height]=d(this,ds).box;const n=new kT(d(this,fa),.0025,.001,this._uiManager.direction==="ltr");E(this,Hi,n.getOutlines());const{firstPoint:s}=d(this,ds);E(this,Hf,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:o}=d(this,Hi);E(this,Gf,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},Xv=function({highlightOutlines:t,highlightId:n,clipPathId:s}){var b,A;if(E(this,ds,t),E(this,Hi,t.getNewOutline(d(this,Xs)/2+1.5,.0025)),n>=0)E(this,hs,n),E(this,Gu,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),E(this,ai,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:d(this,Hi).box,path:{d:d(this,Hi).toSVGPath()}},!0));else if(this.parent){const w=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(d(this,hs),{bbox:M(b=ht,Js,ah).call(b,d(this,ds).box,(w-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(d(this,ai),{bbox:M(A=ht,Js,ah).call(A,d(this,Hi).box,w),path:{d:d(this,Hi).toSVGPath()}})}const[l,c,h,f]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=h,this.height=f;break;case 90:{const[w,C]=this.parentDimensions;this.x=c,this.y=1-l,this.width=h*C/w,this.height=f*w/C;break}case 180:this.x=1-l,this.y=1-c,this.width=h,this.height=f;break;case 270:{const[w,C]=this.parentDimensions;this.x=1-c,this.y=l,this.width=h*C/w,this.height=f*w/C;break}}const{firstPoint:g}=t;E(this,Hf,[(g[0]-l)/h,(g[1]-c)/f]);const{lastPoint:y}=d(this,Hi);E(this,Gf,[(y[0]-l)/h,(y[1]-c)/f])},v2=function(t){const n=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,o=this.opacity;this.addCommands({cmd:n.bind(this,t,ht._defaultOpacity),undo:n.bind(this,s,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},b2=function(t){const n=d(this,Xs),s=o=>{E(this,Xs,o),M(this,qe,_2).call(this,o)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},_2=function(t){d(this,Xn)&&(M(this,qe,Xv).call(this,{highlightOutlines:d(this,ds).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},UT=function(){d(this,hs)===null||!this.parent||(this.parent.drawLayer.remove(d(this,hs)),E(this,hs,null),this.parent.drawLayer.remove(d(this,ai)),E(this,ai,null))},Bc=function(t=this.parent){d(this,hs)===null&&({id:Sn(this,hs)._,clipPathId:Sn(this,Gu)._}=t.drawLayer.draw({bbox:d(this,ds).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:d(this,Xn)},path:{d:d(this,ds).toSVGPath()}},!1,!0),E(this,ai,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:d(this,Xn)},bbox:d(this,Hi).box,path:{d:d(this,Hi).toSVGPath()}},d(this,Xn))),d(this,zu)&&(d(this,zu).style.clipPath=d(this,Gu)))},Js=new WeakSet,ah=function([t,n,s,o],l){switch(l){case 90:return[1-n-o,t,o,s];case 180:return[1-t-s,1-n-o,s,o];case 270:return[n,1-t-s,o,s]}return[t,n,s,o]},S2=function(t){ht._keyboardManager.exec(this,t)},Wv=function(t){if(!d(this,Bf))return;const n=window.getSelection();t?n.setPosition(d(this,Bf),d(this,Sy)):n.setPosition(d(this,Ey),d(this,Ty))},Kv=function(){return d(this,Xn)?this.rotation:0},A2=function(){if(d(this,Xn))return null;const[t,n]=this.pageDimensions,[s,o]=this.pageTranslation,l=d(this,fa),c=new Float32Array(l.length*8);let h=0;for(const{x:f,y:g,width:y,height:b}of l){const A=f*t+s,w=(1-g)*n+o;c[h]=c[h+4]=A,c[h+1]=c[h+3]=w,c[h+2]=c[h+6]=A+y*t,c[h+5]=c[h+7]=w-b*n,h+=8}return c},E2=function(t){return d(this,ds).serialize(t,M(this,qe,Kv).call(this))},T2=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},w2=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},C2=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((s,o)=>s!==n[o])},R(ht,Js),ce(ht,"_defaultColor",null),ce(ht,"_defaultOpacity",1),ce(ht,"_defaultThickness",12),ce(ht,"_type","highlight"),ce(ht,"_editorType",Oe.HIGHLIGHT),ce(ht,"_freeHighlightId",-1),ce(ht,"_freeHighlight",null),ce(ht,"_freeHighlightClipId","");let Eb=ht;var Vu;class x2{constructor(){R(this,Vu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){d(this,Vu)[e]=t}toSVGProperties(){const e=d(this,Vu);return E(this,Vu,Object.create(null)),{root:e}}reset(){E(this,Vu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ut("Not implemented")}}Vu=new WeakMap;var fs,Vf,Mn,qu,$u,Kl,Jl,jl,Yu,ot,FT,BT,HT,Rg,R2,Jv,Ig,lh;const Ae=class Ae extends Bt{constructor(t){super(t);R(this,ot);R(this,fs,null);R(this,Vf);ce(this,"_colorPicker",null);ce(this,"_drawId",null);E(this,Vf,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(M(this,ot,FT).call(this,t),M(this,ot,Rg).call(this))}static _mergeSVGProperties(t,n){const s=new Set(Object.keys(t));for(const[o,l]of Object.entries(n))s.has(o)?Object.assign(t[o],l):t[o]=l;return t}static getDefaultDrawingOptions(t){Ut("Not implemented")}static get typesMap(){Ut("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(d(Ae,Mn).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[s,o]of this.typesMap)t.push([s,n[o]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[s,o]of this.constructor.typesMap)t.push([s,n[o]]);return t}_updateProperty(t,n,s){const o=this._drawingOptions,l=o[n],c=h=>{var g;o.updateProperty(n,h);const f=d(this,fs).updateProperty(n,h);f&&M(this,ot,Ig).call(this,f),(g=this.parent)==null||g.drawLayer.updateProperties(this._drawId,o.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ae._mergeSVGProperties(d(this,fs).getPathResizingSVGProperties(M(this,ot,Jv).call(this)),{bbox:M(this,ot,lh).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ae._mergeSVGProperties(d(this,fs).getPathResizedSVGProperties(M(this,ot,Jv).call(this)),{bbox:M(this,ot,lh).call(this)}))}_onTranslating(t,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:M(this,ot,lh).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ae._mergeSVGProperties(d(this,fs).getPathTranslatedSVGProperties(M(this,ot,Jv).call(this),this.parentDimensions),{bbox:M(this,ot,lh).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,d(this,Vf)&&(E(this,Vf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){M(this,ot,HT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,ot,Rg).call(this),M(this,ot,Ig).call(this,d(this,fs).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),M(this,ot,HT).call(this)):t&&(this._uiManager.addShouldRescale(this),M(this,ot,Rg).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ae._mergeSVGProperties({bbox:M(this,ot,lh).call(this)},d(this,fs).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,ot,Ig).call(this,d(this,fs).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const s=super.render();s.classList.add("draw");const o=document.createElement("div");return s.append(o),o.setAttribute("aria-hidden","true"),o.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),s}static createDrawerInstance(t,n,s,o,l){Ut("Not implemented")}static startDrawing(t,n,s,o){var N;const{target:l,offsetX:c,offsetY:h,pointerId:f,pointerType:g}=o;if(d(Ae,Jl)&&d(Ae,Jl)!==g)return;const{viewport:{rotation:y}}=t,{width:b,height:A}=l.getBoundingClientRect(),w=E(Ae,qu,new AbortController),C=t.combinedSignal(w);if(d(Ae,Kl)||E(Ae,Kl,f),d(Ae,Jl)??E(Ae,Jl,g),window.addEventListener("pointerup",I=>{var P;d(Ae,Kl)===I.pointerId?this._endDraw(I):(P=d(Ae,jl))==null||P.delete(I.pointerId)},{signal:C}),window.addEventListener("pointercancel",I=>{var P;d(Ae,Kl)===I.pointerId?this._currentParent.endDrawingSession():(P=d(Ae,jl))==null||P.delete(I.pointerId)},{signal:C}),window.addEventListener("pointerdown",I=>{d(Ae,Jl)===I.pointerType&&((d(Ae,jl)||E(Ae,jl,new Set)).add(I.pointerId),d(Ae,Mn).isCancellable()&&(d(Ae,Mn).removeLastElement(),d(Ae,Mn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:C}),window.addEventListener("contextmenu",As,{signal:C}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:C}),l.addEventListener("touchmove",I=>{I.timeStamp===d(Ae,Yu)&&Jt(I)},{signal:C}),t.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),d(Ae,Mn)){t.drawLayer.updateProperties(this._currentDrawId,d(Ae,Mn).startNew(c,h,b,A,y));return}n.updateUIForDefaultProperties(this),E(Ae,Mn,this.createDrawerInstance(c,h,b,A,y)),E(Ae,$u,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(d(Ae,$u).toSVGProperties(),d(Ae,Mn).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(E(Ae,Yu,-1),!d(Ae,Mn))return;const{offsetX:n,offsetY:s,pointerId:o}=t;if(d(Ae,Kl)===o){if(((l=d(Ae,jl))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,d(Ae,Mn).add(n,s)),E(Ae,Yu,t.timeStamp),Jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,E(Ae,Mn,null),E(Ae,$u,null),E(Ae,Jl,null),E(Ae,Yu,NaN)),d(Ae,qu)&&(d(Ae,qu).abort(),E(Ae,qu,null),E(Ae,Kl,NaN),E(Ae,jl,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,d(Ae,Mn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=d(Ae,Mn),o=this._currentDrawId,l=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(o,s.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(o,s.removeLastElement())},mustExec:!1,type:tt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(tt.DRAW_STEP),!d(Ae,Mn).isEmpty()){const{pageDimensions:[s,o],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:d(Ae,Mn).getOutlines(s*l,o*l,l,this._INNER_MARGIN),drawingOptions:d(Ae,$u),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,s,o,l,c){Ut("Not implemented")}static async deserialize(t,n,s){var y,b;const{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}=n.viewport,f=this.deserializeDraw(c,h,o,l,this._INNER_MARGIN,t),g=await super.deserialize(t,n,s);return g.createDrawingOptions(t),M(y=g,ot,FT).call(y,{drawOutlines:f}),M(b=g,ot,Rg).call(b),g.onScaleChanging(),g.rotate(),g}serializeDraw(t){const[n,s]=this.pageTranslation,[o,l]=this.pageDimensions;return d(this,fs).serialize([n,s,o,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};fs=new WeakMap,Vf=new WeakMap,Mn=new WeakMap,qu=new WeakMap,$u=new WeakMap,Kl=new WeakMap,Jl=new WeakMap,jl=new WeakMap,Yu=new WeakMap,ot=new WeakSet,FT=function({drawOutlines:t,drawId:n,drawingOptions:s}){E(this,fs,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=M(this,ot,BT).call(this,t,this.parent),M(this,ot,Ig).call(this,t.box)},BT=function(t,n){const{id:s}=n.drawLayer.draw(Ae._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},HT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Rg=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,ot,BT).call(this,d(this,fs),t)}},R2=function([t,n,s,o]){const{parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[n,1-t,s*(c/l),o*(l/c)];case 180:return[1-t,1-n,s,o];case 270:return[1-n,t,s*(c/l),o*(l/c)];default:return[t,n,s,o]}},Jv=function(){const{x:t,y:n,width:s,height:o,parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[1-n,t,s*(l/c),o*(c/l)];case 180:return[1-t,1-n,s,o];case 270:return[n,1-t,s*(l/c),o*(c/l)];default:return[t,n,s,o]}},Ig=function(t){[this.x,this.y,this.width,this.height]=M(this,ot,R2).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},lh=function(){const{x:t,y:n,width:s,height:o,rotation:l,parentRotation:c,parentDimensions:[h,f]}=this;switch((l*4+c)/90){case 1:return[1-n-o,t,o,s];case 2:return[1-t-s,1-n-o,s,o];case 3:return[n,1-t-s,o,s];case 4:return[t,n-s*(h/f),o*(f/h),s*(h/f)];case 5:return[1-n,t,s*(h/f),o*(f/h)];case 6:return[1-t-o*(f/h),1-n,o*(f/h),s*(h/f)];case 7:return[n-s*(h/f),1-t-o*(f/h),s*(h/f),o*(f/h)];case 8:return[t-s,n-o,s,o];case 9:return[1-n,t-s,o,s];case 10:return[1-t,1-n,s,o];case 11:return[n-o,1-t,o,s];case 12:return[t-o*(f/h),n,o*(f/h),s*(h/f)];case 13:return[1-n-s*(h/f),t-o*(f/h),s*(h/f),o*(f/h)];case 14:return[1-t,1-n-s*(h/f),o*(f/h),s*(h/f)];case 15:return[n,1-t,s*(h/f),o*(f/h)];default:return[t,n,s,o]}},ce(Ae,"_currentDrawId",-1),ce(Ae,"_currentParent",null),R(Ae,Mn,null),R(Ae,qu,null),R(Ae,$u,null),R(Ae,Kl,NaN),R(Ae,Jl,null),R(Ae,jl,null),R(Ae,Yu,NaN),ce(Ae,"_INNER_MARGIN",3);let Tb=Ae;var eo,Dn,kn,Xu,qf,gi,Wn,Ws,Wu,Ku,Ju,$f,jv;class T8{constructor(e,t,n,s,o,l){R(this,$f);R(this,eo,new Float64Array(6));R(this,Dn);R(this,kn);R(this,Xu);R(this,qf);R(this,gi);R(this,Wn,"");R(this,Ws,0);R(this,Wu,new Ly);R(this,Ku);R(this,Ju);E(this,Ku,n),E(this,Ju,s),E(this,Xu,o),E(this,qf,l),[e,t]=M(this,$f,jv).call(this,e,t);const c=E(this,Dn,[NaN,NaN,NaN,NaN,e,t]);E(this,gi,[e,t]),E(this,kn,[{line:c,points:d(this,gi)}]),d(this,eo).set(c,0)}updateProperty(e,t){e==="stroke-width"&&E(this,qf,t)}isEmpty(){return!d(this,kn)||d(this,kn).length===0}isCancellable(){return d(this,gi).length<=10}add(e,t){[e,t]=M(this,$f,jv).call(this,e,t);const[n,s,o,l]=d(this,eo).subarray(2,6),c=e-o,h=t-l;return Math.hypot(d(this,Ku)*c,d(this,Ju)*h)<=2?null:(d(this,gi).push(e,t),isNaN(n)?(d(this,eo).set([o,l,e,t],2),d(this,Dn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(d(this,eo)[0])&&d(this,Dn).splice(6,6),d(this,eo).set([n,s,o,l,e,t],0),d(this,Dn).push(...ve.createBezierPoints(n,s,o,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(d(this,gi).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){E(this,Ku,n),E(this,Ju,s),E(this,Xu,o),[e,t]=M(this,$f,jv).call(this,e,t);const l=E(this,Dn,[NaN,NaN,NaN,NaN,e,t]);E(this,gi,[e,t]);const c=d(this,kn).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),d(this,kn).push({line:l,points:d(this,gi)}),d(this,eo).set(l,0),E(this,Ws,0),this.toSVGPath(),null}getLastElement(){return d(this,kn).at(-1)}setLastElement(e){return d(this,kn)?(d(this,kn).push(e),E(this,Dn,e.line),E(this,gi,e.points),E(this,Ws,0),{path:{d:this.toSVGPath()}}):d(this,Wu).setLastElement(e)}removeLastElement(){if(!d(this,kn))return d(this,Wu).removeLastElement();d(this,kn).pop(),E(this,Wn,"");for(let e=0,t=d(this,kn).length;e<t;e++){const{line:n,points:s}=d(this,kn)[e];E(this,Dn,n),E(this,gi,s),E(this,Ws,0),this.toSVGPath()}return{path:{d:d(this,Wn)}}}toSVGPath(){const e=ve.svgRound(d(this,Dn)[4]),t=ve.svgRound(d(this,Dn)[5]);if(d(this,gi).length===2)return E(this,Wn,`${d(this,Wn)} M ${e} ${t} Z`),d(this,Wn);if(d(this,gi).length<=6){const s=d(this,Wn).lastIndexOf("M");E(this,Wn,`${d(this,Wn).slice(0,s)} M ${e} ${t}`),E(this,Ws,6)}if(d(this,gi).length===4){const s=ve.svgRound(d(this,Dn)[10]),o=ve.svgRound(d(this,Dn)[11]);return E(this,Wn,`${d(this,Wn)} L ${s} ${o}`),E(this,Ws,12),d(this,Wn)}const n=[];d(this,Ws)===0&&(n.push(`M ${e} ${t}`),E(this,Ws,6));for(let s=d(this,Ws),o=d(this,Dn).length;s<o;s+=6){const[l,c,h,f,g,y]=d(this,Dn).slice(s,s+6).map(ve.svgRound);n.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}return E(this,Wn,d(this,Wn)+n.join(" ")),E(this,Ws,d(this,Dn).length),d(this,Wn)}getOutlines(e,t,n,s){const o=d(this,kn).at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),d(this,Wu).build(d(this,kn),e,t,n,d(this,Xu),d(this,qf),s),E(this,eo,null),E(this,Dn,null),E(this,kn,null),E(this,Wn,null),d(this,Wu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}eo=new WeakMap,Dn=new WeakMap,kn=new WeakMap,Xu=new WeakMap,qf=new WeakMap,gi=new WeakMap,Wn=new WeakMap,Ws=new WeakMap,Wu=new WeakMap,Ku=new WeakMap,Ju=new WeakMap,$f=new WeakSet,jv=function(e,t){return ve._normalizePoint(e,t,d(this,Ku),d(this,Ju),d(this,Xu))};var mi,Cy,xy,ps,to,no,Yf,Xf,ju,Jn,Oo,I2,N2,M2;class Ly extends ve{constructor(){super(...arguments);R(this,Jn);R(this,mi);R(this,Cy,0);R(this,xy);R(this,ps);R(this,to);R(this,no);R(this,Yf);R(this,Xf);R(this,ju)}build(t,n,s,o,l,c,h){E(this,to,n),E(this,no,s),E(this,Yf,o),E(this,Xf,l),E(this,ju,c),E(this,xy,h??0),E(this,ps,t),M(this,Jn,N2).call(this)}get thickness(){return d(this,ju)}setLastElement(t){return d(this,ps).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return d(this,ps).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of d(this,ps)){if(t.push(`M${ve.svgRound(n[4])} ${ve.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${ve.svgRound(n[10])} ${ve.svgRound(n[11])}`);continue}for(let s=6,o=n.length;s<o;s+=6){const[l,c,h,f,g,y]=n.subarray(s,s+6).map(ve.svgRound);t.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}}return t.join("")}serialize([t,n,s,o],l){const c=[],h=[],[f,g,y,b]=M(this,Jn,I2).call(this);let A,w,C,N,I,P,k,L,O;switch(d(this,Xf)){case 0:O=ve._rescale,A=t,w=n+o,C=s,N=-o,I=t+f*s,P=n+(1-g-b)*o,k=t+(f+y)*s,L=n+(1-g)*o;break;case 90:O=ve._rescaleAndSwap,A=t,w=n,C=s,N=o,I=t+g*s,P=n+f*o,k=t+(g+b)*s,L=n+(f+y)*o;break;case 180:O=ve._rescale,A=t+s,w=n,C=-s,N=o,I=t+(1-f-y)*s,P=n+g*o,k=t+(1-f)*s,L=n+(g+b)*o;break;case 270:O=ve._rescaleAndSwap,A=t+s,w=n+o,C=-s,N=-o,I=t+(1-g-b)*s,P=n+(1-f-y)*o,k=t+(1-g)*s,L=n+(1-f)*o;break}for(const{line:U,points:F}of d(this,ps))c.push(O(U,A,w,C,N,l?new Array(U.length):null)),h.push(O(F,A,w,C,N,l?new Array(F.length):null));return{lines:c,points:h,rect:[I,P,k,L]}}static deserialize(t,n,s,o,l,{paths:{lines:c,points:h},rotation:f,thickness:g}){const y=[];let b,A,w,C,N;switch(f){case 0:N=ve._rescale,b=-t/s,A=n/o+1,w=1/s,C=-1/o;break;case 90:N=ve._rescaleAndSwap,b=-n/o,A=-t/s,w=1/o,C=1/s;break;case 180:N=ve._rescale,b=t/s+1,A=-n/o,w=-1/s,C=1/o;break;case 270:N=ve._rescaleAndSwap,b=n/o+1,A=t/s+1,w=-1/o,C=-1/s;break}if(!c){c=[];for(const P of h){const k=P.length;if(k===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1]]));continue}if(k===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1],NaN,NaN,NaN,NaN,P[2],P[3]]));continue}const L=new Float32Array(3*(k-2));c.push(L);let[O,U,F,K]=P.subarray(0,4);L.set([NaN,NaN,NaN,NaN,O,U],0);for(let q=4;q<k;q+=2){const Q=P[q],ee=P[q+1];L.set(ve.createBezierPoints(O,U,F,K,Q,ee),(q-2)*3),[O,U,F,K]=[F,K,Q,ee]}}}for(let P=0,k=c.length;P<k;P++)y.push({line:N(c[P].map(L=>L??NaN),b,A,w,C),points:N(h[P].map(L=>L??NaN),b,A,w,C)});const I=new this.prototype.constructor;return I.build(y,s,o,1,f,g,l),I}get box(){return d(this,mi)}updateProperty(t,n){return t==="stroke-width"?M(this,Jn,M2).call(this,n):null}updateParentDimensions([t,n],s){const[o,l]=M(this,Jn,Oo).call(this);E(this,to,t),E(this,no,n),E(this,Yf,s);const[c,h]=M(this,Jn,Oo).call(this),f=c-o,g=h-l,y=d(this,mi);return y[0]-=f,y[1]-=g,y[2]+=2*f,y[3]+=2*g,y}updateRotation(t){return E(this,Cy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return d(this,mi).map(ve.svgRound).join(" ")}get defaultProperties(){const[t,n]=d(this,mi);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=d(this,mi);let s=0,o=0,l=0,c=0,h=0,f=0;switch(d(this,Cy)){case 90:o=n/t,l=-t/n,h=t;break;case 180:s=-1,c=-1,h=t,f=n;break;case 270:o=-n/t,l=t/n,f=n;break;default:return""}return`matrix(${s} ${o} ${l} ${c} ${ve.svgRound(h)} ${ve.svgRound(f)})`}getPathResizingSVGProperties([t,n,s,o]){const[l,c]=M(this,Jn,Oo).call(this),[h,f,g,y]=d(this,mi);if(Math.abs(g-l)<=ve.PRECISION||Math.abs(y-c)<=ve.PRECISION){const N=t+s/2-(h+g/2),I=n+o/2-(f+y/2);return{path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${I})`}}}const b=(s-2*l)/(g-2*l),A=(o-2*c)/(y-2*c),w=g/s,C=y/o;return{path:{"transform-origin":`${ve.svgRound(h)} ${ve.svgRound(f)}`,transform:`${this.rotationTransform} scale(${w} ${C}) translate(${ve.svgRound(l)} ${ve.svgRound(c)}) scale(${b} ${A}) translate(${ve.svgRound(-l)} ${ve.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,s,o]){const[l,c]=M(this,Jn,Oo).call(this),h=d(this,mi),[f,g,y,b]=h;if(h[0]=t,h[1]=n,h[2]=s,h[3]=o,Math.abs(y-l)<=ve.PRECISION||Math.abs(b-c)<=ve.PRECISION){const I=t+s/2-(f+y/2),P=n+o/2-(g+b/2);for(const{line:k,points:L}of d(this,ps))ve._translate(k,I,P,k),ve._translate(L,I,P,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(s-2*l)/(y-2*l),w=(o-2*c)/(b-2*c),C=-A*(f+l)+t+l,N=-w*(g+c)+n+c;if(A!==1||w!==1||C!==0||N!==0)for(const{line:I,points:P}of d(this,ps))ve._rescale(I,C,N,A,w,I),ve._rescale(P,C,N,A,w,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],s){const[o,l]=s,c=d(this,mi),h=t-c[0],f=n-c[1];if(d(this,to)===o&&d(this,no)===l)for(const{line:g,points:y}of d(this,ps))ve._translate(g,h,f,g),ve._translate(y,h,f,y);else{const g=d(this,to)/o,y=d(this,no)/l;E(this,to,o),E(this,no,l);for(const{line:b,points:A}of d(this,ps))ve._rescale(b,h,f,g,y,b),ve._rescale(A,h,f,g,y,A);c[2]*=g,c[3]*=y}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get defaultSVGProperties(){const t=d(this,mi);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t[0])} ${ve.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}mi=new WeakMap,Cy=new WeakMap,xy=new WeakMap,ps=new WeakMap,to=new WeakMap,no=new WeakMap,Yf=new WeakMap,Xf=new WeakMap,ju=new WeakMap,Jn=new WeakSet,Oo=function(t=d(this,ju)){const n=d(this,xy)+t/2*d(this,Yf);return d(this,Xf)%180===0?[n/d(this,to),n/d(this,no)]:[n/d(this,no),n/d(this,to)]},I2=function(){const[t,n,s,o]=d(this,mi),[l,c]=M(this,Jn,Oo).call(this,0);return[t+l,n+c,s-2*l,o-2*c]},N2=function(){const t=E(this,mi,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:o}of d(this,ps)){if(o.length<=12){for(let h=4,f=o.length;h<f;h+=6)be.pointBoundingBox(o[h],o[h+1],t);continue}let l=o[4],c=o[5];for(let h=6,f=o.length;h<f;h+=6){const[g,y,b,A,w,C]=o.subarray(h,h+6);be.bezierBoundingBox(l,c,g,y,b,A,w,C,t),l=w,c=C}}const[n,s]=M(this,Jn,Oo).call(this);t[0]=li(t[0]-n,0,1),t[1]=li(t[1]-s,0,1),t[2]=li(t[2]+n,0,1),t[3]=li(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},M2=function(t){const[n,s]=M(this,Jn,Oo).call(this);E(this,ju,t);const[o,l]=M(this,Jn,Oo).call(this),[c,h]=[o-n,l-s],f=d(this,mi);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f};class f_ extends x2{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Bt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new f_(this._viewParameters);return e.updateAll(this),e}}var Zb,D2;const mh=class mh extends Tb{constructor(t){super({...t,name:"inkEditor"});R(this,Zb);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Bt.initialize(t,n),this._defaultDrawingOptions=new f_(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[tt.INK_THICKNESS,"stroke-width"],[tt.INK_COLOR,"stroke"],[tt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,s,o,l){return new T8(t,n,s,o,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,s,o,l,c){return Ly.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){let o=null;if(t instanceof Gw){const{data:{inkLists:c,rect:h,rotation:f,id:g,color:y,opacity:b,borderStyle:{rawWidth:A},popupRef:w,richText:C,contentsObj:N,creationDate:I,modificationDate:P},parent:{page:{pageNumber:k}}}=t;o=t={annotationType:Oe.INK,color:Array.from(y),thickness:A,opacity:b,paths:{points:c},boxes:null,pageIndex:k-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:w,richText:C,comment:(N==null?void 0:N.str)||null,creationDate:I,modificationDate:P}}const l=await super.deserialize(t,n,s);return l._initialData=o,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Sb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return tt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:s}){this._drawingOptions=mh.getDefaultDrawingOptions({stroke:be.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":c}}=this,h=Object.assign(super.serialize(t),{color:Bt._colorManager.convert(o),opacity:l,thickness:c,paths:{lines:n,points:s}});return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!M(this,Zb,D2).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};Zb=new WeakSet,D2=function(t){const{color:n,thickness:s,opacity:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,h)=>c!==n[h])||t.thickness!==s||t.opacity!==o||t.pageIndex!==l},ce(mh,"_type","ink"),ce(mh,"_editorType",Oe.INK),ce(mh,"_defaultDrawingOptions",null);let GT=mh;class zT extends Ly{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Av=8,cg=3;var Qu,ft,VT,mr,k2,P2,qT,Qv,L2,O2,U2,$T,YT,F2;class oo{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,l,c,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const y=200,b=g.font=`${n} ${s} ${y}px ${t}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:C,actualBoundingBoxDescent:N,fontBoundingBoxAscent:I,fontBoundingBoxDescent:P,width:k}=g.measureText(e),L=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,k)*L),U=Math.ceil(Math.max(Math.abs(C)+Math.abs(N)||y,Math.abs(I)+Math.abs(P)||y)*L);f=new OffscreenCanvas(O,U),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,U),g.fillStyle="black",g.fillText(e,O*(L-1)/2,U*(3-L)/2);const F=M(this,ft,$T).call(this,g.getImageData(0,0,O,U).data),K=M(this,ft,U2).call(this,F),q=M(this,ft,YT).call(this,K),Q=M(this,ft,qT).call(this,F,O,U,q);return this.processDrawnLines({lines:{curves:Q,width:O,height:U},pageWidth:o,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[l,c,h]=M(this,ft,F2).call(this,e),[f,g]=M(this,ft,O2).call(this,l,c,h,Math.hypot(c,h)*d(this,Qu).sigmaSFactor,d(this,Qu).sigmaR,d(this,Qu).kernelSize),y=M(this,ft,YT).call(this,g),b=M(this,ft,qT).call(this,f,c,h,y);return this.processDrawnLines({lines:{curves:b,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:l,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:g}=e,y=e.thickness??0,b=[],A=Math.min(t/f,n/g),w=A/t,C=A/n,N=[];for(const{points:P}of h){const k=l?M(this,ft,L2).call(this,P):P;if(!k)continue;N.push(k);const L=k.length,O=new Float32Array(L),U=new Float32Array(3*(L===2?2:L-2));if(b.push({line:U,points:O}),L===2){O[0]=k[0]*w,O[1]=k[1]*C,U.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[F,K,q,Q]=k;F*=w,K*=C,q*=w,Q*=C,O.set([F,K,q,Q],0),U.set([NaN,NaN,NaN,NaN,F,K],0);for(let ee=4;ee<L;ee+=2){const se=O[ee]=k[ee]*w,le=O[ee+1]=k[ee+1]*C;U.set(ve.createBezierPoints(F,K,q,Q,se,le),(ee-2)*3),[F,K,q,Q]=[q,Q,se,le]}}if(b.length===0)return null;const I=c?new zT:new Ly;return I.build(b,t,n,1,s,c?0:y,o),{outline:I,newCurves:N,areContours:c,thickness:y,width:f,height:g}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let l=1/0,c=-1/0,h=0;for(const k of e){h+=k.length;for(let L=2,O=k.length;L<O;L++){const U=k[L]-k[L-2];l=Math.min(l,U),c=Math.max(c,U)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const g=e.length,y=Av+cg*g,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=s,b[A++]=o,b[A++]=t?0:1,b[A++]=Math.max(0,Math.floor(n??0)),b[A++]=g,b[A++]=f.BYTES_PER_ELEMENT;for(const k of e)b[A++]=k.length-2,b[A++]=k[0],b[A++]=k[1];const w=new CompressionStream("deflate-raw"),C=w.writable.getWriter();await C.ready,C.write(b);const N=f.prototype.constructor;for(const k of e){const L=new N(k.length-2);for(let O=2,U=k.length;O<U;O++)L[O-2]=k[O]-k[O-2];C.write(L)}C.close();const I=await new Response(w.readable).arrayBuffer(),P=new Uint8Array(I);return Lk(P)}static async decompressSignature(e){try{const t=KV(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,c=0;for await(const k of n)l||(l=new Uint8Array(new Uint32Array(k.buffer,0,4)[0])),l.set(k,c),c+=k.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],y=h[3],b=h[4]===0,A=h[5],w=h[6],C=h[7],N=[],I=(Av+cg*w)*Uint32Array.BYTES_PER_ELEMENT;let P;switch(C){case Int8Array.BYTES_PER_ELEMENT:P=new Int8Array(l.buffer,I);break;case Int16Array.BYTES_PER_ELEMENT:P=new Int16Array(l.buffer,I);break;case Int32Array.BYTES_PER_ELEMENT:P=new Int32Array(l.buffer,I);break}c=0;for(let k=0;k<w;k++){const L=h[cg*k+Av],O=new Float32Array(L+2);N.push(O);for(let U=0;U<cg-1;U++)O[U]=h[cg*k+Av+U+1];for(let U=0;U<L;U++)O[U+2]=O[U]+P[c++]}return{areContours:b,thickness:A,outlines:N,width:g,height:y}}catch(t){return Ue(`decompressSignature: ${t}`),null}}}Qu=new WeakMap,ft=new WeakSet,VT=function(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s},mr=new WeakMap,k2=function(e,t,n,s,o,l,c){const h=M(this,ft,VT).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(-f+h-c+16)%8,y=d(this,mr)[2*g],b=d(this,mr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},P2=function(e,t,n,s,o,l,c){const h=M(this,ft,VT).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(f+h+c+16)%8,y=d(this,mr)[2*g],b=d(this,mr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},qT=function(e,t,n,s){const o=e.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=e[g]<=s?1:0;for(let g=1;g<n-1;g++)l[g*t]=l[g*t+t-1]=0;for(let g=0;g<t;g++)l[g]=l[t*n-1-g]=0;let c=1,h;const f=[];for(let g=1;g<n-1;g++){h=1;for(let y=1;y<t-1;y++){const b=g*t+y,A=l[b];if(A===0)continue;let w=g,C=y;if(A===1&&l[b-1]===0)c+=1,C-=1;else if(A>=1&&l[b+1]===0)c+=1,C+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const N=[y,g],I=C===y+1,P={isHole:I,points:N,id:c,parent:0};f.push(P);let k;for(const ee of f)if(ee.id===h){k=ee;break}k?k.isHole?P.parent=I?k.parent:h:P.parent=I?h:k.parent:P.parent=I?h:0;const L=M(this,ft,k2).call(this,l,t,g,y,w,C,0);if(L===-1){l[b]=-c,l[b]!==1&&(h=Math.abs(l[b]));continue}let O=d(this,mr)[2*L],U=d(this,mr)[2*L+1];const F=g+O,K=y+U;w=F,C=K;let q=g,Q=y;for(;;){const ee=M(this,ft,P2).call(this,l,t,q,Q,w,C,1);O=d(this,mr)[2*ee],U=d(this,mr)[2*ee+1];const se=q+O,le=Q+U;N.push(le,se);const ue=q*t+Q;if(l[ue+1]===0?l[ue]=-c:l[ue]===1&&(l[ue]=c),se===g&&le===y&&q===F&&Q===K){l[b]!==1&&(h=Math.abs(l[b]));break}else w=q,C=Q,q=se,Q=le}}}return f},Qv=function(e,t,n,s){if(n-t<=4){for(let F=t;F<n-2;F+=2)s.push(e[F],e[F+1]);return}const o=e[t],l=e[t+1],c=e[n-4]-o,h=e[n-3]-l,f=Math.hypot(c,h),g=c/f,y=h/f,b=g*l-y*o,A=h/c,w=1/f,C=Math.atan(A),N=Math.cos(C),I=Math.sin(C),P=w*(Math.abs(N)+Math.abs(I)),k=w*(1-P+P**2),L=Math.max(Math.atan(Math.abs(I+N)*k),Math.atan(Math.abs(I-N)*k));let O=0,U=t;for(let F=t+2;F<n-2;F+=2){const K=Math.abs(b-g*e[F+1]+y*e[F]);K>O&&(U=F,O=K)}O>(f*L)**2?(M(this,ft,Qv).call(this,e,t,U+2,s),M(this,ft,Qv).call(this,e,U,n,s)):s.push(o,l)},L2=function(e){const t=[],n=e.length;return M(this,ft,Qv).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},O2=function(e,t,n,s,o,l){const c=new Float32Array(l**2),h=-2*s**2,f=l>>1;for(let C=0;C<l;C++){const N=(C-f)**2;for(let I=0;I<l;I++)c[C*l+I]=Math.exp((N+(I-f)**2)/h)}const g=new Float32Array(256),y=-2*o**2;for(let C=0;C<256;C++)g[C]=Math.exp(C**2/y);const b=e.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let C=0;C<n;C++)for(let N=0;N<t;N++){const I=C*t+N,P=e[I];let k=0,L=0;for(let U=0;U<l;U++){const F=C+U-f;if(!(F<0||F>=n))for(let K=0;K<l;K++){const q=N+K-f;if(q<0||q>=t)continue;const Q=e[F*t+q],ee=c[U*l+K]*g[Math.abs(Q-P)];k+=Q*ee,L+=ee}}const O=A[I]=Math.round(k/L);w[O]++}return[A,w]},U2=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},$T=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const l=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*l;return n},YT=function(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let l=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-l>s&&(s=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t},F2=function(e){const t=e,{width:n,height:s}=e,{maxDim:o}=d(this,Qu);let l=n,c=s;if(n>o||s>o){let b=n,A=s,w=Math.log2(Math.max(n,s)/o);const C=Math.floor(w);w=w===C?C-1:C;for(let I=0;I<w;I++){l=Math.ceil(b/2),c=Math.ceil(A/2);const P=new OffscreenCanvas(l,c);P.getContext("2d").drawImage(e,0,0,b,A,0,0,l,c),b=l,A=c,e!==t&&e.close(),e=P.transferToImageBitmap()}const N=Math.min(o/l,o/c);l=Math.round(l*N),c=Math.round(c*N)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,l,c);const g=f.getImageData(0,0,l,c).data;return[M(this,ft,$T).call(this,g),l,c]},R(oo,ft),R(oo,Qu,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),R(oo,mr,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class Vw extends x2{constructor(){super(),super.updateProperties({fill:Bt._defaultLineColor,"stroke-width":0})}clone(){const e=new Vw;return e.updateAll(this),e}}class qw extends f_{constructor(e){super(e),super.updateProperties({stroke:Bt._defaultLineColor,"stroke-width":1})}clone(){const e=new qw(this._viewParameters);return e.updateAll(this),e}}var Ql,io,Zl,Zu;const Qi=class Qi extends Tb{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});R(this,Ql,!1);R(this,io,null);R(this,Zl,null);R(this,Zu,null);this._willKeepAspectRatio=!0,E(this,Zl,t.signatureData||null),E(this,io,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Bt.initialize(t,n),this._defaultDrawingOptions=new Vw,this._defaultDrawnSignatureOptions=new qw(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ve(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!d(this,io)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(d(this,Zl)){const{lines:o,mustSmooth:l,areContours:c,description:h,uuid:f,heightInPage:g}=d(this,Zl),{rawDims:{pageWidth:y,pageHeight:b},rotation:A}=this.parent.viewport,w=oo.processDrawnLines({lines:o,pageWidth:y,pageHeight:b,rotation:A,innerMargin:Qi._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(w,g,h,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:d(this,io)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){E(this,Zu,t),this.addEditToolbar()}getUuid(){return d(this,Zu)}get description(){return d(this,io)}set description(t){E(this,io,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:s,width:o,height:l}=d(this,Zl),c=Math.max(o,l),h=oo.processDrawnLines({lines:{curves:t.map(f=>({points:f})),thickness:s,width:o,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,s,o){const{x:l,y:c}=this,{outline:h}=E(this,Zl,t);E(this,Ql,h instanceof zT),this.description=s;let f;d(this,Ql)?f=Qi.getDefaultDrawingOptions():(f=Qi._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:f});const[,g]=this.pageDimensions;let y=n/g;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(o),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!o,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return oo.process(t,n,s,o,Qi._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:s,pageHeight:o},rotation:l}=this.parent.viewport;return oo.extractContoursFromText(t,n,s,o,l,Qi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return oo.processDrawnLines({lines:t,pageWidth:n,pageHeight:s,rotation:o,innerMargin:Qi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=Qi.getDefaultDrawingOptions():(this._drawingOptions=Qi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:d(this,Ql),color:[0,0,0],thickness:d(this,Ql)?0:o});return this.addComment(l),t?(l.paths={lines:n,points:s},l.uuid=d(this,Zu),l.isCopy=!0):l.lines=n,d(this,io)&&(l.accessibilityData={type:"Figure",alt:d(this,io)}),l}static deserializeDraw(t,n,s,o,l,c){return c.areContours?zT.deserialize(t,n,s,o,l,c):Ly.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){var l;const o=await super.deserialize(t,n,s);return E(o,Ql,t.areContours),o.description=((l=t.accessibilityData)==null?void 0:l.alt)||"",E(o,Zu,t.uuid),o}};Ql=new WeakMap,io=new WeakMap,Zl=new WeakMap,Zu=new WeakMap,ce(Qi,"_type","signature"),ce(Qi,"_editorType",Oe.SIGNATURE),ce(Qi,"_defaultDrawingOptions",null);let XT=Qi;var Xt,Pn,ec,pa,tc,Wf,ga,ed,so,gs,Kf,at,Ng,Mg,Zv,eb,tb,KT,nb,B2;class WT extends Bt{constructor(t){super({...t,name:"stampEditor"});R(this,at);R(this,Xt,null);R(this,Pn,null);R(this,ec,null);R(this,pa,null);R(this,tc,null);R(this,Wf,"");R(this,ga,null);R(this,ed,!1);R(this,so,null);R(this,gs,!1);R(this,Kf,!1);E(this,pa,t.bitmapUrl),E(this,tc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Bt.initialize(t,n)}static isHandlingMimeForPasting(t){return mb.includes(t)}static paste(t,n){n.pasteEditor({mode:Oe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:o,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,h=await s.guess({name:"altText",request:{data:o,width:l,height:c,channels:o.length/(l*c)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const f=h.output;return await this.setGuessedAltText(f),n&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var t;d(this,Pn)&&(E(this,Xt,null),this._uiManager.imageManager.deleteId(d(this,Pn)),(t=d(this,ga))==null||t.remove(),E(this,ga,null),d(this,so)&&(clearTimeout(d(this,so)),E(this,so,null))),super.remove()}rebuild(){if(!this.parent){d(this,Pn)&&M(this,at,Zv).call(this);return}super.rebuild(),this.div!==null&&(d(this,Pn)&&d(this,ga)===null&&M(this,at,Zv).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(d(this,ec)||d(this,Xt)||d(this,pa)||d(this,tc)||d(this,Pn)||d(this,ed))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),d(this,ed)||(d(this,Xt)?M(this,at,eb).call(this):M(this,at,Zv).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:s,bitmap:o}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(E(this,Pn,s),o&&E(this,Xt,o),E(this,ed,!1),M(this,at,eb).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;d(this,so)!==null&&clearTimeout(d(this,so)),E(this,so,setTimeout(()=>{E(this,so,null),M(this,at,KT).call(this)},200))}copyCanvas(t,n,s=!1){t||(t=224);const{width:o,height:l}=d(this,Xt),c=new Tr;let h=d(this,Xt),f=o,g=l,y=null;if(n){if(o>n||l>n){const F=Math.min(n/o,n/l);f=Math.floor(o*F),g=Math.floor(l*F)}y=document.createElement("canvas");const A=y.width=Math.ceil(f*c.sx),w=y.height=Math.ceil(g*c.sy);d(this,gs)||(h=M(this,at,tb).call(this,A,w));const C=y.getContext("2d");C.filter=this._uiManager.hcmFilter;let N="white",I="#cfcfd8";this._uiManager.hcmFilter!=="none"?I="black":QV.isDarkMode&&(N="#8f8f9d",I="#42414d");const P=15,k=P*c.sx,L=P*c.sy,O=new OffscreenCanvas(k*2,L*2),U=O.getContext("2d");U.fillStyle=N,U.fillRect(0,0,k*2,L*2),U.fillStyle=I,U.fillRect(0,0,k,L),U.fillRect(k,L,k,L),C.fillStyle=C.createPattern(O,"repeat"),C.fillRect(0,0,A,w),C.drawImage(h,0,0,h.width,h.height,0,0,A,w)}let b=null;if(s){let A,w;if(c.symmetric&&h.width<t&&h.height<t)A=h.width,w=h.height;else if(h=d(this,Xt),o>t||l>t){const I=Math.min(t/o,t/l);A=Math.floor(o*I),w=Math.floor(l*I),d(this,gs)||(h=M(this,at,tb).call(this,A,w))}const N=new OffscreenCanvas(A,w).getContext("2d",{willReadFrequently:!0});N.drawImage(h,0,0,h.width,h.height,0,0,A,w),b={width:A,height:w,data:N.getImageData(0,0,A,w).data}}return{canvas:y,width:f,height:g,imageData:b}}static async deserialize(t,n,s){var N;let o=null,l=!1;if(t instanceof t2){const{data:{rect:I,rotation:P,id:k,structParent:L,popupRef:O,richText:U,contentsObj:F,creationDate:K,modificationDate:q},container:Q,parent:{page:{pageNumber:ee}},canvas:se}=t;let le,ue;se?(delete t.canvas,{id:le,bitmap:ue}=s.imageManager.getFromCanvas(Q.id,se),se.remove()):(l=!0,t._hasNoCanvas=!0);const me=((N=await n._structTree.getAriaAttributes(`${Mw}${k}`))==null?void 0:N.get("aria-label"))||"";o=t={annotationType:Oe.STAMP,bitmapId:le,bitmap:ue,pageIndex:ee-1,rect:I.slice(0),rotation:P,annotationElementId:k,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:me},isSvg:!1,structParent:L,popupRef:O,richText:U,comment:(F==null?void 0:F.str)||null,creationDate:K,modificationDate:q}}const c=await super.deserialize(t,n,s),{rect:h,bitmap:f,bitmapUrl:g,bitmapId:y,isSvg:b,accessibilityData:A}=t;l?(s.addMissingCanvas(t.id,c),E(c,ed,!0)):y&&s.imageManager.isValidId(y)?(E(c,Pn,y),f&&E(c,Xt,f)):E(c,pa,g),E(c,gs,b);const[w,C]=c.pageDimensions;return c.width=(h[2]-h[0])/w,c.height=(h[3]-h[1])/C,A&&(c.altTextData=A),c._initialData=o,t.comment&&c.setCommentData(t),E(c,Kf,!!o),c}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:d(this,Pn),isSvg:d(this,gs)});if(this.addComment(s),t)return s.bitmapUrl=M(this,at,nb).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:o,altText:l}=this.serializeAltText(!1);if(!o&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=M(this,at,B2).call(this,s);return h.isSame?null:(h.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(n===null)return s;n.stamps||(n.stamps=new Map);const c=d(this,gs)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!n.stamps.has(d(this,Pn)))n.stamps.set(d(this,Pn),{area:c,serialized:s}),s.bitmap=M(this,at,nb).call(this,!1);else if(d(this,gs)){const h=n.stamps.get(d(this,Pn));c>h.area&&(h.area=c,h.serialized.bitmap.close(),h.serialized.bitmap=M(this,at,nb).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Xt=new WeakMap,Pn=new WeakMap,ec=new WeakMap,pa=new WeakMap,tc=new WeakMap,Wf=new WeakMap,ga=new WeakMap,ed=new WeakMap,so=new WeakMap,gs=new WeakMap,Kf=new WeakMap,at=new WeakSet,Ng=function(t,n=!1){if(!t){this.remove();return}E(this,Xt,t.bitmap),n||(E(this,Pn,t.id),E(this,gs,t.isSvg)),t.file&&E(this,Wf,t.file.name),M(this,at,eb).call(this)},Mg=function(){if(E(this,ec,null),this._uiManager.enableWaiting(!1),!!d(this,ga)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Xt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Xt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Zv=function(){if(d(this,Pn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(d(this,Pn)).then(s=>M(this,at,Ng).call(this,s,!0)).finally(()=>M(this,at,Mg).call(this));return}if(d(this,pa)){const s=d(this,pa);E(this,pa,null),this._uiManager.enableWaiting(!0),E(this,ec,this._uiManager.imageManager.getFromUrl(s).then(o=>M(this,at,Ng).call(this,o)).finally(()=>M(this,at,Mg).call(this)));return}if(d(this,tc)){const s=d(this,tc);E(this,tc,null),this._uiManager.enableWaiting(!0),E(this,ec,this._uiManager.imageManager.getFromFile(s).then(o=>M(this,at,Ng).call(this,o)).finally(()=>M(this,at,Mg).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=mb.join(",");const n=this._uiManager._signal;E(this,ec,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,at,Ng).call(this,o)}s()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:n})}).finally(()=>M(this,at,Mg).call(this))),t.click()},eb=function(){var f;const{div:t}=this;let{width:n,height:s}=d(this,Xt);const[o,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*o,s=this.height*l;else if(n>c*o||s>c*l){const g=Math.min(c*o/n,c*l/s);n*=g,s*=g}this._uiManager.enableWaiting(!1);const h=E(this,ga,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/o,this.height=s/l,this.setDims(),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),M(this,at,KT).call(this),d(this,Kf)||(this.parent.addUndoableEditor(this),E(this,Kf,!0)),this._reportTelemetry({action:"inserted_image"}),d(this,Wf)&&this.div.setAttribute("aria-description",d(this,Wf)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},tb=function(t,n){const{width:s,height:o}=d(this,Xt);let l=s,c=o,h=d(this,Xt);for(;l>2*t||c>2*n;){const f=l,g=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const y=new OffscreenCanvas(l,c);y.getContext("2d").drawImage(h,0,0,f,g,0,0,l,c),h=y.transferToImageBitmap()}return h},KT=function(){const[t,n]=this.parentDimensions,{width:s,height:o}=this,l=new Tr,c=Math.ceil(s*t*l.sx),h=Math.ceil(o*n*l.sy),f=d(this,ga);if(!f||f.width===c&&f.height===h)return;f.width=c,f.height=h;const g=d(this,gs)?d(this,Xt):M(this,at,tb).call(this,c,h),y=f.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(g,0,0,g.width,g.height,0,0,c,h)},nb=function(t){if(t){if(d(this,gs)){const o=this._uiManager.imageManager.getSvgUrl(d(this,Pn));if(o)return o}const n=document.createElement("canvas");return{width:n.width,height:n.height}=d(this,Xt),n.getContext("2d").drawImage(d(this,Xt),0,0),n.toDataURL()}if(d(this,gs)){const[n,s]=this.pageDimensions,o=Math.round(this.width*n*Ra.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Ra.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(o,l);return c.getContext("2d").drawImage(d(this,Xt),0,0,d(this,Xt).width,d(this,Xt).height,0,0,o,l),c.transferToImageBitmap()}return structuredClone(d(this,Xt))},B2=function(t){var c;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,o=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&o&&l,isSameAltText:l}},ce(WT,"_type","stamp"),ce(WT,"_editorType",Oe.STAMP);var td,Jf,nc,ic,ma,Gi,sc,jf,Qf,yr,ya,Ln,va,rc,Zf,we,oc,Ot,JT,H2,Lr,jT,QT,ib;const or=class or{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:g}){R(this,Ot);R(this,td);R(this,Jf,!1);R(this,nc,null);R(this,ic,null);R(this,ma,null);R(this,Gi,new Map);R(this,sc,!1);R(this,jf,!1);R(this,Qf,!1);R(this,yr,null);R(this,ya,null);R(this,Ln,null);R(this,va,null);R(this,rc,null);R(this,Zf,-1);R(this,we);const y=[...d(or,oc).values()];if(!or._initialized){or._initialized=!0;for(const b of y)b.initialize(g,e)}e.registerEditorTypes(y),E(this,we,e),this.pageIndex=t,this.div=n,E(this,td,o),E(this,nc,l),this.viewport=f,E(this,Ln,h),this.drawLayer=c,this._structTree=s,d(this,we).addLayer(this)}get isEmpty(){return d(this,Gi).size===0}get isInvisible(){return this.isEmpty&&d(this,we).getMode()===Oe.NONE}updateToolbar(e){d(this,we).updateToolbar(e)}updateMode(e=d(this,we).getMode()){switch(M(this,Ot,ib).call(this),e){case Oe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Oe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of d(or,oc).values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=d(this,Ln))==null?void 0:t.div)}setEditingState(e){d(this,we).setEditingState(e)}addCommands(e){d(this,we).addCommands(e)}cleanUndoStack(e){d(this,we).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=d(this,nc))==null||t.div.classList.toggle("disabled",!e)}async enable(){var n;E(this,Qf,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=d(this,rc))==null||n.abort(),E(this,rc,null);const e=new Set;for(const s of d(this,Ot,JT))s.enableEditing(),s.show(!0),s.annotationElementId&&(d(this,we).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=d(this,nc);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),d(this,we).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const o=await this.deserialize(s);o&&(this.addOrRebuild(o),o.enableEditing())}E(this,Qf,!1),d(this,we)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var n;if(E(this,jf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),d(this,Ln)&&!d(this,rc)){E(this,rc,new AbortController);const s=d(this,we).combinedSignal(d(this,rc));d(this,Ln).div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,g=d(this,Zf);if(f-g>500){E(this,Zf,f);return}E(this,Zf,-1);const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(c,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${Bg}[0-9]+$`);for(const N of b)if(w.test(N.id)){A=N.id;break}if(!A)return;const C=d(this,Gi).get(A);(C==null?void 0:C.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),C.dblclick(o))},{signal:s,capture:!0})}const e=d(this,nc);if(e){const s=new Map,o=new Map;for(const c of d(this,Ot,JT)){if(c.disableEditing(),!c.annotationElementId){c.updateFakeAnnotationElement(e);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);(n=this.getEditableAnnotation(c.annotationElementId))==null||n.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(d(this,we).isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=s.get(h),f&&(d(this,we).addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}M(this,Ot,ib).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const s of d(or,oc).values())t.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),E(this,jf,!1)}getEditableAnnotation(e){var t;return((t=d(this,nc))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){d(this,we).getActive()!==e&&d(this,we).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=d(this,Ln))!=null&&e.div&&!d(this,va)){E(this,va,new AbortController);const t=d(this,we).combinedSignal(d(this,va));d(this,Ln).div.addEventListener("pointerdown",M(this,Ot,H2).bind(this),{signal:t}),d(this,Ln).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=d(this,Ln))!=null&&e.div&&d(this,va)&&(d(this,va).abort(),E(this,va,null),d(this,Ln).div.classList.remove("highlighting"))}enableClick(){if(d(this,ic))return;E(this,ic,new AbortController);const e=d(this,we).combinedSignal(d(this,ic));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=d(this,ic))==null||e.abort(),E(this,ic,null)}attach(e){d(this,Gi).set(e.id,e);const{annotationElementId:t}=e;t&&d(this,we).isDeletedAnnotationElement(t)&&d(this,we).removeDeletedAnnotationElement(e)}detach(e){var t;d(this,Gi).delete(e.id),(t=d(this,td))==null||t.removePointerInTextLayer(e.contentDiv),!d(this,jf)&&e.annotationElementId&&d(this,we).addDeletedAnnotationElement(e)}remove(e){this.detach(e),d(this,we).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(d(this,we).addDeletedAnnotationElement(e.annotationElementId),Bt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),d(this,we).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!d(this,Qf)),d(this,we).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!d(this,ma)&&(e._focusEventsAllowed=!1,E(this,ma,setTimeout(()=>{E(this,ma,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:d(this,we)._signal}),t.focus())},0))),e._structTreeParentId=(n=d(this,td))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of d(this,Gi).values())if(t.uid===e)return t;return null}getNextId(){return d(this,we).getId()}combinedSignal(e){return d(this,we).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=d(this,Ot,Lr))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await d(this,we).updateMode(e.mode);const{offsetX:n,offsetY:s}=M(this,Ot,QT).call(this),o=this.getNextId(),l=M(this,Ot,jT).call(this,{parent:this,id:o,x:n,y:s,uiManager:d(this,we),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=d(or,oc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,d(this,we)))||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=M(this,Ot,jT).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:d(this,we),isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(M(this,Ot,QT).call(this),!0,e)}setSelected(e){d(this,we).setSelected(e)}toggleSelected(e){d(this,we).toggleSelected(e)}unselect(e){d(this,we).unselect(e)}pointerup(e){var s;const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!d(this,sc)||(E(this,sc,!1),(s=d(this,Ot,Lr))!=null&&s.isDrawer&&d(this,Ot,Lr).supportMultipleDrawings))return;if(!d(this,Jf)){E(this,Jf,!0);return}const n=d(this,we).getMode();if(n===Oe.STAMP||n===Oe.SIGNATURE){d(this,we).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(d(this,we).getMode()===Oe.HIGHLIGHT&&this.enableTextSelection(),d(this,sc)){E(this,sc,!1);return}const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(E(this,sc,!0),(s=d(this,Ot,Lr))!=null&&s.isDrawer){this.startDrawingSession(e);return}const n=d(this,we).getActive();E(this,Jf,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),d(this,yr)){d(this,Ot,Lr).startDrawing(this,d(this,we),!1,e);return}d(this,we).setCurrentDrawingSession(this),E(this,yr,new AbortController);const t=d(this,we).combinedSignal(d(this,yr));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(E(this,ya,null),this.commitOrRemove())},{signal:t}),d(this,Ot,Lr).startDrawing(this,d(this,we),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&E(this,ya,t);return}d(this,ya)&&setTimeout(()=>{var t;(t=d(this,ya))==null||t.focus(),E(this,ya,null)},0)}endDrawingSession(e=!1){return d(this,yr)?(d(this,we).setCurrentDrawingSession(null),d(this,yr).abort(),E(this,yr,null),E(this,ya,null),d(this,Ot,Lr).endDrawing(e)):null}findNewParent(e,t,n){const s=d(this,we).findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return d(this,yr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){d(this,yr)&&d(this,Ot,Lr).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=d(this,we).getActive())==null?void 0:e.parent)===this&&(d(this,we).commitOrRemove(),d(this,we).setActiveEditor(null)),d(this,ma)&&(clearTimeout(d(this,ma)),E(this,ma,null));for(const n of d(this,Gi).values())(t=d(this,td))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,d(this,Gi).clear(),d(this,we).removeLayer(this)}render({viewport:e}){this.viewport=e,uc(this.div,e);for(const t of d(this,we).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){d(this,we).commitOrRemove(),M(this,Ot,ib).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,uc(this.div,{rotation:n}),t!==n)for(const s of d(this,Gi).values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return d(this,we).viewParameters.realScale}};td=new WeakMap,Jf=new WeakMap,nc=new WeakMap,ic=new WeakMap,ma=new WeakMap,Gi=new WeakMap,sc=new WeakMap,jf=new WeakMap,Qf=new WeakMap,yr=new WeakMap,ya=new WeakMap,Ln=new WeakMap,va=new WeakMap,rc=new WeakMap,Zf=new WeakMap,we=new WeakMap,oc=new WeakMap,Ot=new WeakSet,JT=function(){return d(this,Gi).size!==0?d(this,Gi).values():d(this,we).getEditors(this.pageIndex)},H2=function(e){d(this,we).unselectAll();const{target:t}=e;if(t===d(this,Ln).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&d(this,Ln).div.contains(t)){const{isMac:n}=On.platform;if(e.button!==0||e.ctrlKey&&n)return;d(this,we).showAllEditors("highlight",!0,!0),d(this,Ln).div.classList.add("free"),this.toggleDrawing(),Eb.startHighlighting(this,d(this,we).direction==="ltr",{target:d(this,Ln).div,x:e.x,y:e.y}),d(this,Ln).div.addEventListener("pointerup",()=>{d(this,Ln).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:d(this,we)._signal}),e.preventDefault()}},Lr=function(){return d(or,oc).get(d(this,we).getMode())},jT=function(e){const t=d(this,Ot,Lr);return t?new t.prototype.constructor(e):null},QT=function(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,g=(l+h)/2-t,[y,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:y,offsetY:b}},ib=function(){for(const e of d(this,Gi).values())e.isEmpty()&&e.remove()},ce(or,"_initialized",!1),R(or,oc,new Map([MT,GT,WT,Eb,XT].map(e=>[e._editorType,e])));let wb=or;var vr,yi,nd,Ry,e_,G2,ho,ZT,z2,ew;const An=class An{constructor({pageIndex:e}){R(this,ho);R(this,vr,null);R(this,yi,new Map);R(this,nd,new Map);this.pageIndex=e}setParent(e){if(!d(this,vr)){E(this,vr,e);return}if(d(this,vr)!==e){if(d(this,yi).size>0)for(const t of d(this,yi).values())t.remove(),e.append(t);E(this,vr,e)}}static get _svgFactory(){return Ve(this,"_svgFactory",new Yg)}draw(e,t=!1,n=!1){const s=Sn(An,Ry)._++,o=M(this,ho,ZT).call(this),l=An._svgFactory.createElement("defs");o.append(l);const c=An._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&d(this,nd).set(s,c);const f=n?M(this,ho,z2).call(this,l,h):null,g=An._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(o,e),d(this,yi).set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=Sn(An,Ry)._++,s=M(this,ho,ZT).call(this),o=An._svgFactory.createElement("defs");s.append(o);const l=An._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const y=An._svgFactory.createElement("mask");o.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=An._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=An._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${c}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=An._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,e),d(this,yi).set(n,s),n}finalizeDraw(e,t){d(this,nd).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var h;if(!t)return;const{root:n,bbox:s,rootClass:o,path:l}=t,c=typeof e=="number"?d(this,yi).get(e):e;if(c){if(n&&M(this,ho,ew).call(this,c,n),s&&M(h=An,e_,G2).call(h,c,s),o){const{classList:f}=c;for(const[g,y]of Object.entries(o))f.toggle(g,y)}if(l){const g=c.firstChild.firstChild;M(this,ho,ew).call(this,g,l)}}}updateParent(e,t){if(t===this)return;const n=d(this,yi).get(e);n&&(d(t,vr).append(n),d(this,yi).delete(e),d(t,yi).set(e,n))}remove(e){d(this,nd).delete(e),d(this,vr)!==null&&(d(this,yi).get(e).remove(),d(this,yi).delete(e))}destroy(){E(this,vr,null);for(const e of d(this,yi).values())e.remove();d(this,yi).clear(),d(this,nd).clear()}};vr=new WeakMap,yi=new WeakMap,nd=new WeakMap,Ry=new WeakMap,e_=new WeakSet,G2=function(e,[t,n,s,o]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*o}%`},ho=new WeakSet,ZT=function(){const e=An._svgFactory.create(1,1,!0);return d(this,vr).append(e),e.setAttribute("aria-hidden",!0),e},z2=function(e,t){const n=An._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=An._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s},ew=function(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)},R(An,e_),R(An,Ry,0);let Cb=An;globalThis._pdfjsTestingUtils={HighlightOutliner:kT};globalThis.pdfjsLib={AbortException:xa,AnnotationEditorLayer:wb,AnnotationEditorParamsType:tt,AnnotationEditorType:Oe,AnnotationEditorUIManager:dc,AnnotationLayer:zw,AnnotationMode:ro,AnnotationType:cn,applyOpacity:Hk,build:VP,ColorPicker:$g,createValidAbsoluteUrl:Rw,CSSConstants:Bk,DOMSVGFactory:Yg,DrawLayer:Cb,FeatureTest:On,fetchData:ap,findContrastColor:Gk,getDocument:Uw,getFilenameFromUrl:Ok,getPdfFilenameFromUrl:Uk,getRGB:lp,getUuid:Nw,getXfaPageViewport:Fk,GlobalWorkerOptions:Ks,ImageKind:Lg,InvalidPDFException:gb,isDataScheme:Dy,isPdfFile:d_,isValidExplicitDest:_P,MathClamp:li,noContextMenu:As,normalizeUnicode:Pk,OPS:ep,OutputScale:Tr,PasswordResponses:Dk,PDFDataRangeTransport:Fw,PDFDateString:zg,PDFWorker:tp,PermissionFlag:Mk,PixelsPerInch:Ra,RenderingCancelledException:u_,renderRichText:kw,ResponseException:Hg,setLayerDimensions:uc,shadow:Ve,SignatureExtractor:oo,stopEvent:Jt,SupportedImageMimeTypes:mb,TextLayer:qg,TouchManager:Vg,updateUrlHash:Iw,Util:be,VerbosityLevel:Iy,version:Bw,XfaLayer:Dw};const w8=Object.freeze(Object.defineProperty({__proto__:null,AbortException:xa,AnnotationEditorLayer:wb,AnnotationEditorParamsType:tt,AnnotationEditorType:Oe,AnnotationEditorUIManager:dc,AnnotationLayer:zw,AnnotationMode:ro,AnnotationType:cn,CSSConstants:Bk,ColorPicker:$g,DOMSVGFactory:Yg,DrawLayer:Cb,FeatureTest:On,GlobalWorkerOptions:Ks,ImageKind:Lg,InvalidPDFException:gb,MathClamp:li,OPS:ep,OutputScale:Tr,PDFDataRangeTransport:Fw,PDFDateString:zg,PDFWorker:tp,PasswordResponses:Dk,PermissionFlag:Mk,PixelsPerInch:Ra,RenderingCancelledException:u_,ResponseException:Hg,SignatureExtractor:oo,SupportedImageMimeTypes:mb,TextLayer:qg,TouchManager:Vg,Util:be,VerbosityLevel:Iy,XfaLayer:Dw,applyOpacity:Hk,build:VP,createValidAbsoluteUrl:Rw,fetchData:ap,findContrastColor:Gk,getDocument:Uw,getFilenameFromUrl:Ok,getPdfFilenameFromUrl:Uk,getRGB:lp,getUuid:Nw,getXfaPageViewport:Fk,isDataScheme:Dy,isPdfFile:d_,isValidExplicitDest:_P,noContextMenu:As,normalizeUnicode:Pk,renderRichText:kw,setLayerDimensions:uc,shadow:Ve,stopEvent:Jt,updateUrlHash:Iw,version:Bw},Symbol.toStringTag,{value:"Module"}));function V2(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var s=i.length;for(e=0;e<s;e++)i[e]&&(t=V2(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function p_(){for(var i,e,t=0,n="",s=arguments.length;t<s;t++)(i=arguments[t])&&(e=V2(i))&&(n&&(n+=" "),n+=e);return n}var kM=Object.prototype.hasOwnProperty;function PM(i,e,t){for(t of i.keys())if(Sh(t,e))return t}function Sh(i,e){var t,n,s;if(i===e)return!0;if(i&&e&&(t=i.constructor)===e.constructor){if(t===Date)return i.getTime()===e.getTime();if(t===RegExp)return i.toString()===e.toString();if(t===Array){if((n=i.length)===e.length)for(;n--&&Sh(i[n],e[n]););return n===-1}if(t===Set){if(i.size!==e.size)return!1;for(n of i)if(s=n,s&&typeof s=="object"&&(s=PM(e,s),!s)||!e.has(s))return!1;return!0}if(t===Map){if(i.size!==e.size)return!1;for(n of i)if(s=n[0],s&&typeof s=="object"&&(s=PM(e,s),!s)||!Sh(n[1],e.get(s)))return!1;return!0}if(t===ArrayBuffer)i=new Uint8Array(i),e=new Uint8Array(e);else if(t===DataView){if((n=i.byteLength)===e.byteLength)for(;n--&&i.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(i)){if((n=i.byteLength)===e.byteLength)for(;n--&&i[n]===e[n];);return n===-1}if(!t||typeof i=="object"){n=0;for(t in i)if(kM.call(i,t)&&++n&&!kM.call(e,t)||!(t in e)||!Sh(i[t],e[t]))return!1;return Object.keys(e).length===n}}return i!==i&&e!==e}function Oy(i){let e=!1;return{promise:new Promise((n,s)=>{i.then(o=>!e&&n(o)).catch(o=>!e&&s(o))}),cancel(){e=!0}}}const C8=["onCopy","onCut","onPaste"],x8=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],R8=["onFocus","onBlur"],I8=["onInput","onInvalid","onReset","onSubmit"],N8=["onLoad","onError"],M8=["onKeyDown","onKeyPress","onKeyUp"],D8=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],k8=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],P8=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],L8=["onSelect"],O8=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],U8=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],F8=["onScroll"],B8=["onWheel"],H8=["onAnimationStart","onAnimationEnd","onAnimationIteration"],G8=["onTransitionEnd"],z8=["onToggle"],V8=["onChange"],q8=[...C8,...x8,...R8,...I8,...N8,...M8,...D8,...k8,...P8,...L8,...O8,...U8,...F8,...B8,...H8,...G8,...V8,...z8];function q2(i,e){const t={};for(const n of q8){const s=i[n];s&&(e?t[n]=(o=>s(o,e(n))):t[n]=s)}return t}var $8="Invariant failed";function Pt(i,e){if(!i)throw new Error($8)}var tE,LM;function Y8(){if(LM)return tE;LM=1;var i=function(){};return tE=i,tE}var X8=Y8();const ci=pw(X8),$2=Z.createContext(null),W8="noopener noreferrer nofollow";class K8{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Pt(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Pt(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||W8,e.target=n?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Pt(this.pdfDocument),Pt(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Pt(Array.isArray(t));const n=t[0];new Promise(s=>{Pt(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(o=>{s(o)}).catch(()=>{Pt(!1)}):typeof n=="number"?s(n):Pt(!1)}).then(s=>{const o=s+1;Pt(this.pdfViewer),Pt(o>=1&&o<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:s,pageNumber:o})})})}goToPage(e){const t=e-1;Pt(this.pdfViewer),Pt(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function Ah({children:i,type:e}){return T.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:i})}const OM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function J8(i,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return i}}function np(){return Z.useReducer(J8,{value:void 0,error:void 0})}const g_=typeof window<"u",Y2=g_&&window.location.protocol==="file:";function j8(i){return typeof i<"u"}function Lc(i){return j8(i)&&i!==null}function Q8(i){return typeof i=="string"}function Z8(i){return i instanceof ArrayBuffer}function e$(i){return Pt(g_),i instanceof Blob}function tw(i){return Q8(i)&&/^data:/.test(i)}function UM(i){Pt(tw(i));const[e="",t=""]=i.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function t$(){return g_&&window.devicePixelRatio||1}const X2="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function FM(){ci(!Y2,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${X2}`)}function n$(){ci(!Y2,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${X2}`)}function sd(i){i!=null&&i.cancel&&i.cancel()}function nw(i,e){return Object.defineProperty(i,"width",{get(){return this.getViewport({scale:e}).width},configurable:!0}),Object.defineProperty(i,"height",{get(){return this.getViewport({scale:e}).height},configurable:!0}),Object.defineProperty(i,"originalWidth",{get(){return this.getViewport({scale:1}).width},configurable:!0}),Object.defineProperty(i,"originalHeight",{get(){return this.getViewport({scale:1}).height},configurable:!0}),i}function W2(i){return i.name==="AbortException"||i.name==="RenderingCancelledException"}function i$(i){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=s=>{if(!s.target)return t(new Error("Error while reading a file."));const{error:o}=s.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(i)})}const{PDFDataRangeTransport:s$}=w8,r$=(i,e)=>{switch(e){case OM.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");i(t);break}case OM.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");i(t);break}}};function BM(i){return typeof i=="object"&&i!==null&&("data"in i||"range"in i||"url"in i)}const o$=Z.forwardRef(function({children:e,className:t,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF",noData:g="No PDF file specified.",onItemClick:y,onLoadError:b,onLoadProgress:A,onLoadSuccess:w,onPassword:C=r$,onSourceError:N,onSourceSuccess:I,options:P,renderMode:k,rotate:L,scale:O,...U},F){const[K,q]=np(),{value:Q,error:ee}=K,[se,le]=np(),{value:ue,error:me}=se,G=Z.useRef(new K8),$=Z.useRef([]),oe=Z.useRef(void 0),pe=Z.useRef(void 0);l&&l!==oe.current&&BM(l)&&(ci(!Sh(l,oe.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),oe.current=l),P&&P!==pe.current&&(ci(!Sh(P,pe.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),pe.current=P);const Me=Z.useRef({scrollPageIntoView:rt=>{const{dest:We,pageNumber:pt,pageIndex:Qt=pt-1}=rt;if(y){y({dest:We,pageIndex:Qt,pageNumber:pt});return}const Ht=$.current[Qt];if(Ht){Ht.scrollIntoView();return}ci(!1,`An internal link leading to page ${pt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});Z.useImperativeHandle(F,()=>({linkService:G,pages:$,viewer:Me}),[]);function H(){I&&I()}function J(){ee&&(ci(!1,ee.toString()),N&&N(ee))}function re(){q({type:"RESET"})}Z.useEffect(re,[l,q]);const de=Z.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return tw(l)?{data:UM(l)}:(FM(),{url:l});if(l instanceof s$)return{range:l};if(Z8(l))return{data:l};if(g_&&e$(l))return{data:await i$(l)};if(Pt(typeof l=="object"),Pt(BM(l)),"url"in l&&typeof l.url=="string"){if(tw(l.url)){const{url:rt,...We}=l;return{data:UM(rt),...We}}FM()}return l},[l]);Z.useEffect(()=>{const rt=Oy(de());return rt.promise.then(We=>{q({type:"RESOLVE",value:We})}).catch(We=>{q({type:"REJECT",error:We})}),()=>{sd(rt)}},[de,q]),Z.useEffect(()=>{if(!(typeof Q>"u")){if(Q===!1){J();return}H()}},[Q]);function _e(){ue&&(w&&w(ue),$.current=new Array(ue.numPages),G.current.setDocument(ue))}function Ce(){me&&(ci(!1,me.toString()),b&&b(me))}Z.useEffect(function(){le({type:"RESET"})},[le,Q]),Z.useEffect(function(){if(!Q)return;const We=P?{...Q,...P}:Q,pt=Uw(We);A&&(pt.onProgress=A),C&&(pt.onPassword=C);const Qt=pt;return Qt.promise.then(Ht=>{Qt.destroyed||le({type:"RESOLVE",value:Ht})}).catch(Ht=>{Qt.destroyed||le({type:"REJECT",error:Ht})}),()=>{Qt.destroy()}},[P,le,Q]),Z.useEffect(()=>{if(!(typeof ue>"u")){if(ue===!1){Ce();return}_e()}},[ue]),Z.useEffect(function(){G.current.setViewer(Me.current),G.current.setExternalLinkRel(s),G.current.setExternalLinkTarget(o)},[s,o]);const Ee=Z.useCallback((rt,We)=>{$.current[rt]=We},[]),st=Z.useCallback(rt=>{delete $.current[rt]},[]),Je=Z.useMemo(()=>({imageResourcesPath:h,linkService:G.current,onItemClick:y,pdf:ue,registerPage:Ee,renderMode:k,rotate:L,scale:O,unregisterPage:st}),[h,y,ue,Ee,k,L,O,st]),It=Z.useMemo(()=>q2(U,()=>ue),[U,ue]);function Xe(){function rt(pt){return!!(pt!=null&&pt.pdf)}if(!rt(Je))throw new Error("pdf is undefined");const We=typeof e=="function"?e(Je):e;return T.jsx($2.Provider,{value:Je,children:We})}function Cn(){return l?ue==null?T.jsx(Ah,{type:"loading",children:typeof f=="function"?f():f}):ue===!1?T.jsx(Ah,{type:"error",children:typeof n=="function"?n():n}):Xe():T.jsx(Ah,{type:"no-data",children:typeof g=="function"?g():g})}return T.jsx("div",{className:p_("react-pdf__Document",t),ref:c,...It,children:Cn()})});function K2(){return Z.useContext($2)}function J2(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=i.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(o){for(var l=0,c=t;l<c.length;l++){var h=c[l];typeof h=="function"?h(o):h&&(h.current=o)}}}const j2=Z.createContext(null);function m_(){return Z.useContext(j2)}function a$(){const i=K2(),e=m_();Pt(e);const t={...i,...e},{filterAnnotations:n,imageResourcesPath:s,linkService:o,onGetAnnotationsError:l,onGetAnnotationsSuccess:c,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:f,page:g,pdf:y,renderForms:b,rotate:A,scale:w=1}=t;Pt(y),Pt(g),Pt(o);const[C,N]=np(),{value:I,error:P}=C,k=Z.useRef(null);ci(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function L(){I&&c&&c(I)}function O(){P&&(ci(!1,P.toString()),l&&l(P))}Z.useEffect(function(){N({type:"RESET"})},[N,g]),Z.useEffect(function(){if(!g)return;const Q=Oy(g.getAnnotations()),ee=Q;return Q.promise.then(se=>{N({type:"RESOLVE",value:se})}).catch(se=>{N({type:"REJECT",error:se})}),()=>{sd(ee)}},[N,g]),Z.useEffect(()=>{if(I!==void 0){if(I===!1){O();return}L()}},[I]);function U(){f&&f()}function F(q){ci(!1,`${q}`),h&&h(q)}const K=Z.useMemo(()=>g.getViewport({scale:w,rotation:A}),[g,A,w]);return Z.useEffect(function(){if(!y||!g||!o||!I)return;const{current:Q}=k;if(!Q)return;const ee=K.clone({dontFlip:!0}),se={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:y.annotationStorage,commentManager:null,div:Q,l10n:null,linkService:o,page:g,structTreeLayer:null,viewport:ee},le={annotations:n?n({annotations:I}):I,annotationStorage:y.annotationStorage,div:Q,imageResourcesPath:s,linkService:o,page:g,renderForms:b,viewport:ee};Q.innerHTML="";try{new zw(se).render(le),U()}catch(ue){F(ue)}return()=>{}},[I,n,s,o,g,y,b,K]),T.jsx("div",{className:p_("react-pdf__Page__annotations","annotationLayer"),ref:k})}const Q2={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},l$=/^H(\d+)$/;function c$(i){return i in Q2}function y_(i){return"children"in i}function Z2(i){return y_(i)?i.children.length===1&&0 in i.children&&"id"in i.children[0]:!1}function u$(i){const e={};if(y_(i)){const{role:t}=i,n=t.match(l$);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(c$(t)){const s=Q2[t];s&&(e.role=s)}}return e}function eL(i){const e={};if(y_(i)){if(i.alt!==void 0&&(e["aria-label"]=i.alt),i.lang!==void 0&&(e.lang=i.lang),Z2(i)){const[t]=i.children;if(t){const n=eL(t);return{...e,...n}}}}else"id"in i&&(e["aria-owns"]=i.id);return e}function d$(i){return i?{...u$(i),...eL(i)}:null}function tL({className:i,node:e}){const t=Z.useMemo(()=>d$(e),[e]),n=Z.useMemo(()=>!y_(e)||Z2(e)?null:e.children.map((s,o)=>T.jsx(tL,{node:s},o)),[e]);return T.jsx("span",{className:i,...t,children:n})}function h$(){const i=m_();Pt(i);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=i,[n,s]=np(),{value:o,error:l}=n,{customTextRenderer:c,page:h}=i;function f(){o&&t&&t(o)}function g(){l&&(ci(!1,l.toString()),e&&e(l))}return Z.useEffect(function(){s({type:"RESET"})},[s,h]),Z.useEffect(function(){if(c||!h)return;const b=Oy(h.getStructTree()),A=b;return b.promise.then(w=>{s({type:"RESOLVE",value:w})}).catch(w=>{s({type:"REJECT",error:w})}),()=>sd(A)},[c,h,s]),Z.useEffect(()=>{if(o!==void 0){if(o===!1){g();return}f()}},[o]),o?T.jsx(tL,{className:"react-pdf__Page__structTree structTree",node:o}):null}const HM=ro;function f$(i){const e=m_();Pt(e);const t={...e,...i},{_className:n,canvasBackground:s,devicePixelRatio:o=t$(),onRenderError:l,onRenderSuccess:c,page:h,renderForms:f,renderTextLayer:g,rotate:y,scale:b}=t,{canvasRef:A}=i;Pt(h);const w=Z.useRef(null);function C(){h&&c&&c(nw(h,b))}function N(L){W2(L)||(ci(!1,L.toString()),l&&l(L))}const I=Z.useMemo(()=>h.getViewport({scale:b*o,rotation:y}),[o,h,y,b]),P=Z.useMemo(()=>h.getViewport({scale:b,rotation:y}),[h,y,b]);Z.useEffect(function(){if(!h)return;h.cleanup();const{current:O}=w;if(!O)return;O.width=I.width,O.height=I.height,O.style.width=`${Math.floor(P.width)}px`,O.style.height=`${Math.floor(P.height)}px`,O.style.visibility="hidden";const U={annotationMode:f?HM.ENABLE_FORMS:HM.ENABLE,canvas:O,canvasContext:O.getContext("2d",{alpha:!1}),viewport:I};s&&(U.background=s);const F=h.render(U),K=F;return F.promise.then(()=>{O.style.visibility="",C()}).catch(N),()=>sd(K)},[s,h,f,I,P]);const k=Z.useCallback(()=>{const{current:L}=w;L&&(L.width=0,L.height=0)},[]);return Z.useEffect(()=>k,[k]),T.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:J2(A,w),style:{display:"block",userSelect:"none"},children:g?T.jsx(h$,{}):null})}function p$(i){return"str"in i}function g$(){const i=m_();Pt(i);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:o,page:l,pageIndex:c,pageNumber:h,rotate:f,scale:g}=i;Pt(l);const[y,b]=np(),{value:A,error:w}=y,C=Z.useRef(null);ci(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function N(){A&&n&&n(A)}function I(){w&&(ci(!1,w.toString()),t&&t(w))}Z.useEffect(function(){b({type:"RESET"})},[l,b]),Z.useEffect(function(){if(!l)return;const K=Oy(l.getTextContent()),q=K;return K.promise.then(Q=>{b({type:"RESOLVE",value:Q})}).catch(Q=>{b({type:"REJECT",error:Q})}),()=>sd(q)},[l,b]),Z.useEffect(()=>{if(A!==void 0){if(A===!1){I();return}N()}},[A]);const P=Z.useCallback(()=>{o&&o()},[o]),k=Z.useCallback(F=>{W2(F)||(ci(!1,F.toString()),s&&s(F))},[s]);function L(){const F=C.current;F&&F.classList.add("selecting")}function O(){const F=C.current;F&&F.classList.remove("selecting")}const U=Z.useMemo(()=>l.getViewport({scale:g,rotation:f}),[l,f,g]);return Z.useLayoutEffect(function(){if(!l||!A)return;const{current:K}=C;if(!K)return;K.innerHTML="";const q=l.streamTextContent({includeMarkedContent:!0}),Q={container:K,textContentSource:q,viewport:U},ee=new qg(Q),se=ee;return ee.render().then(()=>{const le=document.createElement("div");le.className="endOfContent",K.append(le);const ue=K.querySelectorAll('[role="presentation"]');if(e){let me=0;A.items.forEach((G,$)=>{if(!p$(G))return;const oe=ue[me];if(!oe)return;const pe=e({pageIndex:c,pageNumber:h,itemIndex:$,...G});oe.innerHTML=pe,me+=G.str&&G.hasEOL?2:1})}P()}).catch(k),()=>sd(se)},[e,k,P,l,c,h,A,U]),T.jsx("div",{className:p_("react-pdf__Page__textContent","textLayer"),onMouseUp:O,onMouseDown:L,ref:C})}const GM=1;function m$(i){const t={...K2(),...i},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:o,canvasRef:l,children:c,className:h,customRenderer:f,customTextRenderer:g,devicePixelRatio:y,error:b="Failed to load the page.",filterAnnotations:A,height:w,inputRef:C,loading:N="Loading page",noData:I="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:U,onGetTextSuccess:F,onLoadError:K,onLoadSuccess:q,onRenderAnnotationLayerError:Q,onRenderAnnotationLayerSuccess:ee,onRenderError:se,onRenderSuccess:le,onRenderTextLayerError:ue,onRenderTextLayerSuccess:me,pageIndex:G,pageNumber:$,pdf:oe,registerPage:pe,renderAnnotationLayer:Me=!0,renderForms:H=!1,renderMode:J="canvas",renderTextLayer:re=!0,rotate:de,scale:_e=GM,unregisterPage:Ce,width:Ee,...st}=t,[Je,It]=np(),{value:Xe,error:Cn}=Je,rt=Z.useRef(null);Pt(oe);const We=Lc($)?$-1:G??null,pt=$??(Lc(G)?G+1:null),Qt=de??(Xe?Xe.rotate:null),Ht=Z.useMemo(()=>{if(!Xe)return null;let Qn=1;const Rr=_e??GM;if(Ee||w){const qi=Xe.getViewport({scale:1,rotation:Qt});Ee?Qn=Ee/qi.width:w&&(Qn=w/qi.height)}return Rr*Qn},[w,Xe,Qt,_e,Ee]);Z.useEffect(function(){return()=>{Lc(We)&&s&&Ce&&Ce(We)}},[s,oe,We,Ce]);function er(){if(q){if(!Xe||!Ht)return;q(nw(Xe,Ht))}if(s&&pe){if(!Lc(We)||!rt.current)return;pe(We,rt.current)}}function Vi(){Cn&&(ci(!1,Cn.toString()),K&&K(Cn))}Z.useEffect(function(){It({type:"RESET"})},[It,oe,We]),Z.useEffect(function(){if(!oe||!pt)return;const Rr=Oy(oe.getPage(pt)),qi=Rr;return Rr.promise.then(ye=>{It({type:"RESOLVE",value:ye})}).catch(ye=>{It({type:"REJECT",error:ye})}),()=>sd(qi)},[It,oe,pt]),Z.useEffect(()=>{if(Xe!==void 0){if(Xe===!1){Vi();return}er()}},[Xe,Ht]);const Ts=Z.useMemo(()=>Lc(We)&&pt&&Lc(Qt)&&Lc(Ht)?{_className:n,canvasBackground:o,customTextRenderer:g,devicePixelRatio:y,filterAnnotations:A,onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:U,onGetTextSuccess:F,onRenderAnnotationLayerError:Q,onRenderAnnotationLayerSuccess:ee,onRenderError:se,onRenderSuccess:le,onRenderTextLayerError:ue,onRenderTextLayerSuccess:me,page:Xe,pageIndex:We,pageNumber:pt,renderForms:H,renderTextLayer:re,rotate:Qt,scale:Ht}:null,[n,o,g,y,A,P,k,L,O,U,F,Q,ee,se,le,ue,me,Xe,We,pt,H,re,Qt,Ht]),ws=Z.useMemo(()=>q2(st,()=>Xe&&(Ht?nw(Xe,Ht):void 0)),[st,Xe,Ht]),ae=`${We}@${Ht}/${Qt}`;function Ge(){switch(J){case"custom":return Pt(f),T.jsx(f,{},`${ae}_custom`);case"none":return null;case"canvas":default:return T.jsx(f$,{canvasRef:l},`${ae}_canvas`)}}function Re(){return re?T.jsx(g$,{},`${ae}_text`):null}function hn(){return Me?T.jsx(a$,{},`${ae}_annotations`):null}function wi(){function Qn(qi){return!!(qi!=null&&qi.page)}if(!Qn(Ts))throw new Error("page is undefined");const Rr=typeof c=="function"?c(Ts):c;return T.jsxs(j2.Provider,{value:Ts,children:[Ge(),Re(),hn(),Rr]})}function di(){return pt?oe===null||Xe===void 0||Xe===null?T.jsx(Ah,{type:"loading",children:typeof N=="function"?N():N}):oe===!1||Xe===!1?T.jsx(Ah,{type:"error",children:typeof b=="function"?b():b}):wi():T.jsx(Ah,{type:"no-data",children:typeof I=="function"?I():I})}return T.jsx("div",{className:p_(n,h),"data-page-number":pt,ref:J2(C,rt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Ht}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:o||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...ws,children:di()})}n$();Ks.workerSrc="pdf.worker.mjs";Ks.workerSrc=`//unpkg.com/pdfjs-dist@${Bw}/build/pdf.worker.min.js`;const y$=({book:i,onClose:e,onReward:t,onUpdateBookData:n})=>{const[s,o]=Z.useState(!1),[l,c]=Z.useState(""),[h,f]=Z.useState(!0),[g,y]=Z.useState(i.isLocal?"complete":"selecting"),[b,A]=Z.useState(i.currentChapter||1),[w,C]=Z.useState(null),[N,I]=Z.useState(i.userHighlights||[]),[P,k]=Z.useState(i.userNotes||[]),[L,O]=Z.useState(null),[U,F]=Z.useState(""),[K,q]=Z.useState(!1),[Q,ee]=Z.useState(""),[se,le]=Z.useState([]),[ue,me]=Z.useState(""),[G,$]=Z.useState(!1),[oe,pe]=Z.useState(null),[Me,H]=Z.useState(!1),[J,re]=Z.useState(""),[de,_e]=Z.useState(!1),[Ce,Ee]=Z.useState(null),[st,Je]=Z.useState(1),It=Z.useRef(null);function Xe({numPages:ye}){Ee(ye)}const Cn=()=>{var Nt;const ye=window.getSelection();if(ye&&ye.toString().trim()){const gt=ye.getRangeAt(0),_t=gt.commonAncestorContainer,tr=(Nt=It.current)==null?void 0:Nt.querySelector(".react-pdf__Page");if(tr&&tr.contains(_t)){const Zn=gt.getBoundingClientRect();if(It.current){const Vy=It.current.getBoundingClientRect(),qy=ye.toString();F(qy),C({text:qy,top:Zn.top-Vy.top+It.current.scrollTop,left:Zn.left-Vy.left})}}}else C(null),F("")};Z.useEffect(()=>{const ye=()=>{Cn()};return document.addEventListener("selectionchange",ye),()=>document.removeEventListener("selectionchange",ye)},[]),Z.useEffect(()=>{n(i.id,{userNotes:P,userHighlights:N,lastReadDate:Date.now(),currentChapter:b})},[P,N,b]);const rt=async ye=>{if(f(!0),i.isLocal&&i.fileUrl)f(!1);else{const Nt=await OV(i.title,i.author,ye),gt=Ht(Nt,N);c(gt),f(!1)}};Z.useEffect(()=>{i.isLocal?(y("complete"),f(!1)):i.content&&i.currentChapter&&(y("complete"),c(Ht(i.content,N)),f(!1))},[]);const We=ye=>{y(ye),rt(ye==="preview"?1:b)},pt=()=>{const ye=b+1;A(ye),rt(ye),window.scrollTo(0,0)},Qt=()=>{if(b>1){const ye=b-1;A(ye),rt(ye),window.scrollTo(0,0)}},Ht=(ye,Nt)=>{let gt=ye;return Nt.forEach(_t=>{gt.includes(_t.text)&&(gt=gt.replace(_t.text,`<mark style="background-color: ${_t.color}; color: black; border-radius: 2px; padding: 2px 0;">${_t.text}</mark>`))}),gt},er=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),o(!1)):(document.documentElement.requestFullscreen(),o(!0))},Vi=()=>{const ye=window.getSelection();if(ye&&ye.toString().length>0){const gt=ye.getRangeAt(0).getBoundingClientRect();if(L)return;C({text:ye.toString(),top:gt.top+window.scrollY,left:gt.left+gt.width/2+window.scrollX}),q(!1),pe(null)}else K||C(null)},Ts=ye=>{ye.preventDefault()},ws=ye=>{var Nt;if(w){const gt={id:Date.now().toString(),text:U,color:ye};I(_t=>[..._t,gt]),c(_t=>_t.replace(U,`<mark style="background-color: ${ye}; color: black; border-radius: 2px; padding: 2px 0;">${U}</mark>`)),C(null),window.getSelection&&((Nt=window.getSelection())==null||Nt.removeAllRanges())}},ae=async()=>{if(!w)return;pe({text:"Translating...",type:"translation"});const ye=U;C(null);const Nt=await PV(ye);pe({text:Nt,type:"translation"})},Ge=async()=>{if(!w)return;pe({text:"Analyzing context...",type:"explanation"});const ye=U;C(null);const Nt=await LV(ye,i.title);pe({text:Nt,type:"explanation"})},Re=()=>{w&&(window.open(`https://www.google.com/search?q=${encodeURIComponent(U)}`,"_blank"),C(null))},hn=()=>{q(!0)},wi=()=>{if(w&&Q){const ye={id:Date.now().toString(),text:Q,selectedText:U,createdAt:Date.now()};k(Nt=>[...Nt,ye]),ee(""),q(!1),C(null),O("notes")}},di=async ye=>{if(ye.preventDefault(),!ue.trim())return;const Nt=ue;me(""),le(_t=>[..._t,{role:"user",text:Nt}]),$(!0);const gt=await Nk(i.title,Nt,se);le(_t=>[..._t,{role:"model",text:gt}]),$(!1)},Qn=async ye=>{O("chat"),$(!0);let Nt="";ye==="summarize"?(le(gt=>[...gt,{role:"user",text:"Summarize this book."}]),Nt=await UV(i.title)):(le(gt=>[...gt,{role:"user",text:"Where was I? Recap the context."}]),Nt=await FV(i.title)),le(gt=>[...gt,{role:"model",text:Nt}]),$(!1)},Rr=()=>{H(!0)},qi=()=>{H(!1),n(i.id,{isFinished:!0}),_e(!0),t&&t()};return g==="selecting"&&!i.isLocal?T.jsx("div",{className:"fixed inset-0 z-50 bg-[#F5F5F7] flex items-center justify-center p-4",children:T.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-[2rem] p-8 shadow-2xl animate-spring",children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx(oB,{size:48,className:"mx-auto text-blue-500 mb-4"}),T.jsx("h2",{className:"text-3xl font-serif font-bold mb-2",children:"How would you like to read?"}),T.jsxs("p",{className:"text-gray-500",children:['Choose your reading experience for "',i.title,'".']})]}),T.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[T.jsxs("button",{onClick:()=>We("preview"),className:"p-6 rounded-3xl border-2 border-gray-100 hover:border-blue-500 hover:bg-blue-50 transition-all text-left group",children:[T.jsx(yB,{size:24,className:"text-gray-400 group-hover:text-blue-500 mb-4"}),T.jsx("h3",{className:"font-bold text-lg mb-1",children:"Quick Preview"}),T.jsx("p",{className:"text-sm text-gray-500",children:"Read a generated summary and excerpt to see if it's your vibe."})]}),T.jsxs("button",{onClick:()=>We("complete"),className:"p-6 rounded-3xl border-2 border-black bg-black text-white hover:scale-[1.02] transition-all text-left",children:[T.jsx(Sa,{size:24,className:"text-white mb-4"}),T.jsx("h3",{className:"font-bold text-lg mb-1",children:"Read Complete Book"}),T.jsx("p",{className:"text-sm text-gray-400",children:"Read the full book chapter by chapter with AI generation."})]})]}),T.jsx("button",{onClick:e,className:"mt-8 mx-auto block text-sm font-bold text-gray-400 hover:text-gray-900",children:"Cancel"})]})}):T.jsxs("div",{className:"flex h-screen bg-[#F5F5F7] text-gray-900 animate-in fade-in duration-300 overflow-hidden font-serif",children:[T.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-500 ${L?"mr-96":""}`,children:[T.jsxs("div",{className:"h-16 flex items-center justify-between px-6 bg-white/80 backdrop-blur-md border-b border-gray-200 z-20",children:[T.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:T.jsx(tB,{size:20})}),T.jsxs("div",{className:"text-center",children:[T.jsx("h1",{className:"text-sm font-bold",children:i.title}),T.jsxs("p",{className:"text-xs text-gray-500",children:[i.author,g==="complete"&&!i.isLocal&&T.jsxs("span",{className:"ml-2 bg-gray-100 px-2 py-0.5 rounded-full text-[10px] font-bold tracking-wide",children:["CH ",b]})]})]}),T.jsx("div",{className:"flex gap-2",children:T.jsx("button",{onClick:er,className:"p-2 hover:bg-gray-100 rounded-full",children:s?T.jsx(UB,{size:20}):T.jsx(PB,{size:20})})})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-8 md:p-16 relative scroll-smooth",onMouseUp:Vi,children:[h?T.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[T.jsx(ac,{className:"animate-spin text-gray-400"}),T.jsxs("p",{className:"text-sm text-gray-400",children:["Loading ",g==="complete"?`Chapter ${b}`:"Preview","..."]})]}):i.isLocal&&!i.fileUrl?T.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[T.jsx("div",{className:"bg-gray-100 p-6 rounded-full mb-4",children:T.jsx(EI,{size:32,className:"text-gray-400"})}),T.jsx("h3",{className:"text-lg font-bold mb-2",children:"File Content Missing"}),T.jsx("p",{className:"text-gray-500 max-w-sm",children:"This is a local file. For security reasons, the browser does not persist the PDF content after a reload. Please re-upload to read again."})]}):i.isLocal&&i.fileUrl?T.jsxs("div",{className:"w-full h-full rounded-2xl shadow-sm overflow-auto",children:[T.jsx(o$,{ref:It,file:i.fileUrl,onLoadSuccess:Xe,loading:T.jsx("div",{className:"flex items-center justify-center h-full",children:T.jsx(ac,{className:"animate-spin",size:24})}),error:T.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:"Failed to load PDF"}),children:T.jsx(m$,{pageNumber:st,renderTextLayer:!0,renderAnnotationLayer:!1,onMouseUp:Cn,className:"shadow-lg"})}),Ce&&T.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 p-4 bg-white rounded-lg shadow-sm",children:[T.jsx("button",{onClick:()=>Je(Math.max(1,st-1)),disabled:st<=1,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:T.jsx(AI,{size:20})}),T.jsxs("span",{className:"text-sm font-medium",children:["Page ",st," of ",Ce]}),T.jsx("button",{onClick:()=>Je(Math.min(Ce,st+1)),disabled:st>=Ce,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:T.jsx(fE,{size:20})})]})]}):T.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-12 shadow-sm rounded-[2px] min-h-full leading-loose text-lg text-gray-800 selection:bg-blue-100 selection:text-blue-900 pb-32",children:[T.jsx("div",{dangerouslySetInnerHTML:{__html:l}}),g==="complete"&&T.jsxs("div",{className:"mt-16 pt-8 border-t border-gray-100 flex items-center justify-between",children:[T.jsxs("button",{onClick:Qt,disabled:b<=1,className:"flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold text-gray-500 hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent",children:[T.jsx(AI,{size:16})," Previous"]}),T.jsxs("button",{onClick:pt,className:"flex items-center gap-2 px-8 py-3 bg-black text-white rounded-full text-sm font-bold hover:scale-105 transition-transform",children:["Next Chapter ",T.jsx(fE,{size:16})]})]}),g==="preview"&&T.jsx("div",{className:"mt-8 pt-8 border-t border-gray-100 text-center text-xs text-gray-400 italic",children:'This is an AI-generated preview. Switch to "Complete Book" mode to read more.'})]}),U&&!K&&T.jsxs("div",{className:"fixed z-50 bg-gray-900/90 backdrop-blur-xl text-white rounded-xl shadow-2xl flex items-center gap-1 p-1 animate-in zoom-in-95 duration-200",style:{top:w.top-60,left:w.left-180},onMouseDown:Ts,children:[T.jsx("button",{onClick:()=>ws("#fef08a"),className:"p-3 hover:bg-white/20 rounded-lg group tooltip-container relative",children:T.jsx(RB,{size:16,className:"text-yellow-300"})}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsx("button",{onClick:hn,className:"p-3 hover:bg-white/20 rounded-lg",children:T.jsx(VA,{size:16,className:"text-pink-300"})}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsxs("button",{onClick:ae,className:"p-3 hover:bg-white/20 rounded-lg text-xs font-bold flex items-center gap-1",children:[T.jsx(TB,{size:14})," Translate"]}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsxs("button",{onClick:Ge,className:"p-3 hover:bg-white/20 rounded-lg text-xs font-bold flex items-center gap-1",children:[T.jsx(Sa,{size:14})," Explain"]}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsx("button",{onClick:Re,className:"p-3 hover:bg-white/20 rounded-lg",children:T.jsx(gE,{size:16})})]}),K&&U&&T.jsxs("div",{className:"fixed z-50 bg-white rounded-2xl shadow-2xl p-4 w-72 animate-in zoom-in-95 duration-200 border border-gray-100",style:{top:w.top-120,left:w.left-144},onMouseDown:ye=>ye.stopPropagation(),children:[T.jsx("textarea",{className:"w-full bg-yellow-50 p-3 rounded-xl text-sm mb-2 focus:outline-none focus:ring-2 focus:ring-yellow-200",placeholder:"Add your note here...",rows:3,value:Q,onChange:ye=>ee(ye.target.value),autoFocus:!0}),T.jsxs("div",{className:"flex justify-end gap-2",children:[T.jsx("button",{onClick:()=>q(!1),className:"text-xs font-bold text-gray-400 px-3 py-1.5 hover:bg-gray-100 rounded-lg",children:"Cancel"}),T.jsx("button",{onClick:wi,className:"text-xs font-bold bg-black text-white px-3 py-1.5 rounded-lg",children:"Save Note"})]})]}),oe&&T.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full animate-in slide-in-from-bottom-4 z-40 border border-gray-100",children:[T.jsxs("div",{className:"flex justify-between items-center mb-3",children:[T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-blue-600",children:oe.type==="translation"?"Translation":"Context & Analysis"}),T.jsx("button",{onClick:()=>pe(null),children:T.jsx(yh,{size:16,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsx("p",{className:"text-gray-800 leading-relaxed font-serif text-lg",children:oe.text})]})]}),T.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur-xl border border-white shadow-2xl rounded-full px-6 py-3 flex items-center gap-6 z-30 hover:scale-105 transition-transform",children:[T.jsxs("button",{onClick:()=>O(L==="chat"?null:"chat"),className:`flex items-center gap-2 text-sm font-bold ${L==="chat"?"text-blue-600":"text-gray-600"}`,children:[T.jsx(TI,{size:18}),"Ask Companion"]}),T.jsx("div",{className:"w-px h-6 bg-gray-300"}),T.jsxs("button",{onClick:()=>O(L==="notes"?null:"notes"),className:`flex items-center gap-2 text-sm font-bold ${L==="notes"?"text-blue-600":"text-gray-600"}`,children:[T.jsx(pE,{size:18}),"Notes (",P.length,")"]}),T.jsx("div",{className:"w-px h-6 bg-gray-300"}),T.jsxs("button",{onClick:Rr,className:"flex items-center gap-2 text-sm font-bold text-gray-600 hover:text-gray-900",children:[T.jsx(gB,{size:18}),"Finish"]})]})]}),T.jsxs("div",{className:`fixed top-0 right-0 bottom-0 w-96 bg-white border-l border-gray-200 shadow-2xl transform transition-transform duration-500 z-40 ${L?"translate-x-0":"translate-x-full"}`,children:[L==="chat"&&T.jsxs("div",{className:"flex flex-col h-full",children:[T.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[T.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[T.jsx(bs,{size:18,className:"text-blue-500"})," Reading Companion"]}),T.jsx("button",{onClick:()=>O(null),children:T.jsx(yh,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsxs("div",{className:"p-4 flex gap-2 overflow-x-auto border-b border-gray-50",children:[T.jsxs("button",{onClick:()=>Qn("summarize"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-full text-xs font-bold hover:bg-blue-100 whitespace-nowrap",children:[T.jsx(EI,{size:12})," Summarize"]}),T.jsxs("button",{onClick:()=>Qn("recap"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-purple-50 text-purple-600 rounded-full text-xs font-bold hover:bg-purple-100 whitespace-nowrap",children:[T.jsx(WB,{size:12})," Where was I?"]})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-white",children:[se.length===0&&T.jsxs("div",{className:"text-center mt-10 text-gray-400",children:[T.jsx(TI,{size:32,className:"mx-auto mb-2 opacity-20"}),T.jsx("p",{className:"text-sm",children:"Ask anything about the book."})]}),se.map((ye,Nt)=>T.jsx("div",{className:`p-3 rounded-xl text-sm leading-relaxed shadow-sm ${ye.role==="user"?"bg-black text-white ml-8 rounded-br-none":"bg-gray-100 text-gray-800 mr-8 rounded-bl-none"}`,children:ye.text},Nt)),G&&T.jsx("div",{className:"p-3 bg-gray-50 rounded-xl w-12",children:T.jsx(ac,{size:16,className:"animate-spin text-gray-400"})})]}),T.jsx("form",{onSubmit:di,className:"p-4 bg-white border-t border-gray-100",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{value:ue,onChange:ye=>me(ye.target.value),placeholder:"Ask about the plot...",className:"w-full bg-gray-100 rounded-full px-4 py-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow"}),T.jsx("button",{type:"submit",className:"absolute right-2 top-2 p-1.5 bg-blue-500 text-white rounded-full hover:scale-105 transition-transform",children:T.jsx(yw,{size:14})})]})})]}),L==="notes"&&T.jsxs("div",{className:"flex flex-col h-full",children:[T.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[T.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[T.jsx(VA,{size:18,className:"text-pink-500"})," My Notes"]}),T.jsx("button",{onClick:()=>O(null),children:T.jsx(yh,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:P.length===0?T.jsxs("div",{className:"text-center mt-20 opacity-50",children:[T.jsx(pE,{size:48,className:"mx-auto mb-4 text-gray-300"}),T.jsx("p",{className:"text-gray-500 font-medium",children:"No notes yet."}),T.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Select text to add a note."})]}):P.map(ye=>T.jsxs("div",{className:"bg-yellow-50 p-4 rounded-2xl border border-yellow-100/50 shadow-sm",children:[T.jsxs("div",{className:"text-xs font-bold text-yellow-600/70 uppercase tracking-wider mb-2 flex items-center gap-1",children:[T.jsx(VA,{size:10})," Note"]}),T.jsxs("p",{className:"text-gray-900 font-medium text-sm mb-3 font-serif",children:['"',ye.text,'"']}),ye.selectedText&&T.jsx("div",{className:"pl-3 border-l-2 border-yellow-200",children:T.jsxs("p",{className:"text-xs text-gray-500 italic line-clamp-2",children:['Re: "',ye.selectedText,'"']})}),T.jsx("p",{className:"text-[10px] text-right text-gray-400 mt-2",children:new Date(ye.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},ye.id))})]})]}),Me&&T.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4 animate-in fade-in",children:T.jsxs("div",{className:"bg-white rounded-[2rem] w-full max-w-lg p-8 shadow-2xl animate-spring",children:[T.jsx("h2",{className:"text-3xl font-serif font-bold text-center mb-2",children:"Congratulations!"}),T.jsxs("p",{className:"text-center text-gray-500 mb-8",children:["You've finished ",i.title,"."]}),T.jsxs("div",{className:"mb-6",children:[T.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2",children:"Leave a note for the author"}),T.jsx("textarea",{className:"w-full bg-gray-50 rounded-2xl p-4 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-100 h-32 resize-none",placeholder:"Your thoughts meant the world...",value:J,onChange:ye=>re(ye.target.value)})]}),T.jsxs("button",{onClick:qi,className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg hover:scale-[1.02] transition-transform flex items-center justify-center gap-2",children:["Send & Claim Reward ",T.jsx(AB,{size:18})]})]})}),de&&T.jsxs("div",{className:"fixed inset-0 z-[70] flex flex-col items-center justify-center bg-black/90 text-white animate-in fade-in duration-500",children:[T.jsxs("div",{className:"relative mb-8 animate-[spin_10s_linear_infinite]",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-yellow-400 to-purple-500 blur-3xl opacity-50 rounded-full"}),T.jsx("div",{className:"relative w-64 h-80 bg-gray-800 rounded-xl overflow-hidden border-2 border-yellow-500/50 shadow-[0_0_50px_rgba(234,179,8,0.3)]",children:T.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:i.coverColor},children:T.jsx(Sa,{size:64,className:"text-white/50"})})})]}),T.jsx("h1",{className:"text-4xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:"NFT Minted!"}),T.jsx("p",{className:"text-gray-400 mb-8",children:"You earned 50 Suitcase Tokens (SCT)"}),T.jsx("button",{onClick:()=>{_e(!1),e()},className:"px-8 py-3 bg-white text-black rounded-full font-bold hover:bg-gray-200 transition-colors",children:"Add to Wallet"})]})]})},v$=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],b$=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],_$=({onComplete:i})=>{const[e,t]=Z.useState(1),[n,s]=Z.useState([]),[o,l]=Z.useState(""),[c,h]=Z.useState(""),f=y=>{n.includes(y)?s(b=>b.filter(A=>A!==y)):n.length<3&&s(b=>[...b,y])},g=()=>{e===1&&c.trim()?t(2):e===2&&n.length>0?t(3):e===3&&o&&i({name:c,genres:n,readingGoal:o,onboardingComplete:!0,joinDate:Date.now()})};return T.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-[#F5F5F7]",children:T.jsxs("div",{className:"max-w-xl w-full p-8 animate-spring",children:[T.jsxs("div",{className:"flex justify-center gap-2 mb-12",children:[T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=1?"bg-black":"bg-gray-200"}`}),T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=2?"bg-black":"bg-gray-200"}`}),T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=3?"bg-black":"bg-gray-200"}`})]}),T.jsxs("div",{className:"text-center mb-10",children:[T.jsx("div",{className:"inline-block p-4 bg-white rounded-[2rem] shadow-lg mb-6 rotate-3",children:T.jsx(bs,{size:32,className:"text-blue-500"})}),T.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-4",children:e===1?"Welcome Traveler":e===2?"What do you like to read?":"Why are you reading?"}),T.jsx("p",{className:"text-gray-500 text-lg",children:e===1?"What should we call you?":e===2?"Pick up to 3 genres.":"Help us curate your perfect suitcase."})]}),T.jsxs("div",{className:"min-h-[200px]",children:[e===1&&T.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:T.jsx("input",{value:c,onChange:y=>h(y.target.value),className:"w-full text-center text-3xl font-bold border-b-2 border-gray-200 focus:border-black bg-transparent outline-none py-2",placeholder:"Enter your name",autoFocus:!0})}),e===2&&T.jsx("div",{className:"flex flex-wrap justify-center gap-3 animate-in fade-in slide-in-from-bottom-4",children:v$.map(y=>T.jsx("button",{onClick:()=>f(y),className:`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${n.includes(y)?"bg-black text-white shadow-lg scale-105":"bg-white text-gray-500 hover:bg-gray-100"}`,children:y},y))}),e===3&&T.jsx("div",{className:"grid gap-4 animate-in fade-in slide-in-from-bottom-4",children:b$.map(y=>T.jsxs("button",{onClick:()=>l(y.label),className:`flex items-center gap-4 p-5 rounded-[2rem] text-left transition-all duration-300 border-2 ${o===y.label?"border-blue-500 bg-blue-50 shadow-lg":"border-transparent bg-white hover:bg-gray-50"}`,children:[T.jsx("span",{className:"text-3xl",children:y.icon}),T.jsx("span",{className:`text-xl font-bold ${o===y.label?"text-blue-900":"text-gray-700"}`,children:y.label}),o===y.label&&T.jsx(hE,{className:"ml-auto text-blue-500"})]},y.id))})]}),T.jsx("div",{className:"flex justify-center mt-8",children:T.jsxs("button",{onClick:g,disabled:e===1?!c.trim():e===2?n.length===0:!o,className:"group flex items-center gap-2 bg-black text-white px-8 py-4 rounded-full font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:scale-105 active:scale-95",children:[e===3?"Finish Setup":"Next",T.jsx(mw,{className:"group-hover:translate-x-1 transition-transform"})]})})]})})},S$=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],zM=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],A$=({userPrefs:i,wallet:e,library:t,onClose:n,onUpdateProfile:s,onReset:o})=>{var L;const[l,c]=Z.useState(!1),[h,f]=Z.useState(i.name||"Traveler"),[g,y]=Z.useState(i.readingGoal),[b,A]=Z.useState(i.genres),w=t.filter(O=>O.isFinished).length,C=t.reduce((O,U)=>{var F;return O+(((F=U.userNotes)==null?void 0:F.length)||0)},0),N=t.filter(O=>e.nfts.includes(O.id)),I=()=>{s({...i,name:h,readingGoal:g,genres:b}),c(!1)},P=()=>{f(i.name||"Traveler"),y(i.readingGoal),A(i.genres),c(!1)},k=O=>{b.includes(O)?A(U=>U.filter(F=>F!==O)):b.length<5&&A(U=>[...U,O])};return T.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-300 max-w-4xl mx-auto mt-8 mb-24",children:[T.jsx("div",{className:"flex justify-end mb-4",children:l?T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:P,className:"px-4 py-2 bg-white text-gray-500 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm",children:"Cancel"}),T.jsxs("button",{onClick:I,className:"px-4 py-2 bg-black text-white rounded-full font-bold shadow-lg hover:bg-gray-800 text-sm flex items-center gap-2",children:[T.jsx(hE,{size:14})," Save Changes"]})]}):T.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-white text-gray-900 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm flex items-center gap-2",children:[T.jsx(HB,{size:14})," Edit Profile"]})}),T.jsxs("div",{className:"bg-white rounded-[2.5rem] p-8 shadow-sm mb-8 relative overflow-hidden",children:[T.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-bl from-blue-100 to-purple-100 rounded-bl-[10rem] -z-0 opacity-50 pointer-events-none"}),T.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 relative z-10",children:[T.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-tr from-gray-900 to-gray-700 shadow-2xl flex items-center justify-center text-4xl font-serif font-bold text-white border-4 border-white",children:h.charAt(0).toUpperCase()}),T.jsxs("div",{className:"text-center md:text-left flex-1 w-full",children:[l?T.jsxs("div",{className:"flex flex-col gap-2 mb-2 w-full max-w-md",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider",children:"Display Name"}),T.jsx("input",{value:h,onChange:O=>f(O.target.value),className:"text-2xl font-serif font-bold text-gray-900 bg-gray-50 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500 w-full"})]}):T.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-2",children:h}),T.jsx("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 text-sm text-gray-500 font-medium",children:T.jsxs("span",{className:"flex items-center gap-1.5",children:[T.jsx(kD,{size:14})," Joined ",new Date(i.joinDate).toLocaleDateString()]})})]}),T.jsxs("div",{className:"bg-gray-900 text-white p-6 rounded-3xl shadow-xl min-w-[200px] text-center md:text-right relative overflow-hidden group",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/20 to-purple-500/20 group-hover:opacity-100 transition-opacity opacity-0"}),T.jsxs("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 flex items-center justify-end gap-2",children:["Balance ",T.jsx(r3,{size:12})]}),T.jsxs("div",{className:"text-3xl font-mono font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:[e.balance," SCT"]})]})]})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[T.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[T.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[T.jsx(bs,{size:14})," Current Focus"]}),l?T.jsx("div",{className:"grid gap-2",children:zM.map(O=>T.jsxs("button",{onClick:()=>y(O.label),className:`flex items-center gap-3 p-3 rounded-xl border text-left transition-colors ${g===O.label?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-100 hover:bg-gray-50"}`,children:[T.jsx("span",{className:"text-xl",children:O.icon}),T.jsx("span",{className:"font-bold text-sm",children:O.label}),g===O.label&&T.jsx(hE,{size:16,className:"ml-auto text-blue-600"})]},O.id))}):T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("span",{className:"text-3xl",children:((L=zM.find(O=>O.label===g))==null?void 0:L.icon)||""}),T.jsx("span",{className:"text-xl font-bold text-gray-900",children:g})]})]}),T.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[T.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[T.jsx(Sa,{size:14})," Favorite Genres"]}),T.jsx("div",{className:"flex flex-wrap gap-2",children:l?S$.map(O=>T.jsx("button",{onClick:()=>k(O),className:`px-3 py-1.5 rounded-full text-sm font-bold transition-colors ${b.includes(O)?"bg-black text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:O},O)):b.map(O=>T.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm font-bold",children:O},O))})]})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-50 flex items-center justify-center text-blue-600",children:T.jsx(Sa,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Books Finished"})]})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-purple-50 flex items-center justify-center text-purple-600",children:T.jsx(pE,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Notes Taken"})]})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-yellow-50 flex items-center justify-center text-yellow-600",children:T.jsx(SI,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.nfts.length}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"NFTs Collected"})]})]})]}),T.jsxs("div",{className:"mb-12",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-6 px-2",children:[T.jsx(bs,{className:"text-yellow-500",size:20}),T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900",children:"Your Collection (NFTs)"})]}),N.length===0?T.jsxs("div",{className:"bg-white rounded-[2rem] p-12 text-center border-2 border-dashed border-gray-200",children:[T.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300",children:T.jsx(SI,{size:32})}),T.jsx("h3",{className:"text-gray-900 font-bold mb-1",children:"No Digital Collectibles Yet"}),T.jsx("p",{className:"text-gray-500 text-sm",children:"Finish books to mint their covers as NFTs."})]}):T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:N.map(O=>T.jsxs("div",{className:"group relative aspect-[2/3] rounded-2xl overflow-hidden shadow-lg transition-transform hover:scale-105",children:[T.jsx("div",{className:"absolute inset-0",style:{backgroundColor:O.coverColor}}),O.isbn&&T.jsx("img",{src:`https://covers.openlibrary.org/b/isbn/${O.isbn}-L.jpg`,className:"absolute inset-0 w-full h-full object-cover",alt:O.title}),T.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-4",children:[T.jsx("p",{className:"text-white font-bold text-sm line-clamp-2",children:O.title}),T.jsx("div",{className:"flex items-center gap-1 mt-1",children:T.jsx("span",{className:"text-[10px] font-bold bg-yellow-400 text-black px-1.5 rounded",children:"NFT"})})]})]},O.id))})]}),T.jsx("div",{className:"flex justify-center",children:T.jsxs("button",{onClick:o,className:"text-red-500 text-sm font-bold flex items-center gap-2 hover:bg-red-50 px-6 py-3 rounded-full transition-colors",children:[T.jsx(PD,{size:16})," Reset Profile & Data"]})})]})},E$=()=>{};var VM={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},T$=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=i[t++];e[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=i[t++],l=i[t++],c=i[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=i[t++],l=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},iL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const o=i[s],l=s+1<i.length,c=l?i[s+1]:0,h=s+2<i.length,f=h?i[s+2]:0,g=o>>2,y=(o&3)<<4|c>>4;let b=(c&15)<<2|f>>6,A=f&63;h||(A=64,l||(b=64)),n.push(t[g],t[y],t[b],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(nL(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):T$(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const o=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const f=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,o==null||c==null||f==null||y==null)throw new w$;const b=o<<2|c>>4;if(n.push(b),f!==64){const A=c<<4&240|f>>2;if(n.push(A),y!==64){const w=f<<6&192|y;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class w$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C$=function(i){const e=nL(i);return iL.encodeByteArray(e,!0)},sL=function(i){return C$(i).replace(/\./g,"")},rL=function(i){try{return iL.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R$=()=>x$().__FIREBASE_DEFAULTS__,I$=()=>{if(typeof process>"u"||typeof VM>"u")return;const i=VM.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},N$=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&rL(i[1]);return e&&JSON.parse(e)},$w=()=>{try{return E$()||R$()||I$()||N$()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},M$=i=>{var e,t;return(t=(e=$w())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},oL=()=>{var i;return(i=$w())==null?void 0:i.config},aL=i=>{var e;return(e=$w())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function k$(i){return(await fetch(i,{credentials:"include"})).ok}const Og={};function P$(){const i={prod:[],emulator:[]};for(const e of Object.keys(Og))Og[e]?i.emulator.push(e):i.prod.push(e);return i}function L$(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let qM=!1;function O$(i,e){if(typeof window>"u"||typeof document>"u"||!v_(window.location.host)||Og[i]===e||Og[i]||qM)return;Og[i]=e;function t(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=P$().prod.length>0;function l(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,A){b.setAttribute("width","24"),b.setAttribute("id",A),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{qM=!0,l()},b}function g(b,A){b.setAttribute("id",A),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function y(){const b=L$(n),A=t("text"),w=document.getElementById(A)||document.createElement("span"),C=t("learnmore"),N=document.getElementById(C)||document.createElement("a"),I=t("preprendIcon"),P=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const k=b.element;c(k),g(N,C);const L=f();h(P,I),k.append(P,w,N,L),document.body.appendChild(k)}o?(w.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ti())}function F$(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lL(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function B$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function H$(){const i=Ti();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function cL(){try{return typeof indexedDB=="object"}catch{return!1}}function uL(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}function G$(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z$="FirebaseError";class go extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=z$,Object.setPrototypeOf(this,go.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fd.prototype.create)}}class fd{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?V$(o,n):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new go(s,c,n)}}function V$(i,e){return i.replace(q$,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const q$=/\{\$([^}]+)}/g;function $$(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function rd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const o=i[s],l=e[s];if($M(o)&&$M(l)){if(!rd(o,l))return!1}else if(o!==l)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function $M(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uy(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Dg(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,o]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function kg(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function Y$(i,e){const t=new X$(i,e);return t.subscribe.bind(t)}class X${constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");W$(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=nE),s.error===void 0&&(s.error=nE),s.complete===void 0&&(s.complete=nE);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function W$(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function nE(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$=1e3,J$=2,j$=14400*1e3,Q$=.5;function YM(i,e=K$,t=J$){const n=e*Math.pow(t,i),s=Math.round(Q$*n*(Math.random()-.5)*2);return Math.min(j$,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(i){return i&&i._delegate?i._delegate:i}class uo{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z${constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new D$;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(t9(e))try{this.getOrInitializeService({instanceIdentifier:Hc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(e=Hc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Hc){return this.instances.has(e)}getOptions(e=Hc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&l.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&e(o,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:e9(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Hc){return this.component?this.component.multipleInstances?e:Hc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function e9(i){return i===Hc?void 0:i}function t9(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Z$(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Lt||(Lt={}));const i9={debug:Lt.DEBUG,verbose:Lt.VERBOSE,info:Lt.INFO,warn:Lt.WARN,error:Lt.ERROR,silent:Lt.SILENT},s9=Lt.INFO,r9={[Lt.DEBUG]:"log",[Lt.VERBOSE]:"log",[Lt.INFO]:"info",[Lt.WARN]:"warn",[Lt.ERROR]:"error"},o9=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=r9[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yw{constructor(e){this.name=e,this._logLevel=s9,this._logHandler=o9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Lt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?i9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Lt.DEBUG,...e),this._logHandler(this,Lt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Lt.VERBOSE,...e),this._logHandler(this,Lt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Lt.INFO,...e),this._logHandler(this,Lt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Lt.WARN,...e),this._logHandler(this,Lt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Lt.ERROR,...e),this._logHandler(this,Lt.ERROR,...e)}}const a9=(i,e)=>e.some(t=>i instanceof t);let XM,WM;function l9(){return XM||(XM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function c9(){return WM||(WM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dL=new WeakMap,iw=new WeakMap,hL=new WeakMap,iE=new WeakMap,Xw=new WeakMap;function u9(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",o),i.removeEventListener("error",l)},o=()=>{t(lc(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",o),i.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&dL.set(t,i)}).catch(()=>{}),Xw.set(e,i),e}function d9(i){if(iw.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",l),i.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",o),i.addEventListener("error",l),i.addEventListener("abort",l)});iw.set(i,e)}let sw={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return iw.get(i);if(e==="objectStoreNames")return i.objectStoreNames||hL.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return lc(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function h9(i){sw=i(sw)}function f9(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(sE(this),e,...t);return hL.set(n,e.sort?e.sort():[e]),lc(n)}:c9().includes(i)?function(...e){return i.apply(sE(this),e),lc(dL.get(this))}:function(...e){return lc(i.apply(sE(this),e))}}function p9(i){return typeof i=="function"?f9(i):(i instanceof IDBTransaction&&d9(i),a9(i,l9())?new Proxy(i,sw):i)}function lc(i){if(i instanceof IDBRequest)return u9(i);if(iE.has(i))return iE.get(i);const e=p9(i);return e!==i&&(iE.set(i,e),Xw.set(e,i)),e}const sE=i=>Xw.get(i);function fL(i,e,{blocked:t,upgrade:n,blocking:s,terminated:o}={}){const l=indexedDB.open(i,e),c=lc(l);return n&&l.addEventListener("upgradeneeded",h=>{n(lc(l.result),h.oldVersion,h.newVersion,lc(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const g9=["get","getKey","getAll","getAllKeys","count"],m9=["put","add","delete","clear"],rE=new Map;function KM(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(rE.get(e))return rE.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=m9.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||g9.includes(t)))return;const o=async function(l,...c){const h=this.transaction(l,s?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),s&&h.done]))[0]};return rE.set(e,o),o}h9(i=>({...i,get:(e,t,n)=>KM(e,t)||i.get(e,t,n),has:(e,t)=>!!KM(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(v9(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function v9(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rw="@firebase/app",JM="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=new Yw("@firebase/app"),b9="@firebase/app-compat",_9="@firebase/analytics-compat",S9="@firebase/analytics",A9="@firebase/app-check-compat",E9="@firebase/app-check",T9="@firebase/auth",w9="@firebase/auth-compat",C9="@firebase/database",x9="@firebase/data-connect",R9="@firebase/database-compat",I9="@firebase/functions",N9="@firebase/functions-compat",M9="@firebase/installations",D9="@firebase/installations-compat",k9="@firebase/messaging",P9="@firebase/messaging-compat",L9="@firebase/performance",O9="@firebase/performance-compat",U9="@firebase/remote-config",F9="@firebase/remote-config-compat",B9="@firebase/storage",H9="@firebase/storage-compat",G9="@firebase/firestore",z9="@firebase/ai",V9="@firebase/firestore-compat",q9="firebase",$9="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="[DEFAULT]",Y9={[rw]:"fire-core",[b9]:"fire-core-compat",[S9]:"fire-analytics",[_9]:"fire-analytics-compat",[E9]:"fire-app-check",[A9]:"fire-app-check-compat",[T9]:"fire-auth",[w9]:"fire-auth-compat",[C9]:"fire-rtdb",[x9]:"fire-data-connect",[R9]:"fire-rtdb-compat",[I9]:"fire-fn",[N9]:"fire-fn-compat",[M9]:"fire-iid",[D9]:"fire-iid-compat",[k9]:"fire-fcm",[P9]:"fire-fcm-compat",[L9]:"fire-perf",[O9]:"fire-perf-compat",[U9]:"fire-rc",[F9]:"fire-rc-compat",[B9]:"fire-gcs",[H9]:"fire-gcs-compat",[G9]:"fire-fst",[V9]:"fire-fst-compat",[z9]:"fire-vertex","fire-js":"fire-js",[q9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=new Map,X9=new Map,aw=new Map;function jM(i,e){try{i.container.addComponent(e)}catch(t){Ia.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Na(i){const e=i.name;if(aw.has(e))return Ia.debug(`There were multiple attempts to register component ${e}.`),!1;aw.set(e,i);for(const t of xb.values())jM(t,i);for(const t of X9.values())jM(t,i);return!0}function cp(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function br(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cc=new fd("app","Firebase",W9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new uo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=$9;function pL(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:ow,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw cc.create("bad-app-name",{appName:String(s)});if(t||(t=oL()),!t)throw cc.create("no-options");const o=xb.get(s);if(o){if(rd(t,o.options)&&rd(n,o.config))return o;throw cc.create("duplicate-app",{appName:s})}const l=new n9(s);for(const h of aw.values())l.addComponent(h);const c=new K9(t,n,l);return xb.set(s,c),c}function gL(i=ow){const e=xb.get(i);if(!e&&i===ow&&oL())return pL();if(!e)throw cc.create("no-app",{appName:i});return e}function ao(i,e,t){let n=Y9[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${n}" with version "${e}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ia.warn(l.join(" "));return}Na(new uo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="firebase-heartbeat-database",j9=1,Xg="firebase-heartbeat-store";let oE=null;function mL(){return oE||(oE=fL(J9,j9,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Xg)}catch(t){console.warn(t)}}}}).catch(i=>{throw cc.create("idb-open",{originalErrorMessage:i.message})})),oE}async function Q9(i){try{const t=(await mL()).transaction(Xg),n=await t.objectStore(Xg).get(yL(i));return await t.done,n}catch(e){if(e instanceof go)Ia.warn(e.message);else{const t=cc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ia.warn(t.message)}}}async function QM(i,e){try{const n=(await mL()).transaction(Xg,"readwrite");await n.objectStore(Xg).put(e,yL(i)),await n.done}catch(t){if(t instanceof go)Ia.warn(t.message);else{const n=cc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ia.warn(n.message)}}}function yL(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z9=1024,eY=30;class tY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new iY(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ZM();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>eY){const l=sY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ia.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ZM(),{heartbeatsToSend:n,unsentEntries:s}=nY(this._heartbeatsCache.heartbeats),o=sL(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Ia.warn(t),""}}}function ZM(){return new Date().toISOString().substring(0,10)}function nY(i,e=Z9){const t=[];let n=i.slice();for(const s of i){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),eD(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),eD(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class iY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cL()?uL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Q9(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return QM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return QM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function eD(i){return sL(JSON.stringify({version:2,heartbeats:i})).length}function sY(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rY(i){Na(new uo("platform-logger",e=>new y9(e),"PRIVATE")),Na(new uo("heartbeat",e=>new tY(e),"PRIVATE")),ao(rw,JM,i),ao(rw,JM,"esm2020"),ao("fire-js","")}rY("");function vL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oY=vL,bL=new fd("auth","Firebase",vL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=new Yw("@firebase/auth");function aY(i,...e){Rb.logLevel<=Lt.WARN&&Rb.warn(`Auth (${Fy}): ${i}`,...e)}function sb(i,...e){Rb.logLevel<=Lt.ERROR&&Rb.error(`Auth (${Fy}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(i,...e){throw Ww(i,...e)}function lo(i,...e){return Ww(i,...e)}function _L(i,e,t){const n={...oY(),[e]:t};return new fd("auth","Firebase",n).create(e,{appName:i.name})}function Aa(i){return _L(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ww(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return bL.create(i,...e)}function De(i,e,...t){if(!i)throw Ww(e,...t)}function ba(i){const e="INTERNAL ASSERTION FAILED: "+i;throw sb(e),new Error(e)}function Ma(i,e){i||ba(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function lY(){return tD()==="http:"||tD()==="https:"}function tD(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lY()||lL()||"connection"in navigator)?navigator.onLine:!0}function uY(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ma(t>e,"Short delay should be less than long delay!"),this.isMobile=U$()||B$()}get(){return cY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(i,e){Ma(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ba("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ba("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ba("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fY=new By(3e4,6e4);function mc(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Oa(i,e,t,n,s={}){return AL(i,s,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const c=Uy({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const f={method:e,headers:h,...o};return F$()||(f.referrerPolicy="no-referrer"),i.emulatorConfig&&v_(i.emulatorConfig.host)&&(f.credentials="include"),SL.fetch()(await EL(i,i.config.apiHost,t,c),f)})}async function AL(i,e,t){i._canInitEmulator=!1;const n={...dY,...e};try{const s=new gY(i),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Ev(i,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[h,f]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ev(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Ev(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw Ev(i,"user-disabled",l);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw _L(i,g,f);wr(i,g)}}catch(s){if(s instanceof go)throw s;wr(i,"network-request-failed",{message:String(s)})}}async function Hy(i,e,t,n,s={}){const o=await Oa(i,e,t,n,s);return"mfaPendingCredential"in o&&wr(i,"multi-factor-auth-required",{_serverResponse:o}),o}async function EL(i,e,t,n){const s=`${e}${t}?${n}`,o=i,l=o.config.emulator?Kw(i.config,s):`${i.config.apiScheme}://${s}`;return hY.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function pY(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(lo(this.auth,"network-request-failed")),fY.get())})}}function Ev(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=lo(i,e,n);return s.customData._tokenResponse=t,s}function nD(i){return i!==void 0&&i.enterprise!==void 0}class mY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return pY(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yY(i,e){return Oa(i,"GET","/v2/recaptchaConfig",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vY(i,e){return Oa(i,"POST","/v1/accounts:delete",e)}async function Ib(i,e){return Oa(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bY(i,e=!1){const t=Es(i),n=await t.getIdToken(e),s=Jw(n);De(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:n,authTime:Ug(aE(s.auth_time)),issuedAtTime:Ug(aE(s.iat)),expirationTime:Ug(aE(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function aE(i){return Number(i)*1e3}function Jw(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return sb("JWT malformed, contained fewer than 3 sections"),null;try{const s=rL(t);return s?JSON.parse(s):(sb("Failed to decode base64 JWT payload"),null)}catch(s){return sb("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function iD(i){const e=Jw(i);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ip(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof go&&_Y(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function _Y({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ug(this.lastLoginAt),this.creationTime=Ug(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nb(i){var y;const e=i.auth,t=await i.getIdToken(),n=await ip(i,Ib(e,{idToken:t}));De(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const o=(y=s.providerUserInfo)!=null&&y.length?TL(s.providerUserInfo):[],l=EY(i.providerData,o),c=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new cw(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(i,g)}async function AY(i){const e=Es(i);await Nb(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EY(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function TL(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TY(i,e){const t=await AL(i,{},async()=>{const n=Uy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=i.config,l=await EL(i,s,"/v1/token",`key=${o}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return i.emulatorConfig&&v_(i.emulatorConfig.host)&&(h.credentials="include"),SL.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function wY(i,e){return Oa(i,"POST","/v2/accounts:revokeToken",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=iD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:o}=await TY(e,t);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:o}=t,l=new Eh;return n&&(De(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),s&&(De(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(De(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Eh,this.toJSON())}_performRefresh(){return ba("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(i,e){De(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class _r{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new SY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new cw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ip(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bY(this,e)}reload(){return AY(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Nb(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(Aa(this.auth));const e=await this.getIdToken();return await ip(this,vY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:y,emailVerified:b,isAnonymous:A,providerData:w,stsTokenManager:C}=t;De(y&&C,e,"internal-error");const N=Eh.fromJSON(this.name,C);De(typeof y=="string",e,"internal-error"),al(n,e.name),al(s,e.name),De(typeof b=="boolean",e,"internal-error"),De(typeof A=="boolean",e,"internal-error"),al(o,e.name),al(l,e.name),al(c,e.name),al(h,e.name),al(f,e.name),al(g,e.name);const I=new _r({uid:y,auth:e,email:s,emailVerified:b,displayName:n,isAnonymous:A,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:N,createdAt:f,lastLoginAt:g});return w&&Array.isArray(w)&&(I.providerData=w.map(P=>({...P}))),h&&(I._redirectEventId=h),I}static async _fromIdTokenResponse(e,t,n=!1){const s=new Eh;s.updateFromServerResponse(t);const o=new _r({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Nb(o),o}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];De(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?TL(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),c=new Eh;c.updateFromIdToken(n);const h=new _r({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new cw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new Map;function _a(i){Ma(i instanceof Function,"Expected a class definition");let e=sD.get(i);return e?(Ma(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,sD.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wL.type="NONE";const rD=wL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(i,e,t){return`firebase:${i}:${e}:${t}`}class Th{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=rb(this.userKey,s.apiKey,o),this.fullPersistenceKey=rb("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ib(this.auth,{idToken:e}).catch(()=>{});return t?_r._fromGetAccountInfoResponse(this.auth,t,e):null}return _r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Th(_a(rD),e,n);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||_a(rD);const l=rb(n,e.config.apiKey,e.name);let c=null;for(const f of t)try{const g=await f._get(l);if(g){let y;if(typeof g=="string"){const b=await Ib(e,{idToken:g}).catch(()=>{});if(!b)break;y=await _r._fromGetAccountInfoResponse(e,b,g)}else y=_r._fromJSON(e,g);f!==o&&(c=y),o=f;break}}catch{}const h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Th(o,e,n):(o=h[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new Th(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(IL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ML(e))return"Blackberry";if(DL(e))return"Webos";if(xL(e))return"Safari";if((e.includes("chrome/")||RL(e))&&!e.includes("edge/"))return"Chrome";if(NL(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function CL(i=Ti()){return/firefox\//i.test(i)}function xL(i=Ti()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function RL(i=Ti()){return/crios\//i.test(i)}function IL(i=Ti()){return/iemobile/i.test(i)}function NL(i=Ti()){return/android/i.test(i)}function ML(i=Ti()){return/blackberry/i.test(i)}function DL(i=Ti()){return/webos/i.test(i)}function jw(i=Ti()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function CY(i=Ti()){var e;return jw(i)&&!!((e=window.navigator)!=null&&e.standalone)}function xY(){return H$()&&document.documentMode===10}function kL(i=Ti()){return jw(i)||NL(i)||DL(i)||ML(i)||/windows phone/i.test(i)||IL(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(i,e=[]){let t;switch(i){case"Browser":t=oD(Ti());break;case"Worker":t=`${oD(Ti())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Fy}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((l,c)=>{try{const h=e(o);l(h)}catch(h){c(h)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IY(i,e={}){return Oa(i,"GET","/v2/passwordPolicy",mc(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=6;class MY{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??NY,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aD(this),this.idTokenSubscription=new aD(this),this.beforeStateQueue=new RY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_a(t)),this._initializationPromise=this.queue(async()=>{var n,s,o;if(!this._deleted&&(this.persistenceManager=await Th.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ib(this,{idToken:e}),n=await _r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(br(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,c=n==null?void 0:n._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&(h!=null&&h.user)&&(n=h.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nb(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(Aa(this));const t=e?Es(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(Aa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(Aa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_a(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IY(this),t=new MY(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fd("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await wY(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_a(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Th.create(this,[_a(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&aY(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function pd(i){return Es(i)}class aD{constructor(e){this.auth=e,this.observer=null,this.addObserver=Y$(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let b_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kY(i){b_=i}function LL(i){return b_.loadJS(i)}function PY(){return b_.recaptchaEnterpriseScript}function LY(){return b_.gapiScript}function OY(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class UY{constructor(){this.enterprise=new FY}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class FY{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const BY="recaptcha-enterprise",OL="NO_RECAPTCHA";class HY{constructor(e){this.type=BY,this.auth=pd(e)}async verify(e="verify",t=!1){async function n(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,c)=>{yY(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const f=new mY(h);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(h=>{c(h)})})}function s(o,l,c){const h=window.grecaptcha;nD(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(f=>{l(f)}).catch(()=>{l(OL)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new UY().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(c=>{if(!t&&nD(window.grecaptcha))s(c,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=PY();h.length!==0&&(h+=c),LL(h).then(()=>{s(c,o,l)}).catch(f=>{l(f)})}}).catch(c=>{l(c)})})}}async function lD(i,e,t,n=!1,s=!1){const o=new HY(i);let l;if(s)l=OL;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,f=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function uw(i,e,t,n,s){var o;if((o=i._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await lD(i,e,t,t==="getOobCode");return n(i,l)}else return n(i,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await lD(i,e,t,t==="getOobCode");return n(i,c)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GY(i,e){const t=cp(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(rd(o,e??{}))return s;wr(s,"already-initialized")}return t.initialize({options:e})}function zY(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(_a);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function VY(i,e,t){const n=pd(i);De(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,o=UL(e),{host:l,port:c}=qY(e),h=c===null?"":`:${c}`,f={url:`${o}//${l}${h}/`},g=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){De(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),De(rd(f,n.config.emulator)&&rd(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,v_(l)?(k$(`${o}//${l}${h}`),O$("Auth",!0)):$Y()}function UL(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function qY(i){const e=UL(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:cD(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:cD(l)}}}function cD(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function $Y(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ba("not implemented")}_getIdTokenResponse(e){return ba("not implemented")}_linkToIdToken(e,t){return ba("not implemented")}_getReauthenticationResolver(e){return ba("not implemented")}}async function YY(i,e){return Oa(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XY(i,e){return Hy(i,"POST","/v1/accounts:signInWithPassword",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WY(i,e){return Hy(i,"POST","/v1/accounts:signInWithEmailLink",mc(i,e))}async function KY(i,e){return Hy(i,"POST","/v1/accounts:signInWithEmailLink",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg extends Qw{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Wg(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Wg(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uw(e,t,"signInWithPassword",XY);case"emailLink":return WY(e,{email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uw(e,n,"signUpPassword",YY);case"emailLink":return KY(e,{idToken:t,email:this._email,oobCode:this._password});default:wr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wh(i,e){return Hy(i,"POST","/v1/accounts:signInWithIdp",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JY="http://localhost";class od extends Qw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new od(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...o}=t;if(!n||!s)return null;const l=new od(n,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return wh(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,wh(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wh(e,t)}buildRequest(){const e={requestUri:JY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Uy(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jY(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QY(i){const e=Dg(kg(i)).link,t=e?Dg(kg(e)).deep_link_id:null,n=Dg(kg(i)).deep_link_id;return(n?Dg(kg(n)).link:null)||n||t||e||i}class Zw{constructor(e){const t=Dg(kg(e)),n=t.apiKey??null,s=t.oobCode??null,o=jY(t.mode??null);De(n&&s&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=QY(e);try{return new Zw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this.providerId=up.PROVIDER_ID}static credential(e,t){return Wg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Zw.parseLink(t);return De(n,"argument-error"),Wg._fromEmailAndCode(e,n.code,n.tenantId)}}up.PROVIDER_ID="password";up.EMAIL_PASSWORD_SIGN_IN_METHOD="password";up.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy extends FL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl extends Gy{constructor(){super("facebook.com")}static credential(e){return od._fromParams({providerId:cl.PROVIDER_ID,signInMethod:cl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cl.credentialFromTaggedObject(e)}static credentialFromError(e){return cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cl.credential(e.oauthAccessToken)}catch{return null}}}cl.FACEBOOK_SIGN_IN_METHOD="facebook.com";cl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul extends Gy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return od._fromParams({providerId:ul.PROVIDER_ID,signInMethod:ul.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ul.credentialFromTaggedObject(e)}static credentialFromError(e){return ul.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ul.credential(t,n)}catch{return null}}}ul.GOOGLE_SIGN_IN_METHOD="google.com";ul.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl extends Gy{constructor(){super("github.com")}static credential(e){return od._fromParams({providerId:dl.PROVIDER_ID,signInMethod:dl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dl.credentialFromTaggedObject(e)}static credentialFromError(e){return dl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dl.credential(e.oauthAccessToken)}catch{return null}}}dl.GITHUB_SIGN_IN_METHOD="github.com";dl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl extends Gy{constructor(){super("twitter.com")}static credential(e,t){return od._fromParams({providerId:hl.PROVIDER_ID,signInMethod:hl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return hl.credentialFromTaggedObject(e)}static credentialFromError(e){return hl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return hl.credential(t,n)}catch{return null}}}hl.TWITTER_SIGN_IN_METHOD="twitter.com";hl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZY(i,e){return Hy(i,"POST","/v1/accounts:signUp",mc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const o=await _r._fromIdTokenResponse(e,n,s),l=uD(n);return new ad({user:o,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=uD(n);return new ad({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function uD(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb extends go{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Mb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Mb(e,t,n,s)}}function BL(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Mb._fromErrorAndOperation(i,o,e,n):o})}async function e7(i,e,t=!1){const n=await ip(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return ad._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t7(i,e,t=!1){const{auth:n}=i;if(br(n.app))return Promise.reject(Aa(n));const s="reauthenticate";try{const o=await ip(i,BL(n,s,e,i),t);De(o.idToken,n,"internal-error");const l=Jw(o.idToken);De(l,n,"internal-error");const{sub:c}=l;return De(i.uid===c,n,"user-mismatch"),ad._forOperation(i,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&wr(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HL(i,e,t=!1){if(br(i.app))return Promise.reject(Aa(i));const n="signIn",s=await BL(i,n,e),o=await ad._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(o.user),o}async function n7(i,e){return HL(pd(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GL(i){const e=pd(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function i7(i,e,t){if(br(i.app))return Promise.reject(Aa(i));const n=pd(i),l=await uw(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ZY).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&GL(i),h}),c=await ad._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function s7(i,e,t){return br(i.app)?Promise.reject(Aa(i)):n7(Es(i),up.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&GL(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r7(i,e){return Oa(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o7(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=Es(i),o={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await ip(n,r7(n.auth,o));n.displayName=l.displayName||null,n.photoURL=l.photoUrl||null;const c=n.providerData.find(({providerId:h})=>h==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(l)}function a7(i,e,t,n){return Es(i).onIdTokenChanged(e,t,n)}function l7(i,e,t){return Es(i).beforeAuthStateChanged(e,t)}function c7(i,e,t,n){return Es(i).onAuthStateChanged(e,t,n)}function u7(i){return Es(i).signOut()}const Db="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Db,"1"),this.storage.removeItem(Db),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7=1e3,h7=10;class VL extends zL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);xY()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,h7):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},d7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}VL.type="LOCAL";const f7=VL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL extends zL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}qL.type="SESSION";const $L=qL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new __(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(l).map(async f=>f(t.origin,o)),h=await p7(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}__.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((c,h)=>{const f=eC("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(y){const b=y;if(b.data.eventId===f)switch(b.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function co(){return window}function m7(i){co().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(){return typeof co().WorkerGlobalScope<"u"&&typeof co().importScripts=="function"}async function y7(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function v7(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function b7(){return YL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL="firebaseLocalStorageDb",_7=1,kb="firebaseLocalStorage",WL="fbase_key";class zy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function S_(i,e){return i.transaction([kb],e?"readwrite":"readonly").objectStore(kb)}function S7(){const i=indexedDB.deleteDatabase(XL);return new zy(i).toPromise()}function dw(){const i=indexedDB.open(XL,_7);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(kb,{keyPath:WL})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(kb)?e(n):(n.close(),await S7(),e(await dw()))})})}async function dD(i,e,t){const n=S_(i,!0).put({[WL]:e,value:t});return new zy(n).toPromise()}async function A7(i,e){const t=S_(i,!1).get(e),n=await new zy(t).toPromise();return n===void 0?null:n.value}function hD(i,e){const t=S_(i,!0).delete(e);return new zy(t).toPromise()}const E7=800,T7=3;class KL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>T7)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return YL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=__._getInstance(b7()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await y7(),!this.activeServiceWorker)return;this.sender=new g7(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||v7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dw();return await dD(e,Db,"1"),await hD(e,Db),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>dD(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>A7(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hD(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=S_(s,!1).getAll();return new zy(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),E7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KL.type="LOCAL";const w7=KL;new By(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C7(i,e){return e?_a(e):(De(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC extends Qw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function x7(i){return HL(i.auth,new tC(i),i.bypassAuthState)}function R7(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),t7(t,new tC(i),i.bypassAuthState)}async function I7(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),e7(t,new tC(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,t,n,s,o=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return x7;case"linkViaPopup":case"linkViaRedirect":return I7;case"reauthViaPopup":case"reauthViaRedirect":return R7;default:wr(this.auth,"internal-error")}}resolve(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N7=new By(2e3,1e4);class hh extends JL{constructor(e,t,n,s,o){super(e,t,s,o),this.provider=n,this.authWindow=null,this.pollId=null,hh.currentPopupAction&&hh.currentPopupAction.cancel(),hh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Ma(this.filter.length===1,"Popup operations only handle one event");const e=eC();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(lo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,N7.get())};e()}}hh.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7="pendingRedirect",ob=new Map;class D7 extends JL{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ob.get(this.auth._key());if(!e){try{const n=await k7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ob.set(this.auth._key(),e)}return this.bypassAuthState||ob.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k7(i,e){const t=O7(e),n=L7(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function P7(i,e){ob.set(i._key(),e)}function L7(i){return _a(i._redirectPersistence)}function O7(i){return rb(M7,i.config.apiKey,i.name)}async function U7(i,e,t=!1){if(br(i.app))return Promise.reject(Aa(i));const n=pd(i),s=C7(n,e),l=await new D7(n,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7=600*1e3;class B7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!H7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!jL(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(lo(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=F7&&this.cachedEventUids.clear(),this.cachedEventUids.has(fD(e))}saveEventToCache(e){this.cachedEventUids.add(fD(e)),this.lastProcessedEventTime=Date.now()}}function fD(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function jL({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function H7(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jL(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G7(i,e={}){return Oa(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,V7=/^https?/;async function q7(i){if(i.config.emulator)return;const{authorizedDomains:e}=await G7(i);for(const t of e)try{if($7(t))return}catch{}wr(i,"unauthorized-domain")}function $7(i){const e=lw(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!V7.test(t))return!1;if(z7.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y7=new By(3e4,6e4);function pD(){const i=co().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function X7(i){return new Promise((e,t)=>{var s,o,l;function n(){pD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pD(),t(lo(i,"network-request-failed"))},timeout:Y7.get()})}if((o=(s=co().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=co().gapi)!=null&&l.load)n();else{const c=OY("iframefcb");return co()[c]=()=>{gapi.load?n():t(lo(i,"network-request-failed"))},LL(`${LY()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw ab=null,e})}let ab=null;function W7(i){return ab=ab||X7(i),ab}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K7=new By(5e3,15e3),J7="__/auth/iframe",j7="emulator/auth/iframe",Q7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Z7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eX(i){const e=i.config;De(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Kw(e,j7):`https://${i.config.authDomain}/${J7}`,n={apiKey:e.apiKey,appName:i.name,v:Fy},s=Z7.get(i.config.apiHost);s&&(n.eid=s);const o=i._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Uy(n).slice(1)}`}async function tX(i){const e=await W7(i),t=co().gapi;return De(t,i,"internal-error"),e.open({where:document.body,url:eX(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Q7,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const l=lo(i,"network-request-failed"),c=co().setTimeout(()=>{o(l)},K7.get());function h(){co().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iX=500,sX=600,rX="_blank",oX="http://localhost";class gD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aX(i,e,t,n=iX,s=sX){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...nX,width:n.toString(),height:s.toString(),top:o,left:l},f=Ti().toLowerCase();t&&(c=RL(f)?rX:t),CL(f)&&(e=e||oX,h.scrollbars="yes");const g=Object.entries(h).reduce((b,[A,w])=>`${b}${A}=${w},`,"");if(CY(f)&&c!=="_self")return lX(e||"",c),new gD(null);const y=window.open(e||"",c,g);De(y,i,"popup-blocked");try{y.focus()}catch{}return new gD(y)}function lX(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX="__/auth/handler",uX="emulator/auth/handler",dX=encodeURIComponent("fac");async function mD(i,e,t,n,s,o){De(i.config.authDomain,i,"auth-domain-config-required"),De(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Fy,eventId:s};if(e instanceof FL){e.setDefaultLanguage(i.languageCode),l.providerId=e.providerId||"",$$(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries({}))l[g]=y}if(e instanceof Gy){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(l.scopes=g.join(","))}i.tenantId&&(l.tid=i.tenantId);const c=l;for(const g of Object.keys(c))c[g]===void 0&&delete c[g];const h=await i._getAppCheckToken(),f=h?`#${dX}=${encodeURIComponent(h)}`:"";return`${hX(i)}?${Uy(c).slice(1)}${f}`}function hX({config:i}){return i.emulator?Kw(i,uX):`https://${i.authDomain}/${cX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE="webStorageSupport";class fX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$L,this._completeRedirectFn=U7,this._overrideRedirectResult=P7}async _openPopup(e,t,n,s){var l;Ma((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await mD(e,t,n,lw(),s);return aX(e,o,eC())}async _openRedirect(e,t,n,s){await this._originValidation(e);const o=await mD(e,t,n,lw(),s);return m7(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Ma(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await tX(e),n=new B7(e);return t.register("authEvent",s=>(De(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(lE,{type:lE},s=>{var l;const o=(l=s==null?void 0:s[0])==null?void 0:l[lE];o!==void 0&&t(!!o),wr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=q7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kL()||xL()||jw()}}const pX=fX;var yD="@firebase/auth",vD="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mX(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yX(i){Na(new uo("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;De(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PL(i)},f=new DY(n,s,o,h);return zY(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Na(new uo("auth-internal",e=>{const t=pd(e.getProvider("auth").getImmediate());return(n=>new gX(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ao(yD,vD,mX(i)),ao(yD,vD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vX=300,bX=aL("authIdTokenMaxAge")||vX;let bD=null;const _X=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>bX)return;const s=t==null?void 0:t.token;bD!==s&&(bD=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function SX(i=gL()){const e=cp(i,"auth");if(e.isInitialized())return e.getImmediate();const t=GY(i,{popupRedirectResolver:pX,persistence:[w7,f7,$L]}),n=aL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=_X(o.toString());l7(t,l,()=>l(t.currentUser)),a7(t,c=>l(c))}}const s=M$("auth");return s&&VY(t,`http://${s}`),t}function AX(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}kY({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const o=lo("internal-error");o.customData=s,t(o)},n.type="text/javascript",n.charset="UTF-8",AX().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yX("Browser");var EX="firebase",TX="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ao(EX,TX,"app");const QL="@firebase/installations",nC="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=1e4,eO=`w:${nC}`,tO="FIS_v2",wX="https://firebaseinstallations.googleapis.com/v1",CX=3600*1e3,xX="installations",RX="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IX={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ld=new fd(xX,RX,IX);function nO(i){return i instanceof go&&i.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO({projectId:i}){return`${wX}/projects/${i}/installations`}function sO(i){return{token:i.token,requestStatus:2,expiresIn:MX(i.expiresIn),creationTime:Date.now()}}async function rO(i,e){const n=(await e.json()).error;return ld.create("request-failed",{requestName:i,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function oO({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function NX(i,{refreshToken:e}){const t=oO(i);return t.append("Authorization",DX(e)),t}async function aO(i){const e=await i();return e.status>=500&&e.status<600?i():e}function MX(i){return Number(i.replace("s","000"))}function DX(i){return`${tO} ${i}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kX({appConfig:i,heartbeatServiceProvider:e},{fid:t}){const n=iO(i),s=oO(i),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={fid:t,authVersion:tO,appId:i.appId,sdkVersion:eO},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await aO(()=>fetch(n,c));if(h.ok){const f=await h.json();return{fid:f.fid||t,registrationStatus:2,refreshToken:f.refreshToken,authToken:sO(f.authToken)}}else throw await rO("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PX(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LX=/^[cdef][\w-]{21}$/,hw="";function OX(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const t=UX(i);return LX.test(t)?t:hw}catch{return hw}}function UX(i){return PX(i).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(i){return`${i.appName}!${i.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO=new Map;function uO(i,e){const t=A_(i);dO(t,e),FX(t,e)}function dO(i,e){const t=cO.get(i);if(t)for(const n of t)n(e)}function FX(i,e){const t=BX();t&&t.postMessage({key:i,fid:e}),HX()}let qc=null;function BX(){return!qc&&"BroadcastChannel"in self&&(qc=new BroadcastChannel("[Firebase] FID Change"),qc.onmessage=i=>{dO(i.data.key,i.data.fid)}),qc}function HX(){cO.size===0&&qc&&(qc.close(),qc=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GX="firebase-installations-database",zX=1,cd="firebase-installations-store";let cE=null;function iC(){return cE||(cE=fL(GX,zX,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(cd)}}})),cE}async function Pb(i,e){const t=A_(i),s=(await iC()).transaction(cd,"readwrite"),o=s.objectStore(cd),l=await o.get(t);return await o.put(e,t),await s.done,(!l||l.fid!==e.fid)&&uO(i,e.fid),e}async function hO(i){const e=A_(i),n=(await iC()).transaction(cd,"readwrite");await n.objectStore(cd).delete(e),await n.done}async function E_(i,e){const t=A_(i),s=(await iC()).transaction(cd,"readwrite"),o=s.objectStore(cd),l=await o.get(t),c=e(l);return c===void 0?await o.delete(t):await o.put(c,t),await s.done,c&&(!l||l.fid!==c.fid)&&uO(i,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sC(i){let e;const t=await E_(i.appConfig,n=>{const s=VX(n),o=qX(i,s);return e=o.registrationPromise,o.installationEntry});return t.fid===hw?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function VX(i){const e=i||{fid:OX(),registrationStatus:0};return fO(e)}function qX(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(ld.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=$X(i,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:YX(i)}:{installationEntry:e}}async function $X(i,e){try{const t=await kX(i,e);return Pb(i.appConfig,t)}catch(t){throw nO(t)&&t.customData.serverCode===409?await hO(i.appConfig):await Pb(i.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function YX(i){let e=await _D(i.appConfig);for(;e.registrationStatus===1;)await lO(100),e=await _D(i.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await sC(i);return n||t}return e}function _D(i){return E_(i,e=>{if(!e)throw ld.create("installation-not-found");return fO(e)})}function fO(i){return XX(i)?{fid:i.fid,registrationStatus:0}:i}function XX(i){return i.registrationStatus===1&&i.registrationTime+ZL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WX({appConfig:i,heartbeatServiceProvider:e},t){const n=KX(i,t),s=NX(i,t),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={installation:{sdkVersion:eO,appId:i.appId}},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await aO(()=>fetch(n,c));if(h.ok){const f=await h.json();return sO(f)}else throw await rO("Generate Auth Token",h)}function KX(i,{fid:e}){return`${iO(i)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rC(i,e=!1){let t;const n=await E_(i.appConfig,o=>{if(!pO(o))throw ld.create("not-registered");const l=o.authToken;if(!e&&QX(l))return o;if(l.requestStatus===1)return t=JX(i,e),o;{if(!navigator.onLine)throw ld.create("app-offline");const c=eW(o);return t=jX(i,c),c}});return t?await t:n.authToken}async function JX(i,e){let t=await SD(i.appConfig);for(;t.authToken.requestStatus===1;)await lO(100),t=await SD(i.appConfig);const n=t.authToken;return n.requestStatus===0?rC(i,e):n}function SD(i){return E_(i,e=>{if(!pO(e))throw ld.create("not-registered");const t=e.authToken;return tW(t)?{...e,authToken:{requestStatus:0}}:e})}async function jX(i,e){try{const t=await WX(i,e),n={...e,authToken:t};return await Pb(i.appConfig,n),t}catch(t){if(nO(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await hO(i.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Pb(i.appConfig,n)}throw t}}function pO(i){return i!==void 0&&i.registrationStatus===2}function QX(i){return i.requestStatus===2&&!ZX(i)}function ZX(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+CX}function eW(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function tW(i){return i.requestStatus===1&&i.requestTime+ZL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nW(i){const e=i,{installationEntry:t,registrationPromise:n}=await sC(e);return n?n.catch(console.error):rC(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iW(i,e=!1){const t=i;return await sW(t),(await rC(t,e)).token}async function sW(i){const{registrationPromise:e}=await sC(i);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rW(i){if(!i||!i.options)throw uE("App Configuration");if(!i.name)throw uE("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!i.options[t])throw uE(t);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function uE(i){return ld.create("missing-app-config-values",{valueName:i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO="installations",oW="installations-internal",aW=i=>{const e=i.getProvider("app").getImmediate(),t=rW(e),n=cp(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},lW=i=>{const e=i.getProvider("app").getImmediate(),t=cp(e,gO).getImmediate();return{getId:()=>nW(t),getToken:s=>iW(t,s)}};function cW(){Na(new uo(gO,aW,"PUBLIC")),Na(new uo(oW,lW,"PRIVATE"))}cW();ao(QL,nC);ao(QL,nC,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb="analytics",uW="firebase_id",dW="origin",hW=60*1e3,fW="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",oC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new Yw("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},_s=new fd("analytics","Analytics",pW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(i){if(!i.startsWith(oC)){const e=_s.create("invalid-gtag-resource",{gtagURL:i});return Si.warn(e.message),""}return i}function mO(i){return Promise.all(i.map(e=>e.catch(t=>t)))}function mW(i,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(i,e)),t}function yW(i,e){const t=mW("firebase-js-sdk-policy",{createScriptURL:gW}),n=document.createElement("script"),s=`${oC}?l=${i}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function vW(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function bW(i,e,t,n,s,o){const l=n[s];try{if(l)await e[l];else{const h=(await mO(t)).find(f=>f.measurementId===s);h&&await e[h.appId]}}catch(c){Si.error(c)}i("config",s,o)}async function _W(i,e,t,n,s){try{let o=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const c=await mO(t);for(const h of l){const f=c.find(y=>y.measurementId===h),g=f&&e[f.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),i("event",n,s||{})}catch(o){Si.error(o)}}function SW(i,e,t,n){async function s(o,...l){try{if(o==="event"){const[c,h]=l;await _W(i,e,t,c,h)}else if(o==="config"){const[c,h]=l;await bW(i,e,t,n,c,h)}else if(o==="consent"){const[c,h]=l;i("consent",c,h)}else if(o==="get"){const[c,h,f]=l;i("get",c,h,f)}else if(o==="set"){const[c]=l;i("set",c)}else i(o,...l)}catch(c){Si.error(c)}}return s}function AW(i,e,t,n,s){let o=function(...l){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=SW(o,i,e,t),{gtagCore:o,wrappedGtag:window[s]}}function EW(i){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(oC)&&t.src.includes(i))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=30,wW=1e3;class CW{constructor(e={},t=wW){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const yO=new CW;function xW(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function RW(i){var l;const{appId:e,apiKey:t}=i,n={method:"GET",headers:xW(t)},s=fW.replace("{app-id}",e),o=await fetch(s,n);if(o.status!==200&&o.status!==304){let c="";try{const h=await o.json();(l=h.error)!=null&&l.message&&(c=h.error.message)}catch{}throw _s.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}async function IW(i,e=yO,t){const{appId:n,apiKey:s,measurementId:o}=i.options;if(!n)throw _s.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:n};throw _s.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new DW;return setTimeout(async()=>{c.abort()},hW),vO({appId:n,apiKey:s,measurementId:o},l,c,e)}async function vO(i,{throttleEndTimeMillis:e,backoffCount:t},n,s=yO){var c;const{appId:o,measurementId:l}=i;try{await NW(n,e)}catch(h){if(l)return Si.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:l};throw h}try{const h=await RW(i);return s.deleteThrottleMetadata(o),h}catch(h){const f=h;if(!MW(f)){if(s.deleteThrottleMetadata(o),l)return Si.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:o,measurementId:l};throw h}const g=Number((c=f==null?void 0:f.customData)==null?void 0:c.httpStatus)===503?YM(t,s.intervalMillis,TW):YM(t,s.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return s.setThrottleMetadata(o,y),Si.debug(`Calling attemptFetch again in ${g} millis`),vO(i,y,n,s)}}function NW(i,e){return new Promise((t,n)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);i.addEventListener(()=>{clearTimeout(o),n(_s.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function MW(i){if(!(i instanceof go)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class DW{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function kW(i,e,t,n,s){if(s&&s.global){i("event",t,n);return}else{const o=await e,l={...n,send_to:o};i("event",t,l)}}async function PW(i,e,t,n){if(n&&n.global){const s={};for(const o of Object.keys(t))s[`user_properties.${o}`]=t[o];return i("set",s),Promise.resolve()}else{const s=await e;i("config",s,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LW(){if(cL())try{await uL()}catch(i){return Si.warn(_s.create("indexeddb-unavailable",{errorInfo:i==null?void 0:i.toString()}).message),!1}else return Si.warn(_s.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function OW(i,e,t,n,s,o,l){const c=IW(i);c.then(b=>{t[b.measurementId]=b.appId,i.options.measurementId&&b.measurementId!==i.options.measurementId&&Si.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>Si.error(b)),e.push(c);const h=LW().then(b=>{if(b)return n.getId()}),[f,g]=await Promise.all([c,h]);EW(o)||yW(o,f.measurementId),s("js",new Date);const y=(l==null?void 0:l.config)??{};return y[dW]="firebase",y.update=!0,g!=null&&(y[uW]=g),s("config",f.measurementId,y),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(e){this.app=e}_delete(){return delete Ch[this.app.options.appId],Promise.resolve()}}let Ch={},AD=[];const ED={};let dE="dataLayer",FW="gtag",TD,aC,wD=!1;function BW(){const i=[];if(lL()&&i.push("This is a browser extension environment."),G$()||i.push("Cookies are not available."),i.length>0){const e=i.map((n,s)=>`(${s+1}) ${n}`).join(" "),t=_s.create("invalid-analytics-context",{errorInfo:e});Si.warn(t.message)}}function HW(i,e,t){BW();const n=i.options.appId;if(!n)throw _s.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)Si.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw _s.create("no-api-key");if(Ch[n]!=null)throw _s.create("already-exists",{id:n});if(!wD){vW(dE);const{wrappedGtag:o,gtagCore:l}=AW(Ch,AD,ED,dE,FW);aC=o,TD=l,wD=!0}return Ch[n]=OW(i,AD,ED,e,TD,dE,t),new UW(i)}function GW(i=gL()){i=Es(i);const e=cp(i,Lb);return e.isInitialized()?e.getImmediate():zW(i)}function zW(i,e={}){const t=cp(i,Lb);if(t.isInitialized()){const s=t.getImmediate();if(rd(e,t.getOptions()))return s;throw _s.create("already-initialized")}return t.initialize({options:e})}function VW(i,e,t){i=Es(i),PW(aC,Ch[i.app.options.appId],e,t).catch(n=>Si.error(n))}function qW(i,e,t,n){i=Es(i),kW(aC,Ch[i.app.options.appId],e,t,n).catch(s=>Si.error(s))}const CD="@firebase/analytics",xD="0.10.19";function $W(){Na(new uo(Lb,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return HW(n,s,t)},"PUBLIC")),Na(new uo("analytics-internal",i,"PRIVATE")),ao(CD,xD),ao(CD,xD,"esm2020");function i(e){try{const t=e.getProvider(Lb).getImmediate();return{logEvent:(n,s,o)=>qW(t,n,s,o),setUserProperties:(n,s)=>VW(t,n,s)}}catch(t){throw _s.create("interop-component-reg-failed",{reason:t})}}}$W();const YW={apiKey:"AIzaSyDGAI-Y0jWMkkTwVa3pWRYTRnIjeR5IgDo",authDomain:"suitcase-e579b.firebaseapp.com",projectId:"suitcase-e579b",storageBucket:"suitcase-e579b.firebasestorage.app",messagingSenderId:"535507830039",appId:"1:535507830039:web:1380d5f29396b0a614e352",measurementId:"G-1E9GL03TX0"},bO=pL(YW);GW(bO);const Pg=SX(bO),lb=i=>({id:i.uid,email:i.email||"",name:i.displayName||"Traveler"}),fw={signup:async(i,e,t)=>{try{const n=await i7(Pg,e,t);return await o7(n.user,{displayName:i}),lb({...n.user,displayName:i})}catch(n){throw console.error("Signup Error:",n),new Error(RD(n.code))}},login:async(i,e)=>{try{const t=await s7(Pg,i,e);return lb(t.user)}catch(t){throw console.error("Login Error:",t),new Error(RD(t.code))}},logout:async()=>{try{await u7(Pg)}catch(i){console.error("Logout Error",i)}},getCurrentUser:()=>{const i=Pg.currentUser;return i?lb(i):null}},RD=i=>{switch(i){case"auth/email-already-in-use":return"That email is already registered.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":return"Invalid email or password.";case"auth/weak-password":return"Password should be at least 6 characters.";default:return"Authentication failed. Please try again."}},XW=({onSuccess:i})=>{const[e,t]=Z.useState(!0),[n,s]=Z.useState(!1),[o,l]=Z.useState(null),[c,h]=Z.useState(""),[f,g]=Z.useState(""),[y,b]=Z.useState(""),A=async w=>{w.preventDefault(),l(null),s(!0);try{let C;if(e)C=await fw.login(f,y);else{if(!c.trim())throw new Error("Name is required");C=await fw.signup(c,f,y)}i(C)}catch(C){l(C.message||"Something went wrong")}finally{s(!1)}};return T.jsxs("div",{className:"min-h-screen bg-white flex flex-col md:flex-row relative",children:[T.jsxs("div",{className:"w-full md:w-1/2 bg-[#F5F5F7] p-8 md:p-12 flex flex-col justify-between relative overflow-hidden h-[30vh] md:h-auto",children:[T.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-tr from-blue-200 to-purple-200 rounded-full blur-[80px] opacity-60 animate-float pointer-events-none"}),T.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[T.jsx("div",{className:"p-2 bg-black text-white rounded-xl",children:T.jsx(DD,{size:24})}),T.jsx("span",{className:"font-serif font-bold text-2xl tracking-tight text-gray-900",children:"Suitcase"})]}),T.jsxs("div",{className:"relative z-10 hidden md:block",children:[T.jsxs("h1",{className:"text-5xl lg:text-7xl font-serif font-bold text-gray-900 mb-6 leading-[1.1]",children:["Pack your ",T.jsx("br",{})," ",T.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"imagination."})]}),T.jsx("p",{className:"text-xl text-gray-500 max-w-md leading-relaxed",children:"Your intelligent travel companion for literary journeys. Discover, read, and collect books with smart insights."})]}),T.jsx("div",{className:"relative z-10 md:hidden mt-4",children:T.jsx("h1",{className:"text-3xl font-serif font-bold text-gray-900",children:"Your literary journey starts here."})}),T.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm font-bold text-gray-400 uppercase tracking-widest",children:[T.jsx(bs,{size:16,className:"text-yellow-500"}),T.jsx("span",{children:"Next Gen Library"})]})]}),T.jsx("div",{className:"w-full md:w-1/2 p-8 md:p-20 flex flex-col justify-center bg-white -mt-6 md:mt-0 rounded-t-[2rem] md:rounded-none shadow-[0_-10px_40px_-10px_rgba(0,0,0,0.1)] md:shadow-none z-20",children:T.jsxs("div",{className:"max-w-md w-full mx-auto",children:[T.jsxs("div",{className:"mb-8",children:[T.jsx("h2",{className:"text-3xl font-serif font-bold text-gray-900 mb-2",children:e?"Welcome back":"Create account"}),T.jsx("p",{className:"text-gray-500",children:e?"Enter your details to access your library.":"Start building your digital suitcase today."})]}),o&&T.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-xl flex items-center gap-2 text-sm font-medium animate-in slide-in-from-top-2",children:[T.jsx(fB,{size:16}),o]}),T.jsxs("form",{onSubmit:A,className:"space-y-4",children:[!e&&T.jsxs("div",{className:"space-y-1 animate-in fade-in slide-in-from-bottom-2",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Full Name"}),T.jsx("input",{type:"text",value:c,onChange:w=>h(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"Ernest Hemingway"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Email Address"}),T.jsx("input",{type:"email",value:f,onChange:w=>g(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"reader@example.com",autoComplete:"email"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Password"}),T.jsx("input",{type:"password",value:y,onChange:w=>b(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"",autoComplete:"current-password"})]}),T.jsx("button",{type:"submit",disabled:n,className:"w-full bg-black text-white py-5 rounded-2xl font-bold text-lg hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 mt-4 shadow-xl shadow-gray-200",children:n?T.jsx(ac,{className:"animate-spin"}):T.jsxs(T.Fragment,{children:[e?"Sign In":"Create Account"," ",T.jsx(mw,{size:20})]})})]}),T.jsx("div",{className:"mt-8 text-center",children:T.jsx("button",{onClick:()=>{t(!e),l(null)},className:"text-sm font-semibold text-gray-500 hover:text-black transition-colors",children:e?"New to Suitcase? Create an account":"Already have an account? Log in"})})]})}),T.jsx("div",{className:"absolute bottom-4 right-8 z-30 hidden md:block",children:T.jsxs("p",{className:"text-xs font-medium text-gray-400 flex items-center gap-1",children:["Crafted with ",T.jsx(CB,{size:10,className:"fill-red-400 text-red-400"})," by Yashraj Pardeshi (@incyashraj)"]})})]})},Ea=(i,e)=>`suitcase_${i}_${e}`,WW=(i,e)=>{try{localStorage.setItem(Ea(i,"prefs"),JSON.stringify(e))}catch(t){console.error("Failed to save prefs",t)}},KW=i=>{try{const e=localStorage.getItem(Ea(i,"prefs"));return e?JSON.parse(e):null}catch{return null}},JW=(i,e)=>{try{const t=e.map(n=>({...n,fileUrl:n.isLocal?void 0:n.fileUrl}));localStorage.setItem(Ea(i,"library"),JSON.stringify(t))}catch(t){console.error("Failed to save library",t)}},jW=i=>{try{const e=localStorage.getItem(Ea(i,"library"));return e?JSON.parse(e):[]}catch{return[]}},QW=(i,e)=>{try{localStorage.setItem(Ea(i,"wallet"),JSON.stringify(e))}catch(t){console.error("Failed to save wallet",t)}},ZW=i=>{try{const e=localStorage.getItem(Ea(i,"wallet"));return e?JSON.parse(e):{balance:0,nfts:[]}}catch{return{balance:0,nfts:[]}}},eK=i=>{localStorage.removeItem(Ea(i,"prefs")),localStorage.removeItem(Ea(i,"library")),localStorage.removeItem(Ea(i,"wallet")),window.location.reload()};function tK(){const[i,e]=Z.useState(null),[t,n]=Z.useState("auth"),[s,o]=Z.useState(null),[l,c]=Z.useState([]),[h,f]=Z.useState(null),[g,y]=Z.useState({balance:0,nfts:[]}),[b,A]=Z.useState(!1),[w,C]=Z.useState([]),[N,I]=Z.useState([]),[P,k]=Z.useState([]),[L,O]=Z.useState(""),[U,F]=Z.useState(""),[K,q]=Z.useState(!1),[Q,ee]=Z.useState(!1),[se,le]=Z.useState("library"),[ue,me]=Z.useState(!1),[G,$]=Z.useState(!1),oe=Z.useRef(null),pe=Z.useRef(null),Me=Z.useRef(null);Z.useEffect(()=>{const ae=c7(Pg,Ge=>{if(Ge){const Re=lb(Ge);e(Re),H(Re.id)}else e(null),n("auth"),A(!0)});return()=>ae()},[]);const H=ae=>{const Ge=KW(ae),Re=jW(ae),hn=ZW(ae);f(Ge),c(Re),y(hn),A(!0),Ge?(n("library"),YA(Ge).then(wi=>{wi&&wi.length>0&&I(wi)})):n("onboarding")};Z.useEffect(()=>{i&&b&&h&&WW(i.id,h)},[h,b,i]),Z.useEffect(()=>{i&&b&&JW(i.id,l)},[l,b,i]),Z.useEffect(()=>{i&&b&&QW(i.id,g)},[g,b,i]),Z.useEffect(()=>{se==="search"&&pe.current&&pe.current.focus()},[se]),Z.useEffect(()=>{var ae;se==="mood"&&((ae=Me.current)==null||ae.scrollIntoView({behavior:"smooth"}))},[P,se]);const J=()=>{const ae=new Date().getHours();return ae<12?"Good morning":ae<18?"Good afternoon":"Good evening"},re=ae=>{e(ae),H(ae.id)},de=async()=>{await fw.logout(),f(null),c([]),y({balance:0,nfts:[]})},_e=ae=>{var Re;const Ge=(Re=ae.target.files)==null?void 0:Re[0];Ge&&Ge.type==="application/pdf"&&Je(Ge)},Ce=ae=>{ae.preventDefault(),ae.stopPropagation(),me(!0)},Ee=ae=>{ae.preventDefault(),ae.stopPropagation(),!ae.currentTarget.contains(ae.relatedTarget)&&me(!1)},st=ae=>{ae.preventDefault(),ae.stopPropagation(),me(!1);const Ge=ae.dataTransfer.files;Ge&&Ge.length>0&&Ge[0].type==="application/pdf"&&Je(Ge[0])},Je=ae=>{const Ge={id:`local-${Date.now()}`,title:ae.name.replace(".pdf",""),author:"My Document",description:"Imported PDF document from local device.",coverColor:It(),fileUrl:URL.createObjectURL(ae),isLocal:!0,categories:["Uploads"],publishedYear:new Date().getFullYear().toString()};c(Re=>[Ge,...Re]),se!=="library"&&le("library")},It=()=>{const ae=["#e0f2fe","#f0fdf4","#fdf4ff","#fff1f2","#fefce8"];return ae[Math.floor(Math.random()*ae.length)]},Xe=async ae=>{if(ae.preventDefault(),!U.trim())return;q(!0),C([]),ee(!1);const Ge=await MV(U);C(Ge),ee(!0),q(!1)},Cn=async ae=>{if(ae.preventDefault(),!L.trim())return;const Ge=L;O(""),q(!0),k(di=>[...di,{role:"user",text:Ge}]);const Re=P.map(di=>({role:di.role,text:di.text})),{reply:hn,suggestions:wi}=await DV(Ge,Re);k(di=>[...di,{role:"model",text:hn,books:wi}]),q(!1)},rt=async ae=>{$(!0),f(ae),y({balance:100,nfts:[]});const Ge=new Promise(di=>setTimeout(di,2500)),Re=YA(ae),[hn,wi]=await Promise.all([Ge,Re]);I(wi),$(!1),n("library")},We=()=>{y(ae=>({...ae,balance:ae.balance+50,nfts:[...ae.nfts,(s==null?void 0:s.id)||"unknown"]}))},pt=(ae,Ge)=>{c(Re=>Re.map(hn=>hn.id===ae?{...hn,...Ge}:hn)),s&&s.id===ae&&o(Re=>Re?{...Re,...Ge}:null)},Qt=ae=>{f(ae),YA(ae).then(I)},Ht=()=>{i&&(eK(i.id),de())},er=ae=>{const Ge=l.find(Re=>Re.id===ae.id);o(Ge||ae),n("details")},Vi=ae=>{const Ge=l.find(Re=>Re.id===ae.id);if(Ge)o(Ge);else{const Re={...ae,lastReadDate:Date.now()};c(hn=>[Re,...hn]),o(Re)}n("reader")},Ts=()=>{n("library"),o(null)},ws=({icon:ae,label:Ge,isActive:Re,onClick:hn})=>T.jsxs("button",{onClick:hn,className:"group relative flex flex-col items-center justify-center w-12 h-12 rounded-full dock-icon-transition hover:scale-125 hover:-translate-y-2",children:[T.jsx("div",{className:`p-2.5 rounded-full transition-colors duration-300 ${Re?"bg-blue-50 text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:T.jsx(ae,{size:26,strokeWidth:Re?2.5:2})}),T.jsx("span",{className:`absolute -bottom-1 w-1.5 h-1.5 rounded-full bg-blue-600 transition-transform duration-300 ${Re?"scale-100":"scale-0"}`})]});return!b&&t!=="auth"?T.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F5F5F7]",children:T.jsx(ac,{className:"animate-spin text-gray-400"})}):t==="auth"?T.jsx(XW,{onSuccess:re}):t==="onboarding"?T.jsx(_$,{onComplete:rt}):G?T.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#F5F5F7] animate-in fade-in duration-500",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-full blur-xl animate-pulse"}),T.jsx(Sa,{size:64,className:"relative text-blue-600 mb-6 animate-bounce"})]}),T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 mb-2",children:"Curating your Suitcase..."}),T.jsx("p",{className:"text-gray-500",children:"Finding books that match your vibe."})]}):T.jsxs("div",{className:"min-h-screen flex flex-col bg-[#F5F5F7] selection:bg-blue-100 overflow-x-hidden relative",onDragOver:Ce,onDragLeave:Ee,onDrop:st,children:[ue&&T.jsx("div",{className:"fixed inset-0 z-[100] bg-blue-500/10 backdrop-blur-sm border-4 border-blue-500 border-dashed m-4 rounded-[3rem] flex items-center justify-center pointer-events-none animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-2xl flex flex-col items-center",children:[T.jsx(wI,{size:48,className:"text-blue-500 mb-4 animate-bounce"}),T.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Drop PDF to Upload"})]})}),T.jsxs("div",{className:"fixed top-0 left-0 right-0 z-30 px-6 py-4 flex justify-between items-center pointer-events-none",children:[T.jsxs("div",{className:"flex items-center gap-2 mix-blend-multiply opacity-50",children:[T.jsx(DD,{size:20,className:"text-gray-900"}),T.jsx("span",{className:"font-serif font-bold text-xl tracking-tight text-gray-900 hidden sm:block",children:"Suitcase"})]}),T.jsxs("div",{className:"pointer-events-auto flex items-center gap-3",children:[T.jsx("button",{onClick:de,className:"bg-white/60 backdrop-blur-md p-2 rounded-full shadow-sm border border-white/50 text-gray-500 hover:text-red-500 transition-colors",children:T.jsx(PD,{size:16})}),T.jsxs("div",{onClick:()=>{le("library"),n("profile")},className:"bg-white/60 backdrop-blur-md px-4 py-2 rounded-full shadow-sm border border-white/50 flex items-center gap-2 hover:scale-105 transition-transform cursor-pointer",children:[T.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-tr from-yellow-400 to-yellow-600 flex items-center justify-center shadow-sm",children:T.jsx("span",{className:"text-[10px] font-bold text-white",children:"$"})}),T.jsx("span",{className:"text-sm font-bold text-gray-800",children:g.balance})]})]})]}),T.jsx("input",{type:"file",ref:oe,className:"hidden",accept:"application/pdf",onChange:_e}),T.jsxs("main",{className:"flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-36 w-full",children:[t==="profile"&&h&&T.jsx(A$,{userPrefs:h,wallet:g,library:l,onClose:()=>n("library"),onUpdateProfile:Qt,onReset:Ht}),t==="library"&&se==="mood"&&h&&T.jsxs("div",{className:"max-w-4xl mx-auto h-[calc(100vh-140px)] flex flex-col",children:[P.length===0?T.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-spring pb-20",children:[T.jsx("div",{className:"animate-float inline-flex items-center justify-center w-20 h-20 bg-gradient-to-tr from-blue-100 to-purple-100 rounded-full mb-6 shadow-xl shadow-blue-100/50",children:T.jsx(bs,{size:32,className:"text-blue-500"})}),T.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-bold text-gray-900 mb-4 tracking-tight",children:"How are you feeling?"}),T.jsx("p",{className:"text-gray-500 text-lg max-w-md mb-8",children:"Tell me your mood, or what you're curious about, and I'll curate a selection just for you."})]}):T.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 pb-24 px-4 scroll-smooth",children:[P.map((ae,Ge)=>T.jsxs("div",{className:`flex flex-col ${ae.role==="user"?"items-end":"items-start"} animate-in fade-in slide-in-from-bottom-2`,children:[T.jsx("div",{className:`max-w-[85%] md:max-w-[70%] p-5 rounded-[1.5rem] text-base leading-relaxed shadow-sm ${ae.role==="user"?"bg-black text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-100"}`,children:ae.text}),ae.books&&ae.books.length>0&&T.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-4 w-full",children:ae.books.map(Re=>T.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-500",children:T.jsx(av,{book:Re,onClick:()=>er(Re),onRead:hn=>{hn.stopPropagation(),Vi(Re)}})},Re.id))})]},Ge)),K&&T.jsx("div",{className:"flex justify-start",children:T.jsxs("div",{className:"bg-white border border-gray-100 p-4 rounded-[1.5rem] rounded-bl-none shadow-sm flex gap-2 items-center text-gray-400",children:[T.jsx(bs,{size:16,className:"animate-pulse"}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Suitcase is thinking..."})]})}),T.jsx("div",{ref:Me})]}),T.jsx("div",{className:`${P.length===0?"relative mb-10":"fixed bottom-24 left-4 right-4 max-w-4xl mx-auto z-40"}`,children:T.jsxs("form",{onSubmit:Cn,className:"relative group",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full blur-xl opacity-20 group-hover:opacity-40 transition-opacity"}),T.jsx("input",{type:"text",placeholder:"I want a mystery set in Paris...",className:"w-full relative bg-white/90 backdrop-blur-xl border border-white/60 p-5 pl-8 pr-16 rounded-full text-lg text-gray-900 placeholder:text-gray-400 outline-none shadow-[0_8px_30px_rgb(0,0,0,0.06)] focus:shadow-[0_12px_40px_rgb(0,0,0,0.1)] transition-all duration-300 font-medium",value:L,onChange:ae=>O(ae.target.value),autoFocus:P.length===0}),T.jsx("button",{type:"submit",disabled:!L.trim()||K,className:"absolute right-2 top-2 bottom-2 aspect-square bg-black text-white rounded-full flex items-center justify-center hover:scale-105 transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:K?T.jsx(ac,{size:18,className:"animate-spin"}):P.length===0?T.jsx(mw,{size:20}):T.jsx(yw,{size:18})})]})})]}),t==="library"&&se==="search"&&T.jsxs("div",{className:"max-w-6xl mx-auto animate-spring mt-8",children:[T.jsx("div",{className:"mb-8 max-w-2xl mx-auto relative px-4",children:T.jsxs("div",{className:"relative",children:[T.jsx(gE,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-gray-400 w-6 h-6"}),T.jsx("form",{onSubmit:Xe,children:T.jsx("input",{ref:pe,type:"text",placeholder:"Search for books, authors...",className:"w-full pl-16 pr-6 py-5 bg-white/90 backdrop-blur-xl border border-white/50 rounded-3xl text-2xl text-gray-900 placeholder:text-gray-300 outline-none shadow-2xl shadow-gray-200/50 transition-all duration-300 font-serif",value:U,onChange:ae=>F(ae.target.value)})}),U&&T.jsx("button",{onClick:()=>{F(""),C([]),ee(!1)},className:"absolute right-6 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-full text-gray-400 transition-colors",children:T.jsx(yh,{size:16})})]})}),K?T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6 opacity-50 pointer-events-none",children:[1,2,3,4,5].map(ae=>T.jsx("div",{className:"aspect-[2/3] bg-white rounded-2xl animate-pulse"},ae))}):T.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:Q&&w.length===0?T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-60",children:[T.jsx(bB,{size:64,className:"text-gray-300 mb-4"}),T.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"No books found"}),T.jsx("p",{className:"text-gray-500",children:"Try checking the spelling or use different keywords."})]}):w.length>0&&T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6",children:w.map(ae=>T.jsx(av,{book:ae,onClick:()=>er(ae),onRead:()=>Vi(ae)},ae.id))})})]}),t==="library"&&se==="library"&&T.jsxs("div",{className:"animate-in fade-in duration-500 space-y-12",children:[T.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[T.jsxs("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-gray-900",children:[J(),", ",(i==null?void 0:i.name.split(" ")[0])||"Traveler","."]}),T.jsx("p",{className:"text-gray-500",children:"Ready to continue your journey?"})]}),N.length>0&&T.jsxs("section",{children:[T.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(bs,{size:18,className:"text-blue-500"}),T.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"For You"})]}),T.jsxs("button",{className:"text-xs font-bold text-gray-400 hover:text-gray-900 flex items-center gap-1",children:["View All ",T.jsx(fE,{size:12})]})]}),T.jsx("div",{className:"flex gap-6 overflow-x-auto pb-8 -mx-4 px-4 scrollbar-hide snap-x snap-mandatory",children:N.map(ae=>T.jsx("div",{className:"min-w-[160px] md:min-w-[180px] snap-start",children:T.jsx(av,{book:ae,onClick:()=>er(ae),onRead:()=>Vi(ae)})},ae.id))})]}),T.jsxs("section",{children:[T.jsxs("div",{className:"flex items-end justify-between mb-6 px-2 border-b border-gray-200 pb-2",children:[T.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Your Suitcase"}),T.jsxs("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest bg-white px-2 py-1 rounded-md border border-gray-100",children:[l.length," Items"]})]}),l.length===0?T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 rounded-3xl transition-all cursor-pointer group bg-white border border-gray-100 hover:border-blue-200 hover:shadow-lg",onClick:()=>{var ae;return(ae=oe.current)==null?void 0:ae.click()},children:[T.jsx("div",{className:"relative mb-4",children:T.jsx("div",{className:"animate-float relative bg-blue-50 w-20 h-20 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:T.jsx(wI,{className:"text-blue-600 w-8 h-8"})})}),T.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"It's empty here"}),T.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Upload a PDF to start reading."}),T.jsx("button",{className:"bg-black text-white px-6 py-2 rounded-full text-sm font-bold",children:"Import Book"})]}):T.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-x-6 gap-y-10",children:[T.jsxs("button",{onClick:()=>{var ae;return(ae=oe.current)==null?void 0:ae.click()},className:"aspect-[2/3] rounded-2xl bg-gray-100 border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 transition-all group flex flex-col items-center justify-center gap-3",children:[T.jsx("div",{className:"w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center text-gray-400 group-hover:text-blue-500 transition-colors",children:T.jsx(qB,{size:24})}),T.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-blue-600 uppercase tracking-wide",children:"Add Book"})]}),l.map(ae=>T.jsx(av,{book:ae,onClick:()=>er(ae),onRead:()=>Vi(ae)},ae.id))]})]})]})]}),t!=="reader"&&T.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-40 animate-in slide-in-from-bottom-24 duration-1000 ease-out",children:T.jsxs("div",{className:"glass-panel flex items-center gap-2 p-2 px-4 rounded-full shadow-[0_25px_60px_-15px_rgba(0,0,0,0.15)] ring-1 ring-white/60 bg-white/80 backdrop-blur-xl",children:[T.jsx(ws,{icon:NB,label:"Library",isActive:t==="library"&&se==="library",onClick:()=>{n("library"),le("library")}}),T.jsx(ws,{icon:bs,label:"Concierge",isActive:t==="library"&&se==="mood",onClick:()=>{n("library"),le("mood")}}),T.jsx(ws,{icon:gE,label:"Search",isActive:t==="library"&&se==="search",onClick:()=>{n("library"),le("search")}}),T.jsx(ws,{icon:OD,label:"Profile",isActive:t==="profile",onClick:()=>{n("profile")}})]})}),t==="details"&&s&&T.jsx(BV,{book:s,onClose:Ts,onRead:()=>Vi(s)}),t==="reader"&&s&&T.jsx("div",{className:"fixed inset-0 z-50",children:T.jsx(y$,{book:s,onClose:Ts,onReward:We,onUpdateBookData:pt})})]})}const _O=document.getElementById("root");if(!_O)throw new Error("Could not find root element to mount to");const nK=WF.createRoot(_O);nK.render(T.jsx(HF.StrictMode,{children:T.jsx(tK,{})}));
