var LF=Object.defineProperty;var oI=i=>{throw TypeError(i)};var OF=(i,e,t)=>e in i?LF(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var le=(i,e,t)=>OF(i,typeof e!="symbol"?e+"":e,t),kA=(i,e,t)=>e.has(i)||oI("Cannot "+t);var d=(i,e,t)=>(kA(i,e,"read from private field"),t?t.call(i):e.get(i)),R=(i,e,t)=>e.has(i)?oI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),E=(i,e,t,n)=>(kA(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),M=(i,e,t)=>(kA(i,e,"access private method"),t);var yn=(i,e,t,n)=>({set _(s){E(i,e,s,t)},get _(){return d(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function dw(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var PA={exports:{}},tg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aI;function UF(){if(aI)return tg;aI=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:o}}return tg.Fragment=e,tg.jsx=t,tg.jsxs=t,tg}var lI;function FF(){return lI||(lI=1,PA.exports=UF()),PA.exports}var T=FF(),LA={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cI;function BF(){if(cI)return Oe;cI=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(H){return H===null||typeof H!="object"?null:(H=b&&H[b]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,N={};function I(H,J,se){this.props=H,this.context=J,this.refs=N,this.updater=se||w}I.prototype.isReactComponent={},I.prototype.setState=function(H,J){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,J,"setState")},I.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function P(){}P.prototype=I.prototype;function k(H,J,se){this.props=H,this.context=J,this.refs=N,this.updater=se||w}var L=k.prototype=new P;L.constructor=k,C(L,I.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function U(){}var F={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function q(H,J,se){var de=se.ref;return{$$typeof:i,type:H,key:J,ref:de!==void 0?de:null,props:se}}function Q(H,J){return q(H.type,J,H.props)}function Z(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function oe(H){var J={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(se){return J[se]})}var ce=/\/+/g;function ue(H,J){return typeof H=="object"&&H!==null&&H.key!=null?oe(""+H.key):J.toString(36)}function pe(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(U,U):(H.status="pending",H.then(function(J){H.status==="pending"&&(H.status="fulfilled",H.value=J)},function(J){H.status==="pending"&&(H.status="rejected",H.reason=J)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,J,se,de,ve){var Re=typeof H;(Re==="undefined"||Re==="boolean")&&(H=null);var Ae=!1;if(H===null)Ae=!0;else switch(Re){case"bigint":case"string":case"number":Ae=!0;break;case"object":switch(H.$$typeof){case i:case e:Ae=!0;break;case g:return Ae=H._init,G(Ae(H._payload),J,se,de,ve)}}if(Ae)return ve=ve(H),Ae=de===""?"."+ue(H,0):de,O(ve)?(se="",Ae!=null&&(se=Ae.replace(ce,"$&/")+"/"),G(ve,J,se,"",function(qt){return qt})):ve!=null&&(Z(ve)&&(ve=Q(ve,se+(ve.key==null||H&&H.key===ve.key?"":(""+ve.key).replace(ce,"$&/")+"/")+Ae)),J.push(ve)),1;Ae=0;var ft=de===""?".":de+":";if(O(H))for(var Qe=0;Qe<H.length;Qe++)de=H[Qe],Re=ft+ue(de,Qe),Ae+=G(de,J,se,Re,ve);else if(Qe=A(H),typeof Qe=="function")for(H=Qe.call(H),Qe=0;!(de=H.next()).done;)de=de.value,Re=ft+ue(de,Qe++),Ae+=G(de,J,se,Re,ve);else if(Re==="object"){if(typeof H.then=="function")return G(pe(H),J,se,de,ve);throw J=String(H),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ae}function $(H,J,se){if(H==null)return H;var de=[],ve=0;return G(H,de,"","",function(Re){return J.call(se,Re,ve++)}),de}function ae(H){if(H._status===-1){var J=H._result;J=J(),J.then(function(se){(H._status===0||H._status===-1)&&(H._status=1,H._result=se)},function(se){(H._status===0||H._status===-1)&&(H._status=2,H._result=se)}),H._status===-1&&(H._status=0,H._result=J)}if(H._status===1)return H._result.default;throw H._result}var Se=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Ie={map:$,forEach:function(H,J,se){$(H,function(){J.apply(this,arguments)},se)},count:function(H){var J=0;return $(H,function(){J++}),J},toArray:function(H){return $(H,function(J){return J})||[]},only:function(H){if(!Z(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Oe.Activity=y,Oe.Children=Ie,Oe.Component=I,Oe.Fragment=t,Oe.Profiler=s,Oe.PureComponent=k,Oe.StrictMode=n,Oe.Suspense=h,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(H){return F.H.useMemoCache(H)}},Oe.cache=function(H){return function(){return H.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(H,J,se){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var de=C({},H.props),ve=H.key;if(J!=null)for(Re in J.key!==void 0&&(ve=""+J.key),J)!K.call(J,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&J.ref===void 0||(de[Re]=J[Re]);var Re=arguments.length-2;if(Re===1)de.children=se;else if(1<Re){for(var Ae=Array(Re),ft=0;ft<Re;ft++)Ae[ft]=arguments[ft+2];de.children=Ae}return q(H.type,ve,de)},Oe.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:o,_context:H},H},Oe.createElement=function(H,J,se){var de,ve={},Re=null;if(J!=null)for(de in J.key!==void 0&&(Re=""+J.key),J)K.call(J,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(ve[de]=J[de]);var Ae=arguments.length-2;if(Ae===1)ve.children=se;else if(1<Ae){for(var ft=Array(Ae),Qe=0;Qe<Ae;Qe++)ft[Qe]=arguments[Qe+2];ve.children=ft}if(H&&H.defaultProps)for(de in Ae=H.defaultProps,Ae)ve[de]===void 0&&(ve[de]=Ae[de]);return q(H,Re,ve)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(H){return{$$typeof:c,render:H}},Oe.isValidElement=Z,Oe.lazy=function(H){return{$$typeof:g,_payload:{_status:-1,_result:H},_init:ae}},Oe.memo=function(H,J){return{$$typeof:f,type:H,compare:J===void 0?null:J}},Oe.startTransition=function(H){var J=F.T,se={};F.T=se;try{var de=H(),ve=F.S;ve!==null&&ve(se,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(U,Se)}catch(Re){Se(Re)}finally{J!==null&&se.types!==null&&(J.types=se.types),F.T=J}},Oe.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Oe.use=function(H){return F.H.use(H)},Oe.useActionState=function(H,J,se){return F.H.useActionState(H,J,se)},Oe.useCallback=function(H,J){return F.H.useCallback(H,J)},Oe.useContext=function(H){return F.H.useContext(H)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(H,J){return F.H.useDeferredValue(H,J)},Oe.useEffect=function(H,J){return F.H.useEffect(H,J)},Oe.useEffectEvent=function(H){return F.H.useEffectEvent(H)},Oe.useId=function(){return F.H.useId()},Oe.useImperativeHandle=function(H,J,se){return F.H.useImperativeHandle(H,J,se)},Oe.useInsertionEffect=function(H,J){return F.H.useInsertionEffect(H,J)},Oe.useLayoutEffect=function(H,J){return F.H.useLayoutEffect(H,J)},Oe.useMemo=function(H,J){return F.H.useMemo(H,J)},Oe.useOptimistic=function(H,J){return F.H.useOptimistic(H,J)},Oe.useReducer=function(H,J,se){return F.H.useReducer(H,J,se)},Oe.useRef=function(H){return F.H.useRef(H)},Oe.useState=function(H){return F.H.useState(H)},Oe.useSyncExternalStore=function(H,J,se){return F.H.useSyncExternalStore(H,J,se)},Oe.useTransition=function(){return F.H.useTransition()},Oe.version="19.2.4",Oe}var uI;function hw(){return uI||(uI=1,LA.exports=BF()),LA.exports}var ee=hw();const HF=dw(ee);var OA={exports:{}},ng={},UA={exports:{}},FA={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dI;function GF(){return dI||(dI=1,(function(i){function e(G,$){var ae=G.length;G.push($);e:for(;0<ae;){var Se=ae-1>>>1,Ie=G[Se];if(0<s(Ie,$))G[Se]=$,G[ae]=Ie,ae=Se;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var $=G[0],ae=G.pop();if(ae!==$){G[0]=ae;e:for(var Se=0,Ie=G.length,H=Ie>>>1;Se<H;){var J=2*(Se+1)-1,se=G[J],de=J+1,ve=G[de];if(0>s(se,ae))de<Ie&&0>s(ve,se)?(G[Se]=ve,G[de]=ae,Se=de):(G[Se]=se,G[J]=ae,Se=J);else if(de<Ie&&0>s(ve,ae))G[Se]=ve,G[de]=ae,Se=de;else break e}}return $}function s(G,$){var ae=G.sortIndex-$.sortIndex;return ae!==0?ae:G.id-$.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,y=null,b=3,A=!1,w=!1,C=!1,N=!1,I=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function L(G){for(var $=t(f);$!==null;){if($.callback===null)n(f);else if($.startTime<=G)n(f),$.sortIndex=$.expirationTime,e(h,$);else break;$=t(f)}}function O(G){if(C=!1,L(G),!w)if(t(h)!==null)w=!0,U||(U=!0,oe());else{var $=t(f);$!==null&&pe(O,$.startTime-G)}}var U=!1,F=-1,K=5,q=-1;function Q(){return N?!0:!(i.unstable_now()-q<K)}function Z(){if(N=!1,U){var G=i.unstable_now();q=G;var $=!0;try{e:{w=!1,C&&(C=!1,P(F),F=-1),A=!0;var ae=b;try{t:{for(L(G),y=t(h);y!==null&&!(y.expirationTime>G&&Q());){var Se=y.callback;if(typeof Se=="function"){y.callback=null,b=y.priorityLevel;var Ie=Se(y.expirationTime<=G);if(G=i.unstable_now(),typeof Ie=="function"){y.callback=Ie,L(G),$=!0;break t}y===t(h)&&n(h),L(G)}else n(h);y=t(h)}if(y!==null)$=!0;else{var H=t(f);H!==null&&pe(O,H.startTime-G),$=!1}}break e}finally{y=null,b=ae,A=!1}$=void 0}}finally{$?oe():U=!1}}}var oe;if(typeof k=="function")oe=function(){k(Z)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ue=ce.port2;ce.port1.onmessage=Z,oe=function(){ue.postMessage(null)}}else oe=function(){I(Z,0)};function pe(G,$){F=I(function(){G(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(G){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var ae=b;b=$;try{return G()}finally{b=ae}},i.unstable_requestPaint=function(){N=!0},i.unstable_runWithPriority=function(G,$){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=b;b=G;try{return $()}finally{b=ae}},i.unstable_scheduleCallback=function(G,$,ae){var Se=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Se+ae:Se):ae=Se,G){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=ae+Ie,G={id:g++,callback:$,priorityLevel:G,startTime:ae,expirationTime:Ie,sortIndex:-1},ae>Se?(G.sortIndex=ae,e(f,G),t(h)===null&&G===t(f)&&(C?(P(F),F=-1):C=!0,pe(O,ae-Se))):(G.sortIndex=Ie,e(h,G),w||A||(w=!0,U||(U=!0,oe()))),G},i.unstable_shouldYield=Q,i.unstable_wrapCallback=function(G){var $=b;return function(){var ae=b;b=$;try{return G.apply(this,arguments)}finally{b=ae}}}})(FA)),FA}var hI;function zF(){return hI||(hI=1,UA.exports=GF()),UA.exports}var BA={exports:{}},Kn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fI;function VF(){if(fI)return Kn;fI=1;var i=hw();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:h,containerInfo:f,implementation:g}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Kn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Kn.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,g)},Kn.flushSync=function(h){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=g,n.d.f()}},Kn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Kn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Kn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Kn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Kn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Kn.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Kn.requestFormReset=function(h){n.d.r(h)},Kn.unstable_batchedUpdates=function(h,f){return h(f)},Kn.useFormState=function(h,f,g){return l.H.useFormState(h,f,g)},Kn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Kn.version="19.2.4",Kn}var pI;function qF(){if(pI)return BA.exports;pI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),BA.exports=VF(),BA.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gI;function $F(){if(gI)return ng;gI=1;var i=zF(),e=hw(),t=qF();function n(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,u=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(u=a.return),r=a.return;while(r)}return a.tag===3?u:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function c(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(n(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(n(188));return a!==r?null:r}for(var u=r,p=a;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(p=_.return,p!==null){u=p;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return h(_),r;if(S===p)return h(_),a;S=S.sibling}throw Error(n(188))}if(u.return!==p.return)u=_,p=S;else{for(var x=!1,D=_.child;D;){if(D===u){x=!0,u=_,p=S;break}if(D===p){x=!0,p=_,u=S;break}D=D.sibling}if(!x){for(D=S.child;D;){if(D===u){x=!0,u=S,p=_;break}if(D===p){x=!0,p=S,u=_;break}D=D.sibling}if(!x)throw Error(n(189))}}if(u.alternate!==p)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:a}function g(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=g(r),a!==null)return a;r=r.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),k=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function oe(r){return r===null||typeof r!="object"?null:(r=Z&&r[Z]||r["@@iterator"],typeof r=="function"?r:null)}var ce=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ce?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case I:return"Profiler";case N:return"StrictMode";case O:return"Suspense";case U:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case k:return r.displayName||"Context";case P:return(r._context.displayName||"Context")+".Consumer";case L:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case F:return a=r.displayName||null,a!==null?a:ue(r.type)||"Memo";case K:a=r._payload,r=r._init;try{return ue(r(a))}catch{}}return null}var pe=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},Se=[],Ie=-1;function H(r){return{current:r}}function J(r){0>Ie||(r.current=Se[Ie],Se[Ie]=null,Ie--)}function se(r,a){Ie++,Se[Ie]=r.current,r.current=a}var de=H(null),ve=H(null),Re=H(null),Ae=H(null);function ft(r,a){switch(se(Re,a),se(ve,r),se(de,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?IR(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=IR(a),r=NR(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}J(de),se(de,r)}function Qe(){J(de),J(ve),J(Re)}function qt(r){r.memoizedState!==null&&se(Ae,r);var a=de.current,u=NR(a,r.type);a!==u&&(se(ve,r),se(de,u))}function Xe(r){ve.current===r&&(J(de),J(ve)),Ae.current===r&&(J(Ae),jp._currentValue=ae)}var Pn,ct;function We(r){if(Pn===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);Pn=a&&a[1]||"",ct=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pn+r+ct}var pt=!1;function Kt(r,a){if(!r||pt)return"";pt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(j){var W=j}Reflect.construct(r,[],re)}else{try{re.call()}catch(j){W=j}r.call(re.prototype)}}else{try{throw Error()}catch(j){W=j}(re=r())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(j){if(j&&W&&typeof j.stack=="string")return[j.stack,W.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),x=S[0],D=S[1];if(x&&D){var B=x.split(`
`),X=D.split(`
`);for(_=p=0;p<B.length&&!B[p].includes("DetermineComponentFrameRoot");)p++;for(;_<X.length&&!X[_].includes("DetermineComponentFrameRoot");)_++;if(p===B.length||_===X.length)for(p=B.length-1,_=X.length-1;1<=p&&0<=_&&B[p]!==X[_];)_--;for(;1<=p&&0<=_;p--,_--)if(B[p]!==X[_]){if(p!==1||_!==1)do if(p--,_--,0>_||B[p]!==X[_]){var te=`
`+B[p].replace(" at new "," at ");return r.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",r.displayName)),te}while(1<=p&&0<=_);break}}}finally{pt=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?We(u):""}function Bt(r,a){switch(r.tag){case 26:case 27:case 5:return We(r.type);case 16:return We("Lazy");case 13:return r.child!==a&&a!==null?We("Suspense Fallback"):We("Suspense");case 19:return We("SuspenseList");case 0:case 15:return Kt(r.type,!1);case 11:return Kt(r.type.render,!1);case 1:return Kt(r.type,!0);case 31:return We("Activity");default:return""}}function _s(r){try{var a="",u=null;do a+=Bt(r,u),u=r,r=r.return;while(r);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Oi=Object.prototype.hasOwnProperty,Ss=i.unstable_scheduleCallback,Te=i.unstable_cancelCallback,ne=i.unstable_shouldYield,xe=i.unstable_requestPaint,Ee=i.unstable_now,An=i.unstable_getCurrentPriorityLevel,As=i.unstable_ImmediatePriority,Ui=i.unstable_UserBlockingPriority,Fi=i.unstable_NormalPriority,Da=i.unstable_LowPriority,js=i.unstable_IdlePriority,lp=i.log,vO=i.unstable_setDisableYieldValue,cp=null,Bi=null;function ka(r){if(typeof lp=="function"&&vO(r),Bi&&typeof Bi.setStrictMode=="function")try{Bi.setStrictMode(cp,r)}catch{}}var Hi=Math.clz32?Math.clz32:SO,bO=Math.log,_O=Math.LN2;function SO(r){return r>>>=0,r===0?32:31-(bO(r)/_O|0)|0}var zy=256,Vy=262144,qy=4194304;function pc(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function $y(r,a,u){var p=r.pendingLanes;if(p===0)return 0;var _=0,S=r.suspendedLanes,x=r.pingedLanes;r=r.warmLanes;var D=p&134217727;return D!==0?(p=D&~S,p!==0?_=pc(p):(x&=D,x!==0?_=pc(x):u||(u=D&~r,u!==0&&(_=pc(u))))):(D=p&~S,D!==0?_=pc(D):x!==0?_=pc(x):u||(u=p&~r,u!==0&&(_=pc(u)))),_===0?0:a!==0&&a!==_&&(a&S)===0&&(S=_&-_,u=a&-a,S>=u||S===32&&(u&4194048)!==0)?a:_}function up(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function AO(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uC(){var r=qy;return qy<<=1,(qy&62914560)===0&&(qy=4194304),r}function S_(r){for(var a=[],u=0;31>u;u++)a.push(r);return a}function dp(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function EO(r,a,u,p,_,S){var x=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var D=r.entanglements,B=r.expirationTimes,X=r.hiddenUpdates;for(u=x&~u;0<u;){var te=31-Hi(u),re=1<<te;D[te]=0,B[te]=-1;var W=X[te];if(W!==null)for(X[te]=null,te=0;te<W.length;te++){var j=W[te];j!==null&&(j.lane&=-536870913)}u&=~re}p!==0&&dC(r,p,0),S!==0&&_===0&&r.tag!==0&&(r.suspendedLanes|=S&~(x&~a))}function dC(r,a,u){r.pendingLanes|=a,r.suspendedLanes&=~a;var p=31-Hi(a);r.entangledLanes|=a,r.entanglements[p]=r.entanglements[p]|1073741824|u&261930}function hC(r,a){var u=r.entangledLanes|=a;for(r=r.entanglements;u;){var p=31-Hi(u),_=1<<p;_&a|r[p]&a&&(r[p]|=a),u&=~_}}function fC(r,a){var u=a&-a;return u=(u&42)!==0?1:A_(u),(u&(r.suspendedLanes|a))!==0?0:u}function A_(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function E_(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function pC(){var r=$.p;return r!==0?r:(r=window.event,r===void 0?32:ZR(r.type))}function gC(r,a){var u=$.p;try{return $.p=r,a()}finally{$.p=u}}var Pa=Math.random().toString(36).slice(2),Ln="__reactFiber$"+Pa,bi="__reactProps$"+Pa,hd="__reactContainer$"+Pa,T_="__reactEvents$"+Pa,TO="__reactListeners$"+Pa,wO="__reactHandles$"+Pa,mC="__reactResources$"+Pa,hp="__reactMarker$"+Pa;function w_(r){delete r[Ln],delete r[bi],delete r[T_],delete r[TO],delete r[wO]}function fd(r){var a=r[Ln];if(a)return a;for(var u=r.parentNode;u;){if(a=u[hd]||u[Ln]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(r=UR(r);r!==null;){if(u=r[Ln])return u;r=UR(r)}return a}r=u,u=r.parentNode}return null}function pd(r){if(r=r[Ln]||r[hd]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function fp(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(n(33))}function gd(r){var a=r[mC];return a||(a=r[mC]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function En(r){r[hp]=!0}var yC=new Set,vC={};function gc(r,a){md(r,a),md(r+"Capture",a)}function md(r,a){for(vC[r]=a,r=0;r<a.length;r++)yC.add(a[r])}var CO=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bC={},_C={};function xO(r){return Oi.call(_C,r)?!0:Oi.call(bC,r)?!1:CO.test(r)?_C[r]=!0:(bC[r]=!0,!1)}function Yy(r,a,u){if(xO(a))if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+u)}}function Xy(r,a,u){if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+u)}}function uo(r,a,u,p){if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(a,u,""+p)}}function Es(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function SC(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function RO(r,a,u){var p=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,S=p.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return _.call(this)},set:function(x){u=""+x,S.call(this,x)}}),Object.defineProperty(r,a,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(x){u=""+x},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function C_(r){if(!r._valueTracker){var a=SC(r)?"checked":"value";r._valueTracker=RO(r,a,""+r[a])}}function AC(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var u=a.getValue(),p="";return r&&(p=SC(r)?r.checked?"true":"false":r.value),r=p,r!==u?(a.setValue(r),!0):!1}function Wy(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var IO=/[\n"\\]/g;function Ts(r){return r.replace(IO,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function x_(r,a,u,p,_,S,x,D){r.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.type=x:r.removeAttribute("type"),a!=null?x==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Es(a)):r.value!==""+Es(a)&&(r.value=""+Es(a)):x!=="submit"&&x!=="reset"||r.removeAttribute("value"),a!=null?R_(r,x,Es(a)):u!=null?R_(r,x,Es(u)):p!=null&&r.removeAttribute("value"),_==null&&S!=null&&(r.defaultChecked=!!S),_!=null&&(r.checked=_&&typeof _!="function"&&typeof _!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+Es(D):r.removeAttribute("name")}function EC(r,a,u,p,_,S,x,D){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.type=S),a!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||a!=null)){C_(r);return}u=u!=null?""+Es(u):"",a=a!=null?""+Es(a):u,D||a===r.value||(r.value=a),r.defaultValue=a}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,r.checked=D?r.checked:!!p,r.defaultChecked=!!p,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.name=x),C_(r)}function R_(r,a,u){a==="number"&&Wy(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function yd(r,a,u,p){if(r=r.options,a){a={};for(var _=0;_<u.length;_++)a["$"+u[_]]=!0;for(u=0;u<r.length;u++)_=a.hasOwnProperty("$"+r[u].value),r[u].selected!==_&&(r[u].selected=_),_&&p&&(r[u].defaultSelected=!0)}else{for(u=""+Es(u),a=null,_=0;_<r.length;_++){if(r[_].value===u){r[_].selected=!0,p&&(r[_].defaultSelected=!0);return}a!==null||r[_].disabled||(a=r[_])}a!==null&&(a.selected=!0)}}function TC(r,a,u){if(a!=null&&(a=""+Es(a),a!==r.value&&(r.value=a),u==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=u!=null?""+Es(u):""}function wC(r,a,u,p){if(a==null){if(p!=null){if(u!=null)throw Error(n(92));if(pe(p)){if(1<p.length)throw Error(n(93));p=p[0]}u=p}u==null&&(u=""),a=u}u=Es(a),r.defaultValue=u,p=r.textContent,p===u&&p!==""&&p!==null&&(r.value=p),C_(r)}function vd(r,a){if(a){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=a;return}}r.textContent=a}var NO=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function CC(r,a,u){var p=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":p?r.setProperty(a,u):typeof u!="number"||u===0||NO.has(a)?a==="float"?r.cssFloat=u:r[a]=(""+u).trim():r[a]=u+"px"}function xC(r,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(r=r.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?r.setProperty(p,""):p==="float"?r.cssFloat="":r[p]="");for(var _ in a)p=a[_],a.hasOwnProperty(_)&&u[_]!==p&&CC(r,_,p)}else for(var S in a)a.hasOwnProperty(S)&&CC(r,S,a[S])}function I_(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var MO=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),DO=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ky(r){return DO.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ho(){}var N_=null;function M_(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var bd=null,_d=null;function RC(r){var a=pd(r);if(a&&(r=a.stateNode)){var u=r[bi]||null;e:switch(r=a.stateNode,a.type){case"input":if(x_(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Ts(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var p=u[a];if(p!==r&&p.form===r.form){var _=p[bi]||null;if(!_)throw Error(n(90));x_(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(a=0;a<u.length;a++)p=u[a],p.form===r.form&&AC(p)}break e;case"textarea":TC(r,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&yd(r,!!u.multiple,a,!1)}}}var D_=!1;function IC(r,a,u){if(D_)return r(a,u);D_=!0;try{var p=r(a);return p}finally{if(D_=!1,(bd!==null||_d!==null)&&(O0(),bd&&(a=bd,r=_d,_d=bd=null,RC(a),r)))for(a=0;a<r.length;a++)RC(r[a])}}function pp(r,a){var u=r.stateNode;if(u===null)return null;var p=u[bi]||null;if(p===null)return null;u=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(r=r.type,p=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!p;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),k_=!1;if(fo)try{var gp={};Object.defineProperty(gp,"passive",{get:function(){k_=!0}}),window.addEventListener("test",gp,gp),window.removeEventListener("test",gp,gp)}catch{k_=!1}var La=null,P_=null,Jy=null;function NC(){if(Jy)return Jy;var r,a=P_,u=a.length,p,_="value"in La?La.value:La.textContent,S=_.length;for(r=0;r<u&&a[r]===_[r];r++);var x=u-r;for(p=1;p<=x&&a[u-p]===_[S-p];p++);return Jy=_.slice(r,1<p?1-p:void 0)}function jy(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Qy(){return!0}function MC(){return!1}function _i(r){function a(u,p,_,S,x){this._reactName=u,this._targetInst=_,this.type=p,this.nativeEvent=S,this.target=x,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(u=r[D],this[D]=u?u(S):S[D]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Qy:MC,this.isPropagationStopped=MC,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Qy)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Qy)},persist:function(){},isPersistent:Qy}),a}var mc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zy=_i(mc),mp=y({},mc,{view:0,detail:0}),kO=_i(mp),L_,O_,yp,e0=y({},mp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:F_,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==yp&&(yp&&r.type==="mousemove"?(L_=r.screenX-yp.screenX,O_=r.screenY-yp.screenY):O_=L_=0,yp=r),L_)},movementY:function(r){return"movementY"in r?r.movementY:O_}}),DC=_i(e0),PO=y({},e0,{dataTransfer:0}),LO=_i(PO),OO=y({},mp,{relatedTarget:0}),U_=_i(OO),UO=y({},mc,{animationName:0,elapsedTime:0,pseudoElement:0}),FO=_i(UO),BO=y({},mc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),HO=_i(BO),GO=y({},mc,{data:0}),kC=_i(GO),zO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $O(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=qO[r])?!!a[r]:!1}function F_(){return $O}var YO=y({},mp,{key:function(r){if(r.key){var a=zO[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=jy(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?VO[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:F_,charCode:function(r){return r.type==="keypress"?jy(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?jy(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),XO=_i(YO),WO=y({},e0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PC=_i(WO),KO=y({},mp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:F_}),JO=_i(KO),jO=y({},mc,{propertyName:0,elapsedTime:0,pseudoElement:0}),QO=_i(jO),ZO=y({},e0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),eU=_i(ZO),tU=y({},mc,{newState:0,oldState:0}),nU=_i(tU),iU=[9,13,27,32],B_=fo&&"CompositionEvent"in window,vp=null;fo&&"documentMode"in document&&(vp=document.documentMode);var sU=fo&&"TextEvent"in window&&!vp,LC=fo&&(!B_||vp&&8<vp&&11>=vp),OC=" ",UC=!1;function FC(r,a){switch(r){case"keyup":return iU.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BC(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Sd=!1;function rU(r,a){switch(r){case"compositionend":return BC(a);case"keypress":return a.which!==32?null:(UC=!0,OC);case"textInput":return r=a.data,r===OC&&UC?null:r;default:return null}}function oU(r,a){if(Sd)return r==="compositionend"||!B_&&FC(r,a)?(r=NC(),Jy=P_=La=null,Sd=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return LC&&a.locale!=="ko"?null:a.data;default:return null}}var aU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HC(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!aU[r.type]:a==="textarea"}function GC(r,a,u,p){bd?_d?_d.push(p):_d=[p]:bd=p,a=V0(a,"onChange"),0<a.length&&(u=new Zy("onChange","change",null,u,p),r.push({event:u,listeners:a}))}var bp=null,_p=null;function lU(r){ER(r,0)}function t0(r){var a=fp(r);if(AC(a))return r}function zC(r,a){if(r==="change")return a}var VC=!1;if(fo){var H_;if(fo){var G_="oninput"in document;if(!G_){var qC=document.createElement("div");qC.setAttribute("oninput","return;"),G_=typeof qC.oninput=="function"}H_=G_}else H_=!1;VC=H_&&(!document.documentMode||9<document.documentMode)}function $C(){bp&&(bp.detachEvent("onpropertychange",YC),_p=bp=null)}function YC(r){if(r.propertyName==="value"&&t0(_p)){var a=[];GC(a,_p,r,M_(r)),IC(lU,a)}}function cU(r,a,u){r==="focusin"?($C(),bp=a,_p=u,bp.attachEvent("onpropertychange",YC)):r==="focusout"&&$C()}function uU(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return t0(_p)}function dU(r,a){if(r==="click")return t0(a)}function hU(r,a){if(r==="input"||r==="change")return t0(a)}function fU(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Gi=typeof Object.is=="function"?Object.is:fU;function Sp(r,a){if(Gi(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var u=Object.keys(r),p=Object.keys(a);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var _=u[p];if(!Oi.call(a,_)||!Gi(r[_],a[_]))return!1}return!0}function XC(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function WC(r,a){var u=XC(r);r=0;for(var p;u;){if(u.nodeType===3){if(p=r+u.textContent.length,r<=a&&p>=a)return{node:u,offset:a-r};r=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=XC(u)}}function KC(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?KC(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function JC(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Wy(r.document);a instanceof r.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)r=a.contentWindow;else break;a=Wy(r.document)}return a}function z_(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var pU=fo&&"documentMode"in document&&11>=document.documentMode,Ad=null,V_=null,Ap=null,q_=!1;function jC(r,a,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;q_||Ad==null||Ad!==Wy(p)||(p=Ad,"selectionStart"in p&&z_(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ap&&Sp(Ap,p)||(Ap=p,p=V0(V_,"onSelect"),0<p.length&&(a=new Zy("onSelect","select",null,a,u),r.push({event:a,listeners:p}),a.target=Ad)))}function yc(r,a){var u={};return u[r.toLowerCase()]=a.toLowerCase(),u["Webkit"+r]="webkit"+a,u["Moz"+r]="moz"+a,u}var Ed={animationend:yc("Animation","AnimationEnd"),animationiteration:yc("Animation","AnimationIteration"),animationstart:yc("Animation","AnimationStart"),transitionrun:yc("Transition","TransitionRun"),transitionstart:yc("Transition","TransitionStart"),transitioncancel:yc("Transition","TransitionCancel"),transitionend:yc("Transition","TransitionEnd")},$_={},QC={};fo&&(QC=document.createElement("div").style,"AnimationEvent"in window||(delete Ed.animationend.animation,delete Ed.animationiteration.animation,delete Ed.animationstart.animation),"TransitionEvent"in window||delete Ed.transitionend.transition);function vc(r){if($_[r])return $_[r];if(!Ed[r])return r;var a=Ed[r],u;for(u in a)if(a.hasOwnProperty(u)&&u in QC)return $_[r]=a[u];return r}var ZC=vc("animationend"),ex=vc("animationiteration"),tx=vc("animationstart"),gU=vc("transitionrun"),mU=vc("transitionstart"),yU=vc("transitioncancel"),nx=vc("transitionend"),ix=new Map,Y_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Y_.push("scrollEnd");function Qs(r,a){ix.set(r,a),gc(a,[r])}var n0=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ws=[],Td=0,X_=0;function i0(){for(var r=Td,a=X_=Td=0;a<r;){var u=ws[a];ws[a++]=null;var p=ws[a];ws[a++]=null;var _=ws[a];ws[a++]=null;var S=ws[a];if(ws[a++]=null,p!==null&&_!==null){var x=p.pending;x===null?_.next=_:(_.next=x.next,x.next=_),p.pending=_}S!==0&&sx(u,_,S)}}function s0(r,a,u,p){ws[Td++]=r,ws[Td++]=a,ws[Td++]=u,ws[Td++]=p,X_|=p,r.lanes|=p,r=r.alternate,r!==null&&(r.lanes|=p)}function W_(r,a,u,p){return s0(r,a,u,p),r0(r)}function bc(r,a){return s0(r,null,null,a),r0(r)}function sx(r,a,u){r.lanes|=u;var p=r.alternate;p!==null&&(p.lanes|=u);for(var _=!1,S=r.return;S!==null;)S.childLanes|=u,p=S.alternate,p!==null&&(p.childLanes|=u),S.tag===22&&(r=S.stateNode,r===null||r._visibility&1||(_=!0)),r=S,S=S.return;return r.tag===3?(S=r.stateNode,_&&a!==null&&(_=31-Hi(u),r=S.hiddenUpdates,p=r[_],p===null?r[_]=[a]:p.push(a),a.lane=u|536870912),S):null}function r0(r){if(50<qp)throw qp=0,iA=null,Error(n(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var wd={};function vU(r,a,u,p){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zi(r,a,u,p){return new vU(r,a,u,p)}function K_(r){return r=r.prototype,!(!r||!r.isReactComponent)}function po(r,a){var u=r.alternate;return u===null?(u=zi(r.tag,a,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=a,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,a=r.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function rx(r,a){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,a=u.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function o0(r,a,u,p,_,S){var x=0;if(p=r,typeof r=="function")K_(r)&&(x=1);else if(typeof r=="string")x=EF(r,u,de.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=zi(31,u,a,_),r.elementType=q,r.lanes=S,r;case C:return _c(u.children,_,S,a);case N:x=8,_|=24;break;case I:return r=zi(12,u,a,_|2),r.elementType=I,r.lanes=S,r;case O:return r=zi(13,u,a,_),r.elementType=O,r.lanes=S,r;case U:return r=zi(19,u,a,_),r.elementType=U,r.lanes=S,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k:x=10;break e;case P:x=9;break e;case L:x=11;break e;case F:x=14;break e;case K:x=16,p=null;break e}x=29,u=Error(n(130,r===null?"null":typeof r,"")),p=null}return a=zi(x,u,a,_),a.elementType=r,a.type=p,a.lanes=S,a}function _c(r,a,u,p){return r=zi(7,r,p,a),r.lanes=u,r}function J_(r,a,u){return r=zi(6,r,null,a),r.lanes=u,r}function ox(r){var a=zi(18,null,null,0);return a.stateNode=r,a}function j_(r,a,u){return a=zi(4,r.children!==null?r.children:[],r.key,a),a.lanes=u,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var ax=new WeakMap;function Cs(r,a){if(typeof r=="object"&&r!==null){var u=ax.get(r);return u!==void 0?u:(a={value:r,source:a,stack:_s(a)},ax.set(r,a),a)}return{value:r,source:a,stack:_s(a)}}var Cd=[],xd=0,a0=null,Ep=0,xs=[],Rs=0,Oa=null,Tr=1,wr="";function go(r,a){Cd[xd++]=Ep,Cd[xd++]=a0,a0=r,Ep=a}function lx(r,a,u){xs[Rs++]=Tr,xs[Rs++]=wr,xs[Rs++]=Oa,Oa=r;var p=Tr;r=wr;var _=32-Hi(p)-1;p&=~(1<<_),u+=1;var S=32-Hi(a)+_;if(30<S){var x=_-_%5;S=(p&(1<<x)-1).toString(32),p>>=x,_-=x,Tr=1<<32-Hi(a)+_|u<<_|p,wr=S+r}else Tr=1<<S|u<<_|p,wr=r}function Q_(r){r.return!==null&&(go(r,1),lx(r,1,0))}function Z_(r){for(;r===a0;)a0=Cd[--xd],Cd[xd]=null,Ep=Cd[--xd],Cd[xd]=null;for(;r===Oa;)Oa=xs[--Rs],xs[Rs]=null,wr=xs[--Rs],xs[Rs]=null,Tr=xs[--Rs],xs[Rs]=null}function cx(r,a){xs[Rs++]=Tr,xs[Rs++]=wr,xs[Rs++]=Oa,Tr=a.id,wr=a.overflow,Oa=r}var On=null,Ot=null,nt=!1,Ua=null,Is=!1,eS=Error(n(519));function Fa(r){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Tp(Cs(a,r)),eS}function ux(r){var a=r.stateNode,u=r.type,p=r.memoizedProps;switch(a[Ln]=r,a[bi]=p,u){case"dialog":je("cancel",a),je("close",a);break;case"iframe":case"object":case"embed":je("load",a);break;case"video":case"audio":for(u=0;u<Yp.length;u++)je(Yp[u],a);break;case"source":je("error",a);break;case"img":case"image":case"link":je("error",a),je("load",a);break;case"details":je("toggle",a);break;case"input":je("invalid",a),EC(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":je("invalid",a);break;case"textarea":je("invalid",a),wC(a,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||p.suppressHydrationWarning===!0||xR(a.textContent,u)?(p.popover!=null&&(je("beforetoggle",a),je("toggle",a)),p.onScroll!=null&&je("scroll",a),p.onScrollEnd!=null&&je("scrollend",a),p.onClick!=null&&(a.onclick=ho),a=!0):a=!1,a||Fa(r,!0)}function dx(r){for(On=r.return;On;)switch(On.tag){case 5:case 31:case 13:Is=!1;return;case 27:case 3:Is=!0;return;default:On=On.return}}function Rd(r){if(r!==On)return!1;if(!nt)return dx(r),nt=!0,!1;var a=r.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||vA(r.type,r.memoizedProps)),u=!u),u&&Ot&&Fa(r),dx(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Ot=OR(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Ot=OR(r)}else a===27?(a=Ot,Qa(r.type)?(r=EA,EA=null,Ot=r):Ot=a):Ot=On?Ms(r.stateNode.nextSibling):null;return!0}function Sc(){Ot=On=null,nt=!1}function tS(){var r=Ua;return r!==null&&(Ti===null?Ti=r:Ti.push.apply(Ti,r),Ua=null),r}function Tp(r){Ua===null?Ua=[r]:Ua.push(r)}var nS=H(null),Ac=null,mo=null;function Ba(r,a,u){se(nS,a._currentValue),a._currentValue=u}function yo(r){r._currentValue=nS.current,J(nS)}function iS(r,a,u){for(;r!==null;){var p=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),r===u)break;r=r.return}}function sS(r,a,u,p){var _=r.child;for(_!==null&&(_.return=r);_!==null;){var S=_.dependencies;if(S!==null){var x=_.child;S=S.firstContext;e:for(;S!==null;){var D=S;S=_;for(var B=0;B<a.length;B++)if(D.context===a[B]){S.lanes|=u,D=S.alternate,D!==null&&(D.lanes|=u),iS(S.return,u,r),p||(x=null);break e}S=D.next}}else if(_.tag===18){if(x=_.return,x===null)throw Error(n(341));x.lanes|=u,S=x.alternate,S!==null&&(S.lanes|=u),iS(x,u,r),x=null}else x=_.child;if(x!==null)x.return=_;else for(x=_;x!==null;){if(x===r){x=null;break}if(_=x.sibling,_!==null){_.return=x.return,x=_;break}x=x.return}_=x}}function Id(r,a,u,p){r=null;for(var _=a,S=!1;_!==null;){if(!S){if((_.flags&524288)!==0)S=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var x=_.alternate;if(x===null)throw Error(n(387));if(x=x.memoizedProps,x!==null){var D=_.type;Gi(_.pendingProps.value,x.value)||(r!==null?r.push(D):r=[D])}}else if(_===Ae.current){if(x=_.alternate,x===null)throw Error(n(387));x.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(r!==null?r.push(jp):r=[jp])}_=_.return}r!==null&&sS(a,r,u,p),a.flags|=262144}function l0(r){for(r=r.firstContext;r!==null;){if(!Gi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ec(r){Ac=r,mo=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Un(r){return hx(Ac,r)}function c0(r,a){return Ac===null&&Ec(r),hx(r,a)}function hx(r,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},mo===null){if(r===null)throw Error(n(308));mo=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else mo=mo.next=a;return u}var bU=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(u,p){r.push(p)}};this.abort=function(){a.aborted=!0,r.forEach(function(u){return u()})}},_U=i.unstable_scheduleCallback,SU=i.unstable_NormalPriority,cn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rS(){return{controller:new bU,data:new Map,refCount:0}}function wp(r){r.refCount--,r.refCount===0&&_U(SU,function(){r.controller.abort()})}var Cp=null,oS=0,Nd=0,Md=null;function AU(r,a){if(Cp===null){var u=Cp=[];oS=0,Nd=cA(),Md={status:"pending",value:void 0,then:function(p){u.push(p)}}}return oS++,a.then(fx,fx),a}function fx(){if(--oS===0&&Cp!==null){Md!==null&&(Md.status="fulfilled");var r=Cp;Cp=null,Nd=0,Md=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function EU(r,a){var u=[],p={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return r.then(function(){p.status="fulfilled",p.value=a;for(var _=0;_<u.length;_++)(0,u[_])(a)},function(_){for(p.status="rejected",p.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),p}var px=G.S;G.S=function(r,a){j1=Ee(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&AU(r,a),px!==null&&px(r,a)};var Tc=H(null);function aS(){var r=Tc.current;return r!==null?r:xt.pooledCache}function u0(r,a){a===null?se(Tc,Tc.current):se(Tc,a.pool)}function gx(){var r=aS();return r===null?null:{parent:cn._currentValue,pool:r}}var Dd=Error(n(460)),lS=Error(n(474)),d0=Error(n(542)),h0={then:function(){}};function mx(r){return r=r.status,r==="fulfilled"||r==="rejected"}function yx(r,a,u){switch(u=r[u],u===void 0?r.push(a):u!==a&&(a.then(ho,ho),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,bx(r),r;default:if(typeof a.status=="string")a.then(ho,ho);else{if(r=xt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=a,r.status="pending",r.then(function(p){if(a.status==="pending"){var _=a;_.status="fulfilled",_.value=p}},function(p){if(a.status==="pending"){var _=a;_.status="rejected",_.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,bx(r),r}throw Cc=a,Dd}}function wc(r){try{var a=r._init;return a(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Cc=u,Dd):u}}var Cc=null;function vx(){if(Cc===null)throw Error(n(459));var r=Cc;return Cc=null,r}function bx(r){if(r===Dd||r===d0)throw Error(n(483))}var kd=null,xp=0;function f0(r){var a=xp;return xp+=1,kd===null&&(kd=[]),yx(kd,r,a)}function Rp(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function p0(r,a){throw a.$$typeof===b?Error(n(525)):(r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function _x(r){function a(V,z){if(r){var Y=V.deletions;Y===null?(V.deletions=[z],V.flags|=16):Y.push(z)}}function u(V,z){if(!r)return null;for(;z!==null;)a(V,z),z=z.sibling;return null}function p(V){for(var z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function _(V,z){return V=po(V,z),V.index=0,V.sibling=null,V}function S(V,z,Y){return V.index=Y,r?(Y=V.alternate,Y!==null?(Y=Y.index,Y<z?(V.flags|=67108866,z):Y):(V.flags|=67108866,z)):(V.flags|=1048576,z)}function x(V){return r&&V.alternate===null&&(V.flags|=67108866),V}function D(V,z,Y,ie){return z===null||z.tag!==6?(z=J_(Y,V.mode,ie),z.return=V,z):(z=_(z,Y),z.return=V,z)}function B(V,z,Y,ie){var Ne=Y.type;return Ne===C?te(V,z,Y.props.children,ie,Y.key):z!==null&&(z.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===K&&wc(Ne)===z.type)?(z=_(z,Y.props),Rp(z,Y),z.return=V,z):(z=o0(Y.type,Y.key,Y.props,null,V.mode,ie),Rp(z,Y),z.return=V,z)}function X(V,z,Y,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==Y.containerInfo||z.stateNode.implementation!==Y.implementation?(z=j_(Y,V.mode,ie),z.return=V,z):(z=_(z,Y.children||[]),z.return=V,z)}function te(V,z,Y,ie,Ne){return z===null||z.tag!==7?(z=_c(Y,V.mode,ie,Ne),z.return=V,z):(z=_(z,Y),z.return=V,z)}function re(V,z,Y){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=J_(""+z,V.mode,Y),z.return=V,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case A:return Y=o0(z.type,z.key,z.props,null,V.mode,Y),Rp(Y,z),Y.return=V,Y;case w:return z=j_(z,V.mode,Y),z.return=V,z;case K:return z=wc(z),re(V,z,Y)}if(pe(z)||oe(z))return z=_c(z,V.mode,Y,null),z.return=V,z;if(typeof z.then=="function")return re(V,f0(z),Y);if(z.$$typeof===k)return re(V,c0(V,z),Y);p0(V,z)}return null}function W(V,z,Y,ie){var Ne=z!==null?z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ne!==null?null:D(V,z,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return Y.key===Ne?B(V,z,Y,ie):null;case w:return Y.key===Ne?X(V,z,Y,ie):null;case K:return Y=wc(Y),W(V,z,Y,ie)}if(pe(Y)||oe(Y))return Ne!==null?null:te(V,z,Y,ie,null);if(typeof Y.then=="function")return W(V,z,f0(Y),ie);if(Y.$$typeof===k)return W(V,z,c0(V,Y),ie);p0(V,Y)}return null}function j(V,z,Y,ie,Ne){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return V=V.get(Y)||null,D(z,V,""+ie,Ne);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case A:return V=V.get(ie.key===null?Y:ie.key)||null,B(z,V,ie,Ne);case w:return V=V.get(ie.key===null?Y:ie.key)||null,X(z,V,ie,Ne);case K:return ie=wc(ie),j(V,z,Y,ie,Ne)}if(pe(ie)||oe(ie))return V=V.get(Y)||null,te(z,V,ie,Ne,null);if(typeof ie.then=="function")return j(V,z,Y,f0(ie),Ne);if(ie.$$typeof===k)return j(V,z,Y,c0(z,ie),Ne);p0(z,ie)}return null}function be(V,z,Y,ie){for(var Ne=null,ot=null,we=z,ze=z=0,et=null;we!==null&&ze<Y.length;ze++){we.index>ze?(et=we,we=null):et=we.sibling;var at=W(V,we,Y[ze],ie);if(at===null){we===null&&(we=et);break}r&&we&&at.alternate===null&&a(V,we),z=S(at,z,ze),ot===null?Ne=at:ot.sibling=at,ot=at,we=et}if(ze===Y.length)return u(V,we),nt&&go(V,ze),Ne;if(we===null){for(;ze<Y.length;ze++)we=re(V,Y[ze],ie),we!==null&&(z=S(we,z,ze),ot===null?Ne=we:ot.sibling=we,ot=we);return nt&&go(V,ze),Ne}for(we=p(we);ze<Y.length;ze++)et=j(we,V,ze,Y[ze],ie),et!==null&&(r&&et.alternate!==null&&we.delete(et.key===null?ze:et.key),z=S(et,z,ze),ot===null?Ne=et:ot.sibling=et,ot=et);return r&&we.forEach(function(il){return a(V,il)}),nt&&go(V,ze),Ne}function Me(V,z,Y,ie){if(Y==null)throw Error(n(151));for(var Ne=null,ot=null,we=z,ze=z=0,et=null,at=Y.next();we!==null&&!at.done;ze++,at=Y.next()){we.index>ze?(et=we,we=null):et=we.sibling;var il=W(V,we,at.value,ie);if(il===null){we===null&&(we=et);break}r&&we&&il.alternate===null&&a(V,we),z=S(il,z,ze),ot===null?Ne=il:ot.sibling=il,ot=il,we=et}if(at.done)return u(V,we),nt&&go(V,ze),Ne;if(we===null){for(;!at.done;ze++,at=Y.next())at=re(V,at.value,ie),at!==null&&(z=S(at,z,ze),ot===null?Ne=at:ot.sibling=at,ot=at);return nt&&go(V,ze),Ne}for(we=p(we);!at.done;ze++,at=Y.next())at=j(we,V,ze,at.value,ie),at!==null&&(r&&at.alternate!==null&&we.delete(at.key===null?ze:at.key),z=S(at,z,ze),ot===null?Ne=at:ot.sibling=at,ot=at);return r&&we.forEach(function(PF){return a(V,PF)}),nt&&go(V,ze),Ne}function St(V,z,Y,ie){if(typeof Y=="object"&&Y!==null&&Y.type===C&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:e:{for(var Ne=Y.key;z!==null;){if(z.key===Ne){if(Ne=Y.type,Ne===C){if(z.tag===7){u(V,z.sibling),ie=_(z,Y.props.children),ie.return=V,V=ie;break e}}else if(z.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===K&&wc(Ne)===z.type){u(V,z.sibling),ie=_(z,Y.props),Rp(ie,Y),ie.return=V,V=ie;break e}u(V,z);break}else a(V,z);z=z.sibling}Y.type===C?(ie=_c(Y.props.children,V.mode,ie,Y.key),ie.return=V,V=ie):(ie=o0(Y.type,Y.key,Y.props,null,V.mode,ie),Rp(ie,Y),ie.return=V,V=ie)}return x(V);case w:e:{for(Ne=Y.key;z!==null;){if(z.key===Ne)if(z.tag===4&&z.stateNode.containerInfo===Y.containerInfo&&z.stateNode.implementation===Y.implementation){u(V,z.sibling),ie=_(z,Y.children||[]),ie.return=V,V=ie;break e}else{u(V,z);break}else a(V,z);z=z.sibling}ie=j_(Y,V.mode,ie),ie.return=V,V=ie}return x(V);case K:return Y=wc(Y),St(V,z,Y,ie)}if(pe(Y))return be(V,z,Y,ie);if(oe(Y)){if(Ne=oe(Y),typeof Ne!="function")throw Error(n(150));return Y=Ne.call(Y),Me(V,z,Y,ie)}if(typeof Y.then=="function")return St(V,z,f0(Y),ie);if(Y.$$typeof===k)return St(V,z,c0(V,Y),ie);p0(V,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,z!==null&&z.tag===6?(u(V,z.sibling),ie=_(z,Y),ie.return=V,V=ie):(u(V,z),ie=J_(Y,V.mode,ie),ie.return=V,V=ie),x(V)):u(V,z)}return function(V,z,Y,ie){try{xp=0;var Ne=St(V,z,Y,ie);return kd=null,Ne}catch(we){if(we===Dd||we===d0)throw we;var ot=zi(29,we,null,V.mode);return ot.lanes=ie,ot.return=V,ot}finally{}}}var xc=_x(!0),Sx=_x(!1),Ha=!1;function cS(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uS(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ga(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function za(r,a,u){var p=r.updateQueue;if(p===null)return null;if(p=p.shared,(ut&2)!==0){var _=p.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),p.pending=a,a=r0(r),sx(r,null,u),a}return s0(r,p,a,u),r0(r)}function Ip(r,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,hC(r,u)}}function dS(r,a){var u=r.updateQueue,p=r.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var x={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?_=S=x:S=S.next=x,u=u.next}while(u!==null);S===null?_=S=a:S=S.next=a}else _=S=a;u={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=a:r.next=a,u.lastBaseUpdate=a}var hS=!1;function Np(){if(hS){var r=Md;if(r!==null)throw r}}function Mp(r,a,u,p){hS=!1;var _=r.updateQueue;Ha=!1;var S=_.firstBaseUpdate,x=_.lastBaseUpdate,D=_.shared.pending;if(D!==null){_.shared.pending=null;var B=D,X=B.next;B.next=null,x===null?S=X:x.next=X,x=B;var te=r.alternate;te!==null&&(te=te.updateQueue,D=te.lastBaseUpdate,D!==x&&(D===null?te.firstBaseUpdate=X:D.next=X,te.lastBaseUpdate=B))}if(S!==null){var re=_.baseState;x=0,te=X=B=null,D=S;do{var W=D.lane&-536870913,j=W!==D.lane;if(j?(Ze&W)===W:(p&W)===W){W!==0&&W===Nd&&(hS=!0),te!==null&&(te=te.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var be=r,Me=D;W=a;var St=u;switch(Me.tag){case 1:if(be=Me.payload,typeof be=="function"){re=be.call(St,re,W);break e}re=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Me.payload,W=typeof be=="function"?be.call(St,re,W):be,W==null)break e;re=y({},re,W);break e;case 2:Ha=!0}}W=D.callback,W!==null&&(r.flags|=64,j&&(r.flags|=8192),j=_.callbacks,j===null?_.callbacks=[W]:j.push(W))}else j={lane:W,tag:D.tag,payload:D.payload,callback:D.callback,next:null},te===null?(X=te=j,B=re):te=te.next=j,x|=W;if(D=D.next,D===null){if(D=_.shared.pending,D===null)break;j=D,D=j.next,j.next=null,_.lastBaseUpdate=j,_.shared.pending=null}}while(!0);te===null&&(B=re),_.baseState=B,_.firstBaseUpdate=X,_.lastBaseUpdate=te,S===null&&(_.shared.lanes=0),Xa|=x,r.lanes=x,r.memoizedState=re}}function Ax(r,a){if(typeof r!="function")throw Error(n(191,r));r.call(a)}function Ex(r,a){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)Ax(u[r],a)}var Pd=H(null),g0=H(0);function Tx(r,a){r=Co,se(g0,r),se(Pd,a),Co=r|a.baseLanes}function fS(){se(g0,Co),se(Pd,Pd.current)}function pS(){Co=g0.current,J(Pd),J(g0)}var Vi=H(null),Ns=null;function Va(r){var a=r.alternate;se(sn,sn.current&1),se(Vi,r),Ns===null&&(a===null||Pd.current!==null||a.memoizedState!==null)&&(Ns=r)}function gS(r){se(sn,sn.current),se(Vi,r),Ns===null&&(Ns=r)}function wx(r){r.tag===22?(se(sn,sn.current),se(Vi,r),Ns===null&&(Ns=r)):qa()}function qa(){se(sn,sn.current),se(Vi,Vi.current)}function qi(r){J(Vi),Ns===r&&(Ns=null),J(sn)}var sn=H(0);function m0(r){for(var a=r;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||SA(u)||AA(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var vo=0,He=null,bt=null,un=null,y0=!1,Ld=!1,Rc=!1,v0=0,Dp=0,Od=null,TU=0;function Jt(){throw Error(n(321))}function mS(r,a){if(a===null)return!1;for(var u=0;u<a.length&&u<r.length;u++)if(!Gi(r[u],a[u]))return!1;return!0}function yS(r,a,u,p,_,S){return vo=S,He=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,G.H=r===null||r.memoizedState===null?l1:DS,Rc=!1,S=u(p,_),Rc=!1,Ld&&(S=xx(a,u,p,_)),Cx(r),S}function Cx(r){G.H=Lp;var a=bt!==null&&bt.next!==null;if(vo=0,un=bt=He=null,y0=!1,Dp=0,Od=null,a)throw Error(n(300));r===null||dn||(r=r.dependencies,r!==null&&l0(r)&&(dn=!0))}function xx(r,a,u,p){He=r;var _=0;do{if(Ld&&(Od=null),Dp=0,Ld=!1,25<=_)throw Error(n(301));if(_+=1,un=bt=null,r.updateQueue!=null){var S=r.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}G.H=c1,S=a(u,p)}while(Ld);return S}function wU(){var r=G.H,a=r.useState()[0];return a=typeof a.then=="function"?kp(a):a,r=r.useState()[0],(bt!==null?bt.memoizedState:null)!==r&&(He.flags|=1024),a}function vS(){var r=v0!==0;return v0=0,r}function bS(r,a,u){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~u}function _S(r){if(y0){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}y0=!1}vo=0,un=bt=He=null,Ld=!1,Dp=v0=0,Od=null}function oi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?He.memoizedState=un=r:un=un.next=r,un}function rn(){if(bt===null){var r=He.alternate;r=r!==null?r.memoizedState:null}else r=bt.next;var a=un===null?He.memoizedState:un.next;if(a!==null)un=a,bt=r;else{if(r===null)throw He.alternate===null?Error(n(467)):Error(n(310));bt=r,r={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},un===null?He.memoizedState=un=r:un=un.next=r}return un}function b0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kp(r){var a=Dp;return Dp+=1,Od===null&&(Od=[]),r=yx(Od,r,a),a=He,(un===null?a.memoizedState:un.next)===null&&(a=a.alternate,G.H=a===null||a.memoizedState===null?l1:DS),r}function _0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return kp(r);if(r.$$typeof===k)return Un(r)}throw Error(n(438,String(r)))}function SS(r){var a=null,u=He.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var p=He.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(_){return _.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=b0(),He.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(r),p=0;p<r;p++)u[p]=Q;return a.index++,u}function bo(r,a){return typeof a=="function"?a(r):a}function S0(r){var a=rn();return AS(a,bt,r)}function AS(r,a,u){var p=r.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=u;var _=r.baseQueue,S=p.pending;if(S!==null){if(_!==null){var x=_.next;_.next=S.next,S.next=x}a.baseQueue=_=S,p.pending=null}if(S=r.baseState,_===null)r.memoizedState=S;else{a=_.next;var D=x=null,B=null,X=a,te=!1;do{var re=X.lane&-536870913;if(re!==X.lane?(Ze&re)===re:(vo&re)===re){var W=X.revertLane;if(W===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),re===Nd&&(te=!0);else if((vo&W)===W){X=X.next,W===Nd&&(te=!0);continue}else re={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(D=B=re,x=S):B=B.next=re,He.lanes|=W,Xa|=W;re=X.action,Rc&&u(S,re),S=X.hasEagerState?X.eagerState:u(S,re)}else W={lane:re,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},B===null?(D=B=W,x=S):B=B.next=W,He.lanes|=re,Xa|=re;X=X.next}while(X!==null&&X!==a);if(B===null?x=S:B.next=D,!Gi(S,r.memoizedState)&&(dn=!0,te&&(u=Md,u!==null)))throw u;r.memoizedState=S,r.baseState=x,r.baseQueue=B,p.lastRenderedState=S}return _===null&&(p.lanes=0),[r.memoizedState,p.dispatch]}function ES(r){var a=rn(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var p=u.dispatch,_=u.pending,S=a.memoizedState;if(_!==null){u.pending=null;var x=_=_.next;do S=r(S,x.action),x=x.next;while(x!==_);Gi(S,a.memoizedState)||(dn=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),u.lastRenderedState=S}return[S,p]}function Rx(r,a,u){var p=He,_=rn(),S=nt;if(S){if(u===void 0)throw Error(n(407));u=u()}else u=a();var x=!Gi((bt||_).memoizedState,u);if(x&&(_.memoizedState=u,dn=!0),_=_.queue,CS(Mx.bind(null,p,_,r),[r]),_.getSnapshot!==a||x||un!==null&&un.memoizedState.tag&1){if(p.flags|=2048,Ud(9,{destroy:void 0},Nx.bind(null,p,_,u,a),null),xt===null)throw Error(n(349));S||(vo&127)!==0||Ix(p,a,u)}return u}function Ix(r,a,u){r.flags|=16384,r={getSnapshot:a,value:u},a=He.updateQueue,a===null?(a=b0(),He.updateQueue=a,a.stores=[r]):(u=a.stores,u===null?a.stores=[r]:u.push(r))}function Nx(r,a,u,p){a.value=u,a.getSnapshot=p,Dx(a)&&kx(r)}function Mx(r,a,u){return u(function(){Dx(a)&&kx(r)})}function Dx(r){var a=r.getSnapshot;r=r.value;try{var u=a();return!Gi(r,u)}catch{return!0}}function kx(r){var a=bc(r,2);a!==null&&wi(a,r,2)}function TS(r){var a=oi();if(typeof r=="function"){var u=r;if(r=u(),Rc){ka(!0);try{u()}finally{ka(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:r},a}function Px(r,a,u,p){return r.baseState=u,AS(r,bt,typeof p=="function"?p:bo)}function CU(r,a,u,p,_){if(T0(r))throw Error(n(485));if(r=a.action,r!==null){var S={payload:_,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){S.listeners.push(x)}};G.T!==null?u(!0):S.isTransition=!1,p(S),u=a.pending,u===null?(S.next=a.pending=S,Lx(a,S)):(S.next=u.next,a.pending=u.next=S)}}function Lx(r,a){var u=a.action,p=a.payload,_=r.state;if(a.isTransition){var S=G.T,x={};G.T=x;try{var D=u(_,p),B=G.S;B!==null&&B(x,D),Ox(r,a,D)}catch(X){wS(r,a,X)}finally{S!==null&&x.types!==null&&(S.types=x.types),G.T=S}}else try{S=u(_,p),Ox(r,a,S)}catch(X){wS(r,a,X)}}function Ox(r,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){Ux(r,a,p)},function(p){return wS(r,a,p)}):Ux(r,a,u)}function Ux(r,a,u){a.status="fulfilled",a.value=u,Fx(a),r.state=u,a=r.pending,a!==null&&(u=a.next,u===a?r.pending=null:(u=u.next,a.next=u,Lx(r,u)))}function wS(r,a,u){var p=r.pending;if(r.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=u,Fx(a),a=a.next;while(a!==p)}r.action=null}function Fx(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function Bx(r,a){return a}function Hx(r,a){if(nt){var u=xt.formState;if(u!==null){e:{var p=He;if(nt){if(Ot){t:{for(var _=Ot,S=Is;_.nodeType!==8;){if(!S){_=null;break t}if(_=Ms(_.nextSibling),_===null){_=null;break t}}S=_.data,_=S==="F!"||S==="F"?_:null}if(_){Ot=Ms(_.nextSibling),p=_.data==="F!";break e}}Fa(p)}p=!1}p&&(a=u[0])}}return u=oi(),u.memoizedState=u.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bx,lastRenderedState:a},u.queue=p,u=r1.bind(null,He,p),p.dispatch=u,p=TS(!1),S=MS.bind(null,He,!1,p.queue),p=oi(),_={state:a,dispatch:null,action:r,pending:null},p.queue=_,u=CU.bind(null,He,_,S,u),_.dispatch=u,p.memoizedState=r,[a,u,!1]}function Gx(r){var a=rn();return zx(a,bt,r)}function zx(r,a,u){if(a=AS(r,a,Bx)[0],r=S0(bo)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=kp(a)}catch(x){throw x===Dd?d0:x}else p=a;a=rn();var _=a.queue,S=_.dispatch;return u!==a.memoizedState&&(He.flags|=2048,Ud(9,{destroy:void 0},xU.bind(null,_,u),null)),[p,S,r]}function xU(r,a){r.action=a}function Vx(r){var a=rn(),u=bt;if(u!==null)return zx(a,u,r);rn(),a=a.memoizedState,u=rn();var p=u.queue.dispatch;return u.memoizedState=r,[a,p,!1]}function Ud(r,a,u,p){return r={tag:r,create:u,deps:p,inst:a,next:null},a=He.updateQueue,a===null&&(a=b0(),He.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=r.next=r:(p=u.next,u.next=r,r.next=p,a.lastEffect=r),r}function qx(){return rn().memoizedState}function A0(r,a,u,p){var _=oi();He.flags|=r,_.memoizedState=Ud(1|a,{destroy:void 0},u,p===void 0?null:p)}function E0(r,a,u,p){var _=rn();p=p===void 0?null:p;var S=_.memoizedState.inst;bt!==null&&p!==null&&mS(p,bt.memoizedState.deps)?_.memoizedState=Ud(a,S,u,p):(He.flags|=r,_.memoizedState=Ud(1|a,S,u,p))}function $x(r,a){A0(8390656,8,r,a)}function CS(r,a){E0(2048,8,r,a)}function RU(r){He.flags|=4;var a=He.updateQueue;if(a===null)a=b0(),He.updateQueue=a,a.events=[r];else{var u=a.events;u===null?a.events=[r]:u.push(r)}}function Yx(r){var a=rn().memoizedState;return RU({ref:a,nextImpl:r}),function(){if((ut&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Xx(r,a){return E0(4,2,r,a)}function Wx(r,a){return E0(4,4,r,a)}function Kx(r,a){if(typeof a=="function"){r=r();var u=a(r);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function Jx(r,a,u){u=u!=null?u.concat([r]):null,E0(4,4,Kx.bind(null,a,r),u)}function xS(){}function jx(r,a){var u=rn();a=a===void 0?null:a;var p=u.memoizedState;return a!==null&&mS(a,p[1])?p[0]:(u.memoizedState=[r,a],r)}function Qx(r,a){var u=rn();a=a===void 0?null:a;var p=u.memoizedState;if(a!==null&&mS(a,p[1]))return p[0];if(p=r(),Rc){ka(!0);try{r()}finally{ka(!1)}}return u.memoizedState=[p,a],p}function RS(r,a,u){return u===void 0||(vo&1073741824)!==0&&(Ze&261930)===0?r.memoizedState=a:(r.memoizedState=u,r=Z1(),He.lanes|=r,Xa|=r,u)}function Zx(r,a,u,p){return Gi(u,a)?u:Pd.current!==null?(r=RS(r,u,p),Gi(r,a)||(dn=!0),r):(vo&42)===0||(vo&1073741824)!==0&&(Ze&261930)===0?(dn=!0,r.memoizedState=u):(r=Z1(),He.lanes|=r,Xa|=r,a)}function e1(r,a,u,p,_){var S=$.p;$.p=S!==0&&8>S?S:8;var x=G.T,D={};G.T=D,MS(r,!1,a,u);try{var B=_(),X=G.S;if(X!==null&&X(D,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var te=EU(B,p);Pp(r,a,te,Xi(r))}else Pp(r,a,p,Xi(r))}catch(re){Pp(r,a,{then:function(){},status:"rejected",reason:re},Xi())}finally{$.p=S,x!==null&&D.types!==null&&(x.types=D.types),G.T=x}}function IU(){}function IS(r,a,u,p){if(r.tag!==5)throw Error(n(476));var _=t1(r).queue;e1(r,_,a,ae,u===null?IU:function(){return n1(r),u(p)})}function t1(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:ae},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:u},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function n1(r){var a=t1(r);a.next===null&&(a=r.alternate.memoizedState),Pp(r,a.next.queue,{},Xi())}function NS(){return Un(jp)}function i1(){return rn().memoizedState}function s1(){return rn().memoizedState}function NU(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var u=Xi();r=Ga(u);var p=za(a,r,u);p!==null&&(wi(p,a,u),Ip(p,a,u)),a={cache:rS()},r.payload=a;return}a=a.return}}function MU(r,a,u){var p=Xi();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},T0(r)?o1(a,u):(u=W_(r,a,u,p),u!==null&&(wi(u,r,p),a1(u,a,p)))}function r1(r,a,u){var p=Xi();Pp(r,a,u,p)}function Pp(r,a,u,p){var _={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(T0(r))o1(a,_);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var x=a.lastRenderedState,D=S(x,u);if(_.hasEagerState=!0,_.eagerState=D,Gi(D,x))return s0(r,a,_,0),xt===null&&i0(),!1}catch{}finally{}if(u=W_(r,a,_,p),u!==null)return wi(u,r,p),a1(u,a,p),!0}return!1}function MS(r,a,u,p){if(p={lane:2,revertLane:cA(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},T0(r)){if(a)throw Error(n(479))}else a=W_(r,u,p,2),a!==null&&wi(a,r,2)}function T0(r){var a=r.alternate;return r===He||a!==null&&a===He}function o1(r,a){Ld=y0=!0;var u=r.pending;u===null?a.next=a:(a.next=u.next,u.next=a),r.pending=a}function a1(r,a,u){if((u&4194048)!==0){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,hC(r,u)}}var Lp={readContext:Un,use:_0,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useLayoutEffect:Jt,useInsertionEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useSyncExternalStore:Jt,useId:Jt,useHostTransitionStatus:Jt,useFormState:Jt,useActionState:Jt,useOptimistic:Jt,useMemoCache:Jt,useCacheRefresh:Jt};Lp.useEffectEvent=Jt;var l1={readContext:Un,use:_0,useCallback:function(r,a){return oi().memoizedState=[r,a===void 0?null:a],r},useContext:Un,useEffect:$x,useImperativeHandle:function(r,a,u){u=u!=null?u.concat([r]):null,A0(4194308,4,Kx.bind(null,a,r),u)},useLayoutEffect:function(r,a){return A0(4194308,4,r,a)},useInsertionEffect:function(r,a){A0(4,2,r,a)},useMemo:function(r,a){var u=oi();a=a===void 0?null:a;var p=r();if(Rc){ka(!0);try{r()}finally{ka(!1)}}return u.memoizedState=[p,a],p},useReducer:function(r,a,u){var p=oi();if(u!==void 0){var _=u(a);if(Rc){ka(!0);try{u(a)}finally{ka(!1)}}}else _=a;return p.memoizedState=p.baseState=_,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:_},p.queue=r,r=r.dispatch=MU.bind(null,He,r),[p.memoizedState,r]},useRef:function(r){var a=oi();return r={current:r},a.memoizedState=r},useState:function(r){r=TS(r);var a=r.queue,u=r1.bind(null,He,a);return a.dispatch=u,[r.memoizedState,u]},useDebugValue:xS,useDeferredValue:function(r,a){var u=oi();return RS(u,r,a)},useTransition:function(){var r=TS(!1);return r=e1.bind(null,He,r.queue,!0,!1),oi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,u){var p=He,_=oi();if(nt){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),xt===null)throw Error(n(349));(Ze&127)!==0||Ix(p,a,u)}_.memoizedState=u;var S={value:u,getSnapshot:a};return _.queue=S,$x(Mx.bind(null,p,S,r),[r]),p.flags|=2048,Ud(9,{destroy:void 0},Nx.bind(null,p,S,u,a),null),u},useId:function(){var r=oi(),a=xt.identifierPrefix;if(nt){var u=wr,p=Tr;u=(p&~(1<<32-Hi(p)-1)).toString(32)+u,a="_"+a+"R_"+u,u=v0++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=TU++,a="_"+a+"r_"+u.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:NS,useFormState:Hx,useActionState:Hx,useOptimistic:function(r){var a=oi();a.memoizedState=a.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=MS.bind(null,He,!0,u),u.dispatch=a,[r,a]},useMemoCache:SS,useCacheRefresh:function(){return oi().memoizedState=NU.bind(null,He)},useEffectEvent:function(r){var a=oi(),u={impl:r};return a.memoizedState=u,function(){if((ut&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},DS={readContext:Un,use:_0,useCallback:jx,useContext:Un,useEffect:CS,useImperativeHandle:Jx,useInsertionEffect:Xx,useLayoutEffect:Wx,useMemo:Qx,useReducer:S0,useRef:qx,useState:function(){return S0(bo)},useDebugValue:xS,useDeferredValue:function(r,a){var u=rn();return Zx(u,bt.memoizedState,r,a)},useTransition:function(){var r=S0(bo)[0],a=rn().memoizedState;return[typeof r=="boolean"?r:kp(r),a]},useSyncExternalStore:Rx,useId:i1,useHostTransitionStatus:NS,useFormState:Gx,useActionState:Gx,useOptimistic:function(r,a){var u=rn();return Px(u,bt,r,a)},useMemoCache:SS,useCacheRefresh:s1};DS.useEffectEvent=Yx;var c1={readContext:Un,use:_0,useCallback:jx,useContext:Un,useEffect:CS,useImperativeHandle:Jx,useInsertionEffect:Xx,useLayoutEffect:Wx,useMemo:Qx,useReducer:ES,useRef:qx,useState:function(){return ES(bo)},useDebugValue:xS,useDeferredValue:function(r,a){var u=rn();return bt===null?RS(u,r,a):Zx(u,bt.memoizedState,r,a)},useTransition:function(){var r=ES(bo)[0],a=rn().memoizedState;return[typeof r=="boolean"?r:kp(r),a]},useSyncExternalStore:Rx,useId:i1,useHostTransitionStatus:NS,useFormState:Vx,useActionState:Vx,useOptimistic:function(r,a){var u=rn();return bt!==null?Px(u,bt,r,a):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:SS,useCacheRefresh:s1};c1.useEffectEvent=Yx;function kS(r,a,u,p){a=r.memoizedState,u=u(p,a),u=u==null?a:y({},a,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var PS={enqueueSetState:function(r,a,u){r=r._reactInternals;var p=Xi(),_=Ga(p);_.payload=a,u!=null&&(_.callback=u),a=za(r,_,p),a!==null&&(wi(a,r,p),Ip(a,r,p))},enqueueReplaceState:function(r,a,u){r=r._reactInternals;var p=Xi(),_=Ga(p);_.tag=1,_.payload=a,u!=null&&(_.callback=u),a=za(r,_,p),a!==null&&(wi(a,r,p),Ip(a,r,p))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var u=Xi(),p=Ga(u);p.tag=2,a!=null&&(p.callback=a),a=za(r,p,u),a!==null&&(wi(a,r,u),Ip(a,r,u))}};function u1(r,a,u,p,_,S,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(p,S,x):a.prototype&&a.prototype.isPureReactComponent?!Sp(u,p)||!Sp(_,S):!0}function d1(r,a,u,p){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,p),a.state!==r&&PS.enqueueReplaceState(a,a.state,null)}function Ic(r,a){var u=a;if("ref"in a){u={};for(var p in a)p!=="ref"&&(u[p]=a[p])}if(r=r.defaultProps){u===a&&(u=y({},u));for(var _ in r)u[_]===void 0&&(u[_]=r[_])}return u}function h1(r){n0(r)}function f1(r){console.error(r)}function p1(r){n0(r)}function w0(r,a){try{var u=r.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function g1(r,a,u){try{var p=r.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function LS(r,a,u){return u=Ga(u),u.tag=3,u.payload={element:null},u.callback=function(){w0(r,a)},u}function m1(r){return r=Ga(r),r.tag=3,r}function y1(r,a,u,p){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var S=p.value;r.payload=function(){return _(S)},r.callback=function(){g1(a,u,p)}}var x=u.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(r.callback=function(){g1(a,u,p),typeof _!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var D=p.stack;this.componentDidCatch(p.value,{componentStack:D!==null?D:""})})}function DU(r,a,u,p,_){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=u.alternate,a!==null&&Id(a,u,_,!0),u=Vi.current,u!==null){switch(u.tag){case 31:case 13:return Ns===null?U0():u.alternate===null&&jt===0&&(jt=3),u.flags&=-257,u.flags|=65536,u.lanes=_,p===h0?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([p]):a.add(p),oA(r,p,_)),!1;case 22:return u.flags|=65536,p===h0?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([p]):u.add(p)),oA(r,p,_)),!1}throw Error(n(435,u.tag))}return oA(r,p,_),U0(),!1}if(nt)return a=Vi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=_,p!==eS&&(r=Error(n(422),{cause:p}),Tp(Cs(r,u)))):(p!==eS&&(a=Error(n(423),{cause:p}),Tp(Cs(a,u))),r=r.current.alternate,r.flags|=65536,_&=-_,r.lanes|=_,p=Cs(p,u),_=LS(r.stateNode,p,_),dS(r,_),jt!==4&&(jt=2)),!1;var S=Error(n(520),{cause:p});if(S=Cs(S,u),Vp===null?Vp=[S]:Vp.push(S),jt!==4&&(jt=2),a===null)return!0;p=Cs(p,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,r=_&-_,u.lanes|=r,r=LS(u.stateNode,p,r),dS(u,r),!1;case 1:if(a=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Wa===null||!Wa.has(S))))return u.flags|=65536,_&=-_,u.lanes|=_,_=m1(_),y1(_,r,u,p),dS(u,_),!1}u=u.return}while(u!==null);return!1}var OS=Error(n(461)),dn=!1;function Fn(r,a,u,p){a.child=r===null?Sx(a,null,u,p):xc(a,r.child,u,p)}function v1(r,a,u,p,_){u=u.render;var S=a.ref;if("ref"in p){var x={};for(var D in p)D!=="ref"&&(x[D]=p[D])}else x=p;return Ec(a),p=yS(r,a,u,x,S,_),D=vS(),r!==null&&!dn?(bS(r,a,_),_o(r,a,_)):(nt&&D&&Q_(a),a.flags|=1,Fn(r,a,p,_),a.child)}function b1(r,a,u,p,_){if(r===null){var S=u.type;return typeof S=="function"&&!K_(S)&&S.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=S,_1(r,a,S,p,_)):(r=o0(u.type,null,p,a,a.mode,_),r.ref=a.ref,r.return=a,a.child=r)}if(S=r.child,!qS(r,_)){var x=S.memoizedProps;if(u=u.compare,u=u!==null?u:Sp,u(x,p)&&r.ref===a.ref)return _o(r,a,_)}return a.flags|=1,r=po(S,p),r.ref=a.ref,r.return=a,a.child=r}function _1(r,a,u,p,_){if(r!==null){var S=r.memoizedProps;if(Sp(S,p)&&r.ref===a.ref)if(dn=!1,a.pendingProps=p=S,qS(r,_))(r.flags&131072)!==0&&(dn=!0);else return a.lanes=r.lanes,_o(r,a,_)}return US(r,a,u,p,_)}function S1(r,a,u,p){var _=p.children,S=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(S=S!==null?S.baseLanes|u:u,r!==null){for(p=a.child=r.child,_=0;p!==null;)_=_|p.lanes|p.childLanes,p=p.sibling;p=_&~S}else p=0,a.child=null;return A1(r,a,S,u,p)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&u0(a,S!==null?S.cachePool:null),S!==null?Tx(a,S):fS(),wx(a);else return p=a.lanes=536870912,A1(r,a,S!==null?S.baseLanes|u:u,u,p)}else S!==null?(u0(a,S.cachePool),Tx(a,S),qa(),a.memoizedState=null):(r!==null&&u0(a,null),fS(),qa());return Fn(r,a,_,u),a.child}function Op(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function A1(r,a,u,p,_){var S=aS();return S=S===null?null:{parent:cn._currentValue,pool:S},a.memoizedState={baseLanes:u,cachePool:S},r!==null&&u0(a,null),fS(),wx(a),r!==null&&Id(r,a,p,!0),a.childLanes=_,null}function C0(r,a){return a=R0({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function E1(r,a,u){return xc(a,r.child,null,u),r=C0(a,a.pendingProps),r.flags|=2,qi(a),a.memoizedState=null,r}function kU(r,a,u){var p=a.pendingProps,_=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(nt){if(p.mode==="hidden")return r=C0(a,p),a.lanes=536870912,Op(null,r);if(gS(a),(r=Ot)?(r=LR(r,Is),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:Oa!==null?{id:Tr,overflow:wr}:null,retryLane:536870912,hydrationErrors:null},u=ox(r),u.return=a,a.child=u,On=a,Ot=null)):r=null,r===null)throw Fa(a);return a.lanes=536870912,null}return C0(a,p)}var S=r.memoizedState;if(S!==null){var x=S.dehydrated;if(gS(a),_)if(a.flags&256)a.flags&=-257,a=E1(r,a,u);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(n(558));else if(dn||Id(r,a,u,!1),_=(u&r.childLanes)!==0,dn||_){if(p=xt,p!==null&&(x=fC(p,u),x!==0&&x!==S.retryLane))throw S.retryLane=x,bc(r,x),wi(p,r,x),OS;U0(),a=E1(r,a,u)}else r=S.treeContext,Ot=Ms(x.nextSibling),On=a,nt=!0,Ua=null,Is=!1,r!==null&&cx(a,r),a=C0(a,p),a.flags|=4096;return a}return r=po(r.child,{mode:p.mode,children:p.children}),r.ref=a.ref,a.child=r,r.return=a,r}function x0(r,a){var u=a.ref;if(u===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(a.flags|=4194816)}}function US(r,a,u,p,_){return Ec(a),u=yS(r,a,u,p,void 0,_),p=vS(),r!==null&&!dn?(bS(r,a,_),_o(r,a,_)):(nt&&p&&Q_(a),a.flags|=1,Fn(r,a,u,_),a.child)}function T1(r,a,u,p,_,S){return Ec(a),a.updateQueue=null,u=xx(a,p,u,_),Cx(r),p=vS(),r!==null&&!dn?(bS(r,a,S),_o(r,a,S)):(nt&&p&&Q_(a),a.flags|=1,Fn(r,a,u,S),a.child)}function w1(r,a,u,p,_){if(Ec(a),a.stateNode===null){var S=wd,x=u.contextType;typeof x=="object"&&x!==null&&(S=Un(x)),S=new u(p,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=PS,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=p,S.state=a.memoizedState,S.refs={},cS(a),x=u.contextType,S.context=typeof x=="object"&&x!==null?Un(x):wd,S.state=a.memoizedState,x=u.getDerivedStateFromProps,typeof x=="function"&&(kS(a,u,x,p),S.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(x=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),x!==S.state&&PS.enqueueReplaceState(S,S.state,null),Mp(a,p,S,_),Np(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(r===null){S=a.stateNode;var D=a.memoizedProps,B=Ic(u,D);S.props=B;var X=S.context,te=u.contextType;x=wd,typeof te=="object"&&te!==null&&(x=Un(te));var re=u.getDerivedStateFromProps;te=typeof re=="function"||typeof S.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,te||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D||X!==x)&&d1(a,S,p,x),Ha=!1;var W=a.memoizedState;S.state=W,Mp(a,p,S,_),Np(),X=a.memoizedState,D||W!==X||Ha?(typeof re=="function"&&(kS(a,u,re,p),X=a.memoizedState),(B=Ha||u1(a,u,B,p,W,X,x))?(te||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=X),S.props=p,S.state=X,S.context=x,p=B):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{S=a.stateNode,uS(r,a),x=a.memoizedProps,te=Ic(u,x),S.props=te,re=a.pendingProps,W=S.context,X=u.contextType,B=wd,typeof X=="object"&&X!==null&&(B=Un(X)),D=u.getDerivedStateFromProps,(X=typeof D=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(x!==re||W!==B)&&d1(a,S,p,B),Ha=!1,W=a.memoizedState,S.state=W,Mp(a,p,S,_),Np();var j=a.memoizedState;x!==re||W!==j||Ha||r!==null&&r.dependencies!==null&&l0(r.dependencies)?(typeof D=="function"&&(kS(a,u,D,p),j=a.memoizedState),(te=Ha||u1(a,u,te,p,W,j,B)||r!==null&&r.dependencies!==null&&l0(r.dependencies))?(X||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,j,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,j,B)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=j),S.props=p,S.state=j,S.context=B,p=te):(typeof S.componentDidUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),p=!1)}return S=p,x0(r,a),p=(a.flags&128)!==0,S||p?(S=a.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,r!==null&&p?(a.child=xc(a,r.child,null,_),a.child=xc(a,null,u,_)):Fn(r,a,u,_),a.memoizedState=S.state,r=a.child):r=_o(r,a,_),r}function C1(r,a,u,p){return Sc(),a.flags|=256,Fn(r,a,u,p),a.child}var FS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function BS(r){return{baseLanes:r,cachePool:gx()}}function HS(r,a,u){return r=r!==null?r.childLanes&~u:0,a&&(r|=Yi),r}function x1(r,a,u){var p=a.pendingProps,_=!1,S=(a.flags&128)!==0,x;if((x=S)||(x=r!==null&&r.memoizedState===null?!1:(sn.current&2)!==0),x&&(_=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,r===null){if(nt){if(_?Va(a):qa(),(r=Ot)?(r=LR(r,Is),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:Oa!==null?{id:Tr,overflow:wr}:null,retryLane:536870912,hydrationErrors:null},u=ox(r),u.return=a,a.child=u,On=a,Ot=null)):r=null,r===null)throw Fa(a);return AA(r)?a.lanes=32:a.lanes=536870912,null}var D=p.children;return p=p.fallback,_?(qa(),_=a.mode,D=R0({mode:"hidden",children:D},_),p=_c(p,_,u,null),D.return=a,p.return=a,D.sibling=p,a.child=D,p=a.child,p.memoizedState=BS(u),p.childLanes=HS(r,x,u),a.memoizedState=FS,Op(null,p)):(Va(a),GS(a,D))}var B=r.memoizedState;if(B!==null&&(D=B.dehydrated,D!==null)){if(S)a.flags&256?(Va(a),a.flags&=-257,a=zS(r,a,u)):a.memoizedState!==null?(qa(),a.child=r.child,a.flags|=128,a=null):(qa(),D=p.fallback,_=a.mode,p=R0({mode:"visible",children:p.children},_),D=_c(D,_,u,null),D.flags|=2,p.return=a,D.return=a,p.sibling=D,a.child=p,xc(a,r.child,null,u),p=a.child,p.memoizedState=BS(u),p.childLanes=HS(r,x,u),a.memoizedState=FS,a=Op(null,p));else if(Va(a),AA(D)){if(x=D.nextSibling&&D.nextSibling.dataset,x)var X=x.dgst;x=X,p=Error(n(419)),p.stack="",p.digest=x,Tp({value:p,source:null,stack:null}),a=zS(r,a,u)}else if(dn||Id(r,a,u,!1),x=(u&r.childLanes)!==0,dn||x){if(x=xt,x!==null&&(p=fC(x,u),p!==0&&p!==B.retryLane))throw B.retryLane=p,bc(r,p),wi(x,r,p),OS;SA(D)||U0(),a=zS(r,a,u)}else SA(D)?(a.flags|=192,a.child=r.child,a=null):(r=B.treeContext,Ot=Ms(D.nextSibling),On=a,nt=!0,Ua=null,Is=!1,r!==null&&cx(a,r),a=GS(a,p.children),a.flags|=4096);return a}return _?(qa(),D=p.fallback,_=a.mode,B=r.child,X=B.sibling,p=po(B,{mode:"hidden",children:p.children}),p.subtreeFlags=B.subtreeFlags&65011712,X!==null?D=po(X,D):(D=_c(D,_,u,null),D.flags|=2),D.return=a,p.return=a,p.sibling=D,a.child=p,Op(null,p),p=a.child,D=r.child.memoizedState,D===null?D=BS(u):(_=D.cachePool,_!==null?(B=cn._currentValue,_=_.parent!==B?{parent:B,pool:B}:_):_=gx(),D={baseLanes:D.baseLanes|u,cachePool:_}),p.memoizedState=D,p.childLanes=HS(r,x,u),a.memoizedState=FS,Op(r.child,p)):(Va(a),u=r.child,r=u.sibling,u=po(u,{mode:"visible",children:p.children}),u.return=a,u.sibling=null,r!==null&&(x=a.deletions,x===null?(a.deletions=[r],a.flags|=16):x.push(r)),a.child=u,a.memoizedState=null,u)}function GS(r,a){return a=R0({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function R0(r,a){return r=zi(22,r,null,a),r.lanes=0,r}function zS(r,a,u){return xc(a,r.child,null,u),r=GS(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function R1(r,a,u){r.lanes|=a;var p=r.alternate;p!==null&&(p.lanes|=a),iS(r.return,a,u)}function VS(r,a,u,p,_,S){var x=r.memoizedState;x===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:_,treeForkCount:S}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=p,x.tail=u,x.tailMode=_,x.treeForkCount=S)}function I1(r,a,u){var p=a.pendingProps,_=p.revealOrder,S=p.tail;p=p.children;var x=sn.current,D=(x&2)!==0;if(D?(x=x&1|2,a.flags|=128):x&=1,se(sn,x),Fn(r,a,p,u),p=nt?Ep:0,!D&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&R1(r,u,a);else if(r.tag===19)R1(r,u,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(_){case"forwards":for(u=a.child,_=null;u!==null;)r=u.alternate,r!==null&&m0(r)===null&&(_=u),u=u.sibling;u=_,u===null?(_=a.child,a.child=null):(_=u.sibling,u.sibling=null),VS(a,!1,_,u,S,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,_=a.child,a.child=null;_!==null;){if(r=_.alternate,r!==null&&m0(r)===null){a.child=_;break}r=_.sibling,_.sibling=u,u=_,_=r}VS(a,!0,u,null,S,p);break;case"together":VS(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function _o(r,a,u){if(r!==null&&(a.dependencies=r.dependencies),Xa|=a.lanes,(u&a.childLanes)===0)if(r!==null){if(Id(r,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,u=po(r,r.pendingProps),a.child=u,u.return=a;r.sibling!==null;)r=r.sibling,u=u.sibling=po(r,r.pendingProps),u.return=a;u.sibling=null}return a.child}function qS(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&l0(r)))}function PU(r,a,u){switch(a.tag){case 3:ft(a,a.stateNode.containerInfo),Ba(a,cn,r.memoizedState.cache),Sc();break;case 27:case 5:qt(a);break;case 4:ft(a,a.stateNode.containerInfo);break;case 10:Ba(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,gS(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(Va(a),a.flags|=128,null):(u&a.child.childLanes)!==0?x1(r,a,u):(Va(a),r=_o(r,a,u),r!==null?r.sibling:null);Va(a);break;case 19:var _=(r.flags&128)!==0;if(p=(u&a.childLanes)!==0,p||(Id(r,a,u,!1),p=(u&a.childLanes)!==0),_){if(p)return I1(r,a,u);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),se(sn,sn.current),p)break;return null;case 22:return a.lanes=0,S1(r,a,u,a.pendingProps);case 24:Ba(a,cn,r.memoizedState.cache)}return _o(r,a,u)}function N1(r,a,u){if(r!==null)if(r.memoizedProps!==a.pendingProps)dn=!0;else{if(!qS(r,u)&&(a.flags&128)===0)return dn=!1,PU(r,a,u);dn=(r.flags&131072)!==0}else dn=!1,nt&&(a.flags&1048576)!==0&&lx(a,Ep,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(r=wc(a.elementType),a.type=r,typeof r=="function")K_(r)?(p=Ic(r,p),a.tag=1,a=w1(null,a,r,p,u)):(a.tag=0,a=US(null,a,r,p,u));else{if(r!=null){var _=r.$$typeof;if(_===L){a.tag=11,a=v1(null,a,r,p,u);break e}else if(_===F){a.tag=14,a=b1(null,a,r,p,u);break e}}throw a=ue(r)||r,Error(n(306,a,""))}}return a;case 0:return US(r,a,a.type,a.pendingProps,u);case 1:return p=a.type,_=Ic(p,a.pendingProps),w1(r,a,p,_,u);case 3:e:{if(ft(a,a.stateNode.containerInfo),r===null)throw Error(n(387));p=a.pendingProps;var S=a.memoizedState;_=S.element,uS(r,a),Mp(a,p,null,u);var x=a.memoizedState;if(p=x.cache,Ba(a,cn,p),p!==S.cache&&sS(a,[cn],u,!0),Np(),p=x.element,S.isDehydrated)if(S={element:p,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=C1(r,a,p,u);break e}else if(p!==_){_=Cs(Error(n(424)),a),Tp(_),a=C1(r,a,p,u);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ot=Ms(r.firstChild),On=a,nt=!0,Ua=null,Is=!0,u=Sx(a,null,p,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Sc(),p===_){a=_o(r,a,u);break e}Fn(r,a,p,u)}a=a.child}return a;case 26:return x0(r,a),r===null?(u=GR(a.type,null,a.pendingProps,null))?a.memoizedState=u:nt||(u=a.type,r=a.pendingProps,p=q0(Re.current).createElement(u),p[Ln]=a,p[bi]=r,Bn(p,u,r),En(p),a.stateNode=p):a.memoizedState=GR(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return qt(a),r===null&&nt&&(p=a.stateNode=FR(a.type,a.pendingProps,Re.current),On=a,Is=!0,_=Ot,Qa(a.type)?(EA=_,Ot=Ms(p.firstChild)):Ot=_),Fn(r,a,a.pendingProps.children,u),x0(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&nt&&((_=p=Ot)&&(p=uF(p,a.type,a.pendingProps,Is),p!==null?(a.stateNode=p,On=a,Ot=Ms(p.firstChild),Is=!1,_=!0):_=!1),_||Fa(a)),qt(a),_=a.type,S=a.pendingProps,x=r!==null?r.memoizedProps:null,p=S.children,vA(_,S)?p=null:x!==null&&vA(_,x)&&(a.flags|=32),a.memoizedState!==null&&(_=yS(r,a,wU,null,null,u),jp._currentValue=_),x0(r,a),Fn(r,a,p,u),a.child;case 6:return r===null&&nt&&((r=u=Ot)&&(u=dF(u,a.pendingProps,Is),u!==null?(a.stateNode=u,On=a,Ot=null,r=!0):r=!1),r||Fa(a)),null;case 13:return x1(r,a,u);case 4:return ft(a,a.stateNode.containerInfo),p=a.pendingProps,r===null?a.child=xc(a,null,p,u):Fn(r,a,p,u),a.child;case 11:return v1(r,a,a.type,a.pendingProps,u);case 7:return Fn(r,a,a.pendingProps,u),a.child;case 8:return Fn(r,a,a.pendingProps.children,u),a.child;case 12:return Fn(r,a,a.pendingProps.children,u),a.child;case 10:return p=a.pendingProps,Ba(a,a.type,p.value),Fn(r,a,p.children,u),a.child;case 9:return _=a.type._context,p=a.pendingProps.children,Ec(a),_=Un(_),p=p(_),a.flags|=1,Fn(r,a,p,u),a.child;case 14:return b1(r,a,a.type,a.pendingProps,u);case 15:return _1(r,a,a.type,a.pendingProps,u);case 19:return I1(r,a,u);case 31:return kU(r,a,u);case 22:return S1(r,a,u,a.pendingProps);case 24:return Ec(a),p=Un(cn),r===null?(_=aS(),_===null&&(_=xt,S=rS(),_.pooledCache=S,S.refCount++,S!==null&&(_.pooledCacheLanes|=u),_=S),a.memoizedState={parent:p,cache:_},cS(a),Ba(a,cn,_)):((r.lanes&u)!==0&&(uS(r,a),Mp(a,null,null,u),Np()),_=r.memoizedState,S=a.memoizedState,_.parent!==p?(_={parent:p,cache:p},a.memoizedState=_,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=_),Ba(a,cn,p)):(p=S.cache,Ba(a,cn,p),p!==_.cache&&sS(a,[cn],u,!0))),Fn(r,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function So(r){r.flags|=4}function $S(r,a,u,p,_){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(_&335544128)===_)if(r.stateNode.complete)r.flags|=8192;else if(iR())r.flags|=8192;else throw Cc=h0,lS}else r.flags&=-16777217}function M1(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!YR(a))if(iR())r.flags|=8192;else throw Cc=h0,lS}function I0(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?uC():536870912,r.lanes|=a,Gd|=a)}function Up(r,a){if(!nt)switch(r.tailMode){case"hidden":a=r.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:p.sibling=null}}function Ut(r){var a=r.alternate!==null&&r.alternate.child===r.child,u=0,p=0;if(a)for(var _=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=p,r.childLanes=u,a}function LU(r,a,u){var p=a.pendingProps;switch(Z_(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(a),null;case 1:return Ut(a),null;case 3:return u=a.stateNode,p=null,r!==null&&(p=r.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),yo(cn),Qe(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Rd(a)?So(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,tS())),Ut(a),null;case 26:var _=a.type,S=a.memoizedState;return r===null?(So(a),S!==null?(Ut(a),M1(a,S)):(Ut(a),$S(a,_,null,p,u))):S?S!==r.memoizedState?(So(a),Ut(a),M1(a,S)):(Ut(a),a.flags&=-16777217):(r=r.memoizedProps,r!==p&&So(a),Ut(a),$S(a,_,r,p,u)),null;case 27:if(Xe(a),u=Re.current,_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&So(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return Ut(a),null}r=de.current,Rd(a)?ux(a):(r=FR(_,p,u),a.stateNode=r,So(a))}return Ut(a),null;case 5:if(Xe(a),_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&So(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return Ut(a),null}if(S=de.current,Rd(a))ux(a);else{var x=q0(Re.current);switch(S){case 1:S=x.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:S=x.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":S=x.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":S=x.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":S=x.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?S.multiple=!0:p.size&&(S.size=p.size);break;default:S=typeof p.is=="string"?x.createElement(_,{is:p.is}):x.createElement(_)}}S[Ln]=a,S[bi]=p;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)S.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=S;e:switch(Bn(S,_,p),_){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&So(a)}}return Ut(a),$S(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,u),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==p&&So(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(n(166));if(r=Re.current,Rd(a)){if(r=a.stateNode,u=a.memoizedProps,p=null,_=On,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}r[Ln]=a,r=!!(r.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||xR(r.nodeValue,u)),r||Fa(a,!0)}else r=q0(r).createTextNode(p),r[Ln]=a,a.stateNode=r}return Ut(a),null;case 31:if(u=a.memoizedState,r===null||r.memoizedState!==null){if(p=Rd(a),u!==null){if(r===null){if(!p)throw Error(n(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Ln]=a}else Sc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ut(a),r=!1}else u=tS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return a.flags&256?(qi(a),a):(qi(a),null);if((a.flags&128)!==0)throw Error(n(558))}return Ut(a),null;case 13:if(p=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(_=Rd(a),p!==null&&p.dehydrated!==null){if(r===null){if(!_)throw Error(n(318));if(_=a.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[Ln]=a}else Sc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ut(a),_=!1}else _=tS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=_),_=!0;if(!_)return a.flags&256?(qi(a),a):(qi(a),null)}return qi(a),(a.flags&128)!==0?(a.lanes=u,a):(u=p!==null,r=r!==null&&r.memoizedState!==null,u&&(p=a.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool),S=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==_&&(p.flags|=2048)),u!==r&&u&&(a.child.flags|=8192),I0(a,a.updateQueue),Ut(a),null);case 4:return Qe(),r===null&&fA(a.stateNode.containerInfo),Ut(a),null;case 10:return yo(a.type),Ut(a),null;case 19:if(J(sn),p=a.memoizedState,p===null)return Ut(a),null;if(_=(a.flags&128)!==0,S=p.rendering,S===null)if(_)Up(p,!1);else{if(jt!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=m0(r),S!==null){for(a.flags|=128,Up(p,!1),r=S.updateQueue,a.updateQueue=r,I0(a,r),a.subtreeFlags=0,r=u,u=a.child;u!==null;)rx(u,r),u=u.sibling;return se(sn,sn.current&1|2),nt&&go(a,p.treeForkCount),a.child}r=r.sibling}p.tail!==null&&Ee()>P0&&(a.flags|=128,_=!0,Up(p,!1),a.lanes=4194304)}else{if(!_)if(r=m0(S),r!==null){if(a.flags|=128,_=!0,r=r.updateQueue,a.updateQueue=r,I0(a,r),Up(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!nt)return Ut(a),null}else 2*Ee()-p.renderingStartTime>P0&&u!==536870912&&(a.flags|=128,_=!0,Up(p,!1),a.lanes=4194304);p.isBackwards?(S.sibling=a.child,a.child=S):(r=p.last,r!==null?r.sibling=S:a.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=Ee(),r.sibling=null,u=sn.current,se(sn,_?u&1|2:u&1),nt&&go(a,p.treeForkCount),r):(Ut(a),null);case 22:case 23:return qi(a),pS(),p=a.memoizedState!==null,r!==null?r.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(u&536870912)!==0&&(a.flags&128)===0&&(Ut(a),a.subtreeFlags&6&&(a.flags|=8192)):Ut(a),u=a.updateQueue,u!==null&&I0(a,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==u&&(a.flags|=2048),r!==null&&J(Tc),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),yo(cn),Ut(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function OU(r,a){switch(Z_(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return yo(cn),Qe(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Xe(a),null;case 31:if(a.memoizedState!==null){if(qi(a),a.alternate===null)throw Error(n(340));Sc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(qi(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Sc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return J(sn),null;case 4:return Qe(),null;case 10:return yo(a.type),null;case 22:case 23:return qi(a),pS(),r!==null&&J(Tc),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return yo(cn),null;case 25:return null;default:return null}}function D1(r,a){switch(Z_(a),a.tag){case 3:yo(cn),Qe();break;case 26:case 27:case 5:Xe(a);break;case 4:Qe();break;case 31:a.memoizedState!==null&&qi(a);break;case 13:qi(a);break;case 19:J(sn);break;case 10:yo(a.type);break;case 22:case 23:qi(a),pS(),r!==null&&J(Tc);break;case 24:yo(cn)}}function Fp(r,a){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var _=p.next;u=_;do{if((u.tag&r)===r){p=void 0;var S=u.create,x=u.inst;p=S(),x.destroy=p}u=u.next}while(u!==_)}}catch(D){mt(a,a.return,D)}}function $a(r,a,u){try{var p=a.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var S=_.next;p=S;do{if((p.tag&r)===r){var x=p.inst,D=x.destroy;if(D!==void 0){x.destroy=void 0,_=a;var B=u,X=D;try{X()}catch(te){mt(_,B,te)}}}p=p.next}while(p!==S)}}catch(te){mt(a,a.return,te)}}function k1(r){var a=r.updateQueue;if(a!==null){var u=r.stateNode;try{Ex(a,u)}catch(p){mt(r,r.return,p)}}}function P1(r,a,u){u.props=Ic(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(p){mt(r,a,p)}}function Bp(r,a){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var p=r.stateNode;break;case 30:p=r.stateNode;break;default:p=r.stateNode}typeof u=="function"?r.refCleanup=u(p):u.current=p}}catch(_){mt(r,a,_)}}function Cr(r,a){var u=r.ref,p=r.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(_){mt(r,a,_)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){mt(r,a,_)}else u.current=null}function L1(r){var a=r.type,u=r.memoizedProps,p=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(_){mt(r,r.return,_)}}function YS(r,a,u){try{var p=r.stateNode;sF(p,r.type,u,a),p[bi]=a}catch(_){mt(r,r.return,_)}}function O1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Qa(r.type)||r.tag===4}function XS(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||O1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Qa(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function WS(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(r),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=ho));else if(p!==4&&(p===27&&Qa(r.type)&&(u=r.stateNode,a=null),r=r.child,r!==null))for(WS(r,a,u),r=r.sibling;r!==null;)WS(r,a,u),r=r.sibling}function N0(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?u.insertBefore(r,a):u.appendChild(r);else if(p!==4&&(p===27&&Qa(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(N0(r,a,u),r=r.sibling;r!==null;)N0(r,a,u),r=r.sibling}function U1(r){var a=r.stateNode,u=r.memoizedProps;try{for(var p=r.type,_=a.attributes;_.length;)a.removeAttributeNode(_[0]);Bn(a,p,u),a[Ln]=r,a[bi]=u}catch(S){mt(r,r.return,S)}}var Ao=!1,hn=!1,KS=!1,F1=typeof WeakSet=="function"?WeakSet:Set,Tn=null;function UU(r,a){if(r=r.containerInfo,mA=j0,r=JC(r),z_(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var _=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var x=0,D=-1,B=-1,X=0,te=0,re=r,W=null;t:for(;;){for(var j;re!==u||_!==0&&re.nodeType!==3||(D=x+_),re!==S||p!==0&&re.nodeType!==3||(B=x+p),re.nodeType===3&&(x+=re.nodeValue.length),(j=re.firstChild)!==null;)W=re,re=j;for(;;){if(re===r)break t;if(W===u&&++X===_&&(D=x),W===S&&++te===p&&(B=x),(j=re.nextSibling)!==null)break;re=W,W=re.parentNode}re=j}u=D===-1||B===-1?null:{start:D,end:B}}else u=null}u=u||{start:0,end:0}}else u=null;for(yA={focusedElem:r,selectionRange:u},j0=!1,Tn=a;Tn!==null;)if(a=Tn,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,Tn=r;else for(;Tn!==null;){switch(a=Tn,S=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)_=r[u],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&S!==null){r=void 0,u=a,_=S.memoizedProps,S=S.memoizedState,p=u.stateNode;try{var be=Ic(u.type,_);r=p.getSnapshotBeforeUpdate(be,S),p.__reactInternalSnapshotBeforeUpdate=r}catch(Me){mt(u,u.return,Me)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,u=r.nodeType,u===9)_A(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":_A(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=a.sibling,r!==null){r.return=a.return,Tn=r;break}Tn=a.return}}function B1(r,a,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:To(r,u),p&4&&Fp(5,u);break;case 1:if(To(r,u),p&4)if(r=u.stateNode,a===null)try{r.componentDidMount()}catch(x){mt(u,u.return,x)}else{var _=Ic(u.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(_,a,r.__reactInternalSnapshotBeforeUpdate)}catch(x){mt(u,u.return,x)}}p&64&&k1(u),p&512&&Bp(u,u.return);break;case 3:if(To(r,u),p&64&&(r=u.updateQueue,r!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{Ex(r,a)}catch(x){mt(u,u.return,x)}}break;case 27:a===null&&p&4&&U1(u);case 26:case 5:To(r,u),a===null&&p&4&&L1(u),p&512&&Bp(u,u.return);break;case 12:To(r,u);break;case 31:To(r,u),p&4&&z1(r,u);break;case 13:To(r,u),p&4&&V1(r,u),p&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=YU.bind(null,u),hF(r,u))));break;case 22:if(p=u.memoizedState!==null||Ao,!p){a=a!==null&&a.memoizedState!==null||hn,_=Ao;var S=hn;Ao=p,(hn=a)&&!S?wo(r,u,(u.subtreeFlags&8772)!==0):To(r,u),Ao=_,hn=S}break;case 30:break;default:To(r,u)}}function H1(r){var a=r.alternate;a!==null&&(r.alternate=null,H1(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&w_(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ht=null,Si=!1;function Eo(r,a,u){for(u=u.child;u!==null;)G1(r,a,u),u=u.sibling}function G1(r,a,u){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(cp,u)}catch{}switch(u.tag){case 26:hn||Cr(u,a),Eo(r,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:hn||Cr(u,a);var p=Ht,_=Si;Qa(u.type)&&(Ht=u.stateNode,Si=!1),Eo(r,a,u),Wp(u.stateNode),Ht=p,Si=_;break;case 5:hn||Cr(u,a);case 6:if(p=Ht,_=Si,Ht=null,Eo(r,a,u),Ht=p,Si=_,Ht!==null)if(Si)try{(Ht.nodeType===9?Ht.body:Ht.nodeName==="HTML"?Ht.ownerDocument.body:Ht).removeChild(u.stateNode)}catch(S){mt(u,a,S)}else try{Ht.removeChild(u.stateNode)}catch(S){mt(u,a,S)}break;case 18:Ht!==null&&(Si?(r=Ht,kR(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Kd(r)):kR(Ht,u.stateNode));break;case 4:p=Ht,_=Si,Ht=u.stateNode.containerInfo,Si=!0,Eo(r,a,u),Ht=p,Si=_;break;case 0:case 11:case 14:case 15:$a(2,u,a),hn||$a(4,u,a),Eo(r,a,u);break;case 1:hn||(Cr(u,a),p=u.stateNode,typeof p.componentWillUnmount=="function"&&P1(u,a,p)),Eo(r,a,u);break;case 21:Eo(r,a,u);break;case 22:hn=(p=hn)||u.memoizedState!==null,Eo(r,a,u),hn=p;break;default:Eo(r,a,u)}}function z1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Kd(r)}catch(u){mt(a,a.return,u)}}}function V1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Kd(r)}catch(u){mt(a,a.return,u)}}function FU(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new F1),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new F1),a;default:throw Error(n(435,r.tag))}}function M0(r,a){var u=FU(r);a.forEach(function(p){if(!u.has(p)){u.add(p);var _=XU.bind(null,r,p);p.then(_,_)}})}function Ai(r,a){var u=a.deletions;if(u!==null)for(var p=0;p<u.length;p++){var _=u[p],S=r,x=a,D=x;e:for(;D!==null;){switch(D.tag){case 27:if(Qa(D.type)){Ht=D.stateNode,Si=!1;break e}break;case 5:Ht=D.stateNode,Si=!1;break e;case 3:case 4:Ht=D.stateNode.containerInfo,Si=!0;break e}D=D.return}if(Ht===null)throw Error(n(160));G1(S,x,_),Ht=null,Si=!1,S=_.alternate,S!==null&&(S.return=null),_.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)q1(a,r),a=a.sibling}var Zs=null;function q1(r,a){var u=r.alternate,p=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ai(a,r),Ei(r),p&4&&($a(3,r,r.return),Fp(3,r),$a(5,r,r.return));break;case 1:Ai(a,r),Ei(r),p&512&&(hn||u===null||Cr(u,u.return)),p&64&&Ao&&(r=r.updateQueue,r!==null&&(p=r.callbacks,p!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var _=Zs;if(Ai(a,r),Ei(r),p&512&&(hn||u===null||Cr(u,u.return)),p&4){var S=u!==null?u.memoizedState:null;if(p=r.memoizedState,u===null)if(p===null)if(r.stateNode===null){e:{p=r.type,u=r.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":S=_.getElementsByTagName("title")[0],(!S||S[hp]||S[Ln]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=_.createElement(p),_.head.insertBefore(S,_.querySelector("head > title"))),Bn(S,p,u),S[Ln]=r,En(S),p=S;break e;case"link":var x=qR("link","href",_).get(p+(u.href||""));if(x){for(var D=0;D<x.length;D++)if(S=x[D],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){x.splice(D,1);break t}}S=_.createElement(p),Bn(S,p,u),_.head.appendChild(S);break;case"meta":if(x=qR("meta","content",_).get(p+(u.content||""))){for(D=0;D<x.length;D++)if(S=x[D],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){x.splice(D,1);break t}}S=_.createElement(p),Bn(S,p,u),_.head.appendChild(S);break;default:throw Error(n(468,p))}S[Ln]=r,En(S),p=S}r.stateNode=p}else $R(_,r.type,r.stateNode);else r.stateNode=VR(_,p,r.memoizedProps);else S!==p?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,p===null?$R(_,r.type,r.stateNode):VR(_,p,r.memoizedProps)):p===null&&r.stateNode!==null&&YS(r,r.memoizedProps,u.memoizedProps)}break;case 27:Ai(a,r),Ei(r),p&512&&(hn||u===null||Cr(u,u.return)),u!==null&&p&4&&YS(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Ai(a,r),Ei(r),p&512&&(hn||u===null||Cr(u,u.return)),r.flags&32){_=r.stateNode;try{vd(_,"")}catch(be){mt(r,r.return,be)}}p&4&&r.stateNode!=null&&(_=r.memoizedProps,YS(r,_,u!==null?u.memoizedProps:_)),p&1024&&(KS=!0);break;case 6:if(Ai(a,r),Ei(r),p&4){if(r.stateNode===null)throw Error(n(162));p=r.memoizedProps,u=r.stateNode;try{u.nodeValue=p}catch(be){mt(r,r.return,be)}}break;case 3:if(X0=null,_=Zs,Zs=$0(a.containerInfo),Ai(a,r),Zs=_,Ei(r),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Kd(a.containerInfo)}catch(be){mt(r,r.return,be)}KS&&(KS=!1,$1(r));break;case 4:p=Zs,Zs=$0(r.stateNode.containerInfo),Ai(a,r),Ei(r),Zs=p;break;case 12:Ai(a,r),Ei(r);break;case 31:Ai(a,r),Ei(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,M0(r,p)));break;case 13:Ai(a,r),Ei(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(k0=Ee()),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,M0(r,p)));break;case 22:_=r.memoizedState!==null;var B=u!==null&&u.memoizedState!==null,X=Ao,te=hn;if(Ao=X||_,hn=te||B,Ai(a,r),hn=te,Ao=X,Ei(r),p&8192)e:for(a=r.stateNode,a._visibility=_?a._visibility&-2:a._visibility|1,_&&(u===null||B||Ao||hn||Nc(r)),u=null,a=r;;){if(a.tag===5||a.tag===26){if(u===null){B=u=a;try{if(S=B.stateNode,_)x=S.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{D=B.stateNode;var re=B.memoizedProps.style,W=re!=null&&re.hasOwnProperty("display")?re.display:null;D.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(be){mt(B,B.return,be)}}}else if(a.tag===6){if(u===null){B=a;try{B.stateNode.nodeValue=_?"":B.memoizedProps}catch(be){mt(B,B.return,be)}}}else if(a.tag===18){if(u===null){B=a;try{var j=B.stateNode;_?PR(j,!0):PR(B.stateNode,!1)}catch(be){mt(B,B.return,be)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=r.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,M0(r,u))));break;case 19:Ai(a,r),Ei(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,M0(r,p)));break;case 30:break;case 21:break;default:Ai(a,r),Ei(r)}}function Ei(r){var a=r.flags;if(a&2){try{for(var u,p=r.return;p!==null;){if(O1(p)){u=p;break}p=p.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var _=u.stateNode,S=XS(r);N0(r,S,_);break;case 5:var x=u.stateNode;u.flags&32&&(vd(x,""),u.flags&=-33);var D=XS(r);N0(r,D,x);break;case 3:case 4:var B=u.stateNode.containerInfo,X=XS(r);WS(r,X,B);break;default:throw Error(n(161))}}catch(te){mt(r,r.return,te)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function $1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;$1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function To(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)B1(r,a.alternate,a),a=a.sibling}function Nc(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:$a(4,a,a.return),Nc(a);break;case 1:Cr(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&P1(a,a.return,u),Nc(a);break;case 27:Wp(a.stateNode);case 26:case 5:Cr(a,a.return),Nc(a);break;case 22:a.memoizedState===null&&Nc(a);break;case 30:Nc(a);break;default:Nc(a)}r=r.sibling}}function wo(r,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,_=r,S=a,x=S.flags;switch(S.tag){case 0:case 11:case 15:wo(_,S,u),Fp(4,S);break;case 1:if(wo(_,S,u),p=S,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(X){mt(p,p.return,X)}if(p=S,_=p.updateQueue,_!==null){var D=p.stateNode;try{var B=_.shared.hiddenCallbacks;if(B!==null)for(_.shared.hiddenCallbacks=null,_=0;_<B.length;_++)Ax(B[_],D)}catch(X){mt(p,p.return,X)}}u&&x&64&&k1(S),Bp(S,S.return);break;case 27:U1(S);case 26:case 5:wo(_,S,u),u&&p===null&&x&4&&L1(S),Bp(S,S.return);break;case 12:wo(_,S,u);break;case 31:wo(_,S,u),u&&x&4&&z1(_,S);break;case 13:wo(_,S,u),u&&x&4&&V1(_,S);break;case 22:S.memoizedState===null&&wo(_,S,u),Bp(S,S.return);break;case 30:break;default:wo(_,S,u)}a=a.sibling}}function JS(r,a){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&wp(u))}function jS(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&wp(r))}function er(r,a,u,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Y1(r,a,u,p),a=a.sibling}function Y1(r,a,u,p){var _=a.flags;switch(a.tag){case 0:case 11:case 15:er(r,a,u,p),_&2048&&Fp(9,a);break;case 1:er(r,a,u,p);break;case 3:er(r,a,u,p),_&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&wp(r)));break;case 12:if(_&2048){er(r,a,u,p),r=a.stateNode;try{var S=a.memoizedProps,x=S.id,D=S.onPostCommit;typeof D=="function"&&D(x,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(B){mt(a,a.return,B)}}else er(r,a,u,p);break;case 31:er(r,a,u,p);break;case 13:er(r,a,u,p);break;case 23:break;case 22:S=a.stateNode,x=a.alternate,a.memoizedState!==null?S._visibility&2?er(r,a,u,p):Hp(r,a):S._visibility&2?er(r,a,u,p):(S._visibility|=2,Fd(r,a,u,p,(a.subtreeFlags&10256)!==0||!1)),_&2048&&JS(x,a);break;case 24:er(r,a,u,p),_&2048&&jS(a.alternate,a);break;default:er(r,a,u,p)}}function Fd(r,a,u,p,_){for(_=_&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var S=r,x=a,D=u,B=p,X=x.flags;switch(x.tag){case 0:case 11:case 15:Fd(S,x,D,B,_),Fp(8,x);break;case 23:break;case 22:var te=x.stateNode;x.memoizedState!==null?te._visibility&2?Fd(S,x,D,B,_):Hp(S,x):(te._visibility|=2,Fd(S,x,D,B,_)),_&&X&2048&&JS(x.alternate,x);break;case 24:Fd(S,x,D,B,_),_&&X&2048&&jS(x.alternate,x);break;default:Fd(S,x,D,B,_)}a=a.sibling}}function Hp(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=r,p=a,_=p.flags;switch(p.tag){case 22:Hp(u,p),_&2048&&JS(p.alternate,p);break;case 24:Hp(u,p),_&2048&&jS(p.alternate,p);break;default:Hp(u,p)}a=a.sibling}}var Gp=8192;function Bd(r,a,u){if(r.subtreeFlags&Gp)for(r=r.child;r!==null;)X1(r,a,u),r=r.sibling}function X1(r,a,u){switch(r.tag){case 26:Bd(r,a,u),r.flags&Gp&&r.memoizedState!==null&&TF(u,Zs,r.memoizedState,r.memoizedProps);break;case 5:Bd(r,a,u);break;case 3:case 4:var p=Zs;Zs=$0(r.stateNode.containerInfo),Bd(r,a,u),Zs=p;break;case 22:r.memoizedState===null&&(p=r.alternate,p!==null&&p.memoizedState!==null?(p=Gp,Gp=16777216,Bd(r,a,u),Gp=p):Bd(r,a,u));break;default:Bd(r,a,u)}}function W1(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function zp(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Tn=p,J1(p,r)}W1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)K1(r),r=r.sibling}function K1(r){switch(r.tag){case 0:case 11:case 15:zp(r),r.flags&2048&&$a(9,r,r.return);break;case 3:zp(r);break;case 12:zp(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,D0(r)):zp(r);break;default:zp(r)}}function D0(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Tn=p,J1(p,r)}W1(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:$a(8,a,a.return),D0(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,D0(a));break;default:D0(a)}r=r.sibling}}function J1(r,a){for(;Tn!==null;){var u=Tn;switch(u.tag){case 0:case 11:case 15:$a(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:wp(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Tn=p;else e:for(u=r;Tn!==null;){p=Tn;var _=p.sibling,S=p.return;if(H1(p),p===u){Tn=null;break e}if(_!==null){_.return=S,Tn=_;break e}Tn=S}}}var BU={getCacheForType:function(r){var a=Un(cn),u=a.data.get(r);return u===void 0&&(u=r(),a.data.set(r,u)),u},cacheSignal:function(){return Un(cn).controller.signal}},HU=typeof WeakMap=="function"?WeakMap:Map,ut=0,xt=null,Je=null,Ze=0,gt=0,$i=null,Ya=!1,Hd=!1,QS=!1,Co=0,jt=0,Xa=0,Mc=0,ZS=0,Yi=0,Gd=0,Vp=null,Ti=null,eA=!1,k0=0,j1=0,P0=1/0,L0=null,Wa=null,mn=0,Ka=null,zd=null,xo=0,tA=0,nA=null,Q1=null,qp=0,iA=null;function Xi(){return(ut&2)!==0&&Ze!==0?Ze&-Ze:G.T!==null?cA():pC()}function Z1(){if(Yi===0)if((Ze&536870912)===0||nt){var r=Vy;Vy<<=1,(Vy&3932160)===0&&(Vy=262144),Yi=r}else Yi=536870912;return r=Vi.current,r!==null&&(r.flags|=32),Yi}function wi(r,a,u){(r===xt&&(gt===2||gt===9)||r.cancelPendingCommit!==null)&&(Vd(r,0),Ja(r,Ze,Yi,!1)),dp(r,u),((ut&2)===0||r!==xt)&&(r===xt&&((ut&2)===0&&(Mc|=u),jt===4&&Ja(r,Ze,Yi,!1)),xr(r))}function eR(r,a,u){if((ut&6)!==0)throw Error(n(327));var p=!u&&(a&127)===0&&(a&r.expiredLanes)===0||up(r,a),_=p?VU(r,a):rA(r,a,!0),S=p;do{if(_===0){Hd&&!p&&Ja(r,a,0,!1);break}else{if(u=r.current.alternate,S&&!GU(u)){_=rA(r,a,!1),S=!1;continue}if(_===2){if(S=a,r.errorRecoveryDisabledLanes&S)var x=0;else x=r.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var D=r;_=Vp;var B=D.current.memoizedState.isDehydrated;if(B&&(Vd(D,x).flags|=256),x=rA(D,x,!1),x!==2){if(QS&&!B){D.errorRecoveryDisabledLanes|=S,Mc|=S,_=4;break e}S=Ti,Ti=_,S!==null&&(Ti===null?Ti=S:Ti.push.apply(Ti,S))}_=x}if(S=!1,_!==2)continue}}if(_===1){Vd(r,0),Ja(r,a,0,!0);break}e:{switch(p=r,S=_,S){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Ja(p,a,Yi,!Ya);break e;case 2:Ti=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(_=k0+300-Ee(),10<_)){if(Ja(p,a,Yi,!Ya),$y(p,0,!0)!==0)break e;xo=a,p.timeoutHandle=MR(tR.bind(null,p,u,Ti,L0,eA,a,Yi,Mc,Gd,Ya,S,"Throttled",-0,0),_);break e}tR(p,u,Ti,L0,eA,a,Yi,Mc,Gd,Ya,S,null,-0,0)}}break}while(!0);xr(r)}function tR(r,a,u,p,_,S,x,D,B,X,te,re,W,j){if(r.timeoutHandle=-1,re=a.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ho},X1(a,S,re);var be=(S&62914560)===S?k0-Ee():(S&4194048)===S?j1-Ee():0;if(be=wF(re,be),be!==null){xo=S,r.cancelPendingCommit=be(cR.bind(null,r,a,S,u,p,_,x,D,B,te,re,null,W,j)),Ja(r,S,x,!X);return}}cR(r,a,S,u,p,_,x,D,B)}function GU(r){for(var a=r;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var _=u[p],S=_.getSnapshot;_=_.value;try{if(!Gi(S(),_))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ja(r,a,u,p){a&=~ZS,a&=~Mc,r.suspendedLanes|=a,r.pingedLanes&=~a,p&&(r.warmLanes|=a),p=r.expirationTimes;for(var _=a;0<_;){var S=31-Hi(_),x=1<<S;p[S]=-1,_&=~x}u!==0&&dC(r,u,a)}function O0(){return(ut&6)===0?($p(0),!1):!0}function sA(){if(Je!==null){if(gt===0)var r=Je.return;else r=Je,mo=Ac=null,_S(r),kd=null,xp=0,r=Je;for(;r!==null;)D1(r.alternate,r),r=r.return;Je=null}}function Vd(r,a){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,aF(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),xo=0,sA(),xt=r,Je=u=po(r.current,null),Ze=a,gt=0,$i=null,Ya=!1,Hd=up(r,a),QS=!1,Gd=Yi=ZS=Mc=Xa=jt=0,Ti=Vp=null,eA=!1,(a&8)!==0&&(a|=a&32);var p=r.entangledLanes;if(p!==0)for(r=r.entanglements,p&=a;0<p;){var _=31-Hi(p),S=1<<_;a|=r[_],p&=~S}return Co=a,i0(),u}function nR(r,a){He=null,G.H=Lp,a===Dd||a===d0?(a=vx(),gt=3):a===lS?(a=vx(),gt=4):gt=a===OS?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,$i=a,Je===null&&(jt=1,w0(r,Cs(a,r.current)))}function iR(){var r=Vi.current;return r===null?!0:(Ze&4194048)===Ze?Ns===null:(Ze&62914560)===Ze||(Ze&536870912)!==0?r===Ns:!1}function sR(){var r=G.H;return G.H=Lp,r===null?Lp:r}function rR(){var r=G.A;return G.A=BU,r}function U0(){jt=4,Ya||(Ze&4194048)!==Ze&&Vi.current!==null||(Hd=!0),(Xa&134217727)===0&&(Mc&134217727)===0||xt===null||Ja(xt,Ze,Yi,!1)}function rA(r,a,u){var p=ut;ut|=2;var _=sR(),S=rR();(xt!==r||Ze!==a)&&(L0=null,Vd(r,a)),a=!1;var x=jt;e:do try{if(gt!==0&&Je!==null){var D=Je,B=$i;switch(gt){case 8:sA(),x=6;break e;case 3:case 2:case 9:case 6:Vi.current===null&&(a=!0);var X=gt;if(gt=0,$i=null,qd(r,D,B,X),u&&Hd){x=0;break e}break;default:X=gt,gt=0,$i=null,qd(r,D,B,X)}}zU(),x=jt;break}catch(te){nR(r,te)}while(!0);return a&&r.shellSuspendCounter++,mo=Ac=null,ut=p,G.H=_,G.A=S,Je===null&&(xt=null,Ze=0,i0()),x}function zU(){for(;Je!==null;)oR(Je)}function VU(r,a){var u=ut;ut|=2;var p=sR(),_=rR();xt!==r||Ze!==a?(L0=null,P0=Ee()+500,Vd(r,a)):Hd=up(r,a);e:do try{if(gt!==0&&Je!==null){a=Je;var S=$i;t:switch(gt){case 1:gt=0,$i=null,qd(r,a,S,1);break;case 2:case 9:if(mx(S)){gt=0,$i=null,aR(a);break}a=function(){gt!==2&&gt!==9||xt!==r||(gt=7),xr(r)},S.then(a,a);break e;case 3:gt=7;break e;case 4:gt=5;break e;case 7:mx(S)?(gt=0,$i=null,aR(a)):(gt=0,$i=null,qd(r,a,S,7));break;case 5:var x=null;switch(Je.tag){case 26:x=Je.memoizedState;case 5:case 27:var D=Je;if(x?YR(x):D.stateNode.complete){gt=0,$i=null;var B=D.sibling;if(B!==null)Je=B;else{var X=D.return;X!==null?(Je=X,F0(X)):Je=null}break t}}gt=0,$i=null,qd(r,a,S,5);break;case 6:gt=0,$i=null,qd(r,a,S,6);break;case 8:sA(),jt=6;break e;default:throw Error(n(462))}}qU();break}catch(te){nR(r,te)}while(!0);return mo=Ac=null,G.H=p,G.A=_,ut=u,Je!==null?0:(xt=null,Ze=0,i0(),jt)}function qU(){for(;Je!==null&&!ne();)oR(Je)}function oR(r){var a=N1(r.alternate,r,Co);r.memoizedProps=r.pendingProps,a===null?F0(r):Je=a}function aR(r){var a=r,u=a.alternate;switch(a.tag){case 15:case 0:a=T1(u,a,a.pendingProps,a.type,void 0,Ze);break;case 11:a=T1(u,a,a.pendingProps,a.type.render,a.ref,Ze);break;case 5:_S(a);default:D1(u,a),a=Je=rx(a,Co),a=N1(u,a,Co)}r.memoizedProps=r.pendingProps,a===null?F0(r):Je=a}function qd(r,a,u,p){mo=Ac=null,_S(a),kd=null,xp=0;var _=a.return;try{if(DU(r,_,a,u,Ze)){jt=1,w0(r,Cs(u,r.current)),Je=null;return}}catch(S){if(_!==null)throw Je=_,S;jt=1,w0(r,Cs(u,r.current)),Je=null;return}a.flags&32768?(nt||p===1?r=!0:Hd||(Ze&536870912)!==0?r=!1:(Ya=r=!0,(p===2||p===9||p===3||p===6)&&(p=Vi.current,p!==null&&p.tag===13&&(p.flags|=16384))),lR(a,r)):F0(a)}function F0(r){var a=r;do{if((a.flags&32768)!==0){lR(a,Ya);return}r=a.return;var u=LU(a.alternate,a,Co);if(u!==null){Je=u;return}if(a=a.sibling,a!==null){Je=a;return}Je=a=r}while(a!==null);jt===0&&(jt=5)}function lR(r,a){do{var u=OU(r.alternate,r);if(u!==null){u.flags&=32767,Je=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(r=r.sibling,r!==null)){Je=r;return}Je=r=u}while(r!==null);jt=6,Je=null}function cR(r,a,u,p,_,S,x,D,B){r.cancelPendingCommit=null;do B0();while(mn!==0);if((ut&6)!==0)throw Error(n(327));if(a!==null){if(a===r.current)throw Error(n(177));if(S=a.lanes|a.childLanes,S|=X_,EO(r,u,S,x,D,B),r===xt&&(Je=xt=null,Ze=0),zd=a,Ka=r,xo=u,tA=S,nA=_,Q1=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,WU(Fi,function(){return pR(),null})):(r.callbackNode=null,r.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=G.T,G.T=null,_=$.p,$.p=2,x=ut,ut|=4;try{UU(r,a,u)}finally{ut=x,$.p=_,G.T=p}}mn=1,uR(),dR(),hR()}}function uR(){if(mn===1){mn=0;var r=Ka,a=zd,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=ut;ut|=4;try{q1(a,r);var S=yA,x=JC(r.containerInfo),D=S.focusedElem,B=S.selectionRange;if(x!==D&&D&&D.ownerDocument&&KC(D.ownerDocument.documentElement,D)){if(B!==null&&z_(D)){var X=B.start,te=B.end;if(te===void 0&&(te=X),"selectionStart"in D)D.selectionStart=X,D.selectionEnd=Math.min(te,D.value.length);else{var re=D.ownerDocument||document,W=re&&re.defaultView||window;if(W.getSelection){var j=W.getSelection(),be=D.textContent.length,Me=Math.min(B.start,be),St=B.end===void 0?Me:Math.min(B.end,be);!j.extend&&Me>St&&(x=St,St=Me,Me=x);var V=WC(D,Me),z=WC(D,St);if(V&&z&&(j.rangeCount!==1||j.anchorNode!==V.node||j.anchorOffset!==V.offset||j.focusNode!==z.node||j.focusOffset!==z.offset)){var Y=re.createRange();Y.setStart(V.node,V.offset),j.removeAllRanges(),Me>St?(j.addRange(Y),j.extend(z.node,z.offset)):(Y.setEnd(z.node,z.offset),j.addRange(Y))}}}}for(re=[],j=D;j=j.parentNode;)j.nodeType===1&&re.push({element:j,left:j.scrollLeft,top:j.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<re.length;D++){var ie=re[D];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}j0=!!mA,yA=mA=null}finally{ut=_,$.p=p,G.T=u}}r.current=a,mn=2}}function dR(){if(mn===2){mn=0;var r=Ka,a=zd,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=ut;ut|=4;try{B1(r,a.alternate,a)}finally{ut=_,$.p=p,G.T=u}}mn=3}}function hR(){if(mn===4||mn===3){mn=0,xe();var r=Ka,a=zd,u=xo,p=Q1;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?mn=5:(mn=0,zd=Ka=null,fR(r,r.pendingLanes));var _=r.pendingLanes;if(_===0&&(Wa=null),E_(u),a=a.stateNode,Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(cp,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=G.T,_=$.p,$.p=2,G.T=null;try{for(var S=r.onRecoverableError,x=0;x<p.length;x++){var D=p[x];S(D.value,{componentStack:D.stack})}}finally{G.T=a,$.p=_}}(xo&3)!==0&&B0(),xr(r),_=r.pendingLanes,(u&261930)!==0&&(_&42)!==0?r===iA?qp++:(qp=0,iA=r):qp=0,$p(0)}}function fR(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,wp(a)))}function B0(){return uR(),dR(),hR(),pR()}function pR(){if(mn!==5)return!1;var r=Ka,a=tA;tA=0;var u=E_(xo),p=G.T,_=$.p;try{$.p=32>u?32:u,G.T=null,u=nA,nA=null;var S=Ka,x=xo;if(mn=0,zd=Ka=null,xo=0,(ut&6)!==0)throw Error(n(331));var D=ut;if(ut|=4,K1(S.current),Y1(S,S.current,x,u),ut=D,$p(0,!1),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(cp,S)}catch{}return!0}finally{$.p=_,G.T=p,fR(r,a)}}function gR(r,a,u){a=Cs(u,a),a=LS(r.stateNode,a,2),r=za(r,a,2),r!==null&&(dp(r,2),xr(r))}function mt(r,a,u){if(r.tag===3)gR(r,r,u);else for(;a!==null;){if(a.tag===3){gR(a,r,u);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Wa===null||!Wa.has(p))){r=Cs(u,r),u=m1(2),p=za(a,u,2),p!==null&&(y1(u,p,a,r),dp(p,2),xr(p));break}}a=a.return}}function oA(r,a,u){var p=r.pingCache;if(p===null){p=r.pingCache=new HU;var _=new Set;p.set(a,_)}else _=p.get(a),_===void 0&&(_=new Set,p.set(a,_));_.has(u)||(QS=!0,_.add(u),r=$U.bind(null,r,a,u),a.then(r,r))}function $U(r,a,u){var p=r.pingCache;p!==null&&p.delete(a),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,xt===r&&(Ze&u)===u&&(jt===4||jt===3&&(Ze&62914560)===Ze&&300>Ee()-k0?(ut&2)===0&&Vd(r,0):ZS|=u,Gd===Ze&&(Gd=0)),xr(r)}function mR(r,a){a===0&&(a=uC()),r=bc(r,a),r!==null&&(dp(r,a),xr(r))}function YU(r){var a=r.memoizedState,u=0;a!==null&&(u=a.retryLane),mR(r,u)}function XU(r,a){var u=0;switch(r.tag){case 31:case 13:var p=r.stateNode,_=r.memoizedState;_!==null&&(u=_.retryLane);break;case 19:p=r.stateNode;break;case 22:p=r.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(a),mR(r,u)}function WU(r,a){return Ss(r,a)}var H0=null,$d=null,aA=!1,G0=!1,lA=!1,ja=0;function xr(r){r!==$d&&r.next===null&&($d===null?H0=$d=r:$d=$d.next=r),G0=!0,aA||(aA=!0,JU())}function $p(r,a){if(!lA&&G0){lA=!0;do for(var u=!1,p=H0;p!==null;){if(r!==0){var _=p.pendingLanes;if(_===0)var S=0;else{var x=p.suspendedLanes,D=p.pingedLanes;S=(1<<31-Hi(42|r)+1)-1,S&=_&~(x&~D),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,_R(p,S))}else S=Ze,S=$y(p,p===xt?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(S&3)===0||up(p,S)||(u=!0,_R(p,S));p=p.next}while(u);lA=!1}}function KU(){yR()}function yR(){G0=aA=!1;var r=0;ja!==0&&oF()&&(r=ja);for(var a=Ee(),u=null,p=H0;p!==null;){var _=p.next,S=vR(p,a);S===0?(p.next=null,u===null?H0=_:u.next=_,_===null&&($d=u)):(u=p,(r!==0||(S&3)!==0)&&(G0=!0)),p=_}mn!==0&&mn!==5||$p(r),ja!==0&&(ja=0)}function vR(r,a){for(var u=r.suspendedLanes,p=r.pingedLanes,_=r.expirationTimes,S=r.pendingLanes&-62914561;0<S;){var x=31-Hi(S),D=1<<x,B=_[x];B===-1?((D&u)===0||(D&p)!==0)&&(_[x]=AO(D,a)):B<=a&&(r.expiredLanes|=D),S&=~D}if(a=xt,u=Ze,u=$y(r,r===a?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p=r.callbackNode,u===0||r===a&&(gt===2||gt===9)||r.cancelPendingCommit!==null)return p!==null&&p!==null&&Te(p),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||up(r,u)){if(a=u&-u,a===r.callbackPriority)return a;switch(p!==null&&Te(p),E_(u)){case 2:case 8:u=Ui;break;case 32:u=Fi;break;case 268435456:u=js;break;default:u=Fi}return p=bR.bind(null,r),u=Ss(u,p),r.callbackPriority=a,r.callbackNode=u,a}return p!==null&&p!==null&&Te(p),r.callbackPriority=2,r.callbackNode=null,2}function bR(r,a){if(mn!==0&&mn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(B0()&&r.callbackNode!==u)return null;var p=Ze;return p=$y(r,r===xt?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p===0?null:(eR(r,p,a),vR(r,Ee()),r.callbackNode!=null&&r.callbackNode===u?bR.bind(null,r):null)}function _R(r,a){if(B0())return null;eR(r,a,!0)}function JU(){lF(function(){(ut&6)!==0?Ss(As,KU):yR()})}function cA(){if(ja===0){var r=Nd;r===0&&(r=zy,zy<<=1,(zy&261888)===0&&(zy=256)),ja=r}return ja}function SR(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ky(""+r)}function AR(r,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,r.id&&u.setAttribute("form",r.id),a.parentNode.insertBefore(u,a),r=new FormData(r),u.parentNode.removeChild(u),r}function jU(r,a,u,p,_){if(a==="submit"&&u&&u.stateNode===_){var S=SR((_[bi]||null).action),x=p.submitter;x&&(a=(a=x[bi]||null)?SR(a.formAction):x.getAttribute("formAction"),a!==null&&(S=a,x=null));var D=new Zy("action","action",null,p,_);r.push({event:D,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ja!==0){var B=x?AR(_,x):new FormData(_);IS(u,{pending:!0,data:B,method:_.method,action:S},null,B)}}else typeof S=="function"&&(D.preventDefault(),B=x?AR(_,x):new FormData(_),IS(u,{pending:!0,data:B,method:_.method,action:S},S,B))},currentTarget:_}]})}}for(var uA=0;uA<Y_.length;uA++){var dA=Y_[uA],QU=dA.toLowerCase(),ZU=dA[0].toUpperCase()+dA.slice(1);Qs(QU,"on"+ZU)}Qs(ZC,"onAnimationEnd"),Qs(ex,"onAnimationIteration"),Qs(tx,"onAnimationStart"),Qs("dblclick","onDoubleClick"),Qs("focusin","onFocus"),Qs("focusout","onBlur"),Qs(gU,"onTransitionRun"),Qs(mU,"onTransitionStart"),Qs(yU,"onTransitionCancel"),Qs(nx,"onTransitionEnd"),md("onMouseEnter",["mouseout","mouseover"]),md("onMouseLeave",["mouseout","mouseover"]),md("onPointerEnter",["pointerout","pointerover"]),md("onPointerLeave",["pointerout","pointerover"]),gc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gc("onBeforeInput",["compositionend","keypress","textInput","paste"]),gc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yp));function ER(r,a){a=(a&4)!==0;for(var u=0;u<r.length;u++){var p=r[u],_=p.event;p=p.listeners;e:{var S=void 0;if(a)for(var x=p.length-1;0<=x;x--){var D=p[x],B=D.instance,X=D.currentTarget;if(D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=X;try{S(_)}catch(te){n0(te)}_.currentTarget=null,S=B}else for(x=0;x<p.length;x++){if(D=p[x],B=D.instance,X=D.currentTarget,D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=X;try{S(_)}catch(te){n0(te)}_.currentTarget=null,S=B}}}}function je(r,a){var u=a[T_];u===void 0&&(u=a[T_]=new Set);var p=r+"__bubble";u.has(p)||(TR(a,r,2,!1),u.add(p))}function hA(r,a,u){var p=0;a&&(p|=4),TR(u,r,p,a)}var z0="_reactListening"+Math.random().toString(36).slice(2);function fA(r){if(!r[z0]){r[z0]=!0,yC.forEach(function(u){u!=="selectionchange"&&(eF.has(u)||hA(u,!1,r),hA(u,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[z0]||(a[z0]=!0,hA("selectionchange",!1,a))}}function TR(r,a,u,p){switch(ZR(a)){case 2:var _=RF;break;case 8:_=IF;break;default:_=RA}u=_.bind(null,a,u,r),_=void 0,!k_||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),p?_!==void 0?r.addEventListener(a,u,{capture:!0,passive:_}):r.addEventListener(a,u,!0):_!==void 0?r.addEventListener(a,u,{passive:_}):r.addEventListener(a,u,!1)}function pA(r,a,u,p,_){var S=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var x=p.tag;if(x===3||x===4){var D=p.stateNode.containerInfo;if(D===_)break;if(x===4)for(x=p.return;x!==null;){var B=x.tag;if((B===3||B===4)&&x.stateNode.containerInfo===_)return;x=x.return}for(;D!==null;){if(x=fd(D),x===null)return;if(B=x.tag,B===5||B===6||B===26||B===27){p=S=x;continue e}D=D.parentNode}}p=p.return}IC(function(){var X=S,te=M_(u),re=[];e:{var W=ix.get(r);if(W!==void 0){var j=Zy,be=r;switch(r){case"keypress":if(jy(u)===0)break e;case"keydown":case"keyup":j=XO;break;case"focusin":be="focus",j=U_;break;case"focusout":be="blur",j=U_;break;case"beforeblur":case"afterblur":j=U_;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=DC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=LO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=JO;break;case ZC:case ex:case tx:j=FO;break;case nx:j=QO;break;case"scroll":case"scrollend":j=kO;break;case"wheel":j=eU;break;case"copy":case"cut":case"paste":j=HO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=PC;break;case"toggle":case"beforetoggle":j=nU}var Me=(a&4)!==0,St=!Me&&(r==="scroll"||r==="scrollend"),V=Me?W!==null?W+"Capture":null:W;Me=[];for(var z=X,Y;z!==null;){var ie=z;if(Y=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Y===null||V===null||(ie=pp(z,V),ie!=null&&Me.push(Xp(z,ie,Y))),St)break;z=z.return}0<Me.length&&(W=new j(W,be,null,u,te),re.push({event:W,listeners:Me}))}}if((a&7)===0){e:{if(W=r==="mouseover"||r==="pointerover",j=r==="mouseout"||r==="pointerout",W&&u!==N_&&(be=u.relatedTarget||u.fromElement)&&(fd(be)||be[hd]))break e;if((j||W)&&(W=te.window===te?te:(W=te.ownerDocument)?W.defaultView||W.parentWindow:window,j?(be=u.relatedTarget||u.toElement,j=X,be=be?fd(be):null,be!==null&&(St=o(be),Me=be.tag,be!==St||Me!==5&&Me!==27&&Me!==6)&&(be=null)):(j=null,be=X),j!==be)){if(Me=DC,ie="onMouseLeave",V="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Me=PC,ie="onPointerLeave",V="onPointerEnter",z="pointer"),St=j==null?W:fp(j),Y=be==null?W:fp(be),W=new Me(ie,z+"leave",j,u,te),W.target=St,W.relatedTarget=Y,ie=null,fd(te)===X&&(Me=new Me(V,z+"enter",be,u,te),Me.target=Y,Me.relatedTarget=St,ie=Me),St=ie,j&&be)t:{for(Me=tF,V=j,z=be,Y=0,ie=V;ie;ie=Me(ie))Y++;ie=0;for(var Ne=z;Ne;Ne=Me(Ne))ie++;for(;0<Y-ie;)V=Me(V),Y--;for(;0<ie-Y;)z=Me(z),ie--;for(;Y--;){if(V===z||z!==null&&V===z.alternate){Me=V;break t}V=Me(V),z=Me(z)}Me=null}else Me=null;j!==null&&wR(re,W,j,Me,!1),be!==null&&St!==null&&wR(re,St,be,Me,!0)}}e:{if(W=X?fp(X):window,j=W.nodeName&&W.nodeName.toLowerCase(),j==="select"||j==="input"&&W.type==="file")var ot=zC;else if(HC(W))if(VC)ot=hU;else{ot=uU;var we=cU}else j=W.nodeName,!j||j.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?X&&I_(X.elementType)&&(ot=zC):ot=dU;if(ot&&(ot=ot(r,X))){GC(re,ot,u,te);break e}we&&we(r,W,X),r==="focusout"&&X&&W.type==="number"&&X.memoizedProps.value!=null&&R_(W,"number",W.value)}switch(we=X?fp(X):window,r){case"focusin":(HC(we)||we.contentEditable==="true")&&(Ad=we,V_=X,Ap=null);break;case"focusout":Ap=V_=Ad=null;break;case"mousedown":q_=!0;break;case"contextmenu":case"mouseup":case"dragend":q_=!1,jC(re,u,te);break;case"selectionchange":if(pU)break;case"keydown":case"keyup":jC(re,u,te)}var ze;if(B_)e:{switch(r){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Sd?FC(r,u)&&(et="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(et="onCompositionStart");et&&(LC&&u.locale!=="ko"&&(Sd||et!=="onCompositionStart"?et==="onCompositionEnd"&&Sd&&(ze=NC()):(La=te,P_="value"in La?La.value:La.textContent,Sd=!0)),we=V0(X,et),0<we.length&&(et=new kC(et,r,null,u,te),re.push({event:et,listeners:we}),ze?et.data=ze:(ze=BC(u),ze!==null&&(et.data=ze)))),(ze=sU?rU(r,u):oU(r,u))&&(et=V0(X,"onBeforeInput"),0<et.length&&(we=new kC("onBeforeInput","beforeinput",null,u,te),re.push({event:we,listeners:et}),we.data=ze)),jU(re,r,X,u,te)}ER(re,a)})}function Xp(r,a,u){return{instance:r,listener:a,currentTarget:u}}function V0(r,a){for(var u=a+"Capture",p=[];r!==null;){var _=r,S=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||S===null||(_=pp(r,u),_!=null&&p.unshift(Xp(r,_,S)),_=pp(r,a),_!=null&&p.push(Xp(r,_,S))),r.tag===3)return p;r=r.return}return[]}function tF(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function wR(r,a,u,p,_){for(var S=a._reactName,x=[];u!==null&&u!==p;){var D=u,B=D.alternate,X=D.stateNode;if(D=D.tag,B!==null&&B===p)break;D!==5&&D!==26&&D!==27||X===null||(B=X,_?(X=pp(u,S),X!=null&&x.unshift(Xp(u,X,B))):_||(X=pp(u,S),X!=null&&x.push(Xp(u,X,B)))),u=u.return}x.length!==0&&r.push({event:a,listeners:x})}var nF=/\r\n?/g,iF=/\u0000|\uFFFD/g;function CR(r){return(typeof r=="string"?r:""+r).replace(nF,`
`).replace(iF,"")}function xR(r,a){return a=CR(a),CR(r)===a}function _t(r,a,u,p,_,S){switch(u){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||vd(r,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&vd(r,""+p);break;case"className":Xy(r,"class",p);break;case"tabIndex":Xy(r,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Xy(r,u,p);break;case"style":xC(r,p,S);break;case"data":if(a!=="object"){Xy(r,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||u!=="href")){r.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=Ky(""+p),r.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(a!=="input"&&_t(r,a,"name",_.name,_,null),_t(r,a,"formEncType",_.formEncType,_,null),_t(r,a,"formMethod",_.formMethod,_,null),_t(r,a,"formTarget",_.formTarget,_,null)):(_t(r,a,"encType",_.encType,_,null),_t(r,a,"method",_.method,_,null),_t(r,a,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=Ky(""+p),r.setAttribute(u,p);break;case"onClick":p!=null&&(r.onclick=ho);break;case"onScroll":p!=null&&je("scroll",r);break;case"onScrollEnd":p!=null&&je("scrollend",r);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":r.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){r.removeAttribute("xlink:href");break}u=Ky(""+p),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""+p):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":p===!0?r.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,p):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?r.setAttribute(u,p):r.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?r.removeAttribute(u):r.setAttribute(u,p);break;case"popover":je("beforetoggle",r),je("toggle",r),Yy(r,"popover",p);break;case"xlinkActuate":uo(r,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":uo(r,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":uo(r,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":uo(r,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":uo(r,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":uo(r,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":uo(r,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":uo(r,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":uo(r,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Yy(r,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=MO.get(u)||u,Yy(r,u,p))}}function gA(r,a,u,p,_,S){switch(u){case"style":xC(r,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof p=="string"?vd(r,p):(typeof p=="number"||typeof p=="bigint")&&vd(r,""+p);break;case"onScroll":p!=null&&je("scroll",r);break;case"onScrollEnd":p!=null&&je("scrollend",r);break;case"onClick":p!=null&&(r.onclick=ho);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vC.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),a=u.slice(2,_?u.length-7:void 0),S=r[bi]||null,S=S!=null?S[u]:null,typeof S=="function"&&r.removeEventListener(a,S,_),typeof p=="function")){typeof S!="function"&&S!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(a,p,_);break e}u in r?r[u]=p:p===!0?r.setAttribute(u,""):Yy(r,u,p)}}}function Bn(r,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",r),je("load",r);var p=!1,_=!1,S;for(S in u)if(u.hasOwnProperty(S)){var x=u[S];if(x!=null)switch(S){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:_t(r,a,S,x,u,null)}}_&&_t(r,a,"srcSet",u.srcSet,u,null),p&&_t(r,a,"src",u.src,u,null);return;case"input":je("invalid",r);var D=S=x=_=null,B=null,X=null;for(p in u)if(u.hasOwnProperty(p)){var te=u[p];if(te!=null)switch(p){case"name":_=te;break;case"type":x=te;break;case"checked":B=te;break;case"defaultChecked":X=te;break;case"value":S=te;break;case"defaultValue":D=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:_t(r,a,p,te,u,null)}}EC(r,S,D,B,X,x,_,!1);return;case"select":je("invalid",r),p=x=S=null;for(_ in u)if(u.hasOwnProperty(_)&&(D=u[_],D!=null))switch(_){case"value":S=D;break;case"defaultValue":x=D;break;case"multiple":p=D;default:_t(r,a,_,D,u,null)}a=S,u=x,r.multiple=!!p,a!=null?yd(r,!!p,a,!1):u!=null&&yd(r,!!p,u,!0);return;case"textarea":je("invalid",r),S=_=p=null;for(x in u)if(u.hasOwnProperty(x)&&(D=u[x],D!=null))switch(x){case"value":p=D;break;case"defaultValue":_=D;break;case"children":S=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:_t(r,a,x,D,u,null)}wC(r,p,_,S);return;case"option":for(B in u)if(u.hasOwnProperty(B)&&(p=u[B],p!=null))switch(B){case"selected":r.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:_t(r,a,B,p,u,null)}return;case"dialog":je("beforetoggle",r),je("toggle",r),je("cancel",r),je("close",r);break;case"iframe":case"object":je("load",r);break;case"video":case"audio":for(p=0;p<Yp.length;p++)je(Yp[p],r);break;case"image":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"embed":case"source":case"link":je("error",r),je("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in u)if(u.hasOwnProperty(X)&&(p=u[X],p!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:_t(r,a,X,p,u,null)}return;default:if(I_(a)){for(te in u)u.hasOwnProperty(te)&&(p=u[te],p!==void 0&&gA(r,a,te,p,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(p=u[D],p!=null&&_t(r,a,D,p,u,null))}function sF(r,a,u,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,S=null,x=null,D=null,B=null,X=null,te=null;for(j in u){var re=u[j];if(u.hasOwnProperty(j)&&re!=null)switch(j){case"checked":break;case"value":break;case"defaultValue":B=re;default:p.hasOwnProperty(j)||_t(r,a,j,null,p,re)}}for(var W in p){var j=p[W];if(re=u[W],p.hasOwnProperty(W)&&(j!=null||re!=null))switch(W){case"type":S=j;break;case"name":_=j;break;case"checked":X=j;break;case"defaultChecked":te=j;break;case"value":x=j;break;case"defaultValue":D=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(137,a));break;default:j!==re&&_t(r,a,W,j,p,re)}}x_(r,x,D,B,X,te,S,_);return;case"select":j=x=D=W=null;for(S in u)if(B=u[S],u.hasOwnProperty(S)&&B!=null)switch(S){case"value":break;case"multiple":j=B;default:p.hasOwnProperty(S)||_t(r,a,S,null,p,B)}for(_ in p)if(S=p[_],B=u[_],p.hasOwnProperty(_)&&(S!=null||B!=null))switch(_){case"value":W=S;break;case"defaultValue":D=S;break;case"multiple":x=S;default:S!==B&&_t(r,a,_,S,p,B)}a=D,u=x,p=j,W!=null?yd(r,!!u,W,!1):!!p!=!!u&&(a!=null?yd(r,!!u,a,!0):yd(r,!!u,u?[]:"",!1));return;case"textarea":j=W=null;for(D in u)if(_=u[D],u.hasOwnProperty(D)&&_!=null&&!p.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:_t(r,a,D,null,p,_)}for(x in p)if(_=p[x],S=u[x],p.hasOwnProperty(x)&&(_!=null||S!=null))switch(x){case"value":W=_;break;case"defaultValue":j=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==S&&_t(r,a,x,_,p,S)}TC(r,W,j);return;case"option":for(var be in u)if(W=u[be],u.hasOwnProperty(be)&&W!=null&&!p.hasOwnProperty(be))switch(be){case"selected":r.selected=!1;break;default:_t(r,a,be,null,p,W)}for(B in p)if(W=p[B],j=u[B],p.hasOwnProperty(B)&&W!==j&&(W!=null||j!=null))switch(B){case"selected":r.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:_t(r,a,B,W,p,j)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in u)W=u[Me],u.hasOwnProperty(Me)&&W!=null&&!p.hasOwnProperty(Me)&&_t(r,a,Me,null,p,W);for(X in p)if(W=p[X],j=u[X],p.hasOwnProperty(X)&&W!==j&&(W!=null||j!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:_t(r,a,X,W,p,j)}return;default:if(I_(a)){for(var St in u)W=u[St],u.hasOwnProperty(St)&&W!==void 0&&!p.hasOwnProperty(St)&&gA(r,a,St,void 0,p,W);for(te in p)W=p[te],j=u[te],!p.hasOwnProperty(te)||W===j||W===void 0&&j===void 0||gA(r,a,te,W,p,j);return}}for(var V in u)W=u[V],u.hasOwnProperty(V)&&W!=null&&!p.hasOwnProperty(V)&&_t(r,a,V,null,p,W);for(re in p)W=p[re],j=u[re],!p.hasOwnProperty(re)||W===j||W==null&&j==null||_t(r,a,re,W,p,j)}function RR(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rF(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var _=u[p],S=_.transferSize,x=_.initiatorType,D=_.duration;if(S&&D&&RR(x)){for(x=0,D=_.responseEnd,p+=1;p<u.length;p++){var B=u[p],X=B.startTime;if(X>D)break;var te=B.transferSize,re=B.initiatorType;te&&RR(re)&&(B=B.responseEnd,x+=te*(B<D?1:(D-X)/(B-X)))}if(--p,a+=8*(S+x)/(_.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var mA=null,yA=null;function q0(r){return r.nodeType===9?r:r.ownerDocument}function IR(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function NR(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function vA(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var bA=null;function oF(){var r=window.event;return r&&r.type==="popstate"?r===bA?!1:(bA=r,!0):(bA=null,!1)}var MR=typeof setTimeout=="function"?setTimeout:void 0,aF=typeof clearTimeout=="function"?clearTimeout:void 0,DR=typeof Promise=="function"?Promise:void 0,lF=typeof queueMicrotask=="function"?queueMicrotask:typeof DR<"u"?function(r){return DR.resolve(null).then(r).catch(cF)}:MR;function cF(r){setTimeout(function(){throw r})}function Qa(r){return r==="head"}function kR(r,a){var u=a,p=0;do{var _=u.nextSibling;if(r.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"||u==="/&"){if(p===0){r.removeChild(_),Kd(a);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")Wp(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Wp(u);for(var S=u.firstChild;S;){var x=S.nextSibling,D=S.nodeName;S[hp]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=x}}else u==="body"&&Wp(r.ownerDocument.body);u=_}while(u);Kd(a)}function PR(r,a){var u=r;r=0;do{var p=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=p}while(u)}function _A(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":_A(u),w_(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function uF(r,a,u,p){for(;r.nodeType===1;){var _=u;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(p){if(!r[hp])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(S=r.getAttribute("rel"),S==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(S!==_.rel||r.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||r.getAttribute("title")!==(_.title==null?null:_.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(S=r.getAttribute("src"),(S!==(_.src==null?null:_.src)||r.getAttribute("type")!==(_.type==null?null:_.type)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&S&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var S=_.name==null?null:""+_.name;if(_.type==="hidden"&&r.getAttribute("name")===S)return r}else return r;if(r=Ms(r.nextSibling),r===null)break}return null}function dF(r,a,u){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Ms(r.nextSibling),r===null))return null;return r}function LR(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=Ms(r.nextSibling),r===null))return null;return r}function SA(r){return r.data==="$?"||r.data==="$~"}function AA(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function hF(r,a){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||u.readyState!=="loading")a();else{var p=function(){a(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),r._reactRetry=p}}function Ms(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var EA=null;function OR(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(a===0)return Ms(r.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}r=r.nextSibling}return null}function UR(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return r;a--}else u!=="/$"&&u!=="/&"||a++}r=r.previousSibling}return null}function FR(r,a,u){switch(a=q0(u),r){case"html":if(r=a.documentElement,!r)throw Error(n(452));return r;case"head":if(r=a.head,!r)throw Error(n(453));return r;case"body":if(r=a.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Wp(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);w_(r)}var Ds=new Map,BR=new Set;function $0(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ro=$.d;$.d={f:fF,r:pF,D:gF,C:mF,L:yF,m:vF,X:_F,S:bF,M:SF};function fF(){var r=Ro.f(),a=O0();return r||a}function pF(r){var a=pd(r);a!==null&&a.tag===5&&a.type==="form"?n1(a):Ro.r(r)}var Yd=typeof document>"u"?null:document;function HR(r,a,u){var p=Yd;if(p&&typeof a=="string"&&a){var _=Ts(a);_='link[rel="'+r+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),BR.has(_)||(BR.add(_),r={rel:r,crossOrigin:u,href:a},p.querySelector(_)===null&&(a=p.createElement("link"),Bn(a,"link",r),En(a),p.head.appendChild(a)))}}function gF(r){Ro.D(r),HR("dns-prefetch",r,null)}function mF(r,a){Ro.C(r,a),HR("preconnect",r,a)}function yF(r,a,u){Ro.L(r,a,u);var p=Yd;if(p&&r&&a){var _='link[rel="preload"][as="'+Ts(a)+'"]';a==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+Ts(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+Ts(u.imageSizes)+'"]')):_+='[href="'+Ts(r)+'"]';var S=_;switch(a){case"style":S=Xd(r);break;case"script":S=Wd(r)}Ds.has(S)||(r=y({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:r,as:a},u),Ds.set(S,r),p.querySelector(_)!==null||a==="style"&&p.querySelector(Kp(S))||a==="script"&&p.querySelector(Jp(S))||(a=p.createElement("link"),Bn(a,"link",r),En(a),p.head.appendChild(a)))}}function vF(r,a){Ro.m(r,a);var u=Yd;if(u&&r){var p=a&&typeof a.as=="string"?a.as:"script",_='link[rel="modulepreload"][as="'+Ts(p)+'"][href="'+Ts(r)+'"]',S=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Wd(r)}if(!Ds.has(S)&&(r=y({rel:"modulepreload",href:r},a),Ds.set(S,r),u.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Jp(S)))return}p=u.createElement("link"),Bn(p,"link",r),En(p),u.head.appendChild(p)}}}function bF(r,a,u){Ro.S(r,a,u);var p=Yd;if(p&&r){var _=gd(p).hoistableStyles,S=Xd(r);a=a||"default";var x=_.get(S);if(!x){var D={loading:0,preload:null};if(x=p.querySelector(Kp(S)))D.loading=5;else{r=y({rel:"stylesheet",href:r,"data-precedence":a},u),(u=Ds.get(S))&&TA(r,u);var B=x=p.createElement("link");En(B),Bn(B,"link",r),B._p=new Promise(function(X,te){B.onload=X,B.onerror=te}),B.addEventListener("load",function(){D.loading|=1}),B.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Y0(x,a,p)}x={type:"stylesheet",instance:x,count:1,state:D},_.set(S,x)}}}function _F(r,a){Ro.X(r,a);var u=Yd;if(u&&r){var p=gd(u).hoistableScripts,_=Wd(r),S=p.get(_);S||(S=u.querySelector(Jp(_)),S||(r=y({src:r,async:!0},a),(a=Ds.get(_))&&wA(r,a),S=u.createElement("script"),En(S),Bn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function SF(r,a){Ro.M(r,a);var u=Yd;if(u&&r){var p=gd(u).hoistableScripts,_=Wd(r),S=p.get(_);S||(S=u.querySelector(Jp(_)),S||(r=y({src:r,async:!0,type:"module"},a),(a=Ds.get(_))&&wA(r,a),S=u.createElement("script"),En(S),Bn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function GR(r,a,u,p){var _=(_=Re.current)?$0(_):null;if(!_)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=Xd(u.href),u=gd(_).hoistableStyles,p=u.get(a),p||(p={type:"style",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Xd(u.href);var S=gd(_).hoistableStyles,x=S.get(r);if(x||(_=_.ownerDocument||_,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(r,x),(S=_.querySelector(Kp(r)))&&!S._p&&(x.instance=S,x.state.loading=5),Ds.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ds.set(r,u),S||AF(_,r,u,x.state))),a&&p===null)throw Error(n(528,""));return x}if(a&&p!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Wd(u),u=gd(_).hoistableScripts,p=u.get(a),p||(p={type:"script",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Xd(r){return'href="'+Ts(r)+'"'}function Kp(r){return'link[rel="stylesheet"]['+r+"]"}function zR(r){return y({},r,{"data-precedence":r.precedence,precedence:null})}function AF(r,a,u,p){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=r.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),Bn(a,"link",u),En(a),r.head.appendChild(a))}function Wd(r){return'[src="'+Ts(r)+'"]'}function Jp(r){return"script[async]"+r}function VR(r,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var p=r.querySelector('style[data-href~="'+Ts(u.href)+'"]');if(p)return a.instance=p,En(p),p;var _=y({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(r.ownerDocument||r).createElement("style"),En(p),Bn(p,"style",_),Y0(p,u.precedence,r),a.instance=p;case"stylesheet":_=Xd(u.href);var S=r.querySelector(Kp(_));if(S)return a.state.loading|=4,a.instance=S,En(S),S;p=zR(u),(_=Ds.get(_))&&TA(p,_),S=(r.ownerDocument||r).createElement("link"),En(S);var x=S;return x._p=new Promise(function(D,B){x.onload=D,x.onerror=B}),Bn(S,"link",p),a.state.loading|=4,Y0(S,u.precedence,r),a.instance=S;case"script":return S=Wd(u.src),(_=r.querySelector(Jp(S)))?(a.instance=_,En(_),_):(p=u,(_=Ds.get(S))&&(p=y({},u),wA(p,_)),r=r.ownerDocument||r,_=r.createElement("script"),En(_),Bn(_,"link",p),r.head.appendChild(_),a.instance=_);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,Y0(p,u.precedence,r));return a.instance}function Y0(r,a,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,S=_,x=0;x<p.length;x++){var D=p[x];if(D.dataset.precedence===a)S=D;else if(S!==_)break}S?S.parentNode.insertBefore(r,S.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(r,a.firstChild))}function TA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function wA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var X0=null;function qR(r,a,u){if(X0===null){var p=new Map,_=X0=new Map;_.set(u,p)}else _=X0,p=_.get(u),p||(p=new Map,_.set(u,p));if(p.has(r))return p;for(p.set(r,null),u=u.getElementsByTagName(r),_=0;_<u.length;_++){var S=u[_];if(!(S[hp]||S[Ln]||r==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var x=S.getAttribute(a)||"";x=r+x;var D=p.get(x);D?D.push(S):p.set(x,[S])}}return p}function $R(r,a,u){r=r.ownerDocument||r,r.head.insertBefore(u,a==="title"?r.querySelector("head > title"):null)}function EF(r,a,u){if(u===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function YR(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function TF(r,a,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var _=Xd(p.href),S=a.querySelector(Kp(_));if(S){a=S._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=W0.bind(r),a.then(r,r)),u.state.loading|=4,u.instance=S,En(S);return}S=a.ownerDocument||a,p=zR(p),(_=Ds.get(_))&&TA(p,_),S=S.createElement("link"),En(S);var x=S;x._p=new Promise(function(D,B){x.onload=D,x.onerror=B}),Bn(S,"link",p),u.instance=S}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=W0.bind(r),a.addEventListener("load",u),a.addEventListener("error",u))}}var CA=0;function wF(r,a){return r.stylesheets&&r.count===0&&J0(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var p=setTimeout(function(){if(r.stylesheets&&J0(r,r.stylesheets),r.unsuspend){var S=r.unsuspend;r.unsuspend=null,S()}},6e4+a);0<r.imgBytes&&CA===0&&(CA=62500*rF());var _=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&J0(r,r.stylesheets),r.unsuspend)){var S=r.unsuspend;r.unsuspend=null,S()}},(r.imgBytes>CA?50:800)+a);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(p),clearTimeout(_)}}:null}function W0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)J0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var K0=null;function J0(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,K0=new Map,a.forEach(CF,r),K0=null,W0.call(r))}function CF(r,a){if(!(a.state.loading&4)){var u=K0.get(r);if(u)var p=u.get(null);else{u=new Map,K0.set(r,u);for(var _=r.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<_.length;S++){var x=_[S];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(u.set(x.dataset.precedence,x),p=x)}p&&u.set(null,p)}_=a.instance,x=_.getAttribute("data-precedence"),S=u.get(x)||p,S===p&&u.set(null,_),u.set(x,_),this.count++,p=W0.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),S?S.parentNode.insertBefore(_,S.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(_,r.firstChild)),a.state.loading|=4}}var jp={$$typeof:k,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function xF(r,a,u,p,_,S,x,D,B){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=S_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S_(0),this.hiddenUpdates=S_(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=S,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function XR(r,a,u,p,_,S,x,D,B,X,te,re){return r=new xF(r,a,u,x,B,X,te,re,D),a=1,S===!0&&(a|=24),S=zi(3,null,null,a),r.current=S,S.stateNode=r,a=rS(),a.refCount++,r.pooledCache=a,a.refCount++,S.memoizedState={element:p,isDehydrated:u,cache:a},cS(S),r}function WR(r){return r?(r=wd,r):wd}function KR(r,a,u,p,_,S){_=WR(_),p.context===null?p.context=_:p.pendingContext=_,p=Ga(a),p.payload={element:u},S=S===void 0?null:S,S!==null&&(p.callback=S),u=za(r,p,a),u!==null&&(wi(u,r,a),Ip(u,r,a))}function JR(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<a?u:a}}function xA(r,a){JR(r,a),(r=r.alternate)&&JR(r,a)}function jR(r){if(r.tag===13||r.tag===31){var a=bc(r,67108864);a!==null&&wi(a,r,67108864),xA(r,67108864)}}function QR(r){if(r.tag===13||r.tag===31){var a=Xi();a=A_(a);var u=bc(r,a);u!==null&&wi(u,r,a),xA(r,a)}}var j0=!0;function RF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=2,RA(r,a,u,p)}finally{$.p=S,G.T=_}}function IF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=8,RA(r,a,u,p)}finally{$.p=S,G.T=_}}function RA(r,a,u,p){if(j0){var _=IA(p);if(_===null)pA(r,a,p,Q0,u),eI(r,p);else if(MF(_,r,a,u,p))p.stopPropagation();else if(eI(r,p),a&4&&-1<NF.indexOf(r)){for(;_!==null;){var S=pd(_);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var x=pc(S.pendingLanes);if(x!==0){var D=S;for(D.pendingLanes|=2,D.entangledLanes|=2;x;){var B=1<<31-Hi(x);D.entanglements[1]|=B,x&=~B}xr(S),(ut&6)===0&&(P0=Ee()+500,$p(0))}}break;case 31:case 13:D=bc(S,2),D!==null&&wi(D,S,2),O0(),xA(S,2)}if(S=IA(p),S===null&&pA(r,a,p,Q0,u),S===_)break;_=S}_!==null&&p.stopPropagation()}else pA(r,a,p,null,u)}}function IA(r){return r=M_(r),NA(r)}var Q0=null;function NA(r){if(Q0=null,r=fd(r),r!==null){var a=o(r);if(a===null)r=null;else{var u=a.tag;if(u===13){if(r=l(a),r!==null)return r;r=null}else if(u===31){if(r=c(a),r!==null)return r;r=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Q0=r,null}function ZR(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(An()){case As:return 2;case Ui:return 8;case Fi:case Da:return 32;case js:return 268435456;default:return 32}default:return 32}}var MA=!1,Za=null,el=null,tl=null,Qp=new Map,Zp=new Map,nl=[],NF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eI(r,a){switch(r){case"focusin":case"focusout":Za=null;break;case"dragenter":case"dragleave":el=null;break;case"mouseover":case"mouseout":tl=null;break;case"pointerover":case"pointerout":Qp.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zp.delete(a.pointerId)}}function eg(r,a,u,p,_,S){return r===null||r.nativeEvent!==S?(r={blockedOn:a,domEventName:u,eventSystemFlags:p,nativeEvent:S,targetContainers:[_]},a!==null&&(a=pd(a),a!==null&&jR(a)),r):(r.eventSystemFlags|=p,a=r.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),r)}function MF(r,a,u,p,_){switch(a){case"focusin":return Za=eg(Za,r,a,u,p,_),!0;case"dragenter":return el=eg(el,r,a,u,p,_),!0;case"mouseover":return tl=eg(tl,r,a,u,p,_),!0;case"pointerover":var S=_.pointerId;return Qp.set(S,eg(Qp.get(S)||null,r,a,u,p,_)),!0;case"gotpointercapture":return S=_.pointerId,Zp.set(S,eg(Zp.get(S)||null,r,a,u,p,_)),!0}return!1}function tI(r){var a=fd(r.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){r.blockedOn=a,gC(r.priority,function(){QR(u)});return}}else if(a===31){if(a=c(u),a!==null){r.blockedOn=a,gC(r.priority,function(){QR(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Z0(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var u=IA(r.nativeEvent);if(u===null){u=r.nativeEvent;var p=new u.constructor(u.type,u);N_=p,u.target.dispatchEvent(p),N_=null}else return a=pd(u),a!==null&&jR(a),r.blockedOn=u,!1;a.shift()}return!0}function nI(r,a,u){Z0(r)&&u.delete(a)}function DF(){MA=!1,Za!==null&&Z0(Za)&&(Za=null),el!==null&&Z0(el)&&(el=null),tl!==null&&Z0(tl)&&(tl=null),Qp.forEach(nI),Zp.forEach(nI)}function ev(r,a){r.blockedOn===a&&(r.blockedOn=null,MA||(MA=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,DF)))}var tv=null;function iI(r){tv!==r&&(tv=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){tv===r&&(tv=null);for(var a=0;a<r.length;a+=3){var u=r[a],p=r[a+1],_=r[a+2];if(typeof p!="function"){if(NA(p||u)===null)continue;break}var S=pd(u);S!==null&&(r.splice(a,3),a-=3,IS(S,{pending:!0,data:_,method:u.method,action:p},p,_))}}))}function Kd(r){function a(B){return ev(B,r)}Za!==null&&ev(Za,r),el!==null&&ev(el,r),tl!==null&&ev(tl,r),Qp.forEach(a),Zp.forEach(a);for(var u=0;u<nl.length;u++){var p=nl[u];p.blockedOn===r&&(p.blockedOn=null)}for(;0<nl.length&&(u=nl[0],u.blockedOn===null);)tI(u),u.blockedOn===null&&nl.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var _=u[p],S=u[p+1],x=_[bi]||null;if(typeof S=="function")x||iI(u);else if(x){var D=null;if(S&&S.hasAttribute("formAction")){if(_=S,x=S[bi]||null)D=x.formAction;else if(NA(_)!==null)continue}else D=x.action;typeof D=="function"?u[p+1]=D:(u.splice(p,3),p-=3),iI(u)}}}function sI(){function r(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(x){return _=x})},focusReset:"manual",scroll:"manual"})}function a(){_!==null&&(_(),_=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,_=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),_!==null&&(_(),_=null)}}}function DA(r){this._internalRoot=r}nv.prototype.render=DA.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,p=Xi();KR(u,p,r,a,null,null)},nv.prototype.unmount=DA.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;KR(r.current,2,null,r,null,null),O0(),a[hd]=null}};function nv(r){this._internalRoot=r}nv.prototype.unstable_scheduleHydration=function(r){if(r){var a=pC();r={blockedOn:null,target:r,priority:a};for(var u=0;u<nl.length&&a!==0&&a<nl[u].priority;u++);nl.splice(u,0,r),u===0&&tI(r)}};var rI=e.version;if(rI!=="19.2.4")throw Error(n(527,rI,"19.2.4"));$.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=f(a),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var kF={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iv.isDisabled&&iv.supportsFiber)try{cp=iv.inject(kF),Bi=iv}catch{}}return ng.createRoot=function(r,a){if(!s(r))throw Error(n(299));var u=!1,p="",_=h1,S=f1,x=p1;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=XR(r,1,!1,null,null,u,p,null,_,S,x,sI),r[hd]=a.current,fA(r),new DA(a)},ng.hydrateRoot=function(r,a,u){if(!s(r))throw Error(n(299));var p=!1,_="",S=h1,x=f1,D=p1,B=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(x=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(B=u.formState)),a=XR(r,1,!0,a,u??null,p,_,B,S,x,D,sI),a.context=WR(null),u=a.current,p=Xi(),p=A_(p),_=Ga(p),_.callback=null,za(u,_,p),u=p,a.current.lanes=u,dp(a,u),xr(a),r[hd]=a.current,fA(r),new nv(a)},ng.version="19.2.4",ng}var mI;function YF(){if(mI)return OA.exports;mI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),OA.exports=$F(),OA.exports}var XF=YF();const WF=dw(XF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=i=>{const e=JF(i);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=ee.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:l,...c},h)=>ee.createElement("svg",{ref:h,...jF,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:RD("lucide",s),...!o&&!QF(c)&&{"aria-hidden":"true"},...c},[...l.map(([f,g])=>ee.createElement(f,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=(i,e)=>{const t=ee.forwardRef(({className:n,...s},o)=>ee.createElement(ZF,{ref:o,iconNode:e,className:RD(`lucide-${KF(yI(i))}`,`lucide-${i}`,n),...s}));return t.displayName=yI(i),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],tB=Ye("arrow-left",eB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],fw=Ye("arrow-right",nB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],vI=Ye("award",iB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ma=Ye("book-open",sB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],oB=Ye("book",rB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],ID=Ye("briefcase",aB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ND=Ye("calendar",lB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],cE=Ye("check",cB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],bI=Ye("chevron-left",uB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],uE=Ye("chevron-right",dB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],fB=Ye("circle-alert",hB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gB=Ye("circle-check-big",pB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yB=Ye("eye",mB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],bB=Ye("file-question-mark",vB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],_I=Ye("file-text",_B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],AB=Ye("gift",SB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],TB=Ye("globe",EB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],CB=Ye("heart",wB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],RB=Ye("highlighter",xB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],NB=Ye("house",IB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],sc=Ye("loader-circle",MB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],MD=Ye("log-out",DB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],PB=Ye("maximize-2",kB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],SI=Ye("message-square",LB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],UB=Ye("minimize-2",OB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],dE=Ye("pen-tool",FB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],HB=Ye("pen",BB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],zB=Ye("play",GB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qB=Ye("plus",VB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],YB=Ye("quote",$B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],WB=Ye("refresh-cw",XB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],hE=Ye("search",KB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],pw=Ye("send",JB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],gs=Ye("sparkles",jB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],DD=Ye("star",QB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],HA=Ye("sticky-note",ZB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],t3=Ye("trending-up",e3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],AI=Ye("upload",n3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],kD=Ye("user",i3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],r3=Ye("wallet",s3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ph=Ye("x",o3),sv=({book:i,onClick:e,onRead:t})=>{const[n,s]=ee.useState(!1),o=i.isbn?`https://covers.openlibrary.org/b/isbn/${i.isbn}-L.jpg`:null;return T.jsxs("div",{className:"group relative flex flex-col w-full cursor-pointer",onClick:e,children:[T.jsxs("div",{className:"relative w-full aspect-[2/3] rounded-2xl overflow-hidden shadow-sm transition-all duration-500 group-hover:shadow-[0_20px_40px_-12px_rgba(0,0,0,0.15)] group-hover:-translate-y-2",children:[!n&&o?T.jsx("img",{src:o,alt:i.title,className:"w-full h-full object-cover",onError:()=>s(!0),loading:"lazy"}):T.jsxs("div",{className:"w-full h-full flex items-center justify-center relative overflow-hidden",style:{background:`linear-gradient(to bottom right, ${i.coverColor} 0%, #ffffff 150%)`},children:[T.jsx("div",{className:"absolute inset-0 opacity-10 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-black to-transparent"}),T.jsx("div",{className:"transform group-hover:scale-110 group-hover:rotate-3 transition-transform duration-700 ease-[cubic-bezier(0.34,1.56,0.64,1)]",children:T.jsx(ma,{className:"text-black/20 w-16 h-16",strokeWidth:1.5})}),T.jsx("div",{className:"absolute bottom-4 left-4 right-4 text-center",children:T.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-black/40 mb-1",children:"Untitled"})})]}),T.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100",children:T.jsxs("button",{onClick:t,className:"bg-white/90 backdrop-blur-xl text-gray-900 px-5 py-2.5 rounded-full text-xs font-bold shadow-xl transform scale-90 group-hover:scale-100 transition-all duration-300 flex items-center gap-2 hover:bg-white",children:[T.jsx(zB,{size:12,className:"fill-current"})," READ"]})}),i.matchReason&&T.jsx("div",{className:"absolute top-2 left-2 z-10",children:T.jsxs("div",{className:"inline-flex items-center gap-1 bg-white/90 backdrop-blur-md px-2 py-1 rounded-md shadow-sm border border-white/50",children:[T.jsx(gs,{size:8,className:"text-blue-500 fill-blue-500"}),T.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wide text-gray-800",children:"Match"})]})})]}),T.jsxs("div",{className:"mt-3 space-y-1",children:[T.jsx("h3",{className:"font-serif font-bold text-gray-900 text-base leading-tight line-clamp-2 group-hover:text-blue-600 transition-colors",children:i.title}),T.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:i.author}),T.jsxs("div",{className:"flex items-center gap-3 pt-1",children:[i.reviewSnippet&&T.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:[T.jsx(t3,{size:8})," Buzz"]}),T.jsxs("div",{className:"flex items-center gap-0.5",children:[T.jsx(DD,{size:10,className:"text-yellow-400 fill-yellow-400"}),T.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:"4.8"})]})]})]})]})};var a3={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let l3,c3;function u3(){return{geminiUrl:l3,vertexUrl:c3}}function d3(i,e,t,n){var s,o;if(!(i!=null&&i.baseUrl)){const l=u3();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(o=l.geminiUrl)!==null&&o!==void 0?o:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ia{}function fe(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function v(i,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const h=i[c];if(Array.isArray(t))for(let f=0;f<h.length;f++){const g=h[f];v(g,e.slice(o+1),t[f])}else for(const f of h)v(f,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const h=i[c];v(h[0],e.slice(o+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function m(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const s=e[n];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in i){const l=i[o];return Array.isArray(l)?l.map(c=>m(c,e.slice(n+1),t)):t}else return t}else i=i[s]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function h3(i,e){for(const[t,n]of Object.entries(e)){const s=t.split("."),o=n.split("."),l=new Set;let c=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){c=h;break}if(c!==-1&&o.length>c)for(let h=c;h<o.length;h++){const f=o[h];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}fE(i,s,o,0,l)}}function fE(i,e,t,n,s){if(n>=e.length||typeof i!="object"||i===null)return;const o=e[n];if(o.endsWith("[]")){const l=o.slice(0,-2),c=i;if(l in c&&Array.isArray(c[l]))for(const h of c[l])fE(h,e,t,n+1,s)}else if(o==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const l=i,c=Object.keys(l).filter(f=>!f.startsWith("_")&&!s.has(f)),h={};for(const f of c)h[f]=l[f];for(const[f,g]of Object.entries(h)){const y=[];for(const b of t.slice(n))b==="*"?y.push(f):y.push(b);v(l,y,g)}for(const f of c)delete l[f]}}else{const l=i;o in l&&fE(l[o],e,t,n+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gw(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f3(i){const e={},t=m(i,["operationName"]);t!=null&&v(e,["operationName"],t);const n=m(i,["resourceName"]);return n!=null&&v(e,["_url","resourceName"],n),e}function p3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],m3(l)),e}function g3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],y3(l)),e}function m3(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>v3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function y3(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>b3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function v3(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],w3(t)),e}function b3(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],C3(t)),e}function _3(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function S3(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function A3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],E3(l)),e}function E3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function PD(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],T3(l)),e}function T3(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function w3(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],gw(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function C3(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],gw(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var EI;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(EI||(EI={}));var TI;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(TI||(TI={}));var wI;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(wI||(wI={}));var Pe;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(Pe||(Pe={}));var CI;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(CI||(CI={}));var xI;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(xI||(xI={}));var RI;(function(i){i.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",i.HTTP_IN_QUERY="HTTP_IN_QUERY",i.HTTP_IN_HEADER="HTTP_IN_HEADER",i.HTTP_IN_PATH="HTTP_IN_PATH",i.HTTP_IN_BODY="HTTP_IN_BODY",i.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(RI||(RI={}));var II;(function(i){i.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",i.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",i.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",i.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(II||(II={}));var NI;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(NI||(NI={}));var MI;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(MI||(MI={}));var DI;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(DI||(DI={}));var kI;(function(i){i.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH",i.MINIMAL="MINIMAL"})(kI||(kI={}));var PI;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(PI||(PI={}));var LI;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(LI||(LI={}));var OI;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(OI||(OI={}));var UI;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE",i.IMAGE_RECITATION="IMAGE_RECITATION",i.IMAGE_OTHER="IMAGE_OTHER"})(UI||(UI={}));var FI;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(FI||(FI={}));var BI;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(BI||(BI={}));var HI;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(HI||(HI={}));var GI;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(GI||(GI={}));var zI;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(zI||(zI={}));var ob;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(ob||(ob={}));var VI;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(VI||(VI={}));var qI;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(qI||(qI={}));var $I;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})($I||($I={}));var pE;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(pE||(pE={}));var YI;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V",i.TUNING_TASK_R2V="TUNING_TASK_R2V"})(YI||(YI={}));var XI;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",i.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(XI||(XI={}));var gE;(function(i){i.COLLECTION="COLLECTION"})(gE||(gE={}));var WI;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(WI||(WI={}));var KI;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(KI||(KI={}));var JI;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(JI||(JI={}));var jI;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(jI||(jI={}));var QI;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(QI||(QI={}));var ZI;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(ZI||(ZI={}));var eN;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(eN||(eN={}));var tN;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(tN||(tN={}));var nN;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(nN||(nN={}));var iN;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(iN||(iN={}));var sN;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(sN||(sN={}));var rN;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(rN||(rN={}));var oN;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(oN||(oN={}));var aN;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(aN||(aN={}));var lN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.STATE_PENDING="STATE_PENDING",i.STATE_ACTIVE="STATE_ACTIVE",i.STATE_FAILED="STATE_FAILED"})(lN||(lN={}));var cN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(cN||(cN={}));var uN;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED",i.REGISTERED="REGISTERED"})(uN||(uN={}));var dN;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(dN||(dN={}));var hN;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(hN||(hN={}));var fN;(function(i){i.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",i.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",i.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(fN||(fN={}));var pN;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.ACTIVITY_START="ACTIVITY_START",i.ACTIVITY_END="ACTIVITY_END"})(pN||(pN={}));var gN;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(gN||(gN={}));var mN;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(mN||(mN={}));var yN;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(yN||(yN={}));var vN;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(vN||(vN={}));var bN;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(bN||(bN={}));var _N;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(_N||(_N={}));var oh;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(oh||(oh={}));class mE{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ig{get text(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const y=[];for(const b of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[A,w]of Object.entries(b))A!=="text"&&A!=="thought"&&A!=="thoughtSignature"&&(w!==null||w!==void 0)&&y.push(A);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;g=!0,f+=b.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const y of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[b,A]of Object.entries(y))b!=="inlineData"&&(A!==null||A!==void 0)&&g.push(b);y.inlineData&&typeof y.inlineData.data=="string"&&(f+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class SN{}class AN{}class x3{}class R3{}class I3{}class N3{}class EN{}class TN{}class wN{}class M3{}class ab{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new ab;let s;const o=e;return t?s=g3(o):s=p3(o),Object.assign(n,s),n}}class CN{}class xN{}class RN{}class IN{}class D3{}class k3{}class P3{}class mw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new mw,o=A3(e);return Object.assign(n,o),n}}class L3{}class O3{}class U3{}class NN{}class F3{get text(){var e,t,n;let s="",o=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[h,f]of Object.entries(c))h!=="text"&&h!=="thought"&&f!==null&&l.push(h);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;o=!0,s+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,t,n;let s="";const o=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,h]of Object.entries(l))c!=="inlineData"&&h!==null&&o.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class B3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class yw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new yw,o=PD(e);return Object.assign(n,o),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lt(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function LD(i,e){const t=lt(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function OD(i){return Array.isArray(i)?i.map(e=>lb(e)):[lb(i)]}function lb(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function UD(i){const e=lb(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function FD(i){const e=lb(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function MN(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function BD(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>MN(e)):[MN(i)]}function yE(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function DN(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function kN(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function ri(i){if(i==null)throw new Error("ContentUnion is required");return yE(i)?i:{role:"user",parts:BD(i)}}function vw(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=ri(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=ri(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ri(t)):[ri(e)]}function Ws(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(DN(i)||kN(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ri(i)]}const e=[],t=[],n=yE(i[0]);for(const s of i){const o=yE(s);if(o!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(DN(s)||kN(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:BD(t)}),e}function H3(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(Pe).includes(t[0].toUpperCase())?t[0].toUpperCase():Pe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(Pe).includes(n.toUpperCase())?n.toUpperCase():Pe.TYPE_UNSPECIFIED})}}function gh(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=i.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,i=o[1]):o[1].type==="null"&&(e.nullable=!0,i=o[0])),i.type instanceof Array&&H3(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Pe).includes(c.toUpperCase())?c.toUpperCase():Pe.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=gh(c);else if(n.includes(l)){const h=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}h.push(gh(f))}e[l]=h}else if(s.includes(l)){const h={};for(const[f,g]of Object.entries(c))h[f]=gh(g);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=c}return e}function bw(i){return gh(i)}function _w(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function Sw(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function tp(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=gh(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=gh(e.response));return i}function np(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function G3(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Na(i,e){if(typeof e!="string")throw new Error("name must be a string");return G3(i,e,"cachedContents")}function HD(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function dc(i){return gw(i)}function z3(i){return i!=null&&typeof i=="object"&&"name"in i}function V3(i){return i!=null&&typeof i=="object"&&"video"in i}function q3(i){return i!=null&&typeof i=="object"&&"uri"in i}function GD(i){var e;let t;if(z3(i)&&(t=i.name),!(q3(i)&&(t=i.uri,t===void 0))&&!(V3(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function zD(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function VD(i){for(const e of["models","tunedModels","publisherModels"])if($3(i,e))return i[e];return[]}function $3(i,e){return i!==null&&typeof i=="object"&&e in i}function Y3(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function X3(i,e={}){const t=[],n=new Set;for(const s of i){const o=s.name;if(n.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);n.add(o);const l=Y3(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function qD(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(s>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function W3(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function $D(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return i;let o=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function ip(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function YD(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K3(i){const e={},t=m(i,["responsesFile"]);t!=null&&v(e,["fileName"],t);const n=m(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>IH(l))),v(e,["inlinedResponses"],o)}const s=m(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["inlinedEmbedContentResponses"],o)}return e}function J3(i){const e={},t=m(i,["predictionsFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsDestination","outputUriPrefix"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigqueryDestination","outputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function j3(i){const e={},t=m(i,["format"]);t!=null&&v(e,["predictionsFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsDestination","outputUriPrefix"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigqueryDestination","outputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Sv(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata","displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["metadata","state"]);s!=null&&v(e,["state"],YD(s));const o=m(i,["metadata","createTime"]);o!=null&&v(e,["createTime"],o);const l=m(i,["metadata","endTime"]);l!=null&&v(e,["endTime"],l);const c=m(i,["metadata","updateTime"]);c!=null&&v(e,["updateTime"],c);const h=m(i,["metadata","model"]);h!=null&&v(e,["model"],h);const f=m(i,["metadata","output"]);return f!=null&&v(e,["dest"],K3($D(f))),e}function vE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["state"]);s!=null&&v(e,["state"],YD(s));const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["createTime"]);l!=null&&v(e,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(e,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(e,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(e,["updateTime"],f);const g=m(i,["model"]);g!=null&&v(e,["model"],g);const y=m(i,["inputConfig"]);y!=null&&v(e,["src"],Q3(y));const b=m(i,["outputConfig"]);b!=null&&v(e,["dest"],J3($D(b)));const A=m(i,["completionStats"]);return A!=null&&v(e,["completionStats"],A),e}function Q3(i){const e={},t=m(i,["instancesFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsSource","uris"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigquerySource","inputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function Z3(i,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(e,["fileName"]);n!=null&&v(t,["fileName"],n);const s=m(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>RH(i,l))),v(t,["requests","requests"],o)}return t}function eH(i){const e={},t=m(i,["format"]);t!=null&&v(e,["instancesFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsSource","uris"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigquerySource","inputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function tH(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function nH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function iH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function sH(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],rH(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function rH(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function XD(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>OH(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function oH(i,e){const t={},n=m(i,["displayName"]);if(e!==void 0&&n!=null&&v(e,["batch","displayName"],n),m(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function aH(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["dest"]);return e!==void 0&&s!=null&&v(e,["outputConfig"],j3(W3(s))),t}function PN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],Z3(i,qD(i,s)));const o=m(e,["config"]);return o!=null&&oH(o,t),t}function lH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],lt(i,n));const s=m(e,["src"]);s!=null&&v(t,["inputConfig"],eH(qD(i,s)));const o=m(e,["config"]);return o!=null&&aH(o,t),t}function cH(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["batch","displayName"],n),t}function uH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],yH(i,s));const o=m(e,["config"]);return o!=null&&cH(o,t),t}function dH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function hH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function fH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function pH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function gH(i,e){const t={},n=m(e,["contents"]);if(n!=null){let o=vw(i,n);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["requests[]","request","content"],o)}const s=m(e,["config"]);return s!=null&&(v(t,["_self"],mH(s,t)),h3(t,{"requests[].*":"requests[].request.*"})),t}function mH(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function yH(i,e){const t={},n=m(e,["fileName"]);n!=null&&v(t,["file_name"],n);const s=m(e,["inlinedRequests"]);return s!=null&&v(t,["requests"],gH(i,s)),t}function vH(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function bH(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _H(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function SH(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],XD(ri(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],bw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let ce=k;Array.isArray(ce)&&(ce=ce.map(ue=>UH(ue))),v(t,["safetySettings"],ce)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let ce=np(L);Array.isArray(ce)&&(ce=ce.map(ue=>BH(tp(ue)))),v(t,["tools"],ce)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],FH(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=m(e,["cachedContent"]);t!==void 0&&U!=null&&v(t,["cachedContent"],Na(i,U));const F=m(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],_w(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=m(e,["thinkingConfig"]);Q!=null&&v(n,["thinkingConfig"],Q);const Z=m(e,["imageConfig"]);Z!=null&&v(n,["imageConfig"],xH(Z));const oe=m(e,["enableEnhancedCivicAnswers"]);if(oe!=null&&v(n,["enableEnhancedCivicAnswers"],oe),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function AH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>sH(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function EH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function TH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],ip(i,n)),t}function wH(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function CH(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function xH(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function RH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["request","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let c=Ws(s);Array.isArray(c)&&(c=c.map(h=>XD(h))),v(t,["request","contents"],c)}const o=m(e,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(e,["config"]);return l!=null&&v(t,["request","generationConfig"],SH(i,l,m(t,["request"],{}))),t}function IH(i){const e={},t=m(i,["response"]);t!=null&&v(e,["response"],AH(t));const n=m(i,["error"]);return n!=null&&v(e,["error"],n),e}function NH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);if(e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),m(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function MH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);e!==void 0&&s!=null&&v(e,["_query","pageToken"],s);const o=m(i,["filter"]);return e!==void 0&&o!=null&&v(e,["_query","filter"],o),t}function DH(i){const e={},t=m(i,["config"]);return t!=null&&NH(t,e),e}function kH(i){const e={},t=m(i,["config"]);return t!=null&&MH(t,e),e}function PH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Sv(l))),v(e,["batchJobs"],o)}return e}function LH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>vE(l))),v(e,["batchJobs"],o)}return e}function OH(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],vH(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],bH(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],tH(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function UH(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function FH(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],_H(n)),e}function BH(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],wH(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],CH(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sa;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",i.PAGED_ITEM_DOCUMENTS="documents"})(Sa||(Sa={}));class ad{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HH extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ad(Sa.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=PN(this.apiClient,e),n=t._url,s=fe("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,h=c.requests,f=[];for(const g of h){const y=Object.assign({},g);if(y.systemInstruction){const b=y.systemInstruction;delete y.systemInstruction;const A=y.request;A.systemInstruction=b,y.request=A}f.push(y)}return c.requests=f,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),n.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?n.dest=`${o.slice(0,-6)}/dest`:n.dest=`${o}_dest_${s}`;else if(l)n.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=lH(this.apiClient,e);return c=fe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>vE(g))}else{const f=PN(this.apiClient,e);return c=fe("{model}:batchGenerateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>Sv(g))}}async createEmbeddingsInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=uH(this.apiClient,e);return o=fe("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>Sv(h))}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=TH(this.apiClient,e);return c=fe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>vE(g))}else{const f=EH(this.apiClient,e);return c=fe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>Sv(g))}}async cancel(e){var t,n,s,o;let l="",c={};if(this.apiClient.isVertexAI()){const h=iH(this.apiClient,e);l=fe("batchPredictionJobs/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const h=nH(this.apiClient,e);l=fe("batches/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=kH(e);return c=fe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=LH(g),b=new NN;return Object.assign(b,y),b})}else{const f=DH(e);return c=fe("batches",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=PH(g),b=new NN;return Object.assign(b,y),b})}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=hH(this.apiClient,e);return c=fe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>pH(g))}else{const f=dH(this.apiClient,e);return c=fe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>fH(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GH(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function LN(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>u4(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function zH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let g=Ws(l);Array.isArray(g)&&(g=g.map(y=>LN(y))),v(e,["contents"],g)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],LN(ri(c)));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>h4(y))),v(e,["tools"],g)}const f=m(i,["toolConfig"]);if(e!==void 0&&f!=null&&v(e,["toolConfig"],d4(f)),m(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function VH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let y=Ws(l);Array.isArray(y)&&(y=y.map(b=>b)),v(e,["contents"],y)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],ri(c));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let y=h;Array.isArray(y)&&(y=y.map(b=>f4(b))),v(e,["tools"],y)}const f=m(i,["toolConfig"]);e!==void 0&&f!=null&&v(e,["toolConfig"],f);const g=m(i,["kmsKeyName"]);return e!==void 0&&g!=null&&v(e,["encryption_spec","kmsKeyName"],g),t}function qH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],LD(i,n));const s=m(e,["config"]);return s!=null&&zH(s,t),t}function $H(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],LD(i,n));const s=m(e,["config"]);return s!=null&&VH(s,t),t}function YH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Na(i,n)),t}function XH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Na(i,n)),t}function WH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function KH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function JH(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function jH(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function QH(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ZH(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function e4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Na(i,n)),t}function t4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Na(i,n)),t}function n4(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function i4(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function s4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function r4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function o4(i){const e={},t=m(i,["config"]);return t!=null&&s4(t,e),e}function a4(i){const e={},t=m(i,["config"]);return t!=null&&r4(t,e),e}function l4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function c4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function u4(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],JH(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],jH(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],GH(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function d4(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],QH(n)),e}function h4(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],n4(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],i4(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function f4(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>ZH(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function p4(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function g4(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function m4(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],Na(i,n));const s=m(e,["config"]);return s!=null&&p4(s,t),t}function y4(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],Na(i,n));const s=m(e,["config"]);return s!=null&&g4(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class v4 extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ad(Sa.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=$H(this.apiClient,e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=qH(this.apiClient,e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=t4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=e4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=XH(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=KH(g),b=new RN;return Object.assign(b,y),b})}else{const f=YH(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=WH(g),b=new RN;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=y4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=m4(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=a4(e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=c4(g),b=new IN;return Object.assign(b,y),b})}else{const f=o4(e);return c=fe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=l4(g),b=new IN;return Object.assign(b,y),b})}}}function cb(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function ON(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Le(i){return this instanceof Le?(this.v=i,this):new Le(i)}function vr(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(A){return function(w){return Promise.resolve(w).then(A,y)}}function c(A,w){n[A]&&(s[A]=function(C){return new Promise(function(N,I){o.push([A,C,N,I])>1||h(A,C)})},w&&(s[A]=w(s[A])))}function h(A,w){try{f(n[A](w))}catch(C){b(o[0][3],C)}}function f(A){A.value instanceof Le?Promise.resolve(A.value.v).then(g,y):b(o[0][2],A)}function g(A){h("next",A)}function y(A){h("throw",A)}function b(A,w){A(w),o.shift(),o.length&&h(o[0][0],o[0][1])}}function br(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof ON=="function"?ON(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=i[o]&&function(l){return new Promise(function(c,h){l=i[o](l),s(c,h,l.done,l.value)})}}function s(o,l,c,h){Promise.resolve(h).then(function(f){o({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b4(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:WD(t)}function WD(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function _4(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function UN(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let o=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),o&&!WD(i[n])&&(o=!1),n++;o?e.push(...s):e.pop()}return e}class S4{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new A4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class A4{constructor(e,t,n,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),_4(o)}async sendMessage(e){var t;await this.sendPromise;const n=ri(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,c;const h=await s,f=(l=(o=h.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,g=h.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let b=[];g!=null&&(b=(c=g.slice(y))!==null&&c!==void 0?c:[]);const A=f?[f]:[];this.recordHistory(n,A,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=ri(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,n)}getHistory(e=!1){const t=e?UN(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return vr(this,arguments,function*(){var s,o,l,c,h,f;const g=[];try{for(var y=!0,b=br(e),A;A=yield Le(b.next()),s=A.done,!s;y=!0){c=A.value,y=!1;const w=c;if(b4(w)){const C=(f=(h=w.candidates)===null||h===void 0?void 0:h[0])===null||f===void 0?void 0:f.content;C!==void 0&&g.push(C)}yield yield Le(w)}}catch(w){o={error:w}}finally{try{!y&&!s&&(l=b.return)&&(yield Le(l.call(b)))}finally{if(o)throw o.error}}this.recordHistory(t,g)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(o=>o.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...UN(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ug extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ug.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E4(i){const e={},t=m(i,["file"]);return t!=null&&v(e,["file"],t),e}function T4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function w4(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],GD(t)),e}function C4(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function x4(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],GD(t)),e}function R4(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function I4(i){const e={},t=m(i,["config"]);return t!=null&&R4(t,e),e}function N4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M4 extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ad(Sa.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=I4(e);return o=fe("files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=N4(h),g=new L3;return Object.assign(g,f),g})}}async createInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=E4(e);return o=fe("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=T4(h),g=new O3;return Object.assign(g,f),g})}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=x4(e);return o=fe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=w4(e);return o=fe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=C4(h),g=new U3;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Av(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function D4(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>W4(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function k4(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function P4(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function L4(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function O4(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const C=m(i,["responseSchema"]);C!=null&&v(e,["responseSchema"],C);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const U=m(i,["topK"]);U!=null&&v(e,["topK"],U);const F=m(i,["topP"]);if(F!=null&&v(e,["topP"],F),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function U4(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function F4(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function B4(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Sw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],D4(ri(w)));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let U=np(C);Array.isArray(U)&&(U=U.map(F=>J4(tp(F)))),v(e,["setup","tools"],U)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],K4(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function H4(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],O4(n));const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Sw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],ri(w));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let F=np(C);Array.isArray(F)&&(F=F.map(K=>j4(tp(K)))),v(e,["setup","tools"],F)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],N);const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);e!==void 0&&O!=null&&v(e,["setup","proactivity"],O);const U=m(i,["explicitVadSignal"]);return e!==void 0&&U!=null&&v(e,["setup","explicitVadSignal"],U),t}function G4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],lt(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],B4(s,t)),t}function z4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],lt(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],H4(s,t)),t}function V4(i){const e={},t=m(i,["musicGenerationConfig"]);return t!=null&&v(e,["musicGenerationConfig"],t),e}function q4(i){const e={},t=m(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["weightedPrompts"],n)}return e}function $4(i){const e={},t=m(i,["media"]);if(t!=null){let f=OD(t);Array.isArray(f)&&(f=f.map(g=>Av(g))),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],Av(FD(n)));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],Av(UD(o)));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function Y4(i){const e={},t=m(i,["media"]);if(t!=null){let f=OD(t);Array.isArray(f)&&(f=f.map(g=>g)),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],FD(n));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],UD(o));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function X4(i){const e={},t=m(i,["setupComplete"]);t!=null&&v(e,["setupComplete"],t);const n=m(i,["serverContent"]);n!=null&&v(e,["serverContent"],n);const s=m(i,["toolCall"]);s!=null&&v(e,["toolCall"],s);const o=m(i,["toolCallCancellation"]);o!=null&&v(e,["toolCallCancellation"],o);const l=m(i,["usageMetadata"]);l!=null&&v(e,["usageMetadata"],Q4(l));const c=m(i,["goAway"]);c!=null&&v(e,["goAway"],c);const h=m(i,["sessionResumptionUpdate"]);h!=null&&v(e,["sessionResumptionUpdate"],h);const f=m(i,["voiceActivityDetectionSignal"]);f!=null&&v(e,["voiceActivityDetectionSignal"],f);const g=m(i,["voiceActivity"]);return g!=null&&v(e,["voiceActivity"],Z4(g)),e}function W4(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],k4(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],P4(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],Av(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function K4(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function J4(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],U4(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],F4(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function j4(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>L4(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function Q4(i){const e={},t=m(i,["promptTokenCount"]);t!=null&&v(e,["promptTokenCount"],t);const n=m(i,["cachedContentTokenCount"]);n!=null&&v(e,["cachedContentTokenCount"],n);const s=m(i,["candidatesTokenCount"]);s!=null&&v(e,["responseTokenCount"],s);const o=m(i,["toolUsePromptTokenCount"]);o!=null&&v(e,["toolUsePromptTokenCount"],o);const l=m(i,["thoughtsTokenCount"]);l!=null&&v(e,["thoughtsTokenCount"],l);const c=m(i,["totalTokenCount"]);c!=null&&v(e,["totalTokenCount"],c);const h=m(i,["promptTokensDetails"]);if(h!=null){let A=h;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["promptTokensDetails"],A)}const f=m(i,["cacheTokensDetails"]);if(f!=null){let A=f;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["cacheTokensDetails"],A)}const g=m(i,["candidatesTokensDetails"]);if(g!=null){let A=g;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["responseTokensDetails"],A)}const y=m(i,["toolUsePromptTokensDetails"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["toolUsePromptTokensDetails"],A)}const b=m(i,["trafficType"]);return b!=null&&v(e,["trafficType"],b),e}function Z4(i){const e={},t=m(i,["type"]);return t!=null&&v(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e5(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function t5(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],n5(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function n5(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function i5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let o=Ws(s);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["contents"],o)}return t}function s5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["tokensInfo"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["tokensInfo"],s)}return e}function r5(i){const e={},t=m(i,["values"]);t!=null&&v(e,["values"],t);const n=m(i,["statistics"]);return n!=null&&v(e,["statistics"],o5(n)),e}function o5(i){const e={},t=m(i,["truncated"]);t!=null&&v(e,["truncated"],t);const n=m(i,["token_count"]);return n!=null&&v(e,["tokenCount"],n),e}function Qb(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>g6(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function a5(i){const e={},t=m(i,["controlType"]);t!=null&&v(e,["controlType"],t);const n=m(i,["enableControlImageComputation"]);return n!=null&&v(e,["computeControl"],n),e}function l5(i){const e={};if(m(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function c5(i,e){const t={},n=m(i,["systemInstruction"]);e!==void 0&&n!=null&&v(e,["systemInstruction"],ri(n));const s=m(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>QD(c))),v(e,["tools"],l)}const o=m(i,["generationConfig"]);return e!==void 0&&o!=null&&v(e,["generationConfig"],e6(o)),t}function u5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let l=Ws(s);Array.isArray(l)&&(l=l.map(c=>Qb(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&l5(o),t}function d5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let l=Ws(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&c5(o,t),t}function h5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);n!=null&&v(e,["totalTokens"],n);const s=m(i,["cachedContentTokenCount"]);return s!=null&&v(e,["cachedContentTokenCount"],s),e}function f5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);return n!=null&&v(e,["totalTokens"],n),e}function p5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],lt(i,n)),t}function g5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],lt(i,n)),t}function m5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function y5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function v5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const C=m(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&v(e,["parameters","outputOptions","compressionQuality"],C);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["editMode"]);e!==void 0&&P!=null&&v(e,["parameters","editMode"],P);const k=m(i,["baseSteps"]);return e!==void 0&&k!=null&&v(e,["parameters","editConfig","baseSteps"],k),t}function b5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["referenceImages"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>S6(h))),v(t,["instances[0]","referenceImages"],c)}const l=m(e,["config"]);return l!=null&&v5(l,t),t}function _5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Zb(o))),v(e,["generatedImages"],s)}return e}function S5(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function A5(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["instances[]","task_type"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["instances[]","title"],s);const o=m(i,["outputDimensionality"]);e!==void 0&&o!=null&&v(e,["parameters","outputDimensionality"],o);const l=m(i,["mimeType"]);e!==void 0&&l!=null&&v(e,["instances[]","mimeType"],l);const c=m(i,["autoTruncate"]);return e!==void 0&&c!=null&&v(e,["parameters","autoTruncate"],c),t}function E5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let c=vw(i,s);Array.isArray(c)&&(c=c.map(h=>h)),v(t,["requests[]","content"],c)}const o=m(e,["config"]);o!=null&&S5(o,t);const l=m(e,["model"]);return l!==void 0&&v(t,["requests[]","model"],lt(i,l)),t}function T5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let l=vw(i,s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["instances[]","content"],l)}const o=m(e,["config"]);return o!=null&&A5(o,t),t}function w5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function C5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>r5(l))),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function x5(i){const e={},t=m(i,["endpoint"]);t!=null&&v(e,["name"],t);const n=m(i,["deployedModelId"]);return n!=null&&v(e,["deployedModelId"],n),e}function R5(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function I5(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function N5(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function M5(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function D5(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],Qb(ri(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],bw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let ce=k;Array.isArray(ce)&&(ce=ce.map(ue=>A6(ue))),v(t,["safetySettings"],ce)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let ce=np(L);Array.isArray(ce)&&(ce=ce.map(ue=>I6(tp(ue)))),v(t,["tools"],ce)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],R6(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=m(e,["cachedContent"]);t!==void 0&&U!=null&&v(t,["cachedContent"],Na(i,U));const F=m(e,["responseModalities"]);F!=null&&v(n,["responseModalities"],F);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],_w(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=m(e,["thinkingConfig"]);Q!=null&&v(n,["thinkingConfig"],Q);const Z=m(e,["imageConfig"]);Z!=null&&v(n,["imageConfig"],r6(Z));const oe=m(e,["enableEnhancedCivicAnswers"]);if(oe!=null&&v(n,["enableEnhancedCivicAnswers"],oe),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function k5(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],ri(s));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const C=m(e,["seed"]);C!=null&&v(n,["seed"],C);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],bw(I));const P=m(e,["responseJsonSchema"]);P!=null&&v(n,["responseJsonSchema"],P);const k=m(e,["routingConfig"]);k!=null&&v(n,["routingConfig"],k);const L=m(e,["modelSelectionConfig"]);L!=null&&v(n,["modelConfig"],L);const O=m(e,["safetySettings"]);if(t!==void 0&&O!=null){let $=O;Array.isArray($)&&($=$.map(ae=>ae)),v(t,["safetySettings"],$)}const U=m(e,["tools"]);if(t!==void 0&&U!=null){let $=np(U);Array.isArray($)&&($=$.map(ae=>QD(tp(ae)))),v(t,["tools"],$)}const F=m(e,["toolConfig"]);t!==void 0&&F!=null&&v(t,["toolConfig"],F);const K=m(e,["labels"]);t!==void 0&&K!=null&&v(t,["labels"],K);const q=m(e,["cachedContent"]);t!==void 0&&q!=null&&v(t,["cachedContent"],Na(i,q));const Q=m(e,["responseModalities"]);Q!=null&&v(n,["responseModalities"],Q);const Z=m(e,["mediaResolution"]);Z!=null&&v(n,["mediaResolution"],Z);const oe=m(e,["speechConfig"]);oe!=null&&v(n,["speechConfig"],_w(oe));const ce=m(e,["audioTimestamp"]);ce!=null&&v(n,["audioTimestamp"],ce);const ue=m(e,["thinkingConfig"]);ue!=null&&v(n,["thinkingConfig"],ue);const pe=m(e,["imageConfig"]);if(pe!=null&&v(n,["imageConfig"],o6(pe)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const G=m(e,["modelArmorConfig"]);return t!==void 0&&G!=null&&v(t,["modelArmorConfig"],G),n}function FN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let l=Ws(s);Array.isArray(l)&&(l=l.map(c=>Qb(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],D5(i,o,t)),t}function BN(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["contents"]);if(s!=null){let l=Ws(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],k5(i,o,t)),t}function HN(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>t5(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function GN(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>g)),v(e,["candidates"],f)}const s=m(i,["createTime"]);s!=null&&v(e,["createTime"],s);const o=m(i,["modelVersion"]);o!=null&&v(e,["modelVersion"],o);const l=m(i,["promptFeedback"]);l!=null&&v(e,["promptFeedback"],l);const c=m(i,["responseId"]);c!=null&&v(e,["responseId"],c);const h=m(i,["usageMetadata"]);return h!=null&&v(e,["usageMetadata"],h),e}function P5(i,e){const t={};if(m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["aspectRatio"]);e!==void 0&&s!=null&&v(e,["parameters","aspectRatio"],s);const o=m(i,["guidanceScale"]);if(e!==void 0&&o!=null&&v(e,["parameters","guidanceScale"],o),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&v(e,["parameters","safetySetting"],l);const c=m(i,["personGeneration"]);e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c);const h=m(i,["includeSafetyAttributes"]);e!==void 0&&h!=null&&v(e,["parameters","includeSafetyAttributes"],h);const f=m(i,["includeRaiReason"]);e!==void 0&&f!=null&&v(e,["parameters","includeRaiReason"],f);const g=m(i,["language"]);e!==void 0&&g!=null&&v(e,["parameters","language"],g);const y=m(i,["outputMimeType"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","mimeType"],y);const b=m(i,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&v(e,["parameters","outputOptions","compressionQuality"],b),m(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=m(i,["imageSize"]);if(e!==void 0&&A!=null&&v(e,["parameters","sampleImageSize"],A),m(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function L5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const C=m(i,["outputCompressionQuality"]);e!==void 0&&C!=null&&v(e,["parameters","outputOptions","compressionQuality"],C);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["imageSize"]);e!==void 0&&P!=null&&v(e,["parameters","sampleImageSize"],P);const k=m(i,["enhancePrompt"]);return e!==void 0&&k!=null&&v(e,["parameters","enhancePrompt"],k),t}function O5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&P5(o,t),t}function U5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&L5(o,t),t}function F5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>J5(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],JD(s)),e}function B5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>Zb(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],jD(s)),e}function H5(i,e){const t={},n=m(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n),m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=m(i,["durationSeconds"]);if(e!==void 0&&s!=null&&v(e,["parameters","durationSeconds"],s),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(i,["aspectRatio"]);e!==void 0&&o!=null&&v(e,["parameters","aspectRatio"],o);const l=m(i,["resolution"]);e!==void 0&&l!=null&&v(e,["parameters","resolution"],l);const c=m(i,["personGeneration"]);if(e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c),m(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(i,["negativePrompt"]);e!==void 0&&h!=null&&v(e,["parameters","negativePrompt"],h);const f=m(i,["enhancePrompt"]);if(e!==void 0&&f!=null&&v(e,["parameters","enhancePrompt"],f),m(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const g=m(i,["lastFrame"]);e!==void 0&&g!=null&&v(e,["instances[0]","lastFrame"],e_(g));const y=m(i,["referenceImages"]);if(e!==void 0&&y!=null){let b=y;Array.isArray(b)&&(b=b.map(A=>z6(A))),v(e,["instances[0]","referenceImages"],b)}if(m(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function G5(i,e){const t={},n=m(i,["numberOfVideos"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const o=m(i,["fps"]);e!==void 0&&o!=null&&v(e,["parameters","fps"],o);const l=m(i,["durationSeconds"]);e!==void 0&&l!=null&&v(e,["parameters","durationSeconds"],l);const c=m(i,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const h=m(i,["aspectRatio"]);e!==void 0&&h!=null&&v(e,["parameters","aspectRatio"],h);const f=m(i,["resolution"]);e!==void 0&&f!=null&&v(e,["parameters","resolution"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["pubsubTopic"]);e!==void 0&&y!=null&&v(e,["parameters","pubsubTopic"],y);const b=m(i,["negativePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","negativePrompt"],b);const A=m(i,["enhancePrompt"]);e!==void 0&&A!=null&&v(e,["parameters","enhancePrompt"],A);const w=m(i,["generateAudio"]);e!==void 0&&w!=null&&v(e,["parameters","generateAudio"],w);const C=m(i,["lastFrame"]);e!==void 0&&C!=null&&v(e,["instances[0]","lastFrame"],Er(C));const N=m(i,["referenceImages"]);if(e!==void 0&&N!=null){let k=N;Array.isArray(k)&&(k=k.map(L=>V6(L))),v(e,["instances[0]","referenceImages"],k)}const I=m(i,["mask"]);e!==void 0&&I!=null&&v(e,["instances[0]","mask"],G6(I));const P=m(i,["compressionQuality"]);return e!==void 0&&P!=null&&v(e,["parameters","compressionQuality"],P),t}function z5(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],Y5(l)),e}function V5(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],X5(l)),e}function q5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],e_(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],ZD(l));const c=m(e,["source"]);c!=null&&W5(c,t);const h=m(e,["config"]);return h!=null&&H5(h,t),t}function $5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],Er(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],ek(l));const c=m(e,["source"]);c!=null&&K5(c,t);const h=m(e,["config"]);return h!=null&&G5(h,t),t}function Y5(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Q5(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function X5(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Z5(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function W5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],e_(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],ZD(o)),t}function K5(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],Er(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],ek(o)),t}function J5(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],a6(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);return s!=null&&v(e,["safetyAttributes"],JD(s)),e}function Zb(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],KD(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);s!=null&&v(e,["safetyAttributes"],jD(s));const o=m(i,["prompt"]);return o!=null&&v(e,["enhancedPrompt"],o),e}function j5(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["mask"],KD(t));const n=m(i,["labels"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["labels"],s)}return e}function Q5(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],B6(t)),e}function Z5(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],H6(t)),e}function e6(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const C=m(i,["responseSchema"]);C!=null&&v(e,["responseSchema"],C);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const U=m(i,["topK"]);U!=null&&v(e,["topK"],U);const F=m(i,["topP"]);if(F!=null&&v(e,["topP"],F),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function t6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],lt(i,n)),t}function n6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],lt(i,n)),t}function i6(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function s6(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function r6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function o6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);n!=null&&v(e,["imageSize"],n);const s=m(i,["personGeneration"]);s!=null&&v(e,["personGeneration"],s);const o=m(i,["outputMimeType"]);o!=null&&v(e,["imageOutputOptions","mimeType"],o);const l=m(i,["outputCompressionQuality"]);return l!=null&&v(e,["imageOutputOptions","compressionQuality"],l),e}function a6(i){const e={},t=m(i,["bytesBase64Encoded"]);t!=null&&v(e,["imageBytes"],dc(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function KD(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],dc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function e_(i){const e={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(i,["imageBytes"]);t!=null&&v(e,["bytesBase64Encoded"],dc(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function Er(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],dc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function l6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],zD(i,c)),n}function c6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],zD(i,c)),n}function u6(i,e){const t={},n=m(e,["config"]);return n!=null&&l6(i,n,t),t}function d6(i,e){const t={},n=m(e,["config"]);return n!=null&&c6(i,n,t),t}function h6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=VD(s);Array.isArray(o)&&(o=o.map(l=>bE(l))),v(e,["models"],o)}return e}function f6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=VD(s);Array.isArray(o)&&(o=o.map(l=>_E(l))),v(e,["models"],o)}return e}function p6(i){const e={},t=m(i,["maskMode"]);t!=null&&v(e,["maskMode"],t);const n=m(i,["segmentationClasses"]);n!=null&&v(e,["maskClasses"],n);const s=m(i,["maskDilation"]);return s!=null&&v(e,["dilation"],s),e}function bE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["version"]);o!=null&&v(e,["version"],o);const l=m(i,["_self"]);l!=null&&v(e,["tunedModelInfo"],N6(l));const c=m(i,["inputTokenLimit"]);c!=null&&v(e,["inputTokenLimit"],c);const h=m(i,["outputTokenLimit"]);h!=null&&v(e,["outputTokenLimit"],h);const f=m(i,["supportedGenerationMethods"]);f!=null&&v(e,["supportedActions"],f);const g=m(i,["temperature"]);g!=null&&v(e,["temperature"],g);const y=m(i,["maxTemperature"]);y!=null&&v(e,["maxTemperature"],y);const b=m(i,["topP"]);b!=null&&v(e,["topP"],b);const A=m(i,["topK"]);A!=null&&v(e,["topK"],A);const w=m(i,["thinking"]);return w!=null&&v(e,["thinking"],w),e}function _E(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["versionId"]);o!=null&&v(e,["version"],o);const l=m(i,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>x5(b))),v(e,["endpoints"],y)}const c=m(i,["labels"]);c!=null&&v(e,["labels"],c);const h=m(i,["_self"]);h!=null&&v(e,["tunedModelInfo"],M6(h));const f=m(i,["defaultCheckpointId"]);f!=null&&v(e,["defaultCheckpointId"],f);const g=m(i,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(b=>b)),v(e,["checkpoints"],y)}return e}function g6(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],R5(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],I5(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],e5(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function m6(i){const e={},t=m(i,["productImage"]);return t!=null&&v(e,["image"],Er(t)),e}function y6(i,e){const t={},n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["baseSteps"]);e!==void 0&&s!=null&&v(e,["parameters","baseSteps"],s);const o=m(i,["outputGcsUri"]);e!==void 0&&o!=null&&v(e,["parameters","storageUri"],o);const l=m(i,["seed"]);e!==void 0&&l!=null&&v(e,["parameters","seed"],l);const c=m(i,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const h=m(i,["personGeneration"]);e!==void 0&&h!=null&&v(e,["parameters","personGeneration"],h);const f=m(i,["addWatermark"]);e!==void 0&&f!=null&&v(e,["parameters","addWatermark"],f);const g=m(i,["outputMimeType"]);e!==void 0&&g!=null&&v(e,["parameters","outputOptions","mimeType"],g);const y=m(i,["outputCompressionQuality"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","compressionQuality"],y);const b=m(i,["enhancePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","enhancePrompt"],b);const A=m(i,["labels"]);return e!==void 0&&A!=null&&v(e,["labels"],A),t}function v6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["source"]);s!=null&&_6(s,t);const o=m(e,["config"]);return o!=null&&y6(o,t),t}function b6(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>Zb(s))),v(e,["generatedImages"],n)}return e}function _6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["personImage"]);e!==void 0&&s!=null&&v(e,["instances[0]","personImage","image"],Er(s));const o=m(i,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>m6(c))),v(e,["instances[0]","productImages"],l)}return t}function S6(i){const e={},t=m(i,["referenceImage"]);t!=null&&v(e,["referenceImage"],Er(t));const n=m(i,["referenceId"]);n!=null&&v(e,["referenceId"],n);const s=m(i,["referenceType"]);s!=null&&v(e,["referenceType"],s);const o=m(i,["maskImageConfig"]);o!=null&&v(e,["maskImageConfig"],p6(o));const l=m(i,["controlImageConfig"]);l!=null&&v(e,["controlImageConfig"],a5(l));const c=m(i,["styleImageConfig"]);c!=null&&v(e,["styleImageConfig"],c);const h=m(i,["subjectImageConfig"]);return h!=null&&v(e,["subjectImageConfig"],h),e}function JD(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function jD(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function A6(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function E6(i){const e={},t=m(i,["image"]);return t!=null&&v(e,["image"],Er(t)),e}function T6(i,e){const t={},n=m(i,["mode"]);e!==void 0&&n!=null&&v(e,["parameters","mode"],n);const s=m(i,["maxPredictions"]);e!==void 0&&s!=null&&v(e,["parameters","maxPredictions"],s);const o=m(i,["confidenceThreshold"]);e!==void 0&&o!=null&&v(e,["parameters","confidenceThreshold"],o);const l=m(i,["maskDilation"]);e!==void 0&&l!=null&&v(e,["parameters","maskDilation"],l);const c=m(i,["binaryColorThreshold"]);e!==void 0&&c!=null&&v(e,["parameters","binaryColorThreshold"],c);const h=m(i,["labels"]);return e!==void 0&&h!=null&&v(e,["labels"],h),t}function w6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["source"]);s!=null&&x6(s,t);const o=m(e,["config"]);return o!=null&&T6(o,t),t}function C6(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>j5(s))),v(e,["generatedMasks"],n)}return e}function x6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],Er(s));const o=m(i,["scribbleImage"]);return e!==void 0&&o!=null&&v(e,["instances[0]","scribble"],E6(o)),t}function R6(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],N5(n)),e}function I6(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],i6(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],s6(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function QD(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>M5(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function N6(i){const e={},t=m(i,["baseModel"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function M6(i){const e={},t=m(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function D6(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function k6(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function P6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","name"],lt(i,n));const s=m(e,["config"]);return s!=null&&D6(s,t),t}function L6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["config"]);return s!=null&&k6(s,t),t}function O6(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["safetyFilterLevel"]);e!==void 0&&s!=null&&v(e,["parameters","safetySetting"],s);const o=m(i,["personGeneration"]);e!==void 0&&o!=null&&v(e,["parameters","personGeneration"],o);const l=m(i,["includeRaiReason"]);e!==void 0&&l!=null&&v(e,["parameters","includeRaiReason"],l);const c=m(i,["outputMimeType"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","mimeType"],c);const h=m(i,["outputCompressionQuality"]);e!==void 0&&h!=null&&v(e,["parameters","outputOptions","compressionQuality"],h);const f=m(i,["enhanceInputImage"]);e!==void 0&&f!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=m(i,["imagePreservationFactor"]);e!==void 0&&g!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["numberOfImages"]);e!==void 0&&b!=null&&v(e,["parameters","sampleCount"],b);const A=m(i,["mode"]);return e!==void 0&&A!=null&&v(e,["parameters","mode"],A),t}function U6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],lt(i,n));const s=m(e,["image"]);s!=null&&v(t,["instances[0]","image"],Er(s));const o=m(e,["upscaleFactor"]);o!=null&&v(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=m(e,["config"]);return l!=null&&O6(l,t),t}function F6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Zb(o))),v(e,["generatedImages"],s)}return e}function B6(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],dc(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function H6(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],dc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function G6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["_self"],Er(t));const n=m(i,["maskMode"]);return n!=null&&v(e,["maskMode"],n),e}function z6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],e_(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function V6(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],Er(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function ZD(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["encodedVideo"],dc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["encoding"],s),e}function ek(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["bytesBase64Encoded"],dc(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q6(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["displayName"],n),t}function $6(i){const e={},t=m(i,["config"]);return t!=null&&q6(t,e),e}function Y6(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function X6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&Y6(n,e),e}function W6(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function K6(i,e){const t={},n=m(i,["customMetadata"]);if(e!==void 0&&n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["customMetadata"],o)}const s=m(i,["chunkingConfig"]);return e!==void 0&&s!=null&&v(e,["chunkingConfig"],s),t}function J6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],Q6(l)),e}function j6(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["fileName"]);n!=null&&v(e,["fileName"],n);const s=m(i,["config"]);return s!=null&&K6(s,e),e}function Q6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function Z6(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function eG(i){const e={},t=m(i,["config"]);return t!=null&&Z6(t,e),e}function tG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["fileSearchStores"],o)}return e}function tk(i,e){const t={},n=m(i,["mimeType"]);e!==void 0&&n!=null&&v(e,["mimeType"],n);const s=m(i,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const o=m(i,["customMetadata"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>h)),v(e,["customMetadata"],c)}const l=m(i,["chunkingConfig"]);return e!==void 0&&l!=null&&v(e,["chunkingConfig"],l),t}function nG(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["config"]);return n!=null&&tk(n,e),e}function iG(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sG="Content-Type",rG="X-Server-Timeout",oG="User-Agent",SE="x-goog-api-client",aG="1.38.0",lG=`google-genai-sdk/${aG}`,cG="v1beta1",uG="v1beta";class dG{constructor(e){var t,n,s;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:cG}else{if(!this.clientOptions.apiKey)throw new Ug({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:uG,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===gE.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))s.searchParams.append(l,String(c));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))typeof o=="object"?n[s]=Object.assign(Object.assign({},n[s]),o):o!==void 0&&(n[s]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>o.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&hG(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await zN(s),new mE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await zN(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return vr(this,arguments,function*(){var n;const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const c="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:g}=yield Le(s.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const y=o.decode(g,{stream:!0});try{const w=JSON.parse(y);if("error"in w){const C=JSON.parse(JSON.stringify(w.error)),N=C.status,I=C.code,P=`got status: ${N}. ${JSON.stringify(w)}`;if(I>=400&&I<600)throw new Ug({message:P,status:I})}}catch(w){if(w.name==="ApiError")throw w}l+=y;let b=-1,A=0;for(;;){b=-1,A=0;for(const N of h){const I=l.indexOf(N);I!==-1&&(b===-1||I<b)&&(b=I,A=N.length)}if(b===-1)break;const w=l.substring(0,b);l=l.substring(b+A);const C=w.trim();if(C.startsWith(c)){const N=C.substring(c.length).trim();try{const I=new Response(N,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Le(new mE(I))}catch(I){throw new Error(`exception parsing stream chunk ${N}. ${I}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=lG+" "+this.clientOptions.userAgentExtra;return e[oG]=t,e[SE]=t,e[sG]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))n.append(s,o);e.timeout&&e.timeout>0&&n.append(rG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);s.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const h={file:s},f=this.getFileName(e),g=fe("upload/v1beta/files",h._url),y=await this.fetchUploadUrl(g,s.sizeBytes,s.mimeType,f,h,t==null?void 0:t.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,n){var s;const o=this.clientOptions.uploader,l=await o.stat(t),c=String(l.size),h=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(t),y={};n!=null&&tk(n,y);const b=await this.fetchUploadUrl(f,c,h,g,y,n==null?void 0:n.httpOptions);return o.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,s,o,l){var c;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},s?{"X-Goog-Upload-File-Name":s}:{})};const f=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:h});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const g=(c=f==null?void 0:f.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function zN(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new Ug({message:s,status:t}):new Error(s)}}function hG(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const o=JSON.parse(i.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(o,l){const c=Object.assign({},o);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const f=l[h],g=c[h];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[h]=n(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[h]=f)}return c}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fG="mcp_used/unknown";let pG=!1;function nk(i){for(const e of i)if(gG(e)||typeof e=="object"&&"inputSchema"in e)return!0;return pG}function ik(i){var e;const t=(e=i[SE])!==null&&e!==void 0?e:"";i[SE]=(t+` ${fG}`).trimStart()}function gG(i){return i!==null&&typeof i=="object"&&i instanceof Aw}function mG(i){return vr(this,arguments,function*(t,n=100){let s,o=0;for(;o<n;){const l=yield Le(t.listTools({cursor:s}));for(const c of l.tools)yield yield Le(c),o++;if(!l.nextCursor)break;s=l.nextCursor}})}class Aw{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Aw(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const o={},l=[];for(const g of this.mcpClients)try{for(var c=!0,h=(t=void 0,br(mG(g))),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const y=s;l.push(y);const b=y.name;if(o[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);o[b]=g}}catch(y){t={error:y}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),X3(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function yG(i,e,t){const n=new B3;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(n,s),e(n)}class vG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=SG(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(k=>{f=k}),y=e.callbacks,b=function(){f({})},A=this.apiClient,w={onopen:b,onmessage:k=>{yG(A,y.onmessage,k)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(k){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(k){}},C=this.webSocketFactory.create(h,_G(l),w);C.connect(),await g;const P={setup:{model:lt(this.apiClient,e.model)}};return C.send(JSON.stringify(P)),new bG(C,this.apiClient)}}class bG{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=q4(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=V4(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(oh.PLAY)}pause(){this.sendPlaybackControl(oh.PAUSE)}stop(){this.sendPlaybackControl(oh.STOP)}resetContext(){this.sendPlaybackControl(oh.RESET_CONTEXT)}close(){this.conn.close()}}function _G(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function SG(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AG="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function EG(i,e,t){const n=new F3;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const o=JSON.parse(s);if(i.isVertexAI()){const l=X4(o);Object.assign(n,l)}else Object.assign(n,o);e(n)}class TG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new vG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,o,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const y=this.apiClient.getHeaders();e.config&&e.config.tools&&nk(e.config.tools)&&ik(y);const b=RG(y);if(this.apiClient.isVertexAI()){const q=this.apiClient.getProject(),Q=this.apiClient.getLocation(),Z=this.apiClient.getApiKey(),oe=!!q&&!!Q||!!Z;this.apiClient.getCustomBaseUrl()&&!oe?g=h:(g=`${h}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,g))}else{const q=this.apiClient.getApiKey();let Q="BidiGenerateContent",Z="key";q!=null&&q.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Q="BidiGenerateContentConstrained",Z="access_token"),g=`${h}/ws/google.ai.generativelanguage.${f}.GenerativeService.${Q}?${Z}=${q}`}let A=()=>{};const w=new Promise(q=>{A=q}),C=e.callbacks,N=function(){var q;(q=C==null?void 0:C.onopen)===null||q===void 0||q.call(C),A({})},I=this.apiClient,P={onopen:N,onmessage:q=>{EG(I,C.onmessage,q)},onerror:(t=C==null?void 0:C.onerror)!==null&&t!==void 0?t:function(q){},onclose:(n=C==null?void 0:C.onclose)!==null&&n!==void 0?n:function(q){}},k=this.webSocketFactory.create(g,xG(b),P);k.connect(),await w;let L=lt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const q=this.apiClient.getProject(),Q=this.apiClient.getLocation();q&&Q&&(L=`projects/${q}/locations/${Q}/`+L)}let O={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ob.AUDIO]}:e.config.responseModalities=[ob.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const q of U)if(this.isCallableTool(q)){const Q=q;F.push(await Q.tool())}else F.push(q);F.length>0&&(e.config.tools=F);const K={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=z4(this.apiClient,K):O=G4(this.apiClient,K),delete O.config,k.send(JSON.stringify(O)),new CG(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const wG={turnComplete:!0};class CG{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=Ws(t.turns),e.isVertexAI()||(n=n.map(s=>Qb(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const o of n){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(AG)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},wG),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Y4(e)}:t={realtimeInput:$4(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function xG(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function RG(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VN=10;function qN(i){var e,t,n;if(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i==null?void 0:i.tools)!==null&&t!==void 0?t:[])if(mh(l)){s=!0;break}if(!s)return!0;const o=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function mh(i){return"callTool"in i&&typeof i.callTool=="function"}function IG(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>mh(s)))!==null&&n!==void 0?n:!1}function $N(i){var e;const t=[];return!((e=i==null?void 0:i.config)===null||e===void 0)&&e.tools&&i.config.tools.forEach((n,s)=>{if(mh(n))return;const o=n;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(s)}),t}function YN(i){var e;return!(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NG extends Ia{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,o,l,c;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!IG(t)||qN(t.config))return await this.generateContentInternal(h);const f=$N(t);if(f.length>0){const C=f.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${C}.`)}let g,y;const b=Ws(h.contents),A=(o=(s=(n=h.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:VN;let w=0;for(;w<A&&(g=await this.generateContentInternal(h),!(!g.functionCalls||g.functionCalls.length===0));){const C=g.candidates[0].content,N=[];for(const I of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(mh(I)){const k=await I.callTool(g.functionCalls);N.push(...k)}w++,y={role:"user",parts:N},h.contents=Ws(h.contents),h.contents.push(C),h.contents.push(y),YN(h.config)&&(b.push(C),b.push(y))}return YN(h.config)&&(g.automaticFunctionCallingHistory=b),g},this.generateContentStream=async t=>{var n,s,o,l,c;if(this.maybeMoveToResponseJsonSchem(t),qN(t.config)){const y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}const h=$N(t);if(h.length>0){const y=h.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(s=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,g=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(f&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let o;const l=[];if(n!=null&&n.generatedImages)for(const h of n.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((s=h==null?void 0:h.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=h==null?void 0:h.safetyAttributes:l.push(h);let c;return o?c={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ad(Sa.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var n,s,o,l,c,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((h=(c=t.source)===null||c===void 0?void 0:c.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async h=>mh(h)?await h.tool():h)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&nk(e.config.tools)){const h=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let f=Object.assign({},h);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),ik(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var t,n,s;const o=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(mh(l)){const c=l,h=await c.tool();for(const f of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,c)}}return o}async processAfcStream(e){var t,n,s;const o=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:VN;let l=!1,c=0;const h=await this.initAfcToolsMap(e);return(function(f,g,y){return vr(this,arguments,function*(){for(var b,A,w,C,N,I;c<o;){l&&(c++,l=!1);const O=yield Le(f.processParamsMaybeAddMcpUsage(y)),U=yield Le(f.generateContentStreamInternal(O)),F=[],K=[];try{for(var P=!0,k=(A=void 0,br(U)),L;L=yield Le(k.next()),b=L.done,!b;P=!0){C=L.value,P=!1;const q=C;if(yield yield Le(q),q.candidates&&(!((N=q.candidates[0])===null||N===void 0)&&N.content)){K.push(q.candidates[0].content);for(const Q of(I=q.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(c<o&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Q.functionCall.name)){const Z=yield Le(g.get(Q.functionCall.name).callTool([Q.functionCall]));F.push(...Z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(q){A={error:q}}finally{try{!P&&!b&&(w=k.return)&&(yield Le(w.call(k)))}finally{if(A)throw A.error}}if(F.length>0){l=!0;const q=new ig;q.candidates=[{content:{role:"user",parts:F}}],yield yield Le(q);const Q=[];Q.push(...K),Q.push({role:"user",parts:F});const Z=Ws(y.contents).concat(Q);y.contents=Z}else break}})})(this,h,e)}async generateContentInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=BN(this.apiClient,e);return c=fe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=GN(g),b=new ig;return Object.assign(b,y),b})}else{const f=FN(this.apiClient,e);return c=fe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=HN(g),b=new ig;return Object.assign(b,y),b})}}async generateContentStreamInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=BN(this.apiClient,e);return c=fe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(y){return vr(this,arguments,function*(){var b,A,w,C;try{for(var N=!0,I=br(y),P;P=yield Le(I.next()),b=P.done,!b;N=!0){C=P.value,N=!1;const k=C,L=GN(yield Le(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new ig;Object.assign(O,L),yield yield Le(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Le(w.call(I)))}finally{if(A)throw A.error}}})})}else{const f=FN(this.apiClient,e);return c=fe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(y){return vr(this,arguments,function*(){var b,A,w,C;try{for(var N=!0,I=br(y),P;P=yield Le(I.next()),b=P.done,!b;N=!0){C=P.value,N=!1;const k=C,L=HN(yield Le(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new ig;Object.assign(O,L),yield yield Le(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Le(w.call(I)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=T5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=C5(g),b=new SN;return Object.assign(b,y),b})}else{const f=E5(this.apiClient,e);return c=fe("{model}:batchEmbedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=w5(g),b=new SN;return Object.assign(b,y),b})}}async generateImagesInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=U5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=B5(g),b=new AN;return Object.assign(b,y),b})}else{const f=O5(this.apiClient,e);return c=fe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=F5(g),b=new AN;return Object.assign(b,y),b})}}async editImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=b5(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=_5(h),g=new x3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=U6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=F6(h),g=new R3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=v6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=b6(h),g=new I3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=w6(this.apiClient,e);return o=fe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=C6(h),g=new N3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=n6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>_E(g))}else{const f=t6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>bE(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=d6(this.apiClient,e);return c=fe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=f6(g),b=new EN;return Object.assign(b,y),b})}else{const f=u6(this.apiClient,e);return c=fe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=h6(g),b=new EN;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=L6(this.apiClient,e);return c=fe("{model}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>_E(g))}else{const f=P6(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>bE(g))}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=g5(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=y5(g),b=new TN;return Object.assign(b,y),b})}else{const f=p5(this.apiClient,e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=m5(g),b=new TN;return Object.assign(b,y),b})}}async countTokens(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=d5(this.apiClient,e);return c=fe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=f5(g),b=new wN;return Object.assign(b,y),b})}else{const f=u5(this.apiClient,e);return c=fe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=h5(g),b=new wN;return Object.assign(b,y),b})}}async computeTokens(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=i5(this.apiClient,e);return o=fe("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=s5(h),g=new M3;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=$5(this.apiClient,e);return c=fe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const y=V5(g),b=new ab;return Object.assign(b,y),b})}else{const f=q5(this.apiClient,e);return c=fe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>{const y=z5(g),b=new ab;return Object.assign(b,y),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MG extends Ia{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=S3(e);return c=fe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l}else{const f=_3(e);return c=fe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=f3(e);return o=fe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DG(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function kG(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>zG(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function PG(i,e,t){const n={},s=m(e,["expireTime"]);t!==void 0&&s!=null&&v(t,["expireTime"],s);const o=m(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&v(t,["newSessionExpireTime"],o);const l=m(e,["uses"]);t!==void 0&&l!=null&&v(t,["uses"],l);const c=m(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&v(t,["bidiGenerateContentSetup"],GG(i,c));const h=m(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&v(t,["fieldMask"],h),n}function LG(i,e){const t={},n=m(e,["config"]);return n!=null&&v(t,["config"],PG(i,n,t)),t}function OG(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function UG(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function FG(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function BG(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function HG(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],Sw(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],kG(ri(w)));const C=m(i,["tools"]);if(e!==void 0&&C!=null){let U=np(C);Array.isArray(U)&&(U=U.map(F=>qG(tp(F)))),v(e,["setup","tools"],U)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],VG(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function GG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],lt(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],HG(s,t)),t}function zG(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],OG(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],UG(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],DG(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function VG(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function qG(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],FG(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],BG(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $G(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(o=>`${t}.${o}`);e.push(...s)}else e.push(t)}return e.join(",")}function YG(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const o=n.setup;typeof o=="object"&&o!==null?(i.bidiGenerateContentSetup=o,t=o):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const o=$G(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?i.fieldMask=o:delete i.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(f=>l.includes(f)?`generationConfig.${f}`:f));const h=[];o&&h.push(o),c.length>0&&h.push(...c),h.length>0?i.fieldMask=h.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class XG extends Ia{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=LG(this.apiClient,e);o=fe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=YG(c,e.config);return s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WG(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function KG(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&WG(n,e),e}function JG(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function jG(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function QG(i){const e={},t=m(i,["parent"]);t!=null&&v(e,["_url","parent"],t);const n=m(i,["config"]);return n!=null&&jG(n,e),e}function ZG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ez extends Ia{constructor(e){super(),this.apiClient=e,this.list=async t=>new ad(Sa.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=JG(e);return o=fe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KG(e);s=fe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=QG(e);return o=fe("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=ZG(h),g=new D3;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tz extends Ia{constructor(e,t=new ez(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new ad(Sa.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=$6(e);return o=fe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=W6(e);return o=fe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=X6(e);s=fe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=eG(e);return o=fe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=tG(h),g=new k3;return Object.assign(g,f),g})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=nG(e);return o=fe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=iG(h),g=new P3;return Object.assign(g,f),g})}}async importFile(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=j6(e);return o=fe("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=J6(h),g=new mw;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sk=function(){const{crypto:i}=globalThis;if(i!=null&&i.randomUUID)return sk=i.randomUUID.bind(i),i.randomUUID();const e=new Uint8Array(1),t=i?()=>i.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const nz=()=>sk();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AE(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const EE=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const e=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(e.stack=i.stack),i.cause&&!e.cause&&(e.cause=i.cause),i.name&&(e.name=i.name),e}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Js extends Error{}class yi extends Js{constructor(e,t,n,s){super(`${yi.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new t_({message:n,cause:EE(t)});const o=t;return e===400?new ok(e,o,n,s):e===401?new ak(e,o,n,s):e===403?new lk(e,o,n,s):e===404?new ck(e,o,n,s):e===409?new uk(e,o,n,s):e===422?new dk(e,o,n,s):e===429?new hk(e,o,n,s):e>=500?new fk(e,o,n,s):new yi(e,o,n,s)}}class TE extends yi{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class t_ extends yi{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class rk extends t_{constructor({message:e}={}){super({message:e??"Request timed out."})}}class ok extends yi{}class ak extends yi{}class lk extends yi{}class ck extends yi{}class uk extends yi{}class dk extends yi{}class hk extends yi{}class fk extends yi{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iz=/^[a-z][a-z0-9+.-]*:/i,sz=i=>iz.test(i);let wE=i=>(wE=Array.isArray,wE(i));const rz=wE;let oz=rz;const XN=oz;function az(i){if(!i)return!0;for(const e in i)return!1;return!0}function lz(i,e){return Object.prototype.hasOwnProperty.call(i,e)}const cz=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Js(`${i} must be an integer`);if(e<0)throw new Js(`${i} must be a positive integer`);return e},uz=i=>{try{return JSON.parse(i)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dz=i=>new Promise(e=>setTimeout(e,i));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jd="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hz(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const fz=()=>{var i,e,t,n,s;const o=hz();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":KN(Deno.build.os),"X-Stainless-Arch":WN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(i=Deno.version)===null||i===void 0?void 0:i.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":KN((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":WN((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=pz();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":jd,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function pz(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,o=n[2]||0,l=n[3]||0;return{browser:e,version:`${s}.${o}.${l}`}}}return null}const WN=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",KN=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let rv;const gz=()=>rv??(rv=fz());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mz(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function pk(...i){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...i)}function yz(i){let e=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return pk({start(){},async pull(t){const{done:n,value:s}=await e.next();n?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function gk(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function vz(i){var e,t;if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await((t=(e=i[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=i.getReader(),s=n.cancel();n.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bz=({headers:i,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mk=()=>{var i;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((i=e==null?void 0:e.versions)===null||i===void 0?void 0:i.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function GA(i,e,t){return mk(),new File(i,e??"unknown_file",t)}function _z(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const Sz=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yk=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",Az=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&yk(i),Ez=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function Tz(i,e,t){if(mk(),i=await i,Az(i))return i instanceof File?i:GA([await i.arrayBuffer()],i.name);if(Ez(i)){const s=await i.blob();return e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()),GA(await CE(s),e,t)}const n=await CE(i);if(e||(e=_z(i)),!(t!=null&&t.type)){const s=n.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return GA(n,e,t)}async function CE(i){var e,t,n,s,o;let l=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)l.push(i);else if(yk(i))l.push(i instanceof Blob?i:await i.arrayBuffer());else if(Sz(i))try{for(var c=!0,h=br(i),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const g=s;l.push(...await CE(g))}}catch(g){t={error:g}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}else{const g=(o=i==null?void 0:i.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof i}${g?`; constructor: ${g}`:""}${wz(i)}`)}return l}function wz(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vk{constructor(e){this._client=e}}vk._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bk(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const JN=Object.freeze(Object.create(null)),Cz=(i=bk)=>(function(t,...n){if(t.length===1)return t[0];let s=!1;const o=[],l=t.reduce((g,y,b)=>{var A,w,C;/[?#]/.test(y)&&(s=!0);const N=n[b];let I=(s?encodeURIComponent:i)(""+N);return b!==n.length&&(N==null||typeof N=="object"&&N.toString===((C=Object.getPrototypeOf((w=Object.getPrototypeOf((A=N.hasOwnProperty)!==null&&A!==void 0?A:JN))!==null&&w!==void 0?w:JN))===null||C===void 0?void 0:C.toString))&&(I=N+"",o.push({start:g.length+y.length,length:I.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),g+y+(b===n.length?"":I)},""),c=l.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=h.exec(c))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((g,y)=>g.start-y.start),o.length>0){let g=0;const y=o.reduce((b,A)=>{const w=" ".repeat(A.start-g),C="^".repeat(A.length);return g=A.start+A.length,b+w+C},"");throw new Js(`Path parameters result in path with invalid segments:
${o.map(b=>b.error).join(`
`)}
${l}
${y}`)}return l}),ov=Cz(bk);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _k extends vk{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,o=cb(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new Js("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new Js("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(ov`/${s}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(ov`/${s}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(ov`/${s}/interactions/${e}/cancel`,n)}get(e,t={},n){var s;const o=t??{},{api_version:l=this._client.apiVersion}=o,c=cb(o,["api_version"]);return this._client.get(ov`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}_k._key=Object.freeze(["interactions"]);class Sk extends _k{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xz(i){let e=0;for(const s of i)e+=s.length;const t=new Uint8Array(e);let n=0;for(const s of i)t.set(s,n),n+=s.length;return t}let av;function Ew(i){let e;return(av??(e=new globalThis.TextEncoder,av=e.encode.bind(e)))(i)}let lv;function jN(i){let e;return(lv??(e=new globalThis.TextDecoder,lv=e.decode.bind(e)))(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class n_{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Ew(e):e;this.buffer=xz([this.buffer,t]);const n=[];let s;for(;(s=Rz(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(jN(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=jN(this.buffer.subarray(0,o));n.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}n_.NEWLINE_CHARS=new Set([`
`,"\r"]);n_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Rz(i,e){for(let s=e??0;s<i.length;s++){if(i[s]===10)return{preceding:s,index:s+1,carriage:!1};if(i[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Iz(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ub={off:0,error:200,warn:300,info:400,debug:500},QN=(i,e,t)=>{if(i){if(lz(ub,i))return i;hi(t).warn(`${e} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(ub))}`)}};function cg(){}function cv(i,e,t){return!e||ub[i]>ub[t]?cg:e[i].bind(e)}const Nz={error:cg,warn:cg,info:cg,debug:cg};let ZN=new WeakMap;function hi(i){var e;const t=i.logger,n=(e=i.logLevel)!==null&&e!==void 0?e:"off";if(!t)return Nz;const s=ZN.get(t);if(s&&s[0]===n)return s[1];const o={error:cv("error",t,n),warn:cv("warn",t,n),info:cv("info",t,n),debug:cv("debug",t,n)};return ZN.set(t,[n,o]),o}const kc=i=>(i.options&&(i.options=Object.assign({},i.options),delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ah{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const o=n?hi(n):console;function l(){return vr(this,arguments,function*(){var h,f,g,y;if(s)throw new Js("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=br(Mz(e,t)),C;C=yield Le(w.next()),h=C.done,!h;A=!0){y=C.value,A=!1;const N=y;if(!b)if(N.data.startsWith("[DONE]")){b=!0;continue}else try{yield yield Le(JSON.parse(N.data))}catch(I){throw o.error("Could not parse message into JSON:",N.data),o.error("From chunk:",N.raw),I}}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Le(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(AE(N))return yield Le(void 0);throw N}finally{b||t.abort()}})}return new ah(l,t,n)}static fromReadableStream(e,t,n){let s=!1;function o(){return vr(this,arguments,function*(){var h,f,g,y;const b=new n_,A=gk(e);try{for(var w=!0,C=br(A),N;N=yield Le(C.next()),h=N.done,!h;w=!0){y=N.value,w=!1;const I=y;for(const P of b.decode(I))yield yield Le(P)}}catch(I){f={error:I}}finally{try{!w&&!h&&(g=C.return)&&(yield Le(g.call(C)))}finally{if(f)throw f.error}}for(const I of b.flush())yield yield Le(I)})}function l(){return vr(this,arguments,function*(){var h,f,g,y;if(s)throw new Js("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=br(o()),C;C=yield Le(w.next()),h=C.done,!h;A=!0){y=C.value,A=!1;const N=y;b||N&&(yield yield Le(JSON.parse(N)))}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Le(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(AE(N))return yield Le(void 0);throw N}finally{b||t.abort()}})}return new ah(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){const l=n.next();e.push(l),t.push(l)}return o.shift()}});return[new ah(()=>s(e),this.controller,this.client),new ah(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return pk({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:o}=await t.next();if(o)return n.close();const l=Ew(JSON.stringify(s)+`
`);n.enqueue(l)}catch(s){n.error(s)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function Mz(i,e){return vr(this,arguments,function*(){var n,s,o,l;if(!i.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Js("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Js("Attempted to iterate over a response with no body");const c=new kz,h=new n_,f=gk(i.body);try{for(var g=!0,y=br(Dz(f)),b;b=yield Le(y.next()),n=b.done,!n;g=!0){l=b.value,g=!1;const A=l;for(const w of h.decode(A)){const C=c.decode(w);C&&(yield yield Le(C))}}}catch(A){s={error:A}}finally{try{!g&&!n&&(o=y.return)&&(yield Le(o.call(y)))}finally{if(s)throw s.error}}for(const A of h.flush()){const w=c.decode(A);w&&(yield yield Le(w))}})}function Dz(i){return vr(this,arguments,function*(){var t,n,s,o;let l=new Uint8Array;try{for(var c=!0,h=br(i),f;f=yield Le(h.next()),t=f.done,!t;c=!0){o=f.value,c=!1;const g=o;if(g==null)continue;const y=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?Ew(g):g;let b=new Uint8Array(l.length+y.length);b.set(l),b.set(y,l.length),l=b;let A;for(;(A=Iz(l))!==-1;)yield yield Le(l.slice(0,A)),l=l.slice(A)}}catch(g){n={error:g}}finally{try{!c&&!t&&(s=h.return)&&(yield Le(s.call(h)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Le(l))})}class kz{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=Pz(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function Pz(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Lz(i,e){const{response:t,requestLogID:n,retryOfRequestLogID:s,startTime:o}=e,l=await(async()=>{var c;if(e.options.stream)return hi(i).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,i):ah.fromSSEResponse(t,e.controller,i);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type"),f=(c=h==null?void 0:h.split(";")[0])===null||c===void 0?void 0:c.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await t.json():await t.text()})();return hi(i).debug(`[${n}] response parsed`,kc({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-o})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tw extends Promise{constructor(e,t,n=Lz){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new Tw(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ak=Symbol("brand.privateNullableHeaders");function*Oz(i){if(!i)return;if(Ak in i){const{values:n,nulls:s}=i;yield*n.entries();for(const o of s)yield[o,null];return}let e=!1,t;i instanceof Headers?t=i.entries():XN(i)?t=i:(e=!0,t=Object.entries(i??{}));for(let n of t){const s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=XN(n[1])?n[1]:[n[1]];let l=!1;for(const c of o)c!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,c])}}const sg=i=>{const e=new Headers,t=new Set;for(const n of i){const s=new Set;for(const[o,l]of Oz(n)){const c=o.toLowerCase();s.has(c)||(e.delete(o),s.add(c)),l===null?(e.delete(o),t.add(c)):(e.append(o,l),t.delete(c))}}return{[Ak]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zA=i=>{var e,t,n,s,o,l;if(typeof globalThis.process<"u")return(n=(t=(e=a3)===null||e===void 0?void 0:e[i])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||o===void 0?void 0:o.call(s,i))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ek;class i_{constructor(e){var t,n,s,o,l,c,h,{baseURL:f=zA("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:g=(t=zA("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:y="v1beta"}=e,b=cb(e,["baseURL","apiKey","apiVersion"]);const A=Object.assign(Object.assign({apiKey:g,apiVersion:y},b),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=A.baseURL,this.timeout=(n=A.timeout)!==null&&n!==void 0?n:i_.DEFAULT_TIMEOUT,this.logger=(s=A.logger)!==null&&s!==void 0?s:console;const w="warn";this.logLevel=w,this.logLevel=(l=(o=QN(A.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:QN(zA("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:w,this.fetchOptions=A.fetchOptions,this.maxRetries=(c=A.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(h=A.fetch)!==null&&h!==void 0?h:mz(),this.encoder=bz,this._options=A,this.apiKey=g,this.apiVersion=y,this.clientAdapter=A.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=sg([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return sg([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return sg([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new Js(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${jd}`}defaultIdempotencyKey(){return`stainless-node-retry-${nz()}`}makeStatusError(e,t,n,s){return yi.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,o=sz(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return az(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new Tw(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,o,l;const c=await e,h=(s=c.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=h),await this.prepareOptions(c);const{req:f,url:g,timeout:y}=await this.buildRequest(c,{retryCount:h-t});await this.prepareRequest(f,{url:g,options:c});const b="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),A=n===void 0?"":`, retryOf: ${n}`,w=Date.now();if(hi(this).debug(`[${b}] sending request`,kc({retryOfRequestLogID:n,method:c.method,url:g,options:c,headers:f.headers})),!((o=c.signal)===null||o===void 0)&&o.aborted)throw new TE;const C=new AbortController,N=await this.fetchWithTimeout(g,f,y,C).catch(EE),I=Date.now();if(N instanceof globalThis.Error){const k=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new TE;const L=AE(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return hi(this).info(`[${b}] connection ${L?"timed out":"failed"} - ${k}`),hi(this).debug(`[${b}] connection ${L?"timed out":"failed"} (${k})`,kc({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),this.retryRequest(c,t,n??b);throw hi(this).info(`[${b}] connection ${L?"timed out":"failed"} - error; no more retries left`),hi(this).debug(`[${b}] connection ${L?"timed out":"failed"} (error; no more retries left)`,kc({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),L?new rk:new t_({cause:N})}const P=`[${b}${A}] ${f.method} ${g} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${I-w}ms`;if(!N.ok){const k=await this.shouldRetry(N);if(t&&k){const q=`retrying, ${t} attempts remaining`;return await vz(N.body),hi(this).info(`${P} - ${q}`),hi(this).debug(`[${b}] response error (${q})`,kc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),this.retryRequest(c,t,n??b,N.headers)}const L=k?"error; no more retries left":"error; not retryable";hi(this).info(`${P} - ${L}`);const O=await N.text().catch(q=>EE(q).message),U=uz(O),F=U?void 0:O;throw hi(this).debug(`[${b}] response error (${L})`,kc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,message:F,durationMs:Date.now()-w})),this.makeStatusError(N.status,U,F,N.headers)}return hi(this).info(P),hi(this).debug(`[${b}] response start`,kc({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),{response:N,options:c,controller:C,requestLogID:b,retryOfRequestLogID:n,startTime:w}}async fetchWithTimeout(e,t,n,s){const o=t||{},{signal:l,method:c}=o,h=cb(o,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const f=setTimeout(()=>s.abort(),n),g=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,y=Object.assign(Object.assign(Object.assign({signal:s.signal},g?{duplex:"half"}:{}),{method:"GET"}),h);c&&(y.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,y)}finally{clearTimeout(f)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,s){var o;let l;const c=s==null?void 0:s.get("retry-after-ms");if(c){const f=parseFloat(c);Number.isNaN(f)||(l=f)}const h=s==null?void 0:s.get("retry-after");if(h&&!l){const f=parseFloat(h);Number.isNaN(f)?l=Date.parse(h)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,f)}return await dz(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,s,o;const l=Object.assign({},e),{method:c,path:h,query:f,defaultBaseURL:g}=l,y=this.buildURL(h,f,g);"timeout"in l&&cz("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:b,body:A}=this.buildBody({options:l}),w=await this.buildHeaders({options:e,method:c,bodyHeaders:b,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:w},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&A instanceof globalThis.ReadableStream&&{duplex:"half"}),A&&{body:A}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:y,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=sg([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),gz()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=sg([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:yz(e)}:this.encoder({body:e,headers:n})}}i_.DEFAULT_TIMEOUT=6e4;class kn extends i_{constructor(){super(...arguments),this.interactions=new Sk(this)}}Ek=kn;kn.GeminiNextGenAPIClient=Ek;kn.GeminiNextGenAPIClientError=Js;kn.APIError=yi;kn.APIConnectionError=t_;kn.APIConnectionTimeoutError=rk;kn.APIUserAbortError=TE;kn.NotFoundError=ck;kn.ConflictError=uk;kn.RateLimitError=hk;kn.BadRequestError=ok;kn.AuthenticationError=ak;kn.InternalServerError=fk;kn.PermissionDeniedError=lk;kn.UnprocessableEntityError=dk;kn.toFile=Tz;kn.Interactions=Sk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Fz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Bz(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function Hz(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function Gz(i,e,t){const n={};if(m(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(i,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&v(e,["displayName"],s),m(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=m(i,["epochCount"]);e!==void 0&&o!=null&&v(e,["tuningTask","hyperparameters","epochCount"],o);const l=m(i,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=m(i,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const h=m(i,["learningRate"]);if(e!==void 0&&h!=null&&v(e,["tuningTask","hyperparameters","learningRate"],h),m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function zz(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec"],eM(A))}else if(s==="PREFERENCE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec"],eM(A))}const o=m(i,["tunedModelDisplayName"]);e!==void 0&&o!=null&&v(e,["tunedModelDisplayName"],o);const l=m(i,["description"]);e!==void 0&&l!=null&&v(e,["description"],l);let c=m(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],A)}else if(c==="PREFERENCE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],A)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],A)}else if(h==="PREFERENCE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],A)}let f=m(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],A)}else if(f==="PREFERENCE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],A)}let g=m(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],A)}else if(g==="PREFERENCE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],A)}if(m(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["beta"]);return e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),n}function Vz(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&eV(o);const l=m(i,["config"]);return l!=null&&Gz(l,t),t}function qz(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&tV(o,t,e);const l=m(i,["config"]);return l!=null&&zz(l,t,e),t}function $z(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Yz(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function Xz(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function Wz(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function Kz(i,e){const t={},n=m(i,["config"]);return n!=null&&Xz(n,t),t}function Jz(i,e){const t={},n=m(i,["config"]);return n!=null&&Wz(n,t),t}function jz(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>Tk(c))),v(t,["tuningJobs"],l)}return t}function Qz(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>xE(c))),v(t,["tuningJobs"],l)}return t}function Zz(i,e){const t={},n=m(i,["name"]);n!=null&&v(t,["model"],n);const s=m(i,["name"]);return s!=null&&v(t,["endpoint"],s),t}function eV(i,e){const t={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(i,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(t,["examples","examples"],s)}return t}function tV(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=m(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(m(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Tk(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],HD(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["tuningTask","startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["tuningTask","completeTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["description"]);g!=null&&v(t,["description"],g);const y=m(i,["baseModel"]);y!=null&&v(t,["baseModel"],y);const b=m(i,["_self"]);return b!=null&&v(t,["tunedModel"],Zz(b)),t}function xE(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],HD(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["error"]);g!=null&&v(t,["error"],g);const y=m(i,["description"]);y!=null&&v(t,["description"],y);const b=m(i,["baseModel"]);b!=null&&v(t,["baseModel"],b);const A=m(i,["tunedModel"]);A!=null&&v(t,["tunedModel"],A);const w=m(i,["preTunedModel"]);w!=null&&v(t,["preTunedModel"],w);const C=m(i,["supervisedTuningSpec"]);C!=null&&v(t,["supervisedTuningSpec"],C);const N=m(i,["preferenceOptimizationSpec"]);N!=null&&v(t,["preferenceOptimizationSpec"],N);const I=m(i,["tuningDataStats"]);I!=null&&v(t,["tuningDataStats"],I);const P=m(i,["encryptionSpec"]);P!=null&&v(t,["encryptionSpec"],P);const k=m(i,["partnerModelTuningSpec"]);k!=null&&v(t,["partnerModelTuningSpec"],k);const L=m(i,["customBaseModel"]);L!=null&&v(t,["customBaseModel"],L);const O=m(i,["experiment"]);O!=null&&v(t,["experiment"],O);const U=m(i,["labels"]);U!=null&&v(t,["labels"],U);const F=m(i,["outputUri"]);F!=null&&v(t,["outputUri"],F);const K=m(i,["pipelineJob"]);K!=null&&v(t,["pipelineJob"],K);const q=m(i,["serviceAccount"]);q!=null&&v(t,["serviceAccount"],q);const Q=m(i,["tunedModelDisplayName"]);Q!=null&&v(t,["tunedModelDisplayName"],Q);const Z=m(i,["veoTuningSpec"]);return Z!=null&&v(t,["veoTuningSpec"],Z),t}function nV(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(i,["done"]);l!=null&&v(t,["done"],l);const c=m(i,["error"]);return c!=null&&v(t,["error"],c),t}function eM(i,e){const t={},n=m(i,["gcsUri"]);n!=null&&v(t,["validationDatasetUri"],n);const s=m(i,["vertexDatasetResource"]);return s!=null&&v(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iV extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ad(Sa.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),o=await this.tuneMldevInternal(s);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:pE.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Yz(e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>xE(g))}else{const f=$z(e);return c=fe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>Tk(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Jz(e);return c=fe("tuningJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Qz(g),b=new CN;return Object.assign(b,y),b})}else{const f=Kz(e);return c=fe("tunedModels",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=jz(g),b=new CN;return Object.assign(b,y),b})}}async cancel(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=Fz(e);return c=fe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Hz(g),b=new xN;return Object.assign(b,y),b})}else{const f=Uz(e);return c=fe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Bz(g),b=new xN;return Object.assign(b,y),b})}}async tuneInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=qz(e,e);return o=fe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>xE(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Vz(e);return o=fe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>nV(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sV{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const rV=1024*1024*8,oV=3,aV=1e3,lV=2,db="x-goog-upload-status";async function cV(i,e,t){var n;const s=await wk(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[db])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function uV(i,e,t){var n;const s=await wk(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[db])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=PD(o),c=new yw;return Object.assign(c,l),c}async function wk(i,e,t){var n,s;let o=0,l=0,c=new mE(new Response),h="upload";for(o=i.size;l<o;){const f=Math.min(rV,o-l),g=i.slice(l,l+f);l+f>=o&&(h+=", finalize");let y=0,b=aV;for(;y<oV&&(c=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[db]));)y++,await hV(b),b=b*lV;if(l+=f,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[db])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function dV(i){return{size:i.size,type:i.type}}function hV(i){return new Promise(e=>setTimeout(e,i))}class fV{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cV(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uV(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dV(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pV{create(e,t,n){return new gV(e,t,n)}}class gV{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tM="x-goog-api-key";class mV{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(tM)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(tM,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yV="gl-node/";class vV{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new kn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=d3(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new mV(this.apiKey);this.apiClient=new dG({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:yV+"web",uploader:new fV,downloader:new sV}),this.models=new NG(this.apiClient),this.live=new TG(this.apiClient,s,new pV),this.batches=new HH(this.apiClient),this.chats=new S4(this.models,this.apiClient),this.caches=new v4(this.apiClient),this.files=new M4(this.apiClient),this.operations=new MG(this.apiClient),this.authTokens=new XG(this.apiClient),this.tunings=new iV(this.apiClient),this.fileSearchStores=new tz(this.apiClient)}}var bV={};const _V="https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.3",nM=bV.HF_TOKEN,hc=async(i,e)=>{var s;if(!nM)throw new Error("No Fallback Key");const t=await fetch(_V,{method:"POST",headers:{Authorization:`Bearer ${nM}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:`<s>[INST] ${i} 

 ${e} [/INST]`,parameters:{max_new_tokens:1024,temperature:.7,return_full_text:!1}})});if(!t.ok)throw new Error("Fallback API Failed");return((s=(await t.json())[0])==null?void 0:s.generated_text)||""},Ck=i=>{try{const e=i.match(/\[.*\]/s)||i.match(/\{.*\}/s);return e?JSON.parse(e[0]):null}catch{return null}},SV=async i=>{try{const t=await hc("You are a book search engine. Return a JSON array of 5 books matching the query. properties: title, author, description, publishedYear, coverColor (hex), isbn (13 digit).",`Search for: ${i}`),n=Ck(t);if(n&&Array.isArray(n))return n.map((s,o)=>({...s,id:`fallback-${Date.now()}-${o}`,categories:s.categories||["General"],isLocal:!1}));throw new Error("Parse failed")}catch{return[{id:"offline-1",title:"The Offline Library",author:"System Backup",description:"We could not reach our AI services, but here is a classic placeholder.",publishedYear:"2024",categories:["System"],coverColor:"#e2e8f0",isbn:"9780141439518",isLocal:!1}]}},AV=async(i,e)=>{try{const n=await hc("You are a helpful book concierge named Suitcase (Backup Mode). Reply kindly. If asked for books, provide a JSON object with 'reply' (string) and 'suggestions' (array of books with title, author, isbn).",i),s=Ck(n);return s&&s.reply?{reply:s.reply,suggestions:Array.isArray(s.suggestions)?s.suggestions.map((o,l)=>({...o,id:`fb-con-${l}`,coverColor:"#cbd5e1",isLocal:!1,categories:[]})):[]}:{reply:n,suggestions:[]}}catch{return{reply:"I'm having trouble connecting to the cloud, but I'm here listening.",suggestions:[]}}},EV=async i=>[{id:"off-1",title:"The Great Gatsby",author:"F. Scott Fitzgerald",description:"A classic of the Jazz Age.",publishedYear:"1925",categories:["Classic"],coverColor:"#fef3c7",isbn:"9780743273565",matchReason:"Timeless classic",isLocal:!1},{id:"off-2",title:"1984",author:"George Orwell",description:"Dystopian social science fiction.",publishedYear:"1949",categories:["Sci-Fi"],coverColor:"#f3f4f6",isbn:"9780451524935",matchReason:"Essential reading",isLocal:!1},{id:"off-3",title:"Dune",author:"Frank Herbert",description:"Epic science fiction.",publishedYear:"1965",categories:["Sci-Fi"],coverColor:"#fed7aa",isbn:"9780441013593",matchReason:"Masterpiece",isLocal:!1},{id:"off-4",title:"Sapiens",author:"Yuval Noah Harari",description:"A brief history of humankind.",publishedYear:"2011",categories:["History"],coverColor:"#e0f2fe",isbn:"9780062316097",matchReason:"Thought provoking",isLocal:!1}],TV=async(i,e)=>[{id:"rev-1",reviewerName:"Offline Reader",rating:5,text:"This book is a masterpiece!",date:"Today",avatarColor:"#3b82f6"},{id:"rev-2",reviewerName:"Bookworm",rating:4,text:"Really enjoyed the plot twists.",date:"Yesterday",avatarColor:"#ef4444"}],wV=async(i,e,t)=>{try{const n=`You are a literary assistant discussing "${i}". Keep answers short.`;return await hc(n,e)}catch{return"I can't analyze this book right now due to connection issues."}},CV=async i=>{try{return await hc("Translate the following text to English.",i)}catch{return"Translation service unavailable."}},xV=async(i,e)=>{try{const t=`Explain the context of this text from "${e}".`;return await hc(t,i)}catch{return"Context service unavailable."}},RV=async(i,e,t=1)=>{try{const n=`Write Chapter ${t} of "${i}" by ${e}. HTML format <p>.`;return await hc(n,"Generate chapter content.")||"<p>Content generation failed.</p>"}catch{return`
            <h3>Chapter ${t}</h3>
            <p>We are currently unable to generate the full text for <strong>${i}</strong> due to high demand on our AI services.</p>
            <p>Please try again later or upload a local PDF copy of this book to continue reading.</p>
        `}},IV=async i=>{try{return await hc(`Summarize "${i}".`,"Summary:")}catch{return"Summary unavailable offline."}},NV=async i=>{try{return await hc(`Recap the plot of "${i}".`,"Recap:")}catch{return"Recap unavailable offline."}},ao=new vV({apiKey:"AIzaSyDKkxTYId1SXW4k0skhK-P6x2CY62MWRmc"}),lo="gemini-2.5-flash",s_=i=>{if(!i)return[];try{return JSON.parse(i)}catch{const t=i.replace(/```json\n?|```/g,"").trim();try{return JSON.parse(t)}catch(n){return console.error("Failed to parse Gemini JSON",n),[]}}},MV=async i=>{try{const e={type:Pe.OBJECT,properties:{title:{type:Pe.STRING},author:{type:Pe.STRING},description:{type:Pe.STRING},publishedYear:{type:Pe.STRING},categories:{type:Pe.ARRAY,items:{type:Pe.STRING}},coverColor:{type:Pe.STRING,description:"A pastel hex color code matching the book vibe"},isbn:{type:Pe.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10 to fetch cover image."}},required:["title","author","description","publishedYear","categories","coverColor","isbn"]},t={type:Pe.ARRAY,items:e},n=`
      You are the search engine for the world's largest digital library.
      The user is searching for: "${i}".
      
      Instructions:
      1. If the query specifies a particular book title (e.g., "The Great Gatsby"), return that specific book first.
      2. If the query is a genre or topic (e.g., "Sci-Fi", "Cooking"), return 6 popular, high-quality books in that category.
      3. If the query is nonsense, random characters, or matches no known books (e.g., "asdfghjkl"), return an EMPTY array [].
      4. CRITICAL: Provide a valid real-world 'isbn' (ISBN-13 preferred) for every book so we can display the cover.
      
      For 'description', write a compelling 2-sentence hook.
      For 'coverColor', generate a unique, aesthetic pastel hex code for each book as a fallback.
    `,s=await ao.models.generateContent({model:lo,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return s_(s.text).map((l,c)=>({id:`gemini-search-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],fileUrl:void 0}))}catch(e){return console.warn("Gemini Search Error, switching to fallback:",e),SV(i)}},DV=async(i,e)=>{try{const t={type:Pe.OBJECT,properties:{title:{type:Pe.STRING},author:{type:Pe.STRING},description:{type:Pe.STRING},publishedYear:{type:Pe.STRING},categories:{type:Pe.ARRAY,items:{type:Pe.STRING}},coverColor:{type:Pe.STRING},isbn:{type:Pe.STRING,description:"Valid ISBN-13."},matchReason:{type:Pe.STRING,description:"Why this recommendation fits the conversation."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},n={type:Pe.OBJECT,properties:{reply:{type:Pe.STRING,description:"Your conversational response to the user."},suggestions:{type:Pe.ARRAY,items:t,description:"List of 1-3 books if relevant to the user's request. Can be empty if the user is just chatting."}},required:["reply","suggestions"]},s=`
            You are a sophisticated, warm, and highly knowledgeable literary concierge named "Suitcase".
            Your goal is to have a natural conversation with the user to help them find the perfect book.
            
            Conversation History:
            ${JSON.stringify(e.slice(-6))}
            
            Current User Input: "${i}"
            
            Instructions:
            1. Respond conversationally to the user's input. Be witty and helpful.
            2. If the user is asking for books, feeling a certain way, or discussing genres, provide 1-3 highly curated recommendations.
            3. If the user is just saying hello or asking a general question, reply without suggestions.
            4. 'matchReason' should be a personalized sentence about why you picked this book for them.
        `,o=await ao.models.generateContent({model:lo,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=s_(o.text),c=(l.suggestions||[]).map((h,f)=>({id:`concierge-${Date.now()}-${f}`,title:h.title,author:h.author,coverColor:h.coverColor||"#E2E8F0",isbn:h.isbn,description:h.description,isLocal:!1,publishedYear:h.publishedYear,categories:h.categories||[],matchReason:h.matchReason,fileUrl:void 0}));return{reply:l.reply||"I'm pondering that thought...",suggestions:c}}catch(t){return console.warn("Concierge Error, using fallback",t),AV(i)}},VA=async i=>{try{const e={type:Pe.OBJECT,properties:{title:{type:Pe.STRING},author:{type:Pe.STRING},description:{type:Pe.STRING},publishedYear:{type:Pe.STRING},categories:{type:Pe.ARRAY,items:{type:Pe.STRING}},coverColor:{type:Pe.STRING},isbn:{type:Pe.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10."},matchReason:{type:Pe.STRING,description:"Why this fits the user's preferences."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},t={type:Pe.ARRAY,items:e},n=`
        The user loves these genres: ${i.genres.join(", ")}.
        Their reading goal is: ${i.readingGoal}.
        
        Recommend 4 diverse, highly-rated books that fit this profile.
        Use soft, elegant colors for coverColor as fallback.
        CRITICAL: Provide a valid 'isbn' for each book for cover lookup.
      `,s=await ao.models.generateContent({model:lo,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return s_(s.text).map((l,c)=>({id:`gemini-onboarding-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],matchReason:l.matchReason,fileUrl:void 0}))}catch(e){return console.warn("Gemini Onboarding Error, using fallback:",e),EV()}},kV=async(i,e)=>{try{const t={type:Pe.OBJECT,properties:{reviewerName:{type:Pe.STRING},rating:{type:Pe.NUMBER},text:{type:Pe.STRING},date:{type:Pe.STRING}},required:["reviewerName","rating","text","date"]},n={type:Pe.ARRAY,items:t},s=`
      Generate 4 realistic user reviews for "${i}" by ${e}.
      Style: Goodreads or Amazon reviews. 
      Mix of lengths. Some detailed, some short. 
      Vary the ratings (mostly positive but maybe one critical).
    `,o=await ao.models.generateContent({model:lo,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=s_(o.text),c=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"];return l.map((h,f)=>({id:`review-${f}`,reviewerName:h.reviewerName,rating:h.rating,text:h.text,date:h.date,avatarColor:c[f%c.length]}))}catch(t){return console.warn("Review Gen Error, using fallback:",t),TV()}},xk=async(i,e,t)=>{try{const n=`
            You are an expert literary scholar and reading companion.
            Context: The user is currently reading "${i}".
            
            Previous Conversation:
            ${JSON.stringify(t.slice(-5))}
            
            User Question: "${e}"
            
            Answer concisely but deeply. If they ask about plot, be careful with spoilers unless asked.
        `;return(await ao.models.generateContent({model:lo,contents:n})).text||"I couldn't generate a response."}catch{return wV(i,e)}},PV=async(i,e="English")=>{try{const t=`Translate the following literary text to ${e}. Preserve the tone and style: "${i}"`;return(await ao.models.generateContent({model:lo,contents:t})).text||"Translation failed."}catch{return CV(i)}},LV=async(i,e)=>{try{const t=`The user is reading "${e}" and highlighted this text: "${i}".
        Explain this excerpt in simple terms. Provide necessary context, historical background, or define archaic words.`;return(await ao.models.generateContent({model:lo,contents:t})).text||"Could not explain context."}catch{return xV(i,e)}},OV=async(i,e,t=1)=>{try{const n=`
          The user wants to read **Chapter ${t}** of the book "${i}" by ${e}.
          
          Instructions:
          1. Write the FULL text for **Chapter ${t}**. 
          2. If it is a public domain book, provide the exact text.
          3. If it is copyrighted, write a very detailed, high-fidelity narrative adaptation that covers all events, dialogue, and descriptions of the chapter so the user can read it like a real book.
          4. Length: Write at least 800-1200 words. Do not be brief.
          5. Formatting: Use clean HTML. Use <h3> for the Chapter Title. Use <p> for paragraphs.
          
          Do NOT use markdown code blocks. Just return the HTML string.
        `;let o=(await ao.models.generateContent({model:lo,contents:n})).text||"<p>Content unavailable.</p>";return o=o.replace(/```html|```/g,"").trim(),o}catch{return RV(i,e,t)}},UV=async i=>{try{const e=`Provide a comprehensive summary of the book "${i}". Cover the main plot points, themes, and character arcs.`;return(await ao.models.generateContent({model:lo,contents:e})).text||"Summary unavailable."}catch{return IV(i)}},FV=async i=>{try{const e=`The user is reading "${i}" and has forgotten what happened previously. Provide a quick recap of the beginning/setup of the book to jog their memory.`;return(await ao.models.generateContent({model:lo,contents:e})).text||"Recap unavailable."}catch{return NV(i)}},BV=({book:i,onClose:e,onRead:t})=>{const[n,s]=ee.useState([]),[o,l]=ee.useState(!1),[c,h]=ee.useState("reviews"),[f,g]=ee.useState(""),[y,b]=ee.useState([]),[A,w]=ee.useState(!1),C=ee.useRef(null);ee.useEffect(()=>{const I=async()=>{l(!0);const P=await kV(i.title,i.author);s(P),l(!1)};c==="reviews"&&n.length===0&&I()},[i,c]),ee.useEffect(()=>{var I;(I=C.current)==null||I.scrollIntoView({behavior:"smooth"})},[y]);const N=async I=>{if(I.preventDefault(),!f.trim())return;const P=f;g("");const k=[...y,{role:"user",text:P}];b(k),w(!0);try{const L=await xk(i.title,P,k);b(O=>[...O,{role:"model",text:L}])}catch(L){console.error(L)}finally{w(!1)}};return T.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 animate-spring",children:[T.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:e}),T.jsxs("div",{className:"relative w-full max-w-4xl bg-[#FBFBFD] h-[85vh] rounded-[2rem] shadow-2xl overflow-hidden flex flex-col md:flex-row animate-[scale-up_0.4s_cubic-bezier(0.16,1,0.3,1)]",children:[T.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-gray-100 flex flex-col",children:[T.jsxs("div",{className:"relative h-64 md:h-1/2 w-full flex items-center justify-center overflow-hidden",style:{backgroundColor:i.coverColor},children:[T.jsx("button",{onClick:e,className:"absolute top-4 left-4 p-2 bg-black/10 hover:bg-black/20 text-white rounded-full backdrop-blur-lg transition-colors z-10 md:hidden",children:T.jsx(ph,{size:20})}),T.jsx(ma,{className:"text-white/80 w-24 h-24 drop-shadow-lg transform hover:scale-105 transition-transform duration-700"}),i.matchReason&&T.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:T.jsxs("div",{className:"bg-white/90 backdrop-blur p-4 rounded-2xl shadow-lg border border-white/50",children:[T.jsxs("p",{className:"text-[10px] uppercase font-bold text-blue-600 mb-1 flex items-center gap-1",children:[T.jsx(gs,{size:10})," Why this book?"]}),T.jsxs("p",{className:"text-xs text-gray-700 font-medium leading-relaxed",children:['"',i.matchReason,'"']})]})})]}),T.jsxs("div",{className:"p-8 flex flex-col flex-1 bg-white",children:[T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 mb-2 leading-tight",children:i.title}),T.jsx("p",{className:"text-lg text-gray-500 font-medium mb-6",children:i.author}),T.jsx("div",{className:"mt-auto space-y-3",children:T.jsxs("button",{onClick:t,className:"w-full bg-[#1D1D1F] text-white py-4 rounded-2xl font-semibold hover:bg-black transition-transform active:scale-95 flex items-center justify-center gap-2 shadow-lg",children:[T.jsx(ma,{size:18}),"Read"]})})]})]}),T.jsxs("div",{className:"flex-1 flex flex-col bg-[#F5F5F7]",children:[T.jsx("div",{className:"p-6 md:p-8 pb-0 shrink-0",children:T.jsxs("div",{className:"flex justify-between items-start mb-6",children:[T.jsx("div",{className:"flex bg-gray-200/50 p-1 rounded-full relative",children:["reviews","details","chat"].map(I=>T.jsx("button",{onClick:()=>h(I),className:`px-6 py-2 rounded-full text-sm font-semibold transition-all duration-300 relative z-10 ${c===I?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:I.charAt(0).toUpperCase()+I.slice(1)},I))}),T.jsx("button",{onClick:e,className:"hidden md:block p-2 text-gray-400 hover:text-gray-900 bg-white rounded-full shadow-sm hover:shadow transition-all",children:T.jsx(ph,{size:20})})]})}),T.jsxs("div",{className:"flex-1 overflow-y-auto px-6 md:px-8 pb-8",children:[c==="reviews"&&T.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"flex items-center justify-between mb-6",children:[T.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Critics & Readers"}),T.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-gray-500 bg-white px-3 py-1.5 rounded-full shadow-sm",children:[T.jsx(gs,{size:12,className:"text-blue-500"})," Smart Summary"]})]}),i.reviewSnippet&&T.jsxs("div",{className:"mb-8 p-6 bg-blue-50/50 rounded-3xl border border-blue-100/50",children:[T.jsx(YB,{className:"text-blue-200 mb-2 w-8 h-8"}),T.jsx("p",{className:"text-lg font-serif text-gray-800 italic leading-relaxed",children:i.reviewSnippet})]}),o?T.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[T.jsx(sc,{className:"animate-spin text-gray-400 w-8 h-8 mb-4"}),T.jsx("p",{className:"text-gray-400 text-sm",children:"Aggregating reviews..."})]}):T.jsx("div",{className:"grid gap-4",children:n.map(I=>T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-white hover:border-blue-100 transition-colors",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[T.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-sm",style:{backgroundColor:I.avatarColor},children:I.reviewerName.charAt(0)}),T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-bold text-gray-900",children:I.reviewerName}),T.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(P=>T.jsx(DD,{size:10,className:`${P<=I.rating?"text-yellow-400 fill-yellow-400":"text-gray-200"}`},P))})]}),T.jsx("span",{className:"ml-auto text-xs font-medium text-gray-400 bg-gray-50 px-2 py-1 rounded-md",children:I.date})]}),T.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:['"',I.text,'"']})]},I.id))})]}),c==="details"&&T.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"bg-white p-8 rounded-[2rem] shadow-sm",children:[T.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Synopsis"}),T.jsx("p",{className:"text-gray-700 leading-loose font-serif text-lg",children:i.description||"No description provided."})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[T.jsx(ND,{size:18}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Published"})]}),T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.publishedYear||"Unknown"})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[T.jsx(kD,{size:18}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Rights"})]}),T.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Public Domain"})]})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Categories"}),T.jsx("div",{className:"flex flex-wrap gap-2",children:i.categories.map(I=>T.jsx("span",{className:"px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-full text-sm font-medium shadow-sm",children:I},I))})]})]}),c==="chat"&&T.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[T.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 pr-2 min-h-[300px]",children:[y.length===0&&T.jsxs("div",{className:"text-center py-12",children:[T.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:T.jsx(gs,{className:"w-8 h-8 text-blue-500"})}),T.jsx("h4",{className:"text-gray-900 font-bold text-lg mb-1",children:"Book Companion"}),T.jsx("p",{className:"text-gray-500 text-sm",children:"Ask about themes, characters, or plot points."})]}),y.map((I,P)=>T.jsx("div",{className:`flex ${I.role==="user"?"justify-end":"justify-start"}`,children:T.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm leading-relaxed shadow-sm ${I.role==="user"?"bg-blue-600 text-white rounded-br-sm":"bg-white text-gray-800 rounded-bl-sm border border-gray-100"}`,children:I.text})},P)),A&&T.jsx("div",{className:"flex justify-start",children:T.jsx("div",{className:"bg-white border border-gray-100 p-4 rounded-2xl rounded-bl-sm shadow-sm",children:T.jsx(sc,{size:16,className:"animate-spin text-gray-400"})})}),T.jsx("div",{ref:C})]}),T.jsxs("form",{onSubmit:N,className:"relative mt-auto",children:[T.jsx("input",{type:"text",placeholder:"Ask a question...",className:"w-full pl-6 pr-14 py-4 bg-white border-0 shadow-lg shadow-gray-200/50 rounded-full focus:ring-2 focus:ring-blue-500 outline-none text-base font-medium placeholder:text-gray-400 transition-all",value:f,onChange:I=>g(I.target.value)}),T.jsx("button",{type:"submit",disabled:!f.trim()||A,className:"absolute right-2 top-2 p-2.5 bg-black text-white rounded-full hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-90",children:T.jsx(pw,{size:18})})]})]})]})]})]})]})},fi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),RE=[.001,0,0,.001,0,0],qA=1.35,hs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},eo={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Fg="pdfjs_internal_editor_",Ue={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},tt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Rk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Hn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Pg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},on={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Qd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Ry={ERRORS:0,WARNINGS:1,INFOS:5},jf={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},uv={moveTo:0,lineTo:1,curveTo:2,closePath:3},Ik={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let r_=Ry.WARNINGS;function HV(i){Number.isInteger(i)&&(r_=i)}function GV(){return r_}function o_(i){r_>=Ry.INFOS&&console.info(`Info: ${i}`)}function Fe(i){r_>=Ry.WARNINGS&&console.warn(`Warning: ${i}`)}function kt(i){throw new Error(i)}function it(i,e){i||kt(e)}function zV(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ww(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const s=i.match(/\./g);(s==null?void 0:s.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=XV(i)}catch{}}const n=e?URL.parse(i,e):URL.parse(i);return zV(n)?n:null}function Cw(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&ww(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ve(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const ld=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class iM extends ld{constructor(e,t){super(e,"PasswordException"),this.code=t}}class $A extends ld{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class hb extends ld{constructor(e){super(e,"InvalidPDFException")}}class Bg extends ld{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class VV extends ld{constructor(e){super(e,"FormatError")}}class Aa extends ld{constructor(e){super(e,"AbortException")}}function Nk(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&kt("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),l=i.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function Iy(i){typeof i!="string"&&kt("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function qV(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function $V(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function YV(){try{return new Function(""),!0}catch{return!1}}class Dn{static get isLittleEndian(){return Ve(this,"isLittleEndian",$V())}static get isEvalSupported(){return Ve(this,"isEvalSupported",YV())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ve(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const YA=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var ba,Ev,IE;class ye{static makeHexColor(e,t,n){return`#${YA[e]}${YA[t]}${YA[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5];for(let g=0;g<6;g+=2){const y=e[n+g],b=e[n+g+1];e[n+g]=y*s+b*l+h,e[n+g+1]=y*o+b*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],g=e[0],y=e[1],b=e[2],A=e[3];let w=s*g+h,C=w,N=s*b+h,I=N,P=c*y+f,k=P,L=c*A+f,O=L;if(o!==0||l!==0){const U=o*g,F=o*b,K=l*y,q=l*A;w+=K,I+=K,N+=q,C+=q,P+=U,O+=U,L+=F,k+=F}n[0]=Math.min(n[0],w,N,C,I),n[1]=Math.min(n[1],P,L,k,O),n[2]=Math.max(n[2],w,N,C,I),n[3]=Math.max(n[3],P,L,k,O)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],l=e[3],c=n**2+s**2,h=n*o+s*l,f=o**2+l**2,g=(c+f)/2,y=Math.sqrt(g**2-(c*f-h**2));t[0]=Math.sqrt(g+y||1),t[1]=Math.sqrt(g-y||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[n,o,s,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static bezierBoundingBox(e,t,n,s,o,l,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),M(this,ba,IE).call(this,e,n,o,c,t,s,l,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),M(this,ba,IE).call(this,e,n,o,c,t,s,l,h,3*(-t+3*(s-l)+h),6*(t-2*s+l),3*(s-t),f)}}ba=new WeakSet,Ev=function(e,t,n,s,o,l,c,h,f,g){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*e+3*f*t)+3*b*n)+A*s,C=y*(y*(y*o+3*f*l)+3*b*c)+A*h;g[0]=Math.min(g[0],w),g[1]=Math.min(g[1],C),g[2]=Math.max(g[2],w),g[3]=Math.max(g[3],C)},IE=function(e,t,n,s,o,l,c,h,f,g,y,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&M(this,ba,Ev).call(this,e,t,n,s,o,l,c,h,-y/g,b);return}const A=g**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),C=2*f;M(this,ba,Ev).call(this,e,t,n,s,o,l,c,h,(-g+w)/C,b),M(this,ba,Ev).call(this,e,t,n,s,o,l,c,h,(-g-w)/C,b)},R(ye,ba);function XV(i){return decodeURIComponent(escape(i))}let XA=null,sM=null;function Mk(i){return XA||(XA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,sM=new Map([["","t"]])),i.replaceAll(XA,(e,t,n)=>t?t.normalize("NFKC"):sM.get(n))}function xw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),Nk(i)}const Rw="pdfjs_internal_id_";function WV(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!i(n)&&!Number.isInteger(n)||!e(s))return!1;const l=o.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function ii(i,e,t){return Math.min(Math.max(i,e),t)}function Dk(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(Nk(i))}function KV(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):Iy(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});class Hg{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){var h;if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(Hg.shouldBuildText(c))(h=o==null?void 0:o.attributes)!=null&&h.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const f of o.children)s(f)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Iw{static setupStorage(e,t,n,s,o){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var y,b;const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(l),e.viewport){const A=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=A}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const A=document.createTextNode(s.value);l.append(A),c&&Hg.shouldBuildText(s.name)&&f.push(A)}return{textDivs:f}}const g=[[s,-1,l]];for(;g.length>0;){const[A,w,C]=g.at(-1);if(w+1===A.children.length){g.pop();continue}const N=A.children[++g.at(-1)[1]];if(N===null)continue;const{name:I}=N;if(I==="#text"){const k=document.createTextNode(N.value);f.push(k),C.append(k);continue}const P=(y=N==null?void 0:N.attributes)!=null&&y.xmlns?document.createElementNS(N.attributes.xmlns,I):document.createElement(I);if(C.append(P),N.attributes&&this.setAttributes({html:P,element:N,storage:t,intent:o,linkService:n}),((b=N.children)==null?void 0:b.length)>0)g.push([N,-1,P]);else if(N.value){const k=document.createTextNode(N.value);c&&Hg.shouldBuildText(I)&&f.push(k),P.append(k)}}for(const A of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Io="http://www.w3.org/2000/svg",Fc=class Fc{};le(Fc,"CSS",96),le(Fc,"PDF",72),le(Fc,"PDF_TO_CSS_UNITS",Fc.CSS/Fc.PDF);let Ea=Fc;async function sp(i,e="text"){if(ug(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Ny{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let g,y,b,A;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,y=0,b=0,A=1;break;case 90:g=0,y=1,b=1,A=0;break;case 270:g=0,y=-1,b=-1,A=0;break;case 0:g=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(b=-b,A=-A);let w,C,N,I;g===0?(w=Math.abs(f-e[1])*n+o,C=Math.abs(h-e[0])*n+l,N=(e[3]-e[1])*n,I=(e[2]-e[0])*n):(w=Math.abs(h-e[0])*n+o,C=Math.abs(f-e[1])*n+l,N=(e[2]-e[0])*n,I=(e[3]-e[1])*n),this.transform=[g*n,y*n,b*n,A*n,w-g*n*h-b*n*f,C-y*n*h-A*n*f],this.width=N,this.height=I}get rawDims(){const e=this.viewBox;return Ve(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new Ny({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return ye.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];ye.applyTransform(t,this.transform);const n=[e[2],e[3]];return ye.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return ye.applyInverseTransform(n,this.transform),n}}class a_ extends ld{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function My(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function l_(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function kk(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function Pk(i,e="document.pdf"){if(typeof i!="string")return e;if(My(i))return Fe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class rM{constructor(){le(this,"started",Object.create(null));le(this,"times",[])}time(e){e in this.started&&Fe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Fe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function ug(i,e){const t=e?URL.parse(i,e):URL.parse(i);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function vs(i){i.preventDefault()}function Xt(i){i.preventDefault(),i.stopPropagation()}function JV(i){console.log("Deprecated API usage: "+i)}var Wg;class Gg{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;d(this,Wg)||E(this,Wg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=d(this,Wg).exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let g=parseInt(t[8],10);g=g>=0&&g<=23?g:0;let y=parseInt(t[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=g,c+=y):f==="+"&&(l-=g,c-=y),new Date(Date.UTC(n,s,o,l,c,h))}}Wg=new WeakMap,R(Gg,Wg);function Lk(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new Ny({viewBox:o,userUnit:1,scale:e,rotation:t})}function rp(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Fe(`Not a valid color format: "${i}"`),[0,0,0])}function jV(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,rp(n))}e.remove()}function Yt(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform();return[e,t,n,s,o,l]}function Rr(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform().invertSelf();return[e,t,n,s,o,l]}function ac(i,e,t=!1,n=!0){if(e instanceof Ny){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:l}=i,c=Dn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,g=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(l.width=g,l.height=y):(l.width=y,l.height=g)}n&&i.setAttribute("data-main-rotation",e.rotation)}class _r{constructor(){const{pixelRatio:e}=_r;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let l=1/0,c=1/0,h=1/0;n=_r.capPixels(n,o),n>0&&(l=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const fb=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class QV{static get isDarkMode(){var e;return Ve(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class Ok{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Ve(this,"commentForegroundColor",rp(n))}}function Uk(i,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return i=Math.round(i*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[i,e,t]}function oM(i,e){const t=i[0]/255,n=i[1]/255,s=i[2]/255,o=Math.max(t,n,s),l=Math.min(t,n,s),c=(o+l)/2;if(o===l)e[0]=e[1]=0;else{const h=o-l;switch(e[1]=c<.5?h/(o+l):h/(2-o-l),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function NE(i,e){const t=i[0],n=i[1],s=i[2],o=(1-Math.abs(2*s-1))*n,l=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=o+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=l+c;break}}function aM(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function lM(i,e,t){NE(i,t),t.map(aM);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];NE(e,t),t.map(aM);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const cM=new Map;function Fk(i,e){const t=i[0]+i[1]*256+i[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=cM.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),l=s.subarray(3,6);oM(i,l);const c=s.subarray(6,9);oM(e,c);const h=c[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),lM(l,c,o)<f){let g,y;h?(g=l[2],y=1):(g=0,y=l[2]);const b=.005;for(;y-g>b;){const A=l[2]=(g+y)/2;h===lM(l,c,o)<f?g=A:y=A}l[2]=h?y:g}return NE(l,o),n=ye.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),cM.set(t,n),n}function Nw({html:i,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof i=="string"){const o=document.createElement("p");o.dir=e||"auto";const l=i.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const f=l[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else Iw.render({xfaHtml:i,div:s,intent:"richText"});s.firstChild.classList.add("richText",t),n.append(s)}var ul,dl,Ls,Os,Kg,hl,Th,wh,Jg,kb,Bk,Wn,Hk,Gk,Zd,dg;const Do=class Do{constructor(e){R(this,Wn);R(this,ul,null);R(this,dl,null);R(this,Ls);R(this,Os,null);R(this,Kg,null);R(this,hl,null);R(this,Th,null);R(this,wh,null);E(this,Ls,e),d(Do,Jg)||E(Do,Jg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=E(this,ul,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=d(this,Ls)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",vs,{signal:t}),e.addEventListener("pointerdown",M(Do,kb,Bk),{signal:t}));const n=E(this,Os,document.createElement("div"));n.className="buttons",e.append(n);const s=d(this,Ls).toolbarPosition;if(s){const{style:o}=e,l=d(this,Ls)._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return d(this,ul)}hide(){var e;d(this,ul).classList.add("hidden"),(e=d(this,dl))==null||e.hideDropdown()}show(){var e,t;d(this,ul).classList.remove("hidden"),(e=d(this,Kg))==null||e.shown(),(t=d(this,hl))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=d(this,Ls),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",d(Do,Jg)[e]),M(this,Wn,Zd).call(this,n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),d(this,Os).append(n)}async addAltText(e){const t=await e.render();M(this,Wn,Zd).call(this,t),d(this,Os).append(t,d(this,Wn,dg)),E(this,Kg,e)}addComment(e,t=null){if(d(this,hl))return;const n=e.renderForToolbar();if(!n)return;M(this,Wn,Zd).call(this,n);const s=E(this,Th,d(this,Wn,dg));t?(d(this,Os).insertBefore(n,t),d(this,Os).insertBefore(s,t)):d(this,Os).append(n,s),E(this,hl,e),e.toolbar=this}addColorPicker(e){if(d(this,dl))return;E(this,dl,e);const t=e.renderButton();M(this,Wn,Zd).call(this,t),d(this,Os).append(t,d(this,Wn,dg))}async addEditSignatureButton(e){const t=E(this,wh,await e.renderEditButton(d(this,Ls)));M(this,Wn,Zd).call(this,t),d(this,Os).append(t,d(this,Wn,dg))}removeButton(e){var t,n;switch(e){case"comment":(t=d(this,hl))==null||t.removeToolbarCommentButton(),E(this,hl,null),(n=d(this,Th))==null||n.remove(),E(this,Th,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,n){const s=d(this,Os).querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){d(this,wh)&&(d(this,wh).title=e)}remove(){var e;d(this,ul).remove(),(e=d(this,dl))==null||e.destroy(),E(this,dl,null)}};ul=new WeakMap,dl=new WeakMap,Ls=new WeakMap,Os=new WeakMap,Kg=new WeakMap,hl=new WeakMap,Th=new WeakMap,wh=new WeakMap,Jg=new WeakMap,kb=new WeakSet,Bk=function(e){e.stopPropagation()},Wn=new WeakSet,Hk=function(e){d(this,Ls)._focusEventsAllowed=!1,Xt(e)},Gk=function(e){d(this,Ls)._focusEventsAllowed=!0,Xt(e)},Zd=function(e){const t=d(this,Ls)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",M(this,Wn,Hk).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",M(this,Wn,Gk).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",vs,{signal:t}),!0)},dg=function(){const e=document.createElement("div");return e.className="divider",e},R(Do,kb),R(Do,Jg,null);let ME=Do;var jg,zc,Po,xa,zk,Vk,DE;class ZV{constructor(e){R(this,xa);R(this,jg,null);R(this,zc,null);R(this,Po);E(this,Po,e)}show(e,t,n){const[s,o]=M(this,xa,Vk).call(this,t,n),{style:l}=d(this,zc)||E(this,zc,M(this,xa,zk).call(this));e.append(d(this,zc)),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){d(this,zc).remove()}}jg=new WeakMap,zc=new WeakMap,Po=new WeakMap,xa=new WeakSet,zk=function(){const e=E(this,zc,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=d(this,Po)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",vs,{signal:t});const n=E(this,jg,document.createElement("div"));return n.className="buttons",e.append(n),d(this,Po).hasCommentManager()&&M(this,xa,DE).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{d(this,Po).commentSelection("floating_button")}),M(this,xa,DE).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{d(this,Po).highlightSelection("floating_button")}),e},Vk=function(e,t){let n=0,s=0;for(const o of e){const l=o.y+o.height;if(l<n)continue;const c=o.x+(t?o.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]},DE=function(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=d(this,Po)._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",vs,{signal:c}),o.addEventListener("click",s,{signal:c})),d(this,jg).append(o)};function qk(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}var Pb;class eq{constructor(){R(this,Pb,0)}get id(){return`${Fg}${yn(this,Pb)._++}`}}Pb=new WeakMap;var Ch,Qg,jn,xh,Tv;const rC=class rC{constructor(){R(this,xh);R(this,Ch,xw());R(this,Qg,0);R(this,jn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ve(this,"_isSVGFittingCanvas",o)}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return M(this,xh,Tv).call(this,`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return M(this,xh,Tv).call(this,e,e)}async getFromBlob(e,t){const n=await t;return M(this,xh,Tv).call(this,e,n)}async getFromId(e){d(this,jn)||E(this,jn,new Map);const t=d(this,jn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){d(this,jn)||E(this,jn,new Map);let n=d(this,jn).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${d(this,Ch)}_${yn(this,Qg)._++}`,refCounter:1,isSvg:!1},d(this,jn).set(e,n),d(this,jn).set(n.id,n),n}getSvgUrl(e){const t=d(this,jn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;d(this,jn)||E(this,jn,new Map);const t=d(this,jn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const o=new OffscreenCanvas(n.width,n.height);o.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=o.convertToBlob()}(s=n.close)==null||s.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${d(this,Ch)}_`)}};Ch=new WeakMap,Qg=new WeakMap,jn=new WeakMap,xh=new WeakSet,Tv=async function(e,t){d(this,jn)||E(this,jn,new Map);let n=d(this,jn).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${d(this,Ch)}_${yn(this,Qg)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(n.url=t,s=await sp(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=rC._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},l.onload=async()=>{const y=n.svgUrl=l.result;c.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},c.onerror=l.onerror=g});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Fe(s),n=null}return d(this,jn).set(e,n),n&&d(this,jn).set(n.id,n),n};let kE=rC;var an,fl,Zg,$t;class tq{constructor(e=128){R(this,an,[]);R(this,fl,!1);R(this,Zg);R(this,$t,-1);E(this,Zg,e)}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),d(this,fl))return;const h={cmd:e,undo:t,post:n,type:o};if(d(this,$t)===-1){d(this,an).length>0&&(d(this,an).length=0),E(this,$t,0),d(this,an).push(h);return}if(l&&d(this,an)[d(this,$t)].type===o){c&&(h.undo=d(this,an)[d(this,$t)].undo),d(this,an)[d(this,$t)]=h;return}const f=d(this,$t)+1;f===d(this,Zg)?d(this,an).splice(0,1):(E(this,$t,f),f<d(this,an).length&&d(this,an).splice(f)),d(this,an).push(h)}undo(){if(d(this,$t)===-1)return;E(this,fl,!0);const{undo:e,post:t}=d(this,an)[d(this,$t)];e(),t==null||t(),E(this,fl,!1),E(this,$t,d(this,$t)-1)}redo(){if(d(this,$t)<d(this,an).length-1){E(this,$t,d(this,$t)+1),E(this,fl,!0);const{cmd:e,post:t}=d(this,an)[d(this,$t)];e(),t==null||t(),E(this,fl,!1)}}hasSomethingToUndo(){return d(this,$t)!==-1}hasSomethingToRedo(){return d(this,$t)<d(this,an).length-1}cleanType(e){if(d(this,$t)!==-1){for(let t=d(this,$t);t>=0;t--)if(d(this,an)[t].type!==e){d(this,an).splice(t+1,d(this,$t)-t),E(this,$t,t);return}d(this,an).length=0,E(this,$t,-1)}}destroy(){E(this,an,null)}}an=new WeakMap,fl=new WeakMap,Zg=new WeakMap,$t=new WeakMap;var Lb,$k;class Dy{constructor(e){R(this,Lb);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Dn.platform;for(const[n,s,o={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(M(this,Lb,$k).call(this,t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),o||Xt(t))}}Lb=new WeakSet,$k=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Ob=class Ob{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return jV(e),Ve(this,"_colors",e)}convert(e){const t=rp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,l)=>o===t[l]))return Ob._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?ye.makeHexColor(...t):e}};le(Ob,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let PE=Ob;var Rh,Ki,Ih,Qt,bn,Nh,Us,Mh,Fs,Qn,pl,gl,Dh,ml,Mr,Bs,Vc,em,tm,kh,nm,Dr,yl,Ph,vl,kr,Ub,bl,Lh,im,_l,qc,Oh,Sl,sm,pn,yt,Lo,Al,El,rm,Uh,om,Tl,Pr,Oo,am,lm,Hs,he,wv,LE,Yk,Xk,hg,Wk,Kk,Jk,OE,jk,UE,FE,Qk,ai,No,Zk,eP,BE,tP,fg,HE;const uh=class uh{constructor(e,t,n,s,o,l,c,h,f,g,y,b,A,w,C,N){R(this,he);R(this,Rh,new AbortController);R(this,Ki,null);R(this,Ih,null);R(this,Qt,new Map);R(this,bn,new Map);R(this,Nh,null);R(this,Us,null);R(this,Mh,null);R(this,Fs,new tq);R(this,Qn,null);R(this,pl,null);R(this,gl,null);R(this,Dh,0);R(this,ml,new Set);R(this,Mr,null);R(this,Bs,null);R(this,Vc,new Set);le(this,"_editorUndoBar",null);R(this,em,!1);R(this,tm,!1);R(this,kh,!1);R(this,nm,null);R(this,Dr,null);R(this,yl,null);R(this,Ph,null);R(this,vl,!1);R(this,kr,null);R(this,Ub,new eq);R(this,bl,!1);R(this,Lh,!1);R(this,im,!1);R(this,_l,null);R(this,qc,null);R(this,Oh,null);R(this,Sl,null);R(this,sm,null);R(this,pn,Ue.NONE);R(this,yt,new Set);R(this,Lo,null);R(this,Al,null);R(this,El,null);R(this,rm,null);R(this,Uh,null);R(this,om,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});R(this,Tl,[0,0]);R(this,Pr,null);R(this,Oo,null);R(this,am,null);R(this,lm,null);R(this,Hs,null);const I=this._signal=d(this,Rh).signal;E(this,Oo,e),E(this,am,t),E(this,lm,n),E(this,Nh,s),E(this,Qn,o),E(this,Al,l),E(this,Uh,h),this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:I}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:I}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:I}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:I}),c._on("setpreference",this.onSetPreference.bind(this),{signal:I}),c._on("switchannotationeditorparams",P=>this.updateParams(P.type,P.value),{signal:I}),window.addEventListener("pointerdown",()=>{E(this,Lh,!0)},{capture:!0,signal:I}),window.addEventListener("pointerup",()=>{E(this,Lh,!1)},{capture:!0,signal:I}),M(this,he,Wk).call(this),M(this,he,Qk).call(this),M(this,he,OE).call(this),E(this,Us,h.annotationStorage),E(this,nm,h.filterFactory),E(this,El,f),E(this,Ph,g||null),E(this,em,y),E(this,tm,b),E(this,kh,A),E(this,sm,w||null),this.viewParameters={realScale:Ea.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=C||null,this._supportsPinchToZoom=N!==!1,o==null||o.setSidebarUiManager(this)}static get _keyboardManager(){const e=uh.prototype,t=l=>d(l,Oo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Dy([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Oo).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Oo).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}destroy(){var e,t,n,s,o,l,c,h,f;(e=d(this,Hs))==null||e.resolve(),E(this,Hs,null),(t=d(this,Rh))==null||t.abort(),E(this,Rh,null),this._signal=null;for(const g of d(this,bn).values())g.destroy();d(this,bn).clear(),d(this,Qt).clear(),d(this,Vc).clear(),(n=d(this,Sl))==null||n.clear(),E(this,Ki,null),d(this,yt).clear(),d(this,Fs).destroy(),(s=d(this,Nh))==null||s.destroy(),(o=d(this,Qn))==null||o.destroy(),(l=d(this,Al))==null||l.destroy(),(c=d(this,kr))==null||c.hide(),E(this,kr,null),(h=d(this,Oh))==null||h.destroy(),E(this,Oh,null),E(this,Ih,null),d(this,Dr)&&(clearTimeout(d(this,Dr)),E(this,Dr,null)),d(this,Pr)&&(clearTimeout(d(this,Pr)),E(this,Pr,null)),(f=this._editorUndoBar)==null||f.destroy(),E(this,Uh,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return d(this,sm)}get useNewAltTextFlow(){return d(this,tm)}get useNewAltTextWhenAddingImage(){return d(this,kh)}get hcmFilter(){return Ve(this,"hcmFilter",d(this,El)?d(this,nm).addHCMFilter(d(this,El).foreground,d(this,El).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(d(this,Oo)).direction)}get _highlightColors(){return Ve(this,"_highlightColors",d(this,Ph)?new Map(d(this,Ph).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ve(this,"highlightColors",null);const t=new Map,n=!!d(this,El);for(const[s,o]of e){const l=s.endsWith("_HCM");if(n&&l){t.set(s.replace("_HCM",""),o);continue}!n&&!l&&t.set(s,o)}return Ve(this,"highlightColors",t)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),E(this,gl,e)}setMainHighlightColorPicker(e){E(this,Oh,e)}editAltText(e,t=!1){var n;(n=d(this,Nh))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!d(this,Qn)}editComment(e,t,n,s){var o;(o=d(this,Qn))==null||o.showDialog(this,e,t,n,s)}selectComment(e,t){const n=d(this,bn).get(e),s=n==null?void 0:n.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=d(this,Qn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=d(this,Qn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=d(this,Qn))==null||t.removeComments([e.uid])}toggleComment(e,t,n=void 0){var s;(s=d(this,Qn))==null||s.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){var n;return e&&((n=d(this,Qn))==null?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=d(this,Qn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(d(this,bn).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){var t;(t=d(this,Al))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return d(this,Al)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":E(this,kh,t);break}}onPageChanging({pageNumber:e}){E(this,Dh,e-1)}focusMainContainer(){d(this,Oo).focus()}findParent(e,t){for(const n of d(this,bn).values()){const{x:s,y:o,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){d(this,am).classList.toggle("noUserSelect",e)}addShouldRescale(e){d(this,Vc).add(e)}removeShouldRescale(e){d(this,Vc).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Ea.PDF_TO_CSS_UNITS;for(const n of d(this,Vc))n.onScaleChanging();(t=d(this,gl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c}=n,h=n.toString(),g=M(this,he,wv).call(this,n).closest(".textLayer"),y=this.getSelectionBoxes(g);if(!y)return;n.empty();const b=M(this,he,LE).call(this,g),A=d(this,pn)===Ue.NONE,w=()=>{const C=b==null?void 0:b.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:y,anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c,text:h});A&&this.showAllEditors("highlight",!0,!0),t&&(C==null||C.editComment())};if(A){this.switchToMode(Ue.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!d(this,Us))return null;const t=`${Fg}${e}`,n=d(this,Us).getRawValue(t);return n&&d(this,Us).remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&d(this,Us)&&!d(this,Us).has(e.id)&&d(this,Us).setValue(e.id,e)}a11yAlert(e,t=null){const n=d(this,lm);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,d(this,vl)&&(E(this,vl,!1),M(this,he,hg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of d(this,yt))if(t.div.contains(e)){E(this,qc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!d(this,qc))return;const[e,t]=d(this,qc);E(this,qc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){M(this,he,OE).call(this),M(this,he,UE).call(this)}removeEditListeners(){M(this,he,jk).call(this),M(this,he,FE).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of d(this,Bs))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of d(this,Bs))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=d(this,Ki))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of d(this,yt)){const o=s.serialize(!0);o&&t.push(o)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of d(this,Bs))if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){Fe(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)M(this,he,BE).call(this,h);M(this,he,HE).call(this,o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){Fe(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),d(this,pn)!==Ue.NONE&&!this.isEditorHandlingKeyboard&&uh._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,d(this,vl)&&(E(this,vl,!1),M(this,he,hg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(M(this,he,Kk).call(this),M(this,he,UE).call(this),M(this,he,ai).call(this,{isEditing:d(this,pn)!==Ue.NONE,isEmpty:M(this,he,fg).call(this),hasSomethingToUndo:d(this,Fs).hasSomethingToUndo(),hasSomethingToRedo:d(this,Fs).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,he,Jk).call(this),M(this,he,FE).call(this),M(this,he,ai).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!d(this,Bs)){E(this,Bs,e);for(const t of d(this,Bs))M(this,he,No).call(this,t.defaultPropertiesToUpdate)}}getId(){return d(this,Ub).id}get currentLayer(){return d(this,bn).get(d(this,Dh))}getLayer(e){return d(this,bn).get(e)}get currentPageIndex(){return d(this,Dh)}addLayer(e){d(this,bn).set(e.pageIndex,e),d(this,bl)?e.enable():e.disable()}removeLayer(e){d(this,bn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){var l,c,h,f,g,y;if(d(this,pn)!==e&&!(d(this,Hs)&&(await d(this,Hs).promise,!d(this,Hs)))){if(E(this,Hs,Promise.withResolvers()),(l=d(this,gl))==null||l.commitOrRemove(),d(this,pn)===Ue.POPUP&&((c=d(this,Qn))==null||c.hideSidebar()),(h=d(this,Qn))==null||h.destroyPopup(),E(this,pn,e),e===Ue.NONE){this.setEditingState(!1),M(this,he,eP).call(this);for(const b of d(this,Qt).values())b.hideStandaloneCommentButton();(f=this._editorUndoBar)==null||f.hide(),this.toggleComment(null),d(this,Hs).resolve();return}for(const b of d(this,Qt).values())b.addStandaloneCommentButton();e===Ue.SIGNATURE&&await((g=d(this,Al))==null?void 0:g.loadSignatures()),this.setEditingState(!0),await M(this,he,Zk).call(this),this.unselectAll();for(const b of d(this,bn).values())b.updateMode(e);if(e===Ue.POPUP){d(this,Ih)||E(this,Ih,await d(this,Uh).getAnnotationsByType(new Set(d(this,Bs).map(w=>w._editorType))));const b=new Set,A=[];for(const w of d(this,Qt).values()){const{annotationElementId:C,hasComment:N,deleted:I}=w;C&&b.add(C),N&&!I&&A.push(w.getData())}for(const w of d(this,Ih)){const{id:C,popupRef:N,contentsObj:I}=w;N&&(I!=null&&I.str)&&!b.has(C)&&!d(this,ml).has(C)&&A.push(w)}(y=d(this,Qn))==null||y.showSidebar(A)}if(!t){n&&this.addNewEditorFromKeyboard(),d(this,Hs).resolve();return}for(const b of d(this,Qt).values())b.uid===t?(this.setSelected(b),o?b.editComment():s?b.enterInEditMode():b.focus()):b.unselect();d(this,Hs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==d(this,pn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(d(this,Bs)){switch(e){case tt.CREATE:this.currentLayer.addNewEditor(t);return;case tt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d(this,rm)||E(this,rm,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of d(this,yt))n.updateParams(e,t);else for(const n of d(this,Bs))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var o;for(const l of d(this,Qt).values())l.editorType===e&&l.show(t);(((o=d(this,rm))==null?void 0:o.get(tt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&M(this,he,No).call(this,[[tt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(d(this,im)!==e){E(this,im,e);for(const t of d(this,bn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of d(this,Qt).values())t.pageIndex===e&&(yield t)}getEditor(e){return d(this,Qt).get(e)}addEditor(e){d(this,Qt).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(d(this,Dr)&&clearTimeout(d(this,Dr)),E(this,Dr,setTimeout(()=>{this.focusMainContainer(),E(this,Dr,null)},0))),d(this,Qt).delete(e.id),e.annotationElementId&&((t=d(this,Sl))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!d(this,ml).has(e.annotationElementId))&&((n=d(this,Us))==null||n.remove(e.id))}addDeletedAnnotationElement(e){d(this,ml).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return d(this,ml).has(e)}removeDeletedAnnotationElement(e){d(this,ml).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){d(this,Ki)!==e&&(E(this,Ki,e),e&&M(this,he,No).call(this,e.propertiesToUpdate))}updateUI(e){d(this,he,tP)===e&&M(this,he,No).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){M(this,he,No).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(d(this,yt).has(e)){d(this,yt).delete(e),e.unselect(),M(this,he,ai).call(this,{hasSelectedEditor:this.hasSelection});return}d(this,yt).add(e),e.select(),M(this,he,No).call(this,e.propertiesToUpdate),M(this,he,ai).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=d(this,gl))==null||t.commitOrRemove();for(const n of d(this,yt))n!==e&&n.unselect();d(this,yt).clear(),d(this,yt).add(e),e.select(),M(this,he,No).call(this,e.propertiesToUpdate),M(this,he,ai).call(this,{hasSelectedEditor:!0})}isSelected(e){return d(this,yt).has(e)}get firstSelectedEditor(){return d(this,yt).values().next().value}unselect(e){e.unselect(),d(this,yt).delete(e),M(this,he,ai).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return d(this,yt).size!==0}get isEnterHandled(){return d(this,yt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;d(this,Fs).undo(),M(this,he,ai).call(this,{hasSomethingToUndo:d(this,Fs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,he,fg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){d(this,Fs).redo(),M(this,he,ai).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(this,Fs).hasSomethingToRedo(),isEmpty:M(this,he,fg).call(this)})}addCommands(e){d(this,Fs).add(e),M(this,he,ai).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,he,fg).call(this)})}cleanUndoStack(e){d(this,Fs).cleanType(e)}delete(){var o;this.commitOrRemove();const e=(o=this.currentLayer)==null?void 0:o.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...d(this,yt)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(s,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},s=()=>{for(const l of t)M(this,he,BE).call(this,l)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=d(this,Ki))==null||e.commitOrRemove()}hasSomethingToControl(){return d(this,Ki)||this.hasSelection}selectAll(){for(const e of d(this,yt))e.commit();M(this,he,HE).call(this,d(this,Qt).values())}unselectAll(){var e;if(!(d(this,Ki)&&(d(this,Ki).commitOrRemove(),d(this,pn)!==Ue.NONE))&&!((e=d(this,gl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of d(this,yt))t.unselect();d(this,yt).clear(),M(this,he,ai).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;d(this,Tl)[0]+=e,d(this,Tl)[1]+=t;const[s,o]=d(this,Tl),l=[...d(this,yt)],c=1e3;d(this,Pr)&&clearTimeout(d(this,Pr)),E(this,Pr,setTimeout(()=>{E(this,Pr,null),d(this,Tl)[0]=d(this,Tl)[1]=0,this.addCommands({cmd:()=>{for(const h of l)d(this,Qt).has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of l)d(this,Qt).has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c));for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),E(this,Mr,new Map);for(const e of d(this,yt))d(this,Mr).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!d(this,Mr))return!1;this.disableUserSelect(!1);const e=d(this,Mr);E(this,Mr,null);let t=!1;for(const[{x:s,y:o,pageIndex:l},c]of e)c.newX=s,c.newY=o,c.newPageIndex=l,t||(t=s!==c.savedX||o!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(s,o,l,c)=>{if(d(this,Qt).has(s.id)){const h=d(this,bn).get(c);h?s._setParentAndPosition(h,o,l):(s.pageIndex=c,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:c}]of e)n(s,o,l,c)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:c}]of e)n(s,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(d(this,Mr))for(const n of d(this,Mr).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||d(this,yt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return d(this,Ki)===e}getActive(){return d(this,Ki)}getMode(){return d(this,pn)}isEditingMode(){return d(this,pn)!==Ue.NONE}get imageManager(){return Ve(this,"imageManager",new kE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,g=t.rangeCount;f<g;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,g,y,b)=>({x:(g-s)/l,y:1-(f+y-n)/o,width:b/l,height:y/o});break;case"180":c=(f,g,y,b)=>({x:1-(f+y-n)/o,y:1-(g+b-s)/l,width:y/o,height:b/l});break;case"270":c=(f,g,y,b)=>({x:1-(g+b-s)/l,y:(f-n)/o,width:b/l,height:y/o});break;default:c=(f,g,y,b)=>({x:(f-n)/o,y:(g-s)/l,width:y/o,height:b/l});break}const h=[];for(let f=0,g=t.rangeCount;f<g;f++){const y=t.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:C}of y.getClientRects())w===0||C===0||h.push(c(b,A,w,C))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(d(this,Mh)||E(this,Mh,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=d(this,Mh))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=d(this,Mh))==null?void 0:s.get(e.data.id);if(!t)return;const n=d(this,Us).getRawValue(t);n&&(d(this,pn)===Ue.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var o;const s=(o=d(this,Sl))==null?void 0:o.get(e);s&&(s.setCanvas(t,n),d(this,Sl).delete(e))}addMissingCanvas(e,t){(d(this,Sl)||E(this,Sl,new Map)).set(e,t)}};Rh=new WeakMap,Ki=new WeakMap,Ih=new WeakMap,Qt=new WeakMap,bn=new WeakMap,Nh=new WeakMap,Us=new WeakMap,Mh=new WeakMap,Fs=new WeakMap,Qn=new WeakMap,pl=new WeakMap,gl=new WeakMap,Dh=new WeakMap,ml=new WeakMap,Mr=new WeakMap,Bs=new WeakMap,Vc=new WeakMap,em=new WeakMap,tm=new WeakMap,kh=new WeakMap,nm=new WeakMap,Dr=new WeakMap,yl=new WeakMap,Ph=new WeakMap,vl=new WeakMap,kr=new WeakMap,Ub=new WeakMap,bl=new WeakMap,Lh=new WeakMap,im=new WeakMap,_l=new WeakMap,qc=new WeakMap,Oh=new WeakMap,Sl=new WeakMap,sm=new WeakMap,pn=new WeakMap,yt=new WeakMap,Lo=new WeakMap,Al=new WeakMap,El=new WeakMap,rm=new WeakMap,Uh=new WeakMap,om=new WeakMap,Tl=new WeakMap,Pr=new WeakMap,Oo=new WeakMap,am=new WeakMap,lm=new WeakMap,Hs=new WeakMap,he=new WeakSet,wv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},LE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of d(this,bn).values())if(n.hasTextLayer(e))return n;return null},Yk=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=M(this,he,wv).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(d(this,kr)||E(this,kr,new ZV(this)),d(this,kr).show(n,s,this.direction==="ltr"))},Xk=function(){var o,l,c;const e=document.getSelection();if(!e||e.isCollapsed){d(this,Lo)&&((o=d(this,kr))==null||o.hide(),E(this,Lo,null),M(this,he,ai).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===d(this,Lo))return;const s=M(this,he,wv).call(this,e).closest(".textLayer");if(!s){d(this,Lo)&&((l=d(this,kr))==null||l.hide(),E(this,Lo,null),M(this,he,ai).call(this,{hasSelectedText:!1}));return}if((c=d(this,kr))==null||c.hide(),E(this,Lo,t),M(this,he,ai).call(this,{hasSelectedText:!0}),!(d(this,pn)!==Ue.HIGHLIGHT&&d(this,pn)!==Ue.NONE)&&(d(this,pn)===Ue.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),E(this,vl,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=d(this,pn)===Ue.HIGHLIGHT?M(this,he,LE).call(this,s):null;if(h==null||h.toggleDrawing(),d(this,Lh)){const f=new AbortController,g=this.combinedSignal(f),y=b=>{b.type==="pointerup"&&b.button!==0||(f.abort(),h==null||h.toggleDrawing(!0),b.type==="pointerup"&&M(this,he,hg).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:g}),window.addEventListener("blur",y,{signal:g})}else h==null||h.toggleDrawing(!0),M(this,he,hg).call(this,"main_toolbar")}},hg=function(e=""){d(this,pn)===Ue.HIGHLIGHT?this.highlightSelection(e):d(this,em)&&M(this,he,Yk).call(this)},Wk=function(){document.addEventListener("selectionchange",M(this,he,Xk).bind(this),{signal:this._signal})},Kk=function(){if(d(this,yl))return;E(this,yl,new AbortController);const e=this.combinedSignal(d(this,yl));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Jk=function(){var e;(e=d(this,yl))==null||e.abort(),E(this,yl,null)},OE=function(){if(d(this,_l))return;E(this,_l,new AbortController);const e=this.combinedSignal(d(this,_l));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},jk=function(){var e;(e=d(this,_l))==null||e.abort(),E(this,_l,null)},UE=function(){if(d(this,pl))return;E(this,pl,new AbortController);const e=this.combinedSignal(d(this,pl));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},FE=function(){var e;(e=d(this,pl))==null||e.abort(),E(this,pl,null)},Qk=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},ai=function(e){Object.entries(e).some(([n,s])=>d(this,om)[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(this,om),e)}),d(this,pn)===Ue.HIGHLIGHT&&e.hasSelectedEditor===!1&&M(this,he,No).call(this,[[tt.HIGHLIGHT_FREE,!0]]))},No=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Zk=async function(){if(!d(this,bl)){E(this,bl,!0);const e=[];for(const t of d(this,bn).values())e.push(t.enable());await Promise.all(e);for(const t of d(this,Qt).values())t.enable()}},eP=function(){if(this.unselectAll(),d(this,bl)){E(this,bl,!1);for(const e of d(this,bn).values())e.disable();for(const e of d(this,Qt).values())e.disable()}},BE=function(e){const t=d(this,bn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},tP=function(){let e=null;for(e of d(this,yt));return e},fg=function(){if(d(this,Qt).size===0)return!0;if(d(this,Qt).size===1)for(const e of d(this,Qt).values())return e.isEmpty();return!1},HE=function(e){for(const t of d(this,yt))t.unselect();d(this,yt).clear();for(const t of e)t.isEmpty()||(d(this,yt).add(t),t.select());M(this,he,ai).call(this,{hasSelectedEditor:this.hasSelection})},le(uh,"TRANSLATE_SMALL",1),le(uh,"TRANSLATE_BIG",10);let lc=uh;var wn,Lr,ir,Fh,Or,Ji,Bh,Ur,Ri,Uo,$c,Fr,wl,yr,pg,Cv;const li=class li{constructor(e){R(this,yr);R(this,wn,null);R(this,Lr,!1);R(this,ir,null);R(this,Fh,null);R(this,Or,null);R(this,Ji,null);R(this,Bh,!1);R(this,Ur,null);R(this,Ri,null);R(this,Uo,null);R(this,$c,null);R(this,Fr,!1);E(this,Ri,e),E(this,Fr,e._uiManager.useNewAltTextFlow),d(li,wl)||E(li,wl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){li._l10n??(li._l10n=e)}async render(){const e=E(this,ir,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=E(this,Fh,document.createElement("span"));e.append(t),d(this,Fr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",d(li,wl).missing),t.setAttribute("data-l10n-id",d(li,wl)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=d(this,Ri)._uiManager._signal;e.addEventListener("contextmenu",vs,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),d(this,Ri)._uiManager.editAltText(d(this,Ri)),d(this,Fr)&&d(this,Ri)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:d(this,yr,pg)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(E(this,Bh,!0),s(o))},{signal:n}),await M(this,yr,Cv).call(this),e}finish(){d(this,ir)&&(d(this,ir).focus({focusVisible:d(this,Bh)}),E(this,Bh,!1))}isEmpty(){return d(this,Fr)?d(this,wn)===null:!d(this,wn)&&!d(this,Lr)}hasData(){return d(this,Fr)?d(this,wn)!==null||!!d(this,Uo):this.isEmpty()}get guessedText(){return d(this,Uo)}async setGuessedText(e){d(this,wn)===null&&(E(this,Uo,e),E(this,$c,await li._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),M(this,yr,Cv).call(this))}toggleAltTextBadge(e=!1){var t;if(!d(this,Fr)||d(this,wn)){(t=d(this,Ur))==null||t.remove(),E(this,Ur,null);return}if(!d(this,Ur)){const n=E(this,Ur,document.createElement("div"));n.className="noAltTextBadge",d(this,Ri).div.append(n)}d(this,Ur).classList.toggle("hidden",!e)}serialize(e){let t=d(this,wn);return!e&&d(this,Uo)===t&&(t=d(this,$c)),{altText:t,decorative:d(this,Lr),guessedText:d(this,Uo),textWithDisclaimer:d(this,$c)}}get data(){return{altText:d(this,wn),decorative:d(this,Lr)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(E(this,Uo,n),E(this,$c,s)),!(d(this,wn)===e&&d(this,Lr)===t)&&(o||(E(this,wn,e),E(this,Lr,t)),M(this,yr,Cv).call(this))}toggle(e=!1){d(this,ir)&&(!e&&d(this,Ji)&&(clearTimeout(d(this,Ji)),E(this,Ji,null)),d(this,ir).disabled=!e)}shown(){d(this,Ri)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:d(this,yr,pg)}})}destroy(){var e,t;(e=d(this,ir))==null||e.remove(),E(this,ir,null),E(this,Fh,null),E(this,Or,null),(t=d(this,Ur))==null||t.remove(),E(this,Ur,null)}};wn=new WeakMap,Lr=new WeakMap,ir=new WeakMap,Fh=new WeakMap,Or=new WeakMap,Ji=new WeakMap,Bh=new WeakMap,Ur=new WeakMap,Ri=new WeakMap,Uo=new WeakMap,$c=new WeakMap,Fr=new WeakMap,wl=new WeakMap,yr=new WeakSet,pg=function(){return d(this,wn)&&"added"||d(this,wn)===null&&this.guessedText&&"review"||"missing"},Cv=async function(){var s,o,l;const e=d(this,ir);if(!e)return;if(d(this,Fr)){if(e.classList.toggle("done",!!d(this,wn)),e.setAttribute("data-l10n-id",d(li,wl)[d(this,yr,pg)]),(s=d(this,Fh))==null||s.setAttribute("data-l10n-id",d(li,wl)[`${d(this,yr,pg)}-label`]),!d(this,wn)){(o=d(this,Or))==null||o.remove();return}}else{if(!d(this,wn)&&!d(this,Lr)){e.classList.remove("done"),(l=d(this,Or))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=d(this,Or);if(!t){E(this,Or,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${d(this,Ri).id}`;const c=100,h=d(this,Ri)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(d(this,Ji)),E(this,Ji,null)},{once:!0}),e.addEventListener("mouseenter",()=>{E(this,Ji,setTimeout(()=>{E(this,Ji,null),d(this,Or).classList.add("show"),d(this,Ri)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:h}),e.addEventListener("mouseleave",()=>{var f;d(this,Ji)&&(clearTimeout(d(this,Ji)),E(this,Ji,null)),(f=d(this,Or))==null||f.classList.remove("show")},{signal:h})}d(this,Lr)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=d(this,wn)),t.parentNode||e.append(t);const n=d(this,Ri).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},R(li,wl,null),le(li,"_l10n",null);let pb=li;var Gn,Gs,Yc,Pt,cm,Xc,sr,Wc,Kc,Jc,um,GE;class dv{constructor(e){R(this,um);R(this,Gn,null);R(this,Gs,null);R(this,Yc,!1);R(this,Pt,null);R(this,cm,null);R(this,Xc,null);R(this,sr,null);R(this,Wc,null);R(this,Kc,!1);R(this,Jc,null);E(this,Pt,e)}renderForToolbar(){const e=E(this,Gs,document.createElement("button"));return e.className="comment",M(this,um,GE).call(this,e,!1)}renderForStandalone(){const e=E(this,Gn,document.createElement("button"));e.className="annotationCommentButton";const t=d(this,Pt).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(d(this,Pt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=d(this,Pt).commentButtonColor;s&&(n.backgroundColor=s)}return M(this,um,GE).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=d(this,Gn)??d(this,Gs))==null||e.focus()},0)}onUpdatedColor(){if(!d(this,Gn))return;const e=d(this,Pt).commentButtonColor;e&&(d(this,Gn).style.backgroundColor=e),d(this,Pt)._uiManager.updatePopupColor(d(this,Pt))}get commentButtonWidth(){var e;return(((e=d(this,Gn))==null?void 0:e.getBoundingClientRect().width)??0)/d(this,Pt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(d(this,Jc))return d(this,Jc);if(!d(this,Gn))return null;const{x:e,y:t,height:n}=d(this,Gn).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,Pt).parent.boundingClientRect;return[(e-s)/l,(t+n-o)/c]}set commentPopupPositionInLayer(e){E(this,Jc,e)}hasDefaultPopupPosition(){return d(this,Jc)===null}removeStandaloneCommentButton(){var e;(e=d(this,Gn))==null||e.remove(),E(this,Gn,null)}removeToolbarCommentButton(){var e;(e=d(this,Gs))==null||e.remove(),E(this,Gs,null)}setCommentButtonStates({selected:e,hasPopup:t}){d(this,Gn)&&(d(this,Gn).classList.toggle("selected",e),d(this,Gn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=d(this,Pt).commentButtonPosition;const{width:g,height:y,x:b,y:A}=d(this,Pt);n=b+n*g,s=A+s*y}const o=d(this,Pt).parent.boundingClientRect,{x:l,y:c,width:h,height:f}=o;d(this,Pt)._uiManager.editComment(d(this,Pt),l+n*h,c+s*f,{...e,parentDimensions:o})}finish(){d(this,Gs)&&(d(this,Gs).focus({focusVisible:d(this,Yc)}),E(this,Yc,!1))}isDeleted(){return d(this,Kc)||d(this,sr)===""}isEmpty(){return d(this,sr)===null}hasBeenEdited(){return this.isDeleted()||d(this,sr)!==d(this,cm)}serialize(){return this.data}get data(){return{text:d(this,sr),richText:d(this,Xc),date:d(this,Wc),deleted:this.isDeleted()}}set data(e){if(e!==d(this,sr)&&E(this,Xc,null),e===null){E(this,sr,""),E(this,Kc,!0);return}E(this,sr,e),E(this,Wc,new Date),E(this,Kc,!1)}setInitialText(e,t=null){E(this,cm,e),this.data=e,E(this,Wc,null),E(this,Xc,t)}shown(){}destroy(){var e,t;(e=d(this,Gs))==null||e.remove(),E(this,Gs,null),(t=d(this,Gn))==null||t.remove(),E(this,Gn,null),E(this,sr,""),E(this,Xc,null),E(this,Wc,null),E(this,Pt,null),E(this,Yc,!1),E(this,Kc,!1)}}Gn=new WeakMap,Gs=new WeakMap,Yc=new WeakMap,Pt=new WeakMap,cm=new WeakMap,Xc=new WeakMap,sr=new WeakMap,Wc=new WeakMap,Kc=new WeakMap,Jc=new WeakMap,um=new WeakSet,GE=function(e,t){if(!d(this,Pt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[d(this,Pt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=d(this,Pt)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",vs,{signal:n}),t&&(e.addEventListener("focusin",o=>{d(this,Pt)._focusEventsAllowed=!1,Xt(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{d(this,Pt)._focusEventsAllowed=!0,Xt(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===d(this,Gs)?this.edit():d(this,Pt).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(E(this,Yc,!0),s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{d(this,Pt).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{d(this,Pt).toggleComment(!1,!1)},{signal:n}),e};var Hh,jc,dm,hm,fm,pm,gm,Fo,Qc,Bo,Zc,Ho,cc,nP,iP,sP;const oC=class oC{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){R(this,cc);R(this,Hh);R(this,jc,!1);R(this,dm,null);R(this,hm);R(this,fm);R(this,pm);R(this,gm);R(this,Fo,null);R(this,Qc);R(this,Bo,null);R(this,Zc);R(this,Ho,null);E(this,Hh,e),E(this,dm,n),E(this,hm,t),E(this,fm,s),E(this,pm,o),E(this,gm,l),E(this,Zc,new AbortController),E(this,Qc,AbortSignal.any([c,d(this,Zc).signal])),e.addEventListener("touchstart",M(this,cc,nP).bind(this),{passive:!1,signal:d(this,Qc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/_r.pixelRatio}destroy(){var e,t;(e=d(this,Zc))==null||e.abort(),E(this,Zc,null),(t=d(this,Fo))==null||t.abort(),E(this,Fo,null)}};Hh=new WeakMap,jc=new WeakMap,dm=new WeakMap,hm=new WeakMap,fm=new WeakMap,pm=new WeakMap,gm=new WeakMap,Fo=new WeakMap,Qc=new WeakMap,Bo=new WeakMap,Zc=new WeakMap,Ho=new WeakMap,cc=new WeakSet,nP=function(e){var s,o,l;if((s=d(this,hm))!=null&&s.call(this))return;if(e.touches.length===1){if(d(this,Fo))return;const c=E(this,Fo,new AbortController),h=AbortSignal.any([d(this,Qc),c.signal]),f=d(this,Hh),g={capture:!0,signal:h,passive:!1},y=b=>{var A;b.pointerType==="touch"&&((A=d(this,Fo))==null||A.abort(),E(this,Fo,null))};f.addEventListener("pointerdown",b=>{b.pointerType==="touch"&&(Xt(b),y(b))},g),f.addEventListener("pointerup",y,g),f.addEventListener("pointercancel",y,g);return}if(!d(this,Ho)){E(this,Ho,new AbortController);const c=AbortSignal.any([d(this,Qc),d(this,Ho).signal]),h=d(this,Hh),f={signal:c,capture:!1,passive:!1};h.addEventListener("touchmove",M(this,cc,iP).bind(this),f);const g=M(this,cc,sP).bind(this);h.addEventListener("touchend",g,f),h.addEventListener("touchcancel",g,f),f.capture=!0,h.addEventListener("pointerdown",Xt,f),h.addEventListener("pointermove",Xt,f),h.addEventListener("pointercancel",Xt,f),h.addEventListener("pointerup",Xt,f),(o=d(this,fm))==null||o.call(this)}if(Xt(e),e.touches.length!==2||(l=d(this,dm))!=null&&l.call(this)){E(this,Bo,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),E(this,Bo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},iP=function(e){var L;if(!d(this,Bo)||e.touches.length!==2)return;Xt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:l,screenY:c}=n,h=d(this,Bo),{touch0X:f,touch0Y:g,touch1X:y,touch1Y:b}=h,A=y-f,w=b-g,C=l-s,N=c-o,I=Math.hypot(C,N)||1,P=Math.hypot(A,w)||1;if(!d(this,jc)&&Math.abs(P-I)<=oC.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,!d(this,jc)){E(this,jc,!0);return}const k=[(s+l)/2,(o+c)/2];(L=d(this,pm))==null||L.call(this,k,P,I)},sP=function(e){var t;e.touches.length>=2||(d(this,Ho)&&(d(this,Ho).abort(),E(this,Ho,null),(t=d(this,gm))==null||t.call(this)),d(this,Bo)&&(Xt(e),E(this,Bo,null),E(this,jc,!1)))};let zg=oC;var eu,rr,zt,Rt,Go,Gh,Cl,mm,zn,tu,zo,Br,xl,ym,nu,ji,vm,iu,Vo,Hr,zh,Vh,zs,su,bm,Fb,De,zE,_m,VE,xv,rP,oP,qE,Rv,$E,aP,lP,cP,YE,uP,XE,dP,hP,fP,WE,gg;const Be=class Be{constructor(e){R(this,De);R(this,eu,null);R(this,rr,null);R(this,zt,null);R(this,Rt,null);R(this,Go,null);R(this,Gh,!1);R(this,Cl,null);R(this,mm,"");R(this,zn,null);R(this,tu,null);R(this,zo,null);R(this,Br,null);R(this,xl,null);R(this,ym,"");R(this,nu,!1);R(this,ji,null);R(this,vm,!1);R(this,iu,!1);R(this,Vo,!1);R(this,Hr,null);R(this,zh,0);R(this,Vh,0);R(this,zs,null);R(this,su,null);le(this,"isSelected",!1);le(this,"_isCopy",!1);le(this,"_editToolbar",null);le(this,"_initialOptions",Object.create(null));le(this,"_initialData",null);le(this,"_isVisible",!0);le(this,"_uiManager",null);le(this,"_focusEventsAllowed",!0);R(this,bm,!1);R(this,Fb,Be._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Be.prototype._resizeWithKeyboard,t=lc.TRANSLATE_SMALL,n=lc.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new Dy([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Be.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new nq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Be._l10n??(Be._l10n=e),Be._l10nResizer||(Be._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Be._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Be._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){kt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return d(this,bm)}set _isDraggable(e){var t;E(this,bm,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=d(this,Fb)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(M(this,De,gg).call(this),(t=d(this,Br))==null||t.remove(),E(this,Br,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(d(this,nu)?E(this,nu,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}translate(e,t){M(this,De,zE).call(this,this.parentDimensions,e,t)}translateInPage(e,t){d(this,ji)||E(this,ji,[this.x,this.y,this.width,this.height]),M(this,De,zE).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){d(this,ji)||E(this,ji,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!d(this,ji)&&(d(this,ji)[0]!==this.x||d(this,ji)[1]!==this.y)}get _hasBeenResized(){return!!d(this,ji)&&(d(this,ji)[2]!==this.width||d(this,ji)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Be,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=n,h*=s,o*=n,l*=s,this._mustFixPosition)switch(e){case 0:o=ii(o,0,n-c),l=ii(l,0,s-h);break;case 90:o=ii(o,0,n-h),l=ii(l,c,s);break;case 180:o=ii(o,c,n),l=ii(l,h,s);break;case 270:o=ii(o,h,n),l=ii(l,0,s-c);break}this.x=o/=n,this.y=l/=s;const[f,g]=this.getBaseTranslation();o+=f,l+=g,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return M(n=Be,_m,VE).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return M(n=Be,_m,VE).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=d(this,zt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||d(this,iu))return this._editToolbar;this._editToolbar=new ME(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=d(this,zt))==null||t.destroy()}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return d(this,zt)||(pb.initialize(Be._l10n),E(this,zt,new pb(this)),d(this,eu)&&(d(this,zt).data=d(this,eu),E(this,eu,null))),d(this,zt)}get altTextData(){var e;return(e=d(this,zt))==null?void 0:e.data}set altTextData(e){d(this,zt)&&(d(this,zt).data=e)}get guessedAltText(){var e;return(e=d(this,zt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=d(this,zt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=d(this,zt))==null?void 0:t.serialize(e)}hasAltText(){return!!d(this,zt)&&!d(this,zt).isEmpty()}hasAltTextData(){var e;return((e=d(this,zt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=d(this,Rt))==null||e.focusButton()}addCommentButton(){return d(this,Rt)||E(this,Rt,new dv(this))}addStandaloneCommentButton(){if(d(this,Go)){this._uiManager.isEditingMode()&&d(this,Go).classList.remove("hidden");return}this.hasComment&&(E(this,Go,d(this,Rt).renderForStandalone()),this.div.append(d(this,Go)))}removeStandaloneCommentButton(){d(this,Rt).removeStandaloneCommentButton(),E(this,Go,null)}hideStandaloneCommentButton(){var e;(e=d(this,Go))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=d(this,Rt);return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){d(this,Rt)||E(this,Rt,new dv(this)),d(this,Rt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(d(this,Rt)||E(this,Rt,new dv(this)),d(this,Rt).setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=d(this,Rt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=d(this,Rt))==null?void 0:e.isDeleted()}get hasComment(){return!!d(this,Rt)&&!d(this,Rt).isEmpty()&&!d(this,Rt).isDeleted()}async editComment(e){d(this,Rt)||E(this,Rt,new dv(this)),d(this,Rt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){d(this,Rt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,c=l+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){d(this,Rt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var l;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=d(this,Gh)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),M(this,De,XE).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),qk(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(d(this,su)||E(this,su,new zg({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,De,aP).bind(this),onPinching:M(this,De,lP).bind(this),onPinchEnd:M(this,De,cP).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(l=this._uiManager._editorUndoBar)==null||l.hide(),e}pointerdown(e){const{isMac:t}=Dn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(E(this,nu,!0),this._isDraggable){M(this,De,uP).call(this,e);return}M(this,De,YE).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){d(this,Hr)&&clearTimeout(d(this,Hr)),E(this,Hr,setTimeout(()=>{var e;E(this,Hr,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,g=t/s,y=this.x*o,b=this.y*l,A=this.width*o,w=this.height*l;switch(n){case 0:return[y+f+c,l-b-g-w+h,y+f+A+c,l-b-g+h];case 90:return[y+g+c,l-b+f+h,y+g+w+c,l-b+f+A+h];case 180:return[y-f-A+c,l-b+g+h,y-f+c,l-b+g+w+h];case 270:return[y-g-w+c,l-b-f-A+h,y-g+c,l-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,l]=e,c=o-n,h=l-s;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Be._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=d(this,Rt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:l},uid:c,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:f,modificationDate:n||g,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),E(this,iu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),E(this,iu,!1),!0):!1}isInEditMode(){return d(this,iu)}shouldGetKeyboardEvents(){return d(this,Vo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return t<l&&s>0&&e<o&&n>0}rebuild(){M(this,De,XE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,E(s,eu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[o,l]=s.pageDimensions,[c,h,f,g]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/o,s.y=h/l,s.width=f/o,s.height=g/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=d(this,xl))==null||e.abort(),E(this,xl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(this,Hr)&&(clearTimeout(d(this,Hr)),E(this,Hr,null)),M(this,De,gg).call(this),this.removeEditToolbar(),d(this,zs)){for(const n of d(this,zs).values())clearTimeout(n);E(this,zs,null)}this.parent=null,(t=d(this,su))==null||t.destroy(),E(this,su,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,De,rP).call(this),d(this,zn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,l]=this.getPDFRect();return[Be._round(n+(o-n)*e),Be._round(s+(l-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return d(this,Rt).commentPopupPositionInLayer}set commentPopupPosition(e){d(this,Rt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return d(this,Rt).hasDefaultPopupPosition()}get commentButtonWidth(){return d(this,Rt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){d(this,Rt).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),E(this,zo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=d(this,zn).children;if(!d(this,rr)){E(this,rr,Array.from(t));const l=M(this,De,dP).bind(this),c=M(this,De,hP).bind(this),h=this._uiManager._signal;for(const f of d(this,rr)){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",M(this,De,fP).bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",Be._l10nResizer[g])}}const n=d(this,rr)[0];let s=0;for(const l of t){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(d(this,rr).length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)d(this,zn).append(d(this,zn).firstChild);else if(o>s)for(let c=0;c<o-s;c++)d(this,zn).firstChild.before(d(this,zn).lastChild);let l=0;for(const c of t){const f=d(this,rr)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Be._l10nResizer[f])}}M(this,De,WE).call(this,0),E(this,Vo,!0),d(this,zn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){d(this,Vo)&&M(this,De,$E).call(this,d(this,ym),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,De,gg).call(this),this.div.focus()}select(){var e,t,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,o;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((o=this._editToolbar)==null||o.show())});return}(t=this._editToolbar)==null||t.show(),(n=d(this,zt))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,s,o;this.isSelected&&(this.isSelected=!1,(e=d(this,zn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(o=d(this,zt))==null||o.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return d(this,vm)}set isEditing(e){E(this,vm,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){d(this,zs)||E(this,zs,new Map);const{action:n}=e;let s=d(this,zs).get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),d(this,zs).delete(n),d(this,zs).size===0&&E(this,zs,null)},Be._telemetryTimeout),d(this,zs).set(n,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),E(this,Gh,!1)}disable(){this.div&&(this.div.tabIndex=-1),E(this,Gh,!0)}updateFakeAnnotationElement(e){if(!d(this,Br)&&!this.deleted){E(this,Br,e.addFakeAnnotation(this));return}if(this.deleted){d(this,Br).remove(),E(this,Br,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&d(this,Br).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};eu=new WeakMap,rr=new WeakMap,zt=new WeakMap,Rt=new WeakMap,Go=new WeakMap,Gh=new WeakMap,Cl=new WeakMap,mm=new WeakMap,zn=new WeakMap,tu=new WeakMap,zo=new WeakMap,Br=new WeakMap,xl=new WeakMap,ym=new WeakMap,nu=new WeakMap,ji=new WeakMap,vm=new WeakMap,iu=new WeakMap,Vo=new WeakMap,Hr=new WeakMap,zh=new WeakMap,Vh=new WeakMap,zs=new WeakMap,su=new WeakMap,bm=new WeakMap,Fb=new WeakMap,De=new WeakSet,zE=function([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},_m=new WeakSet,VE=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},xv=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},rP=function(){if(d(this,zn))return;E(this,zn,document.createElement("div")),d(this,zn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");d(this,zn).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",M(this,De,oP).bind(this,n),{signal:t}),s.addEventListener("contextmenu",vs,{signal:t}),s.tabIndex=-1}this.div.prepend(d(this,zn))},oP=function(e,t){var g;t.preventDefault();const{isMac:n}=Dn.platform;if(t.button!==0||t.ctrlKey&&n)return;(g=d(this,zt))==null||g.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,E(this,tu,[t.screenX,t.screenY]);const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,De,$E).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Xt,{passive:!1,signal:l}),window.addEventListener("contextmenu",vs,{signal:l}),E(this,zo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{var y;o.abort(),this.parent.togglePointerEvents(!0),(y=d(this,zt))==null||y.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,M(this,De,Rv).call(this)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},qE=function(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Rv=function(){if(!d(this,zo))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=d(this,zo);E(this,zo,null);const o=this.x,l=this.y,c=this.width,h=this.height;o===e&&l===t&&c===n&&h===s||this.addCommands({cmd:M(this,De,qE).bind(this,o,l,c,h),undo:M(this,De,qE).bind(this,e,t,n,s),mustExec:!0})},$E=function(e,t){const[n,s]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=Be.MIN_SIZE/n,g=Be.MIN_SIZE/s,y=M(this,De,xv).call(this,this.rotation),b=(G,$)=>[y[0]*G+y[2]*$,y[1]*G+y[3]*$],A=M(this,De,xv).call(this,360-this.rotation),w=(G,$)=>[A[0]*G+A[2]*$,A[1]*G+A[3]*$];let C,N,I=!1,P=!1;switch(e){case"topLeft":I=!0,C=(G,$)=>[0,0],N=(G,$)=>[G,$];break;case"topMiddle":C=(G,$)=>[G/2,0],N=(G,$)=>[G/2,$];break;case"topRight":I=!0,C=(G,$)=>[G,0],N=(G,$)=>[0,$];break;case"middleRight":P=!0,C=(G,$)=>[G,$/2],N=(G,$)=>[0,$/2];break;case"bottomRight":I=!0,C=(G,$)=>[G,$],N=(G,$)=>[0,0];break;case"bottomMiddle":C=(G,$)=>[G/2,$],N=(G,$)=>[G/2,0];break;case"bottomLeft":I=!0,C=(G,$)=>[0,$],N=(G,$)=>[G,0];break;case"middleLeft":P=!0,C=(G,$)=>[0,$/2],N=(G,$)=>[G,$/2];break}const k=C(c,h),L=N(c,h);let O=b(...L);const U=Be._round(o+O[0]),F=Be._round(l+O[1]);let K=1,q=1,Q,Z;if(t.fromKeyboard)({deltaX:Q,deltaY:Z}=t);else{const{screenX:G,screenY:$}=t,[ae,Se]=d(this,tu);[Q,Z]=this.screenToPageTranslation(G-ae,$-Se),d(this,tu)[0]=G,d(this,tu)[1]=$}if([Q,Z]=w(Q/n,Z/s),I){const G=Math.hypot(c,h);K=q=Math.max(Math.min(Math.hypot(L[0]-k[0]-Q,L[1]-k[1]-Z)/G,1/c,1/h),f/c,g/h)}else P?K=ii(Math.abs(L[0]-k[0]-Q),f,1)/c:q=ii(Math.abs(L[1]-k[1]-Z),g,1)/h;const oe=Be._round(c*K),ce=Be._round(h*q);O=b(...N(oe,ce));const ue=U-O[0],pe=F-O[1];d(this,ji)||E(this,ji,[this.x,this.y,this.width,this.height]),this.width=oe,this.height=ce,this.x=ue,this.y=pe,this.setDims(),this.fixAndSetPosition(),this._onResizing()},aP=function(){var e;E(this,zo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=d(this,zt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},lP=function(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const l=M(this,De,xv).call(this,this.rotation),c=(U,F)=>[l[0]*U+l[2]*F,l[1]*U+l[3]*F],[h,f]=this.parentDimensions,g=this.x,y=this.y,b=this.width,A=this.height,w=Be.MIN_SIZE/h,C=Be.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),w/b,C/A);const N=Be._round(b*o),I=Be._round(A*o);if(N===b&&I===A)return;d(this,ji)||E(this,ji,[g,y,b,A]);const P=c(b/2,A/2),k=Be._round(g+P[0]),L=Be._round(y+P[1]),O=c(N/2,I/2);this.x=k-O[0],this.y=L-O[1],this.width=N,this.height=I,this.setDims(),this.fixAndSetPosition(),this._onResizing()},cP=function(){var e;(e=d(this,zt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),M(this,De,Rv).call(this)},YE=function(e){const{isMac:t}=Dn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},uP=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),E(this,Cl,null),E(this,nu,!1),this._uiManager.endDragSession()||M(this,De,YE).call(this,f),n&&this._onStopDragging()};t&&(E(this,zh,e.clientX),E(this,Vh,e.clientY),E(this,Cl,e.pointerId),E(this,mm,e.pointerType),window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:y,pointerId:b}=f;if(b!==d(this,Cl)){Xt(f);return}const[A,w]=this.screenToPageTranslation(g-d(this,zh),y-d(this,Vh));E(this,zh,g),E(this,Vh,y),this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",Xt,l),window.addEventListener("pointerdown",f=>{f.pointerType===d(this,mm)&&(d(this,su)||f.isPrimary)&&c(f),Xt(f)},l));const h=f=>{if(!d(this,Cl)||d(this,Cl)===f.pointerId){c(f);return}Xt(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})},XE=function(){if(d(this,xl)||!this.div)return;E(this,xl,new AbortController);const e=this._uiManager.combinedSignal(d(this,xl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},dP=function(e){Be._resizerKeyboardManager.exec(this,e)},hP=function(e){var t;d(this,Vo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==d(this,zn)&&M(this,De,gg).call(this)},fP=function(e){E(this,ym,d(this,Vo)?e:"")},WE=function(e){if(d(this,rr))for(const t of d(this,rr))t.tabIndex=e},gg=function(){E(this,Vo,!1),M(this,De,WE).call(this,-1),M(this,De,Rv).call(this)},R(Be,_m),le(Be,"_l10n",null),le(Be,"_l10nResizer",null),le(Be,"_borderLineWidth",-1),le(Be,"_colorManager",new PE),le(Be,"_zIndex",1),le(Be,"_telemetryTimeout",1e3);let Lt=Be;class nq extends Lt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const uM=3285377520,ks=4294901760,Ir=65535;class pP{constructor(e){this.h1=e?e&4294967295:uM,this.h2=e?e&4294967295:uM}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let C=0,N=e.length;C<N;C++){const I=e.charCodeAt(C);I<=255?t[n++]=I:(t[n++]=I>>>8,t[n++]=I&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,g=this.h2;const y=3432918353,b=461845907,A=y&Ir,w=b&Ir;for(let C=0;C<s;C++)C&1?(c=l[C],c=c*y&ks|c*A&Ir,c=c<<15|c>>>17,c=c*b&ks|c*w&Ir,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[C],h=h*y&ks|h*A&Ir,h=h<<15|h>>>17,h=h*b&ks|h*w&Ir,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*y&ks|c*A&Ir,c=c<<15|c>>>17,c=c*b&ks|c*w&Ir,s&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ks|e*36045&Ir,t=t*4283543511&ks|((t<<16|e>>>16)*2950163797&ks)>>>16,e^=t>>>1,e=e*444984403&ks|e*60499&Ir,t=t*3301882366&ks|((t<<16|e>>>16)*3120437893&ks)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const KE=Object.freeze({map:null,hash:"",transfer:void 0});var ru,ou,qo,Vn,Bb,gP;class Mw{constructor(){R(this,Bb);R(this,ru,!1);R(this,ou,null);R(this,qo,null);R(this,Vn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=d(this,Vn).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return d(this,Vn).get(e)}remove(e){const t=d(this,Vn).get(e);if(t!==void 0&&(t instanceof Lt&&d(this,qo).delete(t.annotationElementId),d(this,Vn).delete(e),d(this,Vn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of d(this,Vn).values())if(n instanceof Lt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=d(this,Vn).get(e);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(t))n[o]!==l&&(s=!0,n[o]=l);else s=!0,d(this,Vn).set(e,t);s&&M(this,Bb,gP).call(this),t instanceof Lt&&((d(this,qo)||E(this,qo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return d(this,Vn).has(e)}get size(){return d(this,Vn).size}resetModified(){d(this,ru)&&(E(this,ru,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new mP(this)}get serializable(){if(d(this,Vn).size===0)return KE;const e=new Map,t=new pP,n=[],s=Object.create(null);let o=!1;for(const[l,c]of d(this,Vn)){const h=c instanceof Lt?c.serialize(!1,s):c;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),o||(o=!!h.bitmap))}if(o)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:KE}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of d(this,Vn).values()){if(!(o instanceof Lt)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const h=e[c]||(e[c]=new Map);for(const[f,g]of Object.entries(l)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(g)??0;y.set(g,b+1)}}if((s>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,l]of t)e[o]=l.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){E(this,ou,null)}updateEditor(e,t){var s;const n=(s=d(this,qo))==null?void 0:s.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=d(this,qo))==null?void 0:t.get(e))||null}get modifiedIds(){if(d(this,ou))return d(this,ou);const e=[];if(d(this,qo))for(const t of d(this,qo).values())t.serialize()&&e.push(t.annotationElementId);return E(this,ou,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return d(this,Vn).entries()}}ru=new WeakMap,ou=new WeakMap,qo=new WeakMap,Vn=new WeakMap,Bb=new WeakSet,gP=function(){d(this,ru)||(E(this,ru,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Sm;class mP extends Mw{constructor(t){super();R(this,Sm);const{map:n,hash:s,transfer:o}=t.serializable,l=structuredClone(n,o?{transfer:o}:null);E(this,Sm,{map:l,hash:s,transfer:o})}get print(){kt("Should not call PrintAnnotationStorage.print")}get serializable(){return d(this,Sm)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}Sm=new WeakMap;var qh;class iq{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){R(this,qh,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),d(this,qh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||d(this,qh).has(e.loadedName))){if(it(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:l}=e,c=new FontFace(s,o,l);this.addNativeFontFace(c);try{await c.load(),d(this,qh).add(s),n==null||n(e)}catch{Fe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}kt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Fe(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ve(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ve(this,"isSyncFontLoadingSupported",fi||Dn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(it(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ve(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,O){return L.charCodeAt(O)<<24|L.charCodeAt(O+1)<<16|L.charCodeAt(O+2)<<8|L.charCodeAt(O+3)&255}function s(L,O,U,F){const K=L.substring(0,O),q=L.substring(O+U);return K+F+q}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(L,O){if(++f>30){Fe("Load test font never loaded."),O();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,L,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=s(b,976,y.length,y);const w=16,C=1482184792;let N=n(b,w);for(o=0,l=y.length-3;o<l;o+=4)N=N-C+n(y,o)|0;o<y.length&&(N=N-C+n(y+"XXX",o)|0),b=s(b,w,4,qV(N));const I=`url(data:font/opentype;base64,${btoa(b)});`,P=`@font-face {font-family:"${y}";src:${I}}`;this.insertRule(P);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const L of[e.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=L,k.append(O)}this._document.body.append(k),g(y,()=>{k.remove(),t.complete()})}}qh=new WeakMap;var At;class sq{constructor(e,t=null,n,s){R(this,At);this.compiledGlyphs=Object.create(null),E(this,At,e),this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Dk(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Fe(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return d(this,At).black}get bold(){return d(this,At).bold}get disableFontFace(){return d(this,At).disableFontFace??!1}get fontExtraProperties(){return d(this,At).fontExtraProperties??!1}get isInvalidPDFjsFont(){return d(this,At).isInvalidPDFjsFont}get isType3Font(){return d(this,At).isType3Font}get italic(){return d(this,At).italic}get missingFile(){return d(this,At).missingFile}get remeasure(){return d(this,At).remeasure}get vertical(){return d(this,At).vertical}get ascent(){return d(this,At).ascent}get defaultWidth(){return d(this,At).defaultWidth}get descent(){return d(this,At).descent}get bbox(){return d(this,At).bbox}get fontMatrix(){return d(this,At).fontMatrix}get fallbackName(){return d(this,At).fallbackName}get loadedName(){return d(this,At).loadedName}get mimetype(){return d(this,At).mimetype}get name(){return d(this,At).name}get data(){return d(this,At).data}clearData(){d(this,At).clearData()}get cssFontInfo(){return d(this,At).cssFontInfo}get systemFontInfo(){return d(this,At).systemFontInfo}get defaultVMetrics(){return d(this,At).defaultVMetrics}}At=new WeakMap;function rq(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(fi)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function oq(i){if(fi&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return Iy(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hv(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const JE=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,aq=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",yP=WV.bind(null,JE,aq);var $o,Hb;class lq{constructor(){R(this,$o,new Map);R(this,Hb,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};d(this,Hb).then(()=>{for(const[s]of d(this,$o))s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:o}=n;if(o.aborted){Fe("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}d(this,$o).set(t,s)}removeEventListener(e,t){const n=d(this,$o).get(t);n==null||n(),d(this,$o).delete(t)}terminate(){for(const[,e]of d(this,$o))e==null||e();d(this,$o).clear()}}$o=new WeakMap,Hb=new WeakMap;const fv={DATA:1,ERROR:2},fn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function dM(){}function Ci(i){if(i instanceof Aa||i instanceof hb||i instanceof iM||i instanceof Bg||i instanceof $A)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||kt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Aa(i.message);case"InvalidPDFException":return new hb(i.message);case"PasswordException":return new iM(i.message,i.code);case"ResponseException":return new Bg(i.message,i.status,i.missing);case"UnknownErrorException":return new $A(i.message,i.details)}return new $A(i.message,i.toString())}var $h,Ks,vP,bP,_P,Iv;class mg{constructor(e,t,n){R(this,Ks);R(this,$h,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,Ks,vP).bind(this),{signal:d(this,$h).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,h.postMessage({sourceName:l,targetName:c,stream:fn.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{it(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:fn.CANCEL,streamId:o,reason:Ci(f)}),g.promise}},n)}destroy(){var e;(e=d(this,$h))==null||e.abort(),E(this,$h,null)}}$h=new WeakMap,Ks=new WeakSet,vP=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){M(this,Ks,_P).call(this,e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===fv.DATA)s.resolve(e.data);else if(e.callback===fv.ERROR)s.reject(Ci(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(l){o.postMessage({sourceName:n,targetName:s,callback:fv.DATA,callbackId:e.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:s,callback:fv.ERROR,callbackId:e.callbackId,reason:Ci(l)})});return}if(e.streamId){M(this,Ks,bP).call(this,e);return}t(e.data)},bP=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(f,g=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:fn.ENQUEUE,streamId:t,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:fn.CLOSE,streamId:t}),delete l.streamSinks[t])},error(f){it(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:fn.ERROR,streamId:t,reason:Ci(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fn.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fn.START_COMPLETE,streamId:t,reason:Ci(f)})})},_P=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case fn.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Ci(e.reason));break;case fn.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Ci(e.reason));break;case fn.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:fn.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||dM).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fn.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fn.PULL_COMPLETE,streamId:t,reason:Ci(f)})});break;case fn.ENQUEUE:if(it(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case fn.CLOSE:if(it(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),M(this,Ks,Iv).call(this,l,t);break;case fn.ERROR:it(l,"error should have stream controller"),l.controller.error(Ci(e.reason)),M(this,Ks,Iv).call(this,l,t);break;case fn.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Ci(e.reason)),M(this,Ks,Iv).call(this,l,t);break;case fn.CANCEL:if(!c)break;const h=Ci(e.reason);Promise.try(c.onCancel||dM,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fn.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fn.CANCEL_COMPLETE,streamId:t,reason:Ci(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Iv=async function(e,t){var n,s,o;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(s=e.pullCall)==null?void 0:s.promise,(o=e.cancelCall)==null?void 0:o.promise]),delete this.streamControllers[t]};var Am;class SP{constructor({enableHWA:e=!1}){R(this,Am,!1);E(this,Am,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!d(this,Am)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){kt("Abstract method `_createCanvas` called.")}}Am=new WeakMap;class cq extends SP{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class AP{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class hM extends AP{async _fetch(e){const t=await sp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Iy(t)}}class EP{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}var au,Yh,Yo,Xo,Zn,lu,cu,ge,Jn,yg,eh,Nv,th,TP,jE,nh,vg,bg,QE,_g;class uq extends EP{constructor({docId:t,ownerDocument:n=globalThis.document}){super();R(this,ge);R(this,au);R(this,Yh);R(this,Yo);R(this,Xo);R(this,Zn);R(this,lu);R(this,cu,0);E(this,Xo,t),E(this,Zn,n)}addFilter(t){if(!t)return"none";let n=d(this,ge,Jn).get(t);if(n)return n;const[s,o,l]=M(this,ge,Nv).call(this,t),c=t.length===1?s:`${s}${o}${l}`;if(n=d(this,ge,Jn).get(c),n)return d(this,ge,Jn).set(t,n),n;const h=`g_${d(this,Xo)}_transfer_map_${yn(this,cu)._++}`,f=M(this,ge,th).call(this,h);d(this,ge,Jn).set(t,f),d(this,ge,Jn).set(c,f);const g=M(this,ge,nh).call(this,h);return M(this,ge,bg).call(this,s,o,l,g),f}addHCMFilter(t,n){var w;const s=`${t}-${n}`,o="base";let l=d(this,ge,yg).get(o);if((l==null?void 0:l.key)===s||(l?((w=l.filter)==null||w.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},d(this,ge,yg).set(o,l)),!t||!n))return l.url;const c=M(this,ge,_g).call(this,t);t=ye.makeHexColor(...c);const h=M(this,ge,_g).call(this,n);if(n=ye.makeHexColor(...h),d(this,ge,eh).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const f=new Array(256);for(let C=0;C<=255;C++){const N=C/255;f[C]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const g=f.join(","),y=`g_${d(this,Xo)}_hcm_filter`,b=l.filter=M(this,ge,nh).call(this,y);M(this,ge,bg).call(this,g,g,g,b),M(this,ge,jE).call(this,b);const A=(C,N)=>{const I=c[C]/255,P=h[C]/255,k=new Array(N+1);for(let L=0;L<=N;L++)k[L]=I+L/N*(P-I);return k.join(",")};return M(this,ge,bg).call(this,A(0,5),A(1,5),A(2,5),b),l.url=M(this,ge,th).call(this,y),l.url}addAlphaFilter(t){let n=d(this,ge,Jn).get(t);if(n)return n;const[s]=M(this,ge,Nv).call(this,[t]),o=`alpha_${s}`;if(n=d(this,ge,Jn).get(o),n)return d(this,ge,Jn).set(t,n),n;const l=`g_${d(this,Xo)}_alpha_map_${yn(this,cu)._++}`,c=M(this,ge,th).call(this,l);d(this,ge,Jn).set(t,c),d(this,ge,Jn).set(o,c);const h=M(this,ge,nh).call(this,l);return M(this,ge,QE).call(this,s,h),c}addLuminosityFilter(t){let n=d(this,ge,Jn).get(t||"luminosity");if(n)return n;let s,o;if(t?([s]=M(this,ge,Nv).call(this,[t]),o=`luminosity_${s}`):o="luminosity",n=d(this,ge,Jn).get(o),n)return d(this,ge,Jn).set(t,n),n;const l=`g_${d(this,Xo)}_luminosity_map_${yn(this,cu)._++}`,c=M(this,ge,th).call(this,l);d(this,ge,Jn).set(t,c),d(this,ge,Jn).set(o,c);const h=M(this,ge,nh).call(this,l);return M(this,ge,TP).call(this,h),t&&M(this,ge,QE).call(this,s,h),c}addHighlightHCMFilter(t,n,s,o,l){var P;const c=`${n}-${s}-${o}-${l}`;let h=d(this,ge,yg).get(t);if((h==null?void 0:h.key)===c||(h?((P=h.filter)==null||P.remove(),h.key=c,h.url="none",h.filter=null):(h={key:c,url:"none",filter:null},d(this,ge,yg).set(t,h)),!n||!s))return h.url;const[f,g]=[n,s].map(M(this,ge,_g).bind(this));let y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),b=Math.round(.2126*g[0]+.7152*g[1]+.0722*g[2]),[A,w]=[o,l].map(M(this,ge,_g).bind(this));b<y&&([y,b,A,w]=[b,y,w,A]),d(this,ge,eh).style.color="";const C=(k,L,O)=>{const U=new Array(256),F=(b-y)/O,K=k/255,q=(L-k)/(255*O);let Q=0;for(let Z=0;Z<=O;Z++){const oe=Math.round(y+Z*F),ce=K+Z*q;for(let ue=Q;ue<=oe;ue++)U[ue]=ce;Q=oe+1}for(let Z=Q;Z<256;Z++)U[Z]=U[Q-1];return U.join(",")},N=`g_${d(this,Xo)}_hcm_${t}_filter`,I=h.filter=M(this,ge,nh).call(this,N);return M(this,ge,jE).call(this,I),M(this,ge,bg).call(this,C(A[0],w[0],5),C(A[1],w[1],5),C(A[2],w[2],5),I),h.url=M(this,ge,th).call(this,N),h.url}destroy(t=!1){var n,s,o,l;t&&((n=d(this,lu))!=null&&n.size)||((s=d(this,Yo))==null||s.parentNode.parentNode.remove(),E(this,Yo,null),(o=d(this,Yh))==null||o.clear(),E(this,Yh,null),(l=d(this,lu))==null||l.clear(),E(this,lu,null),E(this,cu,0))}}au=new WeakMap,Yh=new WeakMap,Yo=new WeakMap,Xo=new WeakMap,Zn=new WeakMap,lu=new WeakMap,cu=new WeakMap,ge=new WeakSet,Jn=function(){return d(this,Yh)||E(this,Yh,new Map)},yg=function(){return d(this,lu)||E(this,lu,new Map)},eh=function(){if(!d(this,Yo)){const t=d(this,Zn).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=d(this,Zn).createElementNS(Io,"svg");s.setAttribute("width",0),s.setAttribute("height",0),E(this,Yo,d(this,Zn).createElementNS(Io,"defs")),t.append(s),s.append(d(this,Yo)),d(this,Zn).body.append(t)}return d(this,Yo)},Nv=function(t){if(t.length===1){const f=t[0],g=new Array(256);for(let b=0;b<256;b++)g[b]=f[b]/255;const y=g.join(",");return[y,y,y]}const[n,s,o]=t,l=new Array(256),c=new Array(256),h=new Array(256);for(let f=0;f<256;f++)l[f]=n[f]/255,c[f]=s[f]/255,h[f]=o[f]/255;return[l.join(","),c.join(","),h.join(",")]},th=function(t){if(d(this,au)===void 0){E(this,au,"");const n=d(this,Zn).URL;n!==d(this,Zn).baseURI&&(My(n)?Fe('#createUrl: ignore "data:"-URL for performance reasons.'):E(this,au,Cw(n,"")))}return`url(${d(this,au)}#${t})`},TP=function(t){const n=d(this,Zn).createElementNS(Io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},jE=function(t){const n=d(this,Zn).createElementNS(Io,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},nh=function(t){const n=d(this,Zn).createElementNS(Io,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),d(this,ge,eh).append(n),n},vg=function(t,n,s){const o=d(this,Zn).createElementNS(Io,n);o.setAttribute("type","discrete"),o.setAttribute("tableValues",s),t.append(o)},bg=function(t,n,s,o){const l=d(this,Zn).createElementNS(Io,"feComponentTransfer");o.append(l),M(this,ge,vg).call(this,l,"feFuncR",t),M(this,ge,vg).call(this,l,"feFuncG",n),M(this,ge,vg).call(this,l,"feFuncB",s)},QE=function(t,n){const s=d(this,Zn).createElementNS(Io,"feComponentTransfer");n.append(s),M(this,ge,vg).call(this,s,"feFuncA",t)},_g=function(t){return d(this,ge,eh).style.color=t,rp(getComputedStyle(d(this,ge,eh)).getPropertyValue("color"))};class wP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class fM extends wP{async _fetch(e){const t=await sp(e,"arraybuffer");return new Uint8Array(t)}}class CP{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){kt("Abstract method `_fetch` called.")}}class pM extends CP{async _fetch(e){const t=await sp(e,"arraybuffer");return new Uint8Array(t)}}fi&&Fe("Please use the `legacy` build in Node.js environments.");async function Dw(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class dq extends EP{}class hq extends SP{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class fq extends AP{async _fetch(e){return Dw(e)}}class pq extends wP{async _fetch(e){return Dw(e)}}class gq extends CP{async _fetch(e){return Dw(e)}}const Jd="__forcedDependency",{floor:gM,ceil:mM}=Math;function pv(i,e,t,n,s,o){i[e*4+0]=Math.min(i[e*4+0],t),i[e*4+1]=Math.min(i[e*4+1],n),i[e*4+2]=Math.max(i[e*4+2],s),i[e*4+3]=Math.max(i[e*4+3],o)}const ZE=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Xh,Rl;class mq{constructor(e,t){R(this,Xh);R(this,Rl);E(this,Xh,e),E(this,Rl,t)}get length(){return d(this,Xh).length}isEmpty(e){return d(this,Xh)[e]===ZE}minX(e){return d(this,Rl)[e*4+0]/256}minY(e){return d(this,Rl)[e*4+1]/256}maxX(e){return(d(this,Rl)[e*4+2]+1)/256}maxY(e){return(d(this,Rl)[e*4+3]+1)/256}}Xh=new WeakMap,Rl=new WeakMap;const gv=(i,e)=>{if(!i)return;let t=i.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},i.set(e,t)),t};var Ii,Ni,uu,or,du,Wo,vt,Et,Ko,Mi,Em,Wh,hu,fu,Jo,ei,Gr,Tm,eT;class yq{constructor(e,t,n=!1){R(this,Tm);R(this,Ii,{__proto__:null});R(this,Ni,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Jd]:[]});R(this,uu,new Map);R(this,or,[]);R(this,du,[]);R(this,Wo,[[1,0,0,1,0,0]]);R(this,vt,[-1/0,-1/0,1/0,1/0]);R(this,Et,new Float64Array([1/0,1/0,-1/0,-1/0]));R(this,Ko,-1);R(this,Mi,new Set);R(this,Em,new Map);R(this,Wh,new Map);R(this,hu);R(this,fu);R(this,Jo);R(this,ei);R(this,Gr);E(this,hu,e.width),E(this,fu,e.height),M(this,Tm,eT).call(this,t),n&&E(this,Gr,new Map)}growOperationsCount(e){e>=d(this,ei).length&&M(this,Tm,eT).call(this,e,d(this,ei))}save(e){return E(this,Ii,{__proto__:d(this,Ii)}),E(this,Ni,{__proto__:d(this,Ni),transform:{__proto__:d(this,Ni).transform},moveText:{__proto__:d(this,Ni).moveText},sameLineText:{__proto__:d(this,Ni).sameLineText},[Jd]:{__proto__:d(this,Ni)[Jd]}}),E(this,vt,{__proto__:d(this,vt)}),d(this,or).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(d(this,Ii));if(t===null)return this;E(this,Ii,t),E(this,Ni,Object.getPrototypeOf(d(this,Ni))),E(this,vt,Object.getPrototypeOf(d(this,vt)));const n=d(this,or).pop();return n!==void 0&&((s=gv(d(this,Gr),e))==null||s.dependencies.add(n),d(this,ei)[e]=d(this,ei)[n]),this}recordOpenMarker(e){return d(this,or).push(e),this}getOpenMarker(){return d(this,or).length===0?null:d(this,or).at(-1)}recordCloseMarker(e){var n;const t=d(this,or).pop();return t!==void 0&&((n=gv(d(this,Gr),e))==null||n.dependencies.add(t),d(this,ei)[e]=d(this,ei)[t]),this}beginMarkedContent(e){return d(this,du).push(e),this}endMarkedContent(e){var n;const t=d(this,du).pop();return t!==void 0&&((n=gv(d(this,Gr),e))==null||n.dependencies.add(t),d(this,ei)[e]=d(this,ei)[t]),this}pushBaseTransform(e){return d(this,Wo).push(ye.multiplyByDOMMatrix(d(this,Wo).at(-1),e.getTransform())),this}popBaseTransform(){return d(this,Wo).length>1&&d(this,Wo).pop(),this}recordSimpleData(e,t){return d(this,Ii)[e]=t,this}recordIncrementalData(e,t){return d(this,Ni)[e].push(t),this}resetIncrementalData(e,t){return d(this,Ni)[e].length=0,this}recordNamedData(e,t){return d(this,uu).set(e,t),this}recordSimpleDataFromNamed(e,t,n){d(this,Ii)[e]=d(this,uu).get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Jd,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in d(this,Ii)&&this.recordFutureForcedDependency(t,d(this,Ii)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of d(this,Mi))this.recordFutureForcedDependency(Jd,e);return this}resetBBox(e){return d(this,Ko)!==e&&(E(this,Ko,e),d(this,Et)[0]=1/0,d(this,Et)[1]=1/0,d(this,Et)[2]=-1/0,d(this,Et)[3]=-1/0),this}recordClipBox(e,t,n,s,o,l){const c=ye.multiplyByDOMMatrix(d(this,Wo).at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];ye.axialAlignedBoundingBox([n,o,s,l],c,h);const f=ye.intersect(d(this,vt),h);return f?(d(this,vt)[0]=f[0],d(this,vt)[1]=f[1],d(this,vt)[2]=f[2],d(this,vt)[3]=f[3]):(d(this,vt)[0]=d(this,vt)[1]=1/0,d(this,vt)[2]=d(this,vt)[3]=-1/0),this}recordBBox(e,t,n,s,o,l){const c=d(this,vt);if(c[0]===1/0)return this;const h=ye.multiplyByDOMMatrix(d(this,Wo).at(-1),t.getTransform());if(c[0]===-1/0)return ye.axialAlignedBoundingBox([n,o,s,l],h,d(this,Et)),this;const f=[1/0,1/0,-1/0,-1/0];return ye.axialAlignedBoundingBox([n,o,s,l],h,f),d(this,Et)[0]=Math.min(d(this,Et)[0],Math.max(f[0],c[0])),d(this,Et)[1]=Math.min(d(this,Et)[1],Math.max(f[1],c[1])),d(this,Et)[2]=Math.max(d(this,Et)[2],Math.min(f[2],c[2])),d(this,Et)[3]=Math.max(d(this,Et)[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,l=0,c){const h=n.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&d(this,Wh).get(n),f!==!1&&(g=[0,0,0,0],ye.axialAlignedBoundingBox(h,n.fontMatrix,g),(s!==1||o!==0||l!==0)&&ye.scaleMinMax([s,0,0,-s,o,l],g),f)))return this.recordBBox(e,t,g[0],g[2],g[1],g[3]);if(!c)return this.recordFullPageBBox(e);const y=c();return h&&g&&f===void 0&&(f=g[0]<=o-y.actualBoundingBoxLeft&&g[2]>=o+y.actualBoundingBoxRight&&g[1]<=l-y.actualBoundingBoxAscent&&g[3]>=l+y.actualBoundingBoxDescent,d(this,Wh).set(n,f),f)?this.recordBBox(e,t,g[0],g[2],g[1],g[3]):this.recordBBox(e,t,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(e){return d(this,Et)[0]=Math.max(0,d(this,vt)[0]),d(this,Et)[1]=Math.max(0,d(this,vt)[1]),d(this,Et)[2]=Math.min(d(this,hu),d(this,vt)[2]),d(this,Et)[3]=Math.min(d(this,fu),d(this,vt)[3]),this}getSimpleIndex(e){return d(this,Ii)[e]}recordDependencies(e,t){const n=d(this,Mi),s=d(this,Ii),o=d(this,Ni);for(const l of t)l in d(this,Ii)?n.add(s[l]):l in o&&o[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return d(this,uu).has(t)&&d(this,Mi).add(d(this,uu).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Jd]),d(this,Gr)){const n=gv(d(this,Gr),e),{dependencies:s}=n;d(this,Mi).forEach(s.add,s),d(this,or).forEach(s.add,s),d(this,du).forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(d(this,Ko)===e){const n=gM(d(this,Et)[0]*256/d(this,hu)),s=gM(d(this,Et)[1]*256/d(this,fu)),o=mM(d(this,Et)[2]*256/d(this,hu)),l=mM(d(this,Et)[3]*256/d(this,fu));pv(d(this,Jo),e,n,s,o,l);for(const c of d(this,Mi))c!==e&&pv(d(this,Jo),c,n,s,o,l);for(const c of d(this,or))c!==e&&pv(d(this,Jo),c,n,s,o,l);for(const c of d(this,du))c!==e&&pv(d(this,Jo),c,n,s,o,l);t||(d(this,Mi).clear(),E(this,Ko,-1))}return this}recordShowTextOperation(e,t=!1){const n=Array.from(d(this,Mi));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return d(this,Ko)===e&&(E(this,Ko,-1),d(this,vt)[0]=Math.max(d(this,vt)[0],d(this,Et)[0]),d(this,vt)[1]=Math.max(d(this,vt)[1],d(this,Et)[1]),d(this,vt)[2]=Math.min(d(this,vt)[2],d(this,Et)[2]),d(this,vt)[3]=Math.min(d(this,vt)[3],d(this,Et)[3]),t||d(this,Mi).clear()),this}_takePendingDependencies(){const e=d(this,Mi);return E(this,Mi,new Set),e}_extractOperation(e){const t=d(this,Em).get(e);return d(this,Em).delete(e),t}_pushPendingDependencies(e){for(const t of e)d(this,Mi).add(t)}take(){return d(this,Wh).clear(),new mq(d(this,ei),d(this,Jo))}takeDebugMetadata(){return d(this,Gr)}}Ii=new WeakMap,Ni=new WeakMap,uu=new WeakMap,or=new WeakMap,du=new WeakMap,Wo=new WeakMap,vt=new WeakMap,Et=new WeakMap,Ko=new WeakMap,Mi=new WeakMap,Em=new WeakMap,Wh=new WeakMap,hu=new WeakMap,fu=new WeakMap,Jo=new WeakMap,ei=new WeakMap,Gr=new WeakMap,Tm=new WeakSet,eT=function(e,t){const n=new ArrayBuffer(e*4);E(this,Jo,new Uint8ClampedArray(n)),E(this,ei,new Uint32Array(n)),t&&t.length>0?(d(this,ei).set(t),d(this,ei).fill(ZE,t.length)):d(this,ei).fill(ZE)};var It,Zt,ar,Kh,Jh;const aC=class aC{constructor(e,t,n){R(this,It);R(this,Zt);R(this,ar);R(this,Kh,0);R(this,Jh,0);if(e instanceof aC&&d(e,ar)===!!n)return e;E(this,It,e),E(this,Zt,t),E(this,ar,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){return yn(this,Jh)._++,d(this,It).save(d(this,Zt)),this}restore(e){return d(this,Jh)>0&&(d(this,It).restore(d(this,Zt)),yn(this,Jh)._--),this}recordOpenMarker(e){return yn(this,Kh)._++,this}getOpenMarker(){return d(this,Kh)>0?d(this,Zt):d(this,It).getOpenMarker()}recordCloseMarker(e){return yn(this,Kh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return d(this,It).pushBaseTransform(e),this}popBaseTransform(){return d(this,It).popBaseTransform(),this}recordSimpleData(e,t){return d(this,It).recordSimpleData(e,d(this,Zt)),this}recordIncrementalData(e,t){return d(this,It).recordIncrementalData(e,d(this,Zt)),this}resetIncrementalData(e,t){return d(this,It).resetIncrementalData(e,d(this,Zt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return d(this,It).recordSimpleDataFromNamed(e,t,d(this,Zt)),this}recordFutureForcedDependency(e,t){return d(this,It).recordFutureForcedDependency(e,d(this,Zt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return d(this,It).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return d(this,It).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return d(this,ar)||d(this,It).resetBBox(d(this,Zt)),this}recordClipBox(e,t,n,s,o,l){return d(this,ar)||d(this,It).recordClipBox(d(this,Zt),t,n,s,o,l),this}recordBBox(e,t,n,s,o,l){return d(this,ar)||d(this,It).recordBBox(d(this,Zt),t,n,s,o,l),this}recordCharacterBBox(e,t,n,s,o,l,c){return d(this,ar)||d(this,It).recordCharacterBBox(d(this,Zt),t,n,s,o,l,c),this}recordFullPageBBox(e){return d(this,ar)||d(this,It).recordFullPageBBox(d(this,Zt)),this}getSimpleIndex(e){return d(this,It).getSimpleIndex(e)}recordDependencies(e,t){return d(this,It).recordDependencies(d(this,Zt),t),this}recordNamedDependency(e,t){return d(this,It).recordNamedDependency(d(this,Zt),t),this}recordOperation(e){return d(this,It).recordOperation(d(this,Zt),!0),this}recordShowTextOperation(e){return d(this,It).recordShowTextOperation(d(this,Zt),!0),this}bboxToClipBoxDropOperation(e){return d(this,ar)||d(this,It).bboxToClipBoxDropOperation(d(this,Zt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};It=new WeakMap,Zt=new WeakMap,ar=new WeakMap,Kh=new WeakMap,Jh=new WeakMap;let gb=aC;const Ps={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Yn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function tT(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class kw{isModifyingCurrentTransform(){return!1}getPattern(){kt("Abstract method `getPattern` called.")}}class vq extends kw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===Yn.STROKE||s===Yn.FILL){const l=t.current.getClippedPathBoundingBox(s,Yt(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=ye.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...t.baseTransform),this.matrix&&g.transform(...this.matrix),tT(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=e.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);o.setTransform(y)}else tT(e,this._bbox),o=this._createGradient(e);return o}}function WA(i,e,t,n,s,o,l,c){const h=e.coords,f=e.colors,g=i.data,y=i.width*4;let b;h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b),h[n+1]>h[s+1]&&(b=n,n=s,s=b,b=l,l=c,c=b),h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b);const A=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,C=(h[n]+e.offsetX)*e.scaleX,N=(h[n+1]+e.offsetY)*e.scaleY,I=(h[s]+e.offsetX)*e.scaleX,P=(h[s+1]+e.offsetY)*e.scaleY;if(w>=P)return;const k=f[o],L=f[o+1],O=f[o+2],U=f[l],F=f[l+1],K=f[l+2],q=f[c],Q=f[c+1],Z=f[c+2],oe=Math.round(w),ce=Math.round(P);let ue,pe,G,$,ae,Se,Ie,H;for(let J=oe;J<=ce;J++){if(J<N){const Ae=J<w?0:(w-J)/(w-N);ue=A-(A-C)*Ae,pe=k-(k-U)*Ae,G=L-(L-F)*Ae,$=O-(O-K)*Ae}else{let Ae;J>P?Ae=1:N===P?Ae=0:Ae=(N-J)/(N-P),ue=C-(C-I)*Ae,pe=U-(U-q)*Ae,G=F-(F-Q)*Ae,$=K-(K-Z)*Ae}let se;J<w?se=0:J>P?se=1:se=(w-J)/(w-P),ae=A-(A-I)*se,Se=k-(k-q)*se,Ie=L-(L-Q)*se,H=O-(O-Z)*se;const de=Math.round(Math.min(ue,ae)),ve=Math.round(Math.max(ue,ae));let Re=y*J+de*4;for(let Ae=de;Ae<=ve;Ae++)se=(ue-Ae)/(ue-ae),se<0?se=0:se>1&&(se=1),g[Re++]=pe-(pe-Se)*se|0,g[Re++]=G-(G-Ie)*se|0,g[Re++]=$-($-H)*se|0,g[Re++]=255}}function bq(i,e,t){const n=e.coords,s=e.colors;let o,l;switch(e.type){case"lattice":const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let g=o*c;for(let y=0;y<f;y++,g++)WA(i,t,n[g],n[g+1],n[g+c],s[g],s[g+1],s[g+c]),WA(i,t,n[g+c+1],n[g+1],n[g+c],s[g+c+1],s[g+1],s[g+c])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)WA(i,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class _q extends kw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*e[1]*1.1)),3e3),A=f/y,w=g/b,C={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/A,scaleY:1/w},N=y+4,I=b+4,P=n.getCanvas("mesh",N,I),k=P.context,L=k.createImageData(y,b);if(t){const U=L.data;for(let F=0,K=U.length;F<K;F+=4)U[F]=t[0],U[F+1]=t[1],U[F+2]=t[2],U[F+3]=255}for(const U of this._figures)bq(L,U,C);return k.putImageData(L,2,2),{canvas:P.canvas,offsetX:c-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){tT(e,this._bbox);const o=new Float32Array(2);if(s===Yn.SHADING)ye.singularValueDecompose2dScale(Yt(e),o);else if(this.matrix){ye.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;ye.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else ye.singularValueDecompose2dScale(t.baseTransform,o);const l=this._createMeshCanvas(o,s===Yn.SHADING?null:this._background,t.cachedCanvases);return s!==Yn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class Sq extends kw{getPattern(){return"hotpink"}}function Aq(i){switch(i[0]){case"RadialAxial":return new vq(i);case"Mesh":return new _q(i);case"Dummy":return new Sq}throw new Error(`Unknown IR type: ${i[0]}`)}const yM={COLORED:1,UNCOLORED:2},Gb=class Gb{constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){var Se,Ie;const{bbox:n,operatorList:s,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),o_("TilingType: "+l);const y=n[0],b=n[1],A=n[2],w=n[3],C=A-y,N=w-b,I=new Float32Array(2);ye.singularValueDecompose2dScale(this.matrix,I);const[P,k]=I;ye.singularValueDecompose2dScale(this.baseTransform,I);const L=P*I[0],O=k*I[1];let U=C,F=N,K=!1,q=!1;const Q=Math.ceil(f*L),Z=Math.ceil(g*O),oe=Math.ceil(C*L),ce=Math.ceil(N*O);Q>=oe?U=f:K=!0,Z>=ce?F=g:q=!0;const ue=this.getSizeAndScale(U,this.ctx.canvas.width,L),pe=this.getSizeAndScale(F,this.ctx.canvas.height,O),G=e.cachedCanvases.getCanvas("pattern",ue.size,pe.size),$=G.context,ae=h.createCanvasGraphics($,t);if(ae.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ae,o,c),$.translate(-ue.scale*y,-pe.scale*b),ae.transform(0,ue.scale,0,0,pe.scale,0,0),$.save(),(Se=ae.dependencyTracker)==null||Se.save(),this.clipBbox(ae,y,b,A,w),ae.baseTransform=Yt(ae.ctx),ae.executeOperatorList(s),ae.endDrawing(),(Ie=ae.dependencyTracker)==null||Ie.restore(),$.restore(),K||q){const H=G.canvas;K&&(U=f),q&&(F=g);const J=this.getSizeAndScale(U,this.ctx.canvas.width,L),se=this.getSizeAndScale(F,this.ctx.canvas.height,O),de=J.size,ve=se.size,Re=e.cachedCanvases.getCanvas("pattern-workaround",de,ve),Ae=Re.context,ft=K?Math.floor(C/f):0,Qe=q?Math.floor(N/g):0;for(let qt=0;qt<=ft;qt++)for(let Xe=0;Xe<=Qe;Xe++)Ae.drawImage(H,de*qt,ve*Xe,de,ve,0,0,de,ve);return{canvas:Re.canvas,scaleX:J.scale,scaleY:se.scale,offsetX:y,offsetY:b}}return{canvas:G.canvas,scaleX:ue.scale,scaleY:pe.scale,offsetX:y,offsetY:b}}getSizeAndScale(e,t,n){const s=Math.max(Gb.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const l=s-t,c=o-n;e.ctx.rect(t,n,l,c),ye.axialAlignedBoundingBox([t,n,s,o],Yt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case yM.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=l,s.strokeStyle=o.strokeColor=c;break;case yM.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new VV(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let l=n;s!==Yn.SHADING&&(l=ye.transform(l,t.baseTransform),this.matrix&&(l=ye.transform(l,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}};le(Gb,"MAX_PATTERN_SIZE",3e3);let nT=Gb;function Eq({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=Dn.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],g=n>>3,y=n&7,b=i.length;t=new Uint32Array(t.buffer);let A=0;for(let w=0;w<s;w++){for(const N=e+g;e<N;e++){const I=e<b?i[e]:255;t[A++]=I&128?f:h,t[A++]=I&64?f:h,t[A++]=I&32?f:h,t[A++]=I&16?f:h,t[A++]=I&8?f:h,t[A++]=I&4?f:h,t[A++]=I&2?f:h,t[A++]=I&1?f:h}if(y===0)continue;const C=e<b?i[e++]:255;for(let N=0;N<y;N++)t[A++]=C&1<<7-N?f:h}return{srcPos:e,destPos:A}}const vM=16,bM=100,Tq=15,_M=10,Li=16,KA=new DOMMatrix,fs=new Float32Array(2),lh=new Float32Array([1/0,1/0,-1/0,-1/0]);function wq(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,s,o,l,c){e.transform(t,n,s,o,l,c),this.__originalTransform(t,n,s,o,l,c)},i.setTransform=function(t,n,s,o,l,c){e.setTransform(t,n,s,o,l,c),this.__originalSetTransform(t,n,s,o,l,c)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,o,l,c){e.bezierCurveTo(t,n,s,o,l,c),this.__originalBezierCurveTo(t,n,s,o,l,c)},i.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Cq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function mv(i,e,t,n,s,o,l,c,h,f){const[g,y,b,A,w,C]=Yt(i);if(y===0&&b===0){const P=l*g+w,k=Math.round(P),L=c*A+C,O=Math.round(L),U=(l+h)*g+w,F=Math.abs(Math.round(U)-k)||1,K=(c+f)*A+C,q=Math.abs(Math.round(K)-O)||1;return i.setTransform(Math.sign(g),0,0,Math.sign(A),k,O),i.drawImage(e,t,n,s,o,0,0,F,q),i.setTransform(g,y,b,A,w,C),[F,q]}if(g===0&&A===0){const P=c*b+w,k=Math.round(P),L=l*y+C,O=Math.round(L),U=(c+f)*b+w,F=Math.abs(Math.round(U)-k)||1,K=(l+h)*y+C,q=Math.abs(Math.round(K)-O)||1;return i.setTransform(0,Math.sign(y),Math.sign(b),0,k,O),i.drawImage(e,t,n,s,o,0,0,q,F),i.setTransform(g,y,b,A,w,C),[q,F]}i.drawImage(e,t,n,s,o,l,c,h,f);const N=Math.hypot(g,y),I=Math.hypot(b,A);return[N*h,I*f]}class SM{constructor(e,t,n){le(this,"alphaIsShape",!1);le(this,"fontSize",0);le(this,"fontSizeScale",1);le(this,"textMatrix",null);le(this,"textMatrixScale",1);le(this,"fontMatrix",RE);le(this,"leading",0);le(this,"x",0);le(this,"y",0);le(this,"lineX",0);le(this,"lineY",0);le(this,"charSpacing",0);le(this,"wordSpacing",0);le(this,"textHScale",1);le(this,"textRenderingMode",Hn.FILL);le(this,"textRise",0);le(this,"fillColor","#000000");le(this,"strokeColor","#000000");le(this,"patternFill",!1);le(this,"patternStroke",!1);le(this,"fillAlpha",1);le(this,"strokeAlpha",1);le(this,"lineWidth",1);le(this,"activeSMask",null);le(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=lh.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Yn.FILL,t=null){const n=this.minMax.slice();if(e===Yn.STROKE){t||kt("Stroke bounding box must include transform."),ye.singularValueDecompose2dScale(t,fs);const s=fs[0]*this.lineWidth/2,o=fs[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=ye.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(lh,0)}getClippedPathBoundingBox(e=Yn.FILL,t=null){return ye.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function AM(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%Li,o=(t-s)/Li,l=s===0?o:o+1,c=i.createImageData(n,Li);let h=0,f;const g=e.data,y=c.data;let b,A,w,C;if(e.kind===Pg.GRAYSCALE_1BPP){const N=g.byteLength,I=new Uint32Array(y.buffer,0,y.byteLength>>2),P=I.length,k=n+7>>3,L=4294967295,O=Dn.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(w=b<o?Li:s,f=0,A=0;A<w;A++){const U=N-h;let F=0;const K=U>k?n:U*8-7,q=K&-8;let Q=0,Z=0;for(;F<q;F+=8)Z=g[h++],I[f++]=Z&128?L:O,I[f++]=Z&64?L:O,I[f++]=Z&32?L:O,I[f++]=Z&16?L:O,I[f++]=Z&8?L:O,I[f++]=Z&4?L:O,I[f++]=Z&2?L:O,I[f++]=Z&1?L:O;for(;F<K;F++)Q===0&&(Z=g[h++],Q=128),I[f++]=Z&Q?L:O,Q>>=1}for(;f<P;)I[f++]=0;i.putImageData(c,0,b*Li)}}else if(e.kind===Pg.RGBA_32BPP){for(A=0,C=n*Li*4,b=0;b<o;b++)y.set(g.subarray(h,h+C)),h+=C,i.putImageData(c,0,A),A+=Li;b<l&&(C=n*s*4,y.set(g.subarray(h,h+C)),i.putImageData(c,0,A))}else if(e.kind===Pg.RGB_24BPP)for(w=Li,C=n*w,b=0;b<l;b++){for(b>=o&&(w=s,C=n*w),f=0,A=C;A--;)y[f++]=g[h++],y[f++]=g[h++],y[f++]=g[h++],y[f++]=255;i.putImageData(c,0,b*Li)}else throw new Error(`bad image kind: ${e.kind}`)}function EM(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%Li,o=(t-s)/Li,l=s===0?o:o+1,c=i.createImageData(n,Li);let h=0;const f=e.data,g=c.data;for(let y=0;y<l;y++){const b=y<o?Li:s;({srcPos:h}=Eq({src:f,srcPos:h,dest:g,width:n,height:b,nonBlackColor:0})),i.putImageData(c,0,y*Li)}}function rg(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function yv(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function TM(i,e){if(e)return!0;ye.singularValueDecompose2dScale(i,fs);const t=Math.fround(_r.pixelRatio*Ea.PDF_TO_CSS_UNITS);return fs[0]<=t&&fs[1]<=t}const xq=["butt","round","square"],Rq=["miter","round","bevel"],Iq={},wM={};var Ar,iT,sT,rT;const lC=class lC{constructor(e,t,n,s,o,{optionalContentConfig:l,markedContentStack:c=null},h,f,g){R(this,Ar);this.ctx=e,this.current=new SM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Cq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(e,t,n=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Yt(this.compositeCtx))}this.ctx.save(),yv(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Yt(this.ctx)}executeOperatorList(e,t,n,s,o){var I;const l=e.argsArray,c=e.fnArray;let h=t||0;const f=l.length;if(f===h)return h;const g=f-h>_M&&typeof n=="function",y=g?Date.now()+Tq:0;let b=0;const A=this.commonObjs,w=this.objs;let C,N;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(C=c[h],N=l[h]??null,C!==jf.dependency)N===null?this[C](h):this[C](h,...N);else for(const P of N){(I=this.dependencyTracker)==null||I.recordNamedData(P,h);const k=P.startsWith("g_")?A:w;if(!k.has(P))return k.get(P,n),h}if(h++,h===f)return h;if(g&&++b>_M){if(Date.now()>y)return n(),h;b=0}}}endDrawing(){M(this,Ar,iT).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),M(this,Ar,sT).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",g,y;for(;o>2&&c>1||l>2&&h>1;){let b=c,A=h;o>2&&c>1&&(b=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/b),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),g=this.cachedCanvases.getCanvas(f,b,A),y=g.context,y.clearRect(0,0,b,A),y.drawImage(e,0,0,c,h,0,0,b,A),e=g.canvas,c=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){var Q,Z;const n=this.ctx,{width:s,height:o}=t,l=this.current.fillColor,c=this.current.patternFill,h=Yt(n);let f,g,y,b;if((t.bitmap||t.data)&&t.count>1){const oe=t.bitmap||t.data.buffer;g=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(oe),f||(f=new Map,this._cachedBitmapsMap.set(oe,f));const ce=f.get(g);if(ce&&!c){const ue=Math.round(Math.min(h[0],h[2])+h[4]),pe=Math.round(Math.min(h[1],h[3])+h[5]);return(Q=this.dependencyTracker)==null||Q.recordDependencies(e,Ps.transformAndFill),{canvas:ce,offsetX:ue,offsetY:pe}}y=ce}y||(b=this.cachedCanvases.getCanvas("maskCanvas",s,o),EM(b.context,t));let A=ye.transform(h,[1/s,0,0,-1/o,0,0]);A=ye.transform(A,[1,0,0,1,0,-o]);const w=lh.slice();ye.axialAlignedBoundingBox([0,0,s,o],A,w);const[C,N,I,P]=w,k=Math.round(I-C)||1,L=Math.round(P-N)||1,O=this.cachedCanvases.getCanvas("fillCanvas",k,L),U=O.context,F=C,K=N;U.translate(-F,-K),U.transform(...A),y||(y=this._scaleImage(b.canvas,Rr(U)),y=y.img,f&&c&&f.set(g,y)),U.imageSmoothingEnabled=TM(Yt(U),t.interpolate),mv(U,y,0,0,y.width,y.height,0,0,s,o),U.globalCompositeOperation="source-in";const q=ye.transform(Rr(U),[1,0,0,1,-F,-K]);return U.fillStyle=c?l.getPattern(n,this,q,Yn.FILL,e):l,U.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),(Z=this.dependencyTracker)==null||Z.recordDependencies(e,Ps.transformAndFill),{canvas:O.canvas,offsetX:Math.round(F),offsetY:Math.round(K)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=xq[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Rq[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var o;(o=this.dependencyTracker)==null||o.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,s,o,l,c;for(const[h,f]of t)switch(h){case"LW":this.setLineWidth(e,f);break;case"LC":this.setLineCap(e,f);break;case"LJ":this.setLineJoin(e,f);break;case"ML":this.setMiterLimit(e,f);break;case"D":this.setDash(e,f[0],f[1]);break;case"RI":this.setRenderingIntent(e,f);break;case"FL":this.setFlatness(e,f);break;case"Font":this.setFont(e,f[0],f[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=f;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=f;break;case"BM":(o=this.dependencyTracker)==null||o.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=f;break;case"SMask":(l=this.dependencyTracker)==null||l.recordSimpleData("SMask",e),this.current.activeSMask=f?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(c=this.dependencyTracker)==null||c.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(f);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),rg(this.suspendedCtx,l),wq(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),rg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],l=s[1],c=s[2]-o,h=s[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,l,c,h,f,g,y){let b=e.canvas,A=h-g,w=f-y;if(l)if(A<0||w<0||A+n>b.width||w+s>b.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,s),I=N.context;I.drawImage(b,-A,-w),I.globalCompositeOperation="destination-atop",I.fillStyle=l,I.fillRect(0,0,n,s),I.globalCompositeOperation="source-over",b=N.canvas,A=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(A,w,n,s),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(A,w,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const C=new Path2D;C.rect(h,f,n,s),t.clip(C),t.globalCompositeOperation="destination-in",t.drawImage(b,A,w,n,s,h,f,n,s),t.restore()}save(e){var n;this.inSMaskMode&&rg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&rg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,l,c){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||(o=n[0]=new Path2D),this[t](e,o);return}if(this.dependencyTracker!==null){const l=t===jf.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const l=n[0]=new Path2D;for(let c=0,h=o.length;c<h;)switch(o[c++]){case uv.moveTo:l.moveTo(o[c++],o[c++]);break;case uv.lineTo:l.lineTo(o[c++],o[c++]);break;case uv.curveTo:l.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);break;case uv.closePath:l.closePath();break;default:Fe(`Unrecognized drawing path operator: ${o[c-1]}`);break}o=l}ye.axialAlignedBoundingBox(s,Yt(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var l;const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const c=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,Rr(s),Yn.STROKE,e),c){const h=new Path2D;h.addPath(t,s.getTransform().invertSelf().multiplySelf(c)),t=h}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(l=this.dependencyTracker)==null||l.recordDependencies(e,Ps.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Yn.STROKE,Yt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var f,g,y;const s=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const b=o.isModifyingCurrentTransform()?s.getTransform():null;if((f=this.dependencyTracker)==null||f.save(e),s.save(),s.fillStyle=o.getPattern(s,this,Rr(s),Yn.FILL,e),b){const A=new Path2D;A.addPath(t,s.getTransform().invertSelf().multiplySelf(b)),t=A}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(g=this.dependencyTracker)==null||g.recordDependencies(e,Ps.fill),c&&(s.restore(),(y=this.dependencyTracker)==null||y.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,Ps.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=Iq}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=wM}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:g}of t)g&&s.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var y,b;(y=this.dependencyTracker)==null||y.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||RE,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Fe("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=((b=s.systemFontInfo)==null?void 0:b.css)||`"${l}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let g=n;n<vM?g=vM:n>bM&&(g=bM),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${h} ${g}px ${c}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,s,o,l){var I,P,k,L;const c=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=g&Hn.FILL_STROKE_MASK,A=!!(g&Hn.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,C=h.patternStroke&&!f.missingFile;let N;if((f.disableFontFace||A||w||C)&&!f.missingFile&&(N=f.getPathGenerator(this.commonObjs,t)),N&&(f.disableFontFace||w||C)){c.save(),c.translate(n,s),c.scale(y,-y),(I=this.dependencyTracker)==null||I.recordCharacterBBox(e,c,f);let O;if(b===Hn.FILL||b===Hn.FILL_STROKE)if(o){O=c.getTransform(),c.setTransform(...o);const U=M(this,Ar,rT).call(this,N,O,o);c.fill(U)}else c.fill(N);if(b===Hn.STROKE||b===Hn.FILL_STROKE)if(l){O||(O=c.getTransform()),c.setTransform(...l);const{a:U,b:F,c:K,d:q}=O,Q=ye.inverseTransform(l),Z=ye.transform([U,F,K,q,0,0],Q);ye.singularValueDecompose2dScale(Z,fs),c.lineWidth*=Math.max(fs[0],fs[1])/y,c.stroke(M(this,Ar,rT).call(this,N,O,l))}else c.lineWidth/=y,c.stroke(N);c.restore()}else(b===Hn.FILL||b===Hn.FILL_STROKE)&&(c.fillText(t,n,s),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t))),(b===Hn.STROKE||b===Hn.FILL_STROKE)&&(this.dependencyTracker&&((k=this.dependencyTracker)==null||k.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t)).recordDependencies(e,Ps.stroke)),c.strokeText(t,n,s));A&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Yt(c),x:n,y:s,fontSize:y,path:N}),(L=this.dependencyTracker)==null||L.recordCharacterBBox(e,c,f,y,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ve(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var K,q,Q,Z;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Ps.showText).resetBBox(e),this.current.textRenderingMode&Hn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),(K=this.dependencyTracker)==null||K.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){(q=this.dependencyTracker)==null||q.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,y=n.textHScale*g,b=t.length,A=s.vertical,w=A?1:-1,C=s.defaultVMetrics,N=o*n.fontMatrix[0],I=n.textRenderingMode===Hn.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),g>0?l.scale(y,-1):l.scale(y,1);let P,k;if(n.patternFill){l.save();const oe=n.fillColor.getPattern(l,this,Rr(l),Yn.FILL,e);P=Yt(l),l.restore(),l.fillStyle=oe}if(n.patternStroke){l.save();const oe=n.strokeColor.getPattern(l,this,Rr(l),Yn.STROKE,e);k=Yt(l),l.restore(),l.strokeStyle=oe}let L=n.lineWidth;const O=n.textMatrixScale;if(O===0||L===0){const oe=n.textRenderingMode&Hn.FILL_STROKE_MASK;(oe===Hn.STROKE||oe===Hn.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=O;if(c!==1&&(l.scale(c,c),L/=c),l.lineWidth=L,s.isInvalidPDFjsFont){const oe=[];let ce=0;for(const pe of t)oe.push(pe.unicode),ce+=pe.width;const ue=oe.join("");if(l.fillText(ue,0,0),this.dependencyTracker!==null){const pe=l.measureText(ue);this.dependencyTracker.recordBBox(e,this.ctx,-pe.actualBoundingBoxLeft,pe.actualBoundingBoxRight,-pe.actualBoundingBoxAscent,pe.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=ce*N*y,l.restore(),this.compose();return}let U=0,F;for(F=0;F<b;++F){const oe=t[F];if(typeof oe=="number"){U+=w*oe*o/1e3;continue}let ce=!1;const ue=(oe.isSpace?f:0)+h,pe=oe.fontChar,G=oe.accent;let $,ae,Se=oe.width;if(A){const J=oe.vmetric||C,se=-(oe.vmetric?J[1]:Se*.5)*N,de=J[2]*N;Se=J?-J[0]:Se,$=se/c,ae=(U+de)/c}else $=U/c,ae=0;let Ie;if(s.remeasure&&Se>0){Ie=l.measureText(pe);const J=Ie.width*1e3/o*c;if(Se<J&&this.isFontSubpixelAAEnabled){const se=Se/J;ce=!0,l.save(),l.scale(se,1),$/=se}else Se!==J&&($+=(Se-J)/2e3*o/c)}if(this.contentVisible&&(oe.isInFont||s.missingFile)){if(I&&!G)l.fillText(pe,$,ae),(Q=this.dependencyTracker)==null||Q.recordCharacterBBox(e,l,Ie?{bbox:null}:s,o/c,$,ae,()=>Ie??l.measureText(pe));else if(this.paintChar(e,pe,$,ae,P,k),G){const J=$+o*G.offset.x/c,se=ae-o*G.offset.y/c;this.paintChar(e,G.fontChar,J,se,P,k)}}const H=A?Se*N-ue*g:Se*N+ue*g;U+=H,ce&&l.restore()}A?n.y-=U:n.x+=U*y,l.restore(),this.compose(),(Z=this.dependencyTracker)==null||Z.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,l=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,y=s.textHScale*c,b=s.fontMatrix||RE,A=t.length,w=s.textRenderingMode===Hn.INVISIBLE;let C,N,I,P;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(y,c);const k=this.dependencyTracker;for(this.dependencyTracker=k?new gb(k,e):null,C=0;C<A;++C){if(N=t[C],typeof N=="number"){P=h*N*l/1e3,this.ctx.translate(P,0),s.x+=P*y;continue}const L=(N.isSpace?g:0)+f,O=o.charProcOperatorList[N.operatorListId];O?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...b),this.executeOperatorList(O),this.restore()):Fe(`Type3 character "${N.operatorListId}" is not available.`);const U=[N.width,0];ye.applyTransform(U,b),I=U[0]*l+L,n.translate(I,0),s.x+=I*y}n.restore(),k&&(this.dependencyTracker=k)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,l,c){var f;const h=new Path2D;h.rect(s,o,l-s,c-o),this.ctx.clip(h),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,s,l,o,c).recordClipBox(e,this.ctx,s,l,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Yt(this.ctx),o={createCanvasGraphics:(l,c)=>new lC(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new gb(this.dependencyTracker,c,!0):null)};n=new nT(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=Aq(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){var l;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,Rr(n),Yn.SHADING,e);const o=Rr(n);if(o){const{width:c,height:h}=n.canvas,f=lh.slice();ye.axialAlignedBoundingBox([0,0,c,h],o,f);const[g,y,b,A]=f;this.ctx.fillRect(g,y,b-g,A-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(l=this.dependencyTracker)==null||l.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Ps.transform).recordDependencies(e,Ps.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){kt("Should not call beginInlineImage")}beginImageData(){kt("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Yt(this.ctx),n)){ye.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[o,l,c,h]=n,f=new Path2D;f.rect(o,l,c-o,h-l),this.ctx.clip(f),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,o,c,l,h),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var k;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||o_("TODO: Support non-isolated groups."),t.knockout&&Fe("Knockout groups not supported.");const s=Yt(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=lh.slice();ye.axialAlignedBoundingBox(t.bbox,Yt(n),o);const l=[0,0,n.canvas.width,n.canvas.height];o=ye.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),g=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,g),A=b.context;A.translate(-c,-h),A.transform(...s);let w=new Path2D;const[C,N,I,P]=t.bbox;if(w.rect(C,N,I-C,P-N),t.matrix){const L=new Path2D;L.addPath(w,new DOMMatrix(t.matrix)),w=L}A.clip(w),t.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),rg(n,A),this.ctx=A,(k=this.dependencyTracker)==null||k.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var o;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(o=this.dependencyTracker)==null||o.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Yt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...l);const c=lh.slice();ye.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],l,c),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(e,t,n,s,o,l){if(M(this,Ar,iT).call(this),yv(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,ye.singularValueDecompose2dScale(Yt(this.ctx),fs);const{viewportScale:f}=this,g=Math.ceil(c*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(fs[0],0,0,-fs[1],0,h*fs[1]),yv(this.ctx)}else{yv(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new SM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),M(this,Ar,sT).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var c;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,l,c){var y,b,A;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Yt(h);h.transform(n,s,o,l,0,0);const g=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),(y=this.dependencyTracker)==null||y.resetBBox(e);for(let w=0,C=c.length;w<C;w+=2){const N=ye.transform(f,[n,s,o,l,c[w],c[w+1]]);h.drawImage(g.canvas,N[4],N[5]),(b=this.dependencyTracker)==null||b.recordBBox(e,this.ctx,N[4],N[4]+g.canvas.width,N[5],N[5]+g.canvas.height)}h.restore(),this.compose(),(A=this.dependencyTracker)==null||A.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var l,c,h;if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;(l=this.dependencyTracker)==null||l.resetBBox(e).recordDependencies(e,Ps.transformAndFill);for(const f of t){const{data:g,width:y,height:b,transform:A}=f,w=this.cachedCanvases.getCanvas("maskCanvas",y,b),C=w.context;C.save();const N=this.getObject(e,g,f);EM(C,N),C.globalCompositeOperation="source-in",C.fillStyle=o?s.getPattern(C,this,Rr(n),Yn.FILL,e):s,C.fillRect(0,0,y,b),C.restore(),n.save(),n.transform(...A),n.scale(1,-1),mv(n,w.canvas,0,0,y,b,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,n,0,y,0,b),n.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Fe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Fe("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let g=0,y=o.length;g<y;g+=2)f.push({transform:[n,0,0,s,o[g],o[g+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e,t){var f;if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const y=this.cachedCanvases.getCanvas("inlineImage",n,s).context;AM(y,t),c=this.applyTransferMapsToCanvas(y)}const h=this._scaleImage(c,Rr(o));o.imageSmoothingEnabled=TM(Yt(o),t.interpolate),(f=this.dependencyTracker)==null||f.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,Ps.imageXObject).recordOperation(e),mv(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var l,c,h;if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const f=t.width,g=t.height,b=this.cachedCanvases.getCanvas("inlineImage",f,g).context;AM(b,t),o=this.applyTransferMapsToCanvas(b)}(l=this.dependencyTracker)==null||l.resetBBox(e);for(const f of n)s.save(),s.transform(...f.transform),s.scale(1,-1),mv(s,o,f.x,f.y,f.w,f.h,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,s,0,1,-1,0),s.restore();(h=this.dependencyTracker)==null||h.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Ps.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var l,c;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===wM?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,(l=this.dependencyTracker)==null||l.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(c=this.dependencyTracker)==null||c.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Yt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)l=c=1/h;else{const g=h*e;l=c=g<1?1/g:1}else if(e===0)l=1/h,c=1/f;else{const g=h*e,y=f*e;l=g<1?1/g:1,c=y<1?1/y:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),g=Math.hypot(s,o);if(e===0)l=g/h,c=f/h;else{const y=e*h;l=g>y?g/y:1,c=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,l),KA.a=1/o,KA.d=1/l;const h=new Path2D;if(h.addPath(e,KA),c.length>0){const f=Math.max(o,l);n.setLineDash(c.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ar=new WeakSet,iT=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},sT=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},rT=function(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s};let yh=lC;for(const i in jf)yh.prototype[i]!==void 0&&(yh.prototype[jf[i]]=yh.prototype[i]);var jh,Qh,wm,Zh,Mv;const dh=class dh{constructor(e){R(this,Zh);R(this,jh);R(this,Qh);R(this,wm);E(this,jh,e),E(this,Qh,new DataView(d(this,jh))),E(this,wm,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const f of dh.strings){const g=t.encode(e[f]);n[f]=g,s+=4+g.length}const o=new ArrayBuffer(s),l=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of dh.strings){const g=n[f],y=g.length;c.setUint32(h,y),l.set(g,h+4),h+=4+y}return it(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}get fontFamily(){return M(this,Zh,Mv).call(this,0)}get fontWeight(){return M(this,Zh,Mv).call(this,1)}get italicAngle(){return M(this,Zh,Mv).call(this,2)}};jh=new WeakMap,Qh=new WeakMap,wm=new WeakMap,Zh=new WeakSet,Mv=function(e){it(e<dh.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=d(this,Qh).getUint32(t)+4;const n=d(this,Qh).getUint32(t);return d(this,wm).decode(new Uint8Array(d(this,jh),t+4,n))},le(dh,"strings",["fontFamily","fontWeight","italicAngle"]);let mb=dh;var Il,zr,pu,gu,Sg;const hh=class hh{constructor(e){R(this,gu);R(this,Il);R(this,zr);R(this,pu);E(this,Il,e),E(this,zr,new DataView(d(this,Il))),E(this,pu,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const b of hh.strings){const A=t.encode(e[b]);n[b]=A,s+=4+A.length}s+=4;let o,l,c=1+s;e.style&&(o=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+o.length+4+l.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;g.setUint8(y++,e.guessFallback?1:0),g.setUint32(y,0),y+=4,s=0;for(const b of hh.strings){const A=n[b],w=A.length;s+=4+w,g.setUint32(y,w),f.set(A,y+4),y+=4+w}return g.setUint32(y-s-4,s),e.style&&(g.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,g.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),it(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}get guessFallback(){return d(this,zr).getUint8(0)!==0}get css(){return M(this,gu,Sg).call(this,0)}get loadedName(){return M(this,gu,Sg).call(this,1)}get baseFontName(){return M(this,gu,Sg).call(this,2)}get src(){return M(this,gu,Sg).call(this,3)}get style(){let e=1;e+=4+d(this,zr).getUint32(e);const t=d(this,zr).getUint32(e),n=d(this,pu).decode(new Uint8Array(d(this,Il),e+4,t));e+=4+t;const s=d(this,zr).getUint32(e),o=d(this,pu).decode(new Uint8Array(d(this,Il),e+4,s));return{style:n,weight:o}}};Il=new WeakMap,zr=new WeakMap,pu=new WeakMap,gu=new WeakSet,Sg=function(e){it(e<hh.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=d(this,zr).getUint32(t)+4;const n=d(this,zr).getUint32(t);return d(this,pu).decode(new Uint8Array(d(this,Il),t+4,n))},le(hh,"strings",["css","loadedName","baseFontName","src"]);let yb=hh;var ef,tf,nf,sf,Qi,Vr,Cm,Tt,nn,tr,Dv,Ag;const Ge=class Ge{constructor({data:e,extra:t}){R(this,nn);R(this,Vr);R(this,Cm);R(this,Tt);E(this,Vr,e),E(this,Cm,new TextDecoder),E(this,Tt,new DataView(d(this,Vr))),t&&Object.assign(this,t)}get black(){return M(this,nn,tr).call(this,0)}get bold(){return M(this,nn,tr).call(this,1)}get disableFontFace(){return M(this,nn,tr).call(this,2)}get fontExtraProperties(){return M(this,nn,tr).call(this,3)}get isInvalidPDFjsFont(){return M(this,nn,tr).call(this,4)}get isType3Font(){return M(this,nn,tr).call(this,5)}get italic(){return M(this,nn,tr).call(this,6)}get missingFile(){return M(this,nn,tr).call(this,7)}get remeasure(){return M(this,nn,tr).call(this,8)}get vertical(){return M(this,nn,tr).call(this,9)}get ascent(){return M(this,nn,Dv).call(this,0)}get defaultWidth(){return M(this,nn,Dv).call(this,1)}get descent(){return M(this,nn,Dv).call(this,2)}get bbox(){let e=d(Ge,tf);if(d(this,Tt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(d(this,Tt).getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=d(Ge,nf);if(d(this,Tt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(d(this,Tt).getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=d(Ge,sf);if(d(this,Tt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(d(this,Tt).getInt16(e,!0)),e+=2;return n}get fallbackName(){return M(this,nn,Ag).call(this,0)}get loadedName(){return M(this,nn,Ag).call(this,1)}get mimetype(){return M(this,nn,Ag).call(this,2)}get name(){return M(this,nn,Ag).call(this,3)}get data(){let e=d(Ge,Qi);const t=d(this,Tt).getUint32(e);e+=4+t;const n=d(this,Tt).getUint32(e);e+=4+n;const s=d(this,Tt).getUint32(e);e+=4+s;const o=d(this,Tt).getUint32(e);if(o!==0)return new Uint8Array(d(this,Vr),e+4,o)}clearData(){let e=d(Ge,Qi);const t=d(this,Tt).getUint32(e);e+=4+t;const n=d(this,Tt).getUint32(e);e+=4+n;const s=d(this,Tt).getUint32(e);e+=4+s;const o=d(this,Tt).getUint32(e);new Uint8Array(d(this,Vr),e+4,o).fill(0),d(this,Tt).setUint32(e,0)}get cssFontInfo(){let e=d(Ge,Qi);const t=d(this,Tt).getUint32(e);e+=4+t;const n=d(this,Tt).getUint32(e);e+=4+n;const s=d(this,Tt).getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(d(this,Vr),e+4,s)),new mb(o.buffer)}get systemFontInfo(){let e=d(Ge,Qi);const t=d(this,Tt).getUint32(e);e+=4+t;const n=d(this,Tt).getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Vr),e+4,n)),new yb(s.buffer)}static write(e){const t=e.systemFontInfo?yb.write(e.systemFontInfo):null,n=e.cssFontInfo?mb.write(e.cssFontInfo):null,s=new TextEncoder,o={};let l=0;for(const C of Ge.strings)o[C]=s.encode(e[C]),l+=4+o[C].length;const c=d(Ge,Qi)+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;const b=Ge.bools.length;let A=0,w=0;for(let C=0;C<b;C++){const N=e[Ge.bools[C]];A|=(N===void 0?0:N?2:1)<<w,w+=2,(w===8||C===b-1)&&(g.setUint8(y++,A),A=0,w=0)}it(y===d(Ge,ef),"FontInfo.write: Boolean properties offset mismatch");for(const C of Ge.numbers)g.setFloat64(y,e[C]),y+=8;if(it(y===d(Ge,tf),"FontInfo.write: Number properties offset mismatch"),e.bbox){g.setUint8(y++,4);for(const C of e.bbox)g.setInt16(y,C,!0),y+=2}else g.setUint8(y++,0),y+=8;if(it(y===d(Ge,nf),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){g.setUint8(y++,6);for(const C of e.fontMatrix)g.setFloat64(y,C,!0),y+=8}else g.setUint8(y++,0),y+=48;if(it(y===d(Ge,sf),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){g.setUint8(y++,1);for(const C of e.defaultVMetrics)g.setInt16(y,C,!0),y+=2}else g.setUint8(y++,0),y+=6;it(y===d(Ge,Qi),"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(d(Ge,Qi),0),y+=4;for(const C of Ge.strings){const N=o[C],I=N.length;g.setUint32(y,I),f.set(N,y+4),y+=4+I}if(g.setUint32(d(Ge,Qi),y-d(Ge,Qi)-4),!t)g.setUint32(y,0),y+=4;else{const C=t.byteLength;g.setUint32(y,C),it(y+4+C<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),y+4),y+=4+C}if(!n)g.setUint32(y,0),y+=4;else{const C=n.byteLength;g.setUint32(y,C),it(y+4+C<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),y+4),y+=4+C}return e.data===void 0?(g.setUint32(y,0),y+=4):(g.setUint32(y,e.data.length),f.set(e.data,y+4),y+=4+e.data.length),it(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}};ef=new WeakMap,tf=new WeakMap,nf=new WeakMap,sf=new WeakMap,Qi=new WeakMap,Vr=new WeakMap,Cm=new WeakMap,Tt=new WeakMap,nn=new WeakSet,tr=function(e){it(e<Ge.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=d(this,Tt).getUint8(t)>>n&3;return s===0?void 0:s===2},Dv=function(e){return it(e<Ge.numbers.length,"Invalid number index"),d(this,Tt).getFloat64(d(Ge,ef)+e*8)},Ag=function(e){it(e<Ge.strings.length,"Invalid string index");let t=d(Ge,Qi)+4;for(let o=0;o<e;o++)t+=d(this,Tt).getUint32(t)+4;const n=d(this,Tt).getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Vr),t+4,n)),d(this,Cm).decode(s)},le(Ge,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),le(Ge,"numbers",["ascent","defaultWidth","descent"]),le(Ge,"strings",["fallbackName","loadedName","mimetype","name"]),R(Ge,ef,Math.ceil(Ge.bools.length*2/8)),R(Ge,tf,d(Ge,ef)+Ge.numbers.length*8),R(Ge,nf,d(Ge,tf)+1+8),R(Ge,sf,d(Ge,nf)+1+48),R(Ge,Qi,d(Ge,sf)+1+6);let oT=Ge;var xm,Rm;class Ys{static get workerPort(){return d(this,xm)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");E(this,xm,e)}static get workerSrc(){return d(this,Rm)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");E(this,Rm,e)}}xm=new WeakMap,Rm=new WeakMap,R(Ys,xm,null),R(Ys,Rm,"");var rf,Im;class Nq{constructor({parsedData:e,rawData:t}){R(this,rf);R(this,Im);E(this,rf,e),E(this,Im,t)}getRaw(){return d(this,Im)}get(e){return d(this,rf).get(e)??null}[Symbol.iterator](){return d(this,rf).entries()}}rf=new WeakMap,Im=new WeakMap;const ih=Symbol("INTERNAL");var Nm,Mm,Dm,of;class Mq{constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){R(this,Nm,!1);R(this,Mm,!1);R(this,Dm,!1);R(this,of,!0);E(this,Nm,!!(e&hs.DISPLAY)),E(this,Mm,!!(e&hs.PRINT)),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(d(this,Dm))return d(this,of);if(!d(this,of))return!1;const{print:e,view:t}=this.usage;return d(this,Nm)?(t==null?void 0:t.viewState)!=="OFF":d(this,Mm)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==ih&&kt("Internal method `_setVisible` called."),E(this,Dm,n),E(this,of,t)}}Nm=new WeakMap,Mm=new WeakMap,Dm=new WeakMap,of=new WeakMap;var Nl,wt,af,lf,km,aT;class Dq{constructor(e,t=hs.DISPLAY){R(this,km);R(this,Nl,null);R(this,wt,new Map);R(this,af,null);R(this,lf,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,E(this,lf,e.order);for(const n of e.groups)d(this,wt).set(n.id,new Mq(t,n));if(e.baseState==="OFF")for(const n of d(this,wt).values())n._setVisible(ih,!1);for(const n of e.on)d(this,wt).get(n)._setVisible(ih,!0);for(const n of e.off)d(this,wt).get(n)._setVisible(ih,!1);E(this,af,this.getHash())}}isVisible(e){if(d(this,wt).size===0)return!0;if(!e)return o_("Optional content group not defined."),!0;if(e.type==="OCG")return d(this,wt).has(e.id)?d(this,wt).get(e.id).visible:(Fe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return M(this,km,aT).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!d(this,wt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(d(this,wt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!d(this,wt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!d(this,wt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!d(this,wt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!d(this,wt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!d(this,wt).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(d(this,wt).get(t).visible)return!1}return!0}return Fe(`Unknown optional content policy ${e.policy}.`),!0}return Fe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var o;const s=d(this,wt).get(e);if(!s){Fe(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const l of s.rbGroups)for(const c of l)c!==e&&((o=d(this,wt).get(c))==null||o._setVisible(ih,!1,!0));s._setVisible(ih,!!t,!0),E(this,Nl,null)}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=d(this,wt).get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}E(this,Nl,null)}get hasInitialVisibility(){return d(this,af)===null||this.getHash()===d(this,af)}getOrder(){return d(this,wt).size?d(this,lf)?d(this,lf).slice():[...d(this,wt).keys()]:null}getGroup(e){return d(this,wt).get(e)||null}getHash(){if(d(this,Nl)!==null)return d(this,Nl);const e=new pP;for(const[t,n]of d(this,wt))e.update(`${t}:${n.visible}`);return E(this,Nl,e.hexdigest())}[Symbol.iterator](){return d(this,wt).entries()}}Nl=new WeakMap,wt=new WeakMap,af=new WeakMap,lf=new WeakMap,km=new WeakSet,aT=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let l;if(Array.isArray(o))l=M(this,km,aT).call(this,o);else if(d(this,wt).has(o))l=d(this,wt).get(o).visible;else return Fe(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class kq{constructor(e,{disableRange:t=!1,disableStream:n=!1}){it(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(o==null?void 0:o.length)>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});it(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,s,o;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(o=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||o.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){it(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Pq(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Lq(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Pq{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=l_(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Lq{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Oq(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let g=c(t);return g=unescape(g),g=h(g),g=f(g),o(g)}if(t=l(i),t){const g=f(t);return o(g)}if(t=n("filename","i").exec(i),t){t=t[1];let g=c(t);return g=f(g),o(g)}function n(g,y){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function s(g,y){if(g){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(g,{fatal:!0}),A=Iy(y);y=b.decode(A),e=!1}catch{}}return y}function o(g){return e&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),e&&(g=s("iso-8859-1",g))),g}function l(g){const y=[];let b;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(g))!==null;){let[,C,N,I]=b;if(C=parseInt(C,10),C in y){if(C===0)break;continue}y[C]=[N,I]}const w=[];for(let C=0;C<y.length&&C in y;++C){let[N,I]=y[C];I=c(I),N&&(I=unescape(I),C===0&&(I=h(I))),w.push(I)}return w.join("")}function c(g){if(g.startsWith('"')){const y=g.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}g=y.join('"')}return g}function h(g){const y=g.indexOf("'");if(y===-1)return g;const b=g.slice(0,y),w=g.slice(y+1).replace(/^[^']*'/,"");return s(b,w)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,N){return String.fromCharCode(parseInt(N,16))}),s(b,w);try{w=atob(w)}catch{}return s(b,w)})}return""}function xP(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function c_(i){var e;return((e=URL.parse(i))==null?void 0:e.origin)??null}function RP({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function IP(i){const e=i.get("Content-Disposition");if(e){let t=Oq(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(l_(t))return t}return null}function ky(i,e){return new Bg(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function NP(i){return i===200||i===206}function MP(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function DP(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Fe(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Uq{constructor(e){le(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=xP(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Fq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Bq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Fq{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,MP(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=c_(o.url),!NP(o.status))throw ky(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=RP({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=IP(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Aa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:DP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Bq{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,MP(o,this._withCredentials,this._abortController)).then(c=>{const h=c_(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!NP(c.status))throw ky(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:DP(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const JA=200,jA=206;function Hq(i){const e=i.response;return typeof e!="string"?e:Iy(e).buffer}class Gq{constructor({url:e,httpHeaders:t,withCredentials:n}){le(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=xP(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,l]of this.headers)t.setRequestHeader(o,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=jA):s.expectedStatus=JA,t.responseType="arraybuffer",it(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var s;const n=this.pendingRequests[e];n&&((s=n.onProgress)==null||s.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||JA;if(!(o===JA&&n.expectedStatus===jA)&&o!==n.expectedStatus){n.onError(s.status);return}const c=Hq(s);if(o===jA){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(Fe('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class zq{constructor(e){this._source=e,this._manager=new Gq(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return it(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Vq(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new qq(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Vq{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=c_(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=RP({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=IP(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ky(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class qq{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=c_((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=ky(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const $q=/^[a-z][a-z0-9\-+.]+:/i;function Yq(i){if($q.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class Xq{constructor(e){this.source=e,this.url=Yq(e.url),it(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Wq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Kq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Wq{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=ky(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Aa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Kq{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const og=Symbol("INITIAL_DATA");var Zi,Pm,lT;class kP{constructor(){R(this,Pm);R(this,Zi,Object.create(null))}get(e,t=null){if(t){const s=M(this,Pm,lT).call(this,e);return s.promise.then(()=>t(s.data)),null}const n=d(this,Zi)[e];if(!n||n.data===og)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=d(this,Zi)[e];return!!t&&t.data!==og}delete(e){const t=d(this,Zi)[e];return!t||t.data===og?!1:(delete d(this,Zi)[e],!0)}resolve(e,t=null){const n=M(this,Pm,lT).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in d(this,Zi)){const{data:n}=d(this,Zi)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}E(this,Zi,Object.create(null))}*[Symbol.iterator](){for(const e in d(this,Zi)){const{data:t}=d(this,Zi)[e];t!==og&&(yield[e,t])}}}Zi=new WeakMap,Pm=new WeakSet,lT=function(e){var t;return(t=d(this,Zi))[e]||(t[e]={...Promise.withResolvers(),data:og})};const Jq=1e5,CM=30;var CD,Ml,Di,Lm,Om,mu,jo,Um,Fm,yu,cf,uf,Dl,df,Bm,hf,vu,Hm,Gm,tn,ff,bu,zm,kl,pf,Ra,PP,LP,cT,ys,kv,uT,OP,UP;let Vg=(tn=class{constructor({textContentSource:e,container:t,viewport:n}){R(this,Ra);R(this,Ml,Promise.withResolvers());R(this,Di,null);R(this,Lm,!1);R(this,Om,!!((CD=globalThis.FontInspector)!=null&&CD.enabled));R(this,mu,null);R(this,jo,null);R(this,Um,0);R(this,Fm,0);R(this,yu,null);R(this,cf,null);R(this,uf,0);R(this,Dl,0);R(this,df,Object.create(null));R(this,Bm,[]);R(this,hf,null);R(this,vu,[]);R(this,Hm,new WeakMap);R(this,Gm,null);var h;if(e instanceof ReadableStream)E(this,hf,e);else if(typeof e=="object")E(this,hf,new ReadableStream({start(f){f.enqueue(e),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');E(this,Di,E(this,cf,t)),E(this,Dl,n.scale*_r.pixelRatio),E(this,uf,n.rotation),E(this,jo,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:o,pageX:l,pageY:c}=n.rawDims;E(this,Gm,[1,0,0,-1,-l,c+o]),E(this,Fm,s),E(this,Um,o),M(h=tn,ys,OP).call(h),ac(t,n),d(this,Ml).promise.finally(()=>{d(tn,pf).delete(this),E(this,jo,null),E(this,df,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Dn.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{d(this,yu).read().then(({value:t,done:n})=>{if(n){d(this,Ml).resolve();return}d(this,mu)??E(this,mu,t.lang),Object.assign(d(this,df),t.styles),M(this,Ra,PP).call(this,t.items),e()},d(this,Ml).reject)};return E(this,yu,d(this,hf).getReader()),d(tn,pf).add(this),e(),d(this,Ml).promise}update({viewport:e,onBefore:t=null}){var o;const n=e.scale*_r.pixelRatio,s=e.rotation;if(s!==d(this,uf)&&(t==null||t(),E(this,uf,s),ac(d(this,cf),{rotation:s})),n!==d(this,Dl)){t==null||t(),E(this,Dl,n);const l={div:null,properties:null,ctx:M(o=tn,ys,kv).call(o,d(this,mu))};for(const c of d(this,vu))l.properties=d(this,Hm).get(c),l.div=c,M(this,Ra,cT).call(this,l)}}cancel(){var t;const e=new Aa("TextLayer task cancelled.");(t=d(this,yu))==null||t.cancel(e).catch(()=>{}),E(this,yu,null),d(this,Ml).reject(e)}get textDivs(){return d(this,vu)}get textContentItemsStr(){return d(this,Bm)}static cleanup(){if(!(d(this,pf).size>0)){d(this,ff).clear();for(const{canvas:e}of d(this,bu).values())e.remove();d(this,bu).clear()}}},Ml=new WeakMap,Di=new WeakMap,Lm=new WeakMap,Om=new WeakMap,mu=new WeakMap,jo=new WeakMap,Um=new WeakMap,Fm=new WeakMap,yu=new WeakMap,cf=new WeakMap,uf=new WeakMap,Dl=new WeakMap,df=new WeakMap,Bm=new WeakMap,hf=new WeakMap,vu=new WeakMap,Hm=new WeakMap,Gm=new WeakMap,ff=new WeakMap,bu=new WeakMap,zm=new WeakMap,kl=new WeakMap,pf=new WeakMap,Ra=new WeakSet,PP=function(e){var s,o;if(d(this,Lm))return;(o=d(this,jo)).ctx??(o.ctx=M(s=tn,ys,kv).call(s,d(this,mu)));const t=d(this,vu),n=d(this,Bm);for(const l of e){if(t.length>Jq){Fe("Ignoring additional textDivs for performance reasons."),E(this,Lm,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=d(this,Di);E(this,Di,document.createElement("span")),d(this,Di).classList.add("markedContent"),l.id&&d(this,Di).setAttribute("id",`${l.id}`),c.append(d(this,Di))}else l.type==="endMarkedContent"&&E(this,Di,d(this,Di).parentNode);continue}n.push(l.str),M(this,Ra,LP).call(this,l)}},LP=function(e){var C;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};d(this,vu).push(t);const s=ye.transform(d(this,Gm),e.transform);let o=Math.atan2(s[1],s[0]);const l=d(this,df)[e.fontName];l.vertical&&(o+=Math.PI/2);let c=d(this,Om)&&l.fontSubstitution||l.fontFamily;c=tn.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*M(C=tn,ys,UP).call(C,c,l,d(this,mu));let g,y;o===0?(g=s[4],y=s[5]-f):(g=s[4]+f*Math.sin(o),y=s[5]-f*Math.cos(o));const b="calc(var(--total-scale-factor) *",A=t.style;d(this,Di)===d(this,cf)?(A.left=`${(100*g/d(this,Fm)).toFixed(2)}%`,A.top=`${(100*y/d(this,Um)).toFixed(2)}%`):(A.left=`${b}${g.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(d(tn,kl)*h).toFixed(2)}px)`,A.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,d(this,Om)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),I=Math.abs(e.transform[3]);N!==I&&Math.max(N,I)/Math.min(N,I)>1.5&&(w=!0)}if(w&&(n.canvasWidth=l.vertical?e.height:e.width),d(this,Hm).set(t,n),d(this,jo).div=t,d(this,jo).properties=n,M(this,Ra,cT).call(this,d(this,jo)),n.hasText&&d(this,Di).append(t),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),d(this,Di).append(N)}},cT=function(e){var c;const{div:t,properties:n,ctx:s}=e,{style:o}=t;let l="";if(d(tn,kl)>1&&(l=`scale(${1/d(tn,kl)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=o,{canvasWidth:f,fontSize:g}=n;M(c=tn,ys,uT).call(c,s,g*d(this,Dl),h);const{width:y}=s.measureText(t.textContent);y>0&&(l=`scaleX(${f*d(this,Dl)/y}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(o.transform=l)},ys=new WeakSet,kv=function(e=null){let t=d(this,bu).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),d(this,bu).set(e,t),d(this,zm).set(t,{size:0,family:""})}return t},uT=function(e,t,n){const s=d(this,zm).get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)},OP=function(){if(d(this,kl)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),E(this,kl,e.getBoundingClientRect().height),e.remove()},UP=function(e,t,n){const s=d(this,ff).get(e);if(s)return s;const o=M(this,ys,kv).call(this,n);o.canvas.width=o.canvas.height=CM,M(this,ys,uT).call(this,o,CM,e);const l=o.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(Dn.platform.isFirefox&&Fe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),d(this,ff).set(e,f),f},R(tn,ys),R(tn,ff,new Map),R(tn,bu,new Map),R(tn,zm,new WeakMap),R(tn,kl,null),R(tn,pf,new Set),tn);const jq=100;function Pw(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new dT,{docId:t}=e,n=i.url?rq(i.url):null,s=i.data?oq(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,h=i.range instanceof Lw?i.range:null,f=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let g=i.worker instanceof Qf?i.worker:null;const y=i.verbosity,b=typeof i.docBaseUrl=="string"&&!My(i.docBaseUrl)?i.docBaseUrl:null,A=hv(i.cMapUrl),w=i.cMapPacked!==!1,C=i.CMapReaderFactory||(fi?fq:hM),N=hv(i.iccUrl),I=hv(i.standardFontDataUrl),P=i.StandardFontDataFactory||(fi?pq:fM),k=hv(i.wasmUrl),L=i.WasmFactory||(fi?gq:pM),O=i.stopAtErrors!==!0,U=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,F=i.isEvalSupported!==!1,K=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!fi,q=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!fi&&(Dn.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,Z=typeof i.disableFontFace=="boolean"?i.disableFontFace:fi,oe=i.fontExtraProperties===!0,ce=i.enableXfa===!0,ue=i.ownerDocument||globalThis.document,pe=i.disableRange===!0,G=i.disableStream===!0,$=i.disableAutoFetch===!0,ae=i.pdfBug===!0,Se=i.CanvasFactory||(fi?hq:cq),Ie=i.FilterFactory||(fi?dq:uq),H=i.enableHWA===!0,J=i.useWasm!==!1,se=h?h.length:i.length??NaN,de=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!fi&&!Z,ve=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(C===hM&&P===fM&&L===pM&&A&&I&&k&&ug(A,document.baseURI)&&ug(I,document.baseURI)&&ug(k,document.baseURI)),Re=null;HV(y);const Ae={canvasFactory:new Se({ownerDocument:ue,enableHWA:H}),filterFactory:new Ie({docId:t,ownerDocument:ue}),cMapReaderFactory:ve?null:new C({baseUrl:A,isCompressed:w}),standardFontDataFactory:ve?null:new P({baseUrl:I}),wasmFactory:ve?null:new L({baseUrl:k})};g||(g=Qf.create({verbosity:y,port:Ys.workerPort}),e._worker=g);const ft={docId:t,apiVersion:"5.4.296",data:s,password:c,disableAutoFetch:$,rangeChunkSize:f,length:se,docBaseUrl:b,enableXfa:ce,evaluatorOptions:{maxImageSize:U,disableFontFace:Z,ignoreErrors:O,isEvalSupported:F,isOffscreenCanvasSupported:K,isImageDecoderSupported:q,canvasMaxAreaInBytes:Q,fontExtraProperties:oe,useSystemFonts:de,useWasm:J,useWorkerFetch:ve,cMapUrl:A,iccUrl:N,standardFontDataUrl:I,wasmUrl:k}},Qe={ownerDocument:ue,pdfBug:ae,styleElement:Re,loadingParams:{disableAutoFetch:$,enableXfa:ce}};return g.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const qt=g.messageHandler.sendWithPromise("GetDocRequest",ft,s?[s.buffer]:null);let Xe;if(h)Xe=new kq(h,{disableRange:pe,disableStream:G});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Pn=ug(n)?Uq:fi?Xq:zq;Xe=new Pn({url:n,length:se,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:pe,disableStream:G})}return qt.then(Pn=>{if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const ct=new mg(t,Pn,g.port),We=new e8(ct,e,Xe,Qe,Ae,H);e._transport=We,ct.send("Ready",null)})}).catch(e._capability.reject),e}var zb;const Vb=class Vb{constructor(){le(this,"_capability",Promise.withResolvers());le(this,"_transport",null);le(this,"_worker",null);le(this,"docId",`d${yn(Vb,zb)._++}`);le(this,"destroyed",!1);le(this,"onPassword",null);le(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(o){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,o}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};zb=new WeakMap,R(Vb,zb,0);let dT=Vb;var _u,Vm,qm,$m,Ym,xD;let Lw=(xD=class{constructor(e,t,n=!1,s=null){R(this,_u,Promise.withResolvers());R(this,Vm,[]);R(this,qm,[]);R(this,$m,[]);R(this,Ym,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){d(this,Ym).push(e)}addProgressListener(e){d(this,$m).push(e)}addProgressiveReadListener(e){d(this,qm).push(e)}addProgressiveDoneListener(e){d(this,Vm).push(e)}onDataRange(e,t){for(const n of d(this,Ym))n(e,t)}onDataProgress(e,t){d(this,_u).promise.then(()=>{for(const n of d(this,$m))n(e,t)})}onDataProgressiveRead(e){d(this,_u).promise.then(()=>{for(const t of d(this,qm))t(e)})}onDataProgressiveDone(){d(this,_u).promise.then(()=>{for(const e of d(this,Vm))e()})}transportReady(){d(this,_u).resolve()}requestDataRange(e,t){kt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},_u=new WeakMap,Vm=new WeakMap,qm=new WeakMap,$m=new WeakMap,Ym=new WeakMap,xD);class Qq{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Qo,Su,Eg;class Zq{constructor(e,t,n,s=!1){R(this,Su);R(this,Qo,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new rM:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new kP,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new Ny({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=eo.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){var q,Q,Z;(q=this._stats)==null||q.time("Overall");const C=this._transport.getRenderingIntent(s,o,y,b),{renderingIntent:N,cacheKey:I}=C;E(this,Qo,!1),h||(h=this._transport.getOptionalContentConfig(N));let P=this._intentStates.get(I);P||(P=Object.create(null),this._intentStates.set(I,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);const k=!!(N&hs.PRINT);P.displayReadyCapability||(P.displayReadyCapability=Promise.withResolvers(),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Q=this._stats)==null||Q.time("Page Request"),this._pumpOperatorList(C));const L=!!(this._pdfBug&&((Z=globalThis.StepperManager)!=null&&Z.enabled)),O=!this.recordedBBoxes&&(A||L),U=oe=>{var ce,ue;if(P.renderTasks.delete(F),O){const pe=(ce=F.gfx)==null?void 0:ce.dependencyTracker.take();pe&&(F.stepper&&F.stepper.setOperatorBBoxes(pe,F.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=pe))}k&&E(this,Qo,!0),M(this,Su,Eg).call(this),oe?(F.capability.reject(oe),this._abortOperatorList({intentState:P,reason:oe instanceof Error?oe:new Error(oe)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ue=globalThis.Stats)!=null&&ue.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},F=new hT({callback:U,params:{canvas:t,canvasContext:e,dependencyTracker:O?new yq(t,P.operatorList.length,L):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:w});(P.renderTasks||(P.renderTasks=new Set)).add(F);const K=F.task;return Promise.all([P.displayReadyCapability.promise,h]).then(([oe,ce])=>{var ue;if(this.destroyed){U();return}if((ue=this._stats)==null||ue.time("Rendering"),!(ce.renderingIntent&N))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:oe,optionalContentConfig:ce}),F.operatorListChanged()}).catch(U),K}getOperatorList({intent:e="display",annotationMode:t=eo.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){var f;function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Hg.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){l.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??(c.lang=h.lang),Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),E(this,Qo,!1),Promise.all(e)}cleanup(e=!1){E(this,Qo,!0);const t=M(this,Su,Eg).call(this);return e&&t&&this._stats&&(this._stats=new rM),t}_startRenderPage(e,t){var s,o;const n=this._intentStates.get(t);n&&((s=this._stats)==null||s.timeEnd("Page Request"),(o=n.displayReadyCapability)==null||o.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&M(this,Su,Eg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},l).getReader(),f=this._intentStates.get(t);f.streamReader=h;const g=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),g())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();M(this,Su,Eg).call(this)}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};g()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof a_){let s=jq;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Aa(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Qo=new WeakMap,Su=new WeakSet,Eg=function(){if(!d(this,Qo)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),E(this,Qo,!1),!0};var Pl,lr,Zo,Au,qb,Eu,Tu,pi,Pv,FP,BP,Tg,gf,Lv;const Gt=class Gt{constructor({name:e=null,port:t=null,verbosity:n=GV()}={}){R(this,pi);R(this,Pl,Promise.withResolvers());R(this,lr,null);R(this,Zo,null);R(this,Au,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(d(Gt,Tu).has(t))throw new Error("Cannot use more than one PDFWorker per port.");d(Gt,Tu).set(t,this),M(this,pi,FP).call(this,t)}else M(this,pi,BP).call(this)}get promise(){return d(this,Pl).promise}get port(){return d(this,Zo)}get messageHandler(){return d(this,lr)}destroy(){var e,t;this.destroyed=!0,(e=d(this,Au))==null||e.terminate(),E(this,Au,null),d(Gt,Tu).delete(d(this,Zo)),E(this,Zo,null),(t=d(this,lr))==null||t.destroy(),E(this,lr,null)}static create(e){const t=d(this,Tu).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Gt(e)}static get workerSrc(){if(Ys.workerSrc)return Ys.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>d(this,gf,Lv)?d(this,gf,Lv):(await import(this.workerSrc)).WorkerMessageHandler)())}};Pl=new WeakMap,lr=new WeakMap,Zo=new WeakMap,Au=new WeakMap,qb=new WeakMap,Eu=new WeakMap,Tu=new WeakMap,pi=new WeakSet,Pv=function(){d(this,Pl).resolve(),d(this,lr).send("configure",{verbosity:this.verbosity})},FP=function(e){E(this,Zo,e),E(this,lr,new mg("main","worker",e)),d(this,lr).on("ready",()=>{}),M(this,pi,Pv).call(this)},BP=function(){if(d(Gt,Eu)||d(Gt,gf,Lv)){M(this,pi,Tg).call(this);return}let{workerSrc:e}=Gt;try{Gt._isSameOrigin(window.location,e)||(e=Gt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new mg("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?d(this,Pl).reject(new Error("Worker was destroyed")):M(this,pi,Tg).call(this)},o=new AbortController;t.addEventListener("error",()=>{d(this,Au)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}E(this,lr,n),E(this,Zo,t),E(this,Au,t),M(this,pi,Pv).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{M(this,pi,Tg).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{o_("The worker has been disabled.")}M(this,pi,Tg).call(this)},Tg=function(){d(Gt,Eu)||(Fe("Setting up fake worker."),E(Gt,Eu,!0)),Gt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){d(this,Pl).reject(new Error("Worker was destroyed"));return}const t=new lq;E(this,Zo,t);const n=`fake${yn(Gt,qb)._++}`,s=new mg(n+"_worker",n,t);e.setup(s,t),E(this,lr,new mg(n,n+"_worker",t)),M(this,pi,Pv).call(this)}).catch(e=>{d(this,Pl).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},gf=new WeakSet,Lv=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},R(Gt,gf),R(Gt,qb,0),R(Gt,Eu,!1),R(Gt,Tu,new WeakMap),fi&&(E(Gt,Eu,!0),Ys.workerSrc||(Ys.workerSrc="./pdf.worker.mjs")),Gt._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},Gt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Gt.fromPort=e=>{if(JV("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Gt.create(e)};let Qf=Gt;var ea,qr,mf,yf,ta,wu,wg;class e8{constructor(e,t,n,s,o,l){R(this,wu);R(this,ea,new Map);R(this,qr,new Map);R(this,mf,new Map);R(this,yf,new Map);R(this,ta,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new kP,this.fontLoader=new iq({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new Mw)}getRenderingIntent(e,t=eo.ENABLE,n=null,s=!1,o=!1){let l=hs.DISPLAY,c=KE;switch(e){case"any":l=hs.ANY;break;case"display":break;case"print":l=hs.PRINT;break;default:Fe(`getRenderingIntent - invalid intent: ${e}`)}const h=l&hs.PRINT&&n instanceof mP?n:this.annotationStorage;switch(t){case eo.DISABLE:l+=hs.ANNOTATIONS_DISABLE;break;case eo.ENABLE:break;case eo.ENABLE_FORMS:l+=hs.ANNOTATIONS_FORMS;break;case eo.ENABLE_STORAGE:l+=hs.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Fe(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=hs.IS_EDITING),o&&(l+=hs.OPLIST);const{ids:f,hash:g}=h.modifiedIds,y=[l,c.hash,g];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=d(this,ta))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of d(this,qr).values())e.push(s._destroy());d(this,qr).clear(),d(this,mf).clear(),d(this,yf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,o;this.commonObjs.clear(),this.fontLoader.clear(),d(this,ea).clear(),this.filterFactory.destroy(),Vg.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Aa("Worker was terminated.")),(o=this.messageHandler)==null||o.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{it(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}it(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:l}=this._fullReader;return(!s||!o)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var f;(f=t.onProgress)==null||f.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{it(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){s.close();return}it(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Qq(n,this))}),e.on("DocException",n=>{t._capability.reject(Ci(n))}),e.on("PasswordRequest",n=>{E(this,ta,Promise.withResolvers());try{if(!t.onPassword)throw Ci(n);const s=o=>{o instanceof Error?d(this,ta).reject(o):d(this,ta).resolve({password:o})};t.onPassword(s,n.code)}catch(s){d(this,ta).reject(s)}return d(this,ta).promise}),e.on("DataLoaded",n=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;d(this,qr).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const y=o.error;Fe(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=new oT(o),h=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,f=new sq(c,h,o.extra,o.charProcOperatorList);this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&f.clearData(),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:g}=o;it(g,"The imageRef must be defined.");for(const y of d(this,qr).values())for(const[,b]of y.objs)if((b==null?void 0:b.ref)===g)return b.dataLen?(this.commonObjs.resolve(n,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,l])=>{var h;if(this.destroyed)return;const c=d(this,qr).get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Fe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=d(this,mf).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&d(this,yf).set(o.refStr,e);const l=new Zq(t,o,this,this._params.pdfBug);return d(this,qr).set(t,l),l});return d(this,mf).set(t,s),s}getPageIndex(e){return JE(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return M(this,wu,wg).call(this,"GetFieldObjects")}hasJSActions(){return M(this,wu,wg).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return M(this,wu,wg).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return M(this,wu,wg).call(this,"GetOptionalContentConfig").then(t=>new Dq(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=d(this,ea).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>{var o,l;return{info:s[0],metadata:s[1]?new Nq(s[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return d(this,ea).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of d(this,qr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),d(this,ea).clear(),this.filterFactory.destroy(!0),Vg.cleanup()}}cachedPageNumber(e){if(!JE(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return d(this,yf).get(t)??null}}ea=new WeakMap,qr=new WeakMap,mf=new WeakMap,yf=new WeakMap,ta=new WeakMap,wu=new WeakSet,wg=function(e,t=null){const n=d(this,ea).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return d(this,ea).set(e,s),s};var Ll;class t8{constructor(e){R(this,Ll,null);le(this,"onContinue",null);le(this,"onError",null);E(this,Ll,e)}get promise(){return d(this,Ll).capability.promise}cancel(e=0){d(this,Ll).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=d(this,Ll).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=d(this,Ll);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Ll=new WeakMap;var Ol,Cu;const Bc=class Bc{constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){R(this,Ol,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new t8(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=A,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var h,f;if(this.cancelled)return;if(this._canvas){if(d(Bc,Cu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");d(Bc,Cu).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new yh(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(e=null,t=0){var n,s,o;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),d(this,Ol)&&(window.cancelAnimationFrame(d(this,Ol)),E(this,Ol,null)),d(Bc,Cu).delete(this._canvas),e||(e=new a_(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(o=(s=this.task).onError)==null||o.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?E(this,Ol,window.requestAnimationFrame(()=>{E(this,Ol,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),d(Bc,Cu).delete(this._canvas),this.callback())))}};Ol=new WeakMap,Cu=new WeakMap,R(Bc,Cu,new WeakSet);let hT=Bc;const Ow="5.4.296",HP="f56dc8601";var es,xu,vf,_n,Xm,bf,na,Wm,Ul,cr,Km,Ct,fT,pT,gT,Pc,GP,rl;const xi=class xi{constructor({editor:e=null,uiManager:t=null}){R(this,Ct);R(this,es,null);R(this,xu,null);R(this,vf);R(this,_n,null);R(this,Xm,!1);R(this,bf,!1);R(this,na,null);R(this,Wm);R(this,Ul,null);R(this,cr,null);var n,s;e?(E(this,bf,!1),E(this,na,e)):E(this,bf,!0),E(this,cr,(e==null?void 0:e._uiManager)||t),E(this,Wm,d(this,cr)._eventBus),E(this,vf,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((s=d(this,cr))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),d(xi,Km)||E(xi,Km,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ve(this,"_keyboardManager",new Dy([[["Escape","mac+Escape"],xi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],xi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],xi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],xi.prototype._moveToPrevious],[["Home","mac+Home"],xi.prototype._moveToBeginning],[["End","mac+End"],xi.prototype._moveToEnd]]))}renderButton(){const e=E(this,es,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",d(this,na)&&(e.ariaControls=`${d(this,na).id}_colorpicker_dropdown`);const t=d(this,cr)._signal;e.addEventListener("click",M(this,Ct,Pc).bind(this),{signal:t}),e.addEventListener("keydown",M(this,Ct,gT).bind(this),{signal:t});const n=E(this,xu,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=d(this,vf),e.append(n),e}renderMainDropdown(){const e=E(this,_n,M(this,Ct,fT).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===d(this,es)){M(this,Ct,Pc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&M(this,Ct,pT).call(this,t,e)}_moveToNext(e){var t,n;if(!d(this,Ct,rl)){M(this,Ct,Pc).call(this,e);return}if(e.target===d(this,es)){(t=d(this,_n).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=d(this,_n))==null?void 0:t.firstChild)||e.target===d(this,es)){d(this,Ct,rl)&&this._hideDropdownFromKeyboard();return}d(this,Ct,rl)||M(this,Ct,Pc).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!d(this,Ct,rl)){M(this,Ct,Pc).call(this,e);return}(t=d(this,_n).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!d(this,Ct,rl)){M(this,Ct,Pc).call(this,e);return}(t=d(this,_n).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=d(this,_n))==null||e.classList.add("hidden"),d(this,es).ariaExpanded="false",(t=d(this,Ul))==null||t.abort(),E(this,Ul,null)}_hideDropdownFromKeyboard(){var e;if(!d(this,bf)){if(!d(this,Ct,rl)){(e=d(this,na))==null||e.unselect();return}this.hideDropdown(),d(this,es).focus({preventScroll:!0,focusVisible:d(this,Xm)})}}updateColor(e){if(d(this,xu)&&(d(this,xu).style.backgroundColor=e),!d(this,_n))return;const t=d(this,cr).highlightColors.values();for(const n of d(this,_n).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=d(this,es))==null||e.remove(),E(this,es,null),E(this,xu,null),(t=d(this,_n))==null||t.remove(),E(this,_n,null)}};es=new WeakMap,xu=new WeakMap,vf=new WeakMap,_n=new WeakMap,Xm=new WeakMap,bf=new WeakMap,na=new WeakMap,Wm=new WeakMap,Ul=new WeakMap,cr=new WeakMap,Km=new WeakMap,Ct=new WeakSet,fT=function(){const e=document.createElement("div"),t=d(this,cr)._signal;e.addEventListener("contextmenu",vs,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),d(this,na)&&(e.id=`${d(this,na).id}_colorpicker_dropdown`);for(const[n,s]of d(this,cr).highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",d(xi,Km)[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.ariaSelected=s===d(this,vf),o.addEventListener("click",M(this,Ct,pT).bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",M(this,Ct,gT).bind(this),{signal:t}),e},pT=function(e,t){t.stopPropagation(),d(this,Wm).dispatch("switchannotationeditorparams",{source:this,type:tt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},gT=function(e){xi._keyboardManager.exec(this,e)},Pc=function(e){if(d(this,Ct,rl)){this.hideDropdown();return}if(E(this,Xm,e.detail===0),d(this,Ul)||(E(this,Ul,new AbortController),window.addEventListener("pointerdown",M(this,Ct,GP).bind(this),{signal:d(this,cr).combinedSignal(d(this,Ul))})),d(this,es).ariaExpanded="true",d(this,_n)){d(this,_n).classList.remove("hidden");return}const t=E(this,_n,M(this,Ct,fT).call(this));d(this,es).append(t)},GP=function(e){var t;(t=d(this,_n))!=null&&t.contains(e.target)||this.hideDropdown()},rl=function(){return d(this,_n)&&!d(this,_n).classList.contains("hidden")},R(xi,Km,null);let qg=xi;var $r,Jm,_f,jm;const Hc=class Hc{constructor(e){R(this,$r,null);R(this,Jm,null);R(this,_f,null);E(this,Jm,e),E(this,_f,e._uiManager),d(Hc,jm)||E(Hc,jm,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(d(this,$r))return d(this,$r);const{editorType:e,colorType:t,colorValue:n}=d(this,Jm),s=E(this,$r,document.createElement("input"));return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",d(Hc,jm)[e]),s.addEventListener("input",()=>{d(this,_f).updateParams(t,s.value)},{signal:d(this,_f)._signal}),s}update(e){d(this,$r)&&(d(this,$r).value=e)}destroy(){var e;(e=d(this,$r))==null||e.remove(),E(this,$r,null)}hideDropdown(){}};$r=new WeakMap,Jm=new WeakMap,_f=new WeakMap,jm=new WeakMap,R(Hc,jm,null);let vb=Hc;function xM(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function ag(i){return Math.max(0,Math.min(255,255*i))}class RM{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ag(e),[e,e,e]}static G_HTML([e]){const t=xM(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(ag)}static RGB_HTML(e){return`#${e.map(xM).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[ag(1-Math.min(1,e+s)),ag(1-Math.min(1,n+s)),ag(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,l=1-n,c=Math.min(s,o,l);return["CMYK",s,o,l,c]}}class n8{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){kt("Abstract method `_createSVG` called.")}}class $g extends n8{_createSVG(e){return document.createElementNS(Io,e)}}const i8=9,ed=new WeakSet,s8=new Date().getTimezoneOffset()*60*1e3;class IM{static create(e){switch(e.data.annotationType){case on.LINK:return new Uw(e);case on.TEXT:return new o8(e);case on.WIDGET:switch(e.data.fieldType){case"Tx":return new a8(e);case"Btn":return e.data.radioButton?new qP(e):e.data.checkBox?new c8(e):new u8(e);case"Ch":return new d8(e);case"Sig":return new l8(e)}return new cd(e);case on.POPUP:return new yT(e);case on.FREETEXT:return new KP(e);case on.LINE:return new f8(e);case on.SQUARE:return new p8(e);case on.CIRCLE:return new g8(e);case on.POLYLINE:return new JP(e);case on.CARET:return new y8(e);case on.INK:return new Fw(e);case on.POLYGON:return new m8(e);case on.HIGHLIGHT:return new jP(e);case on.UNDERLINE:return new v8(e);case on.SQUIGGLY:return new b8(e);case on.STRIKEOUT:return new _8(e);case on.STAMP:return new QP(e);case on.FILEATTACHMENT:return new S8(e);default:return new Wt(e)}}}var Ru,Sf,Vs,Qm,mT;const cC=class cC{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){R(this,Qm);R(this,Ru,null);R(this,Sf,!1);R(this,Vs,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return cC._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:e}=this,t=(n=this.annotationStorage)==null?void 0:n.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var c;const e=(c=this.annotationStorage)==null?void 0:c.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,l=-1/0;if((t==null?void 0:t.length)>=8){for(let h=0;h<t.length;h+=8)t[h+1]>l?(l=t[h+1],o=t[h+2]):t[h+1]===l&&(o=Math.max(o,t[h+2]));return[o,l]}if((n==null?void 0:n.length)>=1){for(const h of n)for(let f=0,g=h.length;f<g;f+=2)h[f+1]>l?(l=h[f+1],o=h[f]):h[f+1]===l&&(o=Math.max(o,h[f]));if(o!==1/0)return[o,l]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-l)/s,e}get commentText(){var t,n,s;const{data:e}=this;return((n=(t=this.annotationStorage.getRawValue(`${Fg}${e.id}`))==null?void 0:t.popup)==null?void 0:n.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Fg}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=d(this,Vs))==null?void 0:e.popup)||this.popup)==null||t.remove(),E(this,Vs,this.popup=null)}updateEdited(e){var o;if(!this.container)return;e.rect&&(d(this,Ru)||E(this,Ru,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&M(this,Qm,mT).call(this,t);let s=((o=d(this,Vs))==null?void 0:o.popup)||this.popup;!s&&(n!=null&&n.text)&&(this._createPopup(n),s=d(this,Vs).popup),s&&(s.updateEdited(e),n!=null&&n.deleted&&(s.remove(),E(this,Vs,null),this.popup=null))}resetEdited(){var e;d(this,Ru)&&(M(this,Qm,mT).call(this,d(this,Ru).rect),(e=d(this,Vs))==null||e.popup.resetEdited(),E(this,Ru,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof cd)&&!(this instanceof Uw)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof yT){const{rotation:C}=t;return!t.hasOwnCanvas&&C!==0&&this.setRotation(C,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const C=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(C>0||N>0){const P=`calc(${C}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;l.borderRadius=P}else if(this instanceof qP){const P=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=P}switch(t.borderStyle.style){case Qd.SOLID:l.borderStyle="solid";break;case Qd.DASHED:l.borderStyle="dashed";break;case Qd.BEVELED:Fe("Unimplemented border style: beveled");break;case Qd.INSET:Fe("Unimplemented border style: inset");break;case Qd.UNDERLINE:l.borderBottomStyle="solid";break}const I=t.borderColor||null;I?(E(this,Sf,!0),l.borderColor=ye.makeHexColor(I[0]|0,I[1]|0,I[2]|0)):l.borderWidth=0}const f=ye.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:y,pageX:b,pageY:A}=s.rawDims;l.left=`${100*(f[0]-b)/g}%`,l.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(l.width=`${100*c/g}%`,l.height=`${100*h/y}%`):this.setRotation(w,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:l}=this;e%180!==0&&([o,l]=[l,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*l/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],l=o[0],c=o.slice(1);s.target.style[n]=RM[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:RM[`${l}_rgb`](c)})};return Ve(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const o=e[s]||n[s];o==null||o(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:o},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(C=>Math.fround(C));if(e.length===8){const[C,N,I,P]=e.subarray(2,6);if(s===C&&o===N&&t===I&&n===P)return}const{style:l}=this.container;let c;if(d(this,Sf)){const{borderColor:C,borderWidth:N}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${C}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:g}=this,y=g.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=g.createElement("defs");y.append(b);const A=g.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let C=2,N=e.length;C<N;C+=8){const I=e[C],P=e[C+1],k=e[C+2],L=e[C+3],O=g.createElement("rect"),U=(k-t)/h,F=(o-P)/f,K=(I-k)/h,q=(P-L)/f;O.setAttribute("x",U),O.setAttribute("y",F),O.setAttribute("width",K),O.setAttribute("height",q),A.append(O),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${U}" y="${F}" width="${K}" height="${q}"/>`)}d(this,Sf)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate);const o=E(this,Vs,new yT({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(d(this,Vs)||this.popup||this.data.popupRef)}get extraPopupElement(){return d(this,Vs)}render(){kt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:l,exportValues:c}of s){if(o===-1||l===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!ed.has(f)){Fe(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==t&&ed.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Ru=new WeakMap,Sf=new WeakMap,Vs=new WeakMap,Qm=new WeakSet,mT=function(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(l-e[3]+h)/l}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(s)};let Wt=cC;class r8 extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var ps,Lc,zP,VP;class Uw extends Wt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});R(this,ps);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let o=!1;return t.url?(n.addLinkAttributes(s,t.url,t.newWindow),o=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),o=!0):t.attachment?(M(this,ps,zP).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),o=!0):t.setOCGState?(M(this,ps,VP).call(this,s,t.setOCGState,t.overlaidText),o=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),o=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),o=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),o=!0):this.isTooltipOnly&&!o&&(this._bindLink(s,""),o=!0)),this.container.classList.add("linkAnnotation"),o&&this.container.append(s),this.container}_bindLink(t,n,s=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,ps,Lc).call(this),s&&(t.title=s)}_bindNamedAction(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),s&&(t.title=s),M(this,ps,Lc).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(n.actions)){const l=s.get(o);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:o}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),M(this,ps,Lc).call(this)}_bindResetFormAction(t,n){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),M(this,ps,Lc).call(this),!this._fieldObjects){Fe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var y;s==null||s();const{fields:o,refs:l,include:c}=n,h=[];if(o.length!==0||l.length!==0){const b=new Set(l);for(const A of o){const w=this._fieldObjects[A]||[];for(const{id:C}of w)b.add(C)}for(const A of Object.values(this._fieldObjects))for(const w of A)b.has(w.id)===c&&h.push(w)}else for(const b of Object.values(this._fieldObjects))h.push(...b);const f=this.annotationStorage,g=[];for(const b of h){const{id:A}=b;switch(g.push(A),b.type){case"text":{const C=b.defaultValue||"";f.setValue(A,{value:C});break}case"checkbox":case"radiobutton":{const C=b.defaultValue===b.exportValues;f.setValue(A,{value:C});break}case"combobox":case"listbox":{const C=b.defaultValue||"";f.setValue(A,{value:C});break}default:continue}const w=document.querySelector(`[data-element-id="${A}"]`);if(w){if(!ed.has(w)){Fe(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:g,name:"ResetForm"}})),!1}}}ps=new WeakSet,Lc=function(){this.container.setAttribute("data-internal-link","")},zP=function(t,n,s="",o=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:s&&(t.title=s),t.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(n.content,n.filename,o),!1},M(this,ps,Lc).call(this)},VP=function(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),s&&(t.title=s),M(this,ps,Lc).call(this)};class o8 extends Wt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class cd extends Wt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Dn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}}))})}_setEventListeners(e,t,n,s){var o,l,c;for(const[h,f]of n)(f==="Action"||(o=this.data.actions)!=null&&o[f])&&((f==="Focus"||f==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,h,f,s),f==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):f==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ye.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||i8,o=e.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(qA*s))||1,y=f/g;l=Math.min(s,h(y/qA))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,h(f/qA))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=ye.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class a8 extends cd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),o.setValue(l.id,{[s]:n})}render(){var s,o;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&c.length>h&&(c=c.slice(0,h));let f=l.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const g={userValue:c,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=f??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",f??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),ed.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:y,datetimeType:b,timeStep:A}=this.data,w=!!b&&this.enableScripting;y&&(n.title=y),this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",N=>{e.setValue(t,{value:N.target.value}),this.setPropertyOnSiblings(n,"value",N.target.value,"value"),g.formattedValue=null}),n.addEventListener("resetform",N=>{const I=this.data.defaultFieldValue??"";n.value=g.userValue=I,g.formattedValue=null});let C=N=>{const{formattedValue:I}=g;I!=null&&(N.target.value=I),N.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",I=>{var k;if(g.focused)return;const{target:P}=I;if(w&&(P.type=b,A&&(P.step=A)),g.userValue){const L=g.userValue;if(w)if(b==="time"){const O=new Date(L),U=[O.getHours(),O.getMinutes(),O.getSeconds()];P.value=U.map(F=>F.toString().padStart(2,"0")).join(":")}else P.value=new Date(L-s8).toISOString().split(b==="date"?"T":".",1)[0];else P.value=L}g.lastCommittedValue=P.value,g.commitKey=1,(k=this.data.actions)!=null&&k.Focus||(g.focused=!0)}),n.addEventListener("updatefromsandbox",I=>{this.showElementAndHideCanvas(I.target);const P={value(k){g.userValue=k.detail.value??"",w||e.setValue(t,{value:g.userValue.toString()}),k.target.value=g.userValue},formattedValue(k){const{formattedValue:L}=k.detail;g.formattedValue=L,L!=null&&k.target!==document.activeElement&&(k.target.value=L);const O={formattedValue:L};w&&(O.value=L),e.setValue(t,O)},selRange(k){k.target.setSelectionRange(...k.detail.selRange)},charLimit:k=>{var F;const{charLimit:L}=k.detail,{target:O}=k;if(L===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",L);let U=g.userValue;!U||U.length<=L||(U=U.slice(0,L),O.value=g.userValue=U,e.setValue(t,{value:U}),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:U,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(P,I)}),n.addEventListener("keydown",I=>{var L;g.commitKey=1;let P=-1;if(I.key==="Escape"?P=0:I.key==="Enter"&&!this.data.multiLine?P=2:I.key==="Tab"&&(g.commitKey=3),P===-1)return;const{value:k}=I.target;g.lastCommittedValue!==k&&(g.lastCommittedValue=k,g.userValue=k,(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:P,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}}))});const N=C;C=null,n.addEventListener("blur",I=>{var L,O;if(!g.focused||!I.relatedTarget)return;(L=this.data.actions)!=null&&L.Blur||(g.focused=!1);const{target:P}=I;let{value:k}=P;if(w){if(k&&b==="time"){const U=k.split(":").map(F=>parseInt(F,10));k=new Date(2e3,0,1,U[0],U[1],U[2]||0).valueOf(),P.step=""}else k.includes("T")||(k=`${k}T00:00`),k=new Date(k).valueOf();P.type="text"}g.userValue=k,g.lastCommittedValue!==k&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:g.commitKey,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}})),N(I)}),(o=this.data.actions)!=null&&o.Keystroke&&n.addEventListener("beforeinput",I=>{var q;g.lastCommittedValue=null;const{data:P,target:k}=I,{value:L,selectionStart:O,selectionEnd:U}=k;let F=O,K=U;switch(I.inputType){case"deleteWordBackward":{const Q=L.substring(0,O).match(/\w*[^\w]*$/);Q&&(F-=Q[0].length);break}case"deleteWordForward":{const Q=L.substring(O).match(/^[^\w]*\w*/);Q&&(K+=Q[0].length);break}case"deleteContentBackward":O===U&&(F-=1);break;case"deleteContentForward":O===U&&(K+=1);break}I.preventDefault(),(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:L,change:P||"",willCommit:!1,selStart:F,selEnd:K}})}),this._setEventListeners(n,g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.value)}if(C&&n.addEventListener("blur",C),this.data.comb){const I=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${I}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class l8 extends cd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class c8 extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return ed.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n)){const g=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=g),e.setValue(f.id,{value:g})}e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class qP extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(ed.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=g&&y.id===n;y.domElement&&(y.domElement.checked=b),e.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class u8 extends Uw{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class d8 extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");ed.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const y=this.data.defaultFieldValue;for(const b of s.options)b.selected=b.value===y});for(const g of this.data.options){const y=document.createElement("option");y.textContent=g.displayValue,y.value=g.exportValue,n.value.includes(g.exportValue)&&(y.setAttribute("selected",!0),o=!1),s.append(y)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),l=()=>{g.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=g=>{const y=g?"value":"textContent",{options:b,multiple:A}=s;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=c(!1);const f=g=>{const y=g.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const y={value(b){l==null||l();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const C of s.options)C.selected=w.has(C.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(b){s.multiple=!0},remove(b){const A=s.options,w=b.detail.remove;A[w].selected=!1,s.remove(w),A.length>0&&Array.prototype.findIndex.call(A,N=>N.selected)===-1&&(A[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},clear(b){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(b){const{index:A,displayValue:w,exportValue:C}=b.detail.insert,N=s.children[A],I=document.createElement("option");I.textContent=w,I.value=C,N?N.before(I):s.append(I),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},items(b){const{items:A}=b.detail;for(;s.length!==0;)s.remove(0);for(const w of A){const{displayValue:C,exportValue:N}=w,I=document.createElement("option");I.textContent=C,I.value=N,s.append(I)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,g)}),s.addEventListener("input",g=>{var A;const y=c(!0),b=c(!1);e.setValue(t,{value:y}),g.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var Zm,vT;class yT extends Wt{constructor(t){const{data:n,elements:s,parent:o}=t,l=!!o._commentManager;super(t,{isRenderable:!l&&Wt._hasPopupData(n)});R(this,Zm);if(this.elements=s,l&&Wt._hasPopupData(n)){const c=this.popup=M(this,Zm,vT).call(this);for(const h of s)h.popup=c}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const n=this.popup=M(this,Zm,vT).call(this),s=[];for(const o of this.elements)o.popup=n,o.container.ariaHasPopup="dialog",s.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(o=>`${Rw}${o}`).join(",")),this.container}}Zm=new WeakSet,vT=function(){return new h8({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var ts,Fl,$b,Yb,Af,Ef,en,Yr,Bl,Iu,Tf,wf,Xr,ns,ia,sa,Cn,ra,Hl,ey,oa,Cf,Nu,Gl,ti,zl,$e,Ov,bT,_T,ST,Uv,AT,$P,YP,XP,WP,Fv,Bv,ET;class h8{constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:g,open:y,commentManager:b=null}){R(this,$e);R(this,ts,null);R(this,Fl,M(this,$e,XP).bind(this));R(this,$b,M(this,$e,ET).bind(this));R(this,Yb,M(this,$e,Bv).bind(this));R(this,Af,M(this,$e,Fv).bind(this));R(this,Ef,null);R(this,en,null);R(this,Yr,null);R(this,Bl,null);R(this,Iu,null);R(this,Tf,null);R(this,wf,null);R(this,Xr,!1);R(this,ns,null);R(this,ia,null);R(this,sa,null);R(this,Cn,null);R(this,ra,null);R(this,Hl,null);R(this,ey,null);R(this,oa,null);R(this,Cf,null);R(this,Nu,null);R(this,Gl,!1);R(this,ti,null);R(this,zl,null);E(this,en,e),E(this,Cf,s),E(this,Yr,l),E(this,oa,c),E(this,Tf,h),E(this,Ef,t),E(this,ey,f),E(this,wf,g),E(this,Iu,n),E(this,ts,b),E(this,ti,n[0]),E(this,Bl,Gg.toDateObject(o)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup()),b?this.renderCommentButton():(M(this,$e,Ov).call(this),d(this,en).hidden=!0,y&&M(this,$e,Fv).call(this))}renderCommentButton(){if(d(this,Cn)||(d(this,ra)||M(this,$e,bT).call(this),!d(this,ra)))return;const{signal:e}=E(this,ia,new AbortController),t=!!d(this,ti).extraPopupElement,n=()=>{d(this,ts).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{d(this,ts).toggleCommentPopup(this,!1,!0,!t)},o=()=>{d(this,ts).toggleCommentPopup(this,!1,!1)};if(t){E(this,Cn,d(this,ti).container);for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",d(this,Fl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=E(this,Cn,document.createElement("button"));l.className="annotationCommentButton";const c=d(this,ti).container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),M(this,$e,ST).call(this),M(this,$e,_T).call(this),l.addEventListener("keydown",d(this,Fl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),c.after(l)}}get commentButtonColor(){const{color:e,opacity:t}=d(this,ti).commentData;return e?d(this,Tf)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=d(this,Cn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=d(this,ti).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return d(this,Cn)}get comment(){return d(this,zl)||E(this,zl,d(this,ti).commentText),d(this,zl)}set comment(e){e!==this.comment&&(d(this,ti).commentText=E(this,zl,e))}get parentBoundingClientRect(){return d(this,ti).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){d(this,Cn)&&(d(this,Cn).classList.toggle("selected",e),d(this,Cn).ariaExpanded=t)}setSelectedCommentButton(e){d(this,Cn).classList.toggle("selected",e)}get commentPopupPosition(){if(d(this,Hl))return d(this,Hl);const{x:e,y:t,height:n}=d(this,Cn).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,ti).layer.getBoundingClientRect();return[(e-s)/l,(t+n-o)/c]}set commentPopupPosition(e){E(this,Hl,e)}hasDefaultPopupPosition(){return d(this,Hl)===null}get commentButtonPosition(){return d(this,ra)}get commentButtonWidth(){return d(this,Cn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=d(this,Hl)||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:l,width:c,height:h}=s;d(this,ts).showDialog(null,this,o+t*c,l+n*h,{...e,parentDimensions:s})}render(){var n,s;if(d(this,ns))return;const e=E(this,ns,document.createElement("div"));if(e.className="popup",d(this,Ef)){const o=e.style.outlineColor=ye.makeHexColor(...d(this,Ef));e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=d(this,Cf))!=null&&n.str){const o=document.createElement("span");o.className="title",t.append(o),{dir:o.dir,str:o.textContent}=d(this,Cf)}if(e.append(t),d(this,Bl)){const o=document.createElement("time");o.className="popupDate",o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:d(this,Bl).valueOf()})),o.dateTime=d(this,Bl).toISOString(),t.append(o)}Nw({html:d(this,$e,Uv)||d(this,Yr).str,dir:(s=d(this,Yr))==null?void 0:s.dir,className:"popupContent"},e),d(this,en).append(e)}updateEdited({rect:e,popup:t,deleted:n}){var s;if(d(this,ts)){n?(this.remove(),E(this,zl,null)):t&&(t.deleted?this.remove():(M(this,$e,ST).call(this),E(this,zl,t.text))),e&&(E(this,ra,null),M(this,$e,bT).call(this),M(this,$e,_T).call(this));return}if(n||t!=null&&t.deleted){this.remove();return}M(this,$e,Ov).call(this),d(this,Nu)||E(this,Nu,{contentsObj:d(this,Yr),richText:d(this,oa)}),e&&E(this,sa,null),t&&t.text&&(E(this,oa,M(this,$e,YP).call(this,t.text)),E(this,Bl,Gg.toDateObject(t.date)),E(this,Yr,null)),(s=d(this,ns))==null||s.remove(),E(this,ns,null)}resetEdited(){var e;d(this,Nu)&&({contentsObj:yn(this,Yr)._,richText:yn(this,oa)._}=d(this,Nu),E(this,Nu,null),(e=d(this,ns))==null||e.remove(),E(this,ns,null),E(this,sa,null))}remove(){var e,t,n;if((e=d(this,ia))==null||e.abort(),E(this,ia,null),(t=d(this,ns))==null||t.remove(),E(this,ns,null),E(this,Gl,!1),E(this,Xr,!1),(n=d(this,Cn))==null||n.remove(),E(this,Cn,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){E(this,Gl,this.isVisible),d(this,Gl)&&(d(this,en).hidden=!0)}maybeShow(){d(this,ts)||(M(this,$e,Ov).call(this),d(this,Gl)&&(d(this,ns)||M(this,$e,Bv).call(this),E(this,Gl,!1),d(this,en).hidden=!1))}get isVisible(){return d(this,ts)?!1:d(this,en).hidden===!1}}ts=new WeakMap,Fl=new WeakMap,$b=new WeakMap,Yb=new WeakMap,Af=new WeakMap,Ef=new WeakMap,en=new WeakMap,Yr=new WeakMap,Bl=new WeakMap,Iu=new WeakMap,Tf=new WeakMap,wf=new WeakMap,Xr=new WeakMap,ns=new WeakMap,ia=new WeakMap,sa=new WeakMap,Cn=new WeakMap,ra=new WeakMap,Hl=new WeakMap,ey=new WeakMap,oa=new WeakMap,Cf=new WeakMap,Nu=new WeakMap,Gl=new WeakMap,ti=new WeakMap,zl=new WeakMap,$e=new WeakSet,Ov=function(){var t;if(d(this,ia))return;E(this,ia,new AbortController);const{signal:e}=d(this,ia);for(const n of this.trigger)n.addEventListener("click",d(this,Af),{signal:e}),n.addEventListener("pointerenter",d(this,Yb),{signal:e}),n.addEventListener("pointerleave",d(this,$b),{signal:e}),n.classList.add("popupTriggerArea");for(const n of d(this,Iu))(t=n.container)==null||t.addEventListener("keydown",d(this,Fl),{signal:e})},bT=function(){const e=d(this,Iu).find(t=>t.hasCommentButton);e&&E(this,ra,e._normalizePoint(e.commentButtonPosition))},_T=function(){if(d(this,ti).extraPopupElement&&!d(this,ti).editor)return;this.renderCommentButton();const[e,t]=d(this,ra),{style:n}=d(this,Cn);n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`},ST=function(){d(this,ti).extraPopupElement||(this.renderCommentButton(),d(this,Cn).style.backgroundColor=this.commentButtonColor||"")},Uv=function(){const e=d(this,oa),t=d(this,Yr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&d(this,oa).html||null},AT=function(){var e,t,n;return((n=(t=(e=d(this,$e,Uv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},$P=function(){var e,t,n;return((n=(t=(e=d(this,$e,Uv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},YP=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:d(this,$e,$P),fontSize:d(this,$e,AT)?`calc(${d(this,$e,AT)}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n},XP=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&d(this,Xr))&&M(this,$e,Fv).call(this)},WP=function(){if(d(this,sa)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=d(this,Tf);let l=!!d(this,wf),c=l?d(this,wf):d(this,ey);for(const w of d(this,Iu))if(!c||ye.intersect(w.data.rect,c)!==null){c=w.data.rect,l=!0;break}const h=ye.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),g=l?c[2]-c[0]+5:0,y=h[0]+g,b=h[1];E(this,sa,[100*(y-s)/t,100*(b-o)/n]);const{style:A}=d(this,en);A.left=`${d(this,sa)[0]}%`,A.top=`${d(this,sa)[1]}%`},Fv=function(){if(d(this,ts)){d(this,ts).toggleCommentPopup(this,!1);return}E(this,Xr,!d(this,Xr)),d(this,Xr)?(M(this,$e,Bv).call(this),d(this,en).addEventListener("click",d(this,Af)),d(this,en).addEventListener("keydown",d(this,Fl))):(M(this,$e,ET).call(this),d(this,en).removeEventListener("click",d(this,Af)),d(this,en).removeEventListener("keydown",d(this,Fl)))},Bv=function(){d(this,ns)||this.render(),this.isVisible?d(this,Xr)&&d(this,en).classList.add("focused"):(M(this,$e,WP).call(this),d(this,en).hidden=!1,d(this,en).style.zIndex=parseInt(d(this,en).style.zIndex)+1e3)},ET=function(){d(this,en).classList.remove("focused"),!(d(this,Xr)||!this.isVisible)&&(d(this,en).hidden=!0,d(this,en).style.zIndex=parseInt(d(this,en).style.zIndex)-1e3)};class KP extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ue.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ty;class f8 extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,ty,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=E(this,ty,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,ty)}addHighlightArea(){this.container.classList.add("highlightArea")}}ty=new WeakMap;var ny;class p8 extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,ny,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=E(this,ny,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,ny)}addHighlightArea(){this.container.classList.add("highlightArea")}}ny=new WeakMap;var iy;class g8 extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,iy,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=E(this,iy,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",s/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,iy)}addHighlightArea(){this.container.classList.add("highlightArea")}}iy=new WeakMap;var sy;class JP extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,sy,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:s,popupRef:o},width:l,height:c}=this;if(!n)return this.container;const h=this.svgFactory.create(l,c,!0);let f=[];for(let y=0,b=n.length;y<b;y+=2){const A=n[y]-t[0],w=t[3]-n[y+1];f.push(`${A},${w}`)}f=f.join(" ");const g=E(this,sy,this.svgFactory.createElement(this.svgElementName));return g.setAttribute("points",f),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),h.append(g),this.container.append(h),!o&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,sy)}addHighlightArea(){this.container.classList.add("highlightArea")}}sy=new WeakMap;class m8 extends JP{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class y8 extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var ry,Mu,oy,TT;class Fw extends Wt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,oy);R(this,ry,null);R(this,Mu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ue.HIGHLIGHT:Ue.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:s,borderStyle:o,popupRef:l}}=this,{transform:c,width:h,height:f}=M(this,oy,TT).call(this,n,t),g=this.svgFactory.create(h,f,!0),y=E(this,ry,this.svgFactory.createElement("svg:g"));g.append(y),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",c);for(let b=0,A=s.length;b<A;b++){const w=this.svgFactory.createElement(this.svgElementName);d(this,Mu).push(w),w.setAttribute("points",s[b].join(",")),y.append(w)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(g),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:s,rect:o}=t,l=d(this,ry);if(n>=0&&l.setAttribute("stroke-width",n||1),s)for(let c=0,h=d(this,Mu).length;c<h;c++)d(this,Mu)[c].setAttribute("points",s[c].join(","));if(o){const{transform:c,width:h,height:f}=M(this,oy,TT).call(this,this.data.rotation,o);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${f}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return d(this,Mu)}addHighlightArea(){this.container.classList.add("highlightArea")}}ry=new WeakMap,Mu=new WeakMap,oy=new WeakSet,TT=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class jP extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ue.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class v8 extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class b8 extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class _8 extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class QP extends Wt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ue.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ay,ly,wT;class S8 extends Wt{constructor(t){var s;super(t,{isRenderable:!0});R(this,ly);R(this,ay,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",M(this,ly,wT).bind(this)),E(this,ay,s);const{isMac:o}=Dn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(o?l.metaKey:l.ctrlKey)&&M(this,ly,wT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return d(this,ay)}addHighlightArea(){this.container.classList.add("highlightArea")}}ay=new WeakMap,ly=new WeakSet,wT=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var xf,Du,Rf,Vl,cy,ku,uc,CT,xT,If;let Bw=(If=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:g}){R(this,uc);R(this,xf,null);R(this,Du,null);R(this,Rf,null);R(this,Vl,new Map);R(this,cy,null);R(this,ku,null);this.div=e,E(this,xf,t),E(this,Du,n),E(this,cy,c||null),E(this,ku,f||null),E(this,Rf,g||new Mw),this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return d(this,Vl).size>0}async render(e){var l,c,h;const{annotations:t}=e,n=this.div;ac(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:d(this,ku),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new $g,annotationStorage:d(this,Rf),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const f of t){if(f.noHTML)continue;const g=f.annotationType===on.POPUP;if(g){const A=s.get(f.id);if(!A)continue;o.elements=A}else if(f.rect[2]===f.rect[0]||f.rect[3]===f.rect[1])continue;o.data=f;const y=IM.create(o);if(!y.isRenderable)continue;if(!g&&f.popupRef){const A=s.get(f.popupRef);A?A.push(y):s.set(f.popupRef,[y])}const b=y.render();f.hidden&&(b.style.visibility="hidden"),await M(this,uc,CT).call(this,b,f.id,o.elements),(c=(l=y.extraPopupElement)==null?void 0:l.popup)==null||c.renderCommentButton(),y._isEditable&&(d(this,Vl).set(y.data.id,y),(h=this._annotationEditorUIManager)==null||h.renderAnnotationElement(y))}M(this,uc,xT).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:d(this,ku),svgFactory:new $g,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=If._defaultBorderStyle),t.data=n;const s=IM.create(t);if(!s.isRenderable)continue;const o=s.render();await M(this,uc,CT).call(this,o,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,ac(t,{rotation:e.rotation}),M(this,uc,xT).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(d(this,Vl).values())}getEditableAnnotation(e){return d(this,Vl).get(e)}addFakeAnnotation(e){var c;const{div:t}=this,{id:n,rotation:s}=e,o=new r8({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:d(this,ku),annotationStorage:d(this,Rf)}),l=o.render();return t.append(l),(c=d(this,xf))==null||c.moveElementInDOM(t,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Ve(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Qd.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},xf=new WeakMap,Du=new WeakMap,Rf=new WeakMap,Vl=new WeakMap,cy=new WeakMap,ku=new WeakMap,uc=new WeakSet,CT=async function(e,t,n){var c,h;const s=e.firstChild||e,o=s.id=`${Rw}${t}`,l=await((c=d(this,cy))==null?void 0:c.getAriaAttributes(o));if(l)for(const[f,g]of l)s.setAttribute(f,g);n?n.at(-1).container.after(e):(this.div.append(e),(h=d(this,xf))==null||h.moveElementInDOM(this.div,e,s,!1))},xT=function(){var t;if(!d(this,Du))return;const e=this.div;for(const[n,s]of d(this,Du)){const o=e.querySelector(`[data-annotation-id="${n}"]`);if(!o)continue;s.className="annotationContent";const{firstChild:l}=o;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):o.append(s);const c=d(this,Vl).get(n);c&&(c._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,o.id,s),c._hasNoCanvas=!1):c.canvas=s)}d(this,Du).clear()},If);const vv=/\r\n?|\n/g;var is,uy,Pu,ss,gn,ZP,e2,t2,Hv,_a,Gv,zv,n2,IT,i2;const Ft=class Ft extends Lt{constructor(t){super({...t,name:"freeTextEditor"});R(this,gn);R(this,is,"");R(this,uy,`${this.id}-editor`);R(this,Pu,null);R(this,ss);le(this,"_colorPicker",null);this.color=t.color||Ft._defaultColor||Lt._defaultLineColor,E(this,ss,t.fontSize||Ft._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Ft.prototype,n=l=>l.isEmpty(),s=lc.TRANSLATE_SMALL,o=lc.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Dy([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-o,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[o,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-o],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,o],checker:n}]]))}static initialize(t,n){Lt.initialize(t,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case tt.FREETEXT_SIZE:Ft._defaultFontSize=n;break;case tt.FREETEXT_COLOR:Ft._defaultColor=n;break}}updateParams(t,n){switch(t){case tt.FREETEXT_SIZE:M(this,gn,ZP).call(this,n);break;case tt.FREETEXT_COLOR:M(this,gn,e2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[tt.FREETEXT_SIZE,Ft._defaultFontSize],[tt.FREETEXT_COLOR,Ft._defaultColor||Lt._defaultLineColor]]}get propertiesToUpdate(){return[[tt.FREETEXT_SIZE,d(this,ss)],[tt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new vb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return tt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ft._internalPadding*t,-(Ft._internalPadding+d(this,ss))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),E(this,Pu,new AbortController);const t=this._uiManager.combinedSignal(d(this,Pu));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,uy)),this._isDraggable=!0,(t=d(this,Pu))==null||t.abort(),E(this,Pu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=d(this,is),n=E(this,is,M(this,gn,t2).call(this).trimEnd());if(t===n)return;const s=o=>{if(E(this,is,o),!o){this.remove();return}M(this,gn,zv).call(this),this._uiManager.rebuild(this),M(this,gn,Hv).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(t)},mustExec:!1}),M(this,gn,Hv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ft._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,uy)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${d(this,ss)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[o,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[h,f]=this.getInitialTranslation();[h,f]=this.pageTranslationToScreen(h,f);const[g,y]=this.pageDimensions,[b,A]=this.pageTranslation;let w,C;switch(this.rotation){case 0:w=t+(c[0]-b)/g,C=n+this.height-(c[1]-A)/y;break;case 90:w=t+(c[0]-b)/g,C=n-(c[1]-A)/y,[h,f]=[f,-h];break;case 180:w=t-this.width+(c[0]-b)/g,C=n-(c[1]-A)/y,[h,f]=[-h,-f];break;case 270:w=t+(c[0]-b-this.height*y)/g,C=n+(c[1]-A-this.width*g)/y,[h,f]=[-f,h];break}this.setAt(w*o,C*l,h,f)}else this._moveAfterPaste(t,n);M(this,gn,zv).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,C,N;const n=t.clipboardData||window.clipboardData,{types:s}=n;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const o=M(w=Ft,_a,IT).call(w,n.getData("text")||"").replaceAll(vv,`
`);if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!o.includes(`
`)){c.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=c,g=[],y=[];if(h.nodeType===Node.TEXT_NODE){const I=h.parentElement;if(y.push(h.nodeValue.slice(f).replaceAll(vv,"")),I!==this.editorDiv){let P=g;for(const k of this.editorDiv.childNodes){if(k===I){P=y;continue}P.push(M(C=Ft,_a,Gv).call(C,k))}}g.push(h.nodeValue.slice(0,f).replaceAll(vv,""))}else if(h===this.editorDiv){let I=g,P=0;for(const k of this.editorDiv.childNodes)P++===f&&(I=y),I.push(M(N=Ft,_a,Gv).call(N,k))}E(this,is,`${g.join(`
`)}${o}${y.join(`
`)}`),M(this,gn,zv).call(this);const b=new Range;let A=Math.sumPrecise(g.map(I=>I.length));for(const{firstChild:I}of this.editorDiv.childNodes)if(I.nodeType===Node.TEXT_NODE){const P=I.nodeValue.length;if(A<=P){b.setStart(I,A),b.setEnd(I,A);break}A-=P}l.removeAllRanges(),l.addRange(b)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ft._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,s){var c;let o=null;if(t instanceof KP){const{data:{defaultAppearanceData:{fontSize:h,fontColor:f},rect:g,rotation:y,id:b,popupRef:A,richText:w,contentsObj:C,creationDate:N,modificationDate:I},textContent:P,textPosition:k,parent:{page:{pageNumber:L}}}=t;if(!P||P.length===0)return null;o=t={annotationType:Ue.FREETEXT,color:Array.from(f),fontSize:h,value:P.join(`
`),position:k,pageIndex:L-1,rect:g.slice(0),rotation:y,annotationElementId:b,id:b,deleted:!1,popupRef:A,comment:(C==null?void 0:C.str)||null,richText:w,creationDate:N,modificationDate:I}}const l=await super.deserialize(t,n,s);return E(l,ss,t.fontSize),l.color=ye.makeHexColor(...t.color),E(l,is,M(c=Ft,_a,IT).call(c,t.value)),l._initialData=o,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:n,fontSize:d(this,ss),value:M(this,gn,n2).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!M(this,gn,i2).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:s}=n;s.fontSize=`calc(${d(this,ss)}px * var(--total-scale-factor))`,s.color=this.color,n.replaceChildren();for(const o of d(this,is).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:d(this,is)}}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};is=new WeakMap,uy=new WeakMap,Pu=new WeakMap,ss=new WeakMap,gn=new WeakSet,ZP=function(t){const n=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--total-scale-factor))`,this.translate(0,-(o-d(this,ss))*this.parentScale),E(this,ss,o),M(this,gn,Hv).call(this)},s=d(this,ss);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},e2=function(t){const n=o=>{this.color=o,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},t2=function(){var s;const t=[];this.editorDiv.normalize();let n=null;for(const o of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&o.nodeName==="BR"||(t.push(M(s=Ft,_a,Gv).call(s,o)),n=o);return t.join(`
`)},Hv=function(){const[t,n]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:o,div:l}=this,c=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",o.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/n):(this.width=s.height/t,this.height=s.width/n),this.fixAndSetPosition()},_a=new WeakSet,Gv=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(vv,"")},zv=function(){if(this.editorDiv.replaceChildren(),!!d(this,is))for(const t of d(this,is).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},n2=function(){return d(this,is).replaceAll(""," ")},IT=function(t){return t.replaceAll(" ","")},i2=function(t){const{value:n,fontSize:s,color:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==s||t.color.some((c,h)=>c!==o[h])||t.pageIndex!==l},R(Ft,_a),le(Ft,"_freeTextDefaultContent",""),le(Ft,"_internalPadding",0),le(Ft,"_defaultColor",null),le(Ft,"_defaultFontSize",10),le(Ft,"_type","freetext"),le(Ft,"_editorType",Ue.FREETEXT);let RT=Ft;class me{toSVGPath(){kt("Abstract method `toSVGPath` must be implemented.")}get box(){kt("Abstract getter `box` must be implemented.")}serialize(e,t){kt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*o;return l}static _rescaleAndSwap(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*o;return l}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+l)/6,(n+o)/2,(s+l)/2]}}le(me,"PRECISION",1e-4);var rs,ur,Nf,Mf,Wr,Ke,Lu,Ou,dy,hy,Df,kf,ql,fy,Xb,Wb,Sn,Cg,s2,r2,o2,a2,l2,c2;const ko=class ko{constructor({x:e,y:t},n,s,o,l,c=0){R(this,Sn);R(this,rs);R(this,ur,[]);R(this,Nf);R(this,Mf);R(this,Wr,[]);R(this,Ke,new Float32Array(18));R(this,Lu);R(this,Ou);R(this,dy);R(this,hy);R(this,Df);R(this,kf);R(this,ql,[]);E(this,rs,n),E(this,kf,o*s),E(this,Mf,l),d(this,Ke).set([NaN,NaN,NaN,NaN,e,t],6),E(this,Nf,c),E(this,hy,d(ko,fy)*s),E(this,dy,d(ko,Wb)*s),E(this,Df,s),d(this,ql).push(e,t)}isEmpty(){return isNaN(d(this,Ke)[8])}add({x:e,y:t}){var q;E(this,Lu,e),E(this,Ou,t);const[n,s,o,l]=d(this,rs);let[c,h,f,g]=d(this,Ke).subarray(8,12);const y=e-f,b=t-g,A=Math.hypot(y,b);if(A<d(this,dy))return!1;const w=A-d(this,hy),C=w/A,N=C*y,I=C*b;let P=c,k=h;c=f,h=g,f+=N,g+=I,(q=d(this,ql))==null||q.push(e,t);const L=-I/w,O=N/w,U=L*d(this,kf),F=O*d(this,kf);return d(this,Ke).set(d(this,Ke).subarray(2,8),0),d(this,Ke).set([f+U,g+F],4),d(this,Ke).set(d(this,Ke).subarray(14,18),12),d(this,Ke).set([f-U,g-F],16),isNaN(d(this,Ke)[6])?(d(this,Wr).length===0&&(d(this,Ke).set([c+U,h+F],2),d(this,Wr).push(NaN,NaN,NaN,NaN,(c+U-n)/o,(h+F-s)/l),d(this,Ke).set([c-U,h-F],14),d(this,ur).push(NaN,NaN,NaN,NaN,(c-U-n)/o,(h-F-s)/l)),d(this,Ke).set([P,k,c,h,f,g],6),!this.isEmpty()):(d(this,Ke).set([P,k,c,h,f,g],6),Math.abs(Math.atan2(k-h,P-c)-Math.atan2(I,N))<Math.PI/2?([c,h,f,g]=d(this,Ke).subarray(2,6),d(this,Wr).push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+g)/2-s)/l),[c,h,P,k]=d(this,Ke).subarray(14,18),d(this,ur).push(NaN,NaN,NaN,NaN,((P+c)/2-n)/o,((k+h)/2-s)/l),!0):([P,k,c,h,f,g]=d(this,Ke).subarray(0,6),d(this,Wr).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),[f,g,c,h,P,k]=d(this,Ke).subarray(12,18),d(this,ur).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=d(this,Wr),t=d(this,ur);if(isNaN(d(this,Ke)[6])&&!this.isEmpty())return M(this,Sn,s2).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);M(this,Sn,o2).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return M(this,Sn,r2).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,o,l){return new u2(e,t,n,s,o,l)}getOutlines(){var y;const e=d(this,Wr),t=d(this,ur),n=d(this,Ke),[s,o,l,c]=d(this,rs),h=new Float32Array((((y=d(this,ql))==null?void 0:y.length)??0)+2);for(let b=0,A=h.length-2;b<A;b+=2)h[b]=(d(this,ql)[b]-s)/l,h[b+1]=(d(this,ql)[b+1]-o)/c;if(h[h.length-2]=(d(this,Lu)-s)/l,h[h.length-1]=(d(this,Ou)-o)/c,isNaN(n[6])&&!this.isEmpty())return M(this,Sn,a2).call(this,h);const f=new Float32Array(d(this,Wr).length+24+d(this,ur).length);let g=e.length;for(let b=0;b<g;b+=2){if(isNaN(e[b])){f[b]=f[b+1]=NaN;continue}f[b]=e[b],f[b+1]=e[b+1]}g=M(this,Sn,c2).call(this,f,g);for(let b=t.length-6;b>=6;b-=6)for(let A=0;A<6;A+=2){if(isNaN(t[b+A])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=t[b+A],f[g+1]=t[b+A+1],g+=2}return M(this,Sn,l2).call(this,f,g),this.newFreeDrawOutline(f,h,d(this,rs),d(this,Df),d(this,Nf),d(this,Mf))}};rs=new WeakMap,ur=new WeakMap,Nf=new WeakMap,Mf=new WeakMap,Wr=new WeakMap,Ke=new WeakMap,Lu=new WeakMap,Ou=new WeakMap,dy=new WeakMap,hy=new WeakMap,Df=new WeakMap,kf=new WeakMap,ql=new WeakMap,fy=new WeakMap,Xb=new WeakMap,Wb=new WeakMap,Sn=new WeakSet,Cg=function(){const e=d(this,Ke).subarray(4,6),t=d(this,Ke).subarray(16,18),[n,s,o,l]=d(this,rs);return[(d(this,Lu)+(e[0]-t[0])/2-n)/o,(d(this,Ou)+(e[1]-t[1])/2-s)/l,(d(this,Lu)+(t[0]-e[0])/2-n)/o,(d(this,Ou)+(t[1]-e[1])/2-s)/l]},s2=function(){const[e,t,n,s]=d(this,rs),[o,l,c,h]=M(this,Sn,Cg).call(this);return`M${(d(this,Ke)[2]-e)/n} ${(d(this,Ke)[3]-t)/s} L${(d(this,Ke)[4]-e)/n} ${(d(this,Ke)[5]-t)/s} L${o} ${l} L${c} ${h} L${(d(this,Ke)[16]-e)/n} ${(d(this,Ke)[17]-t)/s} L${(d(this,Ke)[14]-e)/n} ${(d(this,Ke)[15]-t)/s} Z`},r2=function(e){const t=d(this,ur);e.push(`L${t[4]} ${t[5]} Z`)},o2=function(e){const[t,n,s,o]=d(this,rs),l=d(this,Ke).subarray(4,6),c=d(this,Ke).subarray(16,18),[h,f,g,y]=M(this,Sn,Cg).call(this);e.push(`L${(l[0]-t)/s} ${(l[1]-n)/o} L${h} ${f} L${g} ${y} L${(c[0]-t)/s} ${(c[1]-n)/o}`)},a2=function(e){const t=d(this,Ke),[n,s,o,l]=d(this,rs),[c,h,f,g]=M(this,Sn,Cg).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/l],0),this.newFreeDrawOutline(y,e,d(this,rs),d(this,Df),d(this,Nf),d(this,Mf))},l2=function(e,t){const n=d(this,ur);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},c2=function(e,t){const n=d(this,Ke).subarray(4,6),s=d(this,Ke).subarray(16,18),[o,l,c,h]=d(this,rs),[f,g,y,b]=M(this,Sn,Cg).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-l)/h],t),t+=24},R(ko,fy,8),R(ko,Xb,2),R(ko,Wb,d(ko,fy)+d(ko,Xb));let bb=ko;var Pf,Uu,aa,py,os,gy,ln,Kb,d2;class u2 extends me{constructor(t,n,s,o,l,c){super();R(this,Kb);R(this,Pf);R(this,Uu,new Float32Array(4));R(this,aa);R(this,py);R(this,os);R(this,gy);R(this,ln);E(this,ln,t),E(this,os,n),E(this,Pf,s),E(this,gy,o),E(this,aa,l),E(this,py,c),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],M(this,Kb,d2).call(this,c);const[h,f,g,y]=d(this,Uu);for(let b=0,A=t.length;b<A;b+=2)t[b]=(t[b]-h)/g,t[b+1]=(t[b+1]-f)/y;for(let b=0,A=n.length;b<A;b+=2)n[b]=(n[b]-h)/g,n[b+1]=(n[b+1]-f)/y}toSVGPath(){const t=[`M${d(this,ln)[4]} ${d(this,ln)[5]}`];for(let n=6,s=d(this,ln).length;n<s;n+=6){if(isNaN(d(this,ln)[n])){t.push(`L${d(this,ln)[n+4]} ${d(this,ln)[n+5]}`);continue}t.push(`C${d(this,ln)[n]} ${d(this,ln)[n+1]} ${d(this,ln)[n+2]} ${d(this,ln)[n+3]} ${d(this,ln)[n+4]} ${d(this,ln)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,s,o],l){const c=s-t,h=o-n;let f,g;switch(l){case 0:f=me._rescale(d(this,ln),t,o,c,-h),g=me._rescale(d(this,os),t,o,c,-h);break;case 90:f=me._rescaleAndSwap(d(this,ln),t,n,c,h),g=me._rescaleAndSwap(d(this,os),t,n,c,h);break;case 180:f=me._rescale(d(this,ln),s,n,-c,h),g=me._rescale(d(this,os),s,n,-c,h);break;case 270:f=me._rescaleAndSwap(d(this,ln),s,o,-c,-h),g=me._rescaleAndSwap(d(this,os),s,o,-c,-h);break}return{outline:Array.from(f),points:[Array.from(g)]}}get box(){return d(this,Uu)}newOutliner(t,n,s,o,l,c=0){return new bb(t,n,s,o,l,c)}getNewOutline(t,n){const[s,o,l,c]=d(this,Uu),[h,f,g,y]=d(this,Pf),b=l*g,A=c*y,w=s*g+h,C=o*y+f,N=this.newOutliner({x:d(this,os)[0]*b+w,y:d(this,os)[1]*A+C},d(this,Pf),d(this,gy),t,d(this,py),n??d(this,aa));for(let I=2;I<d(this,os).length;I+=2)N.add({x:d(this,os)[I]*b+w,y:d(this,os)[I+1]*A+C});return N.getOutlines()}}Pf=new WeakMap,Uu=new WeakMap,aa=new WeakMap,py=new WeakMap,os=new WeakMap,gy=new WeakMap,ln=new WeakMap,Kb=new WeakSet,d2=function(t){const n=d(this,ln);let s=n[4],o=n[5];const l=[s,o,s,o];let c=s,h=o,f=s,g=o;const y=t?Math.max:Math.min,b=new Float32Array(4);for(let w=6,C=n.length;w<C;w+=6){const N=n[w+4],I=n[w+5];isNaN(n[w])?(ye.pointBoundingBox(N,I,l),h>I?(c=N,h=I):h===I&&(c=y(c,N)),g<I?(f=N,g=I):g===I&&(f=y(f,N))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,ye.bezierBoundingBox(s,o,...n.slice(w,w+6),b),ye.rectBoundingBox(b[0],b[1],b[2],b[3],l),h>b[1]?(c=b[0],h=b[1]):h===b[1]&&(c=y(c,b[0])),g<b[3]?(f=b[2],g=b[3]):g===b[3]&&(f=y(f,b[2]))),s=N,o=I}const A=d(this,Uu);A[0]=l[0]-d(this,aa),A[1]=l[1]-d(this,aa),A[2]=l[2]-l[0]+2*d(this,aa),A[3]=l[3]-l[1]+2*d(this,aa),this.firstPoint=[c,h],this.lastPoint=[f,g]};var my,yy,vy,$l,dr,mi,h2,Vv,f2,p2,MT;class NT{constructor(e,t=0,n=0,s=!0){R(this,mi);R(this,my);R(this,yy);R(this,vy);R(this,$l,[]);R(this,dr,[]);const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:C,y:N,width:I,height:P}of e){const k=Math.floor((C-t)/l)*l,L=Math.ceil((C+I+t)/l)*l,O=Math.floor((N-t)/l)*l,U=Math.ceil((N+P+t)/l)*l,F=[k,O,U,!0],K=[L,O,U,!1];d(this,$l).push(F,K),ye.rectBoundingBox(k,O,L,U,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,g=o[1]-n;let y=s?-1/0:1/0,b=1/0;const A=d(this,$l).at(s?-1:-2),w=[A[0],A[2]];for(const C of d(this,$l)){const[N,I,P,k]=C;!k&&s?I<b?(b=I,y=N):I===b&&(y=Math.max(y,N)):k&&!s&&(I<b?(b=I,y=N):I===b&&(y=Math.min(y,N))),C[0]=(N-f)/c,C[1]=(I-g)/h,C[2]=(P-g)/h}E(this,my,new Float32Array([f,g,c,h])),E(this,yy,[y,b]),E(this,vy,w)}getOutlines(){d(this,$l).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of d(this,$l))t[3]?(e.push(...M(this,mi,MT).call(this,t)),M(this,mi,f2).call(this,t)):(M(this,mi,p2).call(this,t),e.push(...M(this,mi,MT).call(this,t)));return M(this,mi,h2).call(this,e)}}my=new WeakMap,yy=new WeakMap,vy=new WeakMap,$l=new WeakMap,dr=new WeakMap,mi=new WeakSet,h2=function(e){const t=[],n=new Set;for(const l of e){const[c,h,f]=l;t.push([c,h,l],[c,f,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],f=t[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[c,h,f,g,y]=l;n.delete(l);let b=c,A=h;for(o=[c,f],s.push(o);;){let w;if(n.has(g))w=g;else if(n.has(y))w=y;else break;n.delete(w),[c,h,f,g,y]=w,b!==c&&(o.push(b,A,c,A===h?h:f),b=c),A=A===h?f:h}o.push(b,A)}return new A8(s,d(this,my),d(this,yy),d(this,vy))},Vv=function(e){const t=d(this,dr);let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,l=t[o][0];if(l===e)return o;l<e?n=o+1:s=o-1}return s+1},f2=function([,e,t]){const n=M(this,mi,Vv).call(this,e);d(this,dr).splice(n,0,[e,t])},p2=function([,e,t]){const n=M(this,mi,Vv).call(this,e);for(let s=n;s<d(this,dr).length;s++){const[o,l]=d(this,dr)[s];if(o!==e)break;if(o===e&&l===t){d(this,dr).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=d(this,dr)[s];if(o!==e)break;if(o===e&&l===t){d(this,dr).splice(s,1);return}}},MT=function(e){const[t,n,s]=e,o=[[t,n,s]],l=M(this,mi,Vv).call(this,s);for(let c=0;c<l;c++){const[h,f]=d(this,dr)[c];for(let g=0,y=o.length;g<y;g++){const[,b,A]=o[g];if(!(f<=b||A<=h)){if(b>=h){if(A>f)o[g][1]=f;else{if(y===1)return[];o.splice(g,1),g--,y--}continue}o[g][2]=h,A>f&&o.push([t,f,A])}}}return o};var by,Lf;class A8 extends me{constructor(t,n,s,o){super();R(this,by);R(this,Lf);E(this,Lf,t),E(this,by,n),this.firstPoint=s,this.lastPoint=o}toSVGPath(){const t=[];for(const n of d(this,Lf)){let[s,o]=n;t.push(`M${s} ${o}`);for(let l=2;l<n.length;l+=2){const c=n[l],h=n[l+1];c===s?(t.push(`V${h}`),o=h):h===o&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,n,s,o],l){const c=[],h=s-t,f=o-n;for(const g of d(this,Lf)){const y=new Array(g.length);for(let b=0;b<g.length;b+=2)y[b]=t+g[b]*h,y[b+1]=o-g[b+1]*f;c.push(y)}return c}get box(){return d(this,by)}get classNamesForOutlining(){return["highlightOutline"]}}by=new WeakMap,Lf=new WeakMap;class DT extends bb{newFreeDrawOutline(e,t,n,s,o,l){return new E8(e,t,n,s,o,l)}}class E8 extends u2{newOutliner(e,t,n,s,o,l=0){return new DT(e,t,n,s,o,l)}}var Of,_y,la,Fu,Sy,ki,Ay,Ey,Bu,as,ls,qn,Uf,Ff,ni,Bf,qs,Ty,qe,kT,qv,g2,m2,y2,PT,Oc,Xs,sh,v2,$v,Yv,b2,_2,S2,A2,E2;const dt=class dt extends Lt{constructor(t){super({...t,name:"highlightEditor"});R(this,qe);R(this,Of,null);R(this,_y,0);R(this,la);R(this,Fu,null);R(this,Sy,null);R(this,ki,null);R(this,Ay,null);R(this,Ey,0);R(this,Bu,null);R(this,as,null);R(this,ls,null);R(this,qn,!1);R(this,Uf,null);R(this,Ff,null);R(this,ni,null);R(this,Bf,"");R(this,qs);R(this,Ty,"");this.color=t.color||dt._defaultColor,E(this,qs,t.thickness||dt._defaultThickness),this.opacity=t.opacity||dt._defaultOpacity,E(this,la,t.boxes||null),E(this,Ty,t.methodOfCreation||""),E(this,Bf,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(E(this,qn,!0),M(this,qe,qv).call(this,t),M(this,qe,Oc).call(this)):d(this,la)&&(E(this,Of,t.anchorNode),E(this,_y,t.anchorOffset),E(this,Ay,t.focusNode),E(this,Ey,t.focusOffset),M(this,qe,kT).call(this),M(this,qe,Oc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=dt.prototype;return Ve(this,"_keyboardManager",new Dy([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:d(this,qn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:d(this,qs),methodOfCreation:d(this,Ty)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var s;Lt.initialize(t,n),dt._defaultColor||(dt._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case tt.HIGHLIGHT_COLOR:dt._defaultColor=n;break;case tt.HIGHLIGHT_THICKNESS:dt._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return d(this,Ff)}get commentButtonPosition(){return d(this,Uf)}updateParams(t,n){switch(t){case tt.HIGHLIGHT_COLOR:M(this,qe,g2).call(this,n);break;case tt.HIGHLIGHT_THICKNESS:M(this,qe,m2).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[tt.HIGHLIGHT_COLOR,dt._defaultColor],[tt.HIGHLIGHT_THICKNESS,dt._defaultThickness]]}get propertiesToUpdate(){return[[tt.HIGHLIGHT_COLOR,this.color||dt._defaultColor],[tt.HIGHLIGHT_THICKNESS,d(this,qs)||dt._defaultThickness],[tt.HIGHLIGHT_FREE,d(this,qn)]]}onUpdatedColor(){var t,n;(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ls),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=d(this,Sy))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",E(this,Sy,new qg({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,qe,Yv).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,M(this,qe,Yv).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){M(this,qe,PT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,qe,Oc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?M(this,qe,PT).call(this):t&&(M(this,qe,Oc).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var o,l,c;const{drawLayer:n}=this.parent;let s;d(this,qn)?(t=(t-this.rotation+360)%360,s=M(o=dt,Xs,sh).call(o,d(this,as).box,t)):s=M(l=dt,Xs,sh).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(d(this,ls),{bbox:s,root:{"data-main-rotation":t}}),n.updateProperties(d(this,ni),{bbox:M(c=dt,Xs,sh).call(c,d(this,ki).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();d(this,Bf)&&(t.setAttribute("aria-label",d(this,Bf)),t.setAttribute("role","mark")),d(this,qn)?t.classList.add("free"):this.div.addEventListener("keydown",M(this,qe,v2).bind(this),{signal:this._uiManager._signal});const n=E(this,Bu,document.createElement("div"));return t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=d(this,Fu),this.setDims(this.width,this.height),qk(this,d(this,Bu),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ni),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ni),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:M(this,qe,$v).call(this,!0);break;case 1:case 3:M(this,qe,$v).call(this,!1);break}}select(){var t;super.select(),d(this,ni)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,ni),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),d(this,ni)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,ni),{rootClass:{selected:!1}}),d(this,qn)||M(this,qe,$v).call(this,!1))}get _mustFixPosition(){return!d(this,qn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(d(this,ls),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(d(this,ni),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:s,x:o,y:l}){const{x:c,y:h,width:f,height:g}=s.getBoundingClientRect(),y=new AbortController,b=t.combinedSignal(y),A=w=>{y.abort(),M(this,Xs,A2).call(this,t,w)};window.addEventListener("blur",A,{signal:b}),window.addEventListener("pointerup",A,{signal:b}),window.addEventListener("pointerdown",Xt,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",vs,{signal:b}),s.addEventListener("pointermove",M(this,Xs,S2).bind(this,t),{signal:b}),this._freeHighlight=new DT({x:o,y:l},[c,h,f,g],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,s){var C,N,I,P;let o=null;if(t instanceof jP){const{data:{quadPoints:k,rect:L,rotation:O,id:U,color:F,opacity:K,popupRef:q,richText:Q,contentsObj:Z,creationDate:oe,modificationDate:ce},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Ue.HIGHLIGHT,color:Array.from(F),opacity:K,quadPoints:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:U,id:U,deleted:!1,popupRef:q,richText:Q,comment:(Z==null?void 0:Z.str)||null,creationDate:oe,modificationDate:ce}}else if(t instanceof Fw){const{data:{inkLists:k,rect:L,rotation:O,id:U,color:F,borderStyle:{rawWidth:K},popupRef:q,richText:Q,contentsObj:Z,creationDate:oe,modificationDate:ce},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Ue.HIGHLIGHT,color:Array.from(F),thickness:K,inkLists:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:U,id:U,deleted:!1,popupRef:q,richText:Q,comment:(Z==null?void 0:Z.str)||null,creationDate:oe,modificationDate:ce}}const{color:l,quadPoints:c,inkLists:h,opacity:f}=t,g=await super.deserialize(t,n,s);g.color=ye.makeHexColor(...l),g.opacity=f||1,h&&E(g,qs,t.thickness),g._initialData=o,t.comment&&g.setCommentData(t);const[y,b]=g.pageDimensions,[A,w]=g.pageTranslation;if(c){const k=E(g,la,[]);for(let L=0;L<c.length;L+=8)k.push({x:(c[L]-A)/y,y:1-(c[L+1]-w)/b,width:(c[L+2]-c[L])/y,height:(c[L+1]-c[L+5])/b});M(C=g,qe,kT).call(C),M(N=g,qe,Oc).call(N),g.rotate(g.rotation)}else if(h){E(g,qn,!0);const k=h[0],L={x:k[0]-A,y:b-(k[1]-w)},O=new DT(L,[0,0,y,b],1,d(g,qs)/2,!0,.001);for(let K=0,q=k.length;K<q;K+=2)L.x=k[K]-A,L.y=b-(k[K+1]-w),O.add(L);const{id:U,clipPathId:F}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:O.toSVGPath()}},!0,!0);M(I=g,qe,qv).call(I,{highlightOutlines:O.getOutlines(),highlightId:U,clipPathId:F}),M(P=g,qe,Oc).call(P),g.rotate(g.parentRotation)}return g}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=Lt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:n,opacity:this.opacity,thickness:d(this,qs),quadPoints:M(this,qe,b2).call(this),outlines:M(this,qe,_2).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!M(this,qe,E2).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Of=new WeakMap,_y=new WeakMap,la=new WeakMap,Fu=new WeakMap,Sy=new WeakMap,ki=new WeakMap,Ay=new WeakMap,Ey=new WeakMap,Bu=new WeakMap,as=new WeakMap,ls=new WeakMap,qn=new WeakMap,Uf=new WeakMap,Ff=new WeakMap,ni=new WeakMap,Bf=new WeakMap,qs=new WeakMap,Ty=new WeakMap,qe=new WeakSet,kT=function(){const t=new NT(d(this,la),.001);E(this,as,t.getOutlines()),[this.x,this.y,this.width,this.height]=d(this,as).box;const n=new NT(d(this,la),.0025,.001,this._uiManager.direction==="ltr");E(this,ki,n.getOutlines());const{firstPoint:s}=d(this,as);E(this,Uf,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:o}=d(this,ki);E(this,Ff,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},qv=function({highlightOutlines:t,highlightId:n,clipPathId:s}){var b,A;if(E(this,as,t),E(this,ki,t.getNewOutline(d(this,qs)/2+1.5,.0025)),n>=0)E(this,ls,n),E(this,Fu,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),E(this,ni,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:d(this,ki).box,path:{d:d(this,ki).toSVGPath()}},!0));else if(this.parent){const w=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(d(this,ls),{bbox:M(b=dt,Xs,sh).call(b,d(this,as).box,(w-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(d(this,ni),{bbox:M(A=dt,Xs,sh).call(A,d(this,ki).box,w),path:{d:d(this,ki).toSVGPath()}})}const[l,c,h,f]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=h,this.height=f;break;case 90:{const[w,C]=this.parentDimensions;this.x=c,this.y=1-l,this.width=h*C/w,this.height=f*w/C;break}case 180:this.x=1-l,this.y=1-c,this.width=h,this.height=f;break;case 270:{const[w,C]=this.parentDimensions;this.x=1-c,this.y=l,this.width=h*C/w,this.height=f*w/C;break}}const{firstPoint:g}=t;E(this,Uf,[(g[0]-l)/h,(g[1]-c)/f]);const{lastPoint:y}=d(this,ki);E(this,Ff,[(y[0]-l)/h,(y[1]-c)/f])},g2=function(t){const n=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,o=this.opacity;this.addCommands({cmd:n.bind(this,t,dt._defaultOpacity),undo:n.bind(this,s,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},m2=function(t){const n=d(this,qs),s=o=>{E(this,qs,o),M(this,qe,y2).call(this,o)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:tt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},y2=function(t){d(this,qn)&&(M(this,qe,qv).call(this,{highlightOutlines:d(this,as).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},PT=function(){d(this,ls)===null||!this.parent||(this.parent.drawLayer.remove(d(this,ls)),E(this,ls,null),this.parent.drawLayer.remove(d(this,ni)),E(this,ni,null))},Oc=function(t=this.parent){d(this,ls)===null&&({id:yn(this,ls)._,clipPathId:yn(this,Fu)._}=t.drawLayer.draw({bbox:d(this,as).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:d(this,qn)},path:{d:d(this,as).toSVGPath()}},!1,!0),E(this,ni,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:d(this,qn)},bbox:d(this,ki).box,path:{d:d(this,ki).toSVGPath()}},d(this,qn))),d(this,Bu)&&(d(this,Bu).style.clipPath=d(this,Fu)))},Xs=new WeakSet,sh=function([t,n,s,o],l){switch(l){case 90:return[1-n-o,t,o,s];case 180:return[1-t-s,1-n-o,s,o];case 270:return[n,1-t-s,o,s]}return[t,n,s,o]},v2=function(t){dt._keyboardManager.exec(this,t)},$v=function(t){if(!d(this,Of))return;const n=window.getSelection();t?n.setPosition(d(this,Of),d(this,_y)):n.setPosition(d(this,Ay),d(this,Ey))},Yv=function(){return d(this,qn)?this.rotation:0},b2=function(){if(d(this,qn))return null;const[t,n]=this.pageDimensions,[s,o]=this.pageTranslation,l=d(this,la),c=new Float32Array(l.length*8);let h=0;for(const{x:f,y:g,width:y,height:b}of l){const A=f*t+s,w=(1-g)*n+o;c[h]=c[h+4]=A,c[h+1]=c[h+3]=w,c[h+2]=c[h+6]=A+y*t,c[h+5]=c[h+7]=w-b*n,h+=8}return c},_2=function(t){return d(this,as).serialize(t,M(this,qe,Yv).call(this))},S2=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},A2=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},E2=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((s,o)=>s!==n[o])},R(dt,Xs),le(dt,"_defaultColor",null),le(dt,"_defaultOpacity",1),le(dt,"_defaultThickness",12),le(dt,"_type","highlight"),le(dt,"_editorType",Ue.HIGHLIGHT),le(dt,"_freeHighlightId",-1),le(dt,"_freeHighlight",null),le(dt,"_freeHighlightClipId","");let _b=dt;var Hu;class T2{constructor(){R(this,Hu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){d(this,Hu)[e]=t}toSVGProperties(){const e=d(this,Hu);return E(this,Hu,Object.create(null)),{root:e}}reset(){E(this,Hu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){kt("Not implemented")}}Hu=new WeakMap;var cs,Hf,xn,Gu,zu,Yl,Xl,Wl,Vu,st,LT,OT,UT,xg,w2,Xv,Rg,rh;const _e=class _e extends Lt{constructor(t){super(t);R(this,st);R(this,cs,null);R(this,Hf);le(this,"_colorPicker",null);le(this,"_drawId",null);E(this,Hf,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(M(this,st,LT).call(this,t),M(this,st,xg).call(this))}static _mergeSVGProperties(t,n){const s=new Set(Object.keys(t));for(const[o,l]of Object.entries(n))s.has(o)?Object.assign(t[o],l):t[o]=l;return t}static getDefaultDrawingOptions(t){kt("Not implemented")}static get typesMap(){kt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(d(_e,xn).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[s,o]of this.typesMap)t.push([s,n[o]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[s,o]of this.constructor.typesMap)t.push([s,n[o]]);return t}_updateProperty(t,n,s){const o=this._drawingOptions,l=o[n],c=h=>{var g;o.updateProperty(n,h);const f=d(this,cs).updateProperty(n,h);f&&M(this,st,Rg).call(this,f),(g=this.parent)==null||g.drawLayer.updateProperties(this._drawId,o.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(d(this,cs).getPathResizingSVGProperties(M(this,st,Xv).call(this)),{bbox:M(this,st,rh).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(d(this,cs).getPathResizedSVGProperties(M(this,st,Xv).call(this)),{bbox:M(this,st,rh).call(this)}))}_onTranslating(t,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:M(this,st,rh).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(d(this,cs).getPathTranslatedSVGProperties(M(this,st,Xv).call(this),this.parentDimensions),{bbox:M(this,st,rh).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,d(this,Hf)&&(E(this,Hf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){M(this,st,UT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,st,xg).call(this),M(this,st,Rg).call(this,d(this,cs).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),M(this,st,UT).call(this)):t&&(this._uiManager.addShouldRescale(this),M(this,st,xg).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:M(this,st,rh).call(this)},d(this,cs).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,st,Rg).call(this,d(this,cs).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const s=super.render();s.classList.add("draw");const o=document.createElement("div");return s.append(o),o.setAttribute("aria-hidden","true"),o.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),s}static createDrawerInstance(t,n,s,o,l){kt("Not implemented")}static startDrawing(t,n,s,o){var N;const{target:l,offsetX:c,offsetY:h,pointerId:f,pointerType:g}=o;if(d(_e,Xl)&&d(_e,Xl)!==g)return;const{viewport:{rotation:y}}=t,{width:b,height:A}=l.getBoundingClientRect(),w=E(_e,Gu,new AbortController),C=t.combinedSignal(w);if(d(_e,Yl)||E(_e,Yl,f),d(_e,Xl)??E(_e,Xl,g),window.addEventListener("pointerup",I=>{var P;d(_e,Yl)===I.pointerId?this._endDraw(I):(P=d(_e,Wl))==null||P.delete(I.pointerId)},{signal:C}),window.addEventListener("pointercancel",I=>{var P;d(_e,Yl)===I.pointerId?this._currentParent.endDrawingSession():(P=d(_e,Wl))==null||P.delete(I.pointerId)},{signal:C}),window.addEventListener("pointerdown",I=>{d(_e,Xl)===I.pointerType&&((d(_e,Wl)||E(_e,Wl,new Set)).add(I.pointerId),d(_e,xn).isCancellable()&&(d(_e,xn).removeLastElement(),d(_e,xn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:C}),window.addEventListener("contextmenu",vs,{signal:C}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:C}),l.addEventListener("touchmove",I=>{I.timeStamp===d(_e,Vu)&&Xt(I)},{signal:C}),t.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),d(_e,xn)){t.drawLayer.updateProperties(this._currentDrawId,d(_e,xn).startNew(c,h,b,A,y));return}n.updateUIForDefaultProperties(this),E(_e,xn,this.createDrawerInstance(c,h,b,A,y)),E(_e,zu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(d(_e,zu).toSVGProperties(),d(_e,xn).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(E(_e,Vu,-1),!d(_e,xn))return;const{offsetX:n,offsetY:s,pointerId:o}=t;if(d(_e,Yl)===o){if(((l=d(_e,Wl))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,d(_e,xn).add(n,s)),E(_e,Vu,t.timeStamp),Xt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,E(_e,xn,null),E(_e,zu,null),E(_e,Xl,null),E(_e,Vu,NaN)),d(_e,Gu)&&(d(_e,Gu).abort(),E(_e,Gu,null),E(_e,Yl,NaN),E(_e,Wl,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,d(_e,xn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=d(_e,xn),o=this._currentDrawId,l=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(o,s.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(o,s.removeLastElement())},mustExec:!1,type:tt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(tt.DRAW_STEP),!d(_e,xn).isEmpty()){const{pageDimensions:[s,o],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:d(_e,xn).getOutlines(s*l,o*l,l,this._INNER_MARGIN),drawingOptions:d(_e,zu),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,s,o,l,c){kt("Not implemented")}static async deserialize(t,n,s){var y,b;const{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}=n.viewport,f=this.deserializeDraw(c,h,o,l,this._INNER_MARGIN,t),g=await super.deserialize(t,n,s);return g.createDrawingOptions(t),M(y=g,st,LT).call(y,{drawOutlines:f}),M(b=g,st,xg).call(b),g.onScaleChanging(),g.rotate(),g}serializeDraw(t){const[n,s]=this.pageTranslation,[o,l]=this.pageDimensions;return d(this,cs).serialize([n,s,o,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};cs=new WeakMap,Hf=new WeakMap,xn=new WeakMap,Gu=new WeakMap,zu=new WeakMap,Yl=new WeakMap,Xl=new WeakMap,Wl=new WeakMap,Vu=new WeakMap,st=new WeakSet,LT=function({drawOutlines:t,drawId:n,drawingOptions:s}){E(this,cs,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=M(this,st,OT).call(this,t,this.parent),M(this,st,Rg).call(this,t.box)},OT=function(t,n){const{id:s}=n.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},UT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},xg=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,st,OT).call(this,d(this,cs),t)}},w2=function([t,n,s,o]){const{parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[n,1-t,s*(c/l),o*(l/c)];case 180:return[1-t,1-n,s,o];case 270:return[1-n,t,s*(c/l),o*(l/c)];default:return[t,n,s,o]}},Xv=function(){const{x:t,y:n,width:s,height:o,parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[1-n,t,s*(l/c),o*(c/l)];case 180:return[1-t,1-n,s,o];case 270:return[n,1-t,s*(l/c),o*(c/l)];default:return[t,n,s,o]}},Rg=function(t){[this.x,this.y,this.width,this.height]=M(this,st,w2).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},rh=function(){const{x:t,y:n,width:s,height:o,rotation:l,parentRotation:c,parentDimensions:[h,f]}=this;switch((l*4+c)/90){case 1:return[1-n-o,t,o,s];case 2:return[1-t-s,1-n-o,s,o];case 3:return[n,1-t-s,o,s];case 4:return[t,n-s*(h/f),o*(f/h),s*(h/f)];case 5:return[1-n,t,s*(h/f),o*(f/h)];case 6:return[1-t-o*(f/h),1-n,o*(f/h),s*(h/f)];case 7:return[n-s*(h/f),1-t-o*(f/h),s*(h/f),o*(f/h)];case 8:return[t-s,n-o,s,o];case 9:return[1-n,t-s,o,s];case 10:return[1-t,1-n,s,o];case 11:return[n-o,1-t,o,s];case 12:return[t-o*(f/h),n,o*(f/h),s*(h/f)];case 13:return[1-n-s*(h/f),t-o*(f/h),s*(h/f),o*(f/h)];case 14:return[1-t,1-n-s*(h/f),o*(f/h),s*(h/f)];case 15:return[n,1-t,s*(h/f),o*(f/h)];default:return[t,n,s,o]}},le(_e,"_currentDrawId",-1),le(_e,"_currentParent",null),R(_e,xn,null),R(_e,Gu,null),R(_e,zu,null),R(_e,Yl,NaN),R(_e,Xl,null),R(_e,Wl,null),R(_e,Vu,NaN),le(_e,"_INNER_MARGIN",3);let Sb=_e;var Kr,Rn,In,qu,Gf,ci,$n,$s,$u,Yu,Xu,zf,Wv;class T8{constructor(e,t,n,s,o,l){R(this,zf);R(this,Kr,new Float64Array(6));R(this,Rn);R(this,In);R(this,qu);R(this,Gf);R(this,ci);R(this,$n,"");R(this,$s,0);R(this,$u,new Py);R(this,Yu);R(this,Xu);E(this,Yu,n),E(this,Xu,s),E(this,qu,o),E(this,Gf,l),[e,t]=M(this,zf,Wv).call(this,e,t);const c=E(this,Rn,[NaN,NaN,NaN,NaN,e,t]);E(this,ci,[e,t]),E(this,In,[{line:c,points:d(this,ci)}]),d(this,Kr).set(c,0)}updateProperty(e,t){e==="stroke-width"&&E(this,Gf,t)}isEmpty(){return!d(this,In)||d(this,In).length===0}isCancellable(){return d(this,ci).length<=10}add(e,t){[e,t]=M(this,zf,Wv).call(this,e,t);const[n,s,o,l]=d(this,Kr).subarray(2,6),c=e-o,h=t-l;return Math.hypot(d(this,Yu)*c,d(this,Xu)*h)<=2?null:(d(this,ci).push(e,t),isNaN(n)?(d(this,Kr).set([o,l,e,t],2),d(this,Rn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(d(this,Kr)[0])&&d(this,Rn).splice(6,6),d(this,Kr).set([n,s,o,l,e,t],0),d(this,Rn).push(...me.createBezierPoints(n,s,o,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(d(this,ci).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){E(this,Yu,n),E(this,Xu,s),E(this,qu,o),[e,t]=M(this,zf,Wv).call(this,e,t);const l=E(this,Rn,[NaN,NaN,NaN,NaN,e,t]);E(this,ci,[e,t]);const c=d(this,In).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),d(this,In).push({line:l,points:d(this,ci)}),d(this,Kr).set(l,0),E(this,$s,0),this.toSVGPath(),null}getLastElement(){return d(this,In).at(-1)}setLastElement(e){return d(this,In)?(d(this,In).push(e),E(this,Rn,e.line),E(this,ci,e.points),E(this,$s,0),{path:{d:this.toSVGPath()}}):d(this,$u).setLastElement(e)}removeLastElement(){if(!d(this,In))return d(this,$u).removeLastElement();d(this,In).pop(),E(this,$n,"");for(let e=0,t=d(this,In).length;e<t;e++){const{line:n,points:s}=d(this,In)[e];E(this,Rn,n),E(this,ci,s),E(this,$s,0),this.toSVGPath()}return{path:{d:d(this,$n)}}}toSVGPath(){const e=me.svgRound(d(this,Rn)[4]),t=me.svgRound(d(this,Rn)[5]);if(d(this,ci).length===2)return E(this,$n,`${d(this,$n)} M ${e} ${t} Z`),d(this,$n);if(d(this,ci).length<=6){const s=d(this,$n).lastIndexOf("M");E(this,$n,`${d(this,$n).slice(0,s)} M ${e} ${t}`),E(this,$s,6)}if(d(this,ci).length===4){const s=me.svgRound(d(this,Rn)[10]),o=me.svgRound(d(this,Rn)[11]);return E(this,$n,`${d(this,$n)} L ${s} ${o}`),E(this,$s,12),d(this,$n)}const n=[];d(this,$s)===0&&(n.push(`M ${e} ${t}`),E(this,$s,6));for(let s=d(this,$s),o=d(this,Rn).length;s<o;s+=6){const[l,c,h,f,g,y]=d(this,Rn).slice(s,s+6).map(me.svgRound);n.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}return E(this,$n,d(this,$n)+n.join(" ")),E(this,$s,d(this,Rn).length),d(this,$n)}getOutlines(e,t,n,s){const o=d(this,In).at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),d(this,$u).build(d(this,In),e,t,n,d(this,qu),d(this,Gf),s),E(this,Kr,null),E(this,Rn,null),E(this,In,null),E(this,$n,null),d(this,$u)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Kr=new WeakMap,Rn=new WeakMap,In=new WeakMap,qu=new WeakMap,Gf=new WeakMap,ci=new WeakMap,$n=new WeakMap,$s=new WeakMap,$u=new WeakMap,Yu=new WeakMap,Xu=new WeakMap,zf=new WeakSet,Wv=function(e,t){return me._normalizePoint(e,t,d(this,Yu),d(this,Xu),d(this,qu))};var ui,wy,Cy,us,Jr,jr,Vf,qf,Wu,Xn,Mo,C2,x2,R2;class Py extends me{constructor(){super(...arguments);R(this,Xn);R(this,ui);R(this,wy,0);R(this,Cy);R(this,us);R(this,Jr);R(this,jr);R(this,Vf);R(this,qf);R(this,Wu)}build(t,n,s,o,l,c,h){E(this,Jr,n),E(this,jr,s),E(this,Vf,o),E(this,qf,l),E(this,Wu,c),E(this,Cy,h??0),E(this,us,t),M(this,Xn,x2).call(this)}get thickness(){return d(this,Wu)}setLastElement(t){return d(this,us).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return d(this,us).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of d(this,us)){if(t.push(`M${me.svgRound(n[4])} ${me.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${me.svgRound(n[10])} ${me.svgRound(n[11])}`);continue}for(let s=6,o=n.length;s<o;s+=6){const[l,c,h,f,g,y]=n.subarray(s,s+6).map(me.svgRound);t.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}}return t.join("")}serialize([t,n,s,o],l){const c=[],h=[],[f,g,y,b]=M(this,Xn,C2).call(this);let A,w,C,N,I,P,k,L,O;switch(d(this,qf)){case 0:O=me._rescale,A=t,w=n+o,C=s,N=-o,I=t+f*s,P=n+(1-g-b)*o,k=t+(f+y)*s,L=n+(1-g)*o;break;case 90:O=me._rescaleAndSwap,A=t,w=n,C=s,N=o,I=t+g*s,P=n+f*o,k=t+(g+b)*s,L=n+(f+y)*o;break;case 180:O=me._rescale,A=t+s,w=n,C=-s,N=o,I=t+(1-f-y)*s,P=n+g*o,k=t+(1-f)*s,L=n+(g+b)*o;break;case 270:O=me._rescaleAndSwap,A=t+s,w=n+o,C=-s,N=-o,I=t+(1-g-b)*s,P=n+(1-f-y)*o,k=t+(1-g)*s,L=n+(1-f)*o;break}for(const{line:U,points:F}of d(this,us))c.push(O(U,A,w,C,N,l?new Array(U.length):null)),h.push(O(F,A,w,C,N,l?new Array(F.length):null));return{lines:c,points:h,rect:[I,P,k,L]}}static deserialize(t,n,s,o,l,{paths:{lines:c,points:h},rotation:f,thickness:g}){const y=[];let b,A,w,C,N;switch(f){case 0:N=me._rescale,b=-t/s,A=n/o+1,w=1/s,C=-1/o;break;case 90:N=me._rescaleAndSwap,b=-n/o,A=-t/s,w=1/o,C=1/s;break;case 180:N=me._rescale,b=t/s+1,A=-n/o,w=-1/s,C=1/o;break;case 270:N=me._rescaleAndSwap,b=n/o+1,A=t/s+1,w=-1/o,C=-1/s;break}if(!c){c=[];for(const P of h){const k=P.length;if(k===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1]]));continue}if(k===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1],NaN,NaN,NaN,NaN,P[2],P[3]]));continue}const L=new Float32Array(3*(k-2));c.push(L);let[O,U,F,K]=P.subarray(0,4);L.set([NaN,NaN,NaN,NaN,O,U],0);for(let q=4;q<k;q+=2){const Q=P[q],Z=P[q+1];L.set(me.createBezierPoints(O,U,F,K,Q,Z),(q-2)*3),[O,U,F,K]=[F,K,Q,Z]}}}for(let P=0,k=c.length;P<k;P++)y.push({line:N(c[P].map(L=>L??NaN),b,A,w,C),points:N(h[P].map(L=>L??NaN),b,A,w,C)});const I=new this.prototype.constructor;return I.build(y,s,o,1,f,g,l),I}get box(){return d(this,ui)}updateProperty(t,n){return t==="stroke-width"?M(this,Xn,R2).call(this,n):null}updateParentDimensions([t,n],s){const[o,l]=M(this,Xn,Mo).call(this);E(this,Jr,t),E(this,jr,n),E(this,Vf,s);const[c,h]=M(this,Xn,Mo).call(this),f=c-o,g=h-l,y=d(this,ui);return y[0]-=f,y[1]-=g,y[2]+=2*f,y[3]+=2*g,y}updateRotation(t){return E(this,wy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return d(this,ui).map(me.svgRound).join(" ")}get defaultProperties(){const[t,n]=d(this,ui);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=d(this,ui);let s=0,o=0,l=0,c=0,h=0,f=0;switch(d(this,wy)){case 90:o=n/t,l=-t/n,h=t;break;case 180:s=-1,c=-1,h=t,f=n;break;case 270:o=-n/t,l=t/n,f=n;break;default:return""}return`matrix(${s} ${o} ${l} ${c} ${me.svgRound(h)} ${me.svgRound(f)})`}getPathResizingSVGProperties([t,n,s,o]){const[l,c]=M(this,Xn,Mo).call(this),[h,f,g,y]=d(this,ui);if(Math.abs(g-l)<=me.PRECISION||Math.abs(y-c)<=me.PRECISION){const N=t+s/2-(h+g/2),I=n+o/2-(f+y/2);return{path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${I})`}}}const b=(s-2*l)/(g-2*l),A=(o-2*c)/(y-2*c),w=g/s,C=y/o;return{path:{"transform-origin":`${me.svgRound(h)} ${me.svgRound(f)}`,transform:`${this.rotationTransform} scale(${w} ${C}) translate(${me.svgRound(l)} ${me.svgRound(c)}) scale(${b} ${A}) translate(${me.svgRound(-l)} ${me.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,s,o]){const[l,c]=M(this,Xn,Mo).call(this),h=d(this,ui),[f,g,y,b]=h;if(h[0]=t,h[1]=n,h[2]=s,h[3]=o,Math.abs(y-l)<=me.PRECISION||Math.abs(b-c)<=me.PRECISION){const I=t+s/2-(f+y/2),P=n+o/2-(g+b/2);for(const{line:k,points:L}of d(this,us))me._translate(k,I,P,k),me._translate(L,I,P,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(s-2*l)/(y-2*l),w=(o-2*c)/(b-2*c),C=-A*(f+l)+t+l,N=-w*(g+c)+n+c;if(A!==1||w!==1||C!==0||N!==0)for(const{line:I,points:P}of d(this,us))me._rescale(I,C,N,A,w,I),me._rescale(P,C,N,A,w,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],s){const[o,l]=s,c=d(this,ui),h=t-c[0],f=n-c[1];if(d(this,Jr)===o&&d(this,jr)===l)for(const{line:g,points:y}of d(this,us))me._translate(g,h,f,g),me._translate(y,h,f,y);else{const g=d(this,Jr)/o,y=d(this,jr)/l;E(this,Jr,o),E(this,jr,l);for(const{line:b,points:A}of d(this,us))me._rescale(b,h,f,g,y,b),me._rescale(A,h,f,g,y,A);c[2]*=g,c[3]*=y}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${me.svgRound(t)} ${me.svgRound(n)}`}}}get defaultSVGProperties(){const t=d(this,ui);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${me.svgRound(t[0])} ${me.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}ui=new WeakMap,wy=new WeakMap,Cy=new WeakMap,us=new WeakMap,Jr=new WeakMap,jr=new WeakMap,Vf=new WeakMap,qf=new WeakMap,Wu=new WeakMap,Xn=new WeakSet,Mo=function(t=d(this,Wu)){const n=d(this,Cy)+t/2*d(this,Vf);return d(this,qf)%180===0?[n/d(this,Jr),n/d(this,jr)]:[n/d(this,jr),n/d(this,Jr)]},C2=function(){const[t,n,s,o]=d(this,ui),[l,c]=M(this,Xn,Mo).call(this,0);return[t+l,n+c,s-2*l,o-2*c]},x2=function(){const t=E(this,ui,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:o}of d(this,us)){if(o.length<=12){for(let h=4,f=o.length;h<f;h+=6)ye.pointBoundingBox(o[h],o[h+1],t);continue}let l=o[4],c=o[5];for(let h=6,f=o.length;h<f;h+=6){const[g,y,b,A,w,C]=o.subarray(h,h+6);ye.bezierBoundingBox(l,c,g,y,b,A,w,C,t),l=w,c=C}}const[n,s]=M(this,Xn,Mo).call(this);t[0]=ii(t[0]-n,0,1),t[1]=ii(t[1]-s,0,1),t[2]=ii(t[2]+n,0,1),t[3]=ii(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},R2=function(t){const[n,s]=M(this,Xn,Mo).call(this);E(this,Wu,t);const[o,l]=M(this,Xn,Mo).call(this),[c,h]=[o-n,l-s],f=d(this,ui);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f};class u_ extends T2{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Lt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new u_(this._viewParameters);return e.updateAll(this),e}}var Jb,I2;const fh=class fh extends Sb{constructor(t){super({...t,name:"inkEditor"});R(this,Jb);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Lt.initialize(t,n),this._defaultDrawingOptions=new u_(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[tt.INK_THICKNESS,"stroke-width"],[tt.INK_COLOR,"stroke"],[tt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,s,o,l){return new T8(t,n,s,o,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,s,o,l,c){return Py.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){let o=null;if(t instanceof Fw){const{data:{inkLists:c,rect:h,rotation:f,id:g,color:y,opacity:b,borderStyle:{rawWidth:A},popupRef:w,richText:C,contentsObj:N,creationDate:I,modificationDate:P},parent:{page:{pageNumber:k}}}=t;o=t={annotationType:Ue.INK,color:Array.from(y),thickness:A,opacity:b,paths:{points:c},boxes:null,pageIndex:k-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:w,richText:C,comment:(N==null?void 0:N.str)||null,creationDate:I,modificationDate:P}}const l=await super.deserialize(t,n,s);return l._initialData=o,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new vb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return tt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:s}){this._drawingOptions=fh.getDefaultDrawingOptions({stroke:ye.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":c}}=this,h=Object.assign(super.serialize(t),{color:Lt._colorManager.convert(o),opacity:l,thickness:c,paths:{lines:n,points:s}});return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!M(this,Jb,I2).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};Jb=new WeakSet,I2=function(t){const{color:n,thickness:s,opacity:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,h)=>c!==n[h])||t.thickness!==s||t.opacity!==o||t.pageIndex!==l},le(fh,"_type","ink"),le(fh,"_editorType",Ue.INK),le(fh,"_defaultDrawingOptions",null);let FT=fh;class BT extends Py{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const bv=8,lg=3;var Ku,ht,HT,hr,N2,M2,GT,Kv,D2,k2,P2,zT,VT,L2;class to{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,l,c,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const y=200,b=g.font=`${n} ${s} ${y}px ${t}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:C,actualBoundingBoxDescent:N,fontBoundingBoxAscent:I,fontBoundingBoxDescent:P,width:k}=g.measureText(e),L=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,k)*L),U=Math.ceil(Math.max(Math.abs(C)+Math.abs(N)||y,Math.abs(I)+Math.abs(P)||y)*L);f=new OffscreenCanvas(O,U),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,U),g.fillStyle="black",g.fillText(e,O*(L-1)/2,U*(3-L)/2);const F=M(this,ht,zT).call(this,g.getImageData(0,0,O,U).data),K=M(this,ht,P2).call(this,F),q=M(this,ht,VT).call(this,K),Q=M(this,ht,GT).call(this,F,O,U,q);return this.processDrawnLines({lines:{curves:Q,width:O,height:U},pageWidth:o,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[l,c,h]=M(this,ht,L2).call(this,e),[f,g]=M(this,ht,k2).call(this,l,c,h,Math.hypot(c,h)*d(this,Ku).sigmaSFactor,d(this,Ku).sigmaR,d(this,Ku).kernelSize),y=M(this,ht,VT).call(this,g),b=M(this,ht,GT).call(this,f,c,h,y);return this.processDrawnLines({lines:{curves:b,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:l,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:g}=e,y=e.thickness??0,b=[],A=Math.min(t/f,n/g),w=A/t,C=A/n,N=[];for(const{points:P}of h){const k=l?M(this,ht,D2).call(this,P):P;if(!k)continue;N.push(k);const L=k.length,O=new Float32Array(L),U=new Float32Array(3*(L===2?2:L-2));if(b.push({line:U,points:O}),L===2){O[0]=k[0]*w,O[1]=k[1]*C,U.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[F,K,q,Q]=k;F*=w,K*=C,q*=w,Q*=C,O.set([F,K,q,Q],0),U.set([NaN,NaN,NaN,NaN,F,K],0);for(let Z=4;Z<L;Z+=2){const oe=O[Z]=k[Z]*w,ce=O[Z+1]=k[Z+1]*C;U.set(me.createBezierPoints(F,K,q,Q,oe,ce),(Z-2)*3),[F,K,q,Q]=[q,Q,oe,ce]}}if(b.length===0)return null;const I=c?new BT:new Py;return I.build(b,t,n,1,s,c?0:y,o),{outline:I,newCurves:N,areContours:c,thickness:y,width:f,height:g}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let l=1/0,c=-1/0,h=0;for(const k of e){h+=k.length;for(let L=2,O=k.length;L<O;L++){const U=k[L]-k[L-2];l=Math.min(l,U),c=Math.max(c,U)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const g=e.length,y=bv+lg*g,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=s,b[A++]=o,b[A++]=t?0:1,b[A++]=Math.max(0,Math.floor(n??0)),b[A++]=g,b[A++]=f.BYTES_PER_ELEMENT;for(const k of e)b[A++]=k.length-2,b[A++]=k[0],b[A++]=k[1];const w=new CompressionStream("deflate-raw"),C=w.writable.getWriter();await C.ready,C.write(b);const N=f.prototype.constructor;for(const k of e){const L=new N(k.length-2);for(let O=2,U=k.length;O<U;O++)L[O-2]=k[O]-k[O-2];C.write(L)}C.close();const I=await new Response(w.readable).arrayBuffer(),P=new Uint8Array(I);return Dk(P)}static async decompressSignature(e){try{const t=KV(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,c=0;for await(const k of n)l||(l=new Uint8Array(new Uint32Array(k.buffer,0,4)[0])),l.set(k,c),c+=k.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],y=h[3],b=h[4]===0,A=h[5],w=h[6],C=h[7],N=[],I=(bv+lg*w)*Uint32Array.BYTES_PER_ELEMENT;let P;switch(C){case Int8Array.BYTES_PER_ELEMENT:P=new Int8Array(l.buffer,I);break;case Int16Array.BYTES_PER_ELEMENT:P=new Int16Array(l.buffer,I);break;case Int32Array.BYTES_PER_ELEMENT:P=new Int32Array(l.buffer,I);break}c=0;for(let k=0;k<w;k++){const L=h[lg*k+bv],O=new Float32Array(L+2);N.push(O);for(let U=0;U<lg-1;U++)O[U]=h[lg*k+bv+U+1];for(let U=0;U<L;U++)O[U+2]=O[U]+P[c++]}return{areContours:b,thickness:A,outlines:N,width:g,height:y}}catch(t){return Fe(`decompressSignature: ${t}`),null}}}Ku=new WeakMap,ht=new WeakSet,HT=function(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s},hr=new WeakMap,N2=function(e,t,n,s,o,l,c){const h=M(this,ht,HT).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(-f+h-c+16)%8,y=d(this,hr)[2*g],b=d(this,hr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},M2=function(e,t,n,s,o,l,c){const h=M(this,ht,HT).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(f+h+c+16)%8,y=d(this,hr)[2*g],b=d(this,hr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},GT=function(e,t,n,s){const o=e.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=e[g]<=s?1:0;for(let g=1;g<n-1;g++)l[g*t]=l[g*t+t-1]=0;for(let g=0;g<t;g++)l[g]=l[t*n-1-g]=0;let c=1,h;const f=[];for(let g=1;g<n-1;g++){h=1;for(let y=1;y<t-1;y++){const b=g*t+y,A=l[b];if(A===0)continue;let w=g,C=y;if(A===1&&l[b-1]===0)c+=1,C-=1;else if(A>=1&&l[b+1]===0)c+=1,C+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const N=[y,g],I=C===y+1,P={isHole:I,points:N,id:c,parent:0};f.push(P);let k;for(const Z of f)if(Z.id===h){k=Z;break}k?k.isHole?P.parent=I?k.parent:h:P.parent=I?h:k.parent:P.parent=I?h:0;const L=M(this,ht,N2).call(this,l,t,g,y,w,C,0);if(L===-1){l[b]=-c,l[b]!==1&&(h=Math.abs(l[b]));continue}let O=d(this,hr)[2*L],U=d(this,hr)[2*L+1];const F=g+O,K=y+U;w=F,C=K;let q=g,Q=y;for(;;){const Z=M(this,ht,M2).call(this,l,t,q,Q,w,C,1);O=d(this,hr)[2*Z],U=d(this,hr)[2*Z+1];const oe=q+O,ce=Q+U;N.push(ce,oe);const ue=q*t+Q;if(l[ue+1]===0?l[ue]=-c:l[ue]===1&&(l[ue]=c),oe===g&&ce===y&&q===F&&Q===K){l[b]!==1&&(h=Math.abs(l[b]));break}else w=q,C=Q,q=oe,Q=ce}}}return f},Kv=function(e,t,n,s){if(n-t<=4){for(let F=t;F<n-2;F+=2)s.push(e[F],e[F+1]);return}const o=e[t],l=e[t+1],c=e[n-4]-o,h=e[n-3]-l,f=Math.hypot(c,h),g=c/f,y=h/f,b=g*l-y*o,A=h/c,w=1/f,C=Math.atan(A),N=Math.cos(C),I=Math.sin(C),P=w*(Math.abs(N)+Math.abs(I)),k=w*(1-P+P**2),L=Math.max(Math.atan(Math.abs(I+N)*k),Math.atan(Math.abs(I-N)*k));let O=0,U=t;for(let F=t+2;F<n-2;F+=2){const K=Math.abs(b-g*e[F+1]+y*e[F]);K>O&&(U=F,O=K)}O>(f*L)**2?(M(this,ht,Kv).call(this,e,t,U+2,s),M(this,ht,Kv).call(this,e,U,n,s)):s.push(o,l)},D2=function(e){const t=[],n=e.length;return M(this,ht,Kv).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},k2=function(e,t,n,s,o,l){const c=new Float32Array(l**2),h=-2*s**2,f=l>>1;for(let C=0;C<l;C++){const N=(C-f)**2;for(let I=0;I<l;I++)c[C*l+I]=Math.exp((N+(I-f)**2)/h)}const g=new Float32Array(256),y=-2*o**2;for(let C=0;C<256;C++)g[C]=Math.exp(C**2/y);const b=e.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let C=0;C<n;C++)for(let N=0;N<t;N++){const I=C*t+N,P=e[I];let k=0,L=0;for(let U=0;U<l;U++){const F=C+U-f;if(!(F<0||F>=n))for(let K=0;K<l;K++){const q=N+K-f;if(q<0||q>=t)continue;const Q=e[F*t+q],Z=c[U*l+K]*g[Math.abs(Q-P)];k+=Q*Z,L+=Z}}const O=A[I]=Math.round(k/L);w[O]++}return[A,w]},P2=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},zT=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const l=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*l;return n},VT=function(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let l=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-l>s&&(s=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t},L2=function(e){const t=e,{width:n,height:s}=e,{maxDim:o}=d(this,Ku);let l=n,c=s;if(n>o||s>o){let b=n,A=s,w=Math.log2(Math.max(n,s)/o);const C=Math.floor(w);w=w===C?C-1:C;for(let I=0;I<w;I++){l=Math.ceil(b/2),c=Math.ceil(A/2);const P=new OffscreenCanvas(l,c);P.getContext("2d").drawImage(e,0,0,b,A,0,0,l,c),b=l,A=c,e!==t&&e.close(),e=P.transferToImageBitmap()}const N=Math.min(o/l,o/c);l=Math.round(l*N),c=Math.round(c*N)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,l,c);const g=f.getImageData(0,0,l,c).data;return[M(this,ht,zT).call(this,g),l,c]},R(to,ht),R(to,Ku,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),R(to,hr,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class Hw extends T2{constructor(){super(),super.updateProperties({fill:Lt._defaultLineColor,"stroke-width":0})}clone(){const e=new Hw;return e.updateAll(this),e}}class Gw extends u_{constructor(e){super(e),super.updateProperties({stroke:Lt._defaultLineColor,"stroke-width":1})}clone(){const e=new Gw(this._viewParameters);return e.updateAll(this),e}}var Kl,Qr,Jl,Ju;const Wi=class Wi extends Sb{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});R(this,Kl,!1);R(this,Qr,null);R(this,Jl,null);R(this,Ju,null);this._willKeepAspectRatio=!0,E(this,Jl,t.signatureData||null),E(this,Qr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Lt.initialize(t,n),this._defaultDrawingOptions=new Hw,this._defaultDrawnSignatureOptions=new Gw(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ve(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!d(this,Qr)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(d(this,Jl)){const{lines:o,mustSmooth:l,areContours:c,description:h,uuid:f,heightInPage:g}=d(this,Jl),{rawDims:{pageWidth:y,pageHeight:b},rotation:A}=this.parent.viewport,w=to.processDrawnLines({lines:o,pageWidth:y,pageHeight:b,rotation:A,innerMargin:Wi._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(w,g,h,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:d(this,Qr)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){E(this,Ju,t),this.addEditToolbar()}getUuid(){return d(this,Ju)}get description(){return d(this,Qr)}set description(t){E(this,Qr,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:s,width:o,height:l}=d(this,Jl),c=Math.max(o,l),h=to.processDrawnLines({lines:{curves:t.map(f=>({points:f})),thickness:s,width:o,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,s,o){const{x:l,y:c}=this,{outline:h}=E(this,Jl,t);E(this,Kl,h instanceof BT),this.description=s;let f;d(this,Kl)?f=Wi.getDefaultDrawingOptions():(f=Wi._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:f});const[,g]=this.pageDimensions;let y=n/g;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(o),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!o,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return to.process(t,n,s,o,Wi._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:s,pageHeight:o},rotation:l}=this.parent.viewport;return to.extractContoursFromText(t,n,s,o,l,Wi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return to.processDrawnLines({lines:t,pageWidth:n,pageHeight:s,rotation:o,innerMargin:Wi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=Wi.getDefaultDrawingOptions():(this._drawingOptions=Wi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:d(this,Kl),color:[0,0,0],thickness:d(this,Kl)?0:o});return this.addComment(l),t?(l.paths={lines:n,points:s},l.uuid=d(this,Ju),l.isCopy=!0):l.lines=n,d(this,Qr)&&(l.accessibilityData={type:"Figure",alt:d(this,Qr)}),l}static deserializeDraw(t,n,s,o,l,c){return c.areContours?BT.deserialize(t,n,s,o,l,c):Py.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){var l;const o=await super.deserialize(t,n,s);return E(o,Kl,t.areContours),o.description=((l=t.accessibilityData)==null?void 0:l.alt)||"",E(o,Ju,t.uuid),o}};Kl=new WeakMap,Qr=new WeakMap,Jl=new WeakMap,Ju=new WeakMap,le(Wi,"_type","signature"),le(Wi,"_editorType",Ue.SIGNATURE),le(Wi,"_defaultDrawingOptions",null);let qT=Wi;var Vt,Nn,jl,ca,Ql,$f,ua,ju,Zr,ds,Yf,rt,Ig,Ng,Jv,jv,Qv,YT,Zv,O2;class $T extends Lt{constructor(t){super({...t,name:"stampEditor"});R(this,rt);R(this,Vt,null);R(this,Nn,null);R(this,jl,null);R(this,ca,null);R(this,Ql,null);R(this,$f,"");R(this,ua,null);R(this,ju,!1);R(this,Zr,null);R(this,ds,!1);R(this,Yf,!1);E(this,ca,t.bitmapUrl),E(this,Ql,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Lt.initialize(t,n)}static isHandlingMimeForPasting(t){return fb.includes(t)}static paste(t,n){n.pasteEditor({mode:Ue.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:o,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,h=await s.guess({name:"altText",request:{data:o,width:l,height:c,channels:o.length/(l*c)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const f=h.output;return await this.setGuessedAltText(f),n&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var t;d(this,Nn)&&(E(this,Vt,null),this._uiManager.imageManager.deleteId(d(this,Nn)),(t=d(this,ua))==null||t.remove(),E(this,ua,null),d(this,Zr)&&(clearTimeout(d(this,Zr)),E(this,Zr,null))),super.remove()}rebuild(){if(!this.parent){d(this,Nn)&&M(this,rt,Jv).call(this);return}super.rebuild(),this.div!==null&&(d(this,Nn)&&d(this,ua)===null&&M(this,rt,Jv).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(d(this,jl)||d(this,Vt)||d(this,ca)||d(this,Ql)||d(this,Nn)||d(this,ju))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),d(this,ju)||(d(this,Vt)?M(this,rt,jv).call(this):M(this,rt,Jv).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:s,bitmap:o}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(E(this,Nn,s),o&&E(this,Vt,o),E(this,ju,!1),M(this,rt,jv).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;d(this,Zr)!==null&&clearTimeout(d(this,Zr)),E(this,Zr,setTimeout(()=>{E(this,Zr,null),M(this,rt,YT).call(this)},200))}copyCanvas(t,n,s=!1){t||(t=224);const{width:o,height:l}=d(this,Vt),c=new _r;let h=d(this,Vt),f=o,g=l,y=null;if(n){if(o>n||l>n){const F=Math.min(n/o,n/l);f=Math.floor(o*F),g=Math.floor(l*F)}y=document.createElement("canvas");const A=y.width=Math.ceil(f*c.sx),w=y.height=Math.ceil(g*c.sy);d(this,ds)||(h=M(this,rt,Qv).call(this,A,w));const C=y.getContext("2d");C.filter=this._uiManager.hcmFilter;let N="white",I="#cfcfd8";this._uiManager.hcmFilter!=="none"?I="black":QV.isDarkMode&&(N="#8f8f9d",I="#42414d");const P=15,k=P*c.sx,L=P*c.sy,O=new OffscreenCanvas(k*2,L*2),U=O.getContext("2d");U.fillStyle=N,U.fillRect(0,0,k*2,L*2),U.fillStyle=I,U.fillRect(0,0,k,L),U.fillRect(k,L,k,L),C.fillStyle=C.createPattern(O,"repeat"),C.fillRect(0,0,A,w),C.drawImage(h,0,0,h.width,h.height,0,0,A,w)}let b=null;if(s){let A,w;if(c.symmetric&&h.width<t&&h.height<t)A=h.width,w=h.height;else if(h=d(this,Vt),o>t||l>t){const I=Math.min(t/o,t/l);A=Math.floor(o*I),w=Math.floor(l*I),d(this,ds)||(h=M(this,rt,Qv).call(this,A,w))}const N=new OffscreenCanvas(A,w).getContext("2d",{willReadFrequently:!0});N.drawImage(h,0,0,h.width,h.height,0,0,A,w),b={width:A,height:w,data:N.getImageData(0,0,A,w).data}}return{canvas:y,width:f,height:g,imageData:b}}static async deserialize(t,n,s){var N;let o=null,l=!1;if(t instanceof QP){const{data:{rect:I,rotation:P,id:k,structParent:L,popupRef:O,richText:U,contentsObj:F,creationDate:K,modificationDate:q},container:Q,parent:{page:{pageNumber:Z}},canvas:oe}=t;let ce,ue;oe?(delete t.canvas,{id:ce,bitmap:ue}=s.imageManager.getFromCanvas(Q.id,oe),oe.remove()):(l=!0,t._hasNoCanvas=!0);const pe=((N=await n._structTree.getAriaAttributes(`${Rw}${k}`))==null?void 0:N.get("aria-label"))||"";o=t={annotationType:Ue.STAMP,bitmapId:ce,bitmap:ue,pageIndex:Z-1,rect:I.slice(0),rotation:P,annotationElementId:k,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:pe},isSvg:!1,structParent:L,popupRef:O,richText:U,comment:(F==null?void 0:F.str)||null,creationDate:K,modificationDate:q}}const c=await super.deserialize(t,n,s),{rect:h,bitmap:f,bitmapUrl:g,bitmapId:y,isSvg:b,accessibilityData:A}=t;l?(s.addMissingCanvas(t.id,c),E(c,ju,!0)):y&&s.imageManager.isValidId(y)?(E(c,Nn,y),f&&E(c,Vt,f)):E(c,ca,g),E(c,ds,b);const[w,C]=c.pageDimensions;return c.width=(h[2]-h[0])/w,c.height=(h[3]-h[1])/C,A&&(c.altTextData=A),c._initialData=o,t.comment&&c.setCommentData(t),E(c,Yf,!!o),c}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:d(this,Nn),isSvg:d(this,ds)});if(this.addComment(s),t)return s.bitmapUrl=M(this,rt,Zv).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:o,altText:l}=this.serializeAltText(!1);if(!o&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=M(this,rt,O2).call(this,s);return h.isSame?null:(h.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(n===null)return s;n.stamps||(n.stamps=new Map);const c=d(this,ds)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!n.stamps.has(d(this,Nn)))n.stamps.set(d(this,Nn),{area:c,serialized:s}),s.bitmap=M(this,rt,Zv).call(this,!1);else if(d(this,ds)){const h=n.stamps.get(d(this,Nn));c>h.area&&(h.area=c,h.serialized.bitmap.close(),h.serialized.bitmap=M(this,rt,Zv).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Vt=new WeakMap,Nn=new WeakMap,jl=new WeakMap,ca=new WeakMap,Ql=new WeakMap,$f=new WeakMap,ua=new WeakMap,ju=new WeakMap,Zr=new WeakMap,ds=new WeakMap,Yf=new WeakMap,rt=new WeakSet,Ig=function(t,n=!1){if(!t){this.remove();return}E(this,Vt,t.bitmap),n||(E(this,Nn,t.id),E(this,ds,t.isSvg)),t.file&&E(this,$f,t.file.name),M(this,rt,jv).call(this)},Ng=function(){if(E(this,jl,null),this._uiManager.enableWaiting(!1),!!d(this,ua)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Vt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Vt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Jv=function(){if(d(this,Nn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(d(this,Nn)).then(s=>M(this,rt,Ig).call(this,s,!0)).finally(()=>M(this,rt,Ng).call(this));return}if(d(this,ca)){const s=d(this,ca);E(this,ca,null),this._uiManager.enableWaiting(!0),E(this,jl,this._uiManager.imageManager.getFromUrl(s).then(o=>M(this,rt,Ig).call(this,o)).finally(()=>M(this,rt,Ng).call(this)));return}if(d(this,Ql)){const s=d(this,Ql);E(this,Ql,null),this._uiManager.enableWaiting(!0),E(this,jl,this._uiManager.imageManager.getFromFile(s).then(o=>M(this,rt,Ig).call(this,o)).finally(()=>M(this,rt,Ng).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=fb.join(",");const n=this._uiManager._signal;E(this,jl,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,rt,Ig).call(this,o)}s()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:n})}).finally(()=>M(this,rt,Ng).call(this))),t.click()},jv=function(){var f;const{div:t}=this;let{width:n,height:s}=d(this,Vt);const[o,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*o,s=this.height*l;else if(n>c*o||s>c*l){const g=Math.min(c*o/n,c*l/s);n*=g,s*=g}this._uiManager.enableWaiting(!1);const h=E(this,ua,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/o,this.height=s/l,this.setDims(),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),M(this,rt,YT).call(this),d(this,Yf)||(this.parent.addUndoableEditor(this),E(this,Yf,!0)),this._reportTelemetry({action:"inserted_image"}),d(this,$f)&&this.div.setAttribute("aria-description",d(this,$f)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Qv=function(t,n){const{width:s,height:o}=d(this,Vt);let l=s,c=o,h=d(this,Vt);for(;l>2*t||c>2*n;){const f=l,g=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const y=new OffscreenCanvas(l,c);y.getContext("2d").drawImage(h,0,0,f,g,0,0,l,c),h=y.transferToImageBitmap()}return h},YT=function(){const[t,n]=this.parentDimensions,{width:s,height:o}=this,l=new _r,c=Math.ceil(s*t*l.sx),h=Math.ceil(o*n*l.sy),f=d(this,ua);if(!f||f.width===c&&f.height===h)return;f.width=c,f.height=h;const g=d(this,ds)?d(this,Vt):M(this,rt,Qv).call(this,c,h),y=f.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(g,0,0,g.width,g.height,0,0,c,h)},Zv=function(t){if(t){if(d(this,ds)){const o=this._uiManager.imageManager.getSvgUrl(d(this,Nn));if(o)return o}const n=document.createElement("canvas");return{width:n.width,height:n.height}=d(this,Vt),n.getContext("2d").drawImage(d(this,Vt),0,0),n.toDataURL()}if(d(this,ds)){const[n,s]=this.pageDimensions,o=Math.round(this.width*n*Ea.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Ea.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(o,l);return c.getContext("2d").drawImage(d(this,Vt),0,0,d(this,Vt).width,d(this,Vt).height,0,0,o,l),c.transferToImageBitmap()}return structuredClone(d(this,Vt))},O2=function(t){var c;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,o=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&o&&l,isSameAltText:l}},le($T,"_type","stamp"),le($T,"_editorType",Ue.STAMP);var Qu,Xf,Zl,ec,da,Pi,tc,Wf,Kf,fr,ha,Mn,fa,nc,Jf,Ce,ic,Dt,XT,U2,Nr,WT,KT,eb;const nr=class nr{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:g}){R(this,Dt);R(this,Qu);R(this,Xf,!1);R(this,Zl,null);R(this,ec,null);R(this,da,null);R(this,Pi,new Map);R(this,tc,!1);R(this,Wf,!1);R(this,Kf,!1);R(this,fr,null);R(this,ha,null);R(this,Mn,null);R(this,fa,null);R(this,nc,null);R(this,Jf,-1);R(this,Ce);const y=[...d(nr,ic).values()];if(!nr._initialized){nr._initialized=!0;for(const b of y)b.initialize(g,e)}e.registerEditorTypes(y),E(this,Ce,e),this.pageIndex=t,this.div=n,E(this,Qu,o),E(this,Zl,l),this.viewport=f,E(this,Mn,h),this.drawLayer=c,this._structTree=s,d(this,Ce).addLayer(this)}get isEmpty(){return d(this,Pi).size===0}get isInvisible(){return this.isEmpty&&d(this,Ce).getMode()===Ue.NONE}updateToolbar(e){d(this,Ce).updateToolbar(e)}updateMode(e=d(this,Ce).getMode()){switch(M(this,Dt,eb).call(this),e){case Ue.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ue.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ue.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ue.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of d(nr,ic).values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=d(this,Mn))==null?void 0:t.div)}setEditingState(e){d(this,Ce).setEditingState(e)}addCommands(e){d(this,Ce).addCommands(e)}cleanUndoStack(e){d(this,Ce).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=d(this,Zl))==null||t.div.classList.toggle("disabled",!e)}async enable(){var n;E(this,Kf,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=d(this,nc))==null||n.abort(),E(this,nc,null);const e=new Set;for(const s of d(this,Dt,XT))s.enableEditing(),s.show(!0),s.annotationElementId&&(d(this,Ce).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=d(this,Zl);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),d(this,Ce).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const o=await this.deserialize(s);o&&(this.addOrRebuild(o),o.enableEditing())}E(this,Kf,!1),d(this,Ce)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var n;if(E(this,Wf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),d(this,Mn)&&!d(this,nc)){E(this,nc,new AbortController);const s=d(this,Ce).combinedSignal(d(this,nc));d(this,Mn).div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,g=d(this,Jf);if(f-g>500){E(this,Jf,f);return}E(this,Jf,-1);const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(c,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${Fg}[0-9]+$`);for(const N of b)if(w.test(N.id)){A=N.id;break}if(!A)return;const C=d(this,Pi).get(A);(C==null?void 0:C.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),C.dblclick(o))},{signal:s,capture:!0})}const e=d(this,Zl);if(e){const s=new Map,o=new Map;for(const c of d(this,Dt,XT)){if(c.disableEditing(),!c.annotationElementId){c.updateFakeAnnotationElement(e);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);(n=this.getEditableAnnotation(c.annotationElementId))==null||n.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(d(this,Ce).isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=s.get(h),f&&(d(this,Ce).addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}M(this,Dt,eb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const s of d(nr,ic).values())t.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),E(this,Wf,!1)}getEditableAnnotation(e){var t;return((t=d(this,Zl))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){d(this,Ce).getActive()!==e&&d(this,Ce).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=d(this,Mn))!=null&&e.div&&!d(this,fa)){E(this,fa,new AbortController);const t=d(this,Ce).combinedSignal(d(this,fa));d(this,Mn).div.addEventListener("pointerdown",M(this,Dt,U2).bind(this),{signal:t}),d(this,Mn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=d(this,Mn))!=null&&e.div&&d(this,fa)&&(d(this,fa).abort(),E(this,fa,null),d(this,Mn).div.classList.remove("highlighting"))}enableClick(){if(d(this,ec))return;E(this,ec,new AbortController);const e=d(this,Ce).combinedSignal(d(this,ec));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=d(this,ec))==null||e.abort(),E(this,ec,null)}attach(e){d(this,Pi).set(e.id,e);const{annotationElementId:t}=e;t&&d(this,Ce).isDeletedAnnotationElement(t)&&d(this,Ce).removeDeletedAnnotationElement(e)}detach(e){var t;d(this,Pi).delete(e.id),(t=d(this,Qu))==null||t.removePointerInTextLayer(e.contentDiv),!d(this,Wf)&&e.annotationElementId&&d(this,Ce).addDeletedAnnotationElement(e)}remove(e){this.detach(e),d(this,Ce).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(d(this,Ce).addDeletedAnnotationElement(e.annotationElementId),Lt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),d(this,Ce).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!d(this,Kf)),d(this,Ce).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!d(this,da)&&(e._focusEventsAllowed=!1,E(this,da,setTimeout(()=>{E(this,da,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:d(this,Ce)._signal}),t.focus())},0))),e._structTreeParentId=(n=d(this,Qu))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of d(this,Pi).values())if(t.uid===e)return t;return null}getNextId(){return d(this,Ce).getId()}combinedSignal(e){return d(this,Ce).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=d(this,Dt,Nr))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await d(this,Ce).updateMode(e.mode);const{offsetX:n,offsetY:s}=M(this,Dt,KT).call(this),o=this.getNextId(),l=M(this,Dt,WT).call(this,{parent:this,id:o,x:n,y:s,uiManager:d(this,Ce),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=d(nr,ic).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,d(this,Ce)))||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=M(this,Dt,WT).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:d(this,Ce),isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(M(this,Dt,KT).call(this),!0,e)}setSelected(e){d(this,Ce).setSelected(e)}toggleSelected(e){d(this,Ce).toggleSelected(e)}unselect(e){d(this,Ce).unselect(e)}pointerup(e){var s;const{isMac:t}=Dn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!d(this,tc)||(E(this,tc,!1),(s=d(this,Dt,Nr))!=null&&s.isDrawer&&d(this,Dt,Nr).supportMultipleDrawings))return;if(!d(this,Xf)){E(this,Xf,!0);return}const n=d(this,Ce).getMode();if(n===Ue.STAMP||n===Ue.SIGNATURE){d(this,Ce).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(d(this,Ce).getMode()===Ue.HIGHLIGHT&&this.enableTextSelection(),d(this,tc)){E(this,tc,!1);return}const{isMac:t}=Dn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(E(this,tc,!0),(s=d(this,Dt,Nr))!=null&&s.isDrawer){this.startDrawingSession(e);return}const n=d(this,Ce).getActive();E(this,Xf,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),d(this,fr)){d(this,Dt,Nr).startDrawing(this,d(this,Ce),!1,e);return}d(this,Ce).setCurrentDrawingSession(this),E(this,fr,new AbortController);const t=d(this,Ce).combinedSignal(d(this,fr));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(E(this,ha,null),this.commitOrRemove())},{signal:t}),d(this,Dt,Nr).startDrawing(this,d(this,Ce),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&E(this,ha,t);return}d(this,ha)&&setTimeout(()=>{var t;(t=d(this,ha))==null||t.focus(),E(this,ha,null)},0)}endDrawingSession(e=!1){return d(this,fr)?(d(this,Ce).setCurrentDrawingSession(null),d(this,fr).abort(),E(this,fr,null),E(this,ha,null),d(this,Dt,Nr).endDrawing(e)):null}findNewParent(e,t,n){const s=d(this,Ce).findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return d(this,fr)?(this.endDrawingSession(),!0):!1}onScaleChanging(){d(this,fr)&&d(this,Dt,Nr).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=d(this,Ce).getActive())==null?void 0:e.parent)===this&&(d(this,Ce).commitOrRemove(),d(this,Ce).setActiveEditor(null)),d(this,da)&&(clearTimeout(d(this,da)),E(this,da,null));for(const n of d(this,Pi).values())(t=d(this,Qu))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,d(this,Pi).clear(),d(this,Ce).removeLayer(this)}render({viewport:e}){this.viewport=e,ac(this.div,e);for(const t of d(this,Ce).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){d(this,Ce).commitOrRemove(),M(this,Dt,eb).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,ac(this.div,{rotation:n}),t!==n)for(const s of d(this,Pi).values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return d(this,Ce).viewParameters.realScale}};Qu=new WeakMap,Xf=new WeakMap,Zl=new WeakMap,ec=new WeakMap,da=new WeakMap,Pi=new WeakMap,tc=new WeakMap,Wf=new WeakMap,Kf=new WeakMap,fr=new WeakMap,ha=new WeakMap,Mn=new WeakMap,fa=new WeakMap,nc=new WeakMap,Jf=new WeakMap,Ce=new WeakMap,ic=new WeakMap,Dt=new WeakSet,XT=function(){return d(this,Pi).size!==0?d(this,Pi).values():d(this,Ce).getEditors(this.pageIndex)},U2=function(e){d(this,Ce).unselectAll();const{target:t}=e;if(t===d(this,Mn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&d(this,Mn).div.contains(t)){const{isMac:n}=Dn.platform;if(e.button!==0||e.ctrlKey&&n)return;d(this,Ce).showAllEditors("highlight",!0,!0),d(this,Mn).div.classList.add("free"),this.toggleDrawing(),_b.startHighlighting(this,d(this,Ce).direction==="ltr",{target:d(this,Mn).div,x:e.x,y:e.y}),d(this,Mn).div.addEventListener("pointerup",()=>{d(this,Mn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:d(this,Ce)._signal}),e.preventDefault()}},Nr=function(){return d(nr,ic).get(d(this,Ce).getMode())},WT=function(e){const t=d(this,Dt,Nr);return t?new t.prototype.constructor(e):null},KT=function(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,g=(l+h)/2-t,[y,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:y,offsetY:b}},eb=function(){for(const e of d(this,Pi).values())e.isEmpty()&&e.remove()},le(nr,"_initialized",!1),R(nr,ic,new Map([RT,FT,$T,_b,qT].map(e=>[e._editorType,e])));let Ab=nr;var pr,di,Zu,xy,jb,F2,oo,JT,B2,jT;const vn=class vn{constructor({pageIndex:e}){R(this,oo);R(this,pr,null);R(this,di,new Map);R(this,Zu,new Map);this.pageIndex=e}setParent(e){if(!d(this,pr)){E(this,pr,e);return}if(d(this,pr)!==e){if(d(this,di).size>0)for(const t of d(this,di).values())t.remove(),e.append(t);E(this,pr,e)}}static get _svgFactory(){return Ve(this,"_svgFactory",new $g)}draw(e,t=!1,n=!1){const s=yn(vn,xy)._++,o=M(this,oo,JT).call(this),l=vn._svgFactory.createElement("defs");o.append(l);const c=vn._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&d(this,Zu).set(s,c);const f=n?M(this,oo,B2).call(this,l,h):null,g=vn._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(o,e),d(this,di).set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=yn(vn,xy)._++,s=M(this,oo,JT).call(this),o=vn._svgFactory.createElement("defs");s.append(o);const l=vn._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const y=vn._svgFactory.createElement("mask");o.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=vn._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=vn._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${c}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=vn._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,e),d(this,di).set(n,s),n}finalizeDraw(e,t){d(this,Zu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var h;if(!t)return;const{root:n,bbox:s,rootClass:o,path:l}=t,c=typeof e=="number"?d(this,di).get(e):e;if(c){if(n&&M(this,oo,jT).call(this,c,n),s&&M(h=vn,jb,F2).call(h,c,s),o){const{classList:f}=c;for(const[g,y]of Object.entries(o))f.toggle(g,y)}if(l){const g=c.firstChild.firstChild;M(this,oo,jT).call(this,g,l)}}}updateParent(e,t){if(t===this)return;const n=d(this,di).get(e);n&&(d(t,pr).append(n),d(this,di).delete(e),d(t,di).set(e,n))}remove(e){d(this,Zu).delete(e),d(this,pr)!==null&&(d(this,di).get(e).remove(),d(this,di).delete(e))}destroy(){E(this,pr,null);for(const e of d(this,di).values())e.remove();d(this,di).clear(),d(this,Zu).clear()}};pr=new WeakMap,di=new WeakMap,Zu=new WeakMap,xy=new WeakMap,jb=new WeakSet,F2=function(e,[t,n,s,o]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*o}%`},oo=new WeakSet,JT=function(){const e=vn._svgFactory.create(1,1,!0);return d(this,pr).append(e),e.setAttribute("aria-hidden",!0),e},B2=function(e,t){const n=vn._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=vn._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s},jT=function(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)},R(vn,jb),R(vn,xy,0);let Eb=vn;globalThis._pdfjsTestingUtils={HighlightOutliner:NT};globalThis.pdfjsLib={AbortException:Aa,AnnotationEditorLayer:Ab,AnnotationEditorParamsType:tt,AnnotationEditorType:Ue,AnnotationEditorUIManager:lc,AnnotationLayer:Bw,AnnotationMode:eo,AnnotationType:on,applyOpacity:Uk,build:HP,ColorPicker:qg,createValidAbsoluteUrl:ww,CSSConstants:Ok,DOMSVGFactory:$g,DrawLayer:Eb,FeatureTest:Dn,fetchData:sp,findContrastColor:Fk,getDocument:Pw,getFilenameFromUrl:kk,getPdfFilenameFromUrl:Pk,getRGB:rp,getUuid:xw,getXfaPageViewport:Lk,GlobalWorkerOptions:Ys,ImageKind:Pg,InvalidPDFException:hb,isDataScheme:My,isPdfFile:l_,isValidExplicitDest:yP,MathClamp:ii,noContextMenu:vs,normalizeUnicode:Mk,OPS:jf,OutputScale:_r,PasswordResponses:Ik,PDFDataRangeTransport:Lw,PDFDateString:Gg,PDFWorker:Qf,PermissionFlag:Rk,PixelsPerInch:Ea,RenderingCancelledException:a_,renderRichText:Nw,ResponseException:Bg,setLayerDimensions:ac,shadow:Ve,SignatureExtractor:to,stopEvent:Xt,SupportedImageMimeTypes:fb,TextLayer:Vg,TouchManager:zg,updateUrlHash:Cw,Util:ye,VerbosityLevel:Ry,version:Ow,XfaLayer:Iw};const w8=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Aa,AnnotationEditorLayer:Ab,AnnotationEditorParamsType:tt,AnnotationEditorType:Ue,AnnotationEditorUIManager:lc,AnnotationLayer:Bw,AnnotationMode:eo,AnnotationType:on,CSSConstants:Ok,ColorPicker:qg,DOMSVGFactory:$g,DrawLayer:Eb,FeatureTest:Dn,GlobalWorkerOptions:Ys,ImageKind:Pg,InvalidPDFException:hb,MathClamp:ii,OPS:jf,OutputScale:_r,PDFDataRangeTransport:Lw,PDFDateString:Gg,PDFWorker:Qf,PasswordResponses:Ik,PermissionFlag:Rk,PixelsPerInch:Ea,RenderingCancelledException:a_,ResponseException:Bg,SignatureExtractor:to,SupportedImageMimeTypes:fb,TextLayer:Vg,TouchManager:zg,Util:ye,VerbosityLevel:Ry,XfaLayer:Iw,applyOpacity:Uk,build:HP,createValidAbsoluteUrl:ww,fetchData:sp,findContrastColor:Fk,getDocument:Pw,getFilenameFromUrl:kk,getPdfFilenameFromUrl:Pk,getRGB:rp,getUuid:xw,getXfaPageViewport:Lk,isDataScheme:My,isPdfFile:l_,isValidExplicitDest:yP,noContextMenu:vs,normalizeUnicode:Mk,renderRichText:Nw,setLayerDimensions:ac,shadow:Ve,stopEvent:Xt,updateUrlHash:Cw,version:Ow},Symbol.toStringTag,{value:"Module"}));function H2(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var s=i.length;for(e=0;e<s;e++)i[e]&&(t=H2(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function d_(){for(var i,e,t=0,n="",s=arguments.length;t<s;t++)(i=arguments[t])&&(e=H2(i))&&(n&&(n+=" "),n+=e);return n}var NM=Object.prototype.hasOwnProperty;function MM(i,e,t){for(t of i.keys())if(vh(t,e))return t}function vh(i,e){var t,n,s;if(i===e)return!0;if(i&&e&&(t=i.constructor)===e.constructor){if(t===Date)return i.getTime()===e.getTime();if(t===RegExp)return i.toString()===e.toString();if(t===Array){if((n=i.length)===e.length)for(;n--&&vh(i[n],e[n]););return n===-1}if(t===Set){if(i.size!==e.size)return!1;for(n of i)if(s=n,s&&typeof s=="object"&&(s=MM(e,s),!s)||!e.has(s))return!1;return!0}if(t===Map){if(i.size!==e.size)return!1;for(n of i)if(s=n[0],s&&typeof s=="object"&&(s=MM(e,s),!s)||!vh(n[1],e.get(s)))return!1;return!0}if(t===ArrayBuffer)i=new Uint8Array(i),e=new Uint8Array(e);else if(t===DataView){if((n=i.byteLength)===e.byteLength)for(;n--&&i.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(i)){if((n=i.byteLength)===e.byteLength)for(;n--&&i[n]===e[n];);return n===-1}if(!t||typeof i=="object"){n=0;for(t in i)if(NM.call(i,t)&&++n&&!NM.call(e,t)||!(t in e)||!vh(i[t],e[t]))return!1;return Object.keys(e).length===n}}return i!==i&&e!==e}function Ly(i){let e=!1;return{promise:new Promise((n,s)=>{i.then(o=>!e&&n(o)).catch(o=>!e&&s(o))}),cancel(){e=!0}}}const C8=["onCopy","onCut","onPaste"],x8=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],R8=["onFocus","onBlur"],I8=["onInput","onInvalid","onReset","onSubmit"],N8=["onLoad","onError"],M8=["onKeyDown","onKeyPress","onKeyUp"],D8=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],k8=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],P8=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],L8=["onSelect"],O8=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],U8=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],F8=["onScroll"],B8=["onWheel"],H8=["onAnimationStart","onAnimationEnd","onAnimationIteration"],G8=["onTransitionEnd"],z8=["onToggle"],V8=["onChange"],q8=[...C8,...x8,...R8,...I8,...N8,...M8,...D8,...k8,...P8,...L8,...O8,...U8,...F8,...B8,...H8,...G8,...V8,...z8];function G2(i,e){const t={};for(const n of q8){const s=i[n];s&&(e?t[n]=(o=>s(o,e(n))):t[n]=s)}return t}var $8="Invariant failed";function Nt(i,e){if(!i)throw new Error($8)}var QA,DM;function Y8(){if(DM)return QA;DM=1;var i=function(){};return QA=i,QA}var X8=Y8();const si=dw(X8),z2=ee.createContext(null),W8="noopener noreferrer nofollow";class K8{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Nt(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Nt(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||W8,e.target=n?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Nt(this.pdfDocument),Nt(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Nt(Array.isArray(t));const n=t[0];new Promise(s=>{Nt(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(o=>{s(o)}).catch(()=>{Nt(!1)}):typeof n=="number"?s(n):Nt(!1)}).then(s=>{const o=s+1;Nt(this.pdfViewer),Nt(o>=1&&o<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:s,pageNumber:o})})})}goToPage(e){const t=e-1;Nt(this.pdfViewer),Nt(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function bh({children:i,type:e}){return T.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:i})}const kM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function J8(i,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return i}}function Zf(){return ee.useReducer(J8,{value:void 0,error:void 0})}const h_=typeof window<"u",V2=h_&&window.location.protocol==="file:";function j8(i){return typeof i<"u"}function Dc(i){return j8(i)&&i!==null}function Q8(i){return typeof i=="string"}function Z8(i){return i instanceof ArrayBuffer}function e$(i){return Nt(h_),i instanceof Blob}function QT(i){return Q8(i)&&/^data:/.test(i)}function PM(i){Nt(QT(i));const[e="",t=""]=i.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function t$(){return h_&&window.devicePixelRatio||1}const q2="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function LM(){si(!V2,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${q2}`)}function n$(){si(!V2,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${q2}`)}function td(i){i!=null&&i.cancel&&i.cancel()}function ZT(i,e){return Object.defineProperty(i,"width",{get(){return this.getViewport({scale:e}).width},configurable:!0}),Object.defineProperty(i,"height",{get(){return this.getViewport({scale:e}).height},configurable:!0}),Object.defineProperty(i,"originalWidth",{get(){return this.getViewport({scale:1}).width},configurable:!0}),Object.defineProperty(i,"originalHeight",{get(){return this.getViewport({scale:1}).height},configurable:!0}),i}function $2(i){return i.name==="AbortException"||i.name==="RenderingCancelledException"}function i$(i){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=s=>{if(!s.target)return t(new Error("Error while reading a file."));const{error:o}=s.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(i)})}const{PDFDataRangeTransport:s$}=w8,r$=(i,e)=>{switch(e){case kM.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");i(t);break}case kM.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");i(t);break}}};function OM(i){return typeof i=="object"&&i!==null&&("data"in i||"range"in i||"url"in i)}const o$=ee.forwardRef(function({children:e,className:t,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF",noData:g="No PDF file specified.",onItemClick:y,onLoadError:b,onLoadProgress:A,onLoadSuccess:w,onPassword:C=r$,onSourceError:N,onSourceSuccess:I,options:P,renderMode:k,rotate:L,scale:O,...U},F){const[K,q]=Zf(),{value:Q,error:Z}=K,[oe,ce]=Zf(),{value:ue,error:pe}=oe,G=ee.useRef(new K8),$=ee.useRef([]),ae=ee.useRef(void 0),Se=ee.useRef(void 0);l&&l!==ae.current&&OM(l)&&(si(!vh(l,ae.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),ae.current=l),P&&P!==Se.current&&(si(!vh(P,Se.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Se.current=P);const Ie=ee.useRef({scrollPageIntoView:ct=>{const{dest:We,pageNumber:pt,pageIndex:Kt=pt-1}=ct;if(y){y({dest:We,pageIndex:Kt,pageNumber:pt});return}const Bt=$.current[Kt];if(Bt){Bt.scrollIntoView();return}si(!1,`An internal link leading to page ${pt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});ee.useImperativeHandle(F,()=>({linkService:G,pages:$,viewer:Ie}),[]);function H(){I&&I()}function J(){Z&&(si(!1,Z.toString()),N&&N(Z))}function se(){q({type:"RESET"})}ee.useEffect(se,[l,q]);const de=ee.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return QT(l)?{data:PM(l)}:(LM(),{url:l});if(l instanceof s$)return{range:l};if(Z8(l))return{data:l};if(h_&&e$(l))return{data:await i$(l)};if(Nt(typeof l=="object"),Nt(OM(l)),"url"in l&&typeof l.url=="string"){if(QT(l.url)){const{url:ct,...We}=l;return{data:PM(ct),...We}}LM()}return l},[l]);ee.useEffect(()=>{const ct=Ly(de());return ct.promise.then(We=>{q({type:"RESOLVE",value:We})}).catch(We=>{q({type:"REJECT",error:We})}),()=>{td(ct)}},[de,q]),ee.useEffect(()=>{if(!(typeof Q>"u")){if(Q===!1){J();return}H()}},[Q]);function ve(){ue&&(w&&w(ue),$.current=new Array(ue.numPages),G.current.setDocument(ue))}function Re(){pe&&(si(!1,pe.toString()),b&&b(pe))}ee.useEffect(function(){ce({type:"RESET"})},[ce,Q]),ee.useEffect(function(){if(!Q)return;const We=P?{...Q,...P}:Q,pt=Pw(We);A&&(pt.onProgress=A),C&&(pt.onPassword=C);const Kt=pt;return Kt.promise.then(Bt=>{Kt.destroyed||ce({type:"RESOLVE",value:Bt})}).catch(Bt=>{Kt.destroyed||ce({type:"REJECT",error:Bt})}),()=>{Kt.destroy()}},[P,ce,Q]),ee.useEffect(()=>{if(!(typeof ue>"u")){if(ue===!1){Re();return}ve()}},[ue]),ee.useEffect(function(){G.current.setViewer(Ie.current),G.current.setExternalLinkRel(s),G.current.setExternalLinkTarget(o)},[s,o]);const Ae=ee.useCallback((ct,We)=>{$.current[ct]=We},[]),ft=ee.useCallback(ct=>{delete $.current[ct]},[]),Qe=ee.useMemo(()=>({imageResourcesPath:h,linkService:G.current,onItemClick:y,pdf:ue,registerPage:Ae,renderMode:k,rotate:L,scale:O,unregisterPage:ft}),[h,y,ue,Ae,k,L,O,ft]),qt=ee.useMemo(()=>G2(U,()=>ue),[U,ue]);function Xe(){function ct(pt){return!!(pt!=null&&pt.pdf)}if(!ct(Qe))throw new Error("pdf is undefined");const We=typeof e=="function"?e(Qe):e;return T.jsx(z2.Provider,{value:Qe,children:We})}function Pn(){return l?ue==null?T.jsx(bh,{type:"loading",children:typeof f=="function"?f():f}):ue===!1?T.jsx(bh,{type:"error",children:typeof n=="function"?n():n}):Xe():T.jsx(bh,{type:"no-data",children:typeof g=="function"?g():g})}return T.jsx("div",{className:d_("react-pdf__Document",t),ref:c,...qt,children:Pn()})});function Y2(){return ee.useContext(z2)}function X2(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=i.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(o){for(var l=0,c=t;l<c.length;l++){var h=c[l];typeof h=="function"?h(o):h&&(h.current=o)}}}const W2=ee.createContext(null);function f_(){return ee.useContext(W2)}function a$(){const i=Y2(),e=f_();Nt(e);const t={...i,...e},{filterAnnotations:n,imageResourcesPath:s,linkService:o,onGetAnnotationsError:l,onGetAnnotationsSuccess:c,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:f,page:g,pdf:y,renderForms:b,rotate:A,scale:w=1}=t;Nt(y),Nt(g),Nt(o);const[C,N]=Zf(),{value:I,error:P}=C,k=ee.useRef(null);si(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function L(){I&&c&&c(I)}function O(){P&&(si(!1,P.toString()),l&&l(P))}ee.useEffect(function(){N({type:"RESET"})},[N,g]),ee.useEffect(function(){if(!g)return;const Q=Ly(g.getAnnotations()),Z=Q;return Q.promise.then(oe=>{N({type:"RESOLVE",value:oe})}).catch(oe=>{N({type:"REJECT",error:oe})}),()=>{td(Z)}},[N,g]),ee.useEffect(()=>{if(I!==void 0){if(I===!1){O();return}L()}},[I]);function U(){f&&f()}function F(q){si(!1,`${q}`),h&&h(q)}const K=ee.useMemo(()=>g.getViewport({scale:w,rotation:A}),[g,A,w]);return ee.useEffect(function(){if(!y||!g||!o||!I)return;const{current:Q}=k;if(!Q)return;const Z=K.clone({dontFlip:!0}),oe={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:y.annotationStorage,commentManager:null,div:Q,l10n:null,linkService:o,page:g,structTreeLayer:null,viewport:Z},ce={annotations:n?n({annotations:I}):I,annotationStorage:y.annotationStorage,div:Q,imageResourcesPath:s,linkService:o,page:g,renderForms:b,viewport:Z};Q.innerHTML="";try{new Bw(oe).render(ce),U()}catch(ue){F(ue)}return()=>{}},[I,n,s,o,g,y,b,K]),T.jsx("div",{className:d_("react-pdf__Page__annotations","annotationLayer"),ref:k})}const K2={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},l$=/^H(\d+)$/;function c$(i){return i in K2}function p_(i){return"children"in i}function J2(i){return p_(i)?i.children.length===1&&0 in i.children&&"id"in i.children[0]:!1}function u$(i){const e={};if(p_(i)){const{role:t}=i,n=t.match(l$);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(c$(t)){const s=K2[t];s&&(e.role=s)}}return e}function j2(i){const e={};if(p_(i)){if(i.alt!==void 0&&(e["aria-label"]=i.alt),i.lang!==void 0&&(e.lang=i.lang),J2(i)){const[t]=i.children;if(t){const n=j2(t);return{...e,...n}}}}else"id"in i&&(e["aria-owns"]=i.id);return e}function d$(i){return i?{...u$(i),...j2(i)}:null}function Q2({className:i,node:e}){const t=ee.useMemo(()=>d$(e),[e]),n=ee.useMemo(()=>!p_(e)||J2(e)?null:e.children.map((s,o)=>T.jsx(Q2,{node:s},o)),[e]);return T.jsx("span",{className:i,...t,children:n})}function h$(){const i=f_();Nt(i);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=i,[n,s]=Zf(),{value:o,error:l}=n,{customTextRenderer:c,page:h}=i;function f(){o&&t&&t(o)}function g(){l&&(si(!1,l.toString()),e&&e(l))}return ee.useEffect(function(){s({type:"RESET"})},[s,h]),ee.useEffect(function(){if(c||!h)return;const b=Ly(h.getStructTree()),A=b;return b.promise.then(w=>{s({type:"RESOLVE",value:w})}).catch(w=>{s({type:"REJECT",error:w})}),()=>td(A)},[c,h,s]),ee.useEffect(()=>{if(o!==void 0){if(o===!1){g();return}f()}},[o]),o?T.jsx(Q2,{className:"react-pdf__Page__structTree structTree",node:o}):null}const UM=eo;function f$(i){const e=f_();Nt(e);const t={...e,...i},{_className:n,canvasBackground:s,devicePixelRatio:o=t$(),onRenderError:l,onRenderSuccess:c,page:h,renderForms:f,renderTextLayer:g,rotate:y,scale:b}=t,{canvasRef:A}=i;Nt(h);const w=ee.useRef(null);function C(){h&&c&&c(ZT(h,b))}function N(L){$2(L)||(si(!1,L.toString()),l&&l(L))}const I=ee.useMemo(()=>h.getViewport({scale:b*o,rotation:y}),[o,h,y,b]),P=ee.useMemo(()=>h.getViewport({scale:b,rotation:y}),[h,y,b]);ee.useEffect(function(){if(!h)return;h.cleanup();const{current:O}=w;if(!O)return;O.width=I.width,O.height=I.height,O.style.width=`${Math.floor(P.width)}px`,O.style.height=`${Math.floor(P.height)}px`,O.style.visibility="hidden";const U={annotationMode:f?UM.ENABLE_FORMS:UM.ENABLE,canvas:O,canvasContext:O.getContext("2d",{alpha:!1}),viewport:I};s&&(U.background=s);const F=h.render(U),K=F;return F.promise.then(()=>{O.style.visibility="",C()}).catch(N),()=>td(K)},[s,h,f,I,P]);const k=ee.useCallback(()=>{const{current:L}=w;L&&(L.width=0,L.height=0)},[]);return ee.useEffect(()=>k,[k]),T.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:X2(A,w),style:{display:"block",userSelect:"none"},children:g?T.jsx(h$,{}):null})}function p$(i){return"str"in i}function g$(){const i=f_();Nt(i);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:o,page:l,pageIndex:c,pageNumber:h,rotate:f,scale:g}=i;Nt(l);const[y,b]=Zf(),{value:A,error:w}=y,C=ee.useRef(null);si(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function N(){A&&n&&n(A)}function I(){w&&(si(!1,w.toString()),t&&t(w))}ee.useEffect(function(){b({type:"RESET"})},[l,b]),ee.useEffect(function(){if(!l)return;const K=Ly(l.getTextContent()),q=K;return K.promise.then(Q=>{b({type:"RESOLVE",value:Q})}).catch(Q=>{b({type:"REJECT",error:Q})}),()=>td(q)},[l,b]),ee.useEffect(()=>{if(A!==void 0){if(A===!1){I();return}N()}},[A]);const P=ee.useCallback(()=>{o&&o()},[o]),k=ee.useCallback(F=>{$2(F)||(si(!1,F.toString()),s&&s(F))},[s]);function L(){const F=C.current;F&&F.classList.add("selecting")}function O(){const F=C.current;F&&F.classList.remove("selecting")}const U=ee.useMemo(()=>l.getViewport({scale:g,rotation:f}),[l,f,g]);return ee.useLayoutEffect(function(){if(!l||!A)return;const{current:K}=C;if(!K)return;K.innerHTML="";const q=l.streamTextContent({includeMarkedContent:!0}),Q={container:K,textContentSource:q,viewport:U},Z=new Vg(Q),oe=Z;return Z.render().then(()=>{const ce=document.createElement("div");ce.className="endOfContent",K.append(ce);const ue=K.querySelectorAll('[role="presentation"]');if(e){let pe=0;A.items.forEach((G,$)=>{if(!p$(G))return;const ae=ue[pe];if(!ae)return;const Se=e({pageIndex:c,pageNumber:h,itemIndex:$,...G});ae.innerHTML=Se,pe+=G.str&&G.hasEOL?2:1})}P()}).catch(k),()=>td(oe)},[e,k,P,l,c,h,A,U]),T.jsx("div",{className:d_("react-pdf__Page__textContent","textLayer"),onMouseUp:O,onMouseDown:L,ref:C})}const FM=1;function m$(i){const t={...Y2(),...i},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:o,canvasRef:l,children:c,className:h,customRenderer:f,customTextRenderer:g,devicePixelRatio:y,error:b="Failed to load the page.",filterAnnotations:A,height:w,inputRef:C,loading:N="Loading page",noData:I="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:U,onGetTextSuccess:F,onLoadError:K,onLoadSuccess:q,onRenderAnnotationLayerError:Q,onRenderAnnotationLayerSuccess:Z,onRenderError:oe,onRenderSuccess:ce,onRenderTextLayerError:ue,onRenderTextLayerSuccess:pe,pageIndex:G,pageNumber:$,pdf:ae,registerPage:Se,renderAnnotationLayer:Ie=!0,renderForms:H=!1,renderMode:J="canvas",renderTextLayer:se=!0,rotate:de,scale:ve=FM,unregisterPage:Re,width:Ae,...ft}=t,[Qe,qt]=Zf(),{value:Xe,error:Pn}=Qe,ct=ee.useRef(null);Nt(ae);const We=Dc($)?$-1:G??null,pt=$??(Dc(G)?G+1:null),Kt=de??(Xe?Xe.rotate:null),Bt=ee.useMemo(()=>{if(!Xe)return null;let Fi=1;const Da=ve??FM;if(Ae||w){const js=Xe.getViewport({scale:1,rotation:Kt});Ae?Fi=Ae/js.width:w&&(Fi=w/js.height)}return Da*Fi},[w,Xe,Kt,ve,Ae]);ee.useEffect(function(){return()=>{Dc(We)&&s&&Re&&Re(We)}},[s,ae,We,Re]);function _s(){if(q){if(!Xe||!Bt)return;q(ZT(Xe,Bt))}if(s&&Se){if(!Dc(We)||!ct.current)return;Se(We,ct.current)}}function Oi(){Pn&&(si(!1,Pn.toString()),K&&K(Pn))}ee.useEffect(function(){qt({type:"RESET"})},[qt,ae,We]),ee.useEffect(function(){if(!ae||!pt)return;const Da=Ly(ae.getPage(pt)),js=Da;return Da.promise.then(lp=>{qt({type:"RESOLVE",value:lp})}).catch(lp=>{qt({type:"REJECT",error:lp})}),()=>td(js)},[qt,ae,pt]),ee.useEffect(()=>{if(Xe!==void 0){if(Xe===!1){Oi();return}_s()}},[Xe,Bt]);const Ss=ee.useMemo(()=>Dc(We)&&pt&&Dc(Kt)&&Dc(Bt)?{_className:n,canvasBackground:o,customTextRenderer:g,devicePixelRatio:y,filterAnnotations:A,onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:U,onGetTextSuccess:F,onRenderAnnotationLayerError:Q,onRenderAnnotationLayerSuccess:Z,onRenderError:oe,onRenderSuccess:ce,onRenderTextLayerError:ue,onRenderTextLayerSuccess:pe,page:Xe,pageIndex:We,pageNumber:pt,renderForms:H,renderTextLayer:se,rotate:Kt,scale:Bt}:null,[n,o,g,y,A,P,k,L,O,U,F,Q,Z,oe,ce,ue,pe,Xe,We,pt,H,se,Kt,Bt]),Te=ee.useMemo(()=>G2(ft,()=>Xe&&(Bt?ZT(Xe,Bt):void 0)),[ft,Xe,Bt]),ne=`${We}@${Bt}/${Kt}`;function xe(){switch(J){case"custom":return Nt(f),T.jsx(f,{},`${ne}_custom`);case"none":return null;case"canvas":default:return T.jsx(f$,{canvasRef:l},`${ne}_canvas`)}}function Ee(){return se?T.jsx(g$,{},`${ne}_text`):null}function An(){return Ie?T.jsx(a$,{},`${ne}_annotations`):null}function As(){function Fi(js){return!!(js!=null&&js.page)}if(!Fi(Ss))throw new Error("page is undefined");const Da=typeof c=="function"?c(Ss):c;return T.jsxs(W2.Provider,{value:Ss,children:[xe(),Ee(),An(),Da]})}function Ui(){return pt?ae===null||Xe===void 0||Xe===null?T.jsx(bh,{type:"loading",children:typeof N=="function"?N():N}):ae===!1||Xe===!1?T.jsx(bh,{type:"error",children:typeof b=="function"?b():b}):As():T.jsx(bh,{type:"no-data",children:typeof I=="function"?I():I})}return T.jsx("div",{className:d_(n,h),"data-page-number":pt,ref:X2(C,ct),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Bt}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:o||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...Te,children:Ui()})}n$();Ys.workerSrc="pdf.worker.mjs";Ys.workerSrc=`//unpkg.com/pdfjs-dist@${Ow}/build/pdf.worker.min.js`;const y$=({book:i,onClose:e,onReward:t,onUpdateBookData:n})=>{const[s,o]=ee.useState(!1),[l,c]=ee.useState(""),[h,f]=ee.useState(!0),[g,y]=ee.useState(i.isLocal?"complete":"selecting"),[b,A]=ee.useState(i.currentChapter||1),[w,C]=ee.useState(null),[N,I]=ee.useState(i.userHighlights||[]),[P,k]=ee.useState(i.userNotes||[]),[L,O]=ee.useState(null),[U,F]=ee.useState(!1),[K,q]=ee.useState(""),[Q,Z]=ee.useState([]),[oe,ce]=ee.useState(""),[ue,pe]=ee.useState(!1),[G,$]=ee.useState(null),[ae,Se]=ee.useState(null),[Ie,H]=ee.useState(1);function J({numPages:Te}){Se(Te)}ee.useEffect(()=>{n(i.id,{userNotes:P,userHighlights:N,lastReadDate:Date.now(),currentChapter:b})},[P,N,b]);const se=async Te=>{if(f(!0),i.isLocal&&i.fileUrl)f(!1);else{const ne=await OV(i.title,i.author,Te),xe=Ae(ne,N);c(xe),f(!1)}};ee.useEffect(()=>{i.isLocal?(y("complete"),f(!1)):i.content&&i.currentChapter&&(y("complete"),c(Ae(i.content,N)),f(!1))},[]);const de=Te=>{y(Te),se(Te==="preview"?1:b)},ve=()=>{const Te=b+1;A(Te),se(Te),window.scrollTo(0,0)},Re=()=>{if(b>1){const Te=b-1;A(Te),se(Te),window.scrollTo(0,0)}},Ae=(Te,ne)=>{let xe=Te;return ne.forEach(Ee=>{xe.includes(Ee.text)&&(xe=xe.replace(Ee.text,`<mark style="background-color: ${Ee.color}; color: black; border-radius: 2px; padding: 2px 0;">${Ee.text}</mark>`))}),xe},ft=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),o(!1)):(document.documentElement.requestFullscreen(),o(!0))},Qe=()=>{const Te=window.getSelection();if(Te&&Te.toString().length>0){const xe=Te.getRangeAt(0).getBoundingClientRect();if(L)return;C({text:Te.toString(),top:xe.top+window.scrollY,left:xe.left+xe.width/2+window.scrollX}),F(!1),$(null)}else U||C(null)},qt=Te=>{Te.preventDefault()},Xe=Te=>{var ne;if(w){const xe={id:Date.now().toString(),text:w.text,color:Te};I(Ee=>[...Ee,xe]),c(Ee=>Ee.replace(w.text,`<mark style="background-color: ${Te}; color: black; border-radius: 2px; padding: 2px 0;">${w.text}</mark>`)),C(null),window.getSelection&&((ne=window.getSelection())==null||ne.removeAllRanges())}},Pn=async()=>{if(!w)return;$({text:"Translating...",type:"translation"});const Te=w.text;C(null);const ne=await PV(Te);$({text:ne,type:"translation"})},ct=async()=>{if(!w)return;$({text:"Analyzing context...",type:"explanation"});const Te=w.text;C(null);const ne=await LV(Te,i.title);$({text:ne,type:"explanation"})},We=()=>{w&&(window.open(`https://www.google.com/search?q=${encodeURIComponent(w.text)}`,"_blank"),C(null))},pt=()=>{F(!0)},Kt=()=>{if(w&&K){const Te={id:Date.now().toString(),text:K,selectedText:w.text,createdAt:Date.now()};k(ne=>[...ne,Te]),q(""),F(!1),C(null),O("notes")}},Bt=async Te=>{if(Te.preventDefault(),!oe.trim())return;const ne=oe;ce(""),Z(Ee=>[...Ee,{role:"user",text:ne}]),pe(!0);const xe=await xk(i.title,ne,Q);Z(Ee=>[...Ee,{role:"model",text:xe}]),pe(!1)},_s=async Te=>{O("chat"),pe(!0);let ne="";Te==="summarize"?(Z(xe=>[...xe,{role:"user",text:"Summarize this book."}]),ne=await UV(i.title)):(Z(xe=>[...xe,{role:"user",text:"Where was I? Recap the context."}]),ne=await FV(i.title)),Z(xe=>[...xe,{role:"model",text:ne}]),pe(!1)},Oi=()=>{setShowFinishModal(!0)},Ss=()=>{setShowFinishModal(!1),n(i.id,{isFinished:!0}),setShowReward(!0),t&&t()};return g==="selecting"&&!i.isLocal?T.jsx("div",{className:"fixed inset-0 z-50 bg-[#F5F5F7] flex items-center justify-center p-4",children:T.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-[2rem] p-8 shadow-2xl animate-spring",children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx(oB,{size:48,className:"mx-auto text-blue-500 mb-4"}),T.jsx("h2",{className:"text-3xl font-serif font-bold mb-2",children:"How would you like to read?"}),T.jsxs("p",{className:"text-gray-500",children:['Choose your reading experience for "',i.title,'".']})]}),T.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[T.jsxs("button",{onClick:()=>de("preview"),className:"p-6 rounded-3xl border-2 border-gray-100 hover:border-blue-500 hover:bg-blue-50 transition-all text-left group",children:[T.jsx(yB,{size:24,className:"text-gray-400 group-hover:text-blue-500 mb-4"}),T.jsx("h3",{className:"font-bold text-lg mb-1",children:"Quick Preview"}),T.jsx("p",{className:"text-sm text-gray-500",children:"Read a generated summary and excerpt to see if it's your vibe."})]}),T.jsxs("button",{onClick:()=>de("complete"),className:"p-6 rounded-3xl border-2 border-black bg-black text-white hover:scale-[1.02] transition-all text-left",children:[T.jsx(ma,{size:24,className:"text-white mb-4"}),T.jsx("h3",{className:"font-bold text-lg mb-1",children:"Read Complete Book"}),T.jsx("p",{className:"text-sm text-gray-400",children:"Read the full book chapter by chapter with AI generation."})]})]}),T.jsx("button",{onClick:e,className:"mt-8 mx-auto block text-sm font-bold text-gray-400 hover:text-gray-900",children:"Cancel"})]})}):T.jsxs("div",{className:"flex h-screen bg-[#F5F5F7] text-gray-900 animate-in fade-in duration-300 overflow-hidden font-serif",children:[T.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-500 ${L?"mr-96":""}`,children:[T.jsxs("div",{className:"h-16 flex items-center justify-between px-6 bg-white/80 backdrop-blur-md border-b border-gray-200 z-20",children:[T.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:T.jsx(tB,{size:20})}),T.jsxs("div",{className:"text-center",children:[T.jsx("h1",{className:"text-sm font-bold",children:i.title}),T.jsxs("p",{className:"text-xs text-gray-500",children:[i.author,g==="complete"&&!i.isLocal&&T.jsxs("span",{className:"ml-2 bg-gray-100 px-2 py-0.5 rounded-full text-[10px] font-bold tracking-wide",children:["CH ",b]})]})]}),T.jsx("div",{className:"flex gap-2",children:T.jsx("button",{onClick:ft,className:"p-2 hover:bg-gray-100 rounded-full",children:s?T.jsx(UB,{size:20}):T.jsx(PB,{size:20})})})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-8 md:p-16 relative scroll-smooth",onMouseUp:Qe,children:[h?T.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[T.jsx(sc,{className:"animate-spin text-gray-400"}),T.jsxs("p",{className:"text-sm text-gray-400",children:["Loading ",g==="complete"?`Chapter ${b}`:"Preview","..."]})]}):i.isLocal&&!i.fileUrl?T.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[T.jsx("div",{className:"bg-gray-100 p-6 rounded-full mb-4",children:T.jsx(_I,{size:32,className:"text-gray-400"})}),T.jsx("h3",{className:"text-lg font-bold mb-2",children:"File Content Missing"}),T.jsx("p",{className:"text-gray-500 max-w-sm",children:"This is a local file. For security reasons, the browser does not persist the PDF content after a reload. Please re-upload to read again."})]}):i.isLocal&&i.fileUrl?T.jsxs("div",{className:"w-full h-full rounded-2xl shadow-sm overflow-auto",children:[T.jsx(o$,{file:i.fileUrl,onLoadSuccess:J,loading:T.jsx("div",{className:"flex items-center justify-center h-full",children:T.jsx(sc,{className:"animate-spin",size:24})}),error:T.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:"Failed to load PDF"}),children:T.jsx(m$,{pageNumber:Ie,renderTextLayer:!1,renderAnnotationLayer:!1,className:"shadow-lg"})}),ae&&T.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 p-4 bg-white rounded-lg shadow-sm",children:[T.jsx("button",{onClick:()=>H(Math.max(1,Ie-1)),disabled:Ie<=1,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:T.jsx(bI,{size:20})}),T.jsxs("span",{className:"text-sm font-medium",children:["Page ",Ie," of ",ae]}),T.jsx("button",{onClick:()=>H(Math.min(ae,Ie+1)),disabled:Ie>=ae,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50",children:T.jsx(uE,{size:20})})]})]}):T.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-12 shadow-sm rounded-[2px] min-h-full leading-loose text-lg text-gray-800 selection:bg-blue-100 selection:text-blue-900 pb-32",children:[T.jsx("div",{dangerouslySetInnerHTML:{__html:l}}),g==="complete"&&T.jsxs("div",{className:"mt-16 pt-8 border-t border-gray-100 flex items-center justify-between",children:[T.jsxs("button",{onClick:Re,disabled:b<=1,className:"flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold text-gray-500 hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent",children:[T.jsx(bI,{size:16})," Previous"]}),T.jsxs("button",{onClick:ve,className:"flex items-center gap-2 px-8 py-3 bg-black text-white rounded-full text-sm font-bold hover:scale-105 transition-transform",children:["Next Chapter ",T.jsx(uE,{size:16})]})]}),g==="preview"&&T.jsx("div",{className:"mt-8 pt-8 border-t border-gray-100 text-center text-xs text-gray-400 italic",children:'This is an AI-generated preview. Switch to "Complete Book" mode to read more.'})]}),w&&!U&&T.jsxs("div",{className:"fixed z-50 bg-gray-900/90 backdrop-blur-xl text-white rounded-xl shadow-2xl flex items-center gap-1 p-1 animate-in zoom-in-95 duration-200",style:{top:w.top-60,left:w.left-180},onMouseDown:qt,children:[T.jsx("button",{onClick:()=>Xe("#fef08a"),className:"p-3 hover:bg-white/20 rounded-lg group tooltip-container relative",children:T.jsx(RB,{size:16,className:"text-yellow-300"})}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsx("button",{onClick:pt,className:"p-3 hover:bg-white/20 rounded-lg",children:T.jsx(HA,{size:16,className:"text-pink-300"})}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsxs("button",{onClick:Pn,className:"p-3 hover:bg-white/20 rounded-lg text-xs font-bold flex items-center gap-1",children:[T.jsx(TB,{size:14})," Translate"]}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsxs("button",{onClick:ct,className:"p-3 hover:bg-white/20 rounded-lg text-xs font-bold flex items-center gap-1",children:[T.jsx(ma,{size:14})," Explain"]}),T.jsx("div",{className:"w-px h-4 bg-white/20"}),T.jsx("button",{onClick:We,className:"p-3 hover:bg-white/20 rounded-lg",children:T.jsx(hE,{size:16})})]}),U&&w&&T.jsxs("div",{className:"fixed z-50 bg-white rounded-2xl shadow-2xl p-4 w-72 animate-in zoom-in-95 duration-200 border border-gray-100",style:{top:w.top-120,left:w.left-144},onMouseDown:Te=>Te.stopPropagation(),children:[T.jsx("textarea",{className:"w-full bg-yellow-50 p-3 rounded-xl text-sm mb-2 focus:outline-none focus:ring-2 focus:ring-yellow-200",placeholder:"Add your note here...",rows:3,value:K,onChange:Te=>q(Te.target.value),autoFocus:!0}),T.jsxs("div",{className:"flex justify-end gap-2",children:[T.jsx("button",{onClick:()=>F(!1),className:"text-xs font-bold text-gray-400 px-3 py-1.5 hover:bg-gray-100 rounded-lg",children:"Cancel"}),T.jsx("button",{onClick:Kt,className:"text-xs font-bold bg-black text-white px-3 py-1.5 rounded-lg",children:"Save Note"})]})]}),G&&T.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full animate-in slide-in-from-bottom-4 z-40 border border-gray-100",children:[T.jsxs("div",{className:"flex justify-between items-center mb-3",children:[T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-blue-600",children:G.type==="translation"?"Translation":"Context & Analysis"}),T.jsx("button",{onClick:()=>$(null),children:T.jsx(ph,{size:16,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsx("p",{className:"text-gray-800 leading-relaxed font-serif text-lg",children:G.text})]})]}),T.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur-xl border border-white shadow-2xl rounded-full px-6 py-3 flex items-center gap-6 z-30 hover:scale-105 transition-transform",children:[T.jsxs("button",{onClick:()=>O(L==="chat"?null:"chat"),className:`flex items-center gap-2 text-sm font-bold ${L==="chat"?"text-blue-600":"text-gray-600"}`,children:[T.jsx(SI,{size:18}),"Ask Companion"]}),T.jsx("div",{className:"w-px h-6 bg-gray-300"}),T.jsxs("button",{onClick:()=>O(L==="notes"?null:"notes"),className:`flex items-center gap-2 text-sm font-bold ${L==="notes"?"text-blue-600":"text-gray-600"}`,children:[T.jsx(dE,{size:18}),"Notes (",P.length,")"]}),T.jsx("div",{className:"w-px h-6 bg-gray-300"}),T.jsxs("button",{onClick:Oi,className:"flex items-center gap-2 text-sm font-bold text-gray-600 hover:text-gray-900",children:[T.jsx(gB,{size:18}),"Finish"]})]})]}),T.jsxs("div",{className:`fixed top-0 right-0 bottom-0 w-96 bg-white border-l border-gray-200 shadow-2xl transform transition-transform duration-500 z-40 ${L?"translate-x-0":"translate-x-full"}`,children:[L==="chat"&&T.jsxs("div",{className:"flex flex-col h-full",children:[T.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[T.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[T.jsx(gs,{size:18,className:"text-blue-500"})," Reading Companion"]}),T.jsx("button",{onClick:()=>O(null),children:T.jsx(ph,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsxs("div",{className:"p-4 flex gap-2 overflow-x-auto border-b border-gray-50",children:[T.jsxs("button",{onClick:()=>_s("summarize"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-full text-xs font-bold hover:bg-blue-100 whitespace-nowrap",children:[T.jsx(_I,{size:12})," Summarize"]}),T.jsxs("button",{onClick:()=>_s("recap"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-purple-50 text-purple-600 rounded-full text-xs font-bold hover:bg-purple-100 whitespace-nowrap",children:[T.jsx(WB,{size:12})," Where was I?"]})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-white",children:[Q.length===0&&T.jsxs("div",{className:"text-center mt-10 text-gray-400",children:[T.jsx(SI,{size:32,className:"mx-auto mb-2 opacity-20"}),T.jsx("p",{className:"text-sm",children:"Ask anything about the book."})]}),Q.map((Te,ne)=>T.jsx("div",{className:`p-3 rounded-xl text-sm leading-relaxed shadow-sm ${Te.role==="user"?"bg-black text-white ml-8 rounded-br-none":"bg-gray-100 text-gray-800 mr-8 rounded-bl-none"}`,children:Te.text},ne)),ue&&T.jsx("div",{className:"p-3 bg-gray-50 rounded-xl w-12",children:T.jsx(sc,{size:16,className:"animate-spin text-gray-400"})})]}),T.jsx("form",{onSubmit:Bt,className:"p-4 bg-white border-t border-gray-100",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{value:oe,onChange:Te=>ce(Te.target.value),placeholder:"Ask about the plot...",className:"w-full bg-gray-100 rounded-full px-4 py-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow"}),T.jsx("button",{type:"submit",className:"absolute right-2 top-2 p-1.5 bg-blue-500 text-white rounded-full hover:scale-105 transition-transform",children:T.jsx(pw,{size:14})})]})})]}),L==="notes"&&T.jsxs("div",{className:"flex flex-col h-full",children:[T.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[T.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[T.jsx(HA,{size:18,className:"text-pink-500"})," My Notes"]}),T.jsx("button",{onClick:()=>O(null),children:T.jsx(ph,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),T.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:P.length===0?T.jsxs("div",{className:"text-center mt-20 opacity-50",children:[T.jsx(dE,{size:48,className:"mx-auto mb-4 text-gray-300"}),T.jsx("p",{className:"text-gray-500 font-medium",children:"No notes yet."}),T.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Select text to add a note."})]}):P.map(Te=>T.jsxs("div",{className:"bg-yellow-50 p-4 rounded-2xl border border-yellow-100/50 shadow-sm",children:[T.jsxs("div",{className:"text-xs font-bold text-yellow-600/70 uppercase tracking-wider mb-2 flex items-center gap-1",children:[T.jsx(HA,{size:10})," Note"]}),T.jsxs("p",{className:"text-gray-900 font-medium text-sm mb-3 font-serif",children:['"',Te.text,'"']}),Te.selectedText&&T.jsx("div",{className:"pl-3 border-l-2 border-yellow-200",children:T.jsxs("p",{className:"text-xs text-gray-500 italic line-clamp-2",children:['Re: "',Te.selectedText,'"']})}),T.jsx("p",{className:"text-[10px] text-right text-gray-400 mt-2",children:new Date(Te.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},Te.id))})]})]}),showFinishModal&&T.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4 animate-in fade-in",children:T.jsxs("div",{className:"bg-white rounded-[2rem] w-full max-w-lg p-8 shadow-2xl animate-spring",children:[T.jsx("h2",{className:"text-3xl font-serif font-bold text-center mb-2",children:"Congratulations!"}),T.jsxs("p",{className:"text-center text-gray-500 mb-8",children:["You've finished ",i.title,"."]}),T.jsxs("div",{className:"mb-6",children:[T.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2",children:"Leave a note for the author"}),T.jsx("textarea",{className:"w-full bg-gray-50 rounded-2xl p-4 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-100 h-32 resize-none",placeholder:"Your thoughts meant the world...",value:authorNote,onChange:Te=>setAuthorNote(Te.target.value)})]}),T.jsxs("button",{onClick:Ss,className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg hover:scale-[1.02] transition-transform flex items-center justify-center gap-2",children:["Send & Claim Reward ",T.jsx(AB,{size:18})]})]})}),showReward&&T.jsxs("div",{className:"fixed inset-0 z-[70] flex flex-col items-center justify-center bg-black/90 text-white animate-in fade-in duration-500",children:[T.jsxs("div",{className:"relative mb-8 animate-[spin_10s_linear_infinite]",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-yellow-400 to-purple-500 blur-3xl opacity-50 rounded-full"}),T.jsx("div",{className:"relative w-64 h-80 bg-gray-800 rounded-xl overflow-hidden border-2 border-yellow-500/50 shadow-[0_0_50px_rgba(234,179,8,0.3)]",children:T.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:i.coverColor},children:T.jsx(ma,{size:64,className:"text-white/50"})})})]}),T.jsx("h1",{className:"text-4xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:"NFT Minted!"}),T.jsx("p",{className:"text-gray-400 mb-8",children:"You earned 50 Suitcase Tokens (SCT)"}),T.jsx("button",{onClick:()=>{setShowReward(!1),e()},className:"px-8 py-3 bg-white text-black rounded-full font-bold hover:bg-gray-200 transition-colors",children:"Add to Wallet"})]})]})},v$=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],b$=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],_$=({onComplete:i})=>{const[e,t]=ee.useState(1),[n,s]=ee.useState([]),[o,l]=ee.useState(""),[c,h]=ee.useState(""),f=y=>{n.includes(y)?s(b=>b.filter(A=>A!==y)):n.length<3&&s(b=>[...b,y])},g=()=>{e===1&&c.trim()?t(2):e===2&&n.length>0?t(3):e===3&&o&&i({name:c,genres:n,readingGoal:o,onboardingComplete:!0,joinDate:Date.now()})};return T.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-[#F5F5F7]",children:T.jsxs("div",{className:"max-w-xl w-full p-8 animate-spring",children:[T.jsxs("div",{className:"flex justify-center gap-2 mb-12",children:[T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=1?"bg-black":"bg-gray-200"}`}),T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=2?"bg-black":"bg-gray-200"}`}),T.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=3?"bg-black":"bg-gray-200"}`})]}),T.jsxs("div",{className:"text-center mb-10",children:[T.jsx("div",{className:"inline-block p-4 bg-white rounded-[2rem] shadow-lg mb-6 rotate-3",children:T.jsx(gs,{size:32,className:"text-blue-500"})}),T.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-4",children:e===1?"Welcome Traveler":e===2?"What do you like to read?":"Why are you reading?"}),T.jsx("p",{className:"text-gray-500 text-lg",children:e===1?"What should we call you?":e===2?"Pick up to 3 genres.":"Help us curate your perfect suitcase."})]}),T.jsxs("div",{className:"min-h-[200px]",children:[e===1&&T.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:T.jsx("input",{value:c,onChange:y=>h(y.target.value),className:"w-full text-center text-3xl font-bold border-b-2 border-gray-200 focus:border-black bg-transparent outline-none py-2",placeholder:"Enter your name",autoFocus:!0})}),e===2&&T.jsx("div",{className:"flex flex-wrap justify-center gap-3 animate-in fade-in slide-in-from-bottom-4",children:v$.map(y=>T.jsx("button",{onClick:()=>f(y),className:`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${n.includes(y)?"bg-black text-white shadow-lg scale-105":"bg-white text-gray-500 hover:bg-gray-100"}`,children:y},y))}),e===3&&T.jsx("div",{className:"grid gap-4 animate-in fade-in slide-in-from-bottom-4",children:b$.map(y=>T.jsxs("button",{onClick:()=>l(y.label),className:`flex items-center gap-4 p-5 rounded-[2rem] text-left transition-all duration-300 border-2 ${o===y.label?"border-blue-500 bg-blue-50 shadow-lg":"border-transparent bg-white hover:bg-gray-50"}`,children:[T.jsx("span",{className:"text-3xl",children:y.icon}),T.jsx("span",{className:`text-xl font-bold ${o===y.label?"text-blue-900":"text-gray-700"}`,children:y.label}),o===y.label&&T.jsx(cE,{className:"ml-auto text-blue-500"})]},y.id))})]}),T.jsx("div",{className:"flex justify-center mt-8",children:T.jsxs("button",{onClick:g,disabled:e===1?!c.trim():e===2?n.length===0:!o,className:"group flex items-center gap-2 bg-black text-white px-8 py-4 rounded-full font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:scale-105 active:scale-95",children:[e===3?"Finish Setup":"Next",T.jsx(fw,{className:"group-hover:translate-x-1 transition-transform"})]})})]})})},S$=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],BM=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],A$=({userPrefs:i,wallet:e,library:t,onClose:n,onUpdateProfile:s,onReset:o})=>{var L;const[l,c]=ee.useState(!1),[h,f]=ee.useState(i.name||"Traveler"),[g,y]=ee.useState(i.readingGoal),[b,A]=ee.useState(i.genres),w=t.filter(O=>O.isFinished).length,C=t.reduce((O,U)=>{var F;return O+(((F=U.userNotes)==null?void 0:F.length)||0)},0),N=t.filter(O=>e.nfts.includes(O.id)),I=()=>{s({...i,name:h,readingGoal:g,genres:b}),c(!1)},P=()=>{f(i.name||"Traveler"),y(i.readingGoal),A(i.genres),c(!1)},k=O=>{b.includes(O)?A(U=>U.filter(F=>F!==O)):b.length<5&&A(U=>[...U,O])};return T.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-300 max-w-4xl mx-auto mt-8 mb-24",children:[T.jsx("div",{className:"flex justify-end mb-4",children:l?T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:P,className:"px-4 py-2 bg-white text-gray-500 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm",children:"Cancel"}),T.jsxs("button",{onClick:I,className:"px-4 py-2 bg-black text-white rounded-full font-bold shadow-lg hover:bg-gray-800 text-sm flex items-center gap-2",children:[T.jsx(cE,{size:14})," Save Changes"]})]}):T.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-white text-gray-900 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm flex items-center gap-2",children:[T.jsx(HB,{size:14})," Edit Profile"]})}),T.jsxs("div",{className:"bg-white rounded-[2.5rem] p-8 shadow-sm mb-8 relative overflow-hidden",children:[T.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-bl from-blue-100 to-purple-100 rounded-bl-[10rem] -z-0 opacity-50 pointer-events-none"}),T.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 relative z-10",children:[T.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-tr from-gray-900 to-gray-700 shadow-2xl flex items-center justify-center text-4xl font-serif font-bold text-white border-4 border-white",children:h.charAt(0).toUpperCase()}),T.jsxs("div",{className:"text-center md:text-left flex-1 w-full",children:[l?T.jsxs("div",{className:"flex flex-col gap-2 mb-2 w-full max-w-md",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider",children:"Display Name"}),T.jsx("input",{value:h,onChange:O=>f(O.target.value),className:"text-2xl font-serif font-bold text-gray-900 bg-gray-50 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500 w-full"})]}):T.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-2",children:h}),T.jsx("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 text-sm text-gray-500 font-medium",children:T.jsxs("span",{className:"flex items-center gap-1.5",children:[T.jsx(ND,{size:14})," Joined ",new Date(i.joinDate).toLocaleDateString()]})})]}),T.jsxs("div",{className:"bg-gray-900 text-white p-6 rounded-3xl shadow-xl min-w-[200px] text-center md:text-right relative overflow-hidden group",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/20 to-purple-500/20 group-hover:opacity-100 transition-opacity opacity-0"}),T.jsxs("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 flex items-center justify-end gap-2",children:["Balance ",T.jsx(r3,{size:12})]}),T.jsxs("div",{className:"text-3xl font-mono font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:[e.balance," SCT"]})]})]})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[T.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[T.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[T.jsx(gs,{size:14})," Current Focus"]}),l?T.jsx("div",{className:"grid gap-2",children:BM.map(O=>T.jsxs("button",{onClick:()=>y(O.label),className:`flex items-center gap-3 p-3 rounded-xl border text-left transition-colors ${g===O.label?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-100 hover:bg-gray-50"}`,children:[T.jsx("span",{className:"text-xl",children:O.icon}),T.jsx("span",{className:"font-bold text-sm",children:O.label}),g===O.label&&T.jsx(cE,{size:16,className:"ml-auto text-blue-600"})]},O.id))}):T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("span",{className:"text-3xl",children:((L=BM.find(O=>O.label===g))==null?void 0:L.icon)||""}),T.jsx("span",{className:"text-xl font-bold text-gray-900",children:g})]})]}),T.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[T.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[T.jsx(ma,{size:14})," Favorite Genres"]}),T.jsx("div",{className:"flex flex-wrap gap-2",children:l?S$.map(O=>T.jsx("button",{onClick:()=>k(O),className:`px-3 py-1.5 rounded-full text-sm font-bold transition-colors ${b.includes(O)?"bg-black text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:O},O)):b.map(O=>T.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm font-bold",children:O},O))})]})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-50 flex items-center justify-center text-blue-600",children:T.jsx(ma,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Books Finished"})]})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-purple-50 flex items-center justify-center text-purple-600",children:T.jsx(dE,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Notes Taken"})]})]}),T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 rounded-2xl bg-yellow-50 flex items-center justify-center text-yellow-600",children:T.jsx(vI,{size:24})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.nfts.length}),T.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"NFTs Collected"})]})]})]}),T.jsxs("div",{className:"mb-12",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-6 px-2",children:[T.jsx(gs,{className:"text-yellow-500",size:20}),T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900",children:"Your Collection (NFTs)"})]}),N.length===0?T.jsxs("div",{className:"bg-white rounded-[2rem] p-12 text-center border-2 border-dashed border-gray-200",children:[T.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300",children:T.jsx(vI,{size:32})}),T.jsx("h3",{className:"text-gray-900 font-bold mb-1",children:"No Digital Collectibles Yet"}),T.jsx("p",{className:"text-gray-500 text-sm",children:"Finish books to mint their covers as NFTs."})]}):T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:N.map(O=>T.jsxs("div",{className:"group relative aspect-[2/3] rounded-2xl overflow-hidden shadow-lg transition-transform hover:scale-105",children:[T.jsx("div",{className:"absolute inset-0",style:{backgroundColor:O.coverColor}}),O.isbn&&T.jsx("img",{src:`https://covers.openlibrary.org/b/isbn/${O.isbn}-L.jpg`,className:"absolute inset-0 w-full h-full object-cover",alt:O.title}),T.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-4",children:[T.jsx("p",{className:"text-white font-bold text-sm line-clamp-2",children:O.title}),T.jsx("div",{className:"flex items-center gap-1 mt-1",children:T.jsx("span",{className:"text-[10px] font-bold bg-yellow-400 text-black px-1.5 rounded",children:"NFT"})})]})]},O.id))})]}),T.jsx("div",{className:"flex justify-center",children:T.jsxs("button",{onClick:o,className:"text-red-500 text-sm font-bold flex items-center gap-2 hover:bg-red-50 px-6 py-3 rounded-full transition-colors",children:[T.jsx(MD,{size:16})," Reset Profile & Data"]})})]})},E$=()=>{};var HM={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},T$=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=i[t++];e[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=i[t++],l=i[t++],c=i[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=i[t++],l=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},eL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const o=i[s],l=s+1<i.length,c=l?i[s+1]:0,h=s+2<i.length,f=h?i[s+2]:0,g=o>>2,y=(o&3)<<4|c>>4;let b=(c&15)<<2|f>>6,A=f&63;h||(A=64,l||(b=64)),n.push(t[g],t[y],t[b],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(Z2(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):T$(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const o=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const f=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,o==null||c==null||f==null||y==null)throw new w$;const b=o<<2|c>>4;if(n.push(b),f!==64){const A=c<<4&240|f>>2;if(n.push(A),y!==64){const w=f<<6&192|y;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class w$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C$=function(i){const e=Z2(i);return eL.encodeByteArray(e,!0)},tL=function(i){return C$(i).replace(/\./g,"")},nL=function(i){try{return eL.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R$=()=>x$().__FIREBASE_DEFAULTS__,I$=()=>{if(typeof process>"u"||typeof HM>"u")return;const i=HM.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},N$=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&nL(i[1]);return e&&JSON.parse(e)},zw=()=>{try{return E$()||R$()||I$()||N$()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},M$=i=>{var e,t;return(t=(e=zw())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},iL=()=>{var i;return(i=zw())==null?void 0:i.config},sL=i=>{var e;return(e=zw())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function k$(i){return(await fetch(i,{credentials:"include"})).ok}const Lg={};function P$(){const i={prod:[],emulator:[]};for(const e of Object.keys(Lg))Lg[e]?i.emulator.push(e):i.prod.push(e);return i}function L$(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let GM=!1;function O$(i,e){if(typeof window>"u"||typeof document>"u"||!g_(window.location.host)||Lg[i]===e||Lg[i]||GM)return;Lg[i]=e;function t(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=P$().prod.length>0;function l(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,A){b.setAttribute("width","24"),b.setAttribute("id",A),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{GM=!0,l()},b}function g(b,A){b.setAttribute("id",A),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function y(){const b=L$(n),A=t("text"),w=document.getElementById(A)||document.createElement("span"),C=t("learnmore"),N=document.getElementById(C)||document.createElement("a"),I=t("preprendIcon"),P=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const k=b.element;c(k),g(N,C);const L=f();h(P,I),k.append(P,w,N,L),document.body.appendChild(k)}o?(w.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vi())}function F$(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rL(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function B$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function H$(){const i=vi();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function oL(){try{return typeof indexedDB=="object"}catch{return!1}}function aL(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}function G$(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z$="FirebaseError";class co extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=z$,Object.setPrototypeOf(this,co.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ud.prototype.create)}}class ud{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?V$(o,n):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new co(s,c,n)}}function V$(i,e){return i.replace(q$,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const q$=/\{\$([^}]+)}/g;function $$(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function nd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const o=i[s],l=e[s];if(zM(o)&&zM(l)){if(!nd(o,l))return!1}else if(o!==l)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function zM(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Mg(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,o]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Dg(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function Y$(i,e){const t=new X$(i,e);return t.subscribe.bind(t)}class X${constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");W$(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=ZA),s.error===void 0&&(s.error=ZA),s.complete===void 0&&(s.complete=ZA);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function W$(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function ZA(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K$=1e3,J$=2,j$=14400*1e3,Q$=.5;function VM(i,e=K$,t=J$){const n=e*Math.pow(t,i),s=Math.round(Q$*n*(Math.random()-.5)*2);return Math.min(j$,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(i){return i&&i._delegate?i._delegate:i}class ro{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z${constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new D$;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(t9(e))try{this.getOrInitializeService({instanceIdentifier:Uc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(e=Uc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uc){return this.instances.has(e)}getOptions(e=Uc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&l.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&e(o,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:e9(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Uc){return this.component?this.component.multipleInstances?e:Uc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function e9(i){return i===Uc?void 0:i}function t9(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Z$(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Mt||(Mt={}));const i9={debug:Mt.DEBUG,verbose:Mt.VERBOSE,info:Mt.INFO,warn:Mt.WARN,error:Mt.ERROR,silent:Mt.SILENT},s9=Mt.INFO,r9={[Mt.DEBUG]:"log",[Mt.VERBOSE]:"log",[Mt.INFO]:"info",[Mt.WARN]:"warn",[Mt.ERROR]:"error"},o9=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=r9[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vw{constructor(e){this.name=e,this._logLevel=s9,this._logHandler=o9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?i9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Mt.DEBUG,...e),this._logHandler(this,Mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Mt.VERBOSE,...e),this._logHandler(this,Mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Mt.INFO,...e),this._logHandler(this,Mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Mt.WARN,...e),this._logHandler(this,Mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Mt.ERROR,...e),this._logHandler(this,Mt.ERROR,...e)}}const a9=(i,e)=>e.some(t=>i instanceof t);let qM,$M;function l9(){return qM||(qM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function c9(){return $M||($M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lL=new WeakMap,ew=new WeakMap,cL=new WeakMap,eE=new WeakMap,qw=new WeakMap;function u9(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",o),i.removeEventListener("error",l)},o=()=>{t(rc(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",o),i.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&lL.set(t,i)}).catch(()=>{}),qw.set(e,i),e}function d9(i){if(ew.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",l),i.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",o),i.addEventListener("error",l),i.addEventListener("abort",l)});ew.set(i,e)}let tw={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return ew.get(i);if(e==="objectStoreNames")return i.objectStoreNames||cL.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return rc(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function h9(i){tw=i(tw)}function f9(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(tE(this),e,...t);return cL.set(n,e.sort?e.sort():[e]),rc(n)}:c9().includes(i)?function(...e){return i.apply(tE(this),e),rc(lL.get(this))}:function(...e){return rc(i.apply(tE(this),e))}}function p9(i){return typeof i=="function"?f9(i):(i instanceof IDBTransaction&&d9(i),a9(i,l9())?new Proxy(i,tw):i)}function rc(i){if(i instanceof IDBRequest)return u9(i);if(eE.has(i))return eE.get(i);const e=p9(i);return e!==i&&(eE.set(i,e),qw.set(e,i)),e}const tE=i=>qw.get(i);function uL(i,e,{blocked:t,upgrade:n,blocking:s,terminated:o}={}){const l=indexedDB.open(i,e),c=rc(l);return n&&l.addEventListener("upgradeneeded",h=>{n(rc(l.result),h.oldVersion,h.newVersion,rc(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const g9=["get","getKey","getAll","getAllKeys","count"],m9=["put","add","delete","clear"],nE=new Map;function YM(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(nE.get(e))return nE.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=m9.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||g9.includes(t)))return;const o=async function(l,...c){const h=this.transaction(l,s?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),s&&h.done]))[0]};return nE.set(e,o),o}h9(i=>({...i,get:(e,t,n)=>YM(e,t)||i.get(e,t,n),has:(e,t)=>!!YM(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(v9(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function v9(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nw="@firebase/app",XM="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta=new Vw("@firebase/app"),b9="@firebase/app-compat",_9="@firebase/analytics-compat",S9="@firebase/analytics",A9="@firebase/app-check-compat",E9="@firebase/app-check",T9="@firebase/auth",w9="@firebase/auth-compat",C9="@firebase/database",x9="@firebase/data-connect",R9="@firebase/database-compat",I9="@firebase/functions",N9="@firebase/functions-compat",M9="@firebase/installations",D9="@firebase/installations-compat",k9="@firebase/messaging",P9="@firebase/messaging-compat",L9="@firebase/performance",O9="@firebase/performance-compat",U9="@firebase/remote-config",F9="@firebase/remote-config-compat",B9="@firebase/storage",H9="@firebase/storage-compat",G9="@firebase/firestore",z9="@firebase/ai",V9="@firebase/firestore-compat",q9="firebase",$9="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iw="[DEFAULT]",Y9={[nw]:"fire-core",[b9]:"fire-core-compat",[S9]:"fire-analytics",[_9]:"fire-analytics-compat",[E9]:"fire-app-check",[A9]:"fire-app-check-compat",[T9]:"fire-auth",[w9]:"fire-auth-compat",[C9]:"fire-rtdb",[x9]:"fire-data-connect",[R9]:"fire-rtdb-compat",[I9]:"fire-fn",[N9]:"fire-fn-compat",[M9]:"fire-iid",[D9]:"fire-iid-compat",[k9]:"fire-fcm",[P9]:"fire-fcm-compat",[L9]:"fire-perf",[O9]:"fire-perf-compat",[U9]:"fire-rc",[F9]:"fire-rc-compat",[B9]:"fire-gcs",[H9]:"fire-gcs-compat",[G9]:"fire-fst",[V9]:"fire-fst-compat",[z9]:"fire-vertex","fire-js":"fire-js",[q9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb=new Map,X9=new Map,sw=new Map;function WM(i,e){try{i.container.addComponent(e)}catch(t){Ta.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function wa(i){const e=i.name;if(sw.has(e))return Ta.debug(`There were multiple attempts to register component ${e}.`),!1;sw.set(e,i);for(const t of Tb.values())WM(t,i);for(const t of X9.values())WM(t,i);return!0}function op(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function gr(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oc=new ud("app","Firebase",W9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ro("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=$9;function dL(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:iw,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw oc.create("bad-app-name",{appName:String(s)});if(t||(t=iL()),!t)throw oc.create("no-options");const o=Tb.get(s);if(o){if(nd(t,o.options)&&nd(n,o.config))return o;throw oc.create("duplicate-app",{appName:s})}const l=new n9(s);for(const h of sw.values())l.addComponent(h);const c=new K9(t,n,l);return Tb.set(s,c),c}function hL(i=iw){const e=Tb.get(i);if(!e&&i===iw&&iL())return dL();if(!e)throw oc.create("no-app",{appName:i});return e}function no(i,e,t){let n=Y9[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${n}" with version "${e}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ta.warn(l.join(" "));return}wa(new ro(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9="firebase-heartbeat-database",j9=1,Yg="firebase-heartbeat-store";let iE=null;function fL(){return iE||(iE=uL(J9,j9,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Yg)}catch(t){console.warn(t)}}}}).catch(i=>{throw oc.create("idb-open",{originalErrorMessage:i.message})})),iE}async function Q9(i){try{const t=(await fL()).transaction(Yg),n=await t.objectStore(Yg).get(pL(i));return await t.done,n}catch(e){if(e instanceof co)Ta.warn(e.message);else{const t=oc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ta.warn(t.message)}}}async function KM(i,e){try{const n=(await fL()).transaction(Yg,"readwrite");await n.objectStore(Yg).put(e,pL(i)),await n.done}catch(t){if(t instanceof co)Ta.warn(t.message);else{const n=oc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ta.warn(n.message)}}}function pL(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z9=1024,eY=30;class tY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new iY(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=JM();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>eY){const l=sY(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ta.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=JM(),{heartbeatsToSend:n,unsentEntries:s}=nY(this._heartbeatsCache.heartbeats),o=tL(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Ta.warn(t),""}}}function JM(){return new Date().toISOString().substring(0,10)}function nY(i,e=Z9){const t=[];let n=i.slice();for(const s of i){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),jM(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),jM(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class iY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oL()?aL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Q9(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return KM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return KM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function jM(i){return tL(JSON.stringify({version:2,heartbeats:i})).length}function sY(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rY(i){wa(new ro("platform-logger",e=>new y9(e),"PRIVATE")),wa(new ro("heartbeat",e=>new tY(e),"PRIVATE")),no(nw,XM,i),no(nw,XM,"esm2020"),no("fire-js","")}rY("");function gL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oY=gL,mL=new ud("auth","Firebase",gL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb=new Vw("@firebase/auth");function aY(i,...e){wb.logLevel<=Mt.WARN&&wb.warn(`Auth (${Uy}): ${i}`,...e)}function tb(i,...e){wb.logLevel<=Mt.ERROR&&wb.error(`Auth (${Uy}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(i,...e){throw $w(i,...e)}function io(i,...e){return $w(i,...e)}function yL(i,e,t){const n={...oY(),[e]:t};return new ud("auth","Firebase",n).create(e,{appName:i.name})}function ya(i){return yL(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $w(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return mL.create(i,...e)}function ke(i,e,...t){if(!i)throw $w(e,...t)}function pa(i){const e="INTERNAL ASSERTION FAILED: "+i;throw tb(e),new Error(e)}function Ca(i,e){i||pa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function lY(){return QM()==="http:"||QM()==="https:"}function QM(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lY()||rL()||"connection"in navigator)?navigator.onLine:!0}function uY(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ca(t>e,"Short delay should be less than long delay!"),this.isMobile=U$()||B$()}get(){return cY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(i,e){Ca(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hY=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fY=new Fy(3e4,6e4);function fc(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Ma(i,e,t,n,s={}){return bL(i,s,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const c=Oy({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const f={method:e,headers:h,...o};return F$()||(f.referrerPolicy="no-referrer"),i.emulatorConfig&&g_(i.emulatorConfig.host)&&(f.credentials="include"),vL.fetch()(await _L(i,i.config.apiHost,t,c),f)})}async function bL(i,e,t){i._canInitEmulator=!1;const n={...dY,...e};try{const s=new gY(i),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw _v(i,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[h,f]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw _v(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw _v(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw _v(i,"user-disabled",l);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw yL(i,g,f);Sr(i,g)}}catch(s){if(s instanceof co)throw s;Sr(i,"network-request-failed",{message:String(s)})}}async function By(i,e,t,n,s={}){const o=await Ma(i,e,t,n,s);return"mfaPendingCredential"in o&&Sr(i,"multi-factor-auth-required",{_serverResponse:o}),o}async function _L(i,e,t,n){const s=`${e}${t}?${n}`,o=i,l=o.config.emulator?Yw(i.config,s):`${i.config.apiScheme}://${s}`;return hY.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function pY(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(io(this.auth,"network-request-failed")),fY.get())})}}function _v(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=io(i,e,n);return s.customData._tokenResponse=t,s}function ZM(i){return i!==void 0&&i.enterprise!==void 0}class mY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return pY(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function yY(i,e){return Ma(i,"GET","/v2/recaptchaConfig",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vY(i,e){return Ma(i,"POST","/v1/accounts:delete",e)}async function Cb(i,e){return Ma(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bY(i,e=!1){const t=bs(i),n=await t.getIdToken(e),s=Xw(n);ke(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:n,authTime:Og(sE(s.auth_time)),issuedAtTime:Og(sE(s.iat)),expirationTime:Og(sE(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function sE(i){return Number(i)*1e3}function Xw(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return tb("JWT malformed, contained fewer than 3 sections"),null;try{const s=nL(t);return s?JSON.parse(s):(tb("Failed to decode base64 JWT payload"),null)}catch(s){return tb("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function eD(i){const e=Xw(i);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ep(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof co&&_Y(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function _Y({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Og(this.lastLoginAt),this.creationTime=Og(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xb(i){var y;const e=i.auth,t=await i.getIdToken(),n=await ep(i,Cb(e,{idToken:t}));ke(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const o=(y=s.providerUserInfo)!=null&&y.length?SL(s.providerUserInfo):[],l=EY(i.providerData,o),c=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new ow(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(i,g)}async function AY(i){const e=bs(i);await xb(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EY(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function SL(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TY(i,e){const t=await bL(i,{},async()=>{const n=Oy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=i.config,l=await _L(i,s,"/v1/token",`key=${o}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return i.emulatorConfig&&g_(i.emulatorConfig.host)&&(h.credentials="include"),vL.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function wY(i,e){return Ma(i,"POST","/v2/accounts:revokeToken",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=eD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:o}=await TY(e,t);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:o}=t,l=new _h;return n&&(ke(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),s&&(ke(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(ke(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _h,this.toJSON())}_performRefresh(){return pa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(i,e){ke(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class mr{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new SY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ow(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ep(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bY(this,e)}reload(){return AY(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await xb(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gr(this.auth.app))return Promise.reject(ya(this.auth));const e=await this.getIdToken();return await ep(this,vY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:y,emailVerified:b,isAnonymous:A,providerData:w,stsTokenManager:C}=t;ke(y&&C,e,"internal-error");const N=_h.fromJSON(this.name,C);ke(typeof y=="string",e,"internal-error"),sl(n,e.name),sl(s,e.name),ke(typeof b=="boolean",e,"internal-error"),ke(typeof A=="boolean",e,"internal-error"),sl(o,e.name),sl(l,e.name),sl(c,e.name),sl(h,e.name),sl(f,e.name),sl(g,e.name);const I=new mr({uid:y,auth:e,email:s,emailVerified:b,displayName:n,isAnonymous:A,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:N,createdAt:f,lastLoginAt:g});return w&&Array.isArray(w)&&(I.providerData=w.map(P=>({...P}))),h&&(I._redirectEventId=h),I}static async _fromIdTokenResponse(e,t,n=!1){const s=new _h;s.updateFromServerResponse(t);const o=new mr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await xb(o),o}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];ke(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?SL(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),c=new _h;c.updateFromIdToken(n);const h=new mr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ow(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new Map;function ga(i){Ca(i instanceof Function,"Expected a class definition");let e=tD.get(i);return e?(Ca(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,tD.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}AL.type="NONE";const nD=AL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(i,e,t){return`firebase:${i}:${e}:${t}`}class Sh{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=nb(this.userKey,s.apiKey,o),this.fullPersistenceKey=nb("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Cb(this.auth,{idToken:e}).catch(()=>{});return t?mr._fromGetAccountInfoResponse(this.auth,t,e):null}return mr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Sh(ga(nD),e,n);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||ga(nD);const l=nb(n,e.config.apiKey,e.name);let c=null;for(const f of t)try{const g=await f._get(l);if(g){let y;if(typeof g=="string"){const b=await Cb(e,{idToken:g}).catch(()=>{});if(!b)break;y=await mr._fromGetAccountInfoResponse(e,b,g)}else y=mr._fromJSON(e,g);f!==o&&(c=y),o=f;break}}catch{}const h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Sh(o,e,n):(o=h[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new Sh(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iD(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(EL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RL(e))return"Blackberry";if(IL(e))return"Webos";if(TL(e))return"Safari";if((e.includes("chrome/")||wL(e))&&!e.includes("edge/"))return"Chrome";if(xL(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function EL(i=vi()){return/firefox\//i.test(i)}function TL(i=vi()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wL(i=vi()){return/crios\//i.test(i)}function CL(i=vi()){return/iemobile/i.test(i)}function xL(i=vi()){return/android/i.test(i)}function RL(i=vi()){return/blackberry/i.test(i)}function IL(i=vi()){return/webos/i.test(i)}function Ww(i=vi()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function CY(i=vi()){var e;return Ww(i)&&!!((e=window.navigator)!=null&&e.standalone)}function xY(){return H$()&&document.documentMode===10}function NL(i=vi()){return Ww(i)||xL(i)||IL(i)||RL(i)||/windows phone/i.test(i)||CL(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(i,e=[]){let t;switch(i){case"Browser":t=iD(vi());break;case"Worker":t=`${iD(vi())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Uy}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((l,c)=>{try{const h=e(o);l(h)}catch(h){c(h)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IY(i,e={}){return Ma(i,"GET","/v2/passwordPolicy",fc(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=6;class MY{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??NY,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sD(this),this.idTokenSubscription=new sD(this),this.beforeStateQueue=new RY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ga(t)),this._initializationPromise=this.queue(async()=>{var n,s,o;if(!this._deleted&&(this.persistenceManager=await Sh.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Cb(this,{idToken:e}),n=await mr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(gr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,c=n==null?void 0:n._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&(h!=null&&h.user)&&(n=h.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xb(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gr(this.app))return Promise.reject(ya(this));const t=e?bs(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gr(this.app)?Promise.reject(ya(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gr(this.app)?Promise.reject(ya(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ga(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IY(this),t=new MY(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ud("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await wY(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ga(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Sh.create(this,[ga(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ML(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&aY(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function dd(i){return bs(i)}class sD{constructor(e){this.auth=e,this.observer=null,this.addObserver=Y$(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kY(i){m_=i}function DL(i){return m_.loadJS(i)}function PY(){return m_.recaptchaEnterpriseScript}function LY(){return m_.gapiScript}function OY(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class UY{constructor(){this.enterprise=new FY}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class FY{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const BY="recaptcha-enterprise",kL="NO_RECAPTCHA";class HY{constructor(e){this.type=BY,this.auth=dd(e)}async verify(e="verify",t=!1){async function n(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,c)=>{yY(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const f=new mY(h);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(h=>{c(h)})})}function s(o,l,c){const h=window.grecaptcha;ZM(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(f=>{l(f)}).catch(()=>{l(kL)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new UY().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(c=>{if(!t&&ZM(window.grecaptcha))s(c,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=PY();h.length!==0&&(h+=c),DL(h).then(()=>{s(c,o,l)}).catch(f=>{l(f)})}}).catch(c=>{l(c)})})}}async function rD(i,e,t,n=!1,s=!1){const o=new HY(i);let l;if(s)l=kL;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,f=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function aw(i,e,t,n,s){var o;if((o=i._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await rD(i,e,t,t==="getOobCode");return n(i,l)}else return n(i,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await rD(i,e,t,t==="getOobCode");return n(i,c)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GY(i,e){const t=op(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(nd(o,e??{}))return s;Sr(s,"already-initialized")}return t.initialize({options:e})}function zY(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(ga);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function VY(i,e,t){const n=dd(i);ke(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,o=PL(e),{host:l,port:c}=qY(e),h=c===null?"":`:${c}`,f={url:`${o}//${l}${h}/`},g=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){ke(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ke(nd(f,n.config.emulator)&&nd(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,g_(l)?(k$(`${o}//${l}${h}`),O$("Auth",!0)):$Y()}function PL(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function qY(i){const e=PL(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:oD(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:oD(l)}}}function oD(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function $Y(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pa("not implemented")}_getIdTokenResponse(e){return pa("not implemented")}_linkToIdToken(e,t){return pa("not implemented")}_getReauthenticationResolver(e){return pa("not implemented")}}async function YY(i,e){return Ma(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XY(i,e){return By(i,"POST","/v1/accounts:signInWithPassword",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WY(i,e){return By(i,"POST","/v1/accounts:signInWithEmailLink",fc(i,e))}async function KY(i,e){return By(i,"POST","/v1/accounts:signInWithEmailLink",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg extends Kw{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Xg(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Xg(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aw(e,t,"signInWithPassword",XY);case"emailLink":return WY(e,{email:this._email,oobCode:this._password});default:Sr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return aw(e,n,"signUpPassword",YY);case"emailLink":return KY(e,{idToken:t,email:this._email,oobCode:this._password});default:Sr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ah(i,e){return By(i,"POST","/v1/accounts:signInWithIdp",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JY="http://localhost";class id extends Kw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new id(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...o}=t;if(!n||!s)return null;const l=new id(n,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Ah(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ah(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ah(e,t)}buildRequest(){const e={requestUri:JY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Oy(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jY(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QY(i){const e=Mg(Dg(i)).link,t=e?Mg(Dg(e)).deep_link_id:null,n=Mg(Dg(i)).deep_link_id;return(n?Mg(Dg(n)).link:null)||n||t||e||i}class Jw{constructor(e){const t=Mg(Dg(e)),n=t.apiKey??null,s=t.oobCode??null,o=jY(t.mode??null);ke(n&&s&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=QY(e);try{return new Jw(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(){this.providerId=ap.PROVIDER_ID}static credential(e,t){return Xg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Jw.parseLink(t);return ke(n,"argument-error"),Xg._fromEmailAndCode(e,n.code,n.tenantId)}}ap.PROVIDER_ID="password";ap.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ap.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy extends LL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol extends Hy{constructor(){super("facebook.com")}static credential(e){return id._fromParams({providerId:ol.PROVIDER_ID,signInMethod:ol.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ol.credentialFromTaggedObject(e)}static credentialFromError(e){return ol.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ol.credential(e.oauthAccessToken)}catch{return null}}}ol.FACEBOOK_SIGN_IN_METHOD="facebook.com";ol.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al extends Hy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return id._fromParams({providerId:al.PROVIDER_ID,signInMethod:al.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return al.credentialFromTaggedObject(e)}static credentialFromError(e){return al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return al.credential(t,n)}catch{return null}}}al.GOOGLE_SIGN_IN_METHOD="google.com";al.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll extends Hy{constructor(){super("github.com")}static credential(e){return id._fromParams({providerId:ll.PROVIDER_ID,signInMethod:ll.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ll.credentialFromTaggedObject(e)}static credentialFromError(e){return ll.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ll.credential(e.oauthAccessToken)}catch{return null}}}ll.GITHUB_SIGN_IN_METHOD="github.com";ll.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl extends Hy{constructor(){super("twitter.com")}static credential(e,t){return id._fromParams({providerId:cl.PROVIDER_ID,signInMethod:cl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return cl.credentialFromTaggedObject(e)}static credentialFromError(e){return cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return cl.credential(t,n)}catch{return null}}}cl.TWITTER_SIGN_IN_METHOD="twitter.com";cl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZY(i,e){return By(i,"POST","/v1/accounts:signUp",fc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const o=await mr._fromIdTokenResponse(e,n,s),l=aD(n);return new sd({user:o,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=aD(n);return new sd({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function aD(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb extends co{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Rb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Rb(e,t,n,s)}}function OL(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Rb._fromErrorAndOperation(i,o,e,n):o})}async function e7(i,e,t=!1){const n=await ep(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return sd._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t7(i,e,t=!1){const{auth:n}=i;if(gr(n.app))return Promise.reject(ya(n));const s="reauthenticate";try{const o=await ep(i,OL(n,s,e,i),t);ke(o.idToken,n,"internal-error");const l=Xw(o.idToken);ke(l,n,"internal-error");const{sub:c}=l;return ke(i.uid===c,n,"user-mismatch"),sd._forOperation(i,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Sr(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(i,e,t=!1){if(gr(i.app))return Promise.reject(ya(i));const n="signIn",s=await OL(i,n,e),o=await sd._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(o.user),o}async function n7(i,e){return UL(dd(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FL(i){const e=dd(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function i7(i,e,t){if(gr(i.app))return Promise.reject(ya(i));const n=dd(i),l=await aw(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ZY).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&FL(i),h}),c=await sd._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function s7(i,e,t){return gr(i.app)?Promise.reject(ya(i)):n7(bs(i),ap.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&FL(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r7(i,e){return Ma(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o7(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=bs(i),o={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await ep(n,r7(n.auth,o));n.displayName=l.displayName||null,n.photoURL=l.photoUrl||null;const c=n.providerData.find(({providerId:h})=>h==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(l)}function a7(i,e,t,n){return bs(i).onIdTokenChanged(e,t,n)}function l7(i,e,t){return bs(i).beforeAuthStateChanged(e,t)}function c7(i,e,t,n){return bs(i).onAuthStateChanged(e,t,n)}function u7(i){return bs(i).signOut()}const Ib="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ib,"1"),this.storage.removeItem(Ib),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7=1e3,h7=10;class HL extends BL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);xY()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,h7):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},d7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}HL.type="LOCAL";const f7=HL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL extends BL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}GL.type="SESSION";const zL=GL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new y_(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(l).map(async f=>f(t.origin,o)),h=await p7(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}y_.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((c,h)=>{const f=jw("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(y){const b=y;if(b.data.eventId===f)switch(b.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(){return window}function m7(i){so().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(){return typeof so().WorkerGlobalScope<"u"&&typeof so().importScripts=="function"}async function y7(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function v7(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function b7(){return VL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="firebaseLocalStorageDb",_7=1,Nb="firebaseLocalStorage",$L="fbase_key";class Gy{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function v_(i,e){return i.transaction([Nb],e?"readwrite":"readonly").objectStore(Nb)}function S7(){const i=indexedDB.deleteDatabase(qL);return new Gy(i).toPromise()}function lw(){const i=indexedDB.open(qL,_7);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Nb,{keyPath:$L})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Nb)?e(n):(n.close(),await S7(),e(await lw()))})})}async function lD(i,e,t){const n=v_(i,!0).put({[$L]:e,value:t});return new Gy(n).toPromise()}async function A7(i,e){const t=v_(i,!1).get(e),n=await new Gy(t).toPromise();return n===void 0?null:n.value}function cD(i,e){const t=v_(i,!0).delete(e);return new Gy(t).toPromise()}const E7=800,T7=3;class YL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lw(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>T7)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return VL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=y_._getInstance(b7()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await y7(),!this.activeServiceWorker)return;this.sender=new g7(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||v7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lw();return await lD(e,Ib,"1"),await cD(e,Ib),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>lD(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>A7(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cD(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=v_(s,!1).getAll();return new Gy(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),E7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YL.type="LOCAL";const w7=YL;new Fy(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C7(i,e){return e?ga(e):(ke(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw extends Kw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ah(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ah(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ah(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function x7(i){return UL(i.auth,new Qw(i),i.bypassAuthState)}function R7(i){const{auth:e,user:t}=i;return ke(t,e,"internal-error"),t7(t,new Qw(i),i.bypassAuthState)}async function I7(i){const{auth:e,user:t}=i;return ke(t,e,"internal-error"),e7(t,new Qw(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e,t,n,s,o=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return x7;case"linkViaPopup":case"linkViaRedirect":return I7;case"reauthViaPopup":case"reauthViaRedirect":return R7;default:Sr(this.auth,"internal-error")}}resolve(e){Ca(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ca(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N7=new Fy(2e3,1e4);class ch extends XL{constructor(e,t,n,s,o){super(e,t,s,o),this.provider=n,this.authWindow=null,this.pollId=null,ch.currentPopupAction&&ch.currentPopupAction.cancel(),ch.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){Ca(this.filter.length===1,"Popup operations only handle one event");const e=jw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(io(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(io(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ch.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(io(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,N7.get())};e()}}ch.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7="pendingRedirect",ib=new Map;class D7 extends XL{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ib.get(this.auth._key());if(!e){try{const n=await k7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ib.set(this.auth._key(),e)}return this.bypassAuthState||ib.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k7(i,e){const t=O7(e),n=L7(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function P7(i,e){ib.set(i._key(),e)}function L7(i){return ga(i._redirectPersistence)}function O7(i){return nb(M7,i.config.apiKey,i.name)}async function U7(i,e,t=!1){if(gr(i.app))return Promise.reject(ya(i));const n=dd(i),s=C7(n,e),l=await new D7(n,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7=600*1e3;class B7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!H7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!WL(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(io(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=F7&&this.cachedEventUids.clear(),this.cachedEventUids.has(uD(e))}saveEventToCache(e){this.cachedEventUids.add(uD(e)),this.lastProcessedEventTime=Date.now()}}function uD(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function WL({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function H7(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WL(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G7(i,e={}){return Ma(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,V7=/^https?/;async function q7(i){if(i.config.emulator)return;const{authorizedDomains:e}=await G7(i);for(const t of e)try{if($7(t))return}catch{}Sr(i,"unauthorized-domain")}function $7(i){const e=rw(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!V7.test(t))return!1;if(z7.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y7=new Fy(3e4,6e4);function dD(){const i=so().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function X7(i){return new Promise((e,t)=>{var s,o,l;function n(){dD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dD(),t(io(i,"network-request-failed"))},timeout:Y7.get()})}if((o=(s=so().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=so().gapi)!=null&&l.load)n();else{const c=OY("iframefcb");return so()[c]=()=>{gapi.load?n():t(io(i,"network-request-failed"))},DL(`${LY()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw sb=null,e})}let sb=null;function W7(i){return sb=sb||X7(i),sb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K7=new Fy(5e3,15e3),J7="__/auth/iframe",j7="emulator/auth/iframe",Q7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Z7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eX(i){const e=i.config;ke(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Yw(e,j7):`https://${i.config.authDomain}/${J7}`,n={apiKey:e.apiKey,appName:i.name,v:Uy},s=Z7.get(i.config.apiHost);s&&(n.eid=s);const o=i._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Oy(n).slice(1)}`}async function tX(i){const e=await W7(i),t=so().gapi;return ke(t,i,"internal-error"),e.open({where:document.body,url:eX(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Q7,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const l=io(i,"network-request-failed"),c=so().setTimeout(()=>{o(l)},K7.get());function h(){so().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iX=500,sX=600,rX="_blank",oX="http://localhost";class hD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aX(i,e,t,n=iX,s=sX){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...nX,width:n.toString(),height:s.toString(),top:o,left:l},f=vi().toLowerCase();t&&(c=wL(f)?rX:t),EL(f)&&(e=e||oX,h.scrollbars="yes");const g=Object.entries(h).reduce((b,[A,w])=>`${b}${A}=${w},`,"");if(CY(f)&&c!=="_self")return lX(e||"",c),new hD(null);const y=window.open(e||"",c,g);ke(y,i,"popup-blocked");try{y.focus()}catch{}return new hD(y)}function lX(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX="__/auth/handler",uX="emulator/auth/handler",dX=encodeURIComponent("fac");async function fD(i,e,t,n,s,o){ke(i.config.authDomain,i,"auth-domain-config-required"),ke(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Uy,eventId:s};if(e instanceof LL){e.setDefaultLanguage(i.languageCode),l.providerId=e.providerId||"",$$(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries({}))l[g]=y}if(e instanceof Hy){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(l.scopes=g.join(","))}i.tenantId&&(l.tid=i.tenantId);const c=l;for(const g of Object.keys(c))c[g]===void 0&&delete c[g];const h=await i._getAppCheckToken(),f=h?`#${dX}=${encodeURIComponent(h)}`:"";return`${hX(i)}?${Oy(c).slice(1)}${f}`}function hX({config:i}){return i.emulator?Yw(i,uX):`https://${i.authDomain}/${cX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="webStorageSupport";class fX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zL,this._completeRedirectFn=U7,this._overrideRedirectResult=P7}async _openPopup(e,t,n,s){var l;Ca((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await fD(e,t,n,rw(),s);return aX(e,o,jw())}async _openRedirect(e,t,n,s){await this._originValidation(e);const o=await fD(e,t,n,rw(),s);return m7(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Ca(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await tX(e),n=new B7(e);return t.register("authEvent",s=>(ke(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(rE,{type:rE},s=>{var l;const o=(l=s==null?void 0:s[0])==null?void 0:l[rE];o!==void 0&&t(!!o),Sr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=q7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return NL()||TL()||Ww()}}const pX=fX;var pD="@firebase/auth",gD="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mX(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yX(i){wa(new ro("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;ke(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ML(i)},f=new DY(n,s,o,h);return zY(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),wa(new ro("auth-internal",e=>{const t=dd(e.getProvider("auth").getImmediate());return(n=>new gX(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),no(pD,gD,mX(i)),no(pD,gD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vX=300,bX=sL("authIdTokenMaxAge")||vX;let mD=null;const _X=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>bX)return;const s=t==null?void 0:t.token;mD!==s&&(mD=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function SX(i=hL()){const e=op(i,"auth");if(e.isInitialized())return e.getImmediate();const t=GY(i,{popupRedirectResolver:pX,persistence:[w7,f7,zL]}),n=sL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=_X(o.toString());l7(t,l,()=>l(t.currentUser)),a7(t,c=>l(c))}}const s=M$("auth");return s&&VY(t,`http://${s}`),t}function AX(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}kY({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const o=io("internal-error");o.customData=s,t(o)},n.type="text/javascript",n.charset="UTF-8",AX().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yX("Browser");var EX="firebase",TX="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */no(EX,TX,"app");const KL="@firebase/installations",Zw="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL=1e4,jL=`w:${Zw}`,QL="FIS_v2",wX="https://firebaseinstallations.googleapis.com/v1",CX=3600*1e3,xX="installations",RX="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IX={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},rd=new ud(xX,RX,IX);function ZL(i){return i instanceof co&&i.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eO({projectId:i}){return`${wX}/projects/${i}/installations`}function tO(i){return{token:i.token,requestStatus:2,expiresIn:MX(i.expiresIn),creationTime:Date.now()}}async function nO(i,e){const n=(await e.json()).error;return rd.create("request-failed",{requestName:i,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function iO({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function NX(i,{refreshToken:e}){const t=iO(i);return t.append("Authorization",DX(e)),t}async function sO(i){const e=await i();return e.status>=500&&e.status<600?i():e}function MX(i){return Number(i.replace("s","000"))}function DX(i){return`${QL} ${i}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kX({appConfig:i,heartbeatServiceProvider:e},{fid:t}){const n=eO(i),s=iO(i),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={fid:t,authVersion:QL,appId:i.appId,sdkVersion:jL},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await sO(()=>fetch(n,c));if(h.ok){const f=await h.json();return{fid:f.fid||t,registrationStatus:2,refreshToken:f.refreshToken,authToken:tO(f.authToken)}}else throw await nO("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PX(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LX=/^[cdef][\w-]{21}$/,cw="";function OX(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const t=UX(i);return LX.test(t)?t:cw}catch{return cw}}function UX(i){return PX(i).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(i){return`${i.appName}!${i.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=new Map;function aO(i,e){const t=b_(i);lO(t,e),FX(t,e)}function lO(i,e){const t=oO.get(i);if(t)for(const n of t)n(e)}function FX(i,e){const t=BX();t&&t.postMessage({key:i,fid:e}),HX()}let Gc=null;function BX(){return!Gc&&"BroadcastChannel"in self&&(Gc=new BroadcastChannel("[Firebase] FID Change"),Gc.onmessage=i=>{lO(i.data.key,i.data.fid)}),Gc}function HX(){oO.size===0&&Gc&&(Gc.close(),Gc=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GX="firebase-installations-database",zX=1,od="firebase-installations-store";let oE=null;function eC(){return oE||(oE=uL(GX,zX,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(od)}}})),oE}async function Mb(i,e){const t=b_(i),s=(await eC()).transaction(od,"readwrite"),o=s.objectStore(od),l=await o.get(t);return await o.put(e,t),await s.done,(!l||l.fid!==e.fid)&&aO(i,e.fid),e}async function cO(i){const e=b_(i),n=(await eC()).transaction(od,"readwrite");await n.objectStore(od).delete(e),await n.done}async function __(i,e){const t=b_(i),s=(await eC()).transaction(od,"readwrite"),o=s.objectStore(od),l=await o.get(t),c=e(l);return c===void 0?await o.delete(t):await o.put(c,t),await s.done,c&&(!l||l.fid!==c.fid)&&aO(i,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tC(i){let e;const t=await __(i.appConfig,n=>{const s=VX(n),o=qX(i,s);return e=o.registrationPromise,o.installationEntry});return t.fid===cw?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function VX(i){const e=i||{fid:OX(),registrationStatus:0};return uO(e)}function qX(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(rd.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=$X(i,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:YX(i)}:{installationEntry:e}}async function $X(i,e){try{const t=await kX(i,e);return Mb(i.appConfig,t)}catch(t){throw ZL(t)&&t.customData.serverCode===409?await cO(i.appConfig):await Mb(i.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function YX(i){let e=await yD(i.appConfig);for(;e.registrationStatus===1;)await rO(100),e=await yD(i.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await tC(i);return n||t}return e}function yD(i){return __(i,e=>{if(!e)throw rd.create("installation-not-found");return uO(e)})}function uO(i){return XX(i)?{fid:i.fid,registrationStatus:0}:i}function XX(i){return i.registrationStatus===1&&i.registrationTime+JL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WX({appConfig:i,heartbeatServiceProvider:e},t){const n=KX(i,t),s=NX(i,t),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={installation:{sdkVersion:jL,appId:i.appId}},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await sO(()=>fetch(n,c));if(h.ok){const f=await h.json();return tO(f)}else throw await nO("Generate Auth Token",h)}function KX(i,{fid:e}){return`${eO(i)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(i,e=!1){let t;const n=await __(i.appConfig,o=>{if(!dO(o))throw rd.create("not-registered");const l=o.authToken;if(!e&&QX(l))return o;if(l.requestStatus===1)return t=JX(i,e),o;{if(!navigator.onLine)throw rd.create("app-offline");const c=eW(o);return t=jX(i,c),c}});return t?await t:n.authToken}async function JX(i,e){let t=await vD(i.appConfig);for(;t.authToken.requestStatus===1;)await rO(100),t=await vD(i.appConfig);const n=t.authToken;return n.requestStatus===0?nC(i,e):n}function vD(i){return __(i,e=>{if(!dO(e))throw rd.create("not-registered");const t=e.authToken;return tW(t)?{...e,authToken:{requestStatus:0}}:e})}async function jX(i,e){try{const t=await WX(i,e),n={...e,authToken:t};return await Mb(i.appConfig,n),t}catch(t){if(ZL(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await cO(i.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Mb(i.appConfig,n)}throw t}}function dO(i){return i!==void 0&&i.registrationStatus===2}function QX(i){return i.requestStatus===2&&!ZX(i)}function ZX(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+CX}function eW(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function tW(i){return i.requestStatus===1&&i.requestTime+JL<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nW(i){const e=i,{installationEntry:t,registrationPromise:n}=await tC(e);return n?n.catch(console.error):nC(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iW(i,e=!1){const t=i;return await sW(t),(await nC(t,e)).token}async function sW(i){const{registrationPromise:e}=await tC(i);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rW(i){if(!i||!i.options)throw aE("App Configuration");if(!i.name)throw aE("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!i.options[t])throw aE(t);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function aE(i){return rd.create("missing-app-config-values",{valueName:i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO="installations",oW="installations-internal",aW=i=>{const e=i.getProvider("app").getImmediate(),t=rW(e),n=op(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},lW=i=>{const e=i.getProvider("app").getImmediate(),t=op(e,hO).getImmediate();return{getId:()=>nW(t),getToken:s=>iW(t,s)}};function cW(){wa(new ro(hO,aW,"PUBLIC")),wa(new ro(oW,lW,"PRIVATE"))}cW();no(KL,Zw);no(KL,Zw,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db="analytics",uW="firebase_id",dW="origin",hW=60*1e3,fW="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",iC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new Vw("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ms=new ud("analytics","Analytics",pW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gW(i){if(!i.startsWith(iC)){const e=ms.create("invalid-gtag-resource",{gtagURL:i});return gi.warn(e.message),""}return i}function fO(i){return Promise.all(i.map(e=>e.catch(t=>t)))}function mW(i,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(i,e)),t}function yW(i,e){const t=mW("firebase-js-sdk-policy",{createScriptURL:gW}),n=document.createElement("script"),s=`${iC}?l=${i}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function vW(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function bW(i,e,t,n,s,o){const l=n[s];try{if(l)await e[l];else{const h=(await fO(t)).find(f=>f.measurementId===s);h&&await e[h.appId]}}catch(c){gi.error(c)}i("config",s,o)}async function _W(i,e,t,n,s){try{let o=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const c=await fO(t);for(const h of l){const f=c.find(y=>y.measurementId===h),g=f&&e[f.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),i("event",n,s||{})}catch(o){gi.error(o)}}function SW(i,e,t,n){async function s(o,...l){try{if(o==="event"){const[c,h]=l;await _W(i,e,t,c,h)}else if(o==="config"){const[c,h]=l;await bW(i,e,t,n,c,h)}else if(o==="consent"){const[c,h]=l;i("consent",c,h)}else if(o==="get"){const[c,h,f]=l;i("get",c,h,f)}else if(o==="set"){const[c]=l;i("set",c)}else i(o,...l)}catch(c){gi.error(c)}}return s}function AW(i,e,t,n,s){let o=function(...l){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=SW(o,i,e,t),{gtagCore:o,wrappedGtag:window[s]}}function EW(i){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(iC)&&t.src.includes(i))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=30,wW=1e3;class CW{constructor(e={},t=wW){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const pO=new CW;function xW(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function RW(i){var l;const{appId:e,apiKey:t}=i,n={method:"GET",headers:xW(t)},s=fW.replace("{app-id}",e),o=await fetch(s,n);if(o.status!==200&&o.status!==304){let c="";try{const h=await o.json();(l=h.error)!=null&&l.message&&(c=h.error.message)}catch{}throw ms.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}async function IW(i,e=pO,t){const{appId:n,apiKey:s,measurementId:o}=i.options;if(!n)throw ms.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:n};throw ms.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new DW;return setTimeout(async()=>{c.abort()},hW),gO({appId:n,apiKey:s,measurementId:o},l,c,e)}async function gO(i,{throttleEndTimeMillis:e,backoffCount:t},n,s=pO){var c;const{appId:o,measurementId:l}=i;try{await NW(n,e)}catch(h){if(l)return gi.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:l};throw h}try{const h=await RW(i);return s.deleteThrottleMetadata(o),h}catch(h){const f=h;if(!MW(f)){if(s.deleteThrottleMetadata(o),l)return gi.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:o,measurementId:l};throw h}const g=Number((c=f==null?void 0:f.customData)==null?void 0:c.httpStatus)===503?VM(t,s.intervalMillis,TW):VM(t,s.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return s.setThrottleMetadata(o,y),gi.debug(`Calling attemptFetch again in ${g} millis`),gO(i,y,n,s)}}function NW(i,e){return new Promise((t,n)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);i.addEventListener(()=>{clearTimeout(o),n(ms.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function MW(i){if(!(i instanceof co)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class DW{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function kW(i,e,t,n,s){if(s&&s.global){i("event",t,n);return}else{const o=await e,l={...n,send_to:o};i("event",t,l)}}async function PW(i,e,t,n){if(n&&n.global){const s={};for(const o of Object.keys(t))s[`user_properties.${o}`]=t[o];return i("set",s),Promise.resolve()}else{const s=await e;i("config",s,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LW(){if(oL())try{await aL()}catch(i){return gi.warn(ms.create("indexeddb-unavailable",{errorInfo:i==null?void 0:i.toString()}).message),!1}else return gi.warn(ms.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function OW(i,e,t,n,s,o,l){const c=IW(i);c.then(b=>{t[b.measurementId]=b.appId,i.options.measurementId&&b.measurementId!==i.options.measurementId&&gi.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>gi.error(b)),e.push(c);const h=LW().then(b=>{if(b)return n.getId()}),[f,g]=await Promise.all([c,h]);EW(o)||yW(o,f.measurementId),s("js",new Date);const y=(l==null?void 0:l.config)??{};return y[dW]="firebase",y.update=!0,g!=null&&(y[uW]=g),s("config",f.measurementId,y),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(e){this.app=e}_delete(){return delete Eh[this.app.options.appId],Promise.resolve()}}let Eh={},bD=[];const _D={};let lE="dataLayer",FW="gtag",SD,sC,AD=!1;function BW(){const i=[];if(rL()&&i.push("This is a browser extension environment."),G$()||i.push("Cookies are not available."),i.length>0){const e=i.map((n,s)=>`(${s+1}) ${n}`).join(" "),t=ms.create("invalid-analytics-context",{errorInfo:e});gi.warn(t.message)}}function HW(i,e,t){BW();const n=i.options.appId;if(!n)throw ms.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)gi.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ms.create("no-api-key");if(Eh[n]!=null)throw ms.create("already-exists",{id:n});if(!AD){vW(lE);const{wrappedGtag:o,gtagCore:l}=AW(Eh,bD,_D,lE,FW);sC=o,SD=l,AD=!0}return Eh[n]=OW(i,bD,_D,e,SD,lE,t),new UW(i)}function GW(i=hL()){i=bs(i);const e=op(i,Db);return e.isInitialized()?e.getImmediate():zW(i)}function zW(i,e={}){const t=op(i,Db);if(t.isInitialized()){const s=t.getImmediate();if(nd(e,t.getOptions()))return s;throw ms.create("already-initialized")}return t.initialize({options:e})}function VW(i,e,t){i=bs(i),PW(sC,Eh[i.app.options.appId],e,t).catch(n=>gi.error(n))}function qW(i,e,t,n){i=bs(i),kW(sC,Eh[i.app.options.appId],e,t,n).catch(s=>gi.error(s))}const ED="@firebase/analytics",TD="0.10.19";function $W(){wa(new ro(Db,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return HW(n,s,t)},"PUBLIC")),wa(new ro("analytics-internal",i,"PRIVATE")),no(ED,TD),no(ED,TD,"esm2020");function i(e){try{const t=e.getProvider(Db).getImmediate();return{logEvent:(n,s,o)=>qW(t,n,s,o),setUserProperties:(n,s)=>VW(t,n,s)}}catch(t){throw ms.create("interop-component-reg-failed",{reason:t})}}}$W();const YW={apiKey:"AIzaSyDGAI-Y0jWMkkTwVa3pWRYTRnIjeR5IgDo",authDomain:"suitcase-e579b.firebaseapp.com",projectId:"suitcase-e579b",storageBucket:"suitcase-e579b.firebasestorage.app",messagingSenderId:"535507830039",appId:"1:535507830039:web:1380d5f29396b0a614e352",measurementId:"G-1E9GL03TX0"},mO=dL(YW);GW(mO);const kg=SX(mO),rb=i=>({id:i.uid,email:i.email||"",name:i.displayName||"Traveler"}),uw={signup:async(i,e,t)=>{try{const n=await i7(kg,e,t);return await o7(n.user,{displayName:i}),rb({...n.user,displayName:i})}catch(n){throw console.error("Signup Error:",n),new Error(wD(n.code))}},login:async(i,e)=>{try{const t=await s7(kg,i,e);return rb(t.user)}catch(t){throw console.error("Login Error:",t),new Error(wD(t.code))}},logout:async()=>{try{await u7(kg)}catch(i){console.error("Logout Error",i)}},getCurrentUser:()=>{const i=kg.currentUser;return i?rb(i):null}},wD=i=>{switch(i){case"auth/email-already-in-use":return"That email is already registered.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":return"Invalid email or password.";case"auth/weak-password":return"Password should be at least 6 characters.";default:return"Authentication failed. Please try again."}},XW=({onSuccess:i})=>{const[e,t]=ee.useState(!0),[n,s]=ee.useState(!1),[o,l]=ee.useState(null),[c,h]=ee.useState(""),[f,g]=ee.useState(""),[y,b]=ee.useState(""),A=async w=>{w.preventDefault(),l(null),s(!0);try{let C;if(e)C=await uw.login(f,y);else{if(!c.trim())throw new Error("Name is required");C=await uw.signup(c,f,y)}i(C)}catch(C){l(C.message||"Something went wrong")}finally{s(!1)}};return T.jsxs("div",{className:"min-h-screen bg-white flex flex-col md:flex-row relative",children:[T.jsxs("div",{className:"w-full md:w-1/2 bg-[#F5F5F7] p-8 md:p-12 flex flex-col justify-between relative overflow-hidden h-[30vh] md:h-auto",children:[T.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-tr from-blue-200 to-purple-200 rounded-full blur-[80px] opacity-60 animate-float pointer-events-none"}),T.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[T.jsx("div",{className:"p-2 bg-black text-white rounded-xl",children:T.jsx(ID,{size:24})}),T.jsx("span",{className:"font-serif font-bold text-2xl tracking-tight text-gray-900",children:"Suitcase"})]}),T.jsxs("div",{className:"relative z-10 hidden md:block",children:[T.jsxs("h1",{className:"text-5xl lg:text-7xl font-serif font-bold text-gray-900 mb-6 leading-[1.1]",children:["Pack your ",T.jsx("br",{})," ",T.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"imagination."})]}),T.jsx("p",{className:"text-xl text-gray-500 max-w-md leading-relaxed",children:"Your intelligent travel companion for literary journeys. Discover, read, and collect books with smart insights."})]}),T.jsx("div",{className:"relative z-10 md:hidden mt-4",children:T.jsx("h1",{className:"text-3xl font-serif font-bold text-gray-900",children:"Your literary journey starts here."})}),T.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm font-bold text-gray-400 uppercase tracking-widest",children:[T.jsx(gs,{size:16,className:"text-yellow-500"}),T.jsx("span",{children:"Next Gen Library"})]})]}),T.jsx("div",{className:"w-full md:w-1/2 p-8 md:p-20 flex flex-col justify-center bg-white -mt-6 md:mt-0 rounded-t-[2rem] md:rounded-none shadow-[0_-10px_40px_-10px_rgba(0,0,0,0.1)] md:shadow-none z-20",children:T.jsxs("div",{className:"max-w-md w-full mx-auto",children:[T.jsxs("div",{className:"mb-8",children:[T.jsx("h2",{className:"text-3xl font-serif font-bold text-gray-900 mb-2",children:e?"Welcome back":"Create account"}),T.jsx("p",{className:"text-gray-500",children:e?"Enter your details to access your library.":"Start building your digital suitcase today."})]}),o&&T.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-xl flex items-center gap-2 text-sm font-medium animate-in slide-in-from-top-2",children:[T.jsx(fB,{size:16}),o]}),T.jsxs("form",{onSubmit:A,className:"space-y-4",children:[!e&&T.jsxs("div",{className:"space-y-1 animate-in fade-in slide-in-from-bottom-2",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Full Name"}),T.jsx("input",{type:"text",value:c,onChange:w=>h(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"Ernest Hemingway"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Email Address"}),T.jsx("input",{type:"email",value:f,onChange:w=>g(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"reader@example.com"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Password"}),T.jsx("input",{type:"password",value:y,onChange:w=>b(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"",autoComplete:"current-password"})]}),T.jsx("button",{type:"submit",disabled:n,className:"w-full bg-black text-white py-5 rounded-2xl font-bold text-lg hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 mt-4 shadow-xl shadow-gray-200",children:n?T.jsx(sc,{className:"animate-spin"}):T.jsxs(T.Fragment,{children:[e?"Sign In":"Create Account"," ",T.jsx(fw,{size:20})]})})]}),T.jsx("div",{className:"mt-8 text-center",children:T.jsx("button",{onClick:()=>{t(!e),l(null)},className:"text-sm font-semibold text-gray-500 hover:text-black transition-colors",children:e?"New to Suitcase? Create an account":"Already have an account? Log in"})})]})}),T.jsx("div",{className:"absolute bottom-4 right-8 z-30 hidden md:block",children:T.jsxs("p",{className:"text-xs font-medium text-gray-400 flex items-center gap-1",children:["Crafted with ",T.jsx(CB,{size:10,className:"fill-red-400 text-red-400"})," by Yashraj Pardeshi (@incyashraj)"]})})]})},va=(i,e)=>`suitcase_${i}_${e}`,WW=(i,e)=>{try{localStorage.setItem(va(i,"prefs"),JSON.stringify(e))}catch(t){console.error("Failed to save prefs",t)}},KW=i=>{try{const e=localStorage.getItem(va(i,"prefs"));return e?JSON.parse(e):null}catch{return null}},JW=(i,e)=>{try{const t=e.map(n=>({...n,fileUrl:n.isLocal?void 0:n.fileUrl}));localStorage.setItem(va(i,"library"),JSON.stringify(t))}catch(t){console.error("Failed to save library",t)}},jW=i=>{try{const e=localStorage.getItem(va(i,"library"));return e?JSON.parse(e):[]}catch{return[]}},QW=(i,e)=>{try{localStorage.setItem(va(i,"wallet"),JSON.stringify(e))}catch(t){console.error("Failed to save wallet",t)}},ZW=i=>{try{const e=localStorage.getItem(va(i,"wallet"));return e?JSON.parse(e):{balance:0,nfts:[]}}catch{return{balance:0,nfts:[]}}},eK=i=>{localStorage.removeItem(va(i,"prefs")),localStorage.removeItem(va(i,"library")),localStorage.removeItem(va(i,"wallet")),window.location.reload()};function tK(){const[i,e]=ee.useState(null),[t,n]=ee.useState("auth"),[s,o]=ee.useState(null),[l,c]=ee.useState([]),[h,f]=ee.useState(null),[g,y]=ee.useState({balance:0,nfts:[]}),[b,A]=ee.useState(!1),[w,C]=ee.useState([]),[N,I]=ee.useState([]),[P,k]=ee.useState([]),[L,O]=ee.useState(""),[U,F]=ee.useState(""),[K,q]=ee.useState(!1),[Q,Z]=ee.useState(!1),[oe,ce]=ee.useState("library"),[ue,pe]=ee.useState(!1),[G,$]=ee.useState(!1),ae=ee.useRef(null),Se=ee.useRef(null),Ie=ee.useRef(null);ee.useEffect(()=>{const ne=c7(kg,xe=>{if(xe){const Ee=rb(xe);e(Ee),H(Ee.id)}else e(null),n("auth"),A(!0)});return()=>ne()},[]);const H=ne=>{const xe=KW(ne),Ee=jW(ne),An=ZW(ne);f(xe),c(Ee),y(An),A(!0),xe?(n("library"),VA(xe).then(As=>{As&&As.length>0&&I(As)})):n("onboarding")};ee.useEffect(()=>{i&&b&&h&&WW(i.id,h)},[h,b,i]),ee.useEffect(()=>{i&&b&&JW(i.id,l)},[l,b,i]),ee.useEffect(()=>{i&&b&&QW(i.id,g)},[g,b,i]),ee.useEffect(()=>{oe==="search"&&Se.current&&Se.current.focus()},[oe]),ee.useEffect(()=>{var ne;oe==="mood"&&((ne=Ie.current)==null||ne.scrollIntoView({behavior:"smooth"}))},[P,oe]);const J=()=>{const ne=new Date().getHours();return ne<12?"Good morning":ne<18?"Good afternoon":"Good evening"},se=ne=>{e(ne),H(ne.id)},de=async()=>{await uw.logout(),f(null),c([]),y({balance:0,nfts:[]})},ve=ne=>{var Ee;const xe=(Ee=ne.target.files)==null?void 0:Ee[0];xe&&xe.type==="application/pdf"&&Qe(xe)},Re=ne=>{ne.preventDefault(),ne.stopPropagation(),pe(!0)},Ae=ne=>{ne.preventDefault(),ne.stopPropagation(),!ne.currentTarget.contains(ne.relatedTarget)&&pe(!1)},ft=ne=>{ne.preventDefault(),ne.stopPropagation(),pe(!1);const xe=ne.dataTransfer.files;xe&&xe.length>0&&xe[0].type==="application/pdf"&&Qe(xe[0])},Qe=ne=>{const xe={id:`local-${Date.now()}`,title:ne.name.replace(".pdf",""),author:"My Document",description:"Imported PDF document from local device.",coverColor:qt(),fileUrl:URL.createObjectURL(ne),isLocal:!0,categories:["Uploads"],publishedYear:new Date().getFullYear().toString()};c(Ee=>[xe,...Ee]),oe!=="library"&&ce("library")},qt=()=>{const ne=["#e0f2fe","#f0fdf4","#fdf4ff","#fff1f2","#fefce8"];return ne[Math.floor(Math.random()*ne.length)]},Xe=async ne=>{if(ne.preventDefault(),!U.trim())return;q(!0),C([]),Z(!1);const xe=await MV(U);C(xe),Z(!0),q(!1)},Pn=async ne=>{if(ne.preventDefault(),!L.trim())return;const xe=L;O(""),q(!0),k(Ui=>[...Ui,{role:"user",text:xe}]);const Ee=P.map(Ui=>({role:Ui.role,text:Ui.text})),{reply:An,suggestions:As}=await DV(xe,Ee);k(Ui=>[...Ui,{role:"model",text:An,books:As}]),q(!1)},ct=async ne=>{$(!0),f(ne),y({balance:100,nfts:[]});const xe=new Promise(Ui=>setTimeout(Ui,2500)),Ee=VA(ne),[An,As]=await Promise.all([xe,Ee]);I(As),$(!1),n("library")},We=()=>{y(ne=>({...ne,balance:ne.balance+50,nfts:[...ne.nfts,(s==null?void 0:s.id)||"unknown"]}))},pt=(ne,xe)=>{c(Ee=>Ee.map(An=>An.id===ne?{...An,...xe}:An)),s&&s.id===ne&&o(Ee=>Ee?{...Ee,...xe}:null)},Kt=ne=>{f(ne),VA(ne).then(I)},Bt=()=>{i&&(eK(i.id),de())},_s=ne=>{const xe=l.find(Ee=>Ee.id===ne.id);o(xe||ne),n("details")},Oi=ne=>{const xe=l.find(Ee=>Ee.id===ne.id);if(xe)o(xe);else{const Ee={...ne,lastReadDate:Date.now()};c(An=>[Ee,...An]),o(Ee)}n("reader")},Ss=()=>{n("library"),o(null)},Te=({icon:ne,label:xe,isActive:Ee,onClick:An})=>T.jsxs("button",{onClick:An,className:"group relative flex flex-col items-center justify-center w-12 h-12 rounded-full dock-icon-transition hover:scale-125 hover:-translate-y-2",children:[T.jsx("div",{className:`p-2.5 rounded-full transition-colors duration-300 ${Ee?"bg-blue-50 text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:T.jsx(ne,{size:26,strokeWidth:Ee?2.5:2})}),T.jsx("span",{className:`absolute -bottom-1 w-1.5 h-1.5 rounded-full bg-blue-600 transition-transform duration-300 ${Ee?"scale-100":"scale-0"}`})]});return!b&&t!=="auth"?T.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F5F5F7]",children:T.jsx(sc,{className:"animate-spin text-gray-400"})}):t==="auth"?T.jsx(XW,{onSuccess:se}):t==="onboarding"?T.jsx(_$,{onComplete:ct}):G?T.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#F5F5F7] animate-in fade-in duration-500",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-0 bg-blue-100 rounded-full blur-xl animate-pulse"}),T.jsx(ma,{size:64,className:"relative text-blue-600 mb-6 animate-bounce"})]}),T.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 mb-2",children:"Curating your Suitcase..."}),T.jsx("p",{className:"text-gray-500",children:"Finding books that match your vibe."})]}):T.jsxs("div",{className:"min-h-screen flex flex-col bg-[#F5F5F7] selection:bg-blue-100 overflow-x-hidden relative",onDragOver:Re,onDragLeave:Ae,onDrop:ft,children:[ue&&T.jsx("div",{className:"fixed inset-0 z-[100] bg-blue-500/10 backdrop-blur-sm border-4 border-blue-500 border-dashed m-4 rounded-[3rem] flex items-center justify-center pointer-events-none animate-in fade-in duration-200",children:T.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-2xl flex flex-col items-center",children:[T.jsx(AI,{size:48,className:"text-blue-500 mb-4 animate-bounce"}),T.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Drop PDF to Upload"})]})}),T.jsxs("div",{className:"fixed top-0 left-0 right-0 z-30 px-6 py-4 flex justify-between items-center pointer-events-none",children:[T.jsxs("div",{className:"flex items-center gap-2 mix-blend-multiply opacity-50",children:[T.jsx(ID,{size:20,className:"text-gray-900"}),T.jsx("span",{className:"font-serif font-bold text-xl tracking-tight text-gray-900 hidden sm:block",children:"Suitcase"})]}),T.jsxs("div",{className:"pointer-events-auto flex items-center gap-3",children:[T.jsx("button",{onClick:de,className:"bg-white/60 backdrop-blur-md p-2 rounded-full shadow-sm border border-white/50 text-gray-500 hover:text-red-500 transition-colors",children:T.jsx(MD,{size:16})}),T.jsxs("div",{onClick:()=>{ce("library"),n("profile")},className:"bg-white/60 backdrop-blur-md px-4 py-2 rounded-full shadow-sm border border-white/50 flex items-center gap-2 hover:scale-105 transition-transform cursor-pointer",children:[T.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-tr from-yellow-400 to-yellow-600 flex items-center justify-center shadow-sm",children:T.jsx("span",{className:"text-[10px] font-bold text-white",children:"$"})}),T.jsx("span",{className:"text-sm font-bold text-gray-800",children:g.balance})]})]})]}),T.jsx("input",{type:"file",ref:ae,className:"hidden",accept:"application/pdf",onChange:ve}),T.jsxs("main",{className:"flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-36 w-full",children:[t==="profile"&&h&&T.jsx(A$,{userPrefs:h,wallet:g,library:l,onClose:()=>n("library"),onUpdateProfile:Kt,onReset:Bt}),t==="library"&&oe==="mood"&&h&&T.jsxs("div",{className:"max-w-4xl mx-auto h-[calc(100vh-140px)] flex flex-col",children:[P.length===0?T.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-spring pb-20",children:[T.jsx("div",{className:"animate-float inline-flex items-center justify-center w-20 h-20 bg-gradient-to-tr from-blue-100 to-purple-100 rounded-full mb-6 shadow-xl shadow-blue-100/50",children:T.jsx(gs,{size:32,className:"text-blue-500"})}),T.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-bold text-gray-900 mb-4 tracking-tight",children:"How are you feeling?"}),T.jsx("p",{className:"text-gray-500 text-lg max-w-md mb-8",children:"Tell me your mood, or what you're curious about, and I'll curate a selection just for you."})]}):T.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 pb-24 px-4 scroll-smooth",children:[P.map((ne,xe)=>T.jsxs("div",{className:`flex flex-col ${ne.role==="user"?"items-end":"items-start"} animate-in fade-in slide-in-from-bottom-2`,children:[T.jsx("div",{className:`max-w-[85%] md:max-w-[70%] p-5 rounded-[1.5rem] text-base leading-relaxed shadow-sm ${ne.role==="user"?"bg-black text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-100"}`,children:ne.text}),ne.books&&ne.books.length>0&&T.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-4 w-full",children:ne.books.map(Ee=>T.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-500",children:T.jsx(sv,{book:Ee,onClick:()=>_s(Ee),onRead:An=>{An.stopPropagation(),Oi(Ee)}})},Ee.id))})]},xe)),K&&T.jsx("div",{className:"flex justify-start",children:T.jsxs("div",{className:"bg-white border border-gray-100 p-4 rounded-[1.5rem] rounded-bl-none shadow-sm flex gap-2 items-center text-gray-400",children:[T.jsx(gs,{size:16,className:"animate-pulse"}),T.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Suitcase is thinking..."})]})}),T.jsx("div",{ref:Ie})]}),T.jsx("div",{className:`${P.length===0?"relative mb-10":"fixed bottom-24 left-4 right-4 max-w-4xl mx-auto z-40"}`,children:T.jsxs("form",{onSubmit:Pn,className:"relative group",children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full blur-xl opacity-20 group-hover:opacity-40 transition-opacity"}),T.jsx("input",{type:"text",placeholder:"I want a mystery set in Paris...",className:"w-full relative bg-white/90 backdrop-blur-xl border border-white/60 p-5 pl-8 pr-16 rounded-full text-lg text-gray-900 placeholder:text-gray-400 outline-none shadow-[0_8px_30px_rgb(0,0,0,0.06)] focus:shadow-[0_12px_40px_rgb(0,0,0,0.1)] transition-all duration-300 font-medium",value:L,onChange:ne=>O(ne.target.value),autoFocus:P.length===0}),T.jsx("button",{type:"submit",disabled:!L.trim()||K,className:"absolute right-2 top-2 bottom-2 aspect-square bg-black text-white rounded-full flex items-center justify-center hover:scale-105 transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:K?T.jsx(sc,{size:18,className:"animate-spin"}):P.length===0?T.jsx(fw,{size:20}):T.jsx(pw,{size:18})})]})})]}),t==="library"&&oe==="search"&&T.jsxs("div",{className:"max-w-6xl mx-auto animate-spring mt-8",children:[T.jsx("div",{className:"mb-8 max-w-2xl mx-auto relative px-4",children:T.jsxs("div",{className:"relative",children:[T.jsx(hE,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-gray-400 w-6 h-6"}),T.jsx("form",{onSubmit:Xe,children:T.jsx("input",{ref:Se,type:"text",placeholder:"Search for books, authors...",className:"w-full pl-16 pr-6 py-5 bg-white/90 backdrop-blur-xl border border-white/50 rounded-3xl text-2xl text-gray-900 placeholder:text-gray-300 outline-none shadow-2xl shadow-gray-200/50 transition-all duration-300 font-serif",value:U,onChange:ne=>F(ne.target.value)})}),U&&T.jsx("button",{onClick:()=>{F(""),C([]),Z(!1)},className:"absolute right-6 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-full text-gray-400 transition-colors",children:T.jsx(ph,{size:16})})]})}),K?T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6 opacity-50 pointer-events-none",children:[1,2,3,4,5].map(ne=>T.jsx("div",{className:"aspect-[2/3] bg-white rounded-2xl animate-pulse"},ne))}):T.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:Q&&w.length===0?T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-60",children:[T.jsx(bB,{size:64,className:"text-gray-300 mb-4"}),T.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"No books found"}),T.jsx("p",{className:"text-gray-500",children:"Try checking the spelling or use different keywords."})]}):w.length>0&&T.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6",children:w.map(ne=>T.jsx(sv,{book:ne,onClick:()=>_s(ne),onRead:()=>Oi(ne)},ne.id))})})]}),t==="library"&&oe==="library"&&T.jsxs("div",{className:"animate-in fade-in duration-500 space-y-12",children:[T.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[T.jsxs("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-gray-900",children:[J(),", ",(i==null?void 0:i.name.split(" ")[0])||"Traveler","."]}),T.jsx("p",{className:"text-gray-500",children:"Ready to continue your journey?"})]}),N.length>0&&T.jsxs("section",{children:[T.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx(gs,{size:18,className:"text-blue-500"}),T.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"For You"})]}),T.jsxs("button",{className:"text-xs font-bold text-gray-400 hover:text-gray-900 flex items-center gap-1",children:["View All ",T.jsx(uE,{size:12})]})]}),T.jsx("div",{className:"flex gap-6 overflow-x-auto pb-8 -mx-4 px-4 scrollbar-hide snap-x snap-mandatory",children:N.map(ne=>T.jsx("div",{className:"min-w-[160px] md:min-w-[180px] snap-start",children:T.jsx(sv,{book:ne,onClick:()=>_s(ne),onRead:()=>Oi(ne)})},ne.id))})]}),T.jsxs("section",{children:[T.jsxs("div",{className:"flex items-end justify-between mb-6 px-2 border-b border-gray-200 pb-2",children:[T.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Your Suitcase"}),T.jsxs("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest bg-white px-2 py-1 rounded-md border border-gray-100",children:[l.length," Items"]})]}),l.length===0?T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 rounded-3xl transition-all cursor-pointer group bg-white border border-gray-100 hover:border-blue-200 hover:shadow-lg",onClick:()=>{var ne;return(ne=ae.current)==null?void 0:ne.click()},children:[T.jsx("div",{className:"relative mb-4",children:T.jsx("div",{className:"animate-float relative bg-blue-50 w-20 h-20 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:T.jsx(AI,{className:"text-blue-600 w-8 h-8"})})}),T.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"It's empty here"}),T.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Upload a PDF to start reading."}),T.jsx("button",{className:"bg-black text-white px-6 py-2 rounded-full text-sm font-bold",children:"Import Book"})]}):T.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-x-6 gap-y-10",children:[T.jsxs("button",{onClick:()=>{var ne;return(ne=ae.current)==null?void 0:ne.click()},className:"aspect-[2/3] rounded-2xl bg-gray-100 border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 transition-all group flex flex-col items-center justify-center gap-3",children:[T.jsx("div",{className:"w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center text-gray-400 group-hover:text-blue-500 transition-colors",children:T.jsx(qB,{size:24})}),T.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-blue-600 uppercase tracking-wide",children:"Add Book"})]}),l.map(ne=>T.jsx(sv,{book:ne,onClick:()=>_s(ne),onRead:()=>Oi(ne)},ne.id))]})]})]})]}),t!=="reader"&&T.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-40 animate-in slide-in-from-bottom-24 duration-1000 ease-out",children:T.jsxs("div",{className:"glass-panel flex items-center gap-2 p-2 px-4 rounded-full shadow-[0_25px_60px_-15px_rgba(0,0,0,0.15)] ring-1 ring-white/60 bg-white/80 backdrop-blur-xl",children:[T.jsx(Te,{icon:NB,label:"Library",isActive:t==="library"&&oe==="library",onClick:()=>{n("library"),ce("library")}}),T.jsx(Te,{icon:gs,label:"Concierge",isActive:t==="library"&&oe==="mood",onClick:()=>{n("library"),ce("mood")}}),T.jsx(Te,{icon:hE,label:"Search",isActive:t==="library"&&oe==="search",onClick:()=>{n("library"),ce("search")}}),T.jsx(Te,{icon:kD,label:"Profile",isActive:t==="profile",onClick:()=>{n("profile")}})]})}),t==="details"&&s&&T.jsx(BV,{book:s,onClose:Ss,onRead:()=>Oi(s)}),t==="reader"&&s&&T.jsx("div",{className:"fixed inset-0 z-50",children:T.jsx(y$,{book:s,onClose:Ss,onReward:We,onUpdateBookData:pt})})]})}const yO=document.getElementById("root");if(!yO)throw new Error("Could not find root element to mount to");const nK=WF.createRoot(yO);nK.render(T.jsx(HF.StrictMode,{children:T.jsx(tK,{})}));
