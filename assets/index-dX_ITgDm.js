var jF=Object.defineProperty;var xI=i=>{throw TypeError(i)};var WF=(i,e,t)=>e in i?jF(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var ce=(i,e,t)=>WF(i,typeof e!="symbol"?e+"":e,t),jA=(i,e,t)=>e.has(i)||xI("Cannot "+t);var d=(i,e,t)=>(jA(i,e,"read from private field"),t?t.call(i):e.get(i)),R=(i,e,t)=>e.has(i)?xI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),T=(i,e,t,n)=>(jA(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),M=(i,e,t)=>(jA(i,e,"access private method"),t);var An=(i,e,t,n)=>({set _(s){T(i,e,s,t)},get _(){return d(i,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function xw(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var WA={exports:{}},fg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CI;function XF(){if(CI)return fg;CI=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:o}}return fg.Fragment=e,fg.jsx=t,fg.jsxs=t,fg}var RI;function KF(){return RI||(RI=1,WA.exports=XF()),WA.exports}var E=KF(),XA={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var II;function JF(){if(II)return Oe;II=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),b=Symbol.iterator;function A(H){return H===null||typeof H!="object"?null:(H=b&&H[b]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,N={};function I(H,K,re){this.props=H,this.context=K,this.refs=N,this.updater=re||w}I.prototype.isReactComponent={},I.prototype.setState=function(H,K){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,K,"setState")},I.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function P(){}P.prototype=I.prototype;function k(H,K,re){this.props=H,this.context=K,this.refs=N,this.updater=re||w}var L=k.prototype=new P;L.constructor=k,x(L,I.prototype),L.isPureReactComponent=!0;var O=Array.isArray;function F(){}var U={H:null,A:null,T:null,S:null},X=Object.prototype.hasOwnProperty;function q(H,K,re){var de=re.ref;return{$$typeof:i,type:H,key:K,ref:de!==void 0?de:null,props:re}}function Z(H,K){return q(H.type,K,H.props)}function ee(H){return typeof H=="object"&&H!==null&&H.$$typeof===i}function se(H){var K={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(re){return K[re]})}var le=/\/+/g;function ue(H,K){return typeof H=="object"&&H!==null&&H.key!=null?se(""+H.key):K.toString(36)}function ye(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(F,F):(H.status="pending",H.then(function(K){H.status==="pending"&&(H.status="fulfilled",H.value=K)},function(K){H.status==="pending"&&(H.status="rejected",H.reason=K)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,K,re,de,_e){var Se=typeof H;(Se==="undefined"||Se==="boolean")&&(H=null);var Te=!1;if(H===null)Te=!0;else switch(Se){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(H.$$typeof){case i:case e:Te=!0;break;case g:return Te=H._init,G(Te(H._payload),K,re,de,_e)}}if(Te)return _e=_e(H),Te=de===""?"."+ue(H,0):de,O(_e)?(re="",Te!=null&&(re=Te.replace(le,"$&/")+"/"),G(_e,K,re,"",function(zt){return zt})):_e!=null&&(ee(_e)&&(_e=Z(_e,re+(_e.key==null||H&&H.key===_e.key?"":(""+_e.key).replace(le,"$&/")+"/")+Te)),K.push(_e)),1;Te=0;var Ke=de===""?".":de+":";if(O(H))for(var Ve=0;Ve<H.length;Ve++)de=H[Ve],Se=Ke+ue(de,Ve),Te+=G(de,K,re,Se,_e);else if(Ve=A(H),typeof Ve=="function")for(H=Ve.call(H),Ve=0;!(de=H.next()).done;)de=de.value,Se=Ke+ue(de,Ve++),Te+=G(de,K,re,Se,_e);else if(Se==="object"){if(typeof H.then=="function")return G(ye(H),K,re,de,_e);throw K=String(H),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return Te}function $(H,K,re){if(H==null)return H;var de=[],_e=0;return G(H,de,"","",function(Se){return K.call(re,Se,_e++)}),de}function oe(H){if(H._status===-1){var K=H._result;K=K(),K.then(function(re){(H._status===0||H._status===-1)&&(H._status=1,H._result=re)},function(re){(H._status===0||H._status===-1)&&(H._status=2,H._result=re)}),H._status===-1&&(H._status=0,H._result=K)}if(H._status===1)return H._result.default;throw H._result}var ge=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Me={map:$,forEach:function(H,K,re){$(H,function(){K.apply(this,arguments)},re)},count:function(H){var K=0;return $(H,function(){K++}),K},toArray:function(H){return $(H,function(K){return K})||[]},only:function(H){if(!ee(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Oe.Activity=y,Oe.Children=Me,Oe.Component=I,Oe.Fragment=t,Oe.Profiler=s,Oe.PureComponent=k,Oe.StrictMode=n,Oe.Suspense=h,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(H){return U.H.useMemoCache(H)}},Oe.cache=function(H){return function(){return H.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(H,K,re){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var de=x({},H.props),_e=H.key;if(K!=null)for(Se in K.key!==void 0&&(_e=""+K.key),K)!X.call(K,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&K.ref===void 0||(de[Se]=K[Se]);var Se=arguments.length-2;if(Se===1)de.children=re;else if(1<Se){for(var Te=Array(Se),Ke=0;Ke<Se;Ke++)Te[Ke]=arguments[Ke+2];de.children=Te}return q(H.type,_e,de)},Oe.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:o,_context:H},H},Oe.createElement=function(H,K,re){var de,_e={},Se=null;if(K!=null)for(de in K.key!==void 0&&(Se=""+K.key),K)X.call(K,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(_e[de]=K[de]);var Te=arguments.length-2;if(Te===1)_e.children=re;else if(1<Te){for(var Ke=Array(Te),Ve=0;Ve<Te;Ve++)Ke[Ve]=arguments[Ve+2];_e.children=Ke}if(H&&H.defaultProps)for(de in Te=H.defaultProps,Te)_e[de]===void 0&&(_e[de]=Te[de]);return q(H,Se,_e)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(H){return{$$typeof:c,render:H}},Oe.isValidElement=ee,Oe.lazy=function(H){return{$$typeof:g,_payload:{_status:-1,_result:H},_init:oe}},Oe.memo=function(H,K){return{$$typeof:f,type:H,compare:K===void 0?null:K}},Oe.startTransition=function(H){var K=U.T,re={};U.T=re;try{var de=H(),_e=U.S;_e!==null&&_e(re,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(F,ge)}catch(Se){ge(Se)}finally{K!==null&&re.types!==null&&(K.types=re.types),U.T=K}},Oe.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Oe.use=function(H){return U.H.use(H)},Oe.useActionState=function(H,K,re){return U.H.useActionState(H,K,re)},Oe.useCallback=function(H,K){return U.H.useCallback(H,K)},Oe.useContext=function(H){return U.H.useContext(H)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(H,K){return U.H.useDeferredValue(H,K)},Oe.useEffect=function(H,K){return U.H.useEffect(H,K)},Oe.useEffectEvent=function(H){return U.H.useEffectEvent(H)},Oe.useId=function(){return U.H.useId()},Oe.useImperativeHandle=function(H,K,re){return U.H.useImperativeHandle(H,K,re)},Oe.useInsertionEffect=function(H,K){return U.H.useInsertionEffect(H,K)},Oe.useLayoutEffect=function(H,K){return U.H.useLayoutEffect(H,K)},Oe.useMemo=function(H,K){return U.H.useMemo(H,K)},Oe.useOptimistic=function(H,K){return U.H.useOptimistic(H,K)},Oe.useReducer=function(H,K,re){return U.H.useReducer(H,K,re)},Oe.useRef=function(H){return U.H.useRef(H)},Oe.useState=function(H){return U.H.useState(H)},Oe.useSyncExternalStore=function(H,K,re){return U.H.useSyncExternalStore(H,K,re)},Oe.useTransition=function(){return U.H.useTransition()},Oe.version="19.2.4",Oe}var NI;function Cw(){return NI||(NI=1,XA.exports=JF()),XA.exports}var J=Cw();const QF=xw(J);var KA={exports:{}},pg={},JA={exports:{}},QA={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MI;function ZF(){return MI||(MI=1,(function(i){function e(G,$){var oe=G.length;G.push($);e:for(;0<oe;){var ge=oe-1>>>1,Me=G[ge];if(0<s(Me,$))G[ge]=$,G[oe]=Me,oe=ge;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var $=G[0],oe=G.pop();if(oe!==$){G[0]=oe;e:for(var ge=0,Me=G.length,H=Me>>>1;ge<H;){var K=2*(ge+1)-1,re=G[K],de=K+1,_e=G[de];if(0>s(re,oe))de<Me&&0>s(_e,re)?(G[ge]=_e,G[de]=oe,ge=de):(G[ge]=re,G[K]=oe,ge=K);else if(de<Me&&0>s(_e,oe))G[ge]=_e,G[de]=oe,ge=de;else break e}}return $}function s(G,$){var oe=G.sortIndex-$.sortIndex;return oe!==0?oe:G.id-$.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();i.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,y=null,b=3,A=!1,w=!1,x=!1,N=!1,I=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function L(G){for(var $=t(f);$!==null;){if($.callback===null)n(f);else if($.startTime<=G)n(f),$.sortIndex=$.expirationTime,e(h,$);else break;$=t(f)}}function O(G){if(x=!1,L(G),!w)if(t(h)!==null)w=!0,F||(F=!0,se());else{var $=t(f);$!==null&&ye(O,$.startTime-G)}}var F=!1,U=-1,X=5,q=-1;function Z(){return N?!0:!(i.unstable_now()-q<X)}function ee(){if(N=!1,F){var G=i.unstable_now();q=G;var $=!0;try{e:{w=!1,x&&(x=!1,P(U),U=-1),A=!0;var oe=b;try{t:{for(L(G),y=t(h);y!==null&&!(y.expirationTime>G&&Z());){var ge=y.callback;if(typeof ge=="function"){y.callback=null,b=y.priorityLevel;var Me=ge(y.expirationTime<=G);if(G=i.unstable_now(),typeof Me=="function"){y.callback=Me,L(G),$=!0;break t}y===t(h)&&n(h),L(G)}else n(h);y=t(h)}if(y!==null)$=!0;else{var H=t(f);H!==null&&ye(O,H.startTime-G),$=!1}}break e}finally{y=null,b=oe,A=!1}$=void 0}}finally{$?se():F=!1}}}var se;if(typeof k=="function")se=function(){k(ee)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ue=le.port2;le.port1.onmessage=ee,se=function(){ue.postMessage(null)}}else se=function(){I(ee,0)};function ye(G,$){U=I(function(){G(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(G){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var oe=b;b=$;try{return G()}finally{b=oe}},i.unstable_requestPaint=function(){N=!0},i.unstable_runWithPriority=function(G,$){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var oe=b;b=G;try{return $()}finally{b=oe}},i.unstable_scheduleCallback=function(G,$,oe){var ge=i.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ge+oe:ge):oe=ge,G){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=oe+Me,G={id:g++,callback:$,priorityLevel:G,startTime:oe,expirationTime:Me,sortIndex:-1},oe>ge?(G.sortIndex=oe,e(f,G),t(h)===null&&G===t(f)&&(x?(P(U),U=-1):x=!0,ye(O,oe-ge))):(G.sortIndex=Me,e(h,G),w||A||(w=!0,F||(F=!0,se()))),G},i.unstable_shouldYield=Z,i.unstable_wrapCallback=function(G){var $=b;return function(){var oe=b;b=$;try{return G.apply(this,arguments)}finally{b=oe}}}})(QA)),QA}var DI;function eB(){return DI||(DI=1,JA.exports=ZF()),JA.exports}var ZA={exports:{}},ti={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kI;function tB(){if(kI)return ti;kI=1;var i=Cw();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:h,containerInfo:f,implementation:g}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return ti.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ti.createPortal=function(h,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,g)},ti.flushSync=function(h){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=g,n.d.f()}},ti.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},ti.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},ti.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:y,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},ti.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},ti.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin);n.d.L(h,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},ti.preloadModule=function(h,f){if(typeof h=="string")if(f){var g=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},ti.requestFormReset=function(h){n.d.r(h)},ti.unstable_batchedUpdates=function(h,f){return h(f)},ti.useFormState=function(h,f,g){return l.H.useFormState(h,f,g)},ti.useFormStatus=function(){return l.H.useHostTransitionStatus()},ti.version="19.2.4",ti}var PI;function nB(){if(PI)return ZA.exports;PI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),ZA.exports=tB(),ZA.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LI;function iB(){if(LI)return pg;LI=1;var i=eB(),e=Cw(),t=nB();function n(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,u=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(u=a.return),r=a.return;while(r)}return a.tag===3?u:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function c(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(n(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(n(188));return a!==r?null:r}for(var u=r,p=a;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(p=_.return,p!==null){u=p;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return h(_),r;if(S===p)return h(_),a;S=S.sibling}throw Error(n(188))}if(u.return!==p.return)u=_,p=S;else{for(var C=!1,D=_.child;D;){if(D===u){C=!0,u=_,p=S;break}if(D===p){C=!0,p=_,u=S;break}D=D.sibling}if(!C){for(D=S.child;D;){if(D===u){C=!0,u=S,p=_;break}if(D===p){C=!0,p=S,u=_;break}D=D.sibling}if(!C)throw Error(n(189))}}if(u.alternate!==p)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:a}function g(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=g(r),a!==null)return a;r=r.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),P=Symbol.for("react.consumer"),k=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function se(r){return r===null||typeof r!="object"?null:(r=ee&&r[ee]||r["@@iterator"],typeof r=="function"?r:null)}var le=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===le?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case x:return"Fragment";case I:return"Profiler";case N:return"StrictMode";case O:return"Suspense";case F:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case k:return r.displayName||"Context";case P:return(r._context.displayName||"Context")+".Consumer";case L:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case U:return a=r.displayName||null,a!==null?a:ue(r.type)||"Memo";case X:a=r._payload,r=r._init;try{return ue(r(a))}catch{}}return null}var ye=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},ge=[],Me=-1;function H(r){return{current:r}}function K(r){0>Me||(r.current=ge[Me],ge[Me]=null,Me--)}function re(r,a){Me++,ge[Me]=r.current,r.current=a}var de=H(null),_e=H(null),Se=H(null),Te=H(null);function Ke(r,a){switch(re(Se,a),re(_e,r),re(de,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?XR(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=XR(a),r=KR(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}K(de),re(de,r)}function Ve(){K(de),K(_e),K(Se)}function zt(r){r.memoizedState!==null&&re(Te,r);var a=de.current,u=KR(a,r.type);a!==u&&(re(_e,r),re(de,u))}function We(r){_e.current===r&&(K(de),K(_e)),Te.current===r&&(K(Te),cg._currentValue=oe)}var Fn,at;function Je(r){if(Fn===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);Fn=a&&a[1]||"",at=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fn+r+at}var mt=!1;function Vt(r,a){if(!r||mt)return"";mt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Q){var W=Q}Reflect.construct(r,[],ie)}else{try{ie.call()}catch(Q){W=Q}r.call(ie.prototype)}}else{try{throw Error()}catch(Q){W=Q}(ie=r())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(Q){if(Q&&W&&typeof Q.stack=="string")return[Q.stack,W.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),C=S[0],D=S[1];if(C&&D){var B=C.split(`
`),j=D.split(`
`);for(_=p=0;p<B.length&&!B[p].includes("DetermineComponentFrameRoot");)p++;for(;_<j.length&&!j[_].includes("DetermineComponentFrameRoot");)_++;if(p===B.length||_===j.length)for(p=B.length-1,_=j.length-1;1<=p&&0<=_&&B[p]!==j[_];)_--;for(;1<=p&&0<=_;p--,_--)if(B[p]!==j[_]){if(p!==1||_!==1)do if(p--,_--,0>_||B[p]!==j[_]){var te=`
`+B[p].replace(" at new "," at ");return r.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",r.displayName)),te}while(1<=p&&0<=_);break}}}finally{mt=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?Je(u):""}function Ft(r,a){switch(r.tag){case 26:case 27:case 5:return Je(r.type);case 16:return Je("Lazy");case 13:return r.child!==a&&a!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return Vt(r.type,!1);case 11:return Vt(r.type.render,!1);case 1:return Vt(r.type,!0);case 31:return Je("Activity");default:return""}}function ji(r){try{var a="",u=null;do a+=Ft(r,u),u=r,r=r.return;while(r);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var hi=Object.prototype.hasOwnProperty,Ii=i.unstable_scheduleCallback,Rs=i.unstable_cancelCallback,ae=i.unstable_shouldYield,Be=i.unstable_requestPaint,Ce=i.unstable_now,Wt=i.unstable_getCurrentPriorityLevel,fi=i.unstable_ImmediatePriority,Zn=i.unstable_UserBlockingPriority,fn=i.unstable_NormalPriority,pi=i.unstable_LowPriority,Wi=i.unstable_IdlePriority,Va=i.log,Dr=i.unstable_setDisableYieldValue,qa=null,gi=null;function kr(r){if(typeof Va=="function"&&Dr(r),gi&&typeof gi.setStrictMode=="function")try{gi.setStrictMode(qa,r)}catch{}}var ei=Math.clz32?Math.clz32:L_,P_=Math.log,t0=Math.LN2;function L_(r){return r>>>=0,r===0?32:31-(P_(r)/t0|0)|0}var Td=256,wd=262144,xd=4194304;function _o(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Cd(r,a,u){var p=r.pendingLanes;if(p===0)return 0;var _=0,S=r.suspendedLanes,C=r.pingedLanes;r=r.warmLanes;var D=p&134217727;return D!==0?(p=D&~S,p!==0?_=_o(p):(C&=D,C!==0?_=_o(C):u||(u=D&~r,u!==0&&(_=_o(u))))):(D=p&~S,D!==0?_=_o(D):C!==0?_=_o(C):u||(u=p&~r,u!==0&&(_=_o(u)))),_===0?0:a!==0&&a!==_&&(a&S)===0&&(S=_&-_,u=a&-a,S>=u||S===32&&(u&4194048)!==0)?a:_}function wc(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function O_(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function n0(){var r=xd;return xd<<=1,(xd&62914560)===0&&(xd=4194304),r}function Rd(r){for(var a=[],u=0;31>u;u++)a.push(r);return a}function xc(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function U_(r,a,u,p,_,S){var C=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var D=r.entanglements,B=r.expirationTimes,j=r.hiddenUpdates;for(u=C&~u;0<u;){var te=31-ei(u),ie=1<<te;D[te]=0,B[te]=-1;var W=j[te];if(W!==null)for(j[te]=null,te=0;te<W.length;te++){var Q=W[te];Q!==null&&(Q.lane&=-536870913)}u&=~ie}p!==0&&he(r,p,0),S!==0&&_===0&&r.tag!==0&&(r.suspendedLanes|=S&~(C&~a))}function he(r,a,u){r.pendingLanes|=a,r.suspendedLanes&=~a;var p=31-ei(a);r.entangledLanes|=a,r.entanglements[p]=r.entanglements[p]|1073741824|u&261930}function Xe(r,a){var u=r.entangledLanes|=a;for(r=r.entanglements;u;){var p=31-ei(u),_=1<<p;_&a|r[p]&a&&(r[p]|=a),u&=~_}}function st(r,a){var u=a&-a;return u=(u&42)!==0?1:Zt(u),(u&(r.suspendedLanes|a))!==0?0:u}function Zt(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ir(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Px(){var r=$.p;return r!==0?r:(r=window.event,r===void 0?32:bI(r.type))}function Lx(r,a){var u=$.p;try{return $.p=r,a()}finally{$.p=u}}var $a=Math.random().toString(36).slice(2),Bn="__reactFiber$"+$a,Ni="__reactProps$"+$a,Id="__reactContainer$"+$a,F_="__reactEvents$"+$a,OO="__reactListeners$"+$a,UO="__reactHandles$"+$a,Ox="__reactResources$"+$a,Tp="__reactMarker$"+$a;function B_(r){delete r[Bn],delete r[Ni],delete r[F_],delete r[OO],delete r[UO]}function Nd(r){var a=r[Bn];if(a)return a;for(var u=r.parentNode;u;){if(a=u[Id]||u[Bn]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(r=iI(r);r!==null;){if(u=r[Bn])return u;r=iI(r)}return a}r=u,u=r.parentNode}return null}function Md(r){if(r=r[Bn]||r[Id]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function wp(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(n(33))}function Dd(r){var a=r[Ox];return a||(a=r[Ox]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Cn(r){r[Tp]=!0}var Ux=new Set,Fx={};function Cc(r,a){kd(r,a),kd(r+"Capture",a)}function kd(r,a){for(Fx[r]=a,r=0;r<a.length;r++)Ux.add(a[r])}var FO=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bx={},Hx={};function BO(r){return hi.call(Hx,r)?!0:hi.call(Bx,r)?!1:FO.test(r)?Hx[r]=!0:(Bx[r]=!0,!1)}function i0(r,a,u){if(BO(a))if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+u)}}function s0(r,a,u){if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+u)}}function So(r,a,u,p){if(p===null)r.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(a,u,""+p)}}function Is(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Gx(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function HO(r,a,u){var p=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,S=p.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return _.call(this)},set:function(C){u=""+C,S.call(this,C)}}),Object.defineProperty(r,a,{enumerable:p.enumerable}),{getValue:function(){return u},setValue:function(C){u=""+C},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function H_(r){if(!r._valueTracker){var a=Gx(r)?"checked":"value";r._valueTracker=HO(r,a,""+r[a])}}function zx(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var u=a.getValue(),p="";return r&&(p=Gx(r)?r.checked?"true":"false":r.value),r=p,r!==u?(a.setValue(r),!0):!1}function r0(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var GO=/[\n"\\]/g;function Ns(r){return r.replace(GO,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function G_(r,a,u,p,_,S,C,D){r.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?r.type=C:r.removeAttribute("type"),a!=null?C==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Is(a)):r.value!==""+Is(a)&&(r.value=""+Is(a)):C!=="submit"&&C!=="reset"||r.removeAttribute("value"),a!=null?z_(r,C,Is(a)):u!=null?z_(r,C,Is(u)):p!=null&&r.removeAttribute("value"),_==null&&S!=null&&(r.defaultChecked=!!S),_!=null&&(r.checked=_&&typeof _!="function"&&typeof _!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+Is(D):r.removeAttribute("name")}function Vx(r,a,u,p,_,S,C,D){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.type=S),a!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||a!=null)){H_(r);return}u=u!=null?""+Is(u):"",a=a!=null?""+Is(a):u,D||a===r.value||(r.value=a),r.defaultValue=a}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,r.checked=D?r.checked:!!p,r.defaultChecked=!!p,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.name=C),H_(r)}function z_(r,a,u){a==="number"&&r0(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Pd(r,a,u,p){if(r=r.options,a){a={};for(var _=0;_<u.length;_++)a["$"+u[_]]=!0;for(u=0;u<r.length;u++)_=a.hasOwnProperty("$"+r[u].value),r[u].selected!==_&&(r[u].selected=_),_&&p&&(r[u].defaultSelected=!0)}else{for(u=""+Is(u),a=null,_=0;_<r.length;_++){if(r[_].value===u){r[_].selected=!0,p&&(r[_].defaultSelected=!0);return}a!==null||r[_].disabled||(a=r[_])}a!==null&&(a.selected=!0)}}function qx(r,a,u){if(a!=null&&(a=""+Is(a),a!==r.value&&(r.value=a),u==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=u!=null?""+Is(u):""}function $x(r,a,u,p){if(a==null){if(p!=null){if(u!=null)throw Error(n(92));if(ye(p)){if(1<p.length)throw Error(n(93));p=p[0]}u=p}u==null&&(u=""),a=u}u=Is(a),r.defaultValue=u,p=r.textContent,p===u&&p!==""&&p!==null&&(r.value=p),H_(r)}function Ld(r,a){if(a){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=a;return}}r.textContent=a}var zO=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yx(r,a,u){var p=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":p?r.setProperty(a,u):typeof u!="number"||u===0||zO.has(a)?a==="float"?r.cssFloat=u:r[a]=(""+u).trim():r[a]=u+"px"}function jx(r,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(r=r.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?r.setProperty(p,""):p==="float"?r.cssFloat="":r[p]="");for(var _ in a)p=a[_],a.hasOwnProperty(_)&&u[_]!==p&&Yx(r,_,p)}else for(var S in a)a.hasOwnProperty(S)&&Yx(r,S,a[S])}function V_(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var VO=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qO=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function o0(r){return qO.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Ao(){}var q_=null;function $_(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Od=null,Ud=null;function Wx(r){var a=Md(r);if(a&&(r=a.stateNode)){var u=r[Ni]||null;e:switch(r=a.stateNode,a.type){case"input":if(G_(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Ns(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var p=u[a];if(p!==r&&p.form===r.form){var _=p[Ni]||null;if(!_)throw Error(n(90));G_(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(a=0;a<u.length;a++)p=u[a],p.form===r.form&&zx(p)}break e;case"textarea":qx(r,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&Pd(r,!!u.multiple,a,!1)}}}var Y_=!1;function Xx(r,a,u){if(Y_)return r(a,u);Y_=!0;try{var p=r(a);return p}finally{if(Y_=!1,(Od!==null||Ud!==null)&&(j0(),Od&&(a=Od,r=Ud,Ud=Od=null,Wx(a),r)))for(a=0;a<r.length;a++)Wx(r[a])}}function xp(r,a){var u=r.stateNode;if(u===null)return null;var p=u[Ni]||null;if(p===null)return null;u=p[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(r=r.type,p=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!p;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var Eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),j_=!1;if(Eo)try{var Cp={};Object.defineProperty(Cp,"passive",{get:function(){j_=!0}}),window.addEventListener("test",Cp,Cp),window.removeEventListener("test",Cp,Cp)}catch{j_=!1}var Ya=null,W_=null,a0=null;function Kx(){if(a0)return a0;var r,a=W_,u=a.length,p,_="value"in Ya?Ya.value:Ya.textContent,S=_.length;for(r=0;r<u&&a[r]===_[r];r++);var C=u-r;for(p=1;p<=C&&a[u-p]===_[S-p];p++);return a0=_.slice(r,1<p?1-p:void 0)}function l0(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function c0(){return!0}function Jx(){return!1}function Mi(r){function a(u,p,_,S,C){this._reactName=u,this._targetInst=_,this.type=p,this.nativeEvent=S,this.target=C,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(u=r[D],this[D]=u?u(S):S[D]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?c0:Jx,this.isPropagationStopped=Jx,this}return y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=c0)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=c0)},persist:function(){},isPersistent:c0}),a}var Rc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},u0=Mi(Rc),Rp=y({},Rc,{view:0,detail:0}),$O=Mi(Rp),X_,K_,Ip,d0=y({},Rp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Q_,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ip&&(Ip&&r.type==="mousemove"?(X_=r.screenX-Ip.screenX,K_=r.screenY-Ip.screenY):K_=X_=0,Ip=r),X_)},movementY:function(r){return"movementY"in r?r.movementY:K_}}),Qx=Mi(d0),YO=y({},d0,{dataTransfer:0}),jO=Mi(YO),WO=y({},Rp,{relatedTarget:0}),J_=Mi(WO),XO=y({},Rc,{animationName:0,elapsedTime:0,pseudoElement:0}),KO=Mi(XO),JO=y({},Rc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),QO=Mi(JO),ZO=y({},Rc,{data:0}),Zx=Mi(ZO),eU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iU(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=nU[r])?!!a[r]:!1}function Q_(){return iU}var sU=y({},Rp,{key:function(r){if(r.key){var a=eU[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=l0(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?tU[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Q_,charCode:function(r){return r.type==="keypress"?l0(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?l0(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),rU=Mi(sU),oU=y({},d0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eC=Mi(oU),aU=y({},Rp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Q_}),lU=Mi(aU),cU=y({},Rc,{propertyName:0,elapsedTime:0,pseudoElement:0}),uU=Mi(cU),dU=y({},d0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),hU=Mi(dU),fU=y({},Rc,{newState:0,oldState:0}),pU=Mi(fU),gU=[9,13,27,32],Z_=Eo&&"CompositionEvent"in window,Np=null;Eo&&"documentMode"in document&&(Np=document.documentMode);var mU=Eo&&"TextEvent"in window&&!Np,tC=Eo&&(!Z_||Np&&8<Np&&11>=Np),nC=" ",iC=!1;function sC(r,a){switch(r){case"keyup":return gU.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rC(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Fd=!1;function yU(r,a){switch(r){case"compositionend":return rC(a);case"keypress":return a.which!==32?null:(iC=!0,nC);case"textInput":return r=a.data,r===nC&&iC?null:r;default:return null}}function vU(r,a){if(Fd)return r==="compositionend"||!Z_&&sC(r,a)?(r=Kx(),a0=W_=Ya=null,Fd=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return tC&&a.locale!=="ko"?null:a.data;default:return null}}var bU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oC(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!bU[r.type]:a==="textarea"}function aC(r,a,u,p){Od?Ud?Ud.push(p):Ud=[p]:Od=p,a=ev(a,"onChange"),0<a.length&&(u=new u0("onChange","change",null,u,p),r.push({event:u,listeners:a}))}var Mp=null,Dp=null;function _U(r){VR(r,0)}function h0(r){var a=wp(r);if(zx(a))return r}function lC(r,a){if(r==="change")return a}var cC=!1;if(Eo){var eS;if(Eo){var tS="oninput"in document;if(!tS){var uC=document.createElement("div");uC.setAttribute("oninput","return;"),tS=typeof uC.oninput=="function"}eS=tS}else eS=!1;cC=eS&&(!document.documentMode||9<document.documentMode)}function dC(){Mp&&(Mp.detachEvent("onpropertychange",hC),Dp=Mp=null)}function hC(r){if(r.propertyName==="value"&&h0(Dp)){var a=[];aC(a,Dp,r,$_(r)),Xx(_U,a)}}function SU(r,a,u){r==="focusin"?(dC(),Mp=a,Dp=u,Mp.attachEvent("onpropertychange",hC)):r==="focusout"&&dC()}function AU(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return h0(Dp)}function EU(r,a){if(r==="click")return h0(a)}function TU(r,a){if(r==="input"||r==="change")return h0(a)}function wU(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Xi=typeof Object.is=="function"?Object.is:wU;function kp(r,a){if(Xi(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var u=Object.keys(r),p=Object.keys(a);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var _=u[p];if(!hi.call(a,_)||!Xi(r[_],a[_]))return!1}return!0}function fC(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function pC(r,a){var u=fC(r);r=0;for(var p;u;){if(u.nodeType===3){if(p=r+u.textContent.length,r<=a&&p>=a)return{node:u,offset:a-r};r=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=fC(u)}}function gC(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?gC(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function mC(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=r0(r.document);a instanceof r.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)r=a.contentWindow;else break;a=r0(r.document)}return a}function nS(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var xU=Eo&&"documentMode"in document&&11>=document.documentMode,Bd=null,iS=null,Pp=null,sS=!1;function yC(r,a,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;sS||Bd==null||Bd!==r0(p)||(p=Bd,"selectionStart"in p&&nS(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Pp&&kp(Pp,p)||(Pp=p,p=ev(iS,"onSelect"),0<p.length&&(a=new u0("onSelect","select",null,a,u),r.push({event:a,listeners:p}),a.target=Bd)))}function Ic(r,a){var u={};return u[r.toLowerCase()]=a.toLowerCase(),u["Webkit"+r]="webkit"+a,u["Moz"+r]="moz"+a,u}var Hd={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionrun:Ic("Transition","TransitionRun"),transitionstart:Ic("Transition","TransitionStart"),transitioncancel:Ic("Transition","TransitionCancel"),transitionend:Ic("Transition","TransitionEnd")},rS={},vC={};Eo&&(vC=document.createElement("div").style,"AnimationEvent"in window||(delete Hd.animationend.animation,delete Hd.animationiteration.animation,delete Hd.animationstart.animation),"TransitionEvent"in window||delete Hd.transitionend.transition);function Nc(r){if(rS[r])return rS[r];if(!Hd[r])return r;var a=Hd[r],u;for(u in a)if(a.hasOwnProperty(u)&&u in vC)return rS[r]=a[u];return r}var bC=Nc("animationend"),_C=Nc("animationiteration"),SC=Nc("animationstart"),CU=Nc("transitionrun"),RU=Nc("transitionstart"),IU=Nc("transitioncancel"),AC=Nc("transitionend"),EC=new Map,oS="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");oS.push("scrollEnd");function sr(r,a){EC.set(r,a),Cc(a,[r])}var f0=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Ms=[],Gd=0,aS=0;function p0(){for(var r=Gd,a=aS=Gd=0;a<r;){var u=Ms[a];Ms[a++]=null;var p=Ms[a];Ms[a++]=null;var _=Ms[a];Ms[a++]=null;var S=Ms[a];if(Ms[a++]=null,p!==null&&_!==null){var C=p.pending;C===null?_.next=_:(_.next=C.next,C.next=_),p.pending=_}S!==0&&TC(u,_,S)}}function g0(r,a,u,p){Ms[Gd++]=r,Ms[Gd++]=a,Ms[Gd++]=u,Ms[Gd++]=p,aS|=p,r.lanes|=p,r=r.alternate,r!==null&&(r.lanes|=p)}function lS(r,a,u,p){return g0(r,a,u,p),m0(r)}function Mc(r,a){return g0(r,null,null,a),m0(r)}function TC(r,a,u){r.lanes|=u;var p=r.alternate;p!==null&&(p.lanes|=u);for(var _=!1,S=r.return;S!==null;)S.childLanes|=u,p=S.alternate,p!==null&&(p.childLanes|=u),S.tag===22&&(r=S.stateNode,r===null||r._visibility&1||(_=!0)),r=S,S=S.return;return r.tag===3?(S=r.stateNode,_&&a!==null&&(_=31-ei(u),r=S.hiddenUpdates,p=r[_],p===null?r[_]=[a]:p.push(a),a.lane=u|536870912),S):null}function m0(r){if(50<ng)throw ng=0,yA=null,Error(n(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var zd={};function NU(r,a,u,p){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ki(r,a,u,p){return new NU(r,a,u,p)}function cS(r){return r=r.prototype,!(!r||!r.isReactComponent)}function To(r,a){var u=r.alternate;return u===null?(u=Ki(r.tag,a,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=a,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,a=r.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function wC(r,a){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,a=u.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function y0(r,a,u,p,_,S){var C=0;if(p=r,typeof r=="function")cS(r)&&(C=1);else if(typeof r=="string")C=LF(r,u,de.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=Ki(31,u,a,_),r.elementType=q,r.lanes=S,r;case x:return Dc(u.children,_,S,a);case N:C=8,_|=24;break;case I:return r=Ki(12,u,a,_|2),r.elementType=I,r.lanes=S,r;case O:return r=Ki(13,u,a,_),r.elementType=O,r.lanes=S,r;case F:return r=Ki(19,u,a,_),r.elementType=F,r.lanes=S,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k:C=10;break e;case P:C=9;break e;case L:C=11;break e;case U:C=14;break e;case X:C=16,p=null;break e}C=29,u=Error(n(130,r===null?"null":typeof r,"")),p=null}return a=Ki(C,u,a,_),a.elementType=r,a.type=p,a.lanes=S,a}function Dc(r,a,u,p){return r=Ki(7,r,p,a),r.lanes=u,r}function uS(r,a,u){return r=Ki(6,r,null,a),r.lanes=u,r}function xC(r){var a=Ki(18,null,null,0);return a.stateNode=r,a}function dS(r,a,u){return a=Ki(4,r.children!==null?r.children:[],r.key,a),a.lanes=u,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var CC=new WeakMap;function Ds(r,a){if(typeof r=="object"&&r!==null){var u=CC.get(r);return u!==void 0?u:(a={value:r,source:a,stack:ji(a)},CC.set(r,a),a)}return{value:r,source:a,stack:ji(a)}}var Vd=[],qd=0,v0=null,Lp=0,ks=[],Ps=0,ja=null,Pr=1,Lr="";function wo(r,a){Vd[qd++]=Lp,Vd[qd++]=v0,v0=r,Lp=a}function RC(r,a,u){ks[Ps++]=Pr,ks[Ps++]=Lr,ks[Ps++]=ja,ja=r;var p=Pr;r=Lr;var _=32-ei(p)-1;p&=~(1<<_),u+=1;var S=32-ei(a)+_;if(30<S){var C=_-_%5;S=(p&(1<<C)-1).toString(32),p>>=C,_-=C,Pr=1<<32-ei(a)+_|u<<_|p,Lr=S+r}else Pr=1<<S|u<<_|p,Lr=r}function hS(r){r.return!==null&&(wo(r,1),RC(r,1,0))}function fS(r){for(;r===v0;)v0=Vd[--qd],Vd[qd]=null,Lp=Vd[--qd],Vd[qd]=null;for(;r===ja;)ja=ks[--Ps],ks[Ps]=null,Lr=ks[--Ps],ks[Ps]=null,Pr=ks[--Ps],ks[Ps]=null}function IC(r,a){ks[Ps++]=Pr,ks[Ps++]=Lr,ks[Ps++]=ja,Pr=a.id,Lr=a.overflow,ja=r}var Hn=null,Bt=null,rt=!1,Wa=null,Ls=!1,pS=Error(n(519));function Xa(r){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Op(Ds(a,r)),pS}function NC(r){var a=r.stateNode,u=r.type,p=r.memoizedProps;switch(a[Bn]=r,a[Ni]=p,u){case"dialog":et("cancel",a),et("close",a);break;case"iframe":case"object":case"embed":et("load",a);break;case"video":case"audio":for(u=0;u<sg.length;u++)et(sg[u],a);break;case"source":et("error",a);break;case"img":case"image":case"link":et("error",a),et("load",a);break;case"details":et("toggle",a);break;case"input":et("invalid",a),Vx(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":et("invalid",a);break;case"textarea":et("invalid",a),$x(a,p.value,p.defaultValue,p.children)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||p.suppressHydrationWarning===!0||jR(a.textContent,u)?(p.popover!=null&&(et("beforetoggle",a),et("toggle",a)),p.onScroll!=null&&et("scroll",a),p.onScrollEnd!=null&&et("scrollend",a),p.onClick!=null&&(a.onclick=Ao),a=!0):a=!1,a||Xa(r,!0)}function MC(r){for(Hn=r.return;Hn;)switch(Hn.tag){case 5:case 31:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:Hn=Hn.return}}function $d(r){if(r!==Hn)return!1;if(!rt)return MC(r),rt=!0,!1;var a=r.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||DA(r.type,r.memoizedProps)),u=!u),u&&Bt&&Xa(r),MC(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Bt=nI(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Bt=nI(r)}else a===27?(a=Bt,cl(r.type)?(r=UA,UA=null,Bt=r):Bt=a):Bt=Hn?Us(r.stateNode.nextSibling):null;return!0}function kc(){Bt=Hn=null,rt=!1}function gS(){var r=Wa;return r!==null&&(Li===null?Li=r:Li.push.apply(Li,r),Wa=null),r}function Op(r){Wa===null?Wa=[r]:Wa.push(r)}var mS=H(null),Pc=null,xo=null;function Ka(r,a,u){re(mS,a._currentValue),a._currentValue=u}function Co(r){r._currentValue=mS.current,K(mS)}function yS(r,a,u){for(;r!==null;){var p=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),r===u)break;r=r.return}}function vS(r,a,u,p){var _=r.child;for(_!==null&&(_.return=r);_!==null;){var S=_.dependencies;if(S!==null){var C=_.child;S=S.firstContext;e:for(;S!==null;){var D=S;S=_;for(var B=0;B<a.length;B++)if(D.context===a[B]){S.lanes|=u,D=S.alternate,D!==null&&(D.lanes|=u),yS(S.return,u,r),p||(C=null);break e}S=D.next}}else if(_.tag===18){if(C=_.return,C===null)throw Error(n(341));C.lanes|=u,S=C.alternate,S!==null&&(S.lanes|=u),yS(C,u,r),C=null}else C=_.child;if(C!==null)C.return=_;else for(C=_;C!==null;){if(C===r){C=null;break}if(_=C.sibling,_!==null){_.return=C.return,C=_;break}C=C.return}_=C}}function Yd(r,a,u,p){r=null;for(var _=a,S=!1;_!==null;){if(!S){if((_.flags&524288)!==0)S=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var C=_.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var D=_.type;Xi(_.pendingProps.value,C.value)||(r!==null?r.push(D):r=[D])}}else if(_===Te.current){if(C=_.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(r!==null?r.push(cg):r=[cg])}_=_.return}r!==null&&vS(a,r,u,p),a.flags|=262144}function b0(r){for(r=r.firstContext;r!==null;){if(!Xi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Lc(r){Pc=r,xo=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Gn(r){return DC(Pc,r)}function _0(r,a){return Pc===null&&Lc(r),DC(r,a)}function DC(r,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},xo===null){if(r===null)throw Error(n(308));xo=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else xo=xo.next=a;return u}var MU=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(u,p){r.push(p)}};this.abort=function(){a.aborted=!0,r.forEach(function(u){return u()})}},DU=i.unstable_scheduleCallback,kU=i.unstable_NormalPriority,pn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bS(){return{controller:new MU,data:new Map,refCount:0}}function Up(r){r.refCount--,r.refCount===0&&DU(kU,function(){r.controller.abort()})}var Fp=null,_S=0,jd=0,Wd=null;function PU(r,a){if(Fp===null){var u=Fp=[];_S=0,jd=EA(),Wd={status:"pending",value:void 0,then:function(p){u.push(p)}}}return _S++,a.then(kC,kC),a}function kC(){if(--_S===0&&Fp!==null){Wd!==null&&(Wd.status="fulfilled");var r=Fp;Fp=null,jd=0,Wd=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function LU(r,a){var u=[],p={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return r.then(function(){p.status="fulfilled",p.value=a;for(var _=0;_<u.length;_++)(0,u[_])(a)},function(_){for(p.status="rejected",p.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),p}var PC=G.S;G.S=function(r,a){yR=Ce(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&PU(r,a),PC!==null&&PC(r,a)};var Oc=H(null);function SS(){var r=Oc.current;return r!==null?r:It.pooledCache}function S0(r,a){a===null?re(Oc,Oc.current):re(Oc,a.pool)}function LC(){var r=SS();return r===null?null:{parent:pn._currentValue,pool:r}}var Xd=Error(n(460)),AS=Error(n(474)),A0=Error(n(542)),E0={then:function(){}};function OC(r){return r=r.status,r==="fulfilled"||r==="rejected"}function UC(r,a,u){switch(u=r[u],u===void 0?r.push(a):u!==a&&(a.then(Ao,Ao),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,BC(r),r;default:if(typeof a.status=="string")a.then(Ao,Ao);else{if(r=It,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=a,r.status="pending",r.then(function(p){if(a.status==="pending"){var _=a;_.status="fulfilled",_.value=p}},function(p){if(a.status==="pending"){var _=a;_.status="rejected",_.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,BC(r),r}throw Fc=a,Xd}}function Uc(r){try{var a=r._init;return a(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Fc=u,Xd):u}}var Fc=null;function FC(){if(Fc===null)throw Error(n(459));var r=Fc;return Fc=null,r}function BC(r){if(r===Xd||r===A0)throw Error(n(483))}var Kd=null,Bp=0;function T0(r){var a=Bp;return Bp+=1,Kd===null&&(Kd=[]),UC(Kd,r,a)}function Hp(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function w0(r,a){throw a.$$typeof===b?Error(n(525)):(r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function HC(r){function a(V,z){if(r){var Y=V.deletions;Y===null?(V.deletions=[z],V.flags|=16):Y.push(z)}}function u(V,z){if(!r)return null;for(;z!==null;)a(V,z),z=z.sibling;return null}function p(V){for(var z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function _(V,z){return V=To(V,z),V.index=0,V.sibling=null,V}function S(V,z,Y){return V.index=Y,r?(Y=V.alternate,Y!==null?(Y=Y.index,Y<z?(V.flags|=67108866,z):Y):(V.flags|=67108866,z)):(V.flags|=1048576,z)}function C(V){return r&&V.alternate===null&&(V.flags|=67108866),V}function D(V,z,Y,ne){return z===null||z.tag!==6?(z=uS(Y,V.mode,ne),z.return=V,z):(z=_(z,Y),z.return=V,z)}function B(V,z,Y,ne){var Re=Y.type;return Re===x?te(V,z,Y.props.children,ne,Y.key):z!==null&&(z.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===X&&Uc(Re)===z.type)?(z=_(z,Y.props),Hp(z,Y),z.return=V,z):(z=y0(Y.type,Y.key,Y.props,null,V.mode,ne),Hp(z,Y),z.return=V,z)}function j(V,z,Y,ne){return z===null||z.tag!==4||z.stateNode.containerInfo!==Y.containerInfo||z.stateNode.implementation!==Y.implementation?(z=dS(Y,V.mode,ne),z.return=V,z):(z=_(z,Y.children||[]),z.return=V,z)}function te(V,z,Y,ne,Re){return z===null||z.tag!==7?(z=Dc(Y,V.mode,ne,Re),z.return=V,z):(z=_(z,Y),z.return=V,z)}function ie(V,z,Y){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=uS(""+z,V.mode,Y),z.return=V,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case A:return Y=y0(z.type,z.key,z.props,null,V.mode,Y),Hp(Y,z),Y.return=V,Y;case w:return z=dS(z,V.mode,Y),z.return=V,z;case X:return z=Uc(z),ie(V,z,Y)}if(ye(z)||se(z))return z=Dc(z,V.mode,Y,null),z.return=V,z;if(typeof z.then=="function")return ie(V,T0(z),Y);if(z.$$typeof===k)return ie(V,_0(V,z),Y);w0(V,z)}return null}function W(V,z,Y,ne){var Re=z!==null?z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Re!==null?null:D(V,z,""+Y,ne);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:return Y.key===Re?B(V,z,Y,ne):null;case w:return Y.key===Re?j(V,z,Y,ne):null;case X:return Y=Uc(Y),W(V,z,Y,ne)}if(ye(Y)||se(Y))return Re!==null?null:te(V,z,Y,ne,null);if(typeof Y.then=="function")return W(V,z,T0(Y),ne);if(Y.$$typeof===k)return W(V,z,_0(V,Y),ne);w0(V,Y)}return null}function Q(V,z,Y,ne,Re){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return V=V.get(Y)||null,D(z,V,""+ne,Re);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case A:return V=V.get(ne.key===null?Y:ne.key)||null,B(z,V,ne,Re);case w:return V=V.get(ne.key===null?Y:ne.key)||null,j(z,V,ne,Re);case X:return ne=Uc(ne),Q(V,z,Y,ne,Re)}if(ye(ne)||se(ne))return V=V.get(Y)||null,te(z,V,ne,Re,null);if(typeof ne.then=="function")return Q(V,z,Y,T0(ne),Re);if(ne.$$typeof===k)return Q(V,z,Y,_0(z,ne),Re);w0(z,ne)}return null}function Ae(V,z,Y,ne){for(var Re=null,ut=null,we=z,qe=z=0,nt=null;we!==null&&qe<Y.length;qe++){we.index>qe?(nt=we,we=null):nt=we.sibling;var dt=W(V,we,Y[qe],ne);if(dt===null){we===null&&(we=nt);break}r&&we&&dt.alternate===null&&a(V,we),z=S(dt,z,qe),ut===null?Re=dt:ut.sibling=dt,ut=dt,we=nt}if(qe===Y.length)return u(V,we),rt&&wo(V,qe),Re;if(we===null){for(;qe<Y.length;qe++)we=ie(V,Y[qe],ne),we!==null&&(z=S(we,z,qe),ut===null?Re=we:ut.sibling=we,ut=we);return rt&&wo(V,qe),Re}for(we=p(we);qe<Y.length;qe++)nt=Q(we,V,qe,Y[qe],ne),nt!==null&&(r&&nt.alternate!==null&&we.delete(nt.key===null?qe:nt.key),z=S(nt,z,qe),ut===null?Re=nt:ut.sibling=nt,ut=nt);return r&&we.forEach(function(pl){return a(V,pl)}),rt&&wo(V,qe),Re}function Ie(V,z,Y,ne){if(Y==null)throw Error(n(151));for(var Re=null,ut=null,we=z,qe=z=0,nt=null,dt=Y.next();we!==null&&!dt.done;qe++,dt=Y.next()){we.index>qe?(nt=we,we=null):nt=we.sibling;var pl=W(V,we,dt.value,ne);if(pl===null){we===null&&(we=nt);break}r&&we&&pl.alternate===null&&a(V,we),z=S(pl,z,qe),ut===null?Re=pl:ut.sibling=pl,ut=pl,we=nt}if(dt.done)return u(V,we),rt&&wo(V,qe),Re;if(we===null){for(;!dt.done;qe++,dt=Y.next())dt=ie(V,dt.value,ne),dt!==null&&(z=S(dt,z,qe),ut===null?Re=dt:ut.sibling=dt,ut=dt);return rt&&wo(V,qe),Re}for(we=p(we);!dt.done;qe++,dt=Y.next())dt=Q(we,V,qe,dt.value,ne),dt!==null&&(r&&dt.alternate!==null&&we.delete(dt.key===null?qe:dt.key),z=S(dt,z,qe),ut===null?Re=dt:ut.sibling=dt,ut=dt);return r&&we.forEach(function(YF){return a(V,YF)}),rt&&wo(V,qe),Re}function Et(V,z,Y,ne){if(typeof Y=="object"&&Y!==null&&Y.type===x&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case A:e:{for(var Re=Y.key;z!==null;){if(z.key===Re){if(Re=Y.type,Re===x){if(z.tag===7){u(V,z.sibling),ne=_(z,Y.props.children),ne.return=V,V=ne;break e}}else if(z.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===X&&Uc(Re)===z.type){u(V,z.sibling),ne=_(z,Y.props),Hp(ne,Y),ne.return=V,V=ne;break e}u(V,z);break}else a(V,z);z=z.sibling}Y.type===x?(ne=Dc(Y.props.children,V.mode,ne,Y.key),ne.return=V,V=ne):(ne=y0(Y.type,Y.key,Y.props,null,V.mode,ne),Hp(ne,Y),ne.return=V,V=ne)}return C(V);case w:e:{for(Re=Y.key;z!==null;){if(z.key===Re)if(z.tag===4&&z.stateNode.containerInfo===Y.containerInfo&&z.stateNode.implementation===Y.implementation){u(V,z.sibling),ne=_(z,Y.children||[]),ne.return=V,V=ne;break e}else{u(V,z);break}else a(V,z);z=z.sibling}ne=dS(Y,V.mode,ne),ne.return=V,V=ne}return C(V);case X:return Y=Uc(Y),Et(V,z,Y,ne)}if(ye(Y))return Ae(V,z,Y,ne);if(se(Y)){if(Re=se(Y),typeof Re!="function")throw Error(n(150));return Y=Re.call(Y),Ie(V,z,Y,ne)}if(typeof Y.then=="function")return Et(V,z,T0(Y),ne);if(Y.$$typeof===k)return Et(V,z,_0(V,Y),ne);w0(V,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,z!==null&&z.tag===6?(u(V,z.sibling),ne=_(z,Y),ne.return=V,V=ne):(u(V,z),ne=uS(Y,V.mode,ne),ne.return=V,V=ne),C(V)):u(V,z)}return function(V,z,Y,ne){try{Bp=0;var Re=Et(V,z,Y,ne);return Kd=null,Re}catch(we){if(we===Xd||we===A0)throw we;var ut=Ki(29,we,null,V.mode);return ut.lanes=ne,ut.return=V,ut}finally{}}}var Bc=HC(!0),GC=HC(!1),Ja=!1;function ES(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function TS(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Qa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Za(r,a,u){var p=r.updateQueue;if(p===null)return null;if(p=p.shared,(ft&2)!==0){var _=p.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),p.pending=a,a=m0(r),TC(r,null,u),a}return g0(r,p,a,u),m0(r)}function Gp(r,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,Xe(r,u)}}function wS(r,a){var u=r.updateQueue,p=r.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var C={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?_=S=C:S=S.next=C,u=u.next}while(u!==null);S===null?_=S=a:S=S.next=a}else _=S=a;u={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=a:r.next=a,u.lastBaseUpdate=a}var xS=!1;function zp(){if(xS){var r=Wd;if(r!==null)throw r}}function Vp(r,a,u,p){xS=!1;var _=r.updateQueue;Ja=!1;var S=_.firstBaseUpdate,C=_.lastBaseUpdate,D=_.shared.pending;if(D!==null){_.shared.pending=null;var B=D,j=B.next;B.next=null,C===null?S=j:C.next=j,C=B;var te=r.alternate;te!==null&&(te=te.updateQueue,D=te.lastBaseUpdate,D!==C&&(D===null?te.firstBaseUpdate=j:D.next=j,te.lastBaseUpdate=B))}if(S!==null){var ie=_.baseState;C=0,te=j=B=null,D=S;do{var W=D.lane&-536870913,Q=W!==D.lane;if(Q?(tt&W)===W:(p&W)===W){W!==0&&W===jd&&(xS=!0),te!==null&&(te=te.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ae=r,Ie=D;W=a;var Et=u;switch(Ie.tag){case 1:if(Ae=Ie.payload,typeof Ae=="function"){ie=Ae.call(Et,ie,W);break e}ie=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Ie.payload,W=typeof Ae=="function"?Ae.call(Et,ie,W):Ae,W==null)break e;ie=y({},ie,W);break e;case 2:Ja=!0}}W=D.callback,W!==null&&(r.flags|=64,Q&&(r.flags|=8192),Q=_.callbacks,Q===null?_.callbacks=[W]:Q.push(W))}else Q={lane:W,tag:D.tag,payload:D.payload,callback:D.callback,next:null},te===null?(j=te=Q,B=ie):te=te.next=Q,C|=W;if(D=D.next,D===null){if(D=_.shared.pending,D===null)break;Q=D,D=Q.next,Q.next=null,_.lastBaseUpdate=Q,_.shared.pending=null}}while(!0);te===null&&(B=ie),_.baseState=B,_.firstBaseUpdate=j,_.lastBaseUpdate=te,S===null&&(_.shared.lanes=0),sl|=C,r.lanes=C,r.memoizedState=ie}}function zC(r,a){if(typeof r!="function")throw Error(n(191,r));r.call(a)}function VC(r,a){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)zC(u[r],a)}var Jd=H(null),x0=H(0);function qC(r,a){r=Oo,re(x0,r),re(Jd,a),Oo=r|a.baseLanes}function CS(){re(x0,Oo),re(Jd,Jd.current)}function RS(){Oo=x0.current,K(Jd),K(x0)}var Ji=H(null),Os=null;function el(r){var a=r.alternate;re(ln,ln.current&1),re(Ji,r),Os===null&&(a===null||Jd.current!==null||a.memoizedState!==null)&&(Os=r)}function IS(r){re(ln,ln.current),re(Ji,r),Os===null&&(Os=r)}function $C(r){r.tag===22?(re(ln,ln.current),re(Ji,r),Os===null&&(Os=r)):tl()}function tl(){re(ln,ln.current),re(Ji,Ji.current)}function Qi(r){K(Ji),Os===r&&(Os=null),K(ln)}var ln=H(0);function C0(r){for(var a=r;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||LA(u)||OA(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ro=0,Ge=null,St=null,gn=null,R0=!1,Qd=!1,Hc=!1,I0=0,qp=0,Zd=null,OU=0;function en(){throw Error(n(321))}function NS(r,a){if(a===null)return!1;for(var u=0;u<a.length&&u<r.length;u++)if(!Xi(r[u],a[u]))return!1;return!0}function MS(r,a,u,p,_,S){return Ro=S,Ge=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,G.H=r===null||r.memoizedState===null?R1:YS,Hc=!1,S=u(p,_),Hc=!1,Qd&&(S=jC(a,u,p,_)),YC(r),S}function YC(r){G.H=jp;var a=St!==null&&St.next!==null;if(Ro=0,gn=St=Ge=null,R0=!1,qp=0,Zd=null,a)throw Error(n(300));r===null||mn||(r=r.dependencies,r!==null&&b0(r)&&(mn=!0))}function jC(r,a,u,p){Ge=r;var _=0;do{if(Qd&&(Zd=null),qp=0,Qd=!1,25<=_)throw Error(n(301));if(_+=1,gn=St=null,r.updateQueue!=null){var S=r.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}G.H=I1,S=a(u,p)}while(Qd);return S}function UU(){var r=G.H,a=r.useState()[0];return a=typeof a.then=="function"?$p(a):a,r=r.useState()[0],(St!==null?St.memoizedState:null)!==r&&(Ge.flags|=1024),a}function DS(){var r=I0!==0;return I0=0,r}function kS(r,a,u){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~u}function PS(r){if(R0){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}R0=!1}Ro=0,gn=St=Ge=null,Qd=!1,qp=I0=0,Zd=null}function mi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Ge.memoizedState=gn=r:gn=gn.next=r,gn}function cn(){if(St===null){var r=Ge.alternate;r=r!==null?r.memoizedState:null}else r=St.next;var a=gn===null?Ge.memoizedState:gn.next;if(a!==null)gn=a,St=r;else{if(r===null)throw Ge.alternate===null?Error(n(467)):Error(n(310));St=r,r={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},gn===null?Ge.memoizedState=gn=r:gn=gn.next=r}return gn}function N0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $p(r){var a=qp;return qp+=1,Zd===null&&(Zd=[]),r=UC(Zd,r,a),a=Ge,(gn===null?a.memoizedState:gn.next)===null&&(a=a.alternate,G.H=a===null||a.memoizedState===null?R1:YS),r}function M0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return $p(r);if(r.$$typeof===k)return Gn(r)}throw Error(n(438,String(r)))}function LS(r){var a=null,u=Ge.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var p=Ge.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(_){return _.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=N0(),Ge.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(r),p=0;p<r;p++)u[p]=Z;return a.index++,u}function Io(r,a){return typeof a=="function"?a(r):a}function D0(r){var a=cn();return OS(a,St,r)}function OS(r,a,u){var p=r.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=u;var _=r.baseQueue,S=p.pending;if(S!==null){if(_!==null){var C=_.next;_.next=S.next,S.next=C}a.baseQueue=_=S,p.pending=null}if(S=r.baseState,_===null)r.memoizedState=S;else{a=_.next;var D=C=null,B=null,j=a,te=!1;do{var ie=j.lane&-536870913;if(ie!==j.lane?(tt&ie)===ie:(Ro&ie)===ie){var W=j.revertLane;if(W===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),ie===jd&&(te=!0);else if((Ro&W)===W){j=j.next,W===jd&&(te=!0);continue}else ie={lane:0,revertLane:j.revertLane,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},B===null?(D=B=ie,C=S):B=B.next=ie,Ge.lanes|=W,sl|=W;ie=j.action,Hc&&u(S,ie),S=j.hasEagerState?j.eagerState:u(S,ie)}else W={lane:ie,revertLane:j.revertLane,gesture:j.gesture,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},B===null?(D=B=W,C=S):B=B.next=W,Ge.lanes|=ie,sl|=ie;j=j.next}while(j!==null&&j!==a);if(B===null?C=S:B.next=D,!Xi(S,r.memoizedState)&&(mn=!0,te&&(u=Wd,u!==null)))throw u;r.memoizedState=S,r.baseState=C,r.baseQueue=B,p.lastRenderedState=S}return _===null&&(p.lanes=0),[r.memoizedState,p.dispatch]}function US(r){var a=cn(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var p=u.dispatch,_=u.pending,S=a.memoizedState;if(_!==null){u.pending=null;var C=_=_.next;do S=r(S,C.action),C=C.next;while(C!==_);Xi(S,a.memoizedState)||(mn=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),u.lastRenderedState=S}return[S,p]}function WC(r,a,u){var p=Ge,_=cn(),S=rt;if(S){if(u===void 0)throw Error(n(407));u=u()}else u=a();var C=!Xi((St||_).memoizedState,u);if(C&&(_.memoizedState=u,mn=!0),_=_.queue,HS(JC.bind(null,p,_,r),[r]),_.getSnapshot!==a||C||gn!==null&&gn.memoizedState.tag&1){if(p.flags|=2048,eh(9,{destroy:void 0},KC.bind(null,p,_,u,a),null),It===null)throw Error(n(349));S||(Ro&127)!==0||XC(p,a,u)}return u}function XC(r,a,u){r.flags|=16384,r={getSnapshot:a,value:u},a=Ge.updateQueue,a===null?(a=N0(),Ge.updateQueue=a,a.stores=[r]):(u=a.stores,u===null?a.stores=[r]:u.push(r))}function KC(r,a,u,p){a.value=u,a.getSnapshot=p,QC(a)&&ZC(r)}function JC(r,a,u){return u(function(){QC(a)&&ZC(r)})}function QC(r){var a=r.getSnapshot;r=r.value;try{var u=a();return!Xi(r,u)}catch{return!0}}function ZC(r){var a=Mc(r,2);a!==null&&Oi(a,r,2)}function FS(r){var a=mi();if(typeof r=="function"){var u=r;if(r=u(),Hc){kr(!0);try{u()}finally{kr(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:r},a}function e1(r,a,u,p){return r.baseState=u,OS(r,St,typeof p=="function"?p:Io)}function FU(r,a,u,p,_){if(L0(r))throw Error(n(485));if(r=a.action,r!==null){var S={payload:_,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){S.listeners.push(C)}};G.T!==null?u(!0):S.isTransition=!1,p(S),u=a.pending,u===null?(S.next=a.pending=S,t1(a,S)):(S.next=u.next,a.pending=u.next=S)}}function t1(r,a){var u=a.action,p=a.payload,_=r.state;if(a.isTransition){var S=G.T,C={};G.T=C;try{var D=u(_,p),B=G.S;B!==null&&B(C,D),n1(r,a,D)}catch(j){BS(r,a,j)}finally{S!==null&&C.types!==null&&(S.types=C.types),G.T=S}}else try{S=u(_,p),n1(r,a,S)}catch(j){BS(r,a,j)}}function n1(r,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){i1(r,a,p)},function(p){return BS(r,a,p)}):i1(r,a,u)}function i1(r,a,u){a.status="fulfilled",a.value=u,s1(a),r.state=u,a=r.pending,a!==null&&(u=a.next,u===a?r.pending=null:(u=u.next,a.next=u,t1(r,u)))}function BS(r,a,u){var p=r.pending;if(r.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=u,s1(a),a=a.next;while(a!==p)}r.action=null}function s1(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function r1(r,a){return a}function o1(r,a){if(rt){var u=It.formState;if(u!==null){e:{var p=Ge;if(rt){if(Bt){t:{for(var _=Bt,S=Ls;_.nodeType!==8;){if(!S){_=null;break t}if(_=Us(_.nextSibling),_===null){_=null;break t}}S=_.data,_=S==="F!"||S==="F"?_:null}if(_){Bt=Us(_.nextSibling),p=_.data==="F!";break e}}Xa(p)}p=!1}p&&(a=u[0])}}return u=mi(),u.memoizedState=u.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r1,lastRenderedState:a},u.queue=p,u=w1.bind(null,Ge,p),p.dispatch=u,p=FS(!1),S=$S.bind(null,Ge,!1,p.queue),p=mi(),_={state:a,dispatch:null,action:r,pending:null},p.queue=_,u=FU.bind(null,Ge,_,S,u),_.dispatch=u,p.memoizedState=r,[a,u,!1]}function a1(r){var a=cn();return l1(a,St,r)}function l1(r,a,u){if(a=OS(r,a,r1)[0],r=D0(Io)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=$p(a)}catch(C){throw C===Xd?A0:C}else p=a;a=cn();var _=a.queue,S=_.dispatch;return u!==a.memoizedState&&(Ge.flags|=2048,eh(9,{destroy:void 0},BU.bind(null,_,u),null)),[p,S,r]}function BU(r,a){r.action=a}function c1(r){var a=cn(),u=St;if(u!==null)return l1(a,u,r);cn(),a=a.memoizedState,u=cn();var p=u.queue.dispatch;return u.memoizedState=r,[a,p,!1]}function eh(r,a,u,p){return r={tag:r,create:u,deps:p,inst:a,next:null},a=Ge.updateQueue,a===null&&(a=N0(),Ge.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=r.next=r:(p=u.next,u.next=r,r.next=p,a.lastEffect=r),r}function u1(){return cn().memoizedState}function k0(r,a,u,p){var _=mi();Ge.flags|=r,_.memoizedState=eh(1|a,{destroy:void 0},u,p===void 0?null:p)}function P0(r,a,u,p){var _=cn();p=p===void 0?null:p;var S=_.memoizedState.inst;St!==null&&p!==null&&NS(p,St.memoizedState.deps)?_.memoizedState=eh(a,S,u,p):(Ge.flags|=r,_.memoizedState=eh(1|a,S,u,p))}function d1(r,a){k0(8390656,8,r,a)}function HS(r,a){P0(2048,8,r,a)}function HU(r){Ge.flags|=4;var a=Ge.updateQueue;if(a===null)a=N0(),Ge.updateQueue=a,a.events=[r];else{var u=a.events;u===null?a.events=[r]:u.push(r)}}function h1(r){var a=cn().memoizedState;return HU({ref:a,nextImpl:r}),function(){if((ft&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function f1(r,a){return P0(4,2,r,a)}function p1(r,a){return P0(4,4,r,a)}function g1(r,a){if(typeof a=="function"){r=r();var u=a(r);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function m1(r,a,u){u=u!=null?u.concat([r]):null,P0(4,4,g1.bind(null,a,r),u)}function GS(){}function y1(r,a){var u=cn();a=a===void 0?null:a;var p=u.memoizedState;return a!==null&&NS(a,p[1])?p[0]:(u.memoizedState=[r,a],r)}function v1(r,a){var u=cn();a=a===void 0?null:a;var p=u.memoizedState;if(a!==null&&NS(a,p[1]))return p[0];if(p=r(),Hc){kr(!0);try{r()}finally{kr(!1)}}return u.memoizedState=[p,a],p}function zS(r,a,u){return u===void 0||(Ro&1073741824)!==0&&(tt&261930)===0?r.memoizedState=a:(r.memoizedState=u,r=bR(),Ge.lanes|=r,sl|=r,u)}function b1(r,a,u,p){return Xi(u,a)?u:Jd.current!==null?(r=zS(r,u,p),Xi(r,a)||(mn=!0),r):(Ro&42)===0||(Ro&1073741824)!==0&&(tt&261930)===0?(mn=!0,r.memoizedState=u):(r=bR(),Ge.lanes|=r,sl|=r,a)}function _1(r,a,u,p,_){var S=$.p;$.p=S!==0&&8>S?S:8;var C=G.T,D={};G.T=D,$S(r,!1,a,u);try{var B=_(),j=G.S;if(j!==null&&j(D,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var te=LU(B,p);Yp(r,a,te,ts(r))}else Yp(r,a,p,ts(r))}catch(ie){Yp(r,a,{then:function(){},status:"rejected",reason:ie},ts())}finally{$.p=S,C!==null&&D.types!==null&&(C.types=D.types),G.T=C}}function GU(){}function VS(r,a,u,p){if(r.tag!==5)throw Error(n(476));var _=S1(r).queue;_1(r,_,a,oe,u===null?GU:function(){return A1(r),u(p)})}function S1(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:oe},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:u},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function A1(r){var a=S1(r);a.next===null&&(a=r.alternate.memoizedState),Yp(r,a.next.queue,{},ts())}function qS(){return Gn(cg)}function E1(){return cn().memoizedState}function T1(){return cn().memoizedState}function zU(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var u=ts();r=Qa(u);var p=Za(a,r,u);p!==null&&(Oi(p,a,u),Gp(p,a,u)),a={cache:bS()},r.payload=a;return}a=a.return}}function VU(r,a,u){var p=ts();u={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},L0(r)?x1(a,u):(u=lS(r,a,u,p),u!==null&&(Oi(u,r,p),C1(u,a,p)))}function w1(r,a,u){var p=ts();Yp(r,a,u,p)}function Yp(r,a,u,p){var _={lane:p,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(L0(r))x1(a,_);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var C=a.lastRenderedState,D=S(C,u);if(_.hasEagerState=!0,_.eagerState=D,Xi(D,C))return g0(r,a,_,0),It===null&&p0(),!1}catch{}finally{}if(u=lS(r,a,_,p),u!==null)return Oi(u,r,p),C1(u,a,p),!0}return!1}function $S(r,a,u,p){if(p={lane:2,revertLane:EA(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},L0(r)){if(a)throw Error(n(479))}else a=lS(r,u,p,2),a!==null&&Oi(a,r,2)}function L0(r){var a=r.alternate;return r===Ge||a!==null&&a===Ge}function x1(r,a){Qd=R0=!0;var u=r.pending;u===null?a.next=a:(a.next=u.next,u.next=a),r.pending=a}function C1(r,a,u){if((u&4194048)!==0){var p=a.lanes;p&=r.pendingLanes,u|=p,a.lanes=u,Xe(r,u)}}var jp={readContext:Gn,use:M0,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en};jp.useEffectEvent=en;var R1={readContext:Gn,use:M0,useCallback:function(r,a){return mi().memoizedState=[r,a===void 0?null:a],r},useContext:Gn,useEffect:d1,useImperativeHandle:function(r,a,u){u=u!=null?u.concat([r]):null,k0(4194308,4,g1.bind(null,a,r),u)},useLayoutEffect:function(r,a){return k0(4194308,4,r,a)},useInsertionEffect:function(r,a){k0(4,2,r,a)},useMemo:function(r,a){var u=mi();a=a===void 0?null:a;var p=r();if(Hc){kr(!0);try{r()}finally{kr(!1)}}return u.memoizedState=[p,a],p},useReducer:function(r,a,u){var p=mi();if(u!==void 0){var _=u(a);if(Hc){kr(!0);try{u(a)}finally{kr(!1)}}}else _=a;return p.memoizedState=p.baseState=_,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:_},p.queue=r,r=r.dispatch=VU.bind(null,Ge,r),[p.memoizedState,r]},useRef:function(r){var a=mi();return r={current:r},a.memoizedState=r},useState:function(r){r=FS(r);var a=r.queue,u=w1.bind(null,Ge,a);return a.dispatch=u,[r.memoizedState,u]},useDebugValue:GS,useDeferredValue:function(r,a){var u=mi();return zS(u,r,a)},useTransition:function(){var r=FS(!1);return r=_1.bind(null,Ge,r.queue,!0,!1),mi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,u){var p=Ge,_=mi();if(rt){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),It===null)throw Error(n(349));(tt&127)!==0||XC(p,a,u)}_.memoizedState=u;var S={value:u,getSnapshot:a};return _.queue=S,d1(JC.bind(null,p,S,r),[r]),p.flags|=2048,eh(9,{destroy:void 0},KC.bind(null,p,S,u,a),null),u},useId:function(){var r=mi(),a=It.identifierPrefix;if(rt){var u=Lr,p=Pr;u=(p&~(1<<32-ei(p)-1)).toString(32)+u,a="_"+a+"R_"+u,u=I0++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=OU++,a="_"+a+"r_"+u.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:qS,useFormState:o1,useActionState:o1,useOptimistic:function(r){var a=mi();a.memoizedState=a.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=$S.bind(null,Ge,!0,u),u.dispatch=a,[r,a]},useMemoCache:LS,useCacheRefresh:function(){return mi().memoizedState=zU.bind(null,Ge)},useEffectEvent:function(r){var a=mi(),u={impl:r};return a.memoizedState=u,function(){if((ft&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},YS={readContext:Gn,use:M0,useCallback:y1,useContext:Gn,useEffect:HS,useImperativeHandle:m1,useInsertionEffect:f1,useLayoutEffect:p1,useMemo:v1,useReducer:D0,useRef:u1,useState:function(){return D0(Io)},useDebugValue:GS,useDeferredValue:function(r,a){var u=cn();return b1(u,St.memoizedState,r,a)},useTransition:function(){var r=D0(Io)[0],a=cn().memoizedState;return[typeof r=="boolean"?r:$p(r),a]},useSyncExternalStore:WC,useId:E1,useHostTransitionStatus:qS,useFormState:a1,useActionState:a1,useOptimistic:function(r,a){var u=cn();return e1(u,St,r,a)},useMemoCache:LS,useCacheRefresh:T1};YS.useEffectEvent=h1;var I1={readContext:Gn,use:M0,useCallback:y1,useContext:Gn,useEffect:HS,useImperativeHandle:m1,useInsertionEffect:f1,useLayoutEffect:p1,useMemo:v1,useReducer:US,useRef:u1,useState:function(){return US(Io)},useDebugValue:GS,useDeferredValue:function(r,a){var u=cn();return St===null?zS(u,r,a):b1(u,St.memoizedState,r,a)},useTransition:function(){var r=US(Io)[0],a=cn().memoizedState;return[typeof r=="boolean"?r:$p(r),a]},useSyncExternalStore:WC,useId:E1,useHostTransitionStatus:qS,useFormState:c1,useActionState:c1,useOptimistic:function(r,a){var u=cn();return St!==null?e1(u,St,r,a):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:LS,useCacheRefresh:T1};I1.useEffectEvent=h1;function jS(r,a,u,p){a=r.memoizedState,u=u(p,a),u=u==null?a:y({},a,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var WS={enqueueSetState:function(r,a,u){r=r._reactInternals;var p=ts(),_=Qa(p);_.payload=a,u!=null&&(_.callback=u),a=Za(r,_,p),a!==null&&(Oi(a,r,p),Gp(a,r,p))},enqueueReplaceState:function(r,a,u){r=r._reactInternals;var p=ts(),_=Qa(p);_.tag=1,_.payload=a,u!=null&&(_.callback=u),a=Za(r,_,p),a!==null&&(Oi(a,r,p),Gp(a,r,p))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var u=ts(),p=Qa(u);p.tag=2,a!=null&&(p.callback=a),a=Za(r,p,u),a!==null&&(Oi(a,r,u),Gp(a,r,u))}};function N1(r,a,u,p,_,S,C){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(p,S,C):a.prototype&&a.prototype.isPureReactComponent?!kp(u,p)||!kp(_,S):!0}function M1(r,a,u,p){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,p),a.state!==r&&WS.enqueueReplaceState(a,a.state,null)}function Gc(r,a){var u=a;if("ref"in a){u={};for(var p in a)p!=="ref"&&(u[p]=a[p])}if(r=r.defaultProps){u===a&&(u=y({},u));for(var _ in r)u[_]===void 0&&(u[_]=r[_])}return u}function D1(r){f0(r)}function k1(r){console.error(r)}function P1(r){f0(r)}function O0(r,a){try{var u=r.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function L1(r,a,u){try{var p=r.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function XS(r,a,u){return u=Qa(u),u.tag=3,u.payload={element:null},u.callback=function(){O0(r,a)},u}function O1(r){return r=Qa(r),r.tag=3,r}function U1(r,a,u,p){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var S=p.value;r.payload=function(){return _(S)},r.callback=function(){L1(a,u,p)}}var C=u.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(r.callback=function(){L1(a,u,p),typeof _!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var D=p.stack;this.componentDidCatch(p.value,{componentStack:D!==null?D:""})})}function qU(r,a,u,p,_){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=u.alternate,a!==null&&Yd(a,u,_,!0),u=Ji.current,u!==null){switch(u.tag){case 31:case 13:return Os===null?W0():u.alternate===null&&tn===0&&(tn=3),u.flags&=-257,u.flags|=65536,u.lanes=_,p===E0?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([p]):a.add(p),_A(r,p,_)),!1;case 22:return u.flags|=65536,p===E0?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([p]):u.add(p)),_A(r,p,_)),!1}throw Error(n(435,u.tag))}return _A(r,p,_),W0(),!1}if(rt)return a=Ji.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=_,p!==pS&&(r=Error(n(422),{cause:p}),Op(Ds(r,u)))):(p!==pS&&(a=Error(n(423),{cause:p}),Op(Ds(a,u))),r=r.current.alternate,r.flags|=65536,_&=-_,r.lanes|=_,p=Ds(p,u),_=XS(r.stateNode,p,_),wS(r,_),tn!==4&&(tn=2)),!1;var S=Error(n(520),{cause:p});if(S=Ds(S,u),tg===null?tg=[S]:tg.push(S),tn!==4&&(tn=2),a===null)return!0;p=Ds(p,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,r=_&-_,u.lanes|=r,r=XS(u.stateNode,p,r),wS(u,r),!1;case 1:if(a=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(rl===null||!rl.has(S))))return u.flags|=65536,_&=-_,u.lanes|=_,_=O1(_),U1(_,r,u,p),wS(u,_),!1}u=u.return}while(u!==null);return!1}var KS=Error(n(461)),mn=!1;function zn(r,a,u,p){a.child=r===null?GC(a,null,u,p):Bc(a,r.child,u,p)}function F1(r,a,u,p,_){u=u.render;var S=a.ref;if("ref"in p){var C={};for(var D in p)D!=="ref"&&(C[D]=p[D])}else C=p;return Lc(a),p=MS(r,a,u,C,S,_),D=DS(),r!==null&&!mn?(kS(r,a,_),No(r,a,_)):(rt&&D&&hS(a),a.flags|=1,zn(r,a,p,_),a.child)}function B1(r,a,u,p,_){if(r===null){var S=u.type;return typeof S=="function"&&!cS(S)&&S.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=S,H1(r,a,S,p,_)):(r=y0(u.type,null,p,a,a.mode,_),r.ref=a.ref,r.return=a,a.child=r)}if(S=r.child,!sA(r,_)){var C=S.memoizedProps;if(u=u.compare,u=u!==null?u:kp,u(C,p)&&r.ref===a.ref)return No(r,a,_)}return a.flags|=1,r=To(S,p),r.ref=a.ref,r.return=a,a.child=r}function H1(r,a,u,p,_){if(r!==null){var S=r.memoizedProps;if(kp(S,p)&&r.ref===a.ref)if(mn=!1,a.pendingProps=p=S,sA(r,_))(r.flags&131072)!==0&&(mn=!0);else return a.lanes=r.lanes,No(r,a,_)}return JS(r,a,u,p,_)}function G1(r,a,u,p){var _=p.children,S=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(S=S!==null?S.baseLanes|u:u,r!==null){for(p=a.child=r.child,_=0;p!==null;)_=_|p.lanes|p.childLanes,p=p.sibling;p=_&~S}else p=0,a.child=null;return z1(r,a,S,u,p)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&S0(a,S!==null?S.cachePool:null),S!==null?qC(a,S):CS(),$C(a);else return p=a.lanes=536870912,z1(r,a,S!==null?S.baseLanes|u:u,u,p)}else S!==null?(S0(a,S.cachePool),qC(a,S),tl(),a.memoizedState=null):(r!==null&&S0(a,null),CS(),tl());return zn(r,a,_,u),a.child}function Wp(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function z1(r,a,u,p,_){var S=SS();return S=S===null?null:{parent:pn._currentValue,pool:S},a.memoizedState={baseLanes:u,cachePool:S},r!==null&&S0(a,null),CS(),$C(a),r!==null&&Yd(r,a,p,!0),a.childLanes=_,null}function U0(r,a){return a=B0({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function V1(r,a,u){return Bc(a,r.child,null,u),r=U0(a,a.pendingProps),r.flags|=2,Qi(a),a.memoizedState=null,r}function $U(r,a,u){var p=a.pendingProps,_=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(rt){if(p.mode==="hidden")return r=U0(a,p),a.lanes=536870912,Wp(null,r);if(IS(a),(r=Bt)?(r=tI(r,Ls),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ja!==null?{id:Pr,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},u=xC(r),u.return=a,a.child=u,Hn=a,Bt=null)):r=null,r===null)throw Xa(a);return a.lanes=536870912,null}return U0(a,p)}var S=r.memoizedState;if(S!==null){var C=S.dehydrated;if(IS(a),_)if(a.flags&256)a.flags&=-257,a=V1(r,a,u);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(n(558));else if(mn||Yd(r,a,u,!1),_=(u&r.childLanes)!==0,mn||_){if(p=It,p!==null&&(C=st(p,u),C!==0&&C!==S.retryLane))throw S.retryLane=C,Mc(r,C),Oi(p,r,C),KS;W0(),a=V1(r,a,u)}else r=S.treeContext,Bt=Us(C.nextSibling),Hn=a,rt=!0,Wa=null,Ls=!1,r!==null&&IC(a,r),a=U0(a,p),a.flags|=4096;return a}return r=To(r.child,{mode:p.mode,children:p.children}),r.ref=a.ref,a.child=r,r.return=a,r}function F0(r,a){var u=a.ref;if(u===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(a.flags|=4194816)}}function JS(r,a,u,p,_){return Lc(a),u=MS(r,a,u,p,void 0,_),p=DS(),r!==null&&!mn?(kS(r,a,_),No(r,a,_)):(rt&&p&&hS(a),a.flags|=1,zn(r,a,u,_),a.child)}function q1(r,a,u,p,_,S){return Lc(a),a.updateQueue=null,u=jC(a,p,u,_),YC(r),p=DS(),r!==null&&!mn?(kS(r,a,S),No(r,a,S)):(rt&&p&&hS(a),a.flags|=1,zn(r,a,u,S),a.child)}function $1(r,a,u,p,_){if(Lc(a),a.stateNode===null){var S=zd,C=u.contextType;typeof C=="object"&&C!==null&&(S=Gn(C)),S=new u(p,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=WS,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=p,S.state=a.memoizedState,S.refs={},ES(a),C=u.contextType,S.context=typeof C=="object"&&C!==null?Gn(C):zd,S.state=a.memoizedState,C=u.getDerivedStateFromProps,typeof C=="function"&&(jS(a,u,C,p),S.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(C=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),C!==S.state&&WS.enqueueReplaceState(S,S.state,null),Vp(a,p,S,_),zp(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(r===null){S=a.stateNode;var D=a.memoizedProps,B=Gc(u,D);S.props=B;var j=S.context,te=u.contextType;C=zd,typeof te=="object"&&te!==null&&(C=Gn(te));var ie=u.getDerivedStateFromProps;te=typeof ie=="function"||typeof S.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,te||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D||j!==C)&&M1(a,S,p,C),Ja=!1;var W=a.memoizedState;S.state=W,Vp(a,p,S,_),zp(),j=a.memoizedState,D||W!==j||Ja?(typeof ie=="function"&&(jS(a,u,ie,p),j=a.memoizedState),(B=Ja||N1(a,u,B,p,W,j,C))?(te||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=j),S.props=p,S.state=j,S.context=C,p=B):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{S=a.stateNode,TS(r,a),C=a.memoizedProps,te=Gc(u,C),S.props=te,ie=a.pendingProps,W=S.context,j=u.contextType,B=zd,typeof j=="object"&&j!==null&&(B=Gn(j)),D=u.getDerivedStateFromProps,(j=typeof D=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(C!==ie||W!==B)&&M1(a,S,p,B),Ja=!1,W=a.memoizedState,S.state=W,Vp(a,p,S,_),zp();var Q=a.memoizedState;C!==ie||W!==Q||Ja||r!==null&&r.dependencies!==null&&b0(r.dependencies)?(typeof D=="function"&&(jS(a,u,D,p),Q=a.memoizedState),(te=Ja||N1(a,u,te,p,W,Q,B)||r!==null&&r.dependencies!==null&&b0(r.dependencies))?(j||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,Q,B),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,Q,B)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||C===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=Q),S.props=p,S.state=Q,S.context=B,p=te):(typeof S.componentDidUpdate!="function"||C===r.memoizedProps&&W===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&W===r.memoizedState||(a.flags|=1024),p=!1)}return S=p,F0(r,a),p=(a.flags&128)!==0,S||p?(S=a.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,r!==null&&p?(a.child=Bc(a,r.child,null,_),a.child=Bc(a,null,u,_)):zn(r,a,u,_),a.memoizedState=S.state,r=a.child):r=No(r,a,_),r}function Y1(r,a,u,p){return kc(),a.flags|=256,zn(r,a,u,p),a.child}var QS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ZS(r){return{baseLanes:r,cachePool:LC()}}function eA(r,a,u){return r=r!==null?r.childLanes&~u:0,a&&(r|=es),r}function j1(r,a,u){var p=a.pendingProps,_=!1,S=(a.flags&128)!==0,C;if((C=S)||(C=r!==null&&r.memoizedState===null?!1:(ln.current&2)!==0),C&&(_=!0,a.flags&=-129),C=(a.flags&32)!==0,a.flags&=-33,r===null){if(rt){if(_?el(a):tl(),(r=Bt)?(r=tI(r,Ls),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ja!==null?{id:Pr,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},u=xC(r),u.return=a,a.child=u,Hn=a,Bt=null)):r=null,r===null)throw Xa(a);return OA(r)?a.lanes=32:a.lanes=536870912,null}var D=p.children;return p=p.fallback,_?(tl(),_=a.mode,D=B0({mode:"hidden",children:D},_),p=Dc(p,_,u,null),D.return=a,p.return=a,D.sibling=p,a.child=D,p=a.child,p.memoizedState=ZS(u),p.childLanes=eA(r,C,u),a.memoizedState=QS,Wp(null,p)):(el(a),tA(a,D))}var B=r.memoizedState;if(B!==null&&(D=B.dehydrated,D!==null)){if(S)a.flags&256?(el(a),a.flags&=-257,a=nA(r,a,u)):a.memoizedState!==null?(tl(),a.child=r.child,a.flags|=128,a=null):(tl(),D=p.fallback,_=a.mode,p=B0({mode:"visible",children:p.children},_),D=Dc(D,_,u,null),D.flags|=2,p.return=a,D.return=a,p.sibling=D,a.child=p,Bc(a,r.child,null,u),p=a.child,p.memoizedState=ZS(u),p.childLanes=eA(r,C,u),a.memoizedState=QS,a=Wp(null,p));else if(el(a),OA(D)){if(C=D.nextSibling&&D.nextSibling.dataset,C)var j=C.dgst;C=j,p=Error(n(419)),p.stack="",p.digest=C,Op({value:p,source:null,stack:null}),a=nA(r,a,u)}else if(mn||Yd(r,a,u,!1),C=(u&r.childLanes)!==0,mn||C){if(C=It,C!==null&&(p=st(C,u),p!==0&&p!==B.retryLane))throw B.retryLane=p,Mc(r,p),Oi(C,r,p),KS;LA(D)||W0(),a=nA(r,a,u)}else LA(D)?(a.flags|=192,a.child=r.child,a=null):(r=B.treeContext,Bt=Us(D.nextSibling),Hn=a,rt=!0,Wa=null,Ls=!1,r!==null&&IC(a,r),a=tA(a,p.children),a.flags|=4096);return a}return _?(tl(),D=p.fallback,_=a.mode,B=r.child,j=B.sibling,p=To(B,{mode:"hidden",children:p.children}),p.subtreeFlags=B.subtreeFlags&65011712,j!==null?D=To(j,D):(D=Dc(D,_,u,null),D.flags|=2),D.return=a,p.return=a,p.sibling=D,a.child=p,Wp(null,p),p=a.child,D=r.child.memoizedState,D===null?D=ZS(u):(_=D.cachePool,_!==null?(B=pn._currentValue,_=_.parent!==B?{parent:B,pool:B}:_):_=LC(),D={baseLanes:D.baseLanes|u,cachePool:_}),p.memoizedState=D,p.childLanes=eA(r,C,u),a.memoizedState=QS,Wp(r.child,p)):(el(a),u=r.child,r=u.sibling,u=To(u,{mode:"visible",children:p.children}),u.return=a,u.sibling=null,r!==null&&(C=a.deletions,C===null?(a.deletions=[r],a.flags|=16):C.push(r)),a.child=u,a.memoizedState=null,u)}function tA(r,a){return a=B0({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function B0(r,a){return r=Ki(22,r,null,a),r.lanes=0,r}function nA(r,a,u){return Bc(a,r.child,null,u),r=tA(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function W1(r,a,u){r.lanes|=a;var p=r.alternate;p!==null&&(p.lanes|=a),yS(r.return,a,u)}function iA(r,a,u,p,_,S){var C=r.memoizedState;C===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:_,treeForkCount:S}:(C.isBackwards=a,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=u,C.tailMode=_,C.treeForkCount=S)}function X1(r,a,u){var p=a.pendingProps,_=p.revealOrder,S=p.tail;p=p.children;var C=ln.current,D=(C&2)!==0;if(D?(C=C&1|2,a.flags|=128):C&=1,re(ln,C),zn(r,a,p,u),p=rt?Lp:0,!D&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&W1(r,u,a);else if(r.tag===19)W1(r,u,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(_){case"forwards":for(u=a.child,_=null;u!==null;)r=u.alternate,r!==null&&C0(r)===null&&(_=u),u=u.sibling;u=_,u===null?(_=a.child,a.child=null):(_=u.sibling,u.sibling=null),iA(a,!1,_,u,S,p);break;case"backwards":case"unstable_legacy-backwards":for(u=null,_=a.child,a.child=null;_!==null;){if(r=_.alternate,r!==null&&C0(r)===null){a.child=_;break}r=_.sibling,_.sibling=u,u=_,_=r}iA(a,!0,u,null,S,p);break;case"together":iA(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function No(r,a,u){if(r!==null&&(a.dependencies=r.dependencies),sl|=a.lanes,(u&a.childLanes)===0)if(r!==null){if(Yd(r,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,u=To(r,r.pendingProps),a.child=u,u.return=a;r.sibling!==null;)r=r.sibling,u=u.sibling=To(r,r.pendingProps),u.return=a;u.sibling=null}return a.child}function sA(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&b0(r)))}function YU(r,a,u){switch(a.tag){case 3:Ke(a,a.stateNode.containerInfo),Ka(a,pn,r.memoizedState.cache),kc();break;case 27:case 5:zt(a);break;case 4:Ke(a,a.stateNode.containerInfo);break;case 10:Ka(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,IS(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(el(a),a.flags|=128,null):(u&a.child.childLanes)!==0?j1(r,a,u):(el(a),r=No(r,a,u),r!==null?r.sibling:null);el(a);break;case 19:var _=(r.flags&128)!==0;if(p=(u&a.childLanes)!==0,p||(Yd(r,a,u,!1),p=(u&a.childLanes)!==0),_){if(p)return X1(r,a,u);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),re(ln,ln.current),p)break;return null;case 22:return a.lanes=0,G1(r,a,u,a.pendingProps);case 24:Ka(a,pn,r.memoizedState.cache)}return No(r,a,u)}function K1(r,a,u){if(r!==null)if(r.memoizedProps!==a.pendingProps)mn=!0;else{if(!sA(r,u)&&(a.flags&128)===0)return mn=!1,YU(r,a,u);mn=(r.flags&131072)!==0}else mn=!1,rt&&(a.flags&1048576)!==0&&RC(a,Lp,a.index);switch(a.lanes=0,a.tag){case 16:e:{var p=a.pendingProps;if(r=Uc(a.elementType),a.type=r,typeof r=="function")cS(r)?(p=Gc(r,p),a.tag=1,a=$1(null,a,r,p,u)):(a.tag=0,a=JS(null,a,r,p,u));else{if(r!=null){var _=r.$$typeof;if(_===L){a.tag=11,a=F1(null,a,r,p,u);break e}else if(_===U){a.tag=14,a=B1(null,a,r,p,u);break e}}throw a=ue(r)||r,Error(n(306,a,""))}}return a;case 0:return JS(r,a,a.type,a.pendingProps,u);case 1:return p=a.type,_=Gc(p,a.pendingProps),$1(r,a,p,_,u);case 3:e:{if(Ke(a,a.stateNode.containerInfo),r===null)throw Error(n(387));p=a.pendingProps;var S=a.memoizedState;_=S.element,TS(r,a),Vp(a,p,null,u);var C=a.memoizedState;if(p=C.cache,Ka(a,pn,p),p!==S.cache&&vS(a,[pn],u,!0),zp(),p=C.element,S.isDehydrated)if(S={element:p,isDehydrated:!1,cache:C.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=Y1(r,a,p,u);break e}else if(p!==_){_=Ds(Error(n(424)),a),Op(_),a=Y1(r,a,p,u);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Bt=Us(r.firstChild),Hn=a,rt=!0,Wa=null,Ls=!0,u=GC(a,null,p,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(kc(),p===_){a=No(r,a,u);break e}zn(r,a,p,u)}a=a.child}return a;case 26:return F0(r,a),r===null?(u=aI(a.type,null,a.pendingProps,null))?a.memoizedState=u:rt||(u=a.type,r=a.pendingProps,p=tv(Se.current).createElement(u),p[Bn]=a,p[Ni]=r,Vn(p,u,r),Cn(p),a.stateNode=p):a.memoizedState=aI(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return zt(a),r===null&&rt&&(p=a.stateNode=sI(a.type,a.pendingProps,Se.current),Hn=a,Ls=!0,_=Bt,cl(a.type)?(UA=_,Bt=Us(p.firstChild)):Bt=_),zn(r,a,a.pendingProps.children,u),F0(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&rt&&((_=p=Bt)&&(p=AF(p,a.type,a.pendingProps,Ls),p!==null?(a.stateNode=p,Hn=a,Bt=Us(p.firstChild),Ls=!1,_=!0):_=!1),_||Xa(a)),zt(a),_=a.type,S=a.pendingProps,C=r!==null?r.memoizedProps:null,p=S.children,DA(_,S)?p=null:C!==null&&DA(_,C)&&(a.flags|=32),a.memoizedState!==null&&(_=MS(r,a,UU,null,null,u),cg._currentValue=_),F0(r,a),zn(r,a,p,u),a.child;case 6:return r===null&&rt&&((r=u=Bt)&&(u=EF(u,a.pendingProps,Ls),u!==null?(a.stateNode=u,Hn=a,Bt=null,r=!0):r=!1),r||Xa(a)),null;case 13:return j1(r,a,u);case 4:return Ke(a,a.stateNode.containerInfo),p=a.pendingProps,r===null?a.child=Bc(a,null,p,u):zn(r,a,p,u),a.child;case 11:return F1(r,a,a.type,a.pendingProps,u);case 7:return zn(r,a,a.pendingProps,u),a.child;case 8:return zn(r,a,a.pendingProps.children,u),a.child;case 12:return zn(r,a,a.pendingProps.children,u),a.child;case 10:return p=a.pendingProps,Ka(a,a.type,p.value),zn(r,a,p.children,u),a.child;case 9:return _=a.type._context,p=a.pendingProps.children,Lc(a),_=Gn(_),p=p(_),a.flags|=1,zn(r,a,p,u),a.child;case 14:return B1(r,a,a.type,a.pendingProps,u);case 15:return H1(r,a,a.type,a.pendingProps,u);case 19:return X1(r,a,u);case 31:return $U(r,a,u);case 22:return G1(r,a,u,a.pendingProps);case 24:return Lc(a),p=Gn(pn),r===null?(_=SS(),_===null&&(_=It,S=bS(),_.pooledCache=S,S.refCount++,S!==null&&(_.pooledCacheLanes|=u),_=S),a.memoizedState={parent:p,cache:_},ES(a),Ka(a,pn,_)):((r.lanes&u)!==0&&(TS(r,a),Vp(a,null,null,u),zp()),_=r.memoizedState,S=a.memoizedState,_.parent!==p?(_={parent:p,cache:p},a.memoizedState=_,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=_),Ka(a,pn,p)):(p=S.cache,Ka(a,pn,p),p!==_.cache&&vS(a,[pn],u,!0))),zn(r,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Mo(r){r.flags|=4}function rA(r,a,u,p,_){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(_&335544128)===_)if(r.stateNode.complete)r.flags|=8192;else if(ER())r.flags|=8192;else throw Fc=E0,AS}else r.flags&=-16777217}function J1(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!hI(a))if(ER())r.flags|=8192;else throw Fc=E0,AS}function H0(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?n0():536870912,r.lanes|=a,sh|=a)}function Xp(r,a){if(!rt)switch(r.tailMode){case"hidden":a=r.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:p.sibling=null}}function Ht(r){var a=r.alternate!==null&&r.alternate.child===r.child,u=0,p=0;if(a)for(var _=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=p,r.childLanes=u,a}function jU(r,a,u){var p=a.pendingProps;switch(fS(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(a),null;case 1:return Ht(a),null;case 3:return u=a.stateNode,p=null,r!==null&&(p=r.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),Co(pn),Ve(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&($d(a)?Mo(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,gS())),Ht(a),null;case 26:var _=a.type,S=a.memoizedState;return r===null?(Mo(a),S!==null?(Ht(a),J1(a,S)):(Ht(a),rA(a,_,null,p,u))):S?S!==r.memoizedState?(Mo(a),Ht(a),J1(a,S)):(Ht(a),a.flags&=-16777217):(r=r.memoizedProps,r!==p&&Mo(a),Ht(a),rA(a,_,r,p,u)),null;case 27:if(We(a),u=Se.current,_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&Mo(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return Ht(a),null}r=de.current,$d(a)?NC(a):(r=sI(_,p,u),a.stateNode=r,Mo(a))}return Ht(a),null;case 5:if(We(a),_=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==p&&Mo(a);else{if(!p){if(a.stateNode===null)throw Error(n(166));return Ht(a),null}if(S=de.current,$d(a))NC(a);else{var C=tv(Se.current);switch(S){case 1:S=C.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:S=C.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":S=C.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":S=C.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":S=C.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof p.is=="string"?C.createElement("select",{is:p.is}):C.createElement("select"),p.multiple?S.multiple=!0:p.size&&(S.size=p.size);break;default:S=typeof p.is=="string"?C.createElement(_,{is:p.is}):C.createElement(_)}}S[Bn]=a,S[Ni]=p;e:for(C=a.child;C!==null;){if(C.tag===5||C.tag===6)S.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===a)break e;for(;C.sibling===null;){if(C.return===null||C.return===a)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}a.stateNode=S;e:switch(Vn(S,_,p),_){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Mo(a)}}return Ht(a),rA(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,u),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==p&&Mo(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(n(166));if(r=Se.current,$d(a)){if(r=a.stateNode,u=a.memoizedProps,p=null,_=Hn,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}r[Bn]=a,r=!!(r.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||jR(r.nodeValue,u)),r||Xa(a,!0)}else r=tv(r).createTextNode(p),r[Bn]=a,a.stateNode=r}return Ht(a),null;case 31:if(u=a.memoizedState,r===null||r.memoizedState!==null){if(p=$d(a),u!==null){if(r===null){if(!p)throw Error(n(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Bn]=a}else kc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),r=!1}else u=gS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return a.flags&256?(Qi(a),a):(Qi(a),null);if((a.flags&128)!==0)throw Error(n(558))}return Ht(a),null;case 13:if(p=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(_=$d(a),p!==null&&p.dehydrated!==null){if(r===null){if(!_)throw Error(n(318));if(_=a.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[Bn]=a}else kc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),_=!1}else _=gS(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=_),_=!0;if(!_)return a.flags&256?(Qi(a),a):(Qi(a),null)}return Qi(a),(a.flags&128)!==0?(a.lanes=u,a):(u=p!==null,r=r!==null&&r.memoizedState!==null,u&&(p=a.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool),S=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==_&&(p.flags|=2048)),u!==r&&u&&(a.child.flags|=8192),H0(a,a.updateQueue),Ht(a),null);case 4:return Ve(),r===null&&CA(a.stateNode.containerInfo),Ht(a),null;case 10:return Co(a.type),Ht(a),null;case 19:if(K(ln),p=a.memoizedState,p===null)return Ht(a),null;if(_=(a.flags&128)!==0,S=p.rendering,S===null)if(_)Xp(p,!1);else{if(tn!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=C0(r),S!==null){for(a.flags|=128,Xp(p,!1),r=S.updateQueue,a.updateQueue=r,H0(a,r),a.subtreeFlags=0,r=u,u=a.child;u!==null;)wC(u,r),u=u.sibling;return re(ln,ln.current&1|2),rt&&wo(a,p.treeForkCount),a.child}r=r.sibling}p.tail!==null&&Ce()>$0&&(a.flags|=128,_=!0,Xp(p,!1),a.lanes=4194304)}else{if(!_)if(r=C0(S),r!==null){if(a.flags|=128,_=!0,r=r.updateQueue,a.updateQueue=r,H0(a,r),Xp(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!rt)return Ht(a),null}else 2*Ce()-p.renderingStartTime>$0&&u!==536870912&&(a.flags|=128,_=!0,Xp(p,!1),a.lanes=4194304);p.isBackwards?(S.sibling=a.child,a.child=S):(r=p.last,r!==null?r.sibling=S:a.child=S,p.last=S)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=Ce(),r.sibling=null,u=ln.current,re(ln,_?u&1|2:u&1),rt&&wo(a,p.treeForkCount),r):(Ht(a),null);case 22:case 23:return Qi(a),RS(),p=a.memoizedState!==null,r!==null?r.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(u&536870912)!==0&&(a.flags&128)===0&&(Ht(a),a.subtreeFlags&6&&(a.flags|=8192)):Ht(a),u=a.updateQueue,u!==null&&H0(a,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==u&&(a.flags|=2048),r!==null&&K(Oc),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Co(pn),Ht(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function WU(r,a){switch(fS(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Co(pn),Ve(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return We(a),null;case 31:if(a.memoizedState!==null){if(Qi(a),a.alternate===null)throw Error(n(340));kc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Qi(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));kc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return K(ln),null;case 4:return Ve(),null;case 10:return Co(a.type),null;case 22:case 23:return Qi(a),RS(),r!==null&&K(Oc),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Co(pn),null;case 25:return null;default:return null}}function Q1(r,a){switch(fS(a),a.tag){case 3:Co(pn),Ve();break;case 26:case 27:case 5:We(a);break;case 4:Ve();break;case 31:a.memoizedState!==null&&Qi(a);break;case 13:Qi(a);break;case 19:K(ln);break;case 10:Co(a.type);break;case 22:case 23:Qi(a),RS(),r!==null&&K(Oc);break;case 24:Co(pn)}}function Kp(r,a){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var _=p.next;u=_;do{if((u.tag&r)===r){p=void 0;var S=u.create,C=u.inst;p=S(),C.destroy=p}u=u.next}while(u!==_)}}catch(D){vt(a,a.return,D)}}function nl(r,a,u){try{var p=a.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var S=_.next;p=S;do{if((p.tag&r)===r){var C=p.inst,D=C.destroy;if(D!==void 0){C.destroy=void 0,_=a;var B=u,j=D;try{j()}catch(te){vt(_,B,te)}}}p=p.next}while(p!==S)}}catch(te){vt(a,a.return,te)}}function Z1(r){var a=r.updateQueue;if(a!==null){var u=r.stateNode;try{VC(a,u)}catch(p){vt(r,r.return,p)}}}function eR(r,a,u){u.props=Gc(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(p){vt(r,a,p)}}function Jp(r,a){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var p=r.stateNode;break;case 30:p=r.stateNode;break;default:p=r.stateNode}typeof u=="function"?r.refCleanup=u(p):u.current=p}}catch(_){vt(r,a,_)}}function Or(r,a){var u=r.ref,p=r.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(_){vt(r,a,_)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){vt(r,a,_)}else u.current=null}function tR(r){var a=r.type,u=r.memoizedProps,p=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(_){vt(r,r.return,_)}}function oA(r,a,u){try{var p=r.stateNode;mF(p,r.type,u,a),p[Ni]=a}catch(_){vt(r,r.return,_)}}function nR(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&cl(r.type)||r.tag===4}function aA(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||nR(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&cl(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function lA(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(r),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=Ao));else if(p!==4&&(p===27&&cl(r.type)&&(u=r.stateNode,a=null),r=r.child,r!==null))for(lA(r,a,u),r=r.sibling;r!==null;)lA(r,a,u),r=r.sibling}function G0(r,a,u){var p=r.tag;if(p===5||p===6)r=r.stateNode,a?u.insertBefore(r,a):u.appendChild(r);else if(p!==4&&(p===27&&cl(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(G0(r,a,u),r=r.sibling;r!==null;)G0(r,a,u),r=r.sibling}function iR(r){var a=r.stateNode,u=r.memoizedProps;try{for(var p=r.type,_=a.attributes;_.length;)a.removeAttributeNode(_[0]);Vn(a,p,u),a[Bn]=r,a[Ni]=u}catch(S){vt(r,r.return,S)}}var Do=!1,yn=!1,cA=!1,sR=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function XU(r,a){if(r=r.containerInfo,NA=lv,r=mC(r),nS(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var _=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var C=0,D=-1,B=-1,j=0,te=0,ie=r,W=null;t:for(;;){for(var Q;ie!==u||_!==0&&ie.nodeType!==3||(D=C+_),ie!==S||p!==0&&ie.nodeType!==3||(B=C+p),ie.nodeType===3&&(C+=ie.nodeValue.length),(Q=ie.firstChild)!==null;)W=ie,ie=Q;for(;;){if(ie===r)break t;if(W===u&&++j===_&&(D=C),W===S&&++te===p&&(B=C),(Q=ie.nextSibling)!==null)break;ie=W,W=ie.parentNode}ie=Q}u=D===-1||B===-1?null:{start:D,end:B}}else u=null}u=u||{start:0,end:0}}else u=null;for(MA={focusedElem:r,selectionRange:u},lv=!1,Rn=a;Rn!==null;)if(a=Rn,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,Rn=r;else for(;Rn!==null;){switch(a=Rn,S=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)_=r[u],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&S!==null){r=void 0,u=a,_=S.memoizedProps,S=S.memoizedState,p=u.stateNode;try{var Ae=Gc(u.type,_);r=p.getSnapshotBeforeUpdate(Ae,S),p.__reactInternalSnapshotBeforeUpdate=r}catch(Ie){vt(u,u.return,Ie)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,u=r.nodeType,u===9)PA(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":PA(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=a.sibling,r!==null){r.return=a.return,Rn=r;break}Rn=a.return}}function rR(r,a,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Po(r,u),p&4&&Kp(5,u);break;case 1:if(Po(r,u),p&4)if(r=u.stateNode,a===null)try{r.componentDidMount()}catch(C){vt(u,u.return,C)}else{var _=Gc(u.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(_,a,r.__reactInternalSnapshotBeforeUpdate)}catch(C){vt(u,u.return,C)}}p&64&&Z1(u),p&512&&Jp(u,u.return);break;case 3:if(Po(r,u),p&64&&(r=u.updateQueue,r!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{VC(r,a)}catch(C){vt(u,u.return,C)}}break;case 27:a===null&&p&4&&iR(u);case 26:case 5:Po(r,u),a===null&&p&4&&tR(u),p&512&&Jp(u,u.return);break;case 12:Po(r,u);break;case 31:Po(r,u),p&4&&lR(r,u);break;case 13:Po(r,u),p&4&&cR(r,u),p&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=sF.bind(null,u),TF(r,u))));break;case 22:if(p=u.memoizedState!==null||Do,!p){a=a!==null&&a.memoizedState!==null||yn,_=Do;var S=yn;Do=p,(yn=a)&&!S?Lo(r,u,(u.subtreeFlags&8772)!==0):Po(r,u),Do=_,yn=S}break;case 30:break;default:Po(r,u)}}function oR(r){var a=r.alternate;a!==null&&(r.alternate=null,oR(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&B_(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var qt=null,Di=!1;function ko(r,a,u){for(u=u.child;u!==null;)aR(r,a,u),u=u.sibling}function aR(r,a,u){if(gi&&typeof gi.onCommitFiberUnmount=="function")try{gi.onCommitFiberUnmount(qa,u)}catch{}switch(u.tag){case 26:yn||Or(u,a),ko(r,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:yn||Or(u,a);var p=qt,_=Di;cl(u.type)&&(qt=u.stateNode,Di=!1),ko(r,a,u),og(u.stateNode),qt=p,Di=_;break;case 5:yn||Or(u,a);case 6:if(p=qt,_=Di,qt=null,ko(r,a,u),qt=p,Di=_,qt!==null)if(Di)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(u.stateNode)}catch(S){vt(u,a,S)}else try{qt.removeChild(u.stateNode)}catch(S){vt(u,a,S)}break;case 18:qt!==null&&(Di?(r=qt,ZR(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),hh(r)):ZR(qt,u.stateNode));break;case 4:p=qt,_=Di,qt=u.stateNode.containerInfo,Di=!0,ko(r,a,u),qt=p,Di=_;break;case 0:case 11:case 14:case 15:nl(2,u,a),yn||nl(4,u,a),ko(r,a,u);break;case 1:yn||(Or(u,a),p=u.stateNode,typeof p.componentWillUnmount=="function"&&eR(u,a,p)),ko(r,a,u);break;case 21:ko(r,a,u);break;case 22:yn=(p=yn)||u.memoizedState!==null,ko(r,a,u),yn=p;break;default:ko(r,a,u)}}function lR(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{hh(r)}catch(u){vt(a,a.return,u)}}}function cR(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{hh(r)}catch(u){vt(a,a.return,u)}}function KU(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new sR),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new sR),a;default:throw Error(n(435,r.tag))}}function z0(r,a){var u=KU(r);a.forEach(function(p){if(!u.has(p)){u.add(p);var _=rF.bind(null,r,p);p.then(_,_)}})}function ki(r,a){var u=a.deletions;if(u!==null)for(var p=0;p<u.length;p++){var _=u[p],S=r,C=a,D=C;e:for(;D!==null;){switch(D.tag){case 27:if(cl(D.type)){qt=D.stateNode,Di=!1;break e}break;case 5:qt=D.stateNode,Di=!1;break e;case 3:case 4:qt=D.stateNode.containerInfo,Di=!0;break e}D=D.return}if(qt===null)throw Error(n(160));aR(S,C,_),qt=null,Di=!1,S=_.alternate,S!==null&&(S.return=null),_.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)uR(a,r),a=a.sibling}var rr=null;function uR(r,a){var u=r.alternate,p=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ki(a,r),Pi(r),p&4&&(nl(3,r,r.return),Kp(3,r),nl(5,r,r.return));break;case 1:ki(a,r),Pi(r),p&512&&(yn||u===null||Or(u,u.return)),p&64&&Do&&(r=r.updateQueue,r!==null&&(p=r.callbacks,p!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var _=rr;if(ki(a,r),Pi(r),p&512&&(yn||u===null||Or(u,u.return)),p&4){var S=u!==null?u.memoizedState:null;if(p=r.memoizedState,u===null)if(p===null)if(r.stateNode===null){e:{p=r.type,u=r.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":S=_.getElementsByTagName("title")[0],(!S||S[Tp]||S[Bn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=_.createElement(p),_.head.insertBefore(S,_.querySelector("head > title"))),Vn(S,p,u),S[Bn]=r,Cn(S),p=S;break e;case"link":var C=uI("link","href",_).get(p+(u.href||""));if(C){for(var D=0;D<C.length;D++)if(S=C[D],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){C.splice(D,1);break t}}S=_.createElement(p),Vn(S,p,u),_.head.appendChild(S);break;case"meta":if(C=uI("meta","content",_).get(p+(u.content||""))){for(D=0;D<C.length;D++)if(S=C[D],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){C.splice(D,1);break t}}S=_.createElement(p),Vn(S,p,u),_.head.appendChild(S);break;default:throw Error(n(468,p))}S[Bn]=r,Cn(S),p=S}r.stateNode=p}else dI(_,r.type,r.stateNode);else r.stateNode=cI(_,p,r.memoizedProps);else S!==p?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,p===null?dI(_,r.type,r.stateNode):cI(_,p,r.memoizedProps)):p===null&&r.stateNode!==null&&oA(r,r.memoizedProps,u.memoizedProps)}break;case 27:ki(a,r),Pi(r),p&512&&(yn||u===null||Or(u,u.return)),u!==null&&p&4&&oA(r,r.memoizedProps,u.memoizedProps);break;case 5:if(ki(a,r),Pi(r),p&512&&(yn||u===null||Or(u,u.return)),r.flags&32){_=r.stateNode;try{Ld(_,"")}catch(Ae){vt(r,r.return,Ae)}}p&4&&r.stateNode!=null&&(_=r.memoizedProps,oA(r,_,u!==null?u.memoizedProps:_)),p&1024&&(cA=!0);break;case 6:if(ki(a,r),Pi(r),p&4){if(r.stateNode===null)throw Error(n(162));p=r.memoizedProps,u=r.stateNode;try{u.nodeValue=p}catch(Ae){vt(r,r.return,Ae)}}break;case 3:if(sv=null,_=rr,rr=nv(a.containerInfo),ki(a,r),rr=_,Pi(r),p&4&&u!==null&&u.memoizedState.isDehydrated)try{hh(a.containerInfo)}catch(Ae){vt(r,r.return,Ae)}cA&&(cA=!1,dR(r));break;case 4:p=rr,rr=nv(r.stateNode.containerInfo),ki(a,r),Pi(r),rr=p;break;case 12:ki(a,r),Pi(r);break;case 31:ki(a,r),Pi(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,z0(r,p)));break;case 13:ki(a,r),Pi(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(q0=Ce()),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,z0(r,p)));break;case 22:_=r.memoizedState!==null;var B=u!==null&&u.memoizedState!==null,j=Do,te=yn;if(Do=j||_,yn=te||B,ki(a,r),yn=te,Do=j,Pi(r),p&8192)e:for(a=r.stateNode,a._visibility=_?a._visibility&-2:a._visibility|1,_&&(u===null||B||Do||yn||zc(r)),u=null,a=r;;){if(a.tag===5||a.tag===26){if(u===null){B=u=a;try{if(S=B.stateNode,_)C=S.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{D=B.stateNode;var ie=B.memoizedProps.style,W=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;D.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Ae){vt(B,B.return,Ae)}}}else if(a.tag===6){if(u===null){B=a;try{B.stateNode.nodeValue=_?"":B.memoizedProps}catch(Ae){vt(B,B.return,Ae)}}}else if(a.tag===18){if(u===null){B=a;try{var Q=B.stateNode;_?eI(Q,!0):eI(B.stateNode,!1)}catch(Ae){vt(B,B.return,Ae)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=r.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,z0(r,u))));break;case 19:ki(a,r),Pi(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,z0(r,p)));break;case 30:break;case 21:break;default:ki(a,r),Pi(r)}}function Pi(r){var a=r.flags;if(a&2){try{for(var u,p=r.return;p!==null;){if(nR(p)){u=p;break}p=p.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var _=u.stateNode,S=aA(r);G0(r,S,_);break;case 5:var C=u.stateNode;u.flags&32&&(Ld(C,""),u.flags&=-33);var D=aA(r);G0(r,D,C);break;case 3:case 4:var B=u.stateNode.containerInfo,j=aA(r);lA(r,j,B);break;default:throw Error(n(161))}}catch(te){vt(r,r.return,te)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function dR(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;dR(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Po(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)rR(r,a.alternate,a),a=a.sibling}function zc(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:nl(4,a,a.return),zc(a);break;case 1:Or(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&eR(a,a.return,u),zc(a);break;case 27:og(a.stateNode);case 26:case 5:Or(a,a.return),zc(a);break;case 22:a.memoizedState===null&&zc(a);break;case 30:zc(a);break;default:zc(a)}r=r.sibling}}function Lo(r,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,_=r,S=a,C=S.flags;switch(S.tag){case 0:case 11:case 15:Lo(_,S,u),Kp(4,S);break;case 1:if(Lo(_,S,u),p=S,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(j){vt(p,p.return,j)}if(p=S,_=p.updateQueue,_!==null){var D=p.stateNode;try{var B=_.shared.hiddenCallbacks;if(B!==null)for(_.shared.hiddenCallbacks=null,_=0;_<B.length;_++)zC(B[_],D)}catch(j){vt(p,p.return,j)}}u&&C&64&&Z1(S),Jp(S,S.return);break;case 27:iR(S);case 26:case 5:Lo(_,S,u),u&&p===null&&C&4&&tR(S),Jp(S,S.return);break;case 12:Lo(_,S,u);break;case 31:Lo(_,S,u),u&&C&4&&lR(_,S);break;case 13:Lo(_,S,u),u&&C&4&&cR(_,S);break;case 22:S.memoizedState===null&&Lo(_,S,u),Jp(S,S.return);break;case 30:break;default:Lo(_,S,u)}a=a.sibling}}function uA(r,a){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Up(u))}function dA(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Up(r))}function or(r,a,u,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)hR(r,a,u,p),a=a.sibling}function hR(r,a,u,p){var _=a.flags;switch(a.tag){case 0:case 11:case 15:or(r,a,u,p),_&2048&&Kp(9,a);break;case 1:or(r,a,u,p);break;case 3:or(r,a,u,p),_&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Up(r)));break;case 12:if(_&2048){or(r,a,u,p),r=a.stateNode;try{var S=a.memoizedProps,C=S.id,D=S.onPostCommit;typeof D=="function"&&D(C,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(B){vt(a,a.return,B)}}else or(r,a,u,p);break;case 31:or(r,a,u,p);break;case 13:or(r,a,u,p);break;case 23:break;case 22:S=a.stateNode,C=a.alternate,a.memoizedState!==null?S._visibility&2?or(r,a,u,p):Qp(r,a):S._visibility&2?or(r,a,u,p):(S._visibility|=2,th(r,a,u,p,(a.subtreeFlags&10256)!==0||!1)),_&2048&&uA(C,a);break;case 24:or(r,a,u,p),_&2048&&dA(a.alternate,a);break;default:or(r,a,u,p)}}function th(r,a,u,p,_){for(_=_&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var S=r,C=a,D=u,B=p,j=C.flags;switch(C.tag){case 0:case 11:case 15:th(S,C,D,B,_),Kp(8,C);break;case 23:break;case 22:var te=C.stateNode;C.memoizedState!==null?te._visibility&2?th(S,C,D,B,_):Qp(S,C):(te._visibility|=2,th(S,C,D,B,_)),_&&j&2048&&uA(C.alternate,C);break;case 24:th(S,C,D,B,_),_&&j&2048&&dA(C.alternate,C);break;default:th(S,C,D,B,_)}a=a.sibling}}function Qp(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=r,p=a,_=p.flags;switch(p.tag){case 22:Qp(u,p),_&2048&&uA(p.alternate,p);break;case 24:Qp(u,p),_&2048&&dA(p.alternate,p);break;default:Qp(u,p)}a=a.sibling}}var Zp=8192;function nh(r,a,u){if(r.subtreeFlags&Zp)for(r=r.child;r!==null;)fR(r,a,u),r=r.sibling}function fR(r,a,u){switch(r.tag){case 26:nh(r,a,u),r.flags&Zp&&r.memoizedState!==null&&OF(u,rr,r.memoizedState,r.memoizedProps);break;case 5:nh(r,a,u);break;case 3:case 4:var p=rr;rr=nv(r.stateNode.containerInfo),nh(r,a,u),rr=p;break;case 22:r.memoizedState===null&&(p=r.alternate,p!==null&&p.memoizedState!==null?(p=Zp,Zp=16777216,nh(r,a,u),Zp=p):nh(r,a,u));break;default:nh(r,a,u)}}function pR(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function eg(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Rn=p,mR(p,r)}pR(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)gR(r),r=r.sibling}function gR(r){switch(r.tag){case 0:case 11:case 15:eg(r),r.flags&2048&&nl(9,r,r.return);break;case 3:eg(r);break;case 12:eg(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,V0(r)):eg(r);break;default:eg(r)}}function V0(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var p=a[u];Rn=p,mR(p,r)}pR(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:nl(8,a,a.return),V0(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,V0(a));break;default:V0(a)}r=r.sibling}}function mR(r,a){for(;Rn!==null;){var u=Rn;switch(u.tag){case 0:case 11:case 15:nl(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Up(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Rn=p;else e:for(u=r;Rn!==null;){p=Rn;var _=p.sibling,S=p.return;if(oR(p),p===u){Rn=null;break e}if(_!==null){_.return=S,Rn=_;break e}Rn=S}}}var JU={getCacheForType:function(r){var a=Gn(pn),u=a.data.get(r);return u===void 0&&(u=r(),a.data.set(r,u)),u},cacheSignal:function(){return Gn(pn).controller.signal}},QU=typeof WeakMap=="function"?WeakMap:Map,ft=0,It=null,Ze=null,tt=0,yt=0,Zi=null,il=!1,ih=!1,hA=!1,Oo=0,tn=0,sl=0,Vc=0,fA=0,es=0,sh=0,tg=null,Li=null,pA=!1,q0=0,yR=0,$0=1/0,Y0=null,rl=null,Sn=0,ol=null,rh=null,Uo=0,gA=0,mA=null,vR=null,ng=0,yA=null;function ts(){return(ft&2)!==0&&tt!==0?tt&-tt:G.T!==null?EA():Px()}function bR(){if(es===0)if((tt&536870912)===0||rt){var r=wd;wd<<=1,(wd&3932160)===0&&(wd=262144),es=r}else es=536870912;return r=Ji.current,r!==null&&(r.flags|=32),es}function Oi(r,a,u){(r===It&&(yt===2||yt===9)||r.cancelPendingCommit!==null)&&(oh(r,0),al(r,tt,es,!1)),xc(r,u),((ft&2)===0||r!==It)&&(r===It&&((ft&2)===0&&(Vc|=u),tn===4&&al(r,tt,es,!1)),Ur(r))}function _R(r,a,u){if((ft&6)!==0)throw Error(n(327));var p=!u&&(a&127)===0&&(a&r.expiredLanes)===0||wc(r,a),_=p?tF(r,a):bA(r,a,!0),S=p;do{if(_===0){ih&&!p&&al(r,a,0,!1);break}else{if(u=r.current.alternate,S&&!ZU(u)){_=bA(r,a,!1),S=!1;continue}if(_===2){if(S=a,r.errorRecoveryDisabledLanes&S)var C=0;else C=r.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){a=C;e:{var D=r;_=tg;var B=D.current.memoizedState.isDehydrated;if(B&&(oh(D,C).flags|=256),C=bA(D,C,!1),C!==2){if(hA&&!B){D.errorRecoveryDisabledLanes|=S,Vc|=S,_=4;break e}S=Li,Li=_,S!==null&&(Li===null?Li=S:Li.push.apply(Li,S))}_=C}if(S=!1,_!==2)continue}}if(_===1){oh(r,0),al(r,a,0,!0);break}e:{switch(p=r,S=_,S){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:al(p,a,es,!il);break e;case 2:Li=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(_=q0+300-Ce(),10<_)){if(al(p,a,es,!il),Cd(p,0,!0)!==0)break e;Uo=a,p.timeoutHandle=JR(SR.bind(null,p,u,Li,Y0,pA,a,es,Vc,sh,il,S,"Throttled",-0,0),_);break e}SR(p,u,Li,Y0,pA,a,es,Vc,sh,il,S,null,-0,0)}}break}while(!0);Ur(r)}function SR(r,a,u,p,_,S,C,D,B,j,te,ie,W,Q){if(r.timeoutHandle=-1,ie=a.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ao},fR(a,S,ie);var Ae=(S&62914560)===S?q0-Ce():(S&4194048)===S?yR-Ce():0;if(Ae=UF(ie,Ae),Ae!==null){Uo=S,r.cancelPendingCommit=Ae(IR.bind(null,r,a,S,u,p,_,C,D,B,te,ie,null,W,Q)),al(r,S,C,!j);return}}IR(r,a,S,u,p,_,C,D,B)}function ZU(r){for(var a=r;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var _=u[p],S=_.getSnapshot;_=_.value;try{if(!Xi(S(),_))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function al(r,a,u,p){a&=~fA,a&=~Vc,r.suspendedLanes|=a,r.pingedLanes&=~a,p&&(r.warmLanes|=a),p=r.expirationTimes;for(var _=a;0<_;){var S=31-ei(_),C=1<<S;p[S]=-1,_&=~C}u!==0&&he(r,u,a)}function j0(){return(ft&6)===0?(ig(0),!1):!0}function vA(){if(Ze!==null){if(yt===0)var r=Ze.return;else r=Ze,xo=Pc=null,PS(r),Kd=null,Bp=0,r=Ze;for(;r!==null;)Q1(r.alternate,r),r=r.return;Ze=null}}function oh(r,a){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,bF(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Uo=0,vA(),It=r,Ze=u=To(r.current,null),tt=a,yt=0,Zi=null,il=!1,ih=wc(r,a),hA=!1,sh=es=fA=Vc=sl=tn=0,Li=tg=null,pA=!1,(a&8)!==0&&(a|=a&32);var p=r.entangledLanes;if(p!==0)for(r=r.entanglements,p&=a;0<p;){var _=31-ei(p),S=1<<_;a|=r[_],p&=~S}return Oo=a,p0(),u}function AR(r,a){Ge=null,G.H=jp,a===Xd||a===A0?(a=FC(),yt=3):a===AS?(a=FC(),yt=4):yt=a===KS?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Zi=a,Ze===null&&(tn=1,O0(r,Ds(a,r.current)))}function ER(){var r=Ji.current;return r===null?!0:(tt&4194048)===tt?Os===null:(tt&62914560)===tt||(tt&536870912)!==0?r===Os:!1}function TR(){var r=G.H;return G.H=jp,r===null?jp:r}function wR(){var r=G.A;return G.A=JU,r}function W0(){tn=4,il||(tt&4194048)!==tt&&Ji.current!==null||(ih=!0),(sl&134217727)===0&&(Vc&134217727)===0||It===null||al(It,tt,es,!1)}function bA(r,a,u){var p=ft;ft|=2;var _=TR(),S=wR();(It!==r||tt!==a)&&(Y0=null,oh(r,a)),a=!1;var C=tn;e:do try{if(yt!==0&&Ze!==null){var D=Ze,B=Zi;switch(yt){case 8:vA(),C=6;break e;case 3:case 2:case 9:case 6:Ji.current===null&&(a=!0);var j=yt;if(yt=0,Zi=null,ah(r,D,B,j),u&&ih){C=0;break e}break;default:j=yt,yt=0,Zi=null,ah(r,D,B,j)}}eF(),C=tn;break}catch(te){AR(r,te)}while(!0);return a&&r.shellSuspendCounter++,xo=Pc=null,ft=p,G.H=_,G.A=S,Ze===null&&(It=null,tt=0,p0()),C}function eF(){for(;Ze!==null;)xR(Ze)}function tF(r,a){var u=ft;ft|=2;var p=TR(),_=wR();It!==r||tt!==a?(Y0=null,$0=Ce()+500,oh(r,a)):ih=wc(r,a);e:do try{if(yt!==0&&Ze!==null){a=Ze;var S=Zi;t:switch(yt){case 1:yt=0,Zi=null,ah(r,a,S,1);break;case 2:case 9:if(OC(S)){yt=0,Zi=null,CR(a);break}a=function(){yt!==2&&yt!==9||It!==r||(yt=7),Ur(r)},S.then(a,a);break e;case 3:yt=7;break e;case 4:yt=5;break e;case 7:OC(S)?(yt=0,Zi=null,CR(a)):(yt=0,Zi=null,ah(r,a,S,7));break;case 5:var C=null;switch(Ze.tag){case 26:C=Ze.memoizedState;case 5:case 27:var D=Ze;if(C?hI(C):D.stateNode.complete){yt=0,Zi=null;var B=D.sibling;if(B!==null)Ze=B;else{var j=D.return;j!==null?(Ze=j,X0(j)):Ze=null}break t}}yt=0,Zi=null,ah(r,a,S,5);break;case 6:yt=0,Zi=null,ah(r,a,S,6);break;case 8:vA(),tn=6;break e;default:throw Error(n(462))}}nF();break}catch(te){AR(r,te)}while(!0);return xo=Pc=null,G.H=p,G.A=_,ft=u,Ze!==null?0:(It=null,tt=0,p0(),tn)}function nF(){for(;Ze!==null&&!ae();)xR(Ze)}function xR(r){var a=K1(r.alternate,r,Oo);r.memoizedProps=r.pendingProps,a===null?X0(r):Ze=a}function CR(r){var a=r,u=a.alternate;switch(a.tag){case 15:case 0:a=q1(u,a,a.pendingProps,a.type,void 0,tt);break;case 11:a=q1(u,a,a.pendingProps,a.type.render,a.ref,tt);break;case 5:PS(a);default:Q1(u,a),a=Ze=wC(a,Oo),a=K1(u,a,Oo)}r.memoizedProps=r.pendingProps,a===null?X0(r):Ze=a}function ah(r,a,u,p){xo=Pc=null,PS(a),Kd=null,Bp=0;var _=a.return;try{if(qU(r,_,a,u,tt)){tn=1,O0(r,Ds(u,r.current)),Ze=null;return}}catch(S){if(_!==null)throw Ze=_,S;tn=1,O0(r,Ds(u,r.current)),Ze=null;return}a.flags&32768?(rt||p===1?r=!0:ih||(tt&536870912)!==0?r=!1:(il=r=!0,(p===2||p===9||p===3||p===6)&&(p=Ji.current,p!==null&&p.tag===13&&(p.flags|=16384))),RR(a,r)):X0(a)}function X0(r){var a=r;do{if((a.flags&32768)!==0){RR(a,il);return}r=a.return;var u=jU(a.alternate,a,Oo);if(u!==null){Ze=u;return}if(a=a.sibling,a!==null){Ze=a;return}Ze=a=r}while(a!==null);tn===0&&(tn=5)}function RR(r,a){do{var u=WU(r.alternate,r);if(u!==null){u.flags&=32767,Ze=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(r=r.sibling,r!==null)){Ze=r;return}Ze=r=u}while(r!==null);tn=6,Ze=null}function IR(r,a,u,p,_,S,C,D,B){r.cancelPendingCommit=null;do K0();while(Sn!==0);if((ft&6)!==0)throw Error(n(327));if(a!==null){if(a===r.current)throw Error(n(177));if(S=a.lanes|a.childLanes,S|=aS,U_(r,u,S,C,D,B),r===It&&(Ze=It=null,tt=0),rh=a,ol=r,Uo=u,gA=S,mA=_,vR=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,oF(fn,function(){return PR(),null})):(r.callbackNode=null,r.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=G.T,G.T=null,_=$.p,$.p=2,C=ft,ft|=4;try{XU(r,a,u)}finally{ft=C,$.p=_,G.T=p}}Sn=1,NR(),MR(),DR()}}function NR(){if(Sn===1){Sn=0;var r=ol,a=rh,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=ft;ft|=4;try{uR(a,r);var S=MA,C=mC(r.containerInfo),D=S.focusedElem,B=S.selectionRange;if(C!==D&&D&&D.ownerDocument&&gC(D.ownerDocument.documentElement,D)){if(B!==null&&nS(D)){var j=B.start,te=B.end;if(te===void 0&&(te=j),"selectionStart"in D)D.selectionStart=j,D.selectionEnd=Math.min(te,D.value.length);else{var ie=D.ownerDocument||document,W=ie&&ie.defaultView||window;if(W.getSelection){var Q=W.getSelection(),Ae=D.textContent.length,Ie=Math.min(B.start,Ae),Et=B.end===void 0?Ie:Math.min(B.end,Ae);!Q.extend&&Ie>Et&&(C=Et,Et=Ie,Ie=C);var V=pC(D,Ie),z=pC(D,Et);if(V&&z&&(Q.rangeCount!==1||Q.anchorNode!==V.node||Q.anchorOffset!==V.offset||Q.focusNode!==z.node||Q.focusOffset!==z.offset)){var Y=ie.createRange();Y.setStart(V.node,V.offset),Q.removeAllRanges(),Ie>Et?(Q.addRange(Y),Q.extend(z.node,z.offset)):(Y.setEnd(z.node,z.offset),Q.addRange(Y))}}}}for(ie=[],Q=D;Q=Q.parentNode;)Q.nodeType===1&&ie.push({element:Q,left:Q.scrollLeft,top:Q.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ie.length;D++){var ne=ie[D];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}lv=!!NA,MA=NA=null}finally{ft=_,$.p=p,G.T=u}}r.current=a,Sn=2}}function MR(){if(Sn===2){Sn=0;var r=ol,a=rh,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var p=$.p;$.p=2;var _=ft;ft|=4;try{rR(r,a.alternate,a)}finally{ft=_,$.p=p,G.T=u}}Sn=3}}function DR(){if(Sn===4||Sn===3){Sn=0,Be();var r=ol,a=rh,u=Uo,p=vR;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Sn=5:(Sn=0,rh=ol=null,kR(r,r.pendingLanes));var _=r.pendingLanes;if(_===0&&(rl=null),ir(u),a=a.stateNode,gi&&typeof gi.onCommitFiberRoot=="function")try{gi.onCommitFiberRoot(qa,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=G.T,_=$.p,$.p=2,G.T=null;try{for(var S=r.onRecoverableError,C=0;C<p.length;C++){var D=p[C];S(D.value,{componentStack:D.stack})}}finally{G.T=a,$.p=_}}(Uo&3)!==0&&K0(),Ur(r),_=r.pendingLanes,(u&261930)!==0&&(_&42)!==0?r===yA?ng++:(ng=0,yA=r):ng=0,ig(0)}}function kR(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Up(a)))}function K0(){return NR(),MR(),DR(),PR()}function PR(){if(Sn!==5)return!1;var r=ol,a=gA;gA=0;var u=ir(Uo),p=G.T,_=$.p;try{$.p=32>u?32:u,G.T=null,u=mA,mA=null;var S=ol,C=Uo;if(Sn=0,rh=ol=null,Uo=0,(ft&6)!==0)throw Error(n(331));var D=ft;if(ft|=4,gR(S.current),hR(S,S.current,C,u),ft=D,ig(0,!1),gi&&typeof gi.onPostCommitFiberRoot=="function")try{gi.onPostCommitFiberRoot(qa,S)}catch{}return!0}finally{$.p=_,G.T=p,kR(r,a)}}function LR(r,a,u){a=Ds(u,a),a=XS(r.stateNode,a,2),r=Za(r,a,2),r!==null&&(xc(r,2),Ur(r))}function vt(r,a,u){if(r.tag===3)LR(r,r,u);else for(;a!==null;){if(a.tag===3){LR(a,r,u);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(rl===null||!rl.has(p))){r=Ds(u,r),u=O1(2),p=Za(a,u,2),p!==null&&(U1(u,p,a,r),xc(p,2),Ur(p));break}}a=a.return}}function _A(r,a,u){var p=r.pingCache;if(p===null){p=r.pingCache=new QU;var _=new Set;p.set(a,_)}else _=p.get(a),_===void 0&&(_=new Set,p.set(a,_));_.has(u)||(hA=!0,_.add(u),r=iF.bind(null,r,a,u),a.then(r,r))}function iF(r,a,u){var p=r.pingCache;p!==null&&p.delete(a),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,It===r&&(tt&u)===u&&(tn===4||tn===3&&(tt&62914560)===tt&&300>Ce()-q0?(ft&2)===0&&oh(r,0):fA|=u,sh===tt&&(sh=0)),Ur(r)}function OR(r,a){a===0&&(a=n0()),r=Mc(r,a),r!==null&&(xc(r,a),Ur(r))}function sF(r){var a=r.memoizedState,u=0;a!==null&&(u=a.retryLane),OR(r,u)}function rF(r,a){var u=0;switch(r.tag){case 31:case 13:var p=r.stateNode,_=r.memoizedState;_!==null&&(u=_.retryLane);break;case 19:p=r.stateNode;break;case 22:p=r.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(a),OR(r,u)}function oF(r,a){return Ii(r,a)}var J0=null,lh=null,SA=!1,Q0=!1,AA=!1,ll=0;function Ur(r){r!==lh&&r.next===null&&(lh===null?J0=lh=r:lh=lh.next=r),Q0=!0,SA||(SA=!0,lF())}function ig(r,a){if(!AA&&Q0){AA=!0;do for(var u=!1,p=J0;p!==null;){if(r!==0){var _=p.pendingLanes;if(_===0)var S=0;else{var C=p.suspendedLanes,D=p.pingedLanes;S=(1<<31-ei(42|r)+1)-1,S&=_&~(C&~D),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,HR(p,S))}else S=tt,S=Cd(p,p===It?S:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(S&3)===0||wc(p,S)||(u=!0,HR(p,S));p=p.next}while(u);AA=!1}}function aF(){UR()}function UR(){Q0=SA=!1;var r=0;ll!==0&&vF()&&(r=ll);for(var a=Ce(),u=null,p=J0;p!==null;){var _=p.next,S=FR(p,a);S===0?(p.next=null,u===null?J0=_:u.next=_,_===null&&(lh=u)):(u=p,(r!==0||(S&3)!==0)&&(Q0=!0)),p=_}Sn!==0&&Sn!==5||ig(r),ll!==0&&(ll=0)}function FR(r,a){for(var u=r.suspendedLanes,p=r.pingedLanes,_=r.expirationTimes,S=r.pendingLanes&-62914561;0<S;){var C=31-ei(S),D=1<<C,B=_[C];B===-1?((D&u)===0||(D&p)!==0)&&(_[C]=O_(D,a)):B<=a&&(r.expiredLanes|=D),S&=~D}if(a=It,u=tt,u=Cd(r,r===a?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p=r.callbackNode,u===0||r===a&&(yt===2||yt===9)||r.cancelPendingCommit!==null)return p!==null&&p!==null&&Rs(p),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||wc(r,u)){if(a=u&-u,a===r.callbackPriority)return a;switch(p!==null&&Rs(p),ir(u)){case 2:case 8:u=Zn;break;case 32:u=fn;break;case 268435456:u=Wi;break;default:u=fn}return p=BR.bind(null,r),u=Ii(u,p),r.callbackPriority=a,r.callbackNode=u,a}return p!==null&&p!==null&&Rs(p),r.callbackPriority=2,r.callbackNode=null,2}function BR(r,a){if(Sn!==0&&Sn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(K0()&&r.callbackNode!==u)return null;var p=tt;return p=Cd(r,r===It?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p===0?null:(_R(r,p,a),FR(r,Ce()),r.callbackNode!=null&&r.callbackNode===u?BR.bind(null,r):null)}function HR(r,a){if(K0())return null;_R(r,a,!0)}function lF(){_F(function(){(ft&6)!==0?Ii(fi,aF):UR()})}function EA(){if(ll===0){var r=jd;r===0&&(r=Td,Td<<=1,(Td&261888)===0&&(Td=256)),ll=r}return ll}function GR(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:o0(""+r)}function zR(r,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,r.id&&u.setAttribute("form",r.id),a.parentNode.insertBefore(u,a),r=new FormData(r),u.parentNode.removeChild(u),r}function cF(r,a,u,p,_){if(a==="submit"&&u&&u.stateNode===_){var S=GR((_[Ni]||null).action),C=p.submitter;C&&(a=(a=C[Ni]||null)?GR(a.formAction):C.getAttribute("formAction"),a!==null&&(S=a,C=null));var D=new u0("action","action",null,p,_);r.push({event:D,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ll!==0){var B=C?zR(_,C):new FormData(_);VS(u,{pending:!0,data:B,method:_.method,action:S},null,B)}}else typeof S=="function"&&(D.preventDefault(),B=C?zR(_,C):new FormData(_),VS(u,{pending:!0,data:B,method:_.method,action:S},S,B))},currentTarget:_}]})}}for(var TA=0;TA<oS.length;TA++){var wA=oS[TA],uF=wA.toLowerCase(),dF=wA[0].toUpperCase()+wA.slice(1);sr(uF,"on"+dF)}sr(bC,"onAnimationEnd"),sr(_C,"onAnimationIteration"),sr(SC,"onAnimationStart"),sr("dblclick","onDoubleClick"),sr("focusin","onFocus"),sr("focusout","onBlur"),sr(CU,"onTransitionRun"),sr(RU,"onTransitionStart"),sr(IU,"onTransitionCancel"),sr(AC,"onTransitionEnd"),kd("onMouseEnter",["mouseout","mouseover"]),kd("onMouseLeave",["mouseout","mouseover"]),kd("onPointerEnter",["pointerout","pointerover"]),kd("onPointerLeave",["pointerout","pointerover"]),Cc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Cc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Cc("onBeforeInput",["compositionend","keypress","textInput","paste"]),Cc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Cc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Cc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sg));function VR(r,a){a=(a&4)!==0;for(var u=0;u<r.length;u++){var p=r[u],_=p.event;p=p.listeners;e:{var S=void 0;if(a)for(var C=p.length-1;0<=C;C--){var D=p[C],B=D.instance,j=D.currentTarget;if(D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=j;try{S(_)}catch(te){f0(te)}_.currentTarget=null,S=B}else for(C=0;C<p.length;C++){if(D=p[C],B=D.instance,j=D.currentTarget,D=D.listener,B!==S&&_.isPropagationStopped())break e;S=D,_.currentTarget=j;try{S(_)}catch(te){f0(te)}_.currentTarget=null,S=B}}}}function et(r,a){var u=a[F_];u===void 0&&(u=a[F_]=new Set);var p=r+"__bubble";u.has(p)||(qR(a,r,2,!1),u.add(p))}function xA(r,a,u){var p=0;a&&(p|=4),qR(u,r,p,a)}var Z0="_reactListening"+Math.random().toString(36).slice(2);function CA(r){if(!r[Z0]){r[Z0]=!0,Ux.forEach(function(u){u!=="selectionchange"&&(hF.has(u)||xA(u,!1,r),xA(u,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Z0]||(a[Z0]=!0,xA("selectionchange",!1,a))}}function qR(r,a,u,p){switch(bI(a)){case 2:var _=HF;break;case 8:_=GF;break;default:_=zA}u=_.bind(null,a,u,r),_=void 0,!j_||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),p?_!==void 0?r.addEventListener(a,u,{capture:!0,passive:_}):r.addEventListener(a,u,!0):_!==void 0?r.addEventListener(a,u,{passive:_}):r.addEventListener(a,u,!1)}function RA(r,a,u,p,_){var S=p;if((a&1)===0&&(a&2)===0&&p!==null)e:for(;;){if(p===null)return;var C=p.tag;if(C===3||C===4){var D=p.stateNode.containerInfo;if(D===_)break;if(C===4)for(C=p.return;C!==null;){var B=C.tag;if((B===3||B===4)&&C.stateNode.containerInfo===_)return;C=C.return}for(;D!==null;){if(C=Nd(D),C===null)return;if(B=C.tag,B===5||B===6||B===26||B===27){p=S=C;continue e}D=D.parentNode}}p=p.return}Xx(function(){var j=S,te=$_(u),ie=[];e:{var W=EC.get(r);if(W!==void 0){var Q=u0,Ae=r;switch(r){case"keypress":if(l0(u)===0)break e;case"keydown":case"keyup":Q=rU;break;case"focusin":Ae="focus",Q=J_;break;case"focusout":Ae="blur",Q=J_;break;case"beforeblur":case"afterblur":Q=J_;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=Qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=jO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=lU;break;case bC:case _C:case SC:Q=KO;break;case AC:Q=uU;break;case"scroll":case"scrollend":Q=$O;break;case"wheel":Q=hU;break;case"copy":case"cut":case"paste":Q=QO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=eC;break;case"toggle":case"beforetoggle":Q=pU}var Ie=(a&4)!==0,Et=!Ie&&(r==="scroll"||r==="scrollend"),V=Ie?W!==null?W+"Capture":null:W;Ie=[];for(var z=j,Y;z!==null;){var ne=z;if(Y=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||Y===null||V===null||(ne=xp(z,V),ne!=null&&Ie.push(rg(z,ne,Y))),Et)break;z=z.return}0<Ie.length&&(W=new Q(W,Ae,null,u,te),ie.push({event:W,listeners:Ie}))}}if((a&7)===0){e:{if(W=r==="mouseover"||r==="pointerover",Q=r==="mouseout"||r==="pointerout",W&&u!==q_&&(Ae=u.relatedTarget||u.fromElement)&&(Nd(Ae)||Ae[Id]))break e;if((Q||W)&&(W=te.window===te?te:(W=te.ownerDocument)?W.defaultView||W.parentWindow:window,Q?(Ae=u.relatedTarget||u.toElement,Q=j,Ae=Ae?Nd(Ae):null,Ae!==null&&(Et=o(Ae),Ie=Ae.tag,Ae!==Et||Ie!==5&&Ie!==27&&Ie!==6)&&(Ae=null)):(Q=null,Ae=j),Q!==Ae)){if(Ie=Qx,ne="onMouseLeave",V="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Ie=eC,ne="onPointerLeave",V="onPointerEnter",z="pointer"),Et=Q==null?W:wp(Q),Y=Ae==null?W:wp(Ae),W=new Ie(ne,z+"leave",Q,u,te),W.target=Et,W.relatedTarget=Y,ne=null,Nd(te)===j&&(Ie=new Ie(V,z+"enter",Ae,u,te),Ie.target=Y,Ie.relatedTarget=Et,ne=Ie),Et=ne,Q&&Ae)t:{for(Ie=fF,V=Q,z=Ae,Y=0,ne=V;ne;ne=Ie(ne))Y++;ne=0;for(var Re=z;Re;Re=Ie(Re))ne++;for(;0<Y-ne;)V=Ie(V),Y--;for(;0<ne-Y;)z=Ie(z),ne--;for(;Y--;){if(V===z||z!==null&&V===z.alternate){Ie=V;break t}V=Ie(V),z=Ie(z)}Ie=null}else Ie=null;Q!==null&&$R(ie,W,Q,Ie,!1),Ae!==null&&Et!==null&&$R(ie,Et,Ae,Ie,!0)}}e:{if(W=j?wp(j):window,Q=W.nodeName&&W.nodeName.toLowerCase(),Q==="select"||Q==="input"&&W.type==="file")var ut=lC;else if(oC(W))if(cC)ut=TU;else{ut=AU;var we=SU}else Q=W.nodeName,!Q||Q.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?j&&V_(j.elementType)&&(ut=lC):ut=EU;if(ut&&(ut=ut(r,j))){aC(ie,ut,u,te);break e}we&&we(r,W,j),r==="focusout"&&j&&W.type==="number"&&j.memoizedProps.value!=null&&z_(W,"number",W.value)}switch(we=j?wp(j):window,r){case"focusin":(oC(we)||we.contentEditable==="true")&&(Bd=we,iS=j,Pp=null);break;case"focusout":Pp=iS=Bd=null;break;case"mousedown":sS=!0;break;case"contextmenu":case"mouseup":case"dragend":sS=!1,yC(ie,u,te);break;case"selectionchange":if(xU)break;case"keydown":case"keyup":yC(ie,u,te)}var qe;if(Z_)e:{switch(r){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Fd?sC(r,u)&&(nt="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(nt="onCompositionStart");nt&&(tC&&u.locale!=="ko"&&(Fd||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Fd&&(qe=Kx()):(Ya=te,W_="value"in Ya?Ya.value:Ya.textContent,Fd=!0)),we=ev(j,nt),0<we.length&&(nt=new Zx(nt,r,null,u,te),ie.push({event:nt,listeners:we}),qe?nt.data=qe:(qe=rC(u),qe!==null&&(nt.data=qe)))),(qe=mU?yU(r,u):vU(r,u))&&(nt=ev(j,"onBeforeInput"),0<nt.length&&(we=new Zx("onBeforeInput","beforeinput",null,u,te),ie.push({event:we,listeners:nt}),we.data=qe)),cF(ie,r,j,u,te)}VR(ie,a)})}function rg(r,a,u){return{instance:r,listener:a,currentTarget:u}}function ev(r,a){for(var u=a+"Capture",p=[];r!==null;){var _=r,S=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||S===null||(_=xp(r,u),_!=null&&p.unshift(rg(r,_,S)),_=xp(r,a),_!=null&&p.push(rg(r,_,S))),r.tag===3)return p;r=r.return}return[]}function fF(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function $R(r,a,u,p,_){for(var S=a._reactName,C=[];u!==null&&u!==p;){var D=u,B=D.alternate,j=D.stateNode;if(D=D.tag,B!==null&&B===p)break;D!==5&&D!==26&&D!==27||j===null||(B=j,_?(j=xp(u,S),j!=null&&C.unshift(rg(u,j,B))):_||(j=xp(u,S),j!=null&&C.push(rg(u,j,B)))),u=u.return}C.length!==0&&r.push({event:a,listeners:C})}var pF=/\r\n?/g,gF=/\u0000|\uFFFD/g;function YR(r){return(typeof r=="string"?r:""+r).replace(pF,`
`).replace(gF,"")}function jR(r,a){return a=YR(a),YR(r)===a}function At(r,a,u,p,_,S){switch(u){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||Ld(r,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&Ld(r,""+p);break;case"className":s0(r,"class",p);break;case"tabIndex":s0(r,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":s0(r,u,p);break;case"style":jx(r,p,S);break;case"data":if(a!=="object"){s0(r,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||u!=="href")){r.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=o0(""+p),r.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(a!=="input"&&At(r,a,"name",_.name,_,null),At(r,a,"formEncType",_.formEncType,_,null),At(r,a,"formMethod",_.formMethod,_,null),At(r,a,"formTarget",_.formTarget,_,null)):(At(r,a,"encType",_.encType,_,null),At(r,a,"method",_.method,_,null),At(r,a,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(u);break}p=o0(""+p),r.setAttribute(u,p);break;case"onClick":p!=null&&(r.onclick=Ao);break;case"onScroll":p!=null&&et("scroll",r);break;case"onScrollEnd":p!=null&&et("scrollend",r);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":r.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){r.removeAttribute("xlink:href");break}u=o0(""+p),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""+p):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":p===!0?r.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(u,p):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?r.setAttribute(u,p):r.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?r.removeAttribute(u):r.setAttribute(u,p);break;case"popover":et("beforetoggle",r),et("toggle",r),i0(r,"popover",p);break;case"xlinkActuate":So(r,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":So(r,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":So(r,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":So(r,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":So(r,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":So(r,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":So(r,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":So(r,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":So(r,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":i0(r,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=VO.get(u)||u,i0(r,u,p))}}function IA(r,a,u,p,_,S){switch(u){case"style":jx(r,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof p=="string"?Ld(r,p):(typeof p=="number"||typeof p=="bigint")&&Ld(r,""+p);break;case"onScroll":p!=null&&et("scroll",r);break;case"onScrollEnd":p!=null&&et("scrollend",r);break;case"onClick":p!=null&&(r.onclick=Ao);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fx.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),a=u.slice(2,_?u.length-7:void 0),S=r[Ni]||null,S=S!=null?S[u]:null,typeof S=="function"&&r.removeEventListener(a,S,_),typeof p=="function")){typeof S!="function"&&S!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(a,p,_);break e}u in r?r[u]=p:p===!0?r.setAttribute(u,""):i0(r,u,p)}}}function Vn(r,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":et("error",r),et("load",r);var p=!1,_=!1,S;for(S in u)if(u.hasOwnProperty(S)){var C=u[S];if(C!=null)switch(S){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:At(r,a,S,C,u,null)}}_&&At(r,a,"srcSet",u.srcSet,u,null),p&&At(r,a,"src",u.src,u,null);return;case"input":et("invalid",r);var D=S=C=_=null,B=null,j=null;for(p in u)if(u.hasOwnProperty(p)){var te=u[p];if(te!=null)switch(p){case"name":_=te;break;case"type":C=te;break;case"checked":B=te;break;case"defaultChecked":j=te;break;case"value":S=te;break;case"defaultValue":D=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,a));break;default:At(r,a,p,te,u,null)}}Vx(r,S,D,B,j,C,_,!1);return;case"select":et("invalid",r),p=C=S=null;for(_ in u)if(u.hasOwnProperty(_)&&(D=u[_],D!=null))switch(_){case"value":S=D;break;case"defaultValue":C=D;break;case"multiple":p=D;default:At(r,a,_,D,u,null)}a=S,u=C,r.multiple=!!p,a!=null?Pd(r,!!p,a,!1):u!=null&&Pd(r,!!p,u,!0);return;case"textarea":et("invalid",r),S=_=p=null;for(C in u)if(u.hasOwnProperty(C)&&(D=u[C],D!=null))switch(C){case"value":p=D;break;case"defaultValue":_=D;break;case"children":S=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:At(r,a,C,D,u,null)}$x(r,p,_,S);return;case"option":for(B in u)if(u.hasOwnProperty(B)&&(p=u[B],p!=null))switch(B){case"selected":r.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:At(r,a,B,p,u,null)}return;case"dialog":et("beforetoggle",r),et("toggle",r),et("cancel",r),et("close",r);break;case"iframe":case"object":et("load",r);break;case"video":case"audio":for(p=0;p<sg.length;p++)et(sg[p],r);break;case"image":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"embed":case"source":case"link":et("error",r),et("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(j in u)if(u.hasOwnProperty(j)&&(p=u[j],p!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:At(r,a,j,p,u,null)}return;default:if(V_(a)){for(te in u)u.hasOwnProperty(te)&&(p=u[te],p!==void 0&&IA(r,a,te,p,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(p=u[D],p!=null&&At(r,a,D,p,u,null))}function mF(r,a,u,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,S=null,C=null,D=null,B=null,j=null,te=null;for(Q in u){var ie=u[Q];if(u.hasOwnProperty(Q)&&ie!=null)switch(Q){case"checked":break;case"value":break;case"defaultValue":B=ie;default:p.hasOwnProperty(Q)||At(r,a,Q,null,p,ie)}}for(var W in p){var Q=p[W];if(ie=u[W],p.hasOwnProperty(W)&&(Q!=null||ie!=null))switch(W){case"type":S=Q;break;case"name":_=Q;break;case"checked":j=Q;break;case"defaultChecked":te=Q;break;case"value":C=Q;break;case"defaultValue":D=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(n(137,a));break;default:Q!==ie&&At(r,a,W,Q,p,ie)}}G_(r,C,D,B,j,te,S,_);return;case"select":Q=C=D=W=null;for(S in u)if(B=u[S],u.hasOwnProperty(S)&&B!=null)switch(S){case"value":break;case"multiple":Q=B;default:p.hasOwnProperty(S)||At(r,a,S,null,p,B)}for(_ in p)if(S=p[_],B=u[_],p.hasOwnProperty(_)&&(S!=null||B!=null))switch(_){case"value":W=S;break;case"defaultValue":D=S;break;case"multiple":C=S;default:S!==B&&At(r,a,_,S,p,B)}a=D,u=C,p=Q,W!=null?Pd(r,!!u,W,!1):!!p!=!!u&&(a!=null?Pd(r,!!u,a,!0):Pd(r,!!u,u?[]:"",!1));return;case"textarea":Q=W=null;for(D in u)if(_=u[D],u.hasOwnProperty(D)&&_!=null&&!p.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:At(r,a,D,null,p,_)}for(C in p)if(_=p[C],S=u[C],p.hasOwnProperty(C)&&(_!=null||S!=null))switch(C){case"value":W=_;break;case"defaultValue":Q=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==S&&At(r,a,C,_,p,S)}qx(r,W,Q);return;case"option":for(var Ae in u)if(W=u[Ae],u.hasOwnProperty(Ae)&&W!=null&&!p.hasOwnProperty(Ae))switch(Ae){case"selected":r.selected=!1;break;default:At(r,a,Ae,null,p,W)}for(B in p)if(W=p[B],Q=u[B],p.hasOwnProperty(B)&&W!==Q&&(W!=null||Q!=null))switch(B){case"selected":r.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:At(r,a,B,W,p,Q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ie in u)W=u[Ie],u.hasOwnProperty(Ie)&&W!=null&&!p.hasOwnProperty(Ie)&&At(r,a,Ie,null,p,W);for(j in p)if(W=p[j],Q=u[j],p.hasOwnProperty(j)&&W!==Q&&(W!=null||Q!=null))switch(j){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:At(r,a,j,W,p,Q)}return;default:if(V_(a)){for(var Et in u)W=u[Et],u.hasOwnProperty(Et)&&W!==void 0&&!p.hasOwnProperty(Et)&&IA(r,a,Et,void 0,p,W);for(te in p)W=p[te],Q=u[te],!p.hasOwnProperty(te)||W===Q||W===void 0&&Q===void 0||IA(r,a,te,W,p,Q);return}}for(var V in u)W=u[V],u.hasOwnProperty(V)&&W!=null&&!p.hasOwnProperty(V)&&At(r,a,V,null,p,W);for(ie in p)W=p[ie],Q=u[ie],!p.hasOwnProperty(ie)||W===Q||W==null&&Q==null||At(r,a,ie,W,p,Q)}function WR(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function yF(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,u=performance.getEntriesByType("resource"),p=0;p<u.length;p++){var _=u[p],S=_.transferSize,C=_.initiatorType,D=_.duration;if(S&&D&&WR(C)){for(C=0,D=_.responseEnd,p+=1;p<u.length;p++){var B=u[p],j=B.startTime;if(j>D)break;var te=B.transferSize,ie=B.initiatorType;te&&WR(ie)&&(B=B.responseEnd,C+=te*(B<D?1:(D-j)/(B-j)))}if(--p,a+=8*(S+C)/(_.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var NA=null,MA=null;function tv(r){return r.nodeType===9?r:r.ownerDocument}function XR(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function KR(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function DA(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var kA=null;function vF(){var r=window.event;return r&&r.type==="popstate"?r===kA?!1:(kA=r,!0):(kA=null,!1)}var JR=typeof setTimeout=="function"?setTimeout:void 0,bF=typeof clearTimeout=="function"?clearTimeout:void 0,QR=typeof Promise=="function"?Promise:void 0,_F=typeof queueMicrotask=="function"?queueMicrotask:typeof QR<"u"?function(r){return QR.resolve(null).then(r).catch(SF)}:JR;function SF(r){setTimeout(function(){throw r})}function cl(r){return r==="head"}function ZR(r,a){var u=a,p=0;do{var _=u.nextSibling;if(r.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"||u==="/&"){if(p===0){r.removeChild(_),hh(a);return}p--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")p++;else if(u==="html")og(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,og(u);for(var S=u.firstChild;S;){var C=S.nextSibling,D=S.nodeName;S[Tp]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=C}}else u==="body"&&og(r.ownerDocument.body);u=_}while(u);hh(a)}function eI(r,a){var u=r;r=0;do{var p=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=p}while(u)}function PA(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":PA(u),B_(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function AF(r,a,u,p){for(;r.nodeType===1;){var _=u;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(p){if(!r[Tp])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(S=r.getAttribute("rel"),S==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(S!==_.rel||r.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||r.getAttribute("title")!==(_.title==null?null:_.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(S=r.getAttribute("src"),(S!==(_.src==null?null:_.src)||r.getAttribute("type")!==(_.type==null?null:_.type)||r.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&S&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var S=_.name==null?null:""+_.name;if(_.type==="hidden"&&r.getAttribute("name")===S)return r}else return r;if(r=Us(r.nextSibling),r===null)break}return null}function EF(r,a,u){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Us(r.nextSibling),r===null))return null;return r}function tI(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=Us(r.nextSibling),r===null))return null;return r}function LA(r){return r.data==="$?"||r.data==="$~"}function OA(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function TF(r,a){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||u.readyState!=="loading")a();else{var p=function(){a(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),r._reactRetry=p}}function Us(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var UA=null;function nI(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(a===0)return Us(r.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}r=r.nextSibling}return null}function iI(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return r;a--}else u!=="/$"&&u!=="/&"||a++}r=r.previousSibling}return null}function sI(r,a,u){switch(a=tv(u),r){case"html":if(r=a.documentElement,!r)throw Error(n(452));return r;case"head":if(r=a.head,!r)throw Error(n(453));return r;case"body":if(r=a.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function og(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);B_(r)}var Fs=new Map,rI=new Set;function nv(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Fo=$.d;$.d={f:wF,r:xF,D:CF,C:RF,L:IF,m:NF,X:DF,S:MF,M:kF};function wF(){var r=Fo.f(),a=j0();return r||a}function xF(r){var a=Md(r);a!==null&&a.tag===5&&a.type==="form"?A1(a):Fo.r(r)}var ch=typeof document>"u"?null:document;function oI(r,a,u){var p=ch;if(p&&typeof a=="string"&&a){var _=Ns(a);_='link[rel="'+r+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),rI.has(_)||(rI.add(_),r={rel:r,crossOrigin:u,href:a},p.querySelector(_)===null&&(a=p.createElement("link"),Vn(a,"link",r),Cn(a),p.head.appendChild(a)))}}function CF(r){Fo.D(r),oI("dns-prefetch",r,null)}function RF(r,a){Fo.C(r,a),oI("preconnect",r,a)}function IF(r,a,u){Fo.L(r,a,u);var p=ch;if(p&&r&&a){var _='link[rel="preload"][as="'+Ns(a)+'"]';a==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+Ns(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+Ns(u.imageSizes)+'"]')):_+='[href="'+Ns(r)+'"]';var S=_;switch(a){case"style":S=uh(r);break;case"script":S=dh(r)}Fs.has(S)||(r=y({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:r,as:a},u),Fs.set(S,r),p.querySelector(_)!==null||a==="style"&&p.querySelector(ag(S))||a==="script"&&p.querySelector(lg(S))||(a=p.createElement("link"),Vn(a,"link",r),Cn(a),p.head.appendChild(a)))}}function NF(r,a){Fo.m(r,a);var u=ch;if(u&&r){var p=a&&typeof a.as=="string"?a.as:"script",_='link[rel="modulepreload"][as="'+Ns(p)+'"][href="'+Ns(r)+'"]',S=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=dh(r)}if(!Fs.has(S)&&(r=y({rel:"modulepreload",href:r},a),Fs.set(S,r),u.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(lg(S)))return}p=u.createElement("link"),Vn(p,"link",r),Cn(p),u.head.appendChild(p)}}}function MF(r,a,u){Fo.S(r,a,u);var p=ch;if(p&&r){var _=Dd(p).hoistableStyles,S=uh(r);a=a||"default";var C=_.get(S);if(!C){var D={loading:0,preload:null};if(C=p.querySelector(ag(S)))D.loading=5;else{r=y({rel:"stylesheet",href:r,"data-precedence":a},u),(u=Fs.get(S))&&FA(r,u);var B=C=p.createElement("link");Cn(B),Vn(B,"link",r),B._p=new Promise(function(j,te){B.onload=j,B.onerror=te}),B.addEventListener("load",function(){D.loading|=1}),B.addEventListener("error",function(){D.loading|=2}),D.loading|=4,iv(C,a,p)}C={type:"stylesheet",instance:C,count:1,state:D},_.set(S,C)}}}function DF(r,a){Fo.X(r,a);var u=ch;if(u&&r){var p=Dd(u).hoistableScripts,_=dh(r),S=p.get(_);S||(S=u.querySelector(lg(_)),S||(r=y({src:r,async:!0},a),(a=Fs.get(_))&&BA(r,a),S=u.createElement("script"),Cn(S),Vn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function kF(r,a){Fo.M(r,a);var u=ch;if(u&&r){var p=Dd(u).hoistableScripts,_=dh(r),S=p.get(_);S||(S=u.querySelector(lg(_)),S||(r=y({src:r,async:!0,type:"module"},a),(a=Fs.get(_))&&BA(r,a),S=u.createElement("script"),Cn(S),Vn(S,"link",r),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(_,S))}}function aI(r,a,u,p){var _=(_=Se.current)?nv(_):null;if(!_)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=uh(u.href),u=Dd(_).hoistableStyles,p=u.get(a),p||(p={type:"style",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=uh(u.href);var S=Dd(_).hoistableStyles,C=S.get(r);if(C||(_=_.ownerDocument||_,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(r,C),(S=_.querySelector(ag(r)))&&!S._p&&(C.instance=S,C.state.loading=5),Fs.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Fs.set(r,u),S||PF(_,r,u,C.state))),a&&p===null)throw Error(n(528,""));return C}if(a&&p!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=dh(u),u=Dd(_).hoistableScripts,p=u.get(a),p||(p={type:"script",instance:null,count:0,state:null},u.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function uh(r){return'href="'+Ns(r)+'"'}function ag(r){return'link[rel="stylesheet"]['+r+"]"}function lI(r){return y({},r,{"data-precedence":r.precedence,precedence:null})}function PF(r,a,u,p){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=r.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),Vn(a,"link",u),Cn(a),r.head.appendChild(a))}function dh(r){return'[src="'+Ns(r)+'"]'}function lg(r){return"script[async]"+r}function cI(r,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var p=r.querySelector('style[data-href~="'+Ns(u.href)+'"]');if(p)return a.instance=p,Cn(p),p;var _=y({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(r.ownerDocument||r).createElement("style"),Cn(p),Vn(p,"style",_),iv(p,u.precedence,r),a.instance=p;case"stylesheet":_=uh(u.href);var S=r.querySelector(ag(_));if(S)return a.state.loading|=4,a.instance=S,Cn(S),S;p=lI(u),(_=Fs.get(_))&&FA(p,_),S=(r.ownerDocument||r).createElement("link"),Cn(S);var C=S;return C._p=new Promise(function(D,B){C.onload=D,C.onerror=B}),Vn(S,"link",p),a.state.loading|=4,iv(S,u.precedence,r),a.instance=S;case"script":return S=dh(u.src),(_=r.querySelector(lg(S)))?(a.instance=_,Cn(_),_):(p=u,(_=Fs.get(S))&&(p=y({},u),BA(p,_)),r=r.ownerDocument||r,_=r.createElement("script"),Cn(_),Vn(_,"link",p),r.head.appendChild(_),a.instance=_);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,iv(p,u.precedence,r));return a.instance}function iv(r,a,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,S=_,C=0;C<p.length;C++){var D=p[C];if(D.dataset.precedence===a)S=D;else if(S!==_)break}S?S.parentNode.insertBefore(r,S.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(r,a.firstChild))}function FA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function BA(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var sv=null;function uI(r,a,u){if(sv===null){var p=new Map,_=sv=new Map;_.set(u,p)}else _=sv,p=_.get(u),p||(p=new Map,_.set(u,p));if(p.has(r))return p;for(p.set(r,null),u=u.getElementsByTagName(r),_=0;_<u.length;_++){var S=u[_];if(!(S[Tp]||S[Bn]||r==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var C=S.getAttribute(a)||"";C=r+C;var D=p.get(C);D?D.push(S):p.set(C,[S])}}return p}function dI(r,a,u){r=r.ownerDocument||r,r.head.insertBefore(u,a==="title"?r.querySelector("head > title"):null)}function LF(r,a,u){if(u===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function hI(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function OF(r,a,u,p){if(u.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var _=uh(p.href),S=a.querySelector(ag(_));if(S){a=S._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=rv.bind(r),a.then(r,r)),u.state.loading|=4,u.instance=S,Cn(S);return}S=a.ownerDocument||a,p=lI(p),(_=Fs.get(_))&&FA(p,_),S=S.createElement("link"),Cn(S);var C=S;C._p=new Promise(function(D,B){C.onload=D,C.onerror=B}),Vn(S,"link",p),u.instance=S}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=rv.bind(r),a.addEventListener("load",u),a.addEventListener("error",u))}}var HA=0;function UF(r,a){return r.stylesheets&&r.count===0&&av(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var p=setTimeout(function(){if(r.stylesheets&&av(r,r.stylesheets),r.unsuspend){var S=r.unsuspend;r.unsuspend=null,S()}},6e4+a);0<r.imgBytes&&HA===0&&(HA=62500*yF());var _=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&av(r,r.stylesheets),r.unsuspend)){var S=r.unsuspend;r.unsuspend=null,S()}},(r.imgBytes>HA?50:800)+a);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(p),clearTimeout(_)}}:null}function rv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)av(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var ov=null;function av(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,ov=new Map,a.forEach(FF,r),ov=null,rv.call(r))}function FF(r,a){if(!(a.state.loading&4)){var u=ov.get(r);if(u)var p=u.get(null);else{u=new Map,ov.set(r,u);for(var _=r.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<_.length;S++){var C=_[S];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(u.set(C.dataset.precedence,C),p=C)}p&&u.set(null,p)}_=a.instance,C=_.getAttribute("data-precedence"),S=u.get(C)||p,S===p&&u.set(null,_),u.set(C,_),this.count++,p=rv.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),S?S.parentNode.insertBefore(_,S.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(_,r.firstChild)),a.state.loading|=4}}var cg={$$typeof:k,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function BF(r,a,u,p,_,S,C,D,B){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rd(0),this.hiddenUpdates=Rd(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=S,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function fI(r,a,u,p,_,S,C,D,B,j,te,ie){return r=new BF(r,a,u,C,B,j,te,ie,D),a=1,S===!0&&(a|=24),S=Ki(3,null,null,a),r.current=S,S.stateNode=r,a=bS(),a.refCount++,r.pooledCache=a,a.refCount++,S.memoizedState={element:p,isDehydrated:u,cache:a},ES(S),r}function pI(r){return r?(r=zd,r):zd}function gI(r,a,u,p,_,S){_=pI(_),p.context===null?p.context=_:p.pendingContext=_,p=Qa(a),p.payload={element:u},S=S===void 0?null:S,S!==null&&(p.callback=S),u=Za(r,p,a),u!==null&&(Oi(u,r,a),Gp(u,r,a))}function mI(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<a?u:a}}function GA(r,a){mI(r,a),(r=r.alternate)&&mI(r,a)}function yI(r){if(r.tag===13||r.tag===31){var a=Mc(r,67108864);a!==null&&Oi(a,r,67108864),GA(r,67108864)}}function vI(r){if(r.tag===13||r.tag===31){var a=ts();a=Zt(a);var u=Mc(r,a);u!==null&&Oi(u,r,a),GA(r,a)}}var lv=!0;function HF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=2,zA(r,a,u,p)}finally{$.p=S,G.T=_}}function GF(r,a,u,p){var _=G.T;G.T=null;var S=$.p;try{$.p=8,zA(r,a,u,p)}finally{$.p=S,G.T=_}}function zA(r,a,u,p){if(lv){var _=VA(p);if(_===null)RA(r,a,p,cv,u),_I(r,p);else if(VF(_,r,a,u,p))p.stopPropagation();else if(_I(r,p),a&4&&-1<zF.indexOf(r)){for(;_!==null;){var S=Md(_);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var C=_o(S.pendingLanes);if(C!==0){var D=S;for(D.pendingLanes|=2,D.entangledLanes|=2;C;){var B=1<<31-ei(C);D.entanglements[1]|=B,C&=~B}Ur(S),(ft&6)===0&&($0=Ce()+500,ig(0))}}break;case 31:case 13:D=Mc(S,2),D!==null&&Oi(D,S,2),j0(),GA(S,2)}if(S=VA(p),S===null&&RA(r,a,p,cv,u),S===_)break;_=S}_!==null&&p.stopPropagation()}else RA(r,a,p,null,u)}}function VA(r){return r=$_(r),qA(r)}var cv=null;function qA(r){if(cv=null,r=Nd(r),r!==null){var a=o(r);if(a===null)r=null;else{var u=a.tag;if(u===13){if(r=l(a),r!==null)return r;r=null}else if(u===31){if(r=c(a),r!==null)return r;r=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return cv=r,null}function bI(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case fi:return 2;case Zn:return 8;case fn:case pi:return 32;case Wi:return 268435456;default:return 32}default:return 32}}var $A=!1,ul=null,dl=null,hl=null,ug=new Map,dg=new Map,fl=[],zF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _I(r,a){switch(r){case"focusin":case"focusout":ul=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":hl=null;break;case"pointerover":case"pointerout":ug.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":dg.delete(a.pointerId)}}function hg(r,a,u,p,_,S){return r===null||r.nativeEvent!==S?(r={blockedOn:a,domEventName:u,eventSystemFlags:p,nativeEvent:S,targetContainers:[_]},a!==null&&(a=Md(a),a!==null&&yI(a)),r):(r.eventSystemFlags|=p,a=r.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),r)}function VF(r,a,u,p,_){switch(a){case"focusin":return ul=hg(ul,r,a,u,p,_),!0;case"dragenter":return dl=hg(dl,r,a,u,p,_),!0;case"mouseover":return hl=hg(hl,r,a,u,p,_),!0;case"pointerover":var S=_.pointerId;return ug.set(S,hg(ug.get(S)||null,r,a,u,p,_)),!0;case"gotpointercapture":return S=_.pointerId,dg.set(S,hg(dg.get(S)||null,r,a,u,p,_)),!0}return!1}function SI(r){var a=Nd(r.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){r.blockedOn=a,Lx(r.priority,function(){vI(u)});return}}else if(a===31){if(a=c(u),a!==null){r.blockedOn=a,Lx(r.priority,function(){vI(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function uv(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var u=VA(r.nativeEvent);if(u===null){u=r.nativeEvent;var p=new u.constructor(u.type,u);q_=p,u.target.dispatchEvent(p),q_=null}else return a=Md(u),a!==null&&yI(a),r.blockedOn=u,!1;a.shift()}return!0}function AI(r,a,u){uv(r)&&u.delete(a)}function qF(){$A=!1,ul!==null&&uv(ul)&&(ul=null),dl!==null&&uv(dl)&&(dl=null),hl!==null&&uv(hl)&&(hl=null),ug.forEach(AI),dg.forEach(AI)}function dv(r,a){r.blockedOn===a&&(r.blockedOn=null,$A||($A=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qF)))}var hv=null;function EI(r){hv!==r&&(hv=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){hv===r&&(hv=null);for(var a=0;a<r.length;a+=3){var u=r[a],p=r[a+1],_=r[a+2];if(typeof p!="function"){if(qA(p||u)===null)continue;break}var S=Md(u);S!==null&&(r.splice(a,3),a-=3,VS(S,{pending:!0,data:_,method:u.method,action:p},p,_))}}))}function hh(r){function a(B){return dv(B,r)}ul!==null&&dv(ul,r),dl!==null&&dv(dl,r),hl!==null&&dv(hl,r),ug.forEach(a),dg.forEach(a);for(var u=0;u<fl.length;u++){var p=fl[u];p.blockedOn===r&&(p.blockedOn=null)}for(;0<fl.length&&(u=fl[0],u.blockedOn===null);)SI(u),u.blockedOn===null&&fl.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var _=u[p],S=u[p+1],C=_[Ni]||null;if(typeof S=="function")C||EI(u);else if(C){var D=null;if(S&&S.hasAttribute("formAction")){if(_=S,C=S[Ni]||null)D=C.formAction;else if(qA(_)!==null)continue}else D=C.action;typeof D=="function"?u[p+1]=D:(u.splice(p,3),p-=3),EI(u)}}}function TI(){function r(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(C){return _=C})},focusReset:"manual",scroll:"manual"})}function a(){_!==null&&(_(),_=null),p||setTimeout(u,20)}function u(){if(!p&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,_=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){p=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),_!==null&&(_(),_=null)}}}function YA(r){this._internalRoot=r}fv.prototype.render=YA.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,p=ts();gI(u,p,r,a,null,null)},fv.prototype.unmount=YA.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;gI(r.current,2,null,r,null,null),j0(),a[Id]=null}};function fv(r){this._internalRoot=r}fv.prototype.unstable_scheduleHydration=function(r){if(r){var a=Px();r={blockedOn:null,target:r,priority:a};for(var u=0;u<fl.length&&a!==0&&a<fl[u].priority;u++);fl.splice(u,0,r),u===0&&SI(r)}};var wI=e.version;if(wI!=="19.2.4")throw Error(n(527,wI,"19.2.4"));$.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=f(a),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var $F={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pv.isDisabled&&pv.supportsFiber)try{qa=pv.inject($F),gi=pv}catch{}}return pg.createRoot=function(r,a){if(!s(r))throw Error(n(299));var u=!1,p="",_=D1,S=k1,C=P1;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(C=a.onRecoverableError)),a=fI(r,1,!1,null,null,u,p,null,_,S,C,TI),r[Id]=a.current,CA(r),new YA(a)},pg.hydrateRoot=function(r,a,u){if(!s(r))throw Error(n(299));var p=!1,_="",S=D1,C=k1,D=P1,B=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(C=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(B=u.formState)),a=fI(r,1,!0,a,u??null,p,_,B,S,C,D,TI),a.context=pI(null),u=a.current,p=ts(),p=Zt(p),_=Qa(p),_.callback=null,Za(u,_,p),u=p,a.current.lanes=u,xc(a,u),Ur(a),r[Id]=a.current,CA(r),new fv(a)},pg.version="19.2.4",pg}var OI;function sB(){if(OI)return KA.exports;OI=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),KA.exports=iB(),KA.exports}var rB=sB();const oB=xw(rB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XD=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=i=>{const e=lB(i);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=J.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:l,...c},h)=>J.createElement("svg",{ref:h,...cB,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:XD("lucide",s),...!o&&!uB(c)&&{"aria-hidden":"true"},...c},[...l.map(([f,g])=>J.createElement(f,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(i,e)=>{const t=J.forwardRef(({className:n,...s},o)=>J.createElement(dB,{ref:o,iconNode:e,className:XD(`lucide-${aB(UI(i))}`,`lucide-${i}`,n),...s}));return t.displayName=UI(i),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fB=Le("arrow-left",hB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Rw=Le("arrow-right",pB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],FI=Le("award",gB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ca=Le("book-open",mB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],vB=Le("book",yB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],KD=Le("briefcase",bB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],JD=Le("calendar",_B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],EE=Le("check",SB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],BI=Le("chevron-left",AB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Dv=Le("chevron-right",EB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],wB=Le("circle-alert",TB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CB=Le("circle-check-big",xB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],IB=Le("eye",RB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],MB=Le("file-question-mark",NB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],HI=Le("file-text",DB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],PB=Le("gift",kB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],OB=Le("globe",LB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],FB=Le("heart",UB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],HB=Le("highlighter",BB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],zB=Le("house",GB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],qB=Le("library",VB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],GI=Le("list",$B);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ta=Le("loader-circle",YB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],WB=Le("log-out",jB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],KB=Le("maximize-2",XB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],zI=Le("message-square",JB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],ZB=Le("minimize-2",QB);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],VI=Le("navigation",e3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],TE=Le("pen-tool",t3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],i3=Le("pen",n3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],r3=Le("play",s3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],a3=Le("plus",o3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],c3=Le("quote",l3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],d3=Le("refresh-cw",u3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wE=Le("search",h3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Iw=Le("send",f3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Es=Le("sparkles",p3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],xE=Le("star",g3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],eE=Le("sticky-note",m3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],v3=Le("trending-up",y3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],qI=Le("upload",b3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],QD=Le("user",_3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],A3=Le("wallet",S3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],T3=Le("wifi",E3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],yl=Le("x",w3),gv=({book:i,onClick:e,onRead:t})=>{const[n,s]=J.useState(!1),o=i.coverImageUrl||(i.isbn?`https://covers.openlibrary.org/b/isbn/${i.isbn}-L.jpg`:null);return E.jsxs("div",{className:"group relative flex flex-col w-full cursor-pointer",onClick:e,children:[E.jsxs("div",{className:"relative w-full aspect-[2/3] rounded-2xl overflow-hidden shadow-sm transition-all duration-500 group-hover:shadow-[0_20px_40px_-12px_rgba(0,0,0,0.15)] group-hover:-translate-y-2",children:[!n&&o?E.jsx("img",{src:o,alt:i.title,className:"w-full h-full object-cover",onError:()=>s(!0),loading:"lazy"}):E.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center relative overflow-hidden p-4",style:{background:`linear-gradient(135deg, ${i.coverColor} 0%, ${x3(i.coverColor,-20)} 100%)`},children:[E.jsx("div",{className:"absolute inset-0 opacity-10 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-black to-transparent"}),E.jsx("div",{className:"transform group-hover:scale-110 group-hover:rotate-3 transition-transform duration-700 ease-[cubic-bezier(0.34,1.56,0.64,1)] mb-4",children:E.jsx(Ca,{className:"text-black/20 w-12 h-12",strokeWidth:1.5})}),E.jsx("p",{className:"text-black/60 font-serif font-bold text-sm text-center leading-tight line-clamp-3",children:i.title}),E.jsx("p",{className:"text-black/40 text-xs mt-1",children:i.author})]}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-end justify-center pb-4",children:E.jsxs("button",{onClick:t,className:"bg-white text-gray-900 px-6 py-2.5 rounded-full text-xs font-bold shadow-xl transform translate-y-4 group-hover:translate-y-0 transition-all duration-300 flex items-center gap-2 hover:scale-105 active:scale-95",children:[E.jsx(r3,{size:12,className:"fill-current"})," READ NOW"]})}),i.source==="openLibrary"&&E.jsx("div",{className:"absolute top-2 right-2 z-10",children:E.jsxs("div",{className:"inline-flex items-center gap-1 bg-green-500/90 backdrop-blur-md px-2 py-1 rounded-full shadow-sm",children:[E.jsx(qB,{size:8,className:"text-white"}),E.jsx("span",{className:"text-[7px] font-bold uppercase tracking-wide text-white",children:"Open Library"})]})}),i.matchReason&&E.jsx("div",{className:"absolute top-2 left-2 z-10",children:E.jsxs("div",{className:"inline-flex items-center gap-1 bg-white/90 backdrop-blur-md px-2 py-1 rounded-full shadow-sm border border-white/50",children:[E.jsx(Es,{size:8,className:"text-blue-500 fill-blue-500"}),E.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wide text-gray-800",children:"For You"})]})}),i.hasFullText&&E.jsx("div",{className:"absolute bottom-2 left-2 z-10",children:E.jsxs("div",{className:"inline-flex items-center gap-1 bg-blue-500/90 backdrop-blur-md px-2 py-1 rounded-full shadow-sm",children:[E.jsx(T3,{size:8,className:"text-white"}),E.jsx("span",{className:"text-[7px] font-bold uppercase tracking-wide text-white",children:"Full Text"})]})})]}),E.jsxs("div",{className:"mt-3 space-y-1",children:[E.jsx("h3",{className:"font-serif font-bold text-gray-900 text-base leading-tight line-clamp-2 group-hover:text-blue-600 transition-colors",children:i.title}),E.jsx("p",{className:"text-xs text-gray-500 font-medium line-clamp-1",children:i.author}),E.jsxs("div",{className:"flex items-center gap-3 pt-1",children:[i.averageRating?E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx(xE,{size:12,className:"text-yellow-400 fill-yellow-400"}),E.jsx("span",{className:"text-xs font-bold text-gray-700",children:i.averageRating.toFixed(1)}),i.ratingsCount&&i.ratingsCount>0&&E.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",C3(i.ratingsCount),")"]})]}):E.jsxs("div",{className:"flex items-center gap-0.5",children:[E.jsx(xE,{size:10,className:"text-gray-300"}),E.jsx("span",{className:"text-[10px] text-gray-400",children:"No ratings"})]}),i.reviewSnippet&&E.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded",children:[E.jsx(v3,{size:8})," Buzz"]}),i.publishedYear&&i.publishedYear!=="Unknown"&&E.jsx("span",{className:"text-[10px] text-gray-400",children:i.publishedYear})]})]})]})};function x3(i,e){try{const t=parseInt(i.replace("#",""),16),n=Math.min(255,Math.max(0,(t>>16)+e)),s=Math.min(255,Math.max(0,(t>>8&255)+e)),o=Math.min(255,Math.max(0,(t&255)+e));return`#${(n<<16|s<<8|o).toString(16).padStart(6,"0")}`}catch{return i}}function C3(i){return i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toString()}const Ac=async(i,e)=>{throw new Error("No Fallback Key")},ZD=i=>{try{const e=i.match(/\[.*\]/s)||i.match(/\{.*\}/s);return e?JSON.parse(e[0]):null}catch{return null}},d_=async i=>{try{const t=await Ac("You are a book search engine. Return a JSON array of 5 books matching the query. properties: title, author, description, publishedYear, coverColor (hex), isbn (13 digit).",`Search for: ${i}`),n=ZD(t);if(n&&Array.isArray(n))return n.map((s,o)=>({...s,id:`fallback-${Date.now()}-${o}`,categories:s.categories||["General"],isLocal:!1}));throw new Error("Parse failed")}catch{return[{id:"offline-1",title:"The Offline Library",author:"System Backup",description:"We could not reach our AI services, but here is a classic placeholder.",publishedYear:"2024",categories:["System"],coverColor:"#e2e8f0",isbn:"9780141439518",isLocal:!1}]}},Nw=async(i,e)=>{try{const n=await Ac("You are a helpful book concierge named Suitcase (Backup Mode). Reply kindly. If asked for books, provide a JSON object with 'reply' (string) and 'suggestions' (array of books with title, author, isbn).",i),s=ZD(n);return s&&s.reply?{reply:s.reply,suggestions:Array.isArray(s.suggestions)?s.suggestions.map((o,l)=>({...o,id:`fb-con-${l}`,coverColor:"#cbd5e1",isLocal:!1,categories:[]})):[]}:{reply:n,suggestions:[]}}catch{return{reply:"I'm having trouble connecting to the cloud, but I'm here listening.",suggestions:[]}}},Mw=async i=>[{id:"off-1",title:"The Great Gatsby",author:"F. Scott Fitzgerald",description:"A classic of the Jazz Age.",publishedYear:"1925",categories:["Classic"],coverColor:"#fef3c7",isbn:"9780743273565",matchReason:"Timeless classic",isLocal:!1},{id:"off-2",title:"1984",author:"George Orwell",description:"Dystopian social science fiction.",publishedYear:"1949",categories:["Sci-Fi"],coverColor:"#f3f4f6",isbn:"9780451524935",matchReason:"Essential reading",isLocal:!1},{id:"off-3",title:"Dune",author:"Frank Herbert",description:"Epic science fiction.",publishedYear:"1965",categories:["Sci-Fi"],coverColor:"#fed7aa",isbn:"9780441013593",matchReason:"Masterpiece",isLocal:!1},{id:"off-4",title:"Sapiens",author:"Yuval Noah Harari",description:"A brief history of humankind.",publishedYear:"2011",categories:["History"],coverColor:"#e0f2fe",isbn:"9780062316097",matchReason:"Thought provoking",isLocal:!1}],Dw=async(i,e)=>[{id:"rev-1",reviewerName:"Offline Reader",rating:5,text:"This book is a masterpiece!",date:"Today",avatarColor:"#3b82f6"},{id:"rev-2",reviewerName:"Bookworm",rating:4,text:"Really enjoyed the plot twists.",date:"Yesterday",avatarColor:"#ef4444"}],kw=async(i,e,t)=>{try{const n=`You are a literary assistant discussing "${i}". Keep answers short.`;return await Ac(n,e)}catch{return"I can't analyze this book right now due to connection issues."}},Pw=async i=>{try{return await Ac("Translate the following text to English.",i)}catch{return"Translation service unavailable."}},Lw=async(i,e)=>{try{const t=`Explain the context of this text from "${e}".`;return await Ac(t,i)}catch{return"Context service unavailable."}},Ow=async(i,e,t=1)=>{try{const n=`Write the detailed story content for Chapter ${t} of "${i}" by ${e}. Use HTML format <p>. Focus on storytelling, dialogue, and detail.`;return await Ac(n,"Write the full chapter content.")||"<p>Content generation failed.</p>"}catch{return`
            <h3>Chapter ${t}</h3>
            <p>We are currently unable to generate the full text for <strong>${i}</strong> due to high demand on our AI services.</p>
            <p>Please try again later or upload a local PDF copy of this book to continue reading.</p>
        `}},Uw=async i=>{try{return await Ac(`Summarize "${i}".`,"Summary:")}catch{return"Summary unavailable offline."}},Fw=async i=>{try{return await Ac(`Recap the plot of "${i}".`,"Recap:")}catch{return"Recap unavailable offline."}},R3=Object.freeze(Object.defineProperty({__proto__:null,chatAboutBook:kw,consultConcierge:Nw,explainContext:Lw,generateBookContent:Ow,generateReviews:Dw,getBookRecap:Fw,getBookSummary:Uw,getOnboardingRecommendations:Mw,searchBooks:d_,translateText:Pw},Symbol.toStringTag,{value:"Module"})),I3=async i=>d_(i),N3=async(i,e)=>Nw(i),M3=async i=>Mw(),D3=async(i,e)=>Dw(),k3=async(i,e,t)=>kw(i,e),P3=async(i,e="English")=>Pw(i),L3=async(i,e)=>Lw(i,e),O3=async(i,e,t=1)=>Ow(i,e,t),U3=async i=>Uw(i),F3=async i=>Fw(i),B3=Object.freeze(Object.defineProperty({__proto__:null,chatAboutBook:k3,consultConcierge:N3,explainContext:L3,generateBookContent:O3,generateReviews:D3,getBookRecap:F3,getBookSummary:U3,getOnboardingRecommendations:M3,searchBooks:I3,translateText:P3},Symbol.toStringTag,{value:"Module"}));var H3={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let G3,z3;function V3(){return{geminiUrl:G3,vertexUrl:z3}}function q3(i,e,t,n){var s,o;if(!(i!=null&&i.baseUrl)){const l=V3();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(o=l.geminiUrl)!==null&&o!==void 0?o:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ha{}function pe(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function v(i,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const h=i[c];if(Array.isArray(t))for(let f=0;f<h.length;f++){const g=h[f];v(g,e.slice(o+1),t[f])}else for(const f of h)v(f,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const h=i[c];v(h[0],e.slice(o+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],s=i[n];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function m(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const s=e[n];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in i){const l=i[o];return Array.isArray(l)?l.map(c=>m(c,e.slice(n+1),t)):t}else return t}else i=i[s]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function $3(i,e){for(const[t,n]of Object.entries(e)){const s=t.split("."),o=n.split("."),l=new Set;let c=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){c=h;break}if(c!==-1&&o.length>c)for(let h=c;h<o.length;h++){const f=o[h];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}CE(i,s,o,0,l)}}function CE(i,e,t,n,s){if(n>=e.length||typeof i!="object"||i===null)return;const o=e[n];if(o.endsWith("[]")){const l=o.slice(0,-2),c=i;if(l in c&&Array.isArray(c[l]))for(const h of c[l])CE(h,e,t,n+1,s)}else if(o==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const l=i,c=Object.keys(l).filter(f=>!f.startsWith("_")&&!s.has(f)),h={};for(const f of c)h[f]=l[f];for(const[f,g]of Object.entries(h)){const y=[];for(const b of t.slice(n))b==="*"?y.push(f):y.push(b);v(l,y,g)}for(const f of c)delete l[f]}}else{const l=i;o in l&&CE(l[o],e,t,n+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bw(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y3(i){const e={},t=m(i,["operationName"]);t!=null&&v(e,["operationName"],t);const n=m(i,["resourceName"]);return n!=null&&v(e,["_url","resourceName"],n),e}function j3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],X3(l)),e}function W3(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],K3(l)),e}function X3(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>J3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function K3(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Q3(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function J3(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],s4(t)),e}function Q3(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],r4(t)),e}function Z3(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function e4(i){const e={},t=m(i,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function t4(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],n4(l)),e}function n4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function ek(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],i4(l)),e}function i4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function s4(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],Bw(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function r4(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],Bw(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $I;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($I||($I={}));var YI;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(YI||(YI={}));var jI;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(jI||(jI={}));var ke;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(ke||(ke={}));var WI;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(WI||(WI={}));var XI;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(XI||(XI={}));var KI;(function(i){i.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",i.HTTP_IN_QUERY="HTTP_IN_QUERY",i.HTTP_IN_HEADER="HTTP_IN_HEADER",i.HTTP_IN_PATH="HTTP_IN_PATH",i.HTTP_IN_BODY="HTTP_IN_BODY",i.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(KI||(KI={}));var JI;(function(i){i.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",i.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",i.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",i.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(JI||(JI={}));var QI;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(QI||(QI={}));var ZI;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(ZI||(ZI={}));var eN;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(eN||(eN={}));var tN;(function(i){i.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH",i.MINIMAL="MINIMAL"})(tN||(tN={}));var nN;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(nN||(nN={}));var iN;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(iN||(iN={}));var sN;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(sN||(sN={}));var rN;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE",i.IMAGE_RECITATION="IMAGE_RECITATION",i.IMAGE_OTHER="IMAGE_OTHER"})(rN||(rN={}));var oN;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(oN||(oN={}));var aN;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(aN||(aN={}));var lN;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(lN||(lN={}));var cN;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(cN||(cN={}));var uN;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(uN||(uN={}));var vb;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(vb||(vb={}));var dN;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(dN||(dN={}));var hN;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(hN||(hN={}));var fN;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(fN||(fN={}));var RE;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(RE||(RE={}));var pN;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V",i.TUNING_TASK_R2V="TUNING_TASK_R2V"})(pN||(pN={}));var gN;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",i.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(gN||(gN={}));var IE;(function(i){i.COLLECTION="COLLECTION"})(IE||(IE={}));var mN;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(mN||(mN={}));var yN;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(yN||(yN={}));var vN;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(vN||(vN={}));var bN;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(bN||(bN={}));var _N;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(_N||(_N={}));var SN;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(SN||(SN={}));var AN;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(AN||(AN={}));var EN;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(EN||(EN={}));var TN;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(TN||(TN={}));var wN;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(wN||(wN={}));var xN;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(xN||(xN={}));var CN;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(CN||(CN={}));var RN;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(RN||(RN={}));var IN;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(IN||(IN={}));var NN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.STATE_PENDING="STATE_PENDING",i.STATE_ACTIVE="STATE_ACTIVE",i.STATE_FAILED="STATE_FAILED"})(NN||(NN={}));var MN;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(MN||(MN={}));var DN;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED",i.REGISTERED="REGISTERED"})(DN||(DN={}));var kN;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(kN||(kN={}));var PN;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(PN||(PN={}));var LN;(function(i){i.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",i.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",i.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(LN||(LN={}));var ON;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.ACTIVITY_START="ACTIVITY_START",i.ACTIVITY_END="ACTIVITY_END"})(ON||(ON={}));var UN;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(UN||(UN={}));var FN;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(FN||(FN={}));var BN;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(BN||(BN={}));var HN;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(HN||(HN={}));var GN;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(GN||(GN={}));var zN;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(zN||(zN={}));var Eh;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Eh||(Eh={}));class NE{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class gg{get text(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const y=[];for(const b of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[A,w]of Object.entries(b))A!=="text"&&A!=="thought"&&A!=="thoughtSignature"&&(w!==null||w!==void 0)&&y.push(A);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;g=!0,f+=b.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const y of(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[b,A]of Object.entries(y))b!=="inlineData"&&(A!==null||A!==void 0)&&g.push(b);y.inlineData&&typeof y.inlineData.data=="string"&&(f+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,n,s,o,l,c,h;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,n,s,o,l,c,h,f;if(((s=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(h=(c=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class VN{}class qN{}class o4{}class a4{}class l4{}class c4{}class $N{}class YN{}class jN{}class u4{}class bb{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new bb;let s;const o=e;return t?s=W3(o):s=j3(o),Object.assign(n,s),n}}class WN{}class XN{}class KN{}class JN{}class d4{}class h4{}class f4{}class Hw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Hw,o=t4(e);return Object.assign(n,o),n}}class p4{}class g4{}class m4{}class QN{}class y4{get text(){var e,t,n;let s="",o=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[h,f]of Object.entries(c))h!=="text"&&h!=="thought"&&f!==null&&l.push(h);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;o=!0,s+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,t,n;let s="";const o=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,h]of Object.entries(l))c!=="inlineData"&&h!==null&&o.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class v4{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Gw{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Gw,o=ek(e);return Object.assign(n,o),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ht(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function tk(i,e){const t=ht(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function nk(i){return Array.isArray(i)?i.map(e=>_b(e)):[_b(i)]}function _b(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function ik(i){const e=_b(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function sk(i){const e=_b(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ZN(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function rk(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>ZN(e)):[ZN(i)]}function ME(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function eM(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function tM(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function di(i){if(i==null)throw new Error("ContentUnion is required");return ME(i)?i:{role:"user",parts:rk(i)}}function zw(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=di(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=di(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>di(t)):[di(e)]}function er(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(eM(i)||tM(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[di(i)]}const e=[],t=[],n=ME(i[0]);for(const s of i){const o=ME(s);if(o!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(eM(s)||tM(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return n||e.push({role:"user",parts:rk(t)}),e}function b4(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(ke).includes(t[0].toUpperCase())?t[0].toUpperCase():ke.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(ke).includes(n.toUpperCase())?n.toUpperCase():ke.TYPE_UNSPECIFIED})}}function Mh(i){const e={},t=["items"],n=["anyOf"],s=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=i.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,i=o[1]):o[1].type==="null"&&(e.nullable=!0,i=o[0])),i.type instanceof Array&&b4(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(ke).includes(c.toUpperCase())?c.toUpperCase():ke.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Mh(c);else if(n.includes(l)){const h=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}h.push(Mh(f))}e[l]=h}else if(s.includes(l)){const h={};for(const[f,g]of Object.entries(c))h[f]=Mh(g);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Vw(i){return Mh(i)}function qw(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function $w(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function yp(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Mh(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Mh(e.response));return i}function vp(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function _4(i,e,t,n=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:s?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Ga(i,e){if(typeof e!="string")throw new Error("name must be a string");return _4(i,e,"cachedContents")}function ok(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function Ec(i){return Bw(i)}function S4(i){return i!=null&&typeof i=="object"&&"name"in i}function A4(i){return i!=null&&typeof i=="object"&&"video"in i}function E4(i){return i!=null&&typeof i=="object"&&"uri"in i}function ak(i){var e;let t;if(S4(i)&&(t=i.name),!(E4(i)&&(t=i.uri,t===void 0))&&!(A4(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function lk(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function ck(i){for(const e of["models","tunedModels","publisherModels"])if(T4(i,e))return i[e];return[]}function T4(i,e){return i!==null&&typeof i=="object"&&e in i}function w4(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function x4(i,e={}){const t=[],n=new Set;for(const s of i){const o=s.name;if(n.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);n.add(o);const l=w4(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function uk(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(s>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function C4(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function dk(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return i;let o=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function bp(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function hk(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R4(i){const e={},t=m(i,["responsesFile"]);t!=null&&v(e,["fileName"],t);const n=m(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>lH(l))),v(e,["inlinedResponses"],o)}const s=m(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["inlinedEmbedContentResponses"],o)}return e}function I4(i){const e={},t=m(i,["predictionsFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsDestination","outputUriPrefix"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigqueryDestination","outputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function N4(i){const e={},t=m(i,["format"]);t!=null&&v(e,["predictionsFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsDestination","outputUriPrefix"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigqueryDestination","outputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function kv(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata","displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["metadata","state"]);s!=null&&v(e,["state"],hk(s));const o=m(i,["metadata","createTime"]);o!=null&&v(e,["createTime"],o);const l=m(i,["metadata","endTime"]);l!=null&&v(e,["endTime"],l);const c=m(i,["metadata","updateTime"]);c!=null&&v(e,["updateTime"],c);const h=m(i,["metadata","model"]);h!=null&&v(e,["model"],h);const f=m(i,["metadata","output"]);return f!=null&&v(e,["dest"],R4(dk(f))),e}function DE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["state"]);s!=null&&v(e,["state"],hk(s));const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["createTime"]);l!=null&&v(e,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(e,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(e,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(e,["updateTime"],f);const g=m(i,["model"]);g!=null&&v(e,["model"],g);const y=m(i,["inputConfig"]);y!=null&&v(e,["src"],M4(y));const b=m(i,["outputConfig"]);b!=null&&v(e,["dest"],I4(dk(b)));const A=m(i,["completionStats"]);return A!=null&&v(e,["completionStats"],A),e}function M4(i){const e={},t=m(i,["instancesFormat"]);t!=null&&v(e,["format"],t);const n=m(i,["gcsSource","uris"]);n!=null&&v(e,["gcsUri"],n);const s=m(i,["bigquerySource","inputUri"]);return s!=null&&v(e,["bigqueryUri"],s),e}function D4(i,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(e,["fileName"]);n!=null&&v(t,["fileName"],n);const s=m(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>aH(i,l))),v(t,["requests","requests"],o)}return t}function k4(i){const e={},t=m(i,["format"]);t!=null&&v(e,["instancesFormat"],t);const n=m(i,["gcsUri"]);n!=null&&v(e,["gcsSource","uris"],n);const s=m(i,["bigqueryUri"]);if(s!=null&&v(e,["bigquerySource","inputUri"],s),m(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function P4(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function L4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function O4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function U4(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],F4(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function F4(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function fk(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>gH(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function B4(i,e){const t={},n=m(i,["displayName"]);if(e!==void 0&&n!=null&&v(e,["batch","displayName"],n),m(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function H4(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["dest"]);return e!==void 0&&s!=null&&v(e,["outputConfig"],N4(C4(s))),t}function nM(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],D4(i,uk(i,s)));const o=m(e,["config"]);return o!=null&&B4(o,t),t}function G4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],ht(i,n));const s=m(e,["src"]);s!=null&&v(t,["inputConfig"],k4(uk(i,s)));const o=m(e,["config"]);return o!=null&&H4(o,t),t}function z4(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["batch","displayName"],n),t}function V4(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["src"]);s!=null&&v(t,["batch","inputConfig"],K4(i,s));const o=m(e,["config"]);return o!=null&&z4(o,t),t}function q4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function $4(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function Y4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function j4(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);return o!=null&&v(e,["error"],o),e}function W4(i,e){const t={},n=m(e,["contents"]);if(n!=null){let o=zw(i,n);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["requests[]","request","content"],o)}const s=m(e,["config"]);return s!=null&&(v(t,["_self"],X4(s,t)),$3(t,{"requests[].*":"requests[].request.*"})),t}function X4(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function K4(i,e){const t={},n=m(e,["fileName"]);n!=null&&v(t,["file_name"],n);const s=m(e,["inlinedRequests"]);return s!=null&&v(t,["requests"],W4(i,s)),t}function J4(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function Q4(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Z4(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function eH(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],fk(di(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const x=m(e,["seed"]);x!=null&&v(n,["seed"],x);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Vw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let le=k;Array.isArray(le)&&(le=le.map(ue=>mH(ue))),v(t,["safetySettings"],le)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let le=vp(L);Array.isArray(le)&&(le=le.map(ue=>vH(yp(ue)))),v(t,["tools"],le)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],yH(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=m(e,["cachedContent"]);t!==void 0&&F!=null&&v(t,["cachedContent"],Ga(i,F));const U=m(e,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const X=m(e,["mediaResolution"]);X!=null&&v(n,["mediaResolution"],X);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],qw(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=m(e,["thinkingConfig"]);Z!=null&&v(n,["thinkingConfig"],Z);const ee=m(e,["imageConfig"]);ee!=null&&v(n,["imageConfig"],oH(ee));const se=m(e,["enableEnhancedCivicAnswers"]);if(se!=null&&v(n,["enableEnhancedCivicAnswers"],se),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function tH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>U4(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function nH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function iH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],bp(i,n)),t}function sH(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function rH(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function oH(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function aH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["request","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let c=er(s);Array.isArray(c)&&(c=c.map(h=>fk(h))),v(t,["request","contents"],c)}const o=m(e,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(e,["config"]);return l!=null&&v(t,["request","generationConfig"],eH(i,l,m(t,["request"],{}))),t}function lH(i){const e={},t=m(i,["response"]);t!=null&&v(e,["response"],tH(t));const n=m(i,["error"]);return n!=null&&v(e,["error"],n),e}function cH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);if(e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),m(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function uH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);e!==void 0&&s!=null&&v(e,["_query","pageToken"],s);const o=m(i,["filter"]);return e!==void 0&&o!=null&&v(e,["_query","filter"],o),t}function dH(i){const e={},t=m(i,["config"]);return t!=null&&cH(t,e),e}function hH(i){const e={},t=m(i,["config"]);return t!=null&&uH(t,e),e}function fH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>kv(l))),v(e,["batchJobs"],o)}return e}function pH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>DE(l))),v(e,["batchJobs"],o)}return e}function gH(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],J4(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],Q4(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],P4(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function mH(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function yH(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],Z4(n)),e}function vH(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],sH(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],rH(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Da;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",i.PAGED_ITEM_DOCUMENTS="documents"})(Da||(Da={}));class bd{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bH extends Ha{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bd(Da.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=nM(this.apiClient,e),n=t._url,s=pe("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,h=c.requests,f=[];for(const g of h){const y=Object.assign({},g);if(y.systemInstruction){const b=y.systemInstruction;delete y.systemInstruction;const A=y.request;A.systemInstruction=b,y.request=A}f.push(y)}return c.requests=f,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),n.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?n.dest=`${o.slice(0,-6)}/dest`:n.dest=`${o}_dest_${s}`;else if(l)n.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=G4(this.apiClient,e);return c=pe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>DE(g))}else{const f=nM(this.apiClient,e);return c=pe("{model}:batchGenerateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>kv(g))}}async createEmbeddingsInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=V4(this.apiClient,e);return o=pe("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>kv(h))}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=iH(this.apiClient,e);return c=pe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>DE(g))}else{const f=nH(this.apiClient,e);return c=pe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>kv(g))}}async cancel(e){var t,n,s,o;let l="",c={};if(this.apiClient.isVertexAI()){const h=O4(this.apiClient,e);l=pe("batchPredictionJobs/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const h=L4(this.apiClient,e);l=pe("batches/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=hH(e);return c=pe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=pH(g),b=new QN;return Object.assign(b,y),b})}else{const f=dH(e);return c=pe("batches",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=fH(g),b=new QN;return Object.assign(b,y),b})}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=$4(this.apiClient,e);return c=pe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>j4(g))}else{const f=q4(this.apiClient,e);return c=pe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>Y4(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _H(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function iM(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>VH(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function SH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let g=er(l);Array.isArray(g)&&(g=g.map(y=>iM(y))),v(e,["contents"],g)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],iM(di(c)));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>$H(y))),v(e,["tools"],g)}const f=m(i,["toolConfig"]);if(e!==void 0&&f!=null&&v(e,["toolConfig"],qH(f)),m(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function AH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);e!==void 0&&s!=null&&v(e,["expireTime"],s);const o=m(i,["displayName"]);e!==void 0&&o!=null&&v(e,["displayName"],o);const l=m(i,["contents"]);if(e!==void 0&&l!=null){let y=er(l);Array.isArray(y)&&(y=y.map(b=>b)),v(e,["contents"],y)}const c=m(i,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],di(c));const h=m(i,["tools"]);if(e!==void 0&&h!=null){let y=h;Array.isArray(y)&&(y=y.map(b=>YH(b))),v(e,["tools"],y)}const f=m(i,["toolConfig"]);e!==void 0&&f!=null&&v(e,["toolConfig"],f);const g=m(i,["kmsKeyName"]);return e!==void 0&&g!=null&&v(e,["encryption_spec","kmsKeyName"],g),t}function EH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],tk(i,n));const s=m(e,["config"]);return s!=null&&SH(s,t),t}function TH(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],tk(i,n));const s=m(e,["config"]);return s!=null&&AH(s,t),t}function wH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Ga(i,n)),t}function xH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Ga(i,n)),t}function CH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function RH(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function IH(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function NH(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function MH(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function DH(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function kH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Ga(i,n)),t}function PH(i,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Ga(i,n)),t}function LH(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function OH(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function UH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function FH(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function BH(i){const e={},t=m(i,["config"]);return t!=null&&UH(t,e),e}function HH(i){const e={},t=m(i,["config"]);return t!=null&&FH(t,e),e}function GH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function zH(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["cachedContents"],o)}return e}function VH(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],IH(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],NH(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],_H(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function qH(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],MH(n)),e}function $H(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],LH(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],OH(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function YH(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>DH(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function jH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function WH(i,e){const t={},n=m(i,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const s=m(i,["expireTime"]);return e!==void 0&&s!=null&&v(e,["expireTime"],s),t}function XH(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],Ga(i,n));const s=m(e,["config"]);return s!=null&&jH(s,t),t}function KH(i,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],Ga(i,n));const s=m(e,["config"]);return s!=null&&WH(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JH extends Ha{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bd(Da.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=TH(this.apiClient,e);return c=pe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=EH(this.apiClient,e);return c=pe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=PH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=kH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=xH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=RH(g),b=new KN;return Object.assign(b,y),b})}else{const f=wH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=CH(g),b=new KN;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=KH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>g)}else{const f=XH(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>g)}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=HH(e);return c=pe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=zH(g),b=new JN;return Object.assign(b,y),b})}else{const f=BH(e);return c=pe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=GH(g),b=new JN;return Object.assign(b,y),b})}}}function Sb(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function sM(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pe(i){return this instanceof Pe?(this.v=i,this):new Pe(i)}function Tr(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(A){return function(w){return Promise.resolve(w).then(A,y)}}function c(A,w){n[A]&&(s[A]=function(x){return new Promise(function(N,I){o.push([A,x,N,I])>1||h(A,x)})},w&&(s[A]=w(s[A])))}function h(A,w){try{f(n[A](w))}catch(x){b(o[0][3],x)}}function f(A){A.value instanceof Pe?Promise.resolve(A.value.v).then(g,y):b(o[0][2],A)}function g(A){h("next",A)}function y(A){h("throw",A)}function b(A,w){A(w),o.shift(),o.length&&h(o[0][0],o[0][1])}}function wr(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof sM=="function"?sM(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=i[o]&&function(l){return new Promise(function(c,h){l=i[o](l),s(c,h,l.done,l.value)})}}function s(o,l,c,h){Promise.resolve(h).then(function(f){o({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QH(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:pk(t)}function pk(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function ZH(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rM(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const s=[];let o=!0;for(;n<t&&i[n].role==="model";)s.push(i[n]),o&&!pk(i[n])&&(o=!1),n++;o?e.push(...s):e.pop()}return e}class e5{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new t5(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class t5{constructor(e,t,n,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),ZH(o)}async sendMessage(e){var t;await this.sendPromise;const n=di(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,c;const h=await s,f=(l=(o=h.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,g=h.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let b=[];g!=null&&(b=(c=g.slice(y))!==null&&c!==void 0?c:[]);const A=f?[f]:[];this.recordHistory(n,A,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=di(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,n)}getHistory(e=!1){const t=e?rM(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Tr(this,arguments,function*(){var s,o,l,c,h,f;const g=[];try{for(var y=!0,b=wr(e),A;A=yield Pe(b.next()),s=A.done,!s;y=!0){c=A.value,y=!1;const w=c;if(QH(w)){const x=(f=(h=w.candidates)===null||h===void 0?void 0:h[0])===null||f===void 0?void 0:f.content;x!==void 0&&g.push(x)}yield yield Pe(w)}}catch(w){o={error:w}}finally{try{!y&&!s&&(l=b.return)&&(yield Pe(l.call(b)))}finally{if(o)throw o.error}}this.recordHistory(t,g)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(o=>o.role!==void 0)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...rM(n)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xg extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Xg.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n5(i){const e={},t=m(i,["file"]);return t!=null&&v(e,["file"],t),e}function i5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function s5(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],ak(t)),e}function r5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function o5(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","file"],ak(t)),e}function a5(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function l5(i){const e={},t=m(i,["config"]);return t!=null&&a5(t,e),e}function c5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class u5 extends Ha{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bd(Da.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=l5(e);return o=pe("files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=c5(h),g=new p4;return Object.assign(g,f),g})}}async createInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=n5(e);return o=pe("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=i5(h),g=new g4;return Object.assign(g,f),g})}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=o5(e);return o=pe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=s5(e);return o=pe("files/{file}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=r5(h),g=new m4;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pv(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function d5(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>C5(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function h5(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function f5(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function p5(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function g5(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const x=m(i,["responseSchema"]);x!=null&&v(e,["responseSchema"],x);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const F=m(i,["topK"]);F!=null&&v(e,["topK"],F);const U=m(i,["topP"]);if(U!=null&&v(e,["topP"],U),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function m5(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function y5(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function v5(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],$w(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],d5(di(w)));const x=m(i,["tools"]);if(e!==void 0&&x!=null){let F=vp(x);Array.isArray(F)&&(F=F.map(U=>I5(yp(U)))),v(e,["setup","tools"],F)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],R5(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function b5(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],g5(n));const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],$w(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],di(w));const x=m(i,["tools"]);if(e!==void 0&&x!=null){let U=vp(x);Array.isArray(U)&&(U=U.map(X=>N5(yp(X)))),v(e,["setup","tools"],U)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],N);const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);e!==void 0&&O!=null&&v(e,["setup","proactivity"],O);const F=m(i,["explicitVadSignal"]);return e!==void 0&&F!=null&&v(e,["setup","explicitVadSignal"],F),t}function _5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ht(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],v5(s,t)),t}function S5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ht(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],b5(s,t)),t}function A5(i){const e={},t=m(i,["musicGenerationConfig"]);return t!=null&&v(e,["musicGenerationConfig"],t),e}function E5(i){const e={},t=m(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["weightedPrompts"],n)}return e}function T5(i){const e={},t=m(i,["media"]);if(t!=null){let f=nk(t);Array.isArray(f)&&(f=f.map(g=>Pv(g))),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],Pv(sk(n)));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],Pv(ik(o)));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function w5(i){const e={},t=m(i,["media"]);if(t!=null){let f=nk(t);Array.isArray(f)&&(f=f.map(g=>g)),v(e,["mediaChunks"],f)}const n=m(i,["audio"]);n!=null&&v(e,["audio"],sk(n));const s=m(i,["audioStreamEnd"]);s!=null&&v(e,["audioStreamEnd"],s);const o=m(i,["video"]);o!=null&&v(e,["video"],ik(o));const l=m(i,["text"]);l!=null&&v(e,["text"],l);const c=m(i,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(i,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function x5(i){const e={},t=m(i,["setupComplete"]);t!=null&&v(e,["setupComplete"],t);const n=m(i,["serverContent"]);n!=null&&v(e,["serverContent"],n);const s=m(i,["toolCall"]);s!=null&&v(e,["toolCall"],s);const o=m(i,["toolCallCancellation"]);o!=null&&v(e,["toolCallCancellation"],o);const l=m(i,["usageMetadata"]);l!=null&&v(e,["usageMetadata"],M5(l));const c=m(i,["goAway"]);c!=null&&v(e,["goAway"],c);const h=m(i,["sessionResumptionUpdate"]);h!=null&&v(e,["sessionResumptionUpdate"],h);const f=m(i,["voiceActivityDetectionSignal"]);f!=null&&v(e,["voiceActivityDetectionSignal"],f);const g=m(i,["voiceActivity"]);return g!=null&&v(e,["voiceActivity"],D5(g)),e}function C5(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],h5(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],f5(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],Pv(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function R5(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function I5(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],m5(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],y5(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function N5(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>p5(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function M5(i){const e={},t=m(i,["promptTokenCount"]);t!=null&&v(e,["promptTokenCount"],t);const n=m(i,["cachedContentTokenCount"]);n!=null&&v(e,["cachedContentTokenCount"],n);const s=m(i,["candidatesTokenCount"]);s!=null&&v(e,["responseTokenCount"],s);const o=m(i,["toolUsePromptTokenCount"]);o!=null&&v(e,["toolUsePromptTokenCount"],o);const l=m(i,["thoughtsTokenCount"]);l!=null&&v(e,["thoughtsTokenCount"],l);const c=m(i,["totalTokenCount"]);c!=null&&v(e,["totalTokenCount"],c);const h=m(i,["promptTokensDetails"]);if(h!=null){let A=h;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["promptTokensDetails"],A)}const f=m(i,["cacheTokensDetails"]);if(f!=null){let A=f;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["cacheTokensDetails"],A)}const g=m(i,["candidatesTokensDetails"]);if(g!=null){let A=g;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["responseTokensDetails"],A)}const y=m(i,["toolUsePromptTokensDetails"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(w=>w)),v(e,["toolUsePromptTokensDetails"],A)}const b=m(i,["trafficType"]);return b!=null&&v(e,["trafficType"],b),e}function D5(i){const e={},t=m(i,["type"]);return t!=null&&v(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k5(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function P5(i){const e={},t=m(i,["content"]);t!=null&&v(e,["content"],t);const n=m(i,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],L5(n));const s=m(i,["tokenCount"]);s!=null&&v(e,["tokenCount"],s);const o=m(i,["finishReason"]);o!=null&&v(e,["finishReason"],o);const l=m(i,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(i,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(i,["index"]);h!=null&&v(e,["index"],h);const f=m(i,["logprobsResult"]);f!=null&&v(e,["logprobsResult"],f);const g=m(i,["safetyRatings"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(A=>A)),v(e,["safetyRatings"],b)}const y=m(i,["urlContextMetadata"]);return y!=null&&v(e,["urlContextMetadata"],y),e}function L5(i){const e={},t=m(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>s)),v(e,["citations"],n)}return e}function O5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let o=er(s);Array.isArray(o)&&(o=o.map(l=>l)),v(t,["contents"],o)}return t}function U5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["tokensInfo"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["tokensInfo"],s)}return e}function F5(i){const e={},t=m(i,["values"]);t!=null&&v(e,["values"],t);const n=m(i,["statistics"]);return n!=null&&v(e,["statistics"],B5(n)),e}function B5(i){const e={},t=m(i,["truncated"]);t!=null&&v(e,["truncated"],t);const n=m(i,["token_count"]);return n!=null&&v(e,["tokenCount"],n),e}function h_(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>W6(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function H5(i){const e={},t=m(i,["controlType"]);t!=null&&v(e,["controlType"],t);const n=m(i,["enableControlImageComputation"]);return n!=null&&v(e,["computeControl"],n),e}function G5(i){const e={};if(m(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function z5(i,e){const t={},n=m(i,["systemInstruction"]);e!==void 0&&n!=null&&v(e,["systemInstruction"],di(n));const s=m(i,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>vk(c))),v(e,["tools"],l)}const o=m(i,["generationConfig"]);return e!==void 0&&o!=null&&v(e,["generationConfig"],k6(o)),t}function V5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let l=er(s);Array.isArray(l)&&(l=l.map(c=>h_(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&G5(o),t}function q5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let l=er(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&z5(o,t),t}function $5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);n!=null&&v(e,["totalTokens"],n);const s=m(i,["cachedContentTokenCount"]);return s!=null&&v(e,["cachedContentTokenCount"],s),e}function Y5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["totalTokens"]);return n!=null&&v(e,["totalTokens"],n),e}function j5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ht(i,n)),t}function W5(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ht(i,n)),t}function X5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function K5(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function J5(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const x=m(i,["outputCompressionQuality"]);e!==void 0&&x!=null&&v(e,["parameters","outputOptions","compressionQuality"],x);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["editMode"]);e!==void 0&&P!=null&&v(e,["parameters","editMode"],P);const k=m(i,["baseSteps"]);return e!==void 0&&k!=null&&v(e,["parameters","editConfig","baseSteps"],k),t}function Q5(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["referenceImages"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>eG(h))),v(t,["instances[0]","referenceImages"],c)}const l=m(e,["config"]);return l!=null&&J5(l,t),t}function Z5(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>f_(o))),v(e,["generatedImages"],s)}return e}function e6(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["requests[]","title"],s);const o=m(i,["outputDimensionality"]);if(e!==void 0&&o!=null&&v(e,["requests[]","outputDimensionality"],o),m(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function t6(i,e){const t={},n=m(i,["taskType"]);e!==void 0&&n!=null&&v(e,["instances[]","task_type"],n);const s=m(i,["title"]);e!==void 0&&s!=null&&v(e,["instances[]","title"],s);const o=m(i,["outputDimensionality"]);e!==void 0&&o!=null&&v(e,["parameters","outputDimensionality"],o);const l=m(i,["mimeType"]);e!==void 0&&l!=null&&v(e,["instances[]","mimeType"],l);const c=m(i,["autoTruncate"]);return e!==void 0&&c!=null&&v(e,["parameters","autoTruncate"],c),t}function n6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let c=zw(i,s);Array.isArray(c)&&(c=c.map(h=>h)),v(t,["requests[]","content"],c)}const o=m(e,["config"]);o!=null&&e6(o,t);const l=m(e,["model"]);return l!==void 0&&v(t,["requests[]","model"],ht(i,l)),t}function i6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let l=zw(i,s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["instances[]","content"],l)}const o=m(e,["config"]);return o!=null&&t6(o,t),t}function s6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function r6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions[]","embeddings"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>F5(l))),v(e,["embeddings"],o)}const s=m(i,["metadata"]);return s!=null&&v(e,["metadata"],s),e}function o6(i){const e={},t=m(i,["endpoint"]);t!=null&&v(e,["name"],t);const n=m(i,["deployedModelId"]);return n!=null&&v(e,["deployedModelId"],n),e}function a6(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function l6(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function c6(i){const e={},t=m(i,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(i,["mode"]);if(n!=null&&v(e,["mode"],n),m(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function u6(i){const e={},t=m(i,["description"]);t!=null&&v(e,["description"],t);const n=m(i,["name"]);n!=null&&v(e,["name"],n);const s=m(i,["parameters"]);s!=null&&v(e,["parameters"],s);const o=m(i,["parametersJsonSchema"]);o!=null&&v(e,["parametersJsonSchema"],o);const l=m(i,["response"]);l!=null&&v(e,["response"],l);const c=m(i,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function d6(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],h_(di(s)));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const x=m(e,["seed"]);x!=null&&v(n,["seed"],x);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Vw(I));const P=m(e,["responseJsonSchema"]);if(P!=null&&v(n,["responseJsonSchema"],P),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=m(e,["safetySettings"]);if(t!==void 0&&k!=null){let le=k;Array.isArray(le)&&(le=le.map(ue=>tG(ue))),v(t,["safetySettings"],le)}const L=m(e,["tools"]);if(t!==void 0&&L!=null){let le=vp(L);Array.isArray(le)&&(le=le.map(ue=>lG(yp(ue)))),v(t,["tools"],le)}const O=m(e,["toolConfig"]);if(t!==void 0&&O!=null&&v(t,["toolConfig"],aG(O)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=m(e,["cachedContent"]);t!==void 0&&F!=null&&v(t,["cachedContent"],Ga(i,F));const U=m(e,["responseModalities"]);U!=null&&v(n,["responseModalities"],U);const X=m(e,["mediaResolution"]);X!=null&&v(n,["mediaResolution"],X);const q=m(e,["speechConfig"]);if(q!=null&&v(n,["speechConfig"],qw(q)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=m(e,["thinkingConfig"]);Z!=null&&v(n,["thinkingConfig"],Z);const ee=m(e,["imageConfig"]);ee!=null&&v(n,["imageConfig"],F6(ee));const se=m(e,["enableEnhancedCivicAnswers"]);if(se!=null&&v(n,["enableEnhancedCivicAnswers"],se),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return n}function h6(i,e,t){const n={},s=m(e,["systemInstruction"]);t!==void 0&&s!=null&&v(t,["systemInstruction"],di(s));const o=m(e,["temperature"]);o!=null&&v(n,["temperature"],o);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&v(n,["maxOutputTokens"],f);const g=m(e,["stopSequences"]);g!=null&&v(n,["stopSequences"],g);const y=m(e,["responseLogprobs"]);y!=null&&v(n,["responseLogprobs"],y);const b=m(e,["logprobs"]);b!=null&&v(n,["logprobs"],b);const A=m(e,["presencePenalty"]);A!=null&&v(n,["presencePenalty"],A);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const x=m(e,["seed"]);x!=null&&v(n,["seed"],x);const N=m(e,["responseMimeType"]);N!=null&&v(n,["responseMimeType"],N);const I=m(e,["responseSchema"]);I!=null&&v(n,["responseSchema"],Vw(I));const P=m(e,["responseJsonSchema"]);P!=null&&v(n,["responseJsonSchema"],P);const k=m(e,["routingConfig"]);k!=null&&v(n,["routingConfig"],k);const L=m(e,["modelSelectionConfig"]);L!=null&&v(n,["modelConfig"],L);const O=m(e,["safetySettings"]);if(t!==void 0&&O!=null){let $=O;Array.isArray($)&&($=$.map(oe=>oe)),v(t,["safetySettings"],$)}const F=m(e,["tools"]);if(t!==void 0&&F!=null){let $=vp(F);Array.isArray($)&&($=$.map(oe=>vk(yp(oe)))),v(t,["tools"],$)}const U=m(e,["toolConfig"]);t!==void 0&&U!=null&&v(t,["toolConfig"],U);const X=m(e,["labels"]);t!==void 0&&X!=null&&v(t,["labels"],X);const q=m(e,["cachedContent"]);t!==void 0&&q!=null&&v(t,["cachedContent"],Ga(i,q));const Z=m(e,["responseModalities"]);Z!=null&&v(n,["responseModalities"],Z);const ee=m(e,["mediaResolution"]);ee!=null&&v(n,["mediaResolution"],ee);const se=m(e,["speechConfig"]);se!=null&&v(n,["speechConfig"],qw(se));const le=m(e,["audioTimestamp"]);le!=null&&v(n,["audioTimestamp"],le);const ue=m(e,["thinkingConfig"]);ue!=null&&v(n,["thinkingConfig"],ue);const ye=m(e,["imageConfig"]);if(ye!=null&&v(n,["imageConfig"],B6(ye)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const G=m(e,["modelArmorConfig"]);return t!==void 0&&G!=null&&v(t,["modelArmorConfig"],G),n}function oM(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let l=er(s);Array.isArray(l)&&(l=l.map(c=>h_(c))),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],d6(i,o,t)),t}function aM(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["contents"]);if(s!=null){let l=er(s);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const o=m(e,["config"]);return o!=null&&v(t,["generationConfig"],h6(i,o,t)),t}function lM(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(f=>P5(f))),v(e,["candidates"],h)}const s=m(i,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const o=m(i,["promptFeedback"]);o!=null&&v(e,["promptFeedback"],o);const l=m(i,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(i,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function cM(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(g=>g)),v(e,["candidates"],f)}const s=m(i,["createTime"]);s!=null&&v(e,["createTime"],s);const o=m(i,["modelVersion"]);o!=null&&v(e,["modelVersion"],o);const l=m(i,["promptFeedback"]);l!=null&&v(e,["promptFeedback"],l);const c=m(i,["responseId"]);c!=null&&v(e,["responseId"],c);const h=m(i,["usageMetadata"]);return h!=null&&v(e,["usageMetadata"],h),e}function f6(i,e){const t={};if(m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["aspectRatio"]);e!==void 0&&s!=null&&v(e,["parameters","aspectRatio"],s);const o=m(i,["guidanceScale"]);if(e!==void 0&&o!=null&&v(e,["parameters","guidanceScale"],o),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(i,["safetyFilterLevel"]);e!==void 0&&l!=null&&v(e,["parameters","safetySetting"],l);const c=m(i,["personGeneration"]);e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c);const h=m(i,["includeSafetyAttributes"]);e!==void 0&&h!=null&&v(e,["parameters","includeSafetyAttributes"],h);const f=m(i,["includeRaiReason"]);e!==void 0&&f!=null&&v(e,["parameters","includeRaiReason"],f);const g=m(i,["language"]);e!==void 0&&g!=null&&v(e,["parameters","language"],g);const y=m(i,["outputMimeType"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","mimeType"],y);const b=m(i,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&v(e,["parameters","outputOptions","compressionQuality"],b),m(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=m(i,["imageSize"]);if(e!==void 0&&A!=null&&v(e,["parameters","sampleImageSize"],A),m(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function p6(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["negativePrompt"]);e!==void 0&&s!=null&&v(e,["parameters","negativePrompt"],s);const o=m(i,["numberOfImages"]);e!==void 0&&o!=null&&v(e,["parameters","sampleCount"],o);const l=m(i,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(i,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(i,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const f=m(i,["safetyFilterLevel"]);e!==void 0&&f!=null&&v(e,["parameters","safetySetting"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["includeSafetyAttributes"]);e!==void 0&&y!=null&&v(e,["parameters","includeSafetyAttributes"],y);const b=m(i,["includeRaiReason"]);e!==void 0&&b!=null&&v(e,["parameters","includeRaiReason"],b);const A=m(i,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const w=m(i,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const x=m(i,["outputCompressionQuality"]);e!==void 0&&x!=null&&v(e,["parameters","outputOptions","compressionQuality"],x);const N=m(i,["addWatermark"]);e!==void 0&&N!=null&&v(e,["parameters","addWatermark"],N);const I=m(i,["labels"]);e!==void 0&&I!=null&&v(e,["labels"],I);const P=m(i,["imageSize"]);e!==void 0&&P!=null&&v(e,["parameters","sampleImageSize"],P);const k=m(i,["enhancePrompt"]);return e!==void 0&&k!=null&&v(e,["parameters","enhancePrompt"],k),t}function g6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&f6(o,t),t}function m6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["config"]);return o!=null&&p6(o,t),t}function y6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>I6(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],mk(s)),e}function v6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>f_(l))),v(e,["generatedImages"],o)}const s=m(i,["positivePromptSafetyAttributes"]);return s!=null&&v(e,["positivePromptSafetyAttributes"],yk(s)),e}function b6(i,e){const t={},n=m(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n),m(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=m(i,["durationSeconds"]);if(e!==void 0&&s!=null&&v(e,["parameters","durationSeconds"],s),m(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(i,["aspectRatio"]);e!==void 0&&o!=null&&v(e,["parameters","aspectRatio"],o);const l=m(i,["resolution"]);e!==void 0&&l!=null&&v(e,["parameters","resolution"],l);const c=m(i,["personGeneration"]);if(e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c),m(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(i,["negativePrompt"]);e!==void 0&&h!=null&&v(e,["parameters","negativePrompt"],h);const f=m(i,["enhancePrompt"]);if(e!==void 0&&f!=null&&v(e,["parameters","enhancePrompt"],f),m(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const g=m(i,["lastFrame"]);e!==void 0&&g!=null&&v(e,["instances[0]","lastFrame"],p_(g));const y=m(i,["referenceImages"]);if(e!==void 0&&y!=null){let b=y;Array.isArray(b)&&(b=b.map(A=>SG(A))),v(e,["instances[0]","referenceImages"],b)}if(m(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function _6(i,e){const t={},n=m(i,["numberOfVideos"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const o=m(i,["fps"]);e!==void 0&&o!=null&&v(e,["parameters","fps"],o);const l=m(i,["durationSeconds"]);e!==void 0&&l!=null&&v(e,["parameters","durationSeconds"],l);const c=m(i,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const h=m(i,["aspectRatio"]);e!==void 0&&h!=null&&v(e,["parameters","aspectRatio"],h);const f=m(i,["resolution"]);e!==void 0&&f!=null&&v(e,["parameters","resolution"],f);const g=m(i,["personGeneration"]);e!==void 0&&g!=null&&v(e,["parameters","personGeneration"],g);const y=m(i,["pubsubTopic"]);e!==void 0&&y!=null&&v(e,["parameters","pubsubTopic"],y);const b=m(i,["negativePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","negativePrompt"],b);const A=m(i,["enhancePrompt"]);e!==void 0&&A!=null&&v(e,["parameters","enhancePrompt"],A);const w=m(i,["generateAudio"]);e!==void 0&&w!=null&&v(e,["parameters","generateAudio"],w);const x=m(i,["lastFrame"]);e!==void 0&&x!=null&&v(e,["instances[0]","lastFrame"],Ir(x));const N=m(i,["referenceImages"]);if(e!==void 0&&N!=null){let k=N;Array.isArray(k)&&(k=k.map(L=>AG(L))),v(e,["instances[0]","referenceImages"],k)}const I=m(i,["mask"]);e!==void 0&&I!=null&&v(e,["instances[0]","mask"],_G(I));const P=m(i,["compressionQuality"]);return e!==void 0&&P!=null&&v(e,["parameters","compressionQuality"],P),t}function S6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],w6(l)),e}function A6(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],x6(l)),e}function E6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],p_(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],bk(l));const c=m(e,["source"]);c!=null&&C6(c,t);const h=m(e,["config"]);return h!=null&&b6(h,t),t}function T6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["prompt"]);s!=null&&v(t,["instances[0]","prompt"],s);const o=m(e,["image"]);o!=null&&v(t,["instances[0]","image"],Ir(o));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],_k(l));const c=m(e,["source"]);c!=null&&R6(c,t);const h=m(e,["config"]);return h!=null&&_6(h,t),t}function w6(i){const e={},t=m(i,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>M6(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function x6(i){const e={},t=m(i,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>D6(l))),v(e,["generatedVideos"],o)}const n=m(i,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const s=m(i,["raiMediaFilteredReasons"]);return s!=null&&v(e,["raiMediaFilteredReasons"],s),e}function C6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],p_(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],bk(o)),t}function R6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],Ir(s));const o=m(i,["video"]);return e!==void 0&&o!=null&&v(e,["instances[0]","video"],_k(o)),t}function I6(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],H6(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);return s!=null&&v(e,["safetyAttributes"],mk(s)),e}function f_(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["image"],gk(t));const n=m(i,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const s=m(i,["_self"]);s!=null&&v(e,["safetyAttributes"],yk(s));const o=m(i,["prompt"]);return o!=null&&v(e,["enhancedPrompt"],o),e}function N6(i){const e={},t=m(i,["_self"]);t!=null&&v(e,["mask"],gk(t));const n=m(i,["labels"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(e,["labels"],s)}return e}function M6(i){const e={},t=m(i,["video"]);return t!=null&&v(e,["video"],vG(t)),e}function D6(i){const e={},t=m(i,["_self"]);return t!=null&&v(e,["video"],bG(t)),e}function k6(i){const e={},t=m(i,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(i,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const s=m(i,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const o=m(i,["candidateCount"]);o!=null&&v(e,["candidateCount"],o);const l=m(i,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(i,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(i,["logprobs"]);h!=null&&v(e,["logprobs"],h);const f=m(i,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const g=m(i,["mediaResolution"]);g!=null&&v(e,["mediaResolution"],g);const y=m(i,["presencePenalty"]);y!=null&&v(e,["presencePenalty"],y);const b=m(i,["responseLogprobs"]);b!=null&&v(e,["responseLogprobs"],b);const A=m(i,["responseMimeType"]);A!=null&&v(e,["responseMimeType"],A);const w=m(i,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const x=m(i,["responseSchema"]);x!=null&&v(e,["responseSchema"],x);const N=m(i,["routingConfig"]);N!=null&&v(e,["routingConfig"],N);const I=m(i,["seed"]);I!=null&&v(e,["seed"],I);const P=m(i,["speechConfig"]);P!=null&&v(e,["speechConfig"],P);const k=m(i,["stopSequences"]);k!=null&&v(e,["stopSequences"],k);const L=m(i,["temperature"]);L!=null&&v(e,["temperature"],L);const O=m(i,["thinkingConfig"]);O!=null&&v(e,["thinkingConfig"],O);const F=m(i,["topK"]);F!=null&&v(e,["topK"],F);const U=m(i,["topP"]);if(U!=null&&v(e,["topP"],U),m(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function P6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ht(i,n)),t}function L6(i,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],ht(i,n)),t}function O6(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function U6(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function F6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function B6(i){const e={},t=m(i,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(i,["imageSize"]);n!=null&&v(e,["imageSize"],n);const s=m(i,["personGeneration"]);s!=null&&v(e,["personGeneration"],s);const o=m(i,["outputMimeType"]);o!=null&&v(e,["imageOutputOptions","mimeType"],o);const l=m(i,["outputCompressionQuality"]);return l!=null&&v(e,["imageOutputOptions","compressionQuality"],l),e}function H6(i){const e={},t=m(i,["bytesBase64Encoded"]);t!=null&&v(e,["imageBytes"],Ec(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function gk(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],Ec(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function p_(i){const e={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(i,["imageBytes"]);t!=null&&v(e,["bytesBase64Encoded"],Ec(t));const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function Ir(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],Ec(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function G6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],lk(i,c)),n}function z6(i,e,t){const n={},s=m(e,["pageSize"]);t!==void 0&&s!=null&&v(t,["_query","pageSize"],s);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&v(t,["_query","pageToken"],o);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],lk(i,c)),n}function V6(i,e){const t={},n=m(e,["config"]);return n!=null&&G6(i,n,t),t}function q6(i,e){const t={},n=m(e,["config"]);return n!=null&&z6(i,n,t),t}function $6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=ck(s);Array.isArray(o)&&(o=o.map(l=>kE(l))),v(e,["models"],o)}return e}function Y6(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["_self"]);if(s!=null){let o=ck(s);Array.isArray(o)&&(o=o.map(l=>PE(l))),v(e,["models"],o)}return e}function j6(i){const e={},t=m(i,["maskMode"]);t!=null&&v(e,["maskMode"],t);const n=m(i,["segmentationClasses"]);n!=null&&v(e,["maskClasses"],n);const s=m(i,["maskDilation"]);return s!=null&&v(e,["dilation"],s),e}function kE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["version"]);o!=null&&v(e,["version"],o);const l=m(i,["_self"]);l!=null&&v(e,["tunedModelInfo"],cG(l));const c=m(i,["inputTokenLimit"]);c!=null&&v(e,["inputTokenLimit"],c);const h=m(i,["outputTokenLimit"]);h!=null&&v(e,["outputTokenLimit"],h);const f=m(i,["supportedGenerationMethods"]);f!=null&&v(e,["supportedActions"],f);const g=m(i,["temperature"]);g!=null&&v(e,["temperature"],g);const y=m(i,["maxTemperature"]);y!=null&&v(e,["maxTemperature"],y);const b=m(i,["topP"]);b!=null&&v(e,["topP"],b);const A=m(i,["topK"]);A!=null&&v(e,["topK"],A);const w=m(i,["thinking"]);return w!=null&&v(e,["thinking"],w),e}function PE(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["displayName"]);n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);s!=null&&v(e,["description"],s);const o=m(i,["versionId"]);o!=null&&v(e,["version"],o);const l=m(i,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>o6(b))),v(e,["endpoints"],y)}const c=m(i,["labels"]);c!=null&&v(e,["labels"],c);const h=m(i,["_self"]);h!=null&&v(e,["tunedModelInfo"],uG(h));const f=m(i,["defaultCheckpointId"]);f!=null&&v(e,["defaultCheckpointId"],f);const g=m(i,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(b=>b)),v(e,["checkpoints"],y)}return e}function W6(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],a6(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],l6(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],k5(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function X6(i){const e={},t=m(i,["productImage"]);return t!=null&&v(e,["image"],Ir(t)),e}function K6(i,e){const t={},n=m(i,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const s=m(i,["baseSteps"]);e!==void 0&&s!=null&&v(e,["parameters","baseSteps"],s);const o=m(i,["outputGcsUri"]);e!==void 0&&o!=null&&v(e,["parameters","storageUri"],o);const l=m(i,["seed"]);e!==void 0&&l!=null&&v(e,["parameters","seed"],l);const c=m(i,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const h=m(i,["personGeneration"]);e!==void 0&&h!=null&&v(e,["parameters","personGeneration"],h);const f=m(i,["addWatermark"]);e!==void 0&&f!=null&&v(e,["parameters","addWatermark"],f);const g=m(i,["outputMimeType"]);e!==void 0&&g!=null&&v(e,["parameters","outputOptions","mimeType"],g);const y=m(i,["outputCompressionQuality"]);e!==void 0&&y!=null&&v(e,["parameters","outputOptions","compressionQuality"],y);const b=m(i,["enhancePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","enhancePrompt"],b);const A=m(i,["labels"]);return e!==void 0&&A!=null&&v(e,["labels"],A),t}function J6(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["source"]);s!=null&&Z6(s,t);const o=m(e,["config"]);return o!=null&&K6(o,t),t}function Q6(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>f_(s))),v(e,["generatedImages"],n)}return e}function Z6(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["personImage"]);e!==void 0&&s!=null&&v(e,["instances[0]","personImage","image"],Ir(s));const o=m(i,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>X6(c))),v(e,["instances[0]","productImages"],l)}return t}function eG(i){const e={},t=m(i,["referenceImage"]);t!=null&&v(e,["referenceImage"],Ir(t));const n=m(i,["referenceId"]);n!=null&&v(e,["referenceId"],n);const s=m(i,["referenceType"]);s!=null&&v(e,["referenceType"],s);const o=m(i,["maskImageConfig"]);o!=null&&v(e,["maskImageConfig"],j6(o));const l=m(i,["controlImageConfig"]);l!=null&&v(e,["controlImageConfig"],H5(l));const c=m(i,["styleImageConfig"]);c!=null&&v(e,["styleImageConfig"],c);const h=m(i,["subjectImageConfig"]);return h!=null&&v(e,["subjectImageConfig"],h),e}function mk(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function yk(i){const e={},t=m(i,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(i,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const s=m(i,["contentType"]);return s!=null&&v(e,["contentType"],s),e}function tG(i){const e={},t=m(i,["category"]);if(t!=null&&v(e,["category"],t),m(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(i,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function nG(i){const e={},t=m(i,["image"]);return t!=null&&v(e,["image"],Ir(t)),e}function iG(i,e){const t={},n=m(i,["mode"]);e!==void 0&&n!=null&&v(e,["parameters","mode"],n);const s=m(i,["maxPredictions"]);e!==void 0&&s!=null&&v(e,["parameters","maxPredictions"],s);const o=m(i,["confidenceThreshold"]);e!==void 0&&o!=null&&v(e,["parameters","confidenceThreshold"],o);const l=m(i,["maskDilation"]);e!==void 0&&l!=null&&v(e,["parameters","maskDilation"],l);const c=m(i,["binaryColorThreshold"]);e!==void 0&&c!=null&&v(e,["parameters","binaryColorThreshold"],c);const h=m(i,["labels"]);return e!==void 0&&h!=null&&v(e,["labels"],h),t}function sG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["source"]);s!=null&&oG(s,t);const o=m(e,["config"]);return o!=null&&iG(o,t),t}function rG(i){const e={},t=m(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(s=>N6(s))),v(e,["generatedMasks"],n)}return e}function oG(i,e){const t={},n=m(i,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const s=m(i,["image"]);e!==void 0&&s!=null&&v(e,["instances[0]","image"],Ir(s));const o=m(i,["scribbleImage"]);return e!==void 0&&o!=null&&v(e,["instances[0]","scribble"],nG(o)),t}function aG(i){const e={},t=m(i,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(i,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],c6(n)),e}function lG(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],O6(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],U6(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}function vk(i){const e={},t=m(i,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(i,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=m(i,["codeExecution"]);s!=null&&v(e,["codeExecution"],s);const o=m(i,["enterpriseWebSearch"]);o!=null&&v(e,["enterpriseWebSearch"],o);const l=m(i,["functionDeclarations"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(b=>u6(b))),v(e,["functionDeclarations"],y)}const c=m(i,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(i,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const f=m(i,["googleSearchRetrieval"]);f!=null&&v(e,["googleSearchRetrieval"],f);const g=m(i,["urlContext"]);return g!=null&&v(e,["urlContext"],g),e}function cG(i){const e={},t=m(i,["baseModel"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function uG(i){const e={},t=m(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&v(e,["baseModel"],t);const n=m(i,["createTime"]);n!=null&&v(e,["createTime"],n);const s=m(i,["updateTime"]);return s!=null&&v(e,["updateTime"],s),e}function dG(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function hG(i,e){const t={},n=m(i,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const s=m(i,["description"]);e!==void 0&&s!=null&&v(e,["description"],s);const o=m(i,["defaultCheckpointId"]);return e!==void 0&&o!=null&&v(e,["defaultCheckpointId"],o),t}function fG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","name"],ht(i,n));const s=m(e,["config"]);return s!=null&&dG(s,t),t}function pG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["config"]);return s!=null&&hG(s,t),t}function gG(i,e){const t={},n=m(i,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const s=m(i,["safetyFilterLevel"]);e!==void 0&&s!=null&&v(e,["parameters","safetySetting"],s);const o=m(i,["personGeneration"]);e!==void 0&&o!=null&&v(e,["parameters","personGeneration"],o);const l=m(i,["includeRaiReason"]);e!==void 0&&l!=null&&v(e,["parameters","includeRaiReason"],l);const c=m(i,["outputMimeType"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","mimeType"],c);const h=m(i,["outputCompressionQuality"]);e!==void 0&&h!=null&&v(e,["parameters","outputOptions","compressionQuality"],h);const f=m(i,["enhanceInputImage"]);e!==void 0&&f!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=m(i,["imagePreservationFactor"]);e!==void 0&&g!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["numberOfImages"]);e!==void 0&&b!=null&&v(e,["parameters","sampleCount"],b);const A=m(i,["mode"]);return e!==void 0&&A!=null&&v(e,["parameters","mode"],A),t}function mG(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],ht(i,n));const s=m(e,["image"]);s!=null&&v(t,["instances[0]","image"],Ir(s));const o=m(e,["upscaleFactor"]);o!=null&&v(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=m(e,["config"]);return l!=null&&gG(l,t),t}function yG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>f_(o))),v(e,["generatedImages"],s)}return e}function vG(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["encodedVideo"]);n!=null&&v(e,["videoBytes"],Ec(n));const s=m(i,["encoding"]);return s!=null&&v(e,["mimeType"],s),e}function bG(i){const e={},t=m(i,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(i,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],Ec(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function _G(i){const e={},t=m(i,["image"]);t!=null&&v(e,["_self"],Ir(t));const n=m(i,["maskMode"]);return n!=null&&v(e,["maskMode"],n),e}function SG(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],p_(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function AG(i){const e={},t=m(i,["image"]);t!=null&&v(e,["image"],Ir(t));const n=m(i,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function bk(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["uri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["encodedVideo"],Ec(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["encoding"],s),e}function _k(i){const e={},t=m(i,["uri"]);t!=null&&v(e,["gcsUri"],t);const n=m(i,["videoBytes"]);n!=null&&v(e,["bytesBase64Encoded"],Ec(n));const s=m(i,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EG(i,e){const t={},n=m(i,["displayName"]);return e!==void 0&&n!=null&&v(e,["displayName"],n),t}function TG(i){const e={},t=m(i,["config"]);return t!=null&&EG(t,e),e}function wG(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function xG(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&wG(n,e),e}function CG(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function RG(i,e){const t={},n=m(i,["customMetadata"]);if(e!==void 0&&n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["customMetadata"],o)}const s=m(i,["chunkingConfig"]);return e!==void 0&&s!=null&&v(e,["chunkingConfig"],s),t}function IG(i){const e={},t=m(i,["name"]);t!=null&&v(e,["name"],t);const n=m(i,["metadata"]);n!=null&&v(e,["metadata"],n);const s=m(i,["done"]);s!=null&&v(e,["done"],s);const o=m(i,["error"]);o!=null&&v(e,["error"],o);const l=m(i,["response"]);return l!=null&&v(e,["response"],MG(l)),e}function NG(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["fileName"]);n!=null&&v(e,["fileName"],n);const s=m(i,["config"]);return s!=null&&RG(s,e),e}function MG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["parent"]);n!=null&&v(e,["parent"],n);const s=m(i,["documentName"]);return s!=null&&v(e,["documentName"],s),e}function DG(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function kG(i){const e={},t=m(i,["config"]);return t!=null&&DG(t,e),e}function PG(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["fileSearchStores"],o)}return e}function Sk(i,e){const t={},n=m(i,["mimeType"]);e!==void 0&&n!=null&&v(e,["mimeType"],n);const s=m(i,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const o=m(i,["customMetadata"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(h=>h)),v(e,["customMetadata"],c)}const l=m(i,["chunkingConfig"]);return e!==void 0&&l!=null&&v(e,["chunkingConfig"],l),t}function LG(i){const e={},t=m(i,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(i,["config"]);return n!=null&&Sk(n,e),e}function OG(i){const e={},t=m(i,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UG="Content-Type",FG="X-Server-Timeout",BG="User-Agent",LE="x-goog-api-client",HG="1.38.0",GG=`google-genai-sdk/${HG}`,zG="v1beta1",VG="v1beta";class qG{constructor(e){var t,n,s;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:zG}else{if(!this.clientOptions.apiKey)throw new Xg({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:VG,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===IE.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))s.searchParams.append(l,String(c));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))typeof o=="object"?n[s]=Object.assign(Object.assign({},n[s]),o):o!==void 0&&(n[s]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>o.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&$G(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await uM(s),new NE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async s=>(await uM(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Tr(this,arguments,function*(){var n;const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const c="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:g}=yield Pe(s.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const y=o.decode(g,{stream:!0});try{const w=JSON.parse(y);if("error"in w){const x=JSON.parse(JSON.stringify(w.error)),N=x.status,I=x.code,P=`got status: ${N}. ${JSON.stringify(w)}`;if(I>=400&&I<600)throw new Xg({message:P,status:I})}}catch(w){if(w.name==="ApiError")throw w}l+=y;let b=-1,A=0;for(;;){b=-1,A=0;for(const N of h){const I=l.indexOf(N);I!==-1&&(b===-1||I<b)&&(b=I,A=N.length)}if(b===-1)break;const w=l.substring(0,b);l=l.substring(b+A);const x=w.trim();if(x.startsWith(c)){const N=x.substring(c.length).trim();try{const I=new Response(N,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Pe(new NE(I))}catch(I){throw new Error(`exception parsing stream chunk ${N}. ${I}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=GG+" "+this.clientOptions.userAgentExtra;return e[BG]=t,e[LE]=t,e[UG]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))n.append(s,o);e.timeout&&e.timeout>0&&n.append(FG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);s.sizeBytes=String(l.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const h={file:s},f=this.getFileName(e),g=pe("upload/v1beta/files",h._url),y=await this.fetchUploadUrl(g,s.sizeBytes,s.mimeType,f,h,t==null?void 0:t.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,n){var s;const o=this.clientOptions.uploader,l=await o.stat(t),c=String(l.size),h=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(t),y={};n!=null&&Sk(n,y);const b=await this.fetchUploadUrl(f,c,h,g,y,n==null?void 0:n.httpOptions);return o.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,s,o,l){var c;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},s?{"X-Goog-Upload-File-Name":s}:{})};const f=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:h});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const g=(c=f==null?void 0:f.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function uM(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const s=JSON.stringify(n);throw t>=400&&t<600?new Xg({message:s,status:t}):new Error(s)}}function $G(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const o=JSON.parse(i.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(o,l){const c=Object.assign({},o);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const f=l[h],g=c[h];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[h]=n(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[h]=f)}return c}const s=n(t,e);i.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YG="mcp_used/unknown";let jG=!1;function Ak(i){for(const e of i)if(WG(e)||typeof e=="object"&&"inputSchema"in e)return!0;return jG}function Ek(i){var e;const t=(e=i[LE])!==null&&e!==void 0?e:"";i[LE]=(t+` ${YG}`).trimStart()}function WG(i){return i!==null&&typeof i=="object"&&i instanceof Yw}function XG(i){return Tr(this,arguments,function*(t,n=100){let s,o=0;for(;o<n;){const l=yield Pe(t.listTools({cursor:s}));for(const c of l.tools)yield yield Pe(c),o++;if(!l.nextCursor)break;s=l.nextCursor}})}class Yw{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Yw(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const o={},l=[];for(const g of this.mcpClients)try{for(var c=!0,h=(t=void 0,wr(XG(g))),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const y=s;l.push(y);const b=y.name;if(o[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);o[b]=g}}catch(y){t={error:y}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),x4(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await s.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function KG(i,e,t){const n=new v4;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(n,s),e(n)}class JG{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=ez(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(k=>{f=k}),y=e.callbacks,b=function(){f({})},A=this.apiClient,w={onopen:b,onmessage:k=>{KG(A,y.onmessage,k)},onerror:(t=y==null?void 0:y.onerror)!==null&&t!==void 0?t:function(k){},onclose:(n=y==null?void 0:y.onclose)!==null&&n!==void 0?n:function(k){}},x=this.webSocketFactory.create(h,ZG(l),w);x.connect(),await g;const P={setup:{model:ht(this.apiClient,e.model)}};return x.send(JSON.stringify(P)),new QG(x,this.apiClient)}}class QG{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=E5(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=A5(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Eh.PLAY)}pause(){this.sendPlaybackControl(Eh.PAUSE)}stop(){this.sendPlaybackControl(Eh.STOP)}resetContext(){this.sendPlaybackControl(Eh.RESET_CONTEXT)}close(){this.conn.close()}}function ZG(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function ez(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tz="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function nz(i,e,t){const n=new y4;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const o=JSON.parse(s);if(i.isVertexAI()){const l=x5(o);Object.assign(n,l)}else Object.assign(n,o);e(n)}class iz{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new JG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,o,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const y=this.apiClient.getHeaders();e.config&&e.config.tools&&Ak(e.config.tools)&&Ek(y);const b=az(y);if(this.apiClient.isVertexAI()){const q=this.apiClient.getProject(),Z=this.apiClient.getLocation(),ee=this.apiClient.getApiKey(),se=!!q&&!!Z||!!ee;this.apiClient.getCustomBaseUrl()&&!se?g=h:(g=`${h}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,g))}else{const q=this.apiClient.getApiKey();let Z="BidiGenerateContent",ee="key";q!=null&&q.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Z="BidiGenerateContentConstrained",ee="access_token"),g=`${h}/ws/google.ai.generativelanguage.${f}.GenerativeService.${Z}?${ee}=${q}`}let A=()=>{};const w=new Promise(q=>{A=q}),x=e.callbacks,N=function(){var q;(q=x==null?void 0:x.onopen)===null||q===void 0||q.call(x),A({})},I=this.apiClient,P={onopen:N,onmessage:q=>{nz(I,x.onmessage,q)},onerror:(t=x==null?void 0:x.onerror)!==null&&t!==void 0?t:function(q){},onclose:(n=x==null?void 0:x.onclose)!==null&&n!==void 0?n:function(q){}},k=this.webSocketFactory.create(g,oz(b),P);k.connect(),await w;let L=ht(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const q=this.apiClient.getProject(),Z=this.apiClient.getLocation();q&&Z&&(L=`projects/${q}/locations/${Z}/`+L)}let O={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[vb.AUDIO]}:e.config.responseModalities=[vb.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],U=[];for(const q of F)if(this.isCallableTool(q)){const Z=q;U.push(await Z.tool())}else U.push(q);U.length>0&&(e.config.tools=U);const X={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?O=S5(this.apiClient,X):O=_5(this.apiClient,X),delete O.config,k.send(JSON.stringify(O)),new rz(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const sz={turnComplete:!0};class rz{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=er(t.turns),e.isVertexAI()||(n=n.map(s=>h_(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const o of n){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(tz)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},sz),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:w5(e)}:t={realtimeInput:T5(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function oz(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function az(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dM=10;function hM(i){var e,t,n;if(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=i==null?void 0:i.tools)!==null&&t!==void 0?t:[])if(Dh(l)){s=!0;break}if(!s)return!0;const o=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Dh(i){return"callTool"in i&&typeof i.callTool=="function"}function lz(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>Dh(s)))!==null&&n!==void 0?n:!1}function fM(i){var e;const t=[];return!((e=i==null?void 0:i.config)===null||e===void 0)&&e.tools&&i.config.tools.forEach((n,s)=>{if(Dh(n))return;const o=n;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(s)}),t}function pM(i){var e;return!(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cz extends Ha{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,s,o,l,c;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!lz(t)||hM(t.config))return await this.generateContentInternal(h);const f=fM(t);if(f.length>0){const x=f.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${x}.`)}let g,y;const b=er(h.contents),A=(o=(s=(n=h.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:dM;let w=0;for(;w<A&&(g=await this.generateContentInternal(h),!(!g.functionCalls||g.functionCalls.length===0));){const x=g.candidates[0].content,N=[];for(const I of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Dh(I)){const k=await I.callTool(g.functionCalls);N.push(...k)}w++,y={role:"user",parts:N},h.contents=er(h.contents),h.contents.push(x),h.contents.push(y),pM(h.config)&&(b.push(x),b.push(y))}return pM(h.config)&&(g.automaticFunctionCallingHistory=b),g},this.generateContentStream=async t=>{var n,s,o,l,c;if(this.maybeMoveToResponseJsonSchem(t),hM(t.config)){const y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}const h=fM(t);if(h.length>0){const y=h.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(s=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,g=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(f&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var s;let o;const l=[];if(n!=null&&n.generatedImages)for(const h of n.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((s=h==null?void 0:h.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=h==null?void 0:h.safetyAttributes:l.push(h);let c;return o?c={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new bd(Da.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var n,s,o,l,c,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((h=(c=t.source)===null||c===void 0?void 0:c.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async h=>Dh(h)?await h.tool():h)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&Ak(e.config.tools)){const h=(s=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&s!==void 0?s:{};let f=Object.assign({},h);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),Ek(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var t,n,s;const o=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Dh(l)){const c=l,h=await c.tool();for(const f of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,c)}}return o}async processAfcStream(e){var t,n,s;const o=(s=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&s!==void 0?s:dM;let l=!1,c=0;const h=await this.initAfcToolsMap(e);return(function(f,g,y){return Tr(this,arguments,function*(){for(var b,A,w,x,N,I;c<o;){l&&(c++,l=!1);const O=yield Pe(f.processParamsMaybeAddMcpUsage(y)),F=yield Pe(f.generateContentStreamInternal(O)),U=[],X=[];try{for(var P=!0,k=(A=void 0,wr(F)),L;L=yield Pe(k.next()),b=L.done,!b;P=!0){x=L.value,P=!1;const q=x;if(yield yield Pe(q),q.candidates&&(!((N=q.candidates[0])===null||N===void 0)&&N.content)){X.push(q.candidates[0].content);for(const Z of(I=q.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(c<o&&Z.functionCall){if(!Z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Z.functionCall.name)){const ee=yield Pe(g.get(Z.functionCall.name).callTool([Z.functionCall]));U.push(...ee)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Z.functionCall.name}`)}}}}catch(q){A={error:q}}finally{try{!P&&!b&&(w=k.return)&&(yield Pe(w.call(k)))}finally{if(A)throw A.error}}if(U.length>0){l=!0;const q=new gg;q.candidates=[{content:{role:"user",parts:U}}],yield yield Pe(q);const Z=[];Z.push(...X),Z.push({role:"user",parts:U});const ee=er(y.contents).concat(Z);y.contents=ee}else break}})})(this,h,e)}async generateContentInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=aM(this.apiClient,e);return c=pe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=cM(g),b=new gg;return Object.assign(b,y),b})}else{const f=oM(this.apiClient,e);return c=pe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=lM(g),b=new gg;return Object.assign(b,y),b})}}async generateContentStreamInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=aM(this.apiClient,e);return c=pe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(y){return Tr(this,arguments,function*(){var b,A,w,x;try{for(var N=!0,I=wr(y),P;P=yield Pe(I.next()),b=P.done,!b;N=!0){x=P.value,N=!1;const k=x,L=cM(yield Pe(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new gg;Object.assign(O,L),yield yield Pe(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Pe(w.call(I)))}finally{if(A)throw A.error}}})})}else{const f=oM(this.apiClient,e);return c=pe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(y){return Tr(this,arguments,function*(){var b,A,w,x;try{for(var N=!0,I=wr(y),P;P=yield Pe(I.next()),b=P.done,!b;N=!0){x=P.value,N=!1;const k=x,L=lM(yield Pe(k.json()));L.sdkHttpResponse={headers:k.headers};const O=new gg;Object.assign(O,L),yield yield Pe(O)}}catch(k){A={error:k}}finally{try{!N&&!b&&(w=I.return)&&(yield Pe(w.call(I)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=i6(this.apiClient,e);return c=pe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=r6(g),b=new VN;return Object.assign(b,y),b})}else{const f=n6(this.apiClient,e);return c=pe("{model}:batchEmbedContents",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=s6(g),b=new VN;return Object.assign(b,y),b})}}async generateImagesInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=m6(this.apiClient,e);return c=pe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=v6(g),b=new qN;return Object.assign(b,y),b})}else{const f=g6(this.apiClient,e);return c=pe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=y6(g),b=new qN;return Object.assign(b,y),b})}}async editImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=Q5(this.apiClient,e);return o=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=Z5(h),g=new o4;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=mG(this.apiClient,e);return o=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=yG(h),g=new a4;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=J6(this.apiClient,e);return o=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=Q6(h),g=new l4;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=sG(this.apiClient,e);return o=pe("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=rG(h),g=new c4;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=L6(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>PE(g))}else{const f=P6(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>kE(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=q6(this.apiClient,e);return c=pe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Y6(g),b=new $N;return Object.assign(b,y),b})}else{const f=V6(this.apiClient,e);return c=pe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=$6(g),b=new $N;return Object.assign(b,y),b})}}async update(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=pG(this.apiClient,e);return c=pe("{model}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>PE(g))}else{const f=fG(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>kE(g))}}async delete(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=W5(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=K5(g),b=new YN;return Object.assign(b,y),b})}else{const f=j5(this.apiClient,e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=X5(g),b=new YN;return Object.assign(b,y),b})}}async countTokens(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=q5(this.apiClient,e);return c=pe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=Y5(g),b=new jN;return Object.assign(b,y),b})}else{const f=V5(this.apiClient,e);return c=pe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=$5(g),b=new jN;return Object.assign(b,y),b})}}async computeTokens(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=O5(this.apiClient,e);return o=pe("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const f=U5(h),g=new u4;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=T6(this.apiClient,e);return c=pe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l.then(g=>{const y=A6(g),b=new bb;return Object.assign(b,y),b})}else{const f=E6(this.apiClient,e);return c=pe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l.then(g=>{const y=S6(g),b=new bb;return Object.assign(b,y),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uz extends Ha{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=e4(e);return c=pe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json()),l}else{const f=Z3(e);return c=pe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=Y3(e);return o=pe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dz(i){const e={},t=m(i,["data"]);if(t!=null&&v(e,["data"],t),m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function hz(i){const e={},t=m(i,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>Sz(o))),v(e,["parts"],s)}const n=m(i,["role"]);return n!=null&&v(e,["role"],n),e}function fz(i,e,t){const n={},s=m(e,["expireTime"]);t!==void 0&&s!=null&&v(t,["expireTime"],s);const o=m(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&v(t,["newSessionExpireTime"],o);const l=m(e,["uses"]);t!==void 0&&l!=null&&v(t,["uses"],l);const c=m(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&v(t,["bidiGenerateContentSetup"],_z(i,c));const h=m(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&v(t,["fieldMask"],h),n}function pz(i,e){const t={},n=m(e,["config"]);return n!=null&&v(t,["config"],fz(i,n,t)),t}function gz(i){const e={};if(m(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(i,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(i,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function mz(i){const e={},t=m(i,["id"]);t!=null&&v(e,["id"],t);const n=m(i,["args"]);n!=null&&v(e,["args"],n);const s=m(i,["name"]);if(s!=null&&v(e,["name"],s),m(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function yz(i){const e={};if(m(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(i,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function vz(i){const e={};if(m(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(i,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function bz(i,e){const t={},n=m(i,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const s=m(i,["responseModalities"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","responseModalities"],s);const o=m(i,["temperature"]);e!==void 0&&o!=null&&v(e,["setup","generationConfig","temperature"],o);const l=m(i,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(i,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(i,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(i,["mediaResolution"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","mediaResolution"],f);const g=m(i,["seed"]);e!==void 0&&g!=null&&v(e,["setup","generationConfig","seed"],g);const y=m(i,["speechConfig"]);e!==void 0&&y!=null&&v(e,["setup","generationConfig","speechConfig"],$w(y));const b=m(i,["thinkingConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","thinkingConfig"],b);const A=m(i,["enableAffectiveDialog"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],A);const w=m(i,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],hz(di(w)));const x=m(i,["tools"]);if(e!==void 0&&x!=null){let F=vp(x);Array.isArray(F)&&(F=F.map(U=>Ez(yp(U)))),v(e,["setup","tools"],F)}const N=m(i,["sessionResumption"]);e!==void 0&&N!=null&&v(e,["setup","sessionResumption"],Az(N));const I=m(i,["inputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","inputAudioTranscription"],I);const P=m(i,["outputAudioTranscription"]);e!==void 0&&P!=null&&v(e,["setup","outputAudioTranscription"],P);const k=m(i,["realtimeInputConfig"]);e!==void 0&&k!=null&&v(e,["setup","realtimeInputConfig"],k);const L=m(i,["contextWindowCompression"]);e!==void 0&&L!=null&&v(e,["setup","contextWindowCompression"],L);const O=m(i,["proactivity"]);if(e!==void 0&&O!=null&&v(e,["setup","proactivity"],O),m(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function _z(i,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],ht(i,n));const s=m(e,["config"]);return s!=null&&v(t,["config"],bz(s,t)),t}function Sz(i){const e={},t=m(i,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(i,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const s=m(i,["executableCode"]);s!=null&&v(e,["executableCode"],s);const o=m(i,["fileData"]);o!=null&&v(e,["fileData"],gz(o));const l=m(i,["functionCall"]);l!=null&&v(e,["functionCall"],mz(l));const c=m(i,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(i,["inlineData"]);h!=null&&v(e,["inlineData"],dz(h));const f=m(i,["text"]);f!=null&&v(e,["text"],f);const g=m(i,["thought"]);g!=null&&v(e,["thought"],g);const y=m(i,["thoughtSignature"]);y!=null&&v(e,["thoughtSignature"],y);const b=m(i,["videoMetadata"]);return b!=null&&v(e,["videoMetadata"],b),e}function Az(i){const e={},t=m(i,["handle"]);if(t!=null&&v(e,["handle"],t),m(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ez(i){const e={};if(m(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(i,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(i,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const s=m(i,["codeExecution"]);if(s!=null&&v(e,["codeExecution"],s),m(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(i,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),v(e,["functionDeclarations"],g)}const l=m(i,["googleMaps"]);l!=null&&v(e,["googleMaps"],yz(l));const c=m(i,["googleSearch"]);c!=null&&v(e,["googleSearch"],vz(c));const h=m(i,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const f=m(i,["urlContext"]);return f!=null&&v(e,["urlContext"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tz(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const s=Object.keys(n).map(o=>`${t}.${o}`);e.push(...s)}else e.push(t)}return e.join(",")}function wz(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const o=n.setup;typeof o=="object"&&o!==null?(i.bidiGenerateContentSetup=o,t=o):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const s=i.fieldMask;if(t){const o=Tz(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?i.fieldMask=o:delete i.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(f=>l.includes(f)?`generationConfig.${f}`:f));const h=[];o&&h.push(o),c.length>0&&h.push(...c),h.length>0?i.fieldMask=h.join(","):delete i.fieldMask}else delete i.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?i.fieldMask=s.join(","):delete i.fieldMask;return i}class xz extends Ha{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=pz(this.apiClient,e);o=pe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=wz(c,e.config);return s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),s.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Cz(i,e){const t={},n=m(i,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function Rz(i){const e={},t=m(i,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(i,["config"]);return n!=null&&Cz(n,e),e}function Iz(i){const e={},t=m(i,["name"]);return t!=null&&v(e,["_url","name"],t),e}function Nz(i,e){const t={},n=m(i,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const s=m(i,["pageToken"]);return e!==void 0&&s!=null&&v(e,["_query","pageToken"],s),t}function Mz(i){const e={},t=m(i,["parent"]);t!=null&&v(e,["_url","parent"],t);const n=m(i,["config"]);return n!=null&&Nz(n,e),e}function Dz(i){const e={},t=m(i,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(i,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const s=m(i,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),v(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kz extends Ha{constructor(e){super(),this.apiClient=e,this.list=async t=>new bd(Da.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Iz(e);return o=pe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Rz(e);s=pe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Mz(e);return o=pe("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=Dz(h),g=new d4;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pz extends Ha{constructor(e,t=new kz(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new bd(Da.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=TG(e);return o=pe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=CG(e);return o=pe("{name}",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=xG(e);s=pe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=kG(e);return o=pe("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=PG(h),g=new h4;return Object.assign(g,f),g})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=LG(e);return o=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=OG(h),g=new f4;return Object.assign(g,f),g})}}async importFile(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=NG(e);return o=pe("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),s.then(h=>{const f=IG(h),g=new Hw;return Object.assign(g,f),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Tk=function(){const{crypto:i}=globalThis;if(i!=null&&i.randomUUID)return Tk=i.randomUUID.bind(i),i.randomUUID();const e=new Uint8Array(1),t=i?()=>i.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const Lz=()=>Tk();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OE(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const UE=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const e=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(e.stack=i.stack),i.cause&&!e.cause&&(e.cause=i.cause),i.name&&(e.name=i.name),e}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nr extends Error{}class Ci extends nr{constructor(e,t,n,s){super(`${Ci.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new g_({message:n,cause:UE(t)});const o=t;return e===400?new xk(e,o,n,s):e===401?new Ck(e,o,n,s):e===403?new Rk(e,o,n,s):e===404?new Ik(e,o,n,s):e===409?new Nk(e,o,n,s):e===422?new Mk(e,o,n,s):e===429?new Dk(e,o,n,s):e>=500?new kk(e,o,n,s):new Ci(e,o,n,s)}}class FE extends Ci{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class g_ extends Ci{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class wk extends g_{constructor({message:e}={}){super({message:e??"Request timed out."})}}class xk extends Ci{}class Ck extends Ci{}class Rk extends Ci{}class Ik extends Ci{}class Nk extends Ci{}class Mk extends Ci{}class Dk extends Ci{}class kk extends Ci{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Oz=/^[a-z][a-z0-9+.-]*:/i,Uz=i=>Oz.test(i);let BE=i=>(BE=Array.isArray,BE(i));const Fz=BE;let Bz=Fz;const gM=Bz;function Hz(i){if(!i)return!0;for(const e in i)return!1;return!0}function Gz(i,e){return Object.prototype.hasOwnProperty.call(i,e)}const zz=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new nr(`${i} must be an integer`);if(e<0)throw new nr(`${i} must be a positive integer`);return e},Vz=i=>{try{return JSON.parse(i)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qz=i=>new Promise(e=>setTimeout(e,i));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ph="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $z(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Yz=()=>{var i,e,t,n,s;const o=$z();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ph,"X-Stainless-OS":yM(Deno.build.os),"X-Stainless-Arch":mM(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(i=Deno.version)===null||i===void 0?void 0:i.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ph,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ph,"X-Stainless-OS":yM((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":mM((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=jz();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ph,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ph,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function jz(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,o=n[2]||0,l=n[3]||0;return{browser:e,version:`${s}.${o}.${l}`}}}return null}const mM=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",yM=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let mv;const Wz=()=>mv??(mv=Yz());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xz(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Pk(...i){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...i)}function Kz(i){let e=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return Pk({start(){},async pull(t){const{done:n,value:s}=await e.next();n?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Lk(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Jz(i){var e,t;if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await((t=(e=i[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=i.getReader(),s=n.cancel();n.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qz=({headers:i,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ok=()=>{var i;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((i=e==null?void 0:e.versions)===null||i===void 0?void 0:i.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tE(i,e,t){return Ok(),new File(i,e??"unknown_file",t)}function Zz(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const eV=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uk=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",tV=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&Uk(i),nV=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function iV(i,e,t){if(Ok(),i=await i,tV(i))return i instanceof File?i:tE([await i.arrayBuffer()],i.name);if(nV(i)){const s=await i.blob();return e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()),tE(await HE(s),e,t)}const n=await HE(i);if(e||(e=Zz(i)),!(t!=null&&t.type)){const s=n.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return tE(n,e,t)}async function HE(i){var e,t,n,s,o;let l=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)l.push(i);else if(Uk(i))l.push(i instanceof Blob?i:await i.arrayBuffer());else if(eV(i))try{for(var c=!0,h=wr(i),f;f=await h.next(),e=f.done,!e;c=!0){s=f.value,c=!1;const g=s;l.push(...await HE(g))}}catch(g){t={error:g}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}else{const g=(o=i==null?void 0:i.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof i}${g?`; constructor: ${g}`:""}${sV(i)}`)}return l}function sV(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fk{constructor(e){this._client=e}}Fk._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bk(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const vM=Object.freeze(Object.create(null)),rV=(i=Bk)=>(function(t,...n){if(t.length===1)return t[0];let s=!1;const o=[],l=t.reduce((g,y,b)=>{var A,w,x;/[?#]/.test(y)&&(s=!0);const N=n[b];let I=(s?encodeURIComponent:i)(""+N);return b!==n.length&&(N==null||typeof N=="object"&&N.toString===((x=Object.getPrototypeOf((w=Object.getPrototypeOf((A=N.hasOwnProperty)!==null&&A!==void 0?A:vM))!==null&&w!==void 0?w:vM))===null||x===void 0?void 0:x.toString))&&(I=N+"",o.push({start:g.length+y.length,length:I.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),g+y+(b===n.length?"":I)},""),c=l.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=h.exec(c))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((g,y)=>g.start-y.start),o.length>0){let g=0;const y=o.reduce((b,A)=>{const w=" ".repeat(A.start-g),x="^".repeat(A.length);return g=A.start+A.length,b+w+x},"");throw new nr(`Path parameters result in path with invalid segments:
${o.map(b=>b.error).join(`
`)}
${l}
${y}`)}return l}),yv=rV(Bk);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hk extends Fk{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,o=Sb(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new nr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new nr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(yv`/${s}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(yv`/${s}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(yv`/${s}/interactions/${e}/cancel`,n)}get(e,t={},n){var s;const o=t??{},{api_version:l=this._client.apiVersion}=o,c=Sb(o,["api_version"]);return this._client.get(yv`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}Hk._key=Object.freeze(["interactions"]);class Gk extends Hk{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oV(i){let e=0;for(const s of i)e+=s.length;const t=new Uint8Array(e);let n=0;for(const s of i)t.set(s,n),n+=s.length;return t}let vv;function jw(i){let e;return(vv??(e=new globalThis.TextEncoder,vv=e.encode.bind(e)))(i)}let bv;function bM(i){let e;return(bv??(e=new globalThis.TextDecoder,bv=e.decode.bind(e)))(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class m_{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?jw(e):e;this.buffer=oV([this.buffer,t]);const n=[];let s;for(;(s=aV(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(bM(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=bM(this.buffer.subarray(0,o));n.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}m_.NEWLINE_CHARS=new Set([`
`,"\r"]);m_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function aV(i,e){for(let s=e??0;s<i.length;s++){if(i[s]===10)return{preceding:s,index:s+1,carriage:!1};if(i[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function lV(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ab={off:0,error:200,warn:300,info:400,debug:500},_M=(i,e,t)=>{if(i){if(Gz(Ab,i))return i;Ai(t).warn(`${e} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(Ab))}`)}};function Sg(){}function _v(i,e,t){return!e||Ab[i]>Ab[t]?Sg:e[i].bind(e)}const cV={error:Sg,warn:Sg,info:Sg,debug:Sg};let SM=new WeakMap;function Ai(i){var e;const t=i.logger,n=(e=i.logLevel)!==null&&e!==void 0?e:"off";if(!t)return cV;const s=SM.get(t);if(s&&s[0]===n)return s[1];const o={error:_v("error",t,n),warn:_v("warn",t,n),info:_v("info",t,n),debug:_v("debug",t,n)};return SM.set(t,[n,o]),o}const $c=i=>(i.options&&(i.options=Object.assign({},i.options),delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Th{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const o=n?Ai(n):console;function l(){return Tr(this,arguments,function*(){var h,f,g,y;if(s)throw new nr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=wr(uV(e,t)),x;x=yield Pe(w.next()),h=x.done,!h;A=!0){y=x.value,A=!1;const N=y;if(!b)if(N.data.startsWith("[DONE]")){b=!0;continue}else try{yield yield Pe(JSON.parse(N.data))}catch(I){throw o.error("Could not parse message into JSON:",N.data),o.error("From chunk:",N.raw),I}}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Pe(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(OE(N))return yield Pe(void 0);throw N}finally{b||t.abort()}})}return new Th(l,t,n)}static fromReadableStream(e,t,n){let s=!1;function o(){return Tr(this,arguments,function*(){var h,f,g,y;const b=new m_,A=Lk(e);try{for(var w=!0,x=wr(A),N;N=yield Pe(x.next()),h=N.done,!h;w=!0){y=N.value,w=!1;const I=y;for(const P of b.decode(I))yield yield Pe(P)}}catch(I){f={error:I}}finally{try{!w&&!h&&(g=x.return)&&(yield Pe(g.call(x)))}finally{if(f)throw f.error}}for(const I of b.flush())yield yield Pe(I)})}function l(){return Tr(this,arguments,function*(){var h,f,g,y;if(s)throw new nr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let b=!1;try{try{for(var A=!0,w=wr(o()),x;x=yield Pe(w.next()),h=x.done,!h;A=!0){y=x.value,A=!1;const N=y;b||N&&(yield yield Pe(JSON.parse(N)))}}catch(N){f={error:N}}finally{try{!A&&!h&&(g=w.return)&&(yield Pe(g.call(w)))}finally{if(f)throw f.error}}b=!0}catch(N){if(OE(N))return yield Pe(void 0);throw N}finally{b||t.abort()}})}return new Th(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=o=>({next:()=>{if(o.length===0){const l=n.next();e.push(l),t.push(l)}return o.shift()}});return[new Th(()=>s(e),this.controller,this.client),new Th(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Pk({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:o}=await t.next();if(o)return n.close();const l=jw(JSON.stringify(s)+`
`);n.enqueue(l)}catch(s){n.error(s)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function uV(i,e){return Tr(this,arguments,function*(){var n,s,o,l;if(!i.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new nr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new nr("Attempted to iterate over a response with no body");const c=new hV,h=new m_,f=Lk(i.body);try{for(var g=!0,y=wr(dV(f)),b;b=yield Pe(y.next()),n=b.done,!n;g=!0){l=b.value,g=!1;const A=l;for(const w of h.decode(A)){const x=c.decode(w);x&&(yield yield Pe(x))}}}catch(A){s={error:A}}finally{try{!g&&!n&&(o=y.return)&&(yield Pe(o.call(y)))}finally{if(s)throw s.error}}for(const A of h.flush()){const w=c.decode(A);w&&(yield yield Pe(w))}})}function dV(i){return Tr(this,arguments,function*(){var t,n,s,o;let l=new Uint8Array;try{for(var c=!0,h=wr(i),f;f=yield Pe(h.next()),t=f.done,!t;c=!0){o=f.value,c=!1;const g=o;if(g==null)continue;const y=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?jw(g):g;let b=new Uint8Array(l.length+y.length);b.set(l),b.set(y,l.length),l=b;let A;for(;(A=lV(l))!==-1;)yield yield Pe(l.slice(0,A)),l=l.slice(A)}}catch(g){n={error:g}}finally{try{!c&&!t&&(s=h.return)&&(yield Pe(s.call(h)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Pe(l))})}class hV{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=fV(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function fV(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function pV(i,e){const{response:t,requestLogID:n,retryOfRequestLogID:s,startTime:o}=e,l=await(async()=>{var c;if(e.options.stream)return Ai(i).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,i):Th.fromSSEResponse(t,e.controller,i);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type"),f=(c=h==null?void 0:h.split(";")[0])===null||c===void 0?void 0:c.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await t.json():await t.text()})();return Ai(i).debug(`[${n}] response parsed`,$c({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-o})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ww extends Promise{constructor(e,t,n=pV){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new Ww(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zk=Symbol("brand.privateNullableHeaders");function*gV(i){if(!i)return;if(zk in i){const{values:n,nulls:s}=i;yield*n.entries();for(const o of s)yield[o,null];return}let e=!1,t;i instanceof Headers?t=i.entries():gM(i)?t=i:(e=!0,t=Object.entries(i??{}));for(let n of t){const s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=gM(n[1])?n[1]:[n[1]];let l=!1;for(const c of o)c!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,c])}}const mg=i=>{const e=new Headers,t=new Set;for(const n of i){const s=new Set;for(const[o,l]of gV(n)){const c=o.toLowerCase();s.has(c)||(e.delete(o),s.add(c)),l===null?(e.delete(o),t.add(c)):(e.append(o,l),t.delete(c))}}return{[zk]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nE=i=>{var e,t,n,s,o,l;if(typeof globalThis.process<"u")return(n=(t=(e=H3)===null||e===void 0?void 0:e[i])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||o===void 0?void 0:o.call(s,i))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Vk;class y_{constructor(e){var t,n,s,o,l,c,h,{baseURL:f=nE("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:g=(t=nE("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:y="v1beta"}=e,b=Sb(e,["baseURL","apiKey","apiVersion"]);const A=Object.assign(Object.assign({apiKey:g,apiVersion:y},b),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=A.baseURL,this.timeout=(n=A.timeout)!==null&&n!==void 0?n:y_.DEFAULT_TIMEOUT,this.logger=(s=A.logger)!==null&&s!==void 0?s:console;const w="warn";this.logLevel=w,this.logLevel=(l=(o=_M(A.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:_M(nE("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:w,this.fetchOptions=A.fetchOptions,this.maxRetries=(c=A.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(h=A.fetch)!==null&&h!==void 0?h:Xz(),this.encoder=Qz,this._options=A,this.apiKey=g,this.apiVersion=y,this.clientAdapter=A.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=mg([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return mg([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return mg([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new nr(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ph}`}defaultIdempotencyKey(){return`stainless-node-retry-${Lz()}`}makeStatusError(e,t,n,s){return Ci.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,o=Uz(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return Hz(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new Ww(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,o,l;const c=await e,h=(s=c.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=h),await this.prepareOptions(c);const{req:f,url:g,timeout:y}=await this.buildRequest(c,{retryCount:h-t});await this.prepareRequest(f,{url:g,options:c});const b="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),A=n===void 0?"":`, retryOf: ${n}`,w=Date.now();if(Ai(this).debug(`[${b}] sending request`,$c({retryOfRequestLogID:n,method:c.method,url:g,options:c,headers:f.headers})),!((o=c.signal)===null||o===void 0)&&o.aborted)throw new FE;const x=new AbortController,N=await this.fetchWithTimeout(g,f,y,x).catch(UE),I=Date.now();if(N instanceof globalThis.Error){const k=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new FE;const L=OE(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return Ai(this).info(`[${b}] connection ${L?"timed out":"failed"} - ${k}`),Ai(this).debug(`[${b}] connection ${L?"timed out":"failed"} (${k})`,$c({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),this.retryRequest(c,t,n??b);throw Ai(this).info(`[${b}] connection ${L?"timed out":"failed"} - error; no more retries left`),Ai(this).debug(`[${b}] connection ${L?"timed out":"failed"} (error; no more retries left)`,$c({retryOfRequestLogID:n,url:g,durationMs:I-w,message:N.message})),L?new wk:new g_({cause:N})}const P=`[${b}${A}] ${f.method} ${g} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${I-w}ms`;if(!N.ok){const k=await this.shouldRetry(N);if(t&&k){const q=`retrying, ${t} attempts remaining`;return await Jz(N.body),Ai(this).info(`${P} - ${q}`),Ai(this).debug(`[${b}] response error (${q})`,$c({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),this.retryRequest(c,t,n??b,N.headers)}const L=k?"error; no more retries left":"error; not retryable";Ai(this).info(`${P} - ${L}`);const O=await N.text().catch(q=>UE(q).message),F=Vz(O),U=F?void 0:O;throw Ai(this).debug(`[${b}] response error (${L})`,$c({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,message:U,durationMs:Date.now()-w})),this.makeStatusError(N.status,F,U,N.headers)}return Ai(this).info(P),Ai(this).debug(`[${b}] response start`,$c({retryOfRequestLogID:n,url:N.url,status:N.status,headers:N.headers,durationMs:I-w})),{response:N,options:c,controller:x,requestLogID:b,retryOfRequestLogID:n,startTime:w}}async fetchWithTimeout(e,t,n,s){const o=t||{},{signal:l,method:c}=o,h=Sb(o,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const f=setTimeout(()=>s.abort(),n),g=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,y=Object.assign(Object.assign(Object.assign({signal:s.signal},g?{duplex:"half"}:{}),{method:"GET"}),h);c&&(y.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,y)}finally{clearTimeout(f)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,s){var o;let l;const c=s==null?void 0:s.get("retry-after-ms");if(c){const f=parseFloat(c);Number.isNaN(f)||(l=f)}const h=s==null?void 0:s.get("retry-after");if(h&&!l){const f=parseFloat(h);Number.isNaN(f)?l=Date.parse(h)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,f)}return await qz(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,s,o;const l=Object.assign({},e),{method:c,path:h,query:f,defaultBaseURL:g}=l,y=this.buildURL(h,f,g);"timeout"in l&&zz("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:b,body:A}=this.buildBody({options:l}),w=await this.buildHeaders({options:e,method:c,bodyHeaders:b,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:w},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&A instanceof globalThis.ReadableStream&&{duplex:"half"}),A&&{body:A}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:y,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let o={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=mg([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Wz()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=mg([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Kz(e)}:this.encoder({body:e,headers:n})}}y_.DEFAULT_TIMEOUT=6e4;class Un extends y_{constructor(){super(...arguments),this.interactions=new Gk(this)}}Vk=Un;Un.GeminiNextGenAPIClient=Vk;Un.GeminiNextGenAPIClientError=nr;Un.APIError=Ci;Un.APIConnectionError=g_;Un.APIConnectionTimeoutError=wk;Un.APIUserAbortError=FE;Un.NotFoundError=Ik;Un.ConflictError=Nk;Un.RateLimitError=Dk;Un.BadRequestError=xk;Un.AuthenticationError=Ck;Un.InternalServerError=kk;Un.PermissionDeniedError=Rk;Un.UnprocessableEntityError=Mk;Un.toFile=iV;Un.Interactions=Gk;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mV(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function yV(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function vV(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function bV(i,e){const t={},n=m(i,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function _V(i,e,t){const n={};if(m(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(i,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&v(e,["displayName"],s),m(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=m(i,["epochCount"]);e!==void 0&&o!=null&&v(e,["tuningTask","hyperparameters","epochCount"],o);const l=m(i,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=m(i,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const h=m(i,["learningRate"]);if(e!==void 0&&h!=null&&v(e,["tuningTask","hyperparameters","learningRate"],h),m(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function SV(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec"],AM(A))}else if(s==="PREFERENCE_TUNING"){const A=m(i,["validationDataset"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec"],AM(A))}const o=m(i,["tunedModelDisplayName"]);e!==void 0&&o!=null&&v(e,["tunedModelDisplayName"],o);const l=m(i,["description"]);e!==void 0&&l!=null&&v(e,["description"],l);let c=m(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],A)}else if(c==="PREFERENCE_TUNING"){const A=m(i,["epochCount"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],A)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],A)}else if(h==="PREFERENCE_TUNING"){const A=m(i,["learningRateMultiplier"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],A)}let f=m(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],A)}else if(f==="PREFERENCE_TUNING"){const A=m(i,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],A)}let g=m(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],A)}else if(g==="PREFERENCE_TUNING"){const A=m(i,["adapterSize"]);e!==void 0&&A!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],A)}if(m(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const y=m(i,["labels"]);e!==void 0&&y!=null&&v(e,["labels"],y);const b=m(i,["beta"]);return e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),n}function AV(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&kV(o);const l=m(i,["config"]);return l!=null&&_V(l,t),t}function EV(i,e){const t={},n=m(i,["baseModel"]);n!=null&&v(t,["baseModel"],n);const s=m(i,["preTunedModel"]);s!=null&&v(t,["preTunedModel"],s);const o=m(i,["trainingDataset"]);o!=null&&PV(o,t,e);const l=m(i,["config"]);return l!=null&&SV(l,t,e),t}function TV(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function wV(i,e){const t={},n=m(i,["name"]);return n!=null&&v(t,["_url","name"],n),t}function xV(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function CV(i,e,t){const n={},s=m(i,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const o=m(i,["pageToken"]);e!==void 0&&o!=null&&v(e,["_query","pageToken"],o);const l=m(i,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function RV(i,e){const t={},n=m(i,["config"]);return n!=null&&xV(n,t),t}function IV(i,e){const t={},n=m(i,["config"]);return n!=null&&CV(n,t),t}function NV(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>qk(c))),v(t,["tuningJobs"],l)}return t}function MV(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["nextPageToken"]);s!=null&&v(t,["nextPageToken"],s);const o=m(i,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>GE(c))),v(t,["tuningJobs"],l)}return t}function DV(i,e){const t={},n=m(i,["name"]);n!=null&&v(t,["model"],n);const s=m(i,["name"]);return s!=null&&v(t,["endpoint"],s),t}function kV(i,e){const t={};if(m(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(i,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>o)),v(t,["examples","examples"],s)}return t}function PV(i,e,t){const n={};let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=m(i,["gcsUri"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=m(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=m(i,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(m(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function qk(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],ok(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["tuningTask","startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["tuningTask","completeTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["description"]);g!=null&&v(t,["description"],g);const y=m(i,["baseModel"]);y!=null&&v(t,["baseModel"],y);const b=m(i,["_self"]);return b!=null&&v(t,["tunedModel"],DV(b)),t}function GE(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["state"]);o!=null&&v(t,["state"],ok(o));const l=m(i,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(i,["startTime"]);c!=null&&v(t,["startTime"],c);const h=m(i,["endTime"]);h!=null&&v(t,["endTime"],h);const f=m(i,["updateTime"]);f!=null&&v(t,["updateTime"],f);const g=m(i,["error"]);g!=null&&v(t,["error"],g);const y=m(i,["description"]);y!=null&&v(t,["description"],y);const b=m(i,["baseModel"]);b!=null&&v(t,["baseModel"],b);const A=m(i,["tunedModel"]);A!=null&&v(t,["tunedModel"],A);const w=m(i,["preTunedModel"]);w!=null&&v(t,["preTunedModel"],w);const x=m(i,["supervisedTuningSpec"]);x!=null&&v(t,["supervisedTuningSpec"],x);const N=m(i,["preferenceOptimizationSpec"]);N!=null&&v(t,["preferenceOptimizationSpec"],N);const I=m(i,["tuningDataStats"]);I!=null&&v(t,["tuningDataStats"],I);const P=m(i,["encryptionSpec"]);P!=null&&v(t,["encryptionSpec"],P);const k=m(i,["partnerModelTuningSpec"]);k!=null&&v(t,["partnerModelTuningSpec"],k);const L=m(i,["customBaseModel"]);L!=null&&v(t,["customBaseModel"],L);const O=m(i,["experiment"]);O!=null&&v(t,["experiment"],O);const F=m(i,["labels"]);F!=null&&v(t,["labels"],F);const U=m(i,["outputUri"]);U!=null&&v(t,["outputUri"],U);const X=m(i,["pipelineJob"]);X!=null&&v(t,["pipelineJob"],X);const q=m(i,["serviceAccount"]);q!=null&&v(t,["serviceAccount"],q);const Z=m(i,["tunedModelDisplayName"]);Z!=null&&v(t,["tunedModelDisplayName"],Z);const ee=m(i,["veoTuningSpec"]);return ee!=null&&v(t,["veoTuningSpec"],ee),t}function LV(i,e){const t={},n=m(i,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const s=m(i,["name"]);s!=null&&v(t,["name"],s);const o=m(i,["metadata"]);o!=null&&v(t,["metadata"],o);const l=m(i,["done"]);l!=null&&v(t,["done"],l);const c=m(i,["error"]);return c!=null&&v(t,["error"],c),t}function AM(i,e){const t={},n=m(i,["gcsUri"]);n!=null&&v(t,["validationDatasetUri"],n);const s=m(i,["vertexDatasetResource"]);return s!=null&&v(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OV extends Ha{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bd(Da.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),o=await this.tuneMldevInternal(s);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:RE.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=wV(e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>GE(g))}else{const f=TV(e);return c=pe("{name}",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>qk(g))}}async listInternal(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=IV(e);return c=pe("tuningJobs",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=MV(g),b=new WN;return Object.assign(b,y),b})}else{const f=RV(e);return c=pe("tunedModels",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=NV(g),b=new WN;return Object.assign(b,y),b})}}async cancel(e){var t,n,s,o;let l,c="",h={};if(this.apiClient.isVertexAI()){const f=yV(e);return c=pe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=bV(g),b=new XN;return Object.assign(b,y),b})}else{const f=mV(e);return c=pe("{name}:cancel",f._url),h=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{const b=y;return b.sdkHttpResponse={headers:g.headers},b})),l.then(g=>{const y=vV(g),b=new XN;return Object.assign(b,y),b})}}async tuneInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI()){const c=EV(e,e);return o=pe("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>GE(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=AV(e);return o=pe("tunedModels",c._url),l=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(f=>{const g=f;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>LV(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UV{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const FV=1024*1024*8,BV=3,HV=1e3,GV=2,Eb="x-goog-upload-status";async function zV(i,e,t){var n;const s=await $k(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[Eb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function VV(i,e,t){var n;const s=await $k(i,e,t),o=await(s==null?void 0:s.json());if(((n=s==null?void 0:s.headers)===null||n===void 0?void 0:n[Eb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=ek(o),c=new Gw;return Object.assign(c,l),c}async function $k(i,e,t){var n,s;let o=0,l=0,c=new NE(new Response),h="upload";for(o=i.size;l<o;){const f=Math.min(FV,o-l),g=i.slice(l,l+f);l+f>=o&&(h+=", finalize");let y=0,b=HV;for(;y<BV&&(c=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[Eb]));)y++,await $V(b),b=b*GV;if(l+=f,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[Eb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function qV(i){return{size:i.size,type:i.type}}function $V(i){return new Promise(e=>setTimeout(e,i))}class YV{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await zV(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await VV(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await qV(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jV{create(e,t,n){return new WV(e,t,n)}}class WV{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EM="x-goog-api-key";class XV{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(EM)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(EM,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KV="gl-node/";class JV{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Un({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=q3(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new XV(this.apiKey);this.apiClient=new qG({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:KV+"web",uploader:new YV,downloader:new UV}),this.models=new cz(this.apiClient),this.live=new iz(this.apiClient,s,new jV),this.batches=new bH(this.apiClient),this.chats=new e5(this.models,this.apiClient),this.caches=new JH(this.apiClient),this.files=new u5(this.apiClient),this.operations=new uz(this.apiClient),this.authTokens=new xz(this.apiClient),this.tunings=new OV(this.apiClient),this.fileSearchStores=new Pz(this.apiClient)}}const QV="https://openlibrary.org",ZV="https://covers.openlibrary.org",e8=async(i,e=20)=>{try{const t=await fetch(`${QV}/search.json?q=${encodeURIComponent(i)}&limit=${e}&fields=key,title,author_name,first_publish_year,cover_i,isbn,subject,language,edition_count,has_fulltext,ia,ratings_average,ratings_count`);if(!t.ok)throw new Error("Open Library search failed");return((await t.json()).docs||[]).map((o,l)=>{var c,h,f;return{id:`ol-${o.key.replace("/works/","")}-${Date.now()}-${l}`,title:o.title,author:((c=o.author_name)==null?void 0:c[0])||"Unknown Author",coverColor:t8(),coverImageUrl:o.cover_i?`${ZV}/b/id/${o.cover_i}-L.jpg`:void 0,isbn:(h=o.isbn)==null?void 0:h[0],description:void 0,isLocal:!1,publishedYear:((f=o.first_publish_year)==null?void 0:f.toString())||"Unknown",categories:(o.subject||[]).slice(0,5),source:"openLibrary",openLibraryId:o.key,averageRating:o.ratings_average,ratingsCount:o.ratings_count,hasFullText:o.has_fulltext||!1,internetArchiveIds:o.ia||[]}})}catch(t){return console.error("Open Library search error:",t),[]}},t8=()=>{const i=["#e0f2fe","#dbeafe","#bfdbfe","#f0fdf4","#dcfce7","#bbf7d0","#fdf4ff","#fae8ff","#f5d0fe","#fff1f2","#ffe4e6","#fecdd3","#fefce8","#fef9c3","#fef08a","#f5f5f4","#fafaf9","#e7e5e4"];return i[Math.floor(Math.random()*i.length)]},Nr=new JV({apiKey:"AIzaSyDKkxTYId1SXW4k0skhK-P6x2CY62MWRmc"}),Mr="gemini-2.5-flash",Hy=i=>{if(!i)return[];try{return JSON.parse(i)}catch{const t=i.replace(/```json\n?|```/g,"").trim();try{return JSON.parse(t)}catch(n){return console.error("Failed to parse Gemini JSON",n),[]}}},n8=async i=>{try{const e=await e8(i,12);return e.length>0?await i8(e):await s8(i)}catch(e){return console.error("Hybrid search error:",e),d_(i)}},i8=async i=>{const e=i.filter(t=>!t.description);if(e.length===0)return i;try{const t=e.slice(0,6).map(o=>`"${o.title}" by ${o.author}`).join(", "),n=await Nr.models.generateContent({model:Mr,contents:`For each of these books: ${t}
        
        Return a JSON array with objects containing:
        - title (exact match)
        - description (compelling 2-sentence hook for each book)
        
        Only return the JSON array, no other text.`,config:{responseMimeType:"application/json"}}),s=Hy(n.text);return i.map(o=>{if(o.description)return o;const l=s.find(c=>{var h;return((h=c.title)==null?void 0:h.toLowerCase())===o.title.toLowerCase()});return{...o,description:(l==null?void 0:l.description)||`A fascinating read by ${o.author}.`,source:"openLibrary"}})}catch(t){return console.error("Enrichment error:",t),i}},s8=async i=>{try{const e={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING,description:"A pastel hex color code matching the book vibe"},isbn:{type:ke.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10 to fetch cover image."}},required:["title","author","description","publishedYear","categories","coverColor","isbn"]},t={type:ke.ARRAY,items:e},n=`
      You are the search engine for the world's largest digital library.
      The user is searching for: "${i}".
      
      Instructions:
      1. If the query specifies a particular book title (e.g., "The Great Gatsby"), return that specific book first.
      2. If the query is a genre or topic (e.g., "Sci-Fi", "Cooking"), return 6 popular, high-quality books in that category.
      3. If the query is nonsense, random characters, or matches no known books (e.g., "asdfghjkl"), return an EMPTY array [].
      4. CRITICAL: Provide a valid real-world 'isbn' (ISBN-13 preferred) for every book so we can display the cover.
      
      For 'description', write a compelling 2-sentence hook.
      For 'coverColor', generate a unique, aesthetic pastel hex code for each book as a fallback.
    `,s=await Nr.models.generateContent({model:Mr,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return Hy(s.text).map((l,c)=>({id:`gemini-search-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],source:"gemini",fileUrl:void 0}))}catch(e){return console.warn("Gemini Search Error, switching to fallback:",e),d_(i)}},r8=async(i,e)=>{try{const t={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING},isbn:{type:ke.STRING,description:"Valid ISBN-13."},matchReason:{type:ke.STRING,description:"Why this recommendation fits the conversation."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},n={type:ke.OBJECT,properties:{reply:{type:ke.STRING,description:"Your conversational response to the user."},suggestions:{type:ke.ARRAY,items:t,description:"List of 1-3 books if relevant to the user's request. Can be empty if the user is just chatting."}},required:["reply","suggestions"]},s=`
            You are a sophisticated, warm, and highly knowledgeable literary concierge named "Suitcase".
            Your goal is to have a natural conversation with the user to help them find the perfect book.
            
            Conversation History:
            ${JSON.stringify(e.slice(-6))}
            
            Current User Input: "${i}"
            
            Instructions:
            1. Respond conversationally to the user's input. Be witty and helpful.
            2. If the user is asking for books, feeling a certain way, or discussing genres, provide 1-3 highly curated recommendations.
            3. If the user is just saying hello or asking a general question, reply without suggestions.
            4. 'matchReason' should be a personalized sentence about why you picked this book for them.
        `,o=await Nr.models.generateContent({model:Mr,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=Hy(o.text),c=(l.suggestions||[]).map((h,f)=>({id:`concierge-${Date.now()}-${f}`,title:h.title,author:h.author,coverColor:h.coverColor||"#E2E8F0",isbn:h.isbn,description:h.description,isLocal:!1,publishedYear:h.publishedYear,categories:h.categories||[],matchReason:h.matchReason,fileUrl:void 0}));return{reply:l.reply||"I'm pondering that thought...",suggestions:c}}catch(t){return console.warn("Concierge Error, using fallback",t),Nw(i)}},o8=async i=>{try{const e={type:ke.OBJECT,properties:{title:{type:ke.STRING},author:{type:ke.STRING},description:{type:ke.STRING},publishedYear:{type:ke.STRING},categories:{type:ke.ARRAY,items:{type:ke.STRING}},coverColor:{type:ke.STRING},isbn:{type:ke.STRING,description:"Valid ISBN-13 (preferred) or ISBN-10."},matchReason:{type:ke.STRING,description:"Why this fits the user's preferences."}},required:["title","author","description","publishedYear","categories","coverColor","isbn","matchReason"]},t={type:ke.ARRAY,items:e},n=`
        The user loves these genres: ${i.genres.join(", ")}.
        Their reading goal is: ${i.readingGoal}.
        
        Recommend 4 diverse, highly-rated books that fit this profile.
        Use soft, elegant colors for coverColor as fallback.
        CRITICAL: Provide a valid 'isbn' for each book for cover lookup.
      `,s=await Nr.models.generateContent({model:Mr,contents:n,config:{responseMimeType:"application/json",responseSchema:t}});return Hy(s.text).map((l,c)=>({id:`gemini-onboarding-${Date.now()}-${c}`,title:l.title,author:l.author,coverColor:l.coverColor||"#E2E8F0",isbn:l.isbn,description:l.description,isLocal:!1,publishedYear:l.publishedYear,categories:l.categories||[],matchReason:l.matchReason,fileUrl:void 0}))}catch(e){return console.warn("Gemini Onboarding Error, using fallback:",e),Mw()}},a8=async(i,e)=>{try{const t={type:ke.OBJECT,properties:{reviewerName:{type:ke.STRING},rating:{type:ke.NUMBER},text:{type:ke.STRING},date:{type:ke.STRING}},required:["reviewerName","rating","text","date"]},n={type:ke.ARRAY,items:t},s=`
      Generate 4 realistic user reviews for "${i}" by ${e}.
      Style: Goodreads or Amazon reviews. 
      Mix of lengths. Some detailed, some short. 
      Vary the ratings (mostly positive but maybe one critical).
    `,o=await Nr.models.generateContent({model:Mr,contents:s,config:{responseMimeType:"application/json",responseSchema:n}}),l=Hy(o.text),c=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899"];return l.map((h,f)=>({id:`review-${f}`,reviewerName:h.reviewerName,rating:h.rating,text:h.text,date:h.date,avatarColor:c[f%c.length]}))}catch(t){return console.warn("Review Gen Error, using fallback:",t),Dw()}},l8=async(i,e,t)=>{try{const n=`
            You are an expert literary scholar and reading companion.
            Context: The user is currently reading "${i}".
            
            Previous Conversation:
            ${JSON.stringify(t.slice(-5))}
            
            User Question: "${e}"
            
            Answer concisely but deeply. If they ask about plot, be careful with spoilers unless asked.
        `;return(await Nr.models.generateContent({model:Mr,contents:n})).text||"I couldn't generate a response."}catch{return kw(i,e)}},c8=async(i,e="English")=>{try{const t=`Translate the following literary text to ${e}. Preserve the tone and style: "${i}"`;return(await Nr.models.generateContent({model:Mr,contents:t})).text||"Translation failed."}catch{return Pw(i)}},u8=async(i,e)=>{try{const t=`The user is reading "${e}" and highlighted this text: "${i}".
        Explain this excerpt in simple terms. Provide necessary context, historical background, or define archaic words.`;return(await Nr.models.generateContent({model:Mr,contents:t})).text||"Could not explain context."}catch{return Lw(i,e)}},d8=async(i,e,t=1)=>{try{const n=`
          The user wants to read **Chapter ${t}** of the book "${i}" by ${e}.
          
          Instructions:
          1. Write the FULL text for **Chapter ${t}**. 
          2. If it is a public domain book, provide the exact text.
          3. If it is copyrighted, write a very detailed, high-fidelity narrative adaptation that includes all dialogue, scene descriptions, and inner monologues.
          4. Length: CRITICAL - Write at least 1500-2000 words. The user wants to read for a long time.
          5. Formatting: Use clean HTML. Use <h3> for the Chapter Title. Use <p> for paragraphs.
          
          Do NOT use markdown code blocks. Just return the HTML string.
        `;let o=(await Nr.models.generateContent({model:Mr,contents:n})).text||"<p>Content unavailable.</p>";return o=o.replace(/```html|```/g,"").trim(),o}catch{return Ow(i,e,t)}},h8=async i=>{try{const e=`Provide a comprehensive summary of the book "${i}". Cover the main plot points, themes, and character arcs.`;return(await Nr.models.generateContent({model:Mr,contents:e})).text||"Summary unavailable."}catch{return Uw(i)}},f8=async i=>{try{const e=`The user is reading "${i}" and has forgotten what happened previously. Provide a quick recap of the beginning/setup of the book to jog their memory.`;return(await Nr.models.generateContent({model:Mr,contents:e})).text||"Recap unavailable."}catch{return Fw(i)}},p8=Object.freeze(Object.defineProperty({__proto__:null,chatAboutBook:l8,consultConcierge:r8,explainContext:u8,generateBookContent:d8,generateReviews:a8,getBookRecap:f8,getBookSummary:h8,getOnboardingRecommendations:o8,searchBooks:n8,translateText:c8},Symbol.toStringTag,{value:"Module"})),g8=()=>"gemini",Tb=g8();console.log(` AI Provider: ${Tb.toUpperCase()}${Tb==="fallback"?" (Add VITE_GROQ_API_KEY for free AI features)":""}`);const vo=Tb==="groq"?B3:Tb==="gemini"?p8:R3,m8=vo.searchBooks,y8=vo.consultConcierge,iE=vo.getOnboardingRecommendations,v8=vo.generateReviews,zE=vo.chatAboutBook,b8=vo.translateText,_8=vo.explainContext,S8=vo.generateBookContent,A8=vo.getBookSummary,E8=vo.getBookRecap,T8=({book:i,onClose:e,onRead:t})=>{const[n,s]=J.useState([]),[o,l]=J.useState(!1),[c,h]=J.useState("reviews"),[f,g]=J.useState(""),[y,b]=J.useState([]),[A,w]=J.useState(!1),x=J.useRef(null);J.useEffect(()=>{const I=async()=>{l(!0);const P=await v8(i.title,i.author);s(P),l(!1)};c==="reviews"&&n.length===0&&I()},[i,c]),J.useEffect(()=>{var I;(I=x.current)==null||I.scrollIntoView({behavior:"smooth"})},[y]);const N=async I=>{if(I.preventDefault(),!f.trim())return;const P=f;g("");const k=[...y,{role:"user",text:P}];b(k),w(!0);try{const L=await zE(i.title,P,k);b(O=>[...O,{role:"model",text:L}])}catch(L){console.error(L)}finally{w(!1)}};return E.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 animate-spring",children:[E.jsx("div",{className:"absolute inset-0 bg-gray-900/40 backdrop-blur-sm transition-opacity",onClick:e}),E.jsxs("div",{className:"relative w-full max-w-4xl bg-[#FBFBFD] h-[85vh] rounded-[2rem] shadow-2xl overflow-hidden flex flex-col md:flex-row animate-[scale-up_0.4s_cubic-bezier(0.16,1,0.3,1)]",children:[E.jsxs("div",{className:"w-full md:w-1/3 bg-white border-r border-gray-100 flex flex-col",children:[E.jsxs("div",{className:"relative h-64 md:h-1/2 w-full flex items-center justify-center overflow-hidden",style:{backgroundColor:i.coverColor},children:[E.jsx("button",{onClick:e,className:"absolute top-4 left-4 p-2 bg-black/10 hover:bg-black/20 text-white rounded-full backdrop-blur-lg transition-colors z-10 md:hidden",children:E.jsx(yl,{size:20})}),E.jsx(Ca,{className:"text-white/80 w-24 h-24 drop-shadow-lg transform hover:scale-105 transition-transform duration-700"}),i.matchReason&&E.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:E.jsxs("div",{className:"bg-white/90 backdrop-blur p-4 rounded-2xl shadow-lg border border-white/50",children:[E.jsxs("p",{className:"text-[10px] uppercase font-bold text-blue-600 mb-1 flex items-center gap-1",children:[E.jsx(Es,{size:10})," Why this book?"]}),E.jsxs("p",{className:"text-xs text-gray-700 font-medium leading-relaxed",children:['"',i.matchReason,'"']})]})})]}),E.jsxs("div",{className:"p-8 flex flex-col flex-1 bg-white",children:[E.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900 mb-2 leading-tight",children:i.title}),E.jsx("p",{className:"text-lg text-gray-500 font-medium mb-6",children:i.author}),E.jsx("div",{className:"mt-auto space-y-3",children:E.jsxs("button",{onClick:t,className:"w-full bg-[#1D1D1F] text-white py-4 rounded-2xl font-semibold hover:bg-black transition-transform active:scale-95 flex items-center justify-center gap-2 shadow-lg",children:[E.jsx(Ca,{size:18}),"Read"]})})]})]}),E.jsxs("div",{className:"flex-1 flex flex-col bg-[#F5F5F7]",children:[E.jsx("div",{className:"p-6 md:p-8 pb-0 shrink-0",children:E.jsxs("div",{className:"flex justify-between items-start mb-6",children:[E.jsx("div",{className:"flex bg-gray-200/50 p-1 rounded-full relative",children:["reviews","details","chat"].map(I=>E.jsx("button",{onClick:()=>h(I),className:`px-6 py-2 rounded-full text-sm font-semibold transition-all duration-300 relative z-10 ${c===I?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:I.charAt(0).toUpperCase()+I.slice(1)},I))}),E.jsx("button",{onClick:e,className:"hidden md:block p-2 text-gray-400 hover:text-gray-900 bg-white rounded-full shadow-sm hover:shadow transition-all",children:E.jsx(yl,{size:20})})]})}),E.jsxs("div",{className:"flex-1 overflow-y-auto px-6 md:px-8 pb-8",children:[c==="reviews"&&E.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[E.jsxs("div",{className:"flex items-center justify-between mb-6",children:[E.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Critics & Readers"}),E.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-gray-500 bg-white px-3 py-1.5 rounded-full shadow-sm",children:[E.jsx(Es,{size:12,className:"text-blue-500"})," Smart Summary"]})]}),i.reviewSnippet&&E.jsxs("div",{className:"mb-8 p-6 bg-blue-50/50 rounded-3xl border border-blue-100/50",children:[E.jsx(c3,{className:"text-blue-200 mb-2 w-8 h-8"}),E.jsx("p",{className:"text-lg font-serif text-gray-800 italic leading-relaxed",children:i.reviewSnippet})]}),o?E.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[E.jsx(Ta,{className:"animate-spin text-gray-400 w-8 h-8 mb-4"}),E.jsx("p",{className:"text-gray-400 text-sm",children:"Aggregating reviews..."})]}):E.jsx("div",{className:"grid gap-4",children:n.map(I=>E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-white hover:border-blue-100 transition-colors",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[E.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-sm",style:{backgroundColor:I.avatarColor},children:I.reviewerName.charAt(0)}),E.jsxs("div",{children:[E.jsx("p",{className:"text-sm font-bold text-gray-900",children:I.reviewerName}),E.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(P=>E.jsx(xE,{size:10,className:`${P<=I.rating?"text-yellow-400 fill-yellow-400":"text-gray-200"}`},P))})]}),E.jsx("span",{className:"ml-auto text-xs font-medium text-gray-400 bg-gray-50 px-2 py-1 rounded-md",children:I.date})]}),E.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:['"',I.text,'"']})]},I.id))})]}),c==="details"&&E.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[E.jsxs("div",{className:"bg-white p-8 rounded-[2rem] shadow-sm",children:[E.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Synopsis"}),E.jsx("p",{className:"text-gray-700 leading-loose font-serif text-lg",children:i.description||"No description provided."})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[E.jsx(JD,{size:18}),E.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Published"})]}),E.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.publishedYear||"Unknown"})]}),E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-2",children:[E.jsx(QD,{size:18}),E.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Rights"})]}),E.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Public Domain"})]})]}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Categories"}),E.jsx("div",{className:"flex flex-wrap gap-2",children:i.categories.map(I=>E.jsx("span",{className:"px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-full text-sm font-medium shadow-sm",children:I},I))})]})]}),c==="chat"&&E.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[E.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 mb-4 pr-2 min-h-[300px]",children:[y.length===0&&E.jsxs("div",{className:"text-center py-12",children:[E.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:E.jsx(Es,{className:"w-8 h-8 text-blue-500"})}),E.jsx("h4",{className:"text-gray-900 font-bold text-lg mb-1",children:"Book Companion"}),E.jsx("p",{className:"text-gray-500 text-sm",children:"Ask about themes, characters, or plot points."})]}),y.map((I,P)=>E.jsx("div",{className:`flex ${I.role==="user"?"justify-end":"justify-start"}`,children:E.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm leading-relaxed shadow-sm ${I.role==="user"?"bg-blue-600 text-white rounded-br-sm":"bg-white text-gray-800 rounded-bl-sm border border-gray-100"}`,children:I.text})},P)),A&&E.jsx("div",{className:"flex justify-start",children:E.jsx("div",{className:"bg-white border border-gray-100 p-4 rounded-2xl rounded-bl-sm shadow-sm",children:E.jsx(Ta,{size:16,className:"animate-spin text-gray-400"})})}),E.jsx("div",{ref:x})]}),E.jsxs("form",{onSubmit:N,className:"relative mt-auto",children:[E.jsx("input",{type:"text",placeholder:"Ask a question...",className:"w-full pl-6 pr-14 py-4 bg-white border-0 shadow-lg shadow-gray-200/50 rounded-full focus:ring-2 focus:ring-blue-500 outline-none text-base font-medium placeholder:text-gray-400 transition-all",value:f,onChange:I=>g(I.target.value)}),E.jsx("button",{type:"submit",disabled:!f.trim()||A,className:"absolute right-2 top-2 p-2.5 bg-black text-white rounded-full hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-90",children:E.jsx(Iw,{size:18})})]})]})]})]})]})]})},Ei=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),VE=[.001,0,0,.001,0,0],sE=1.35,_s={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},uo={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Kg="pdfjs_internal_editor_",Ue={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},it={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Yk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Yg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},un={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},gh={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Gy={ERRORS:0,WARNINGS:1,INFOS:5},fp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Sv={moveTo:0,lineTo:1,curveTo:2,closePath:3},jk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let v_=Gy.WARNINGS;function w8(i){Number.isInteger(i)&&(v_=i)}function x8(){return v_}function b_(i){v_>=Gy.INFOS&&console.info(`Info: ${i}`)}function Fe(i){v_>=Gy.WARNINGS&&console.warn(`Warning: ${i}`)}function Lt(i){throw new Error(i)}function ot(i,e){i||Lt(e)}function C8(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Xw(i,e=null,t=null){if(!i)return null;if(t&&typeof i=="string"){if(t.addDefaultProtocol&&i.startsWith("www.")){const s=i.match(/\./g);(s==null?void 0:s.length)>=2&&(i=`http://${i}`)}if(t.tryConvertEncoding)try{i=D8(i)}catch{}}const n=e?URL.parse(i,e):URL.parse(i);return C8(n)?n:null}function Kw(i,e,t=!1){const n=URL.parse(i);return n?(n.hash=e,n.href):t&&Xw(i,"http://example.com")?i.split("#",1)[0]+`${e?`#${e}`:""}`:""}function $e(i,e,t,n=!1){return Object.defineProperty(i,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const _d=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class TM extends _d{constructor(e,t){super(e,"PasswordException"),this.code=t}}class rE extends _d{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class wb extends _d{constructor(e){super(e,"InvalidPDFException")}}class Jg extends _d{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class R8 extends _d{constructor(e){super(e,"FormatError")}}class ka extends _d{constructor(e){super(e,"AbortException")}}function Wk(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&Lt("Invalid argument for bytesToString");const e=i.length,t=8192;if(e<t)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),l=i.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function zy(i){typeof i!="string"&&Lt("Invalid argument for stringToBytes");const e=i.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=i.charCodeAt(n)&255;return t}function I8(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function N8(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function M8(){try{return new Function(""),!0}catch{return!1}}class On{static get isLittleEndian(){return $e(this,"isLittleEndian",N8())}static get isEvalSupported(){return $e(this,"isEvalSupported",M8())}static get isOffscreenCanvasSupported(){return $e(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return $e(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return $e(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return $e(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const oE=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Na,Lv,qE;class be{static makeHexColor(e,t,n){return`#${oE[e]}${oE[t]}${oE[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5];for(let g=0;g<6;g+=2){const y=e[n+g],b=e[n+g+1];e[n+g]=y*s+b*l+h,e[n+g+1]=y*o+b*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],g=e[0],y=e[1],b=e[2],A=e[3];let w=s*g+h,x=w,N=s*b+h,I=N,P=c*y+f,k=P,L=c*A+f,O=L;if(o!==0||l!==0){const F=o*g,U=o*b,X=l*y,q=l*A;w+=X,I+=X,N+=q,x+=q,P+=F,O+=F,L+=U,k+=U}n[0]=Math.min(n[0],w,N,x,I),n[1]=Math.min(n[1],P,L,k,O),n[2]=Math.max(n[2],w,N,x,I),n[3]=Math.max(n[3],P,L,k,O)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],l=e[3],c=n**2+s**2,h=n*o+s*l,f=o**2+l**2,g=(c+f)/2,y=Math.sqrt(g**2-(c*f-h**2));t[0]=Math.sqrt(g+y||1),t[1]=Math.sqrt(g-y||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[n,o,s,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static bezierBoundingBox(e,t,n,s,o,l,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),M(this,Na,qE).call(this,e,n,o,c,t,s,l,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),M(this,Na,qE).call(this,e,n,o,c,t,s,l,h,3*(-t+3*(s-l)+h),6*(t-2*s+l),3*(s-t),f)}}Na=new WeakSet,Lv=function(e,t,n,s,o,l,c,h,f,g){if(f<=0||f>=1)return;const y=1-f,b=f*f,A=b*f,w=y*(y*(y*e+3*f*t)+3*b*n)+A*s,x=y*(y*(y*o+3*f*l)+3*b*c)+A*h;g[0]=Math.min(g[0],w),g[1]=Math.min(g[1],x),g[2]=Math.max(g[2],w),g[3]=Math.max(g[3],x)},qE=function(e,t,n,s,o,l,c,h,f,g,y,b){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&M(this,Na,Lv).call(this,e,t,n,s,o,l,c,h,-y/g,b);return}const A=g**2-4*y*f;if(A<0)return;const w=Math.sqrt(A),x=2*f;M(this,Na,Lv).call(this,e,t,n,s,o,l,c,h,(-g+w)/x,b),M(this,Na,Lv).call(this,e,t,n,s,o,l,c,h,(-g-w)/x,b)},R(be,Na);function D8(i){return decodeURIComponent(escape(i))}let aE=null,wM=null;function Xk(i){return aE||(aE=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,wM=new Map([["","t"]])),i.replaceAll(aE,(e,t,n)=>t?t.normalize("NFKC"):wM.get(n))}function Jw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),Wk(i)}const Qw="pdfjs_internal_id_";function k8(i,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!i(n)&&!Number.isInteger(n)||!e(s))return!1;const l=o.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function ci(i,e,t){return Math.min(Math.max(i,e),t)}function Kk(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(Wk(i))}function P8(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):zy(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...e){return new Promise(t=>{t(i(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((e,t)=>e+t,0)});class Qg{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){var h;if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(Qg.shouldBuildText(c))(h=o==null?void 0:o.attributes)!=null&&h.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const f of o.children)s(f)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Zw{static setupStorage(e,t,n,s,o){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){var y,b;const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(l),e.viewport){const A=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=A}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const A=document.createTextNode(s.value);l.append(A),c&&Qg.shouldBuildText(s.name)&&f.push(A)}return{textDivs:f}}const g=[[s,-1,l]];for(;g.length>0;){const[A,w,x]=g.at(-1);if(w+1===A.children.length){g.pop();continue}const N=A.children[++g.at(-1)[1]];if(N===null)continue;const{name:I}=N;if(I==="#text"){const k=document.createTextNode(N.value);f.push(k),x.append(k);continue}const P=(y=N==null?void 0:N.attributes)!=null&&y.xmlns?document.createElementNS(N.attributes.xmlns,I):document.createElement(I);if(x.append(P),N.attributes&&this.setAttributes({html:P,element:N,storage:t,intent:o,linkService:n}),((b=N.children)==null?void 0:b.length)>0)g.push([N,-1,P]);else if(N.value){const k=document.createTextNode(N.value);c&&Qg.shouldBuildText(I)&&f.push(k),P.append(k)}}for(const A of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))A.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Bo="http://www.w3.org/2000/svg",Kc=class Kc{};ce(Kc,"CSS",96),ce(Kc,"PDF",72),ce(Kc,"PDF_TO_CSS_UNITS",Kc.CSS/Kc.PDF);let Pa=Kc;async function _p(i,e="text"){if(Ag(i,document.baseURI)){const t=await fetch(i);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Vy{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let g,y,b,A;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,y=0,b=0,A=1;break;case 90:g=0,y=1,b=1,A=0;break;case 270:g=0,y=-1,b=-1,A=0;break;case 0:g=1,y=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(b=-b,A=-A);let w,x,N,I;g===0?(w=Math.abs(f-e[1])*n+o,x=Math.abs(h-e[0])*n+l,N=(e[3]-e[1])*n,I=(e[2]-e[0])*n):(w=Math.abs(h-e[0])*n+o,x=Math.abs(f-e[1])*n+l,N=(e[2]-e[0])*n,I=(e[3]-e[1])*n),this.transform=[g*n,y*n,b*n,A*n,w-g*n*h-b*n*f,x-y*n*h-A*n*f],this.width=N,this.height=I}get rawDims(){const e=this.viewBox;return $e(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new Vy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return be.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];be.applyTransform(t,this.transform);const n=[e[2],e[3]];return be.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return be.applyInverseTransform(n,this.transform),n}}class __ extends _d{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function qy(i){const e=i.length;let t=0;for(;t<e&&i[t].trim()==="";)t++;return i.substring(t,t+5).toLowerCase()==="data:"}function S_(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function Jk(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function Qk(i,e="document.pdf"){if(typeof i!="string")return e;if(qy(i))return Fe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class xM{constructor(){ce(this,"started",Object.create(null));ce(this,"times",[])}time(e){e in this.started&&Fe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Fe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function Ag(i,e){const t=e?URL.parse(i,e):URL.parse(i);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function xs(i){i.preventDefault()}function Jt(i){i.preventDefault(),i.stopPropagation()}function L8(i){console.log("Deprecated API usage: "+i)}var om;class Zg{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;d(this,om)||T(this,om,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=d(this,om).exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let g=parseInt(t[8],10);g=g>=0&&g<=23?g:0;let y=parseInt(t[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=g,c+=y):f==="+"&&(l-=g,c-=y),new Date(Date.UTC(n,s,o,l,c,h))}}om=new WeakMap,R(Zg,om);function Zk(i,{scale:e=1,rotation:t=0}){const{width:n,height:s}=i.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new Vy({viewBox:o,userUnit:1,scale:e,rotation:t})}function Sp(i){if(i.startsWith("#")){const e=parseInt(i.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(e=>parseInt(e)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Fe(`Not a valid color format: "${i}"`),[0,0,0])}function O8(i){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of i.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;i.set(t,Sp(n))}e.remove()}function Kt(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform();return[e,t,n,s,o,l]}function Fr(i){const{a:e,b:t,c:n,d:s,e:o,f:l}=i.getTransform().invertSelf();return[e,t,n,s,o,l]}function vc(i,e,t=!1,n=!0){if(e instanceof Vy){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:l}=i,c=On.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,g=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(l.width=g,l.height=y):(l.width=y,l.height=g)}n&&i.setAttribute("data-main-rotation",e.rotation)}class xr{constructor(){const{pixelRatio:e}=xr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let l=1/0,c=1/0,h=1/0;n=xr.capPixels(n,o),n>0&&(l=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const xb=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class U8{static get isDarkMode(){var e;return $e(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class e2{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),$e(this,"commentForegroundColor",Sp(n))}}function t2(i,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return i=Math.round(i*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[i,e,t]}function CM(i,e){const t=i[0]/255,n=i[1]/255,s=i[2]/255,o=Math.max(t,n,s),l=Math.min(t,n,s),c=(o+l)/2;if(o===l)e[0]=e[1]=0;else{const h=o-l;switch(e[1]=c<.5?h/(o+l):h/(2-o-l),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function $E(i,e){const t=i[0],n=i[1],s=i[2],o=(1-Math.abs(2*s-1))*n,l=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=o+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=l+c;break}}function RM(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function IM(i,e,t){$E(i,t),t.map(RM);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];$E(e,t),t.map(RM);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const NM=new Map;function n2(i,e){const t=i[0]+i[1]*256+i[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=NM.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),l=s.subarray(3,6);CM(i,l);const c=s.subarray(6,9);CM(e,c);const h=c[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),IM(l,c,o)<f){let g,y;h?(g=l[2],y=1):(g=0,y=l[2]);const b=.005;for(;y-g>b;){const A=l[2]=(g+y)/2;h===IM(l,c,o)<f?g=A:y=A}l[2]=h?y:g}return $E(l,o),n=be.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),NM.set(t,n),n}function ex({html:i,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof i=="string"){const o=document.createElement("p");o.dir=e||"auto";const l=i.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const f=l[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else Zw.render({xfaHtml:i,div:s,intent:"richText"});s.firstChild.classList.add("richText",t),n.append(s)}var Al,El,Gs,zs,am,Tl,Hh,Gh,lm,Yb,i2,Qn,s2,r2,mh,Eg;const zo=class zo{constructor(e){R(this,Qn);R(this,Al,null);R(this,El,null);R(this,Gs);R(this,zs,null);R(this,am,null);R(this,Tl,null);R(this,Hh,null);R(this,Gh,null);T(this,Gs,e),d(zo,lm)||T(zo,lm,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=T(this,Al,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=d(this,Gs)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",xs,{signal:t}),e.addEventListener("pointerdown",M(zo,Yb,i2),{signal:t}));const n=T(this,zs,document.createElement("div"));n.className="buttons",e.append(n);const s=d(this,Gs).toolbarPosition;if(s){const{style:o}=e,l=d(this,Gs)._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return d(this,Al)}hide(){var e;d(this,Al).classList.add("hidden"),(e=d(this,El))==null||e.hideDropdown()}show(){var e,t;d(this,Al).classList.remove("hidden"),(e=d(this,am))==null||e.shown(),(t=d(this,Tl))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=d(this,Gs),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",d(zo,lm)[e]),M(this,Qn,mh).call(this,n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),d(this,zs).append(n)}async addAltText(e){const t=await e.render();M(this,Qn,mh).call(this,t),d(this,zs).append(t,d(this,Qn,Eg)),T(this,am,e)}addComment(e,t=null){if(d(this,Tl))return;const n=e.renderForToolbar();if(!n)return;M(this,Qn,mh).call(this,n);const s=T(this,Hh,d(this,Qn,Eg));t?(d(this,zs).insertBefore(n,t),d(this,zs).insertBefore(s,t)):d(this,zs).append(n,s),T(this,Tl,e),e.toolbar=this}addColorPicker(e){if(d(this,El))return;T(this,El,e);const t=e.renderButton();M(this,Qn,mh).call(this,t),d(this,zs).append(t,d(this,Qn,Eg))}async addEditSignatureButton(e){const t=T(this,Gh,await e.renderEditButton(d(this,Gs)));M(this,Qn,mh).call(this,t),d(this,zs).append(t,d(this,Qn,Eg))}removeButton(e){var t,n;switch(e){case"comment":(t=d(this,Tl))==null||t.removeToolbarCommentButton(),T(this,Tl,null),(n=d(this,Hh))==null||n.remove(),T(this,Hh,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,n){const s=d(this,zs).querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){d(this,Gh)&&(d(this,Gh).title=e)}remove(){var e;d(this,Al).remove(),(e=d(this,El))==null||e.destroy(),T(this,El,null)}};Al=new WeakMap,El=new WeakMap,Gs=new WeakMap,zs=new WeakMap,am=new WeakMap,Tl=new WeakMap,Hh=new WeakMap,Gh=new WeakMap,lm=new WeakMap,Yb=new WeakSet,i2=function(e){e.stopPropagation()},Qn=new WeakSet,s2=function(e){d(this,Gs)._focusEventsAllowed=!1,Jt(e)},r2=function(e){d(this,Gs)._focusEventsAllowed=!0,Jt(e)},mh=function(e){const t=d(this,Gs)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",M(this,Qn,s2).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",M(this,Qn,r2).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",xs,{signal:t}),!0)},Eg=function(){const e=document.createElement("div");return e.className="divider",e},R(zo,Yb),R(zo,lm,null);let YE=zo;var cm,eu,qo,Fa,o2,a2,jE;class F8{constructor(e){R(this,Fa);R(this,cm,null);R(this,eu,null);R(this,qo);T(this,qo,e)}show(e,t,n){const[s,o]=M(this,Fa,a2).call(this,t,n),{style:l}=d(this,eu)||T(this,eu,M(this,Fa,o2).call(this));e.append(d(this,eu)),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){d(this,eu).remove()}}cm=new WeakMap,eu=new WeakMap,qo=new WeakMap,Fa=new WeakSet,o2=function(){const e=T(this,eu,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=d(this,qo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",xs,{signal:t});const n=T(this,cm,document.createElement("div"));return n.className="buttons",e.append(n),d(this,qo).hasCommentManager()&&M(this,Fa,jE).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{d(this,qo).commentSelection("floating_button")}),M(this,Fa,jE).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{d(this,qo).highlightSelection("floating_button")}),e},a2=function(e,t){let n=0,s=0;for(const o of e){const l=o.y+o.height;if(l<n)continue;const c=o.x+(t?o.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]},jE=function(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=d(this,qo)._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",xs,{signal:c}),o.addEventListener("click",s,{signal:c})),d(this,cm).append(o)};function l2(i,e,t){for(const n of t)e.addEventListener(n,i[n].bind(i))}var jb;class B8{constructor(){R(this,jb,0)}get id(){return`${Kg}${An(this,jb)._++}`}}jb=new WeakMap;var zh,um,ii,Vh,Ov;const Ix=class Ix{constructor(){R(this,Vh);R(this,zh,Jw());R(this,um,0);R(this,ii,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return $e(this,"_isSVGFittingCanvas",o)}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return M(this,Vh,Ov).call(this,`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return M(this,Vh,Ov).call(this,e,e)}async getFromBlob(e,t){const n=await t;return M(this,Vh,Ov).call(this,e,n)}async getFromId(e){d(this,ii)||T(this,ii,new Map);const t=d(this,ii).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){d(this,ii)||T(this,ii,new Map);let n=d(this,ii).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${d(this,zh)}_${An(this,um)._++}`,refCounter:1,isSvg:!1},d(this,ii).set(e,n),d(this,ii).set(n.id,n),n}getSvgUrl(e){const t=d(this,ii).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;d(this,ii)||T(this,ii,new Map);const t=d(this,ii).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const o=new OffscreenCanvas(n.width,n.height);o.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=o.convertToBlob()}(s=n.close)==null||s.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${d(this,zh)}_`)}};zh=new WeakMap,um=new WeakMap,ii=new WeakMap,Vh=new WeakSet,Ov=async function(e,t){d(this,ii)||T(this,ii,new Map);let n=d(this,ii).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${d(this,zh)}_${An(this,um)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(n.url=t,s=await _p(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=Ix._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},l.onload=async()=>{const y=n.svgUrl=l.result;c.src=await o?`${y}#svgView(preserveAspectRatio(none))`:y},c.onerror=l.onerror=g});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Fe(s),n=null}return d(this,ii).set(e,n),n&&d(this,ii).set(n.id,n),n};let WE=Ix;var dn,wl,dm,Xt;class H8{constructor(e=128){R(this,dn,[]);R(this,wl,!1);R(this,dm);R(this,Xt,-1);T(this,dm,e)}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),d(this,wl))return;const h={cmd:e,undo:t,post:n,type:o};if(d(this,Xt)===-1){d(this,dn).length>0&&(d(this,dn).length=0),T(this,Xt,0),d(this,dn).push(h);return}if(l&&d(this,dn)[d(this,Xt)].type===o){c&&(h.undo=d(this,dn)[d(this,Xt)].undo),d(this,dn)[d(this,Xt)]=h;return}const f=d(this,Xt)+1;f===d(this,dm)?d(this,dn).splice(0,1):(T(this,Xt,f),f<d(this,dn).length&&d(this,dn).splice(f)),d(this,dn).push(h)}undo(){if(d(this,Xt)===-1)return;T(this,wl,!0);const{undo:e,post:t}=d(this,dn)[d(this,Xt)];e(),t==null||t(),T(this,wl,!1),T(this,Xt,d(this,Xt)-1)}redo(){if(d(this,Xt)<d(this,dn).length-1){T(this,Xt,d(this,Xt)+1),T(this,wl,!0);const{cmd:e,post:t}=d(this,dn)[d(this,Xt)];e(),t==null||t(),T(this,wl,!1)}}hasSomethingToUndo(){return d(this,Xt)!==-1}hasSomethingToRedo(){return d(this,Xt)<d(this,dn).length-1}cleanType(e){if(d(this,Xt)!==-1){for(let t=d(this,Xt);t>=0;t--)if(d(this,dn)[t].type!==e){d(this,dn).splice(t+1,d(this,Xt)-t),T(this,Xt,t);return}d(this,dn).length=0,T(this,Xt,-1)}}destroy(){T(this,dn,null)}}dn=new WeakMap,wl=new WeakMap,dm=new WeakMap,Xt=new WeakMap;var Wb,c2;class $y{constructor(e){R(this,Wb);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=On.platform;for(const[n,s,o={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(M(this,Wb,c2).call(this,t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),o||Jt(t))}}Wb=new WeakSet,c2=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Xb=class Xb{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return O8(e),$e(this,"_colors",e)}convert(e){const t=Sp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,l)=>o===t[l]))return Xb._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?be.makeHexColor(...t):e}};ce(Xb,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let XE=Xb;var qh,is,$h,nn,Tn,Yh,Vs,jh,qs,si,xl,Cl,Wh,Rl,Gr,$s,tu,hm,fm,Xh,pm,zr,Il,Kh,Nl,Vr,Kb,Ml,Jh,gm,Dl,nu,Qh,kl,mm,bn,bt,$o,Pl,Ll,ym,Zh,vm,Ol,qr,Yo,bm,_m,Ys,fe,Uv,KE,u2,d2,Tg,h2,f2,p2,JE,g2,QE,ZE,m2,yi,Ho,y2,v2,eT,b2,wg,tT;const Ch=class Ch{constructor(e,t,n,s,o,l,c,h,f,g,y,b,A,w,x,N){R(this,fe);R(this,qh,new AbortController);R(this,is,null);R(this,$h,null);R(this,nn,new Map);R(this,Tn,new Map);R(this,Yh,null);R(this,Vs,null);R(this,jh,null);R(this,qs,new H8);R(this,si,null);R(this,xl,null);R(this,Cl,null);R(this,Wh,0);R(this,Rl,new Set);R(this,Gr,null);R(this,$s,null);R(this,tu,new Set);ce(this,"_editorUndoBar",null);R(this,hm,!1);R(this,fm,!1);R(this,Xh,!1);R(this,pm,null);R(this,zr,null);R(this,Il,null);R(this,Kh,null);R(this,Nl,!1);R(this,Vr,null);R(this,Kb,new B8);R(this,Ml,!1);R(this,Jh,!1);R(this,gm,!1);R(this,Dl,null);R(this,nu,null);R(this,Qh,null);R(this,kl,null);R(this,mm,null);R(this,bn,Ue.NONE);R(this,bt,new Set);R(this,$o,null);R(this,Pl,null);R(this,Ll,null);R(this,ym,null);R(this,Zh,null);R(this,vm,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});R(this,Ol,[0,0]);R(this,qr,null);R(this,Yo,null);R(this,bm,null);R(this,_m,null);R(this,Ys,null);const I=this._signal=d(this,qh).signal;T(this,Yo,e),T(this,bm,t),T(this,_m,n),T(this,Yh,s),T(this,si,o),T(this,Pl,l),T(this,Zh,h),this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:I}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:I}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:I}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:I}),c._on("setpreference",this.onSetPreference.bind(this),{signal:I}),c._on("switchannotationeditorparams",P=>this.updateParams(P.type,P.value),{signal:I}),window.addEventListener("pointerdown",()=>{T(this,Jh,!0)},{capture:!0,signal:I}),window.addEventListener("pointerup",()=>{T(this,Jh,!1)},{capture:!0,signal:I}),M(this,fe,h2).call(this),M(this,fe,m2).call(this),M(this,fe,JE).call(this),T(this,Vs,h.annotationStorage),T(this,pm,h.filterFactory),T(this,Ll,f),T(this,Kh,g||null),T(this,hm,y),T(this,fm,b),T(this,Xh,A),T(this,mm,w||null),this.viewParameters={realScale:Pa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=N!==!1,o==null||o.setSidebarUiManager(this)}static get _keyboardManager(){const e=Ch.prototype,t=l=>d(l,Yo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return $e(this,"_keyboardManager",new $y([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Yo).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&d(l,Yo).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}destroy(){var e,t,n,s,o,l,c,h,f;(e=d(this,Ys))==null||e.resolve(),T(this,Ys,null),(t=d(this,qh))==null||t.abort(),T(this,qh,null),this._signal=null;for(const g of d(this,Tn).values())g.destroy();d(this,Tn).clear(),d(this,nn).clear(),d(this,tu).clear(),(n=d(this,kl))==null||n.clear(),T(this,is,null),d(this,bt).clear(),d(this,qs).destroy(),(s=d(this,Yh))==null||s.destroy(),(o=d(this,si))==null||o.destroy(),(l=d(this,Pl))==null||l.destroy(),(c=d(this,Vr))==null||c.hide(),T(this,Vr,null),(h=d(this,Qh))==null||h.destroy(),T(this,Qh,null),T(this,$h,null),d(this,zr)&&(clearTimeout(d(this,zr)),T(this,zr,null)),d(this,qr)&&(clearTimeout(d(this,qr)),T(this,qr,null)),(f=this._editorUndoBar)==null||f.destroy(),T(this,Zh,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return d(this,mm)}get useNewAltTextFlow(){return d(this,fm)}get useNewAltTextWhenAddingImage(){return d(this,Xh)}get hcmFilter(){return $e(this,"hcmFilter",d(this,Ll)?d(this,pm).addHCMFilter(d(this,Ll).foreground,d(this,Ll).background):"none")}get direction(){return $e(this,"direction",getComputedStyle(d(this,Yo)).direction)}get _highlightColors(){return $e(this,"_highlightColors",d(this,Kh)?new Map(d(this,Kh).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return $e(this,"highlightColors",null);const t=new Map,n=!!d(this,Ll);for(const[s,o]of e){const l=s.endsWith("_HCM");if(n&&l){t.set(s.replace("_HCM",""),o);continue}!n&&!l&&t.set(s,o)}return $e(this,"highlightColors",t)}get highlightColorNames(){return $e(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),T(this,Cl,e)}setMainHighlightColorPicker(e){T(this,Qh,e)}editAltText(e,t=!1){var n;(n=d(this,Yh))==null||n.editAltText(this,e,t)}hasCommentManager(){return!!d(this,si)}editComment(e,t,n,s){var o;(o=d(this,si))==null||o.showDialog(this,e,t,n,s)}selectComment(e,t){const n=d(this,Tn).get(e),s=n==null?void 0:n.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=d(this,si))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=d(this,si))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=d(this,si))==null||t.removeComments([e.uid])}toggleComment(e,t,n=void 0){var s;(s=d(this,si))==null||s.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){var n;return e&&((n=d(this,si))==null?void 0:n.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=d(this,si))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(d(this,Tn).has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){var t;(t=d(this,Pl))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return d(this,Pl)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":T(this,Xh,t);break}}onPageChanging({pageNumber:e}){T(this,Wh,e-1)}focusMainContainer(){d(this,Yo).focus()}findParent(e,t){for(const n of d(this,Tn).values()){const{x:s,y:o,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){d(this,bm).classList.toggle("noUserSelect",e)}addShouldRescale(e){d(this,tu).add(e)}removeShouldRescale(e){d(this,tu).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Pa.PDF_TO_CSS_UNITS;for(const n of d(this,tu))n.onScaleChanging();(t=d(this,Cl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c}=n,h=n.toString(),g=M(this,fe,Uv).call(this,n).closest(".textLayer"),y=this.getSelectionBoxes(g);if(!y)return;n.empty();const b=M(this,fe,KE).call(this,g),A=d(this,bn)===Ue.NONE,w=()=>{const x=b==null?void 0:b.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:y,anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c,text:h});A&&this.showAllEditors("highlight",!0,!0),t&&(x==null||x.editComment())};if(A){this.switchToMode(Ue.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!d(this,Vs))return null;const t=`${Kg}${e}`,n=d(this,Vs).getRawValue(t);return n&&d(this,Vs).remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&d(this,Vs)&&!d(this,Vs).has(e.id)&&d(this,Vs).setValue(e.id,e)}a11yAlert(e,t=null){const n=d(this,_m);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,d(this,Nl)&&(T(this,Nl,!1),M(this,fe,Tg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of d(this,bt))if(t.div.contains(e)){T(this,nu,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!d(this,nu))return;const[e,t]=d(this,nu);T(this,nu,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){M(this,fe,JE).call(this),M(this,fe,QE).call(this)}removeEditListeners(){M(this,fe,g2).call(this),M(this,fe,ZE).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of d(this,$s))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of d(this,$s))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=d(this,is))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of d(this,bt)){const o=s.serialize(!0);o&&t.push(o)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of d(this,$s))if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){Fe(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)M(this,fe,eT).call(this,h);M(this,fe,tT).call(this,o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){Fe(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),d(this,bn)!==Ue.NONE&&!this.isEditorHandlingKeyboard&&Ch._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,d(this,Nl)&&(T(this,Nl,!1),M(this,fe,Tg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(M(this,fe,f2).call(this),M(this,fe,QE).call(this),M(this,fe,yi).call(this,{isEditing:d(this,bn)!==Ue.NONE,isEmpty:M(this,fe,wg).call(this),hasSomethingToUndo:d(this,qs).hasSomethingToUndo(),hasSomethingToRedo:d(this,qs).hasSomethingToRedo(),hasSelectedEditor:!1})):(M(this,fe,p2).call(this),M(this,fe,ZE).call(this),M(this,fe,yi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!d(this,$s)){T(this,$s,e);for(const t of d(this,$s))M(this,fe,Ho).call(this,t.defaultPropertiesToUpdate)}}getId(){return d(this,Kb).id}get currentLayer(){return d(this,Tn).get(d(this,Wh))}getLayer(e){return d(this,Tn).get(e)}get currentPageIndex(){return d(this,Wh)}addLayer(e){d(this,Tn).set(e.pageIndex,e),d(this,Ml)?e.enable():e.disable()}removeLayer(e){d(this,Tn).delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){var l,c,h,f,g,y;if(d(this,bn)!==e&&!(d(this,Ys)&&(await d(this,Ys).promise,!d(this,Ys)))){if(T(this,Ys,Promise.withResolvers()),(l=d(this,Cl))==null||l.commitOrRemove(),d(this,bn)===Ue.POPUP&&((c=d(this,si))==null||c.hideSidebar()),(h=d(this,si))==null||h.destroyPopup(),T(this,bn,e),e===Ue.NONE){this.setEditingState(!1),M(this,fe,v2).call(this);for(const b of d(this,nn).values())b.hideStandaloneCommentButton();(f=this._editorUndoBar)==null||f.hide(),this.toggleComment(null),d(this,Ys).resolve();return}for(const b of d(this,nn).values())b.addStandaloneCommentButton();e===Ue.SIGNATURE&&await((g=d(this,Pl))==null?void 0:g.loadSignatures()),this.setEditingState(!0),await M(this,fe,y2).call(this),this.unselectAll();for(const b of d(this,Tn).values())b.updateMode(e);if(e===Ue.POPUP){d(this,$h)||T(this,$h,await d(this,Zh).getAnnotationsByType(new Set(d(this,$s).map(w=>w._editorType))));const b=new Set,A=[];for(const w of d(this,nn).values()){const{annotationElementId:x,hasComment:N,deleted:I}=w;x&&b.add(x),N&&!I&&A.push(w.getData())}for(const w of d(this,$h)){const{id:x,popupRef:N,contentsObj:I}=w;N&&(I!=null&&I.str)&&!b.has(x)&&!d(this,Rl).has(x)&&A.push(w)}(y=d(this,si))==null||y.showSidebar(A)}if(!t){n&&this.addNewEditorFromKeyboard(),d(this,Ys).resolve();return}for(const b of d(this,nn).values())b.uid===t?(this.setSelected(b),o?b.editComment():s?b.enterInEditMode():b.focus()):b.unselect();d(this,Ys).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==d(this,bn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(d(this,$s)){switch(e){case it.CREATE:this.currentLayer.addNewEditor(t);return;case it.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d(this,ym)||T(this,ym,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of d(this,bt))n.updateParams(e,t);else for(const n of d(this,$s))n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var o;for(const l of d(this,nn).values())l.editorType===e&&l.show(t);(((o=d(this,ym))==null?void 0:o.get(it.HIGHLIGHT_SHOW_ALL))??!0)!==t&&M(this,fe,Ho).call(this,[[it.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(d(this,gm)!==e){T(this,gm,e);for(const t of d(this,Tn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of d(this,nn).values())t.pageIndex===e&&(yield t)}getEditor(e){return d(this,nn).get(e)}addEditor(e){d(this,nn).set(e.id,e)}removeEditor(e){var t,n;e.div.contains(document.activeElement)&&(d(this,zr)&&clearTimeout(d(this,zr)),T(this,zr,setTimeout(()=>{this.focusMainContainer(),T(this,zr,null)},0))),d(this,nn).delete(e.id),e.annotationElementId&&((t=d(this,kl))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!d(this,Rl).has(e.annotationElementId))&&((n=d(this,Vs))==null||n.remove(e.id))}addDeletedAnnotationElement(e){d(this,Rl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return d(this,Rl).has(e)}removeDeletedAnnotationElement(e){d(this,Rl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){d(this,is)!==e&&(T(this,is,e),e&&M(this,fe,Ho).call(this,e.propertiesToUpdate))}updateUI(e){d(this,fe,b2)===e&&M(this,fe,Ho).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){M(this,fe,Ho).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(d(this,bt).has(e)){d(this,bt).delete(e),e.unselect(),M(this,fe,yi).call(this,{hasSelectedEditor:this.hasSelection});return}d(this,bt).add(e),e.select(),M(this,fe,Ho).call(this,e.propertiesToUpdate),M(this,fe,yi).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=d(this,Cl))==null||t.commitOrRemove();for(const n of d(this,bt))n!==e&&n.unselect();d(this,bt).clear(),d(this,bt).add(e),e.select(),M(this,fe,Ho).call(this,e.propertiesToUpdate),M(this,fe,yi).call(this,{hasSelectedEditor:!0})}isSelected(e){return d(this,bt).has(e)}get firstSelectedEditor(){return d(this,bt).values().next().value}unselect(e){e.unselect(),d(this,bt).delete(e),M(this,fe,yi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return d(this,bt).size!==0}get isEnterHandled(){return d(this,bt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;d(this,qs).undo(),M(this,fe,yi).call(this,{hasSomethingToUndo:d(this,qs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:M(this,fe,wg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){d(this,qs).redo(),M(this,fe,yi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(this,qs).hasSomethingToRedo(),isEmpty:M(this,fe,wg).call(this)})}addCommands(e){d(this,qs).add(e),M(this,fe,yi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:M(this,fe,wg).call(this)})}cleanUndoStack(e){d(this,qs).cleanType(e)}delete(){var o;this.commitOrRemove();const e=(o=this.currentLayer)==null?void 0:o.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...d(this,bt)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(s,t.length===1?t[0].editorType:t.length);for(const c of t)c.remove()},s=()=>{for(const l of t)M(this,fe,eT).call(this,l)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=d(this,is))==null||e.commitOrRemove()}hasSomethingToControl(){return d(this,is)||this.hasSelection}selectAll(){for(const e of d(this,bt))e.commit();M(this,fe,tT).call(this,d(this,nn).values())}unselectAll(){var e;if(!(d(this,is)&&(d(this,is).commitOrRemove(),d(this,bn)!==Ue.NONE))&&!((e=d(this,Cl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of d(this,bt))t.unselect();d(this,bt).clear(),M(this,fe,yi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;d(this,Ol)[0]+=e,d(this,Ol)[1]+=t;const[s,o]=d(this,Ol),l=[...d(this,bt)],c=1e3;d(this,qr)&&clearTimeout(d(this,qr)),T(this,qr,setTimeout(()=>{T(this,qr,null),d(this,Ol)[0]=d(this,Ol)[1]=0,this.addCommands({cmd:()=>{for(const h of l)d(this,nn).has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of l)d(this,nn).has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c));for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,Gr,new Map);for(const e of d(this,bt))d(this,Gr).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!d(this,Gr))return!1;this.disableUserSelect(!1);const e=d(this,Gr);T(this,Gr,null);let t=!1;for(const[{x:s,y:o,pageIndex:l},c]of e)c.newX=s,c.newY=o,c.newPageIndex=l,t||(t=s!==c.savedX||o!==c.savedY||l!==c.savedPageIndex);if(!t)return!1;const n=(s,o,l,c)=>{if(d(this,nn).has(s.id)){const h=d(this,Tn).get(c);h?s._setParentAndPosition(h,o,l):(s.pageIndex=c,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:c}]of e)n(s,o,l,c)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:c}]of e)n(s,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(d(this,Gr))for(const n of d(this,Gr).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||d(this,bt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return d(this,is)===e}getActive(){return d(this,is)}getMode(){return d(this,bn)}isEditingMode(){return d(this,bn)!==Ue.NONE}get imageManager(){return $e(this,"imageManager",new WE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,g=t.rangeCount;f<g;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,g,y,b)=>({x:(g-s)/l,y:1-(f+y-n)/o,width:b/l,height:y/o});break;case"180":c=(f,g,y,b)=>({x:1-(f+y-n)/o,y:1-(g+b-s)/l,width:y/o,height:b/l});break;case"270":c=(f,g,y,b)=>({x:1-(g+b-s)/l,y:(f-n)/o,width:b/l,height:y/o});break;default:c=(f,g,y,b)=>({x:(f-n)/o,y:(g-s)/l,width:y/o,height:b/l});break}const h=[];for(let f=0,g=t.rangeCount;f<g;f++){const y=t.getRangeAt(f);if(!y.collapsed)for(const{x:b,y:A,width:w,height:x}of y.getClientRects())w===0||x===0||h.push(c(b,A,w,x))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(d(this,jh)||T(this,jh,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=d(this,jh))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=d(this,jh))==null?void 0:s.get(e.data.id);if(!t)return;const n=d(this,Vs).getRawValue(t);n&&(d(this,bn)===Ue.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){var o;const s=(o=d(this,kl))==null?void 0:o.get(e);s&&(s.setCanvas(t,n),d(this,kl).delete(e))}addMissingCanvas(e,t){(d(this,kl)||T(this,kl,new Map)).set(e,t)}};qh=new WeakMap,is=new WeakMap,$h=new WeakMap,nn=new WeakMap,Tn=new WeakMap,Yh=new WeakMap,Vs=new WeakMap,jh=new WeakMap,qs=new WeakMap,si=new WeakMap,xl=new WeakMap,Cl=new WeakMap,Wh=new WeakMap,Rl=new WeakMap,Gr=new WeakMap,$s=new WeakMap,tu=new WeakMap,hm=new WeakMap,fm=new WeakMap,Xh=new WeakMap,pm=new WeakMap,zr=new WeakMap,Il=new WeakMap,Kh=new WeakMap,Nl=new WeakMap,Vr=new WeakMap,Kb=new WeakMap,Ml=new WeakMap,Jh=new WeakMap,gm=new WeakMap,Dl=new WeakMap,nu=new WeakMap,Qh=new WeakMap,kl=new WeakMap,mm=new WeakMap,bn=new WeakMap,bt=new WeakMap,$o=new WeakMap,Pl=new WeakMap,Ll=new WeakMap,ym=new WeakMap,Zh=new WeakMap,vm=new WeakMap,Ol=new WeakMap,qr=new WeakMap,Yo=new WeakMap,bm=new WeakMap,_m=new WeakMap,Ys=new WeakMap,fe=new WeakSet,Uv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},KE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of d(this,Tn).values())if(n.hasTextLayer(e))return n;return null},u2=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=M(this,fe,Uv).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(d(this,Vr)||T(this,Vr,new F8(this)),d(this,Vr).show(n,s,this.direction==="ltr"))},d2=function(){var o,l,c;const e=document.getSelection();if(!e||e.isCollapsed){d(this,$o)&&((o=d(this,Vr))==null||o.hide(),T(this,$o,null),M(this,fe,yi).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===d(this,$o))return;const s=M(this,fe,Uv).call(this,e).closest(".textLayer");if(!s){d(this,$o)&&((l=d(this,Vr))==null||l.hide(),T(this,$o,null),M(this,fe,yi).call(this,{hasSelectedText:!1}));return}if((c=d(this,Vr))==null||c.hide(),T(this,$o,t),M(this,fe,yi).call(this,{hasSelectedText:!0}),!(d(this,bn)!==Ue.HIGHLIGHT&&d(this,bn)!==Ue.NONE)&&(d(this,bn)===Ue.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,Nl,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=d(this,bn)===Ue.HIGHLIGHT?M(this,fe,KE).call(this,s):null;if(h==null||h.toggleDrawing(),d(this,Jh)){const f=new AbortController,g=this.combinedSignal(f),y=b=>{b.type==="pointerup"&&b.button!==0||(f.abort(),h==null||h.toggleDrawing(!0),b.type==="pointerup"&&M(this,fe,Tg).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:g}),window.addEventListener("blur",y,{signal:g})}else h==null||h.toggleDrawing(!0),M(this,fe,Tg).call(this,"main_toolbar")}},Tg=function(e=""){d(this,bn)===Ue.HIGHLIGHT?this.highlightSelection(e):d(this,hm)&&M(this,fe,u2).call(this)},h2=function(){document.addEventListener("selectionchange",M(this,fe,d2).bind(this),{signal:this._signal})},f2=function(){if(d(this,Il))return;T(this,Il,new AbortController);const e=this.combinedSignal(d(this,Il));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},p2=function(){var e;(e=d(this,Il))==null||e.abort(),T(this,Il,null)},JE=function(){if(d(this,Dl))return;T(this,Dl,new AbortController);const e=this.combinedSignal(d(this,Dl));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},g2=function(){var e;(e=d(this,Dl))==null||e.abort(),T(this,Dl,null)},QE=function(){if(d(this,xl))return;T(this,xl,new AbortController);const e=this.combinedSignal(d(this,xl));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ZE=function(){var e;(e=d(this,xl))==null||e.abort(),T(this,xl,null)},m2=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},yi=function(e){Object.entries(e).some(([n,s])=>d(this,vm)[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(this,vm),e)}),d(this,bn)===Ue.HIGHLIGHT&&e.hasSelectedEditor===!1&&M(this,fe,Ho).call(this,[[it.HIGHLIGHT_FREE,!0]]))},Ho=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},y2=async function(){if(!d(this,Ml)){T(this,Ml,!0);const e=[];for(const t of d(this,Tn).values())e.push(t.enable());await Promise.all(e);for(const t of d(this,nn).values())t.enable()}},v2=function(){if(this.unselectAll(),d(this,Ml)){T(this,Ml,!1);for(const e of d(this,Tn).values())e.disable();for(const e of d(this,nn).values())e.disable()}},eT=function(e){const t=d(this,Tn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},b2=function(){let e=null;for(e of d(this,bt));return e},wg=function(){if(d(this,nn).size===0)return!0;if(d(this,nn).size===1)for(const e of d(this,nn).values())return e.isEmpty();return!1},tT=function(e){for(const t of d(this,bt))t.unselect();d(this,bt).clear();for(const t of e)t.isEmpty()||(d(this,bt).add(t),t.select());M(this,fe,yi).call(this,{hasSelectedEditor:this.hasSelection})},ce(Ch,"TRANSLATE_SMALL",1),ce(Ch,"TRANSLATE_BIG",10);let bc=Ch;var In,$r,cr,ef,Yr,ss,tf,jr,Bi,jo,iu,Wr,Ul,Er,xg,Fv;const vi=class vi{constructor(e){R(this,Er);R(this,In,null);R(this,$r,!1);R(this,cr,null);R(this,ef,null);R(this,Yr,null);R(this,ss,null);R(this,tf,!1);R(this,jr,null);R(this,Bi,null);R(this,jo,null);R(this,iu,null);R(this,Wr,!1);T(this,Bi,e),T(this,Wr,e._uiManager.useNewAltTextFlow),d(vi,Ul)||T(vi,Ul,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){vi._l10n??(vi._l10n=e)}async render(){const e=T(this,cr,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=T(this,ef,document.createElement("span"));e.append(t),d(this,Wr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",d(vi,Ul).missing),t.setAttribute("data-l10n-id",d(vi,Ul)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=d(this,Bi)._uiManager._signal;e.addEventListener("contextmenu",xs,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),d(this,Bi)._uiManager.editAltText(d(this,Bi)),d(this,Wr)&&d(this,Bi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:d(this,Er,xg)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(T(this,tf,!0),s(o))},{signal:n}),await M(this,Er,Fv).call(this),e}finish(){d(this,cr)&&(d(this,cr).focus({focusVisible:d(this,tf)}),T(this,tf,!1))}isEmpty(){return d(this,Wr)?d(this,In)===null:!d(this,In)&&!d(this,$r)}hasData(){return d(this,Wr)?d(this,In)!==null||!!d(this,jo):this.isEmpty()}get guessedText(){return d(this,jo)}async setGuessedText(e){d(this,In)===null&&(T(this,jo,e),T(this,iu,await vi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),M(this,Er,Fv).call(this))}toggleAltTextBadge(e=!1){var t;if(!d(this,Wr)||d(this,In)){(t=d(this,jr))==null||t.remove(),T(this,jr,null);return}if(!d(this,jr)){const n=T(this,jr,document.createElement("div"));n.className="noAltTextBadge",d(this,Bi).div.append(n)}d(this,jr).classList.toggle("hidden",!e)}serialize(e){let t=d(this,In);return!e&&d(this,jo)===t&&(t=d(this,iu)),{altText:t,decorative:d(this,$r),guessedText:d(this,jo),textWithDisclaimer:d(this,iu)}}get data(){return{altText:d(this,In),decorative:d(this,$r)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(T(this,jo,n),T(this,iu,s)),!(d(this,In)===e&&d(this,$r)===t)&&(o||(T(this,In,e),T(this,$r,t)),M(this,Er,Fv).call(this))}toggle(e=!1){d(this,cr)&&(!e&&d(this,ss)&&(clearTimeout(d(this,ss)),T(this,ss,null)),d(this,cr).disabled=!e)}shown(){d(this,Bi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:d(this,Er,xg)}})}destroy(){var e,t;(e=d(this,cr))==null||e.remove(),T(this,cr,null),T(this,ef,null),T(this,Yr,null),(t=d(this,jr))==null||t.remove(),T(this,jr,null)}};In=new WeakMap,$r=new WeakMap,cr=new WeakMap,ef=new WeakMap,Yr=new WeakMap,ss=new WeakMap,tf=new WeakMap,jr=new WeakMap,Bi=new WeakMap,jo=new WeakMap,iu=new WeakMap,Wr=new WeakMap,Ul=new WeakMap,Er=new WeakSet,xg=function(){return d(this,In)&&"added"||d(this,In)===null&&this.guessedText&&"review"||"missing"},Fv=async function(){var s,o,l;const e=d(this,cr);if(!e)return;if(d(this,Wr)){if(e.classList.toggle("done",!!d(this,In)),e.setAttribute("data-l10n-id",d(vi,Ul)[d(this,Er,xg)]),(s=d(this,ef))==null||s.setAttribute("data-l10n-id",d(vi,Ul)[`${d(this,Er,xg)}-label`]),!d(this,In)){(o=d(this,Yr))==null||o.remove();return}}else{if(!d(this,In)&&!d(this,$r)){e.classList.remove("done"),(l=d(this,Yr))==null||l.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=d(this,Yr);if(!t){T(this,Yr,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${d(this,Bi).id}`;const c=100,h=d(this,Bi)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(d(this,ss)),T(this,ss,null)},{once:!0}),e.addEventListener("mouseenter",()=>{T(this,ss,setTimeout(()=>{T(this,ss,null),d(this,Yr).classList.add("show"),d(this,Bi)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:h}),e.addEventListener("mouseleave",()=>{var f;d(this,ss)&&(clearTimeout(d(this,ss)),T(this,ss,null)),(f=d(this,Yr))==null||f.classList.remove("show")},{signal:h})}d(this,$r)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=d(this,In)),t.parentNode||e.append(t);const n=d(this,Bi).getElementForAltText();n==null||n.setAttribute("aria-describedby",t.id)},R(vi,Ul,null),ce(vi,"_l10n",null);let Cb=vi;var $n,js,su,Ot,Sm,ru,ur,ou,au,lu,Am,nT;class Av{constructor(e){R(this,Am);R(this,$n,null);R(this,js,null);R(this,su,!1);R(this,Ot,null);R(this,Sm,null);R(this,ru,null);R(this,ur,null);R(this,ou,null);R(this,au,!1);R(this,lu,null);T(this,Ot,e)}renderForToolbar(){const e=T(this,js,document.createElement("button"));return e.className="comment",M(this,Am,nT).call(this,e,!1)}renderForStandalone(){const e=T(this,$n,document.createElement("button"));e.className="annotationCommentButton";const t=d(this,Ot).commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(d(this,Ot)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=d(this,Ot).commentButtonColor;s&&(n.backgroundColor=s)}return M(this,Am,nT).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=d(this,$n)??d(this,js))==null||e.focus()},0)}onUpdatedColor(){if(!d(this,$n))return;const e=d(this,Ot).commentButtonColor;e&&(d(this,$n).style.backgroundColor=e),d(this,Ot)._uiManager.updatePopupColor(d(this,Ot))}get commentButtonWidth(){var e;return(((e=d(this,$n))==null?void 0:e.getBoundingClientRect().width)??0)/d(this,Ot).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(d(this,lu))return d(this,lu);if(!d(this,$n))return null;const{x:e,y:t,height:n}=d(this,$n).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,Ot).parent.boundingClientRect;return[(e-s)/l,(t+n-o)/c]}set commentPopupPositionInLayer(e){T(this,lu,e)}hasDefaultPopupPosition(){return d(this,lu)===null}removeStandaloneCommentButton(){var e;(e=d(this,$n))==null||e.remove(),T(this,$n,null)}removeToolbarCommentButton(){var e;(e=d(this,js))==null||e.remove(),T(this,js,null)}setCommentButtonStates({selected:e,hasPopup:t}){d(this,$n)&&(d(this,$n).classList.toggle("selected",e),d(this,$n).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=d(this,Ot).commentButtonPosition;const{width:g,height:y,x:b,y:A}=d(this,Ot);n=b+n*g,s=A+s*y}const o=d(this,Ot).parent.boundingClientRect,{x:l,y:c,width:h,height:f}=o;d(this,Ot)._uiManager.editComment(d(this,Ot),l+n*h,c+s*f,{...e,parentDimensions:o})}finish(){d(this,js)&&(d(this,js).focus({focusVisible:d(this,su)}),T(this,su,!1))}isDeleted(){return d(this,au)||d(this,ur)===""}isEmpty(){return d(this,ur)===null}hasBeenEdited(){return this.isDeleted()||d(this,ur)!==d(this,Sm)}serialize(){return this.data}get data(){return{text:d(this,ur),richText:d(this,ru),date:d(this,ou),deleted:this.isDeleted()}}set data(e){if(e!==d(this,ur)&&T(this,ru,null),e===null){T(this,ur,""),T(this,au,!0);return}T(this,ur,e),T(this,ou,new Date),T(this,au,!1)}setInitialText(e,t=null){T(this,Sm,e),this.data=e,T(this,ou,null),T(this,ru,t)}shown(){}destroy(){var e,t;(e=d(this,js))==null||e.remove(),T(this,js,null),(t=d(this,$n))==null||t.remove(),T(this,$n,null),T(this,ur,""),T(this,ru,null),T(this,ou,null),T(this,Ot,null),T(this,su,!1),T(this,au,!1)}}$n=new WeakMap,js=new WeakMap,su=new WeakMap,Ot=new WeakMap,Sm=new WeakMap,ru=new WeakMap,ur=new WeakMap,ou=new WeakMap,au=new WeakMap,lu=new WeakMap,Am=new WeakSet,nT=function(e,t){if(!d(this,Ot)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[d(this,Ot)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=d(this,Ot)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",xs,{signal:n}),t&&(e.addEventListener("focusin",o=>{d(this,Ot)._focusEventsAllowed=!1,Jt(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{d(this,Ot)._focusEventsAllowed=!0,Jt(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===d(this,js)?this.edit():d(this,Ot).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(T(this,su,!0),s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{d(this,Ot).toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{d(this,Ot).toggleComment(!1,!1)},{signal:n}),e};var nf,cu,Em,Tm,wm,xm,Cm,Wo,uu,Xo,du,Ko,_c,_2,S2,A2;const Nx=class Nx{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){R(this,_c);R(this,nf);R(this,cu,!1);R(this,Em,null);R(this,Tm);R(this,wm);R(this,xm);R(this,Cm);R(this,Wo,null);R(this,uu);R(this,Xo,null);R(this,du);R(this,Ko,null);T(this,nf,e),T(this,Em,n),T(this,Tm,t),T(this,wm,s),T(this,xm,o),T(this,Cm,l),T(this,du,new AbortController),T(this,uu,AbortSignal.any([c,d(this,du).signal])),e.addEventListener("touchstart",M(this,_c,_2).bind(this),{passive:!1,signal:d(this,uu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/xr.pixelRatio}destroy(){var e,t;(e=d(this,du))==null||e.abort(),T(this,du,null),(t=d(this,Wo))==null||t.abort(),T(this,Wo,null)}};nf=new WeakMap,cu=new WeakMap,Em=new WeakMap,Tm=new WeakMap,wm=new WeakMap,xm=new WeakMap,Cm=new WeakMap,Wo=new WeakMap,uu=new WeakMap,Xo=new WeakMap,du=new WeakMap,Ko=new WeakMap,_c=new WeakSet,_2=function(e){var s,o,l;if((s=d(this,Tm))!=null&&s.call(this))return;if(e.touches.length===1){if(d(this,Wo))return;const c=T(this,Wo,new AbortController),h=AbortSignal.any([d(this,uu),c.signal]),f=d(this,nf),g={capture:!0,signal:h,passive:!1},y=b=>{var A;b.pointerType==="touch"&&((A=d(this,Wo))==null||A.abort(),T(this,Wo,null))};f.addEventListener("pointerdown",b=>{b.pointerType==="touch"&&(Jt(b),y(b))},g),f.addEventListener("pointerup",y,g),f.addEventListener("pointercancel",y,g);return}if(!d(this,Ko)){T(this,Ko,new AbortController);const c=AbortSignal.any([d(this,uu),d(this,Ko).signal]),h=d(this,nf),f={signal:c,capture:!1,passive:!1};h.addEventListener("touchmove",M(this,_c,S2).bind(this),f);const g=M(this,_c,A2).bind(this);h.addEventListener("touchend",g,f),h.addEventListener("touchcancel",g,f),f.capture=!0,h.addEventListener("pointerdown",Jt,f),h.addEventListener("pointermove",Jt,f),h.addEventListener("pointercancel",Jt,f),h.addEventListener("pointerup",Jt,f),(o=d(this,wm))==null||o.call(this)}if(Jt(e),e.touches.length!==2||(l=d(this,Em))!=null&&l.call(this)){T(this,Xo,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),T(this,Xo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},S2=function(e){var L;if(!d(this,Xo)||e.touches.length!==2)return;Jt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:l,screenY:c}=n,h=d(this,Xo),{touch0X:f,touch0Y:g,touch1X:y,touch1Y:b}=h,A=y-f,w=b-g,x=l-s,N=c-o,I=Math.hypot(x,N)||1,P=Math.hypot(A,w)||1;if(!d(this,cu)&&Math.abs(P-I)<=Nx.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,!d(this,cu)){T(this,cu,!0);return}const k=[(s+l)/2,(o+c)/2];(L=d(this,xm))==null||L.call(this,k,P,I)},A2=function(e){var t;e.touches.length>=2||(d(this,Ko)&&(d(this,Ko).abort(),T(this,Ko,null),(t=d(this,Cm))==null||t.call(this)),d(this,Xo)&&(Jt(e),T(this,Xo,null),T(this,cu,!1)))};let em=Nx;var hu,dr,Yt,Nt,Jo,sf,Fl,Rm,Yn,fu,Qo,Xr,Bl,Im,pu,rs,Nm,gu,Zo,Kr,rf,of,Ws,mu,Mm,Jb,Ne,iT,Dm,sT,Bv,E2,T2,rT,Hv,oT,w2,x2,C2,aT,R2,lT,I2,N2,M2,cT,Cg;const He=class He{constructor(e){R(this,Ne);R(this,hu,null);R(this,dr,null);R(this,Yt,null);R(this,Nt,null);R(this,Jo,null);R(this,sf,!1);R(this,Fl,null);R(this,Rm,"");R(this,Yn,null);R(this,fu,null);R(this,Qo,null);R(this,Xr,null);R(this,Bl,null);R(this,Im,"");R(this,pu,!1);R(this,rs,null);R(this,Nm,!1);R(this,gu,!1);R(this,Zo,!1);R(this,Kr,null);R(this,rf,0);R(this,of,0);R(this,Ws,null);R(this,mu,null);ce(this,"isSelected",!1);ce(this,"_isCopy",!1);ce(this,"_editToolbar",null);ce(this,"_initialOptions",Object.create(null));ce(this,"_initialData",null);ce(this,"_isVisible",!0);ce(this,"_uiManager",null);ce(this,"_focusEventsAllowed",!0);R(this,Mm,!1);R(this,Jb,He._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=He.prototype._resizeWithKeyboard,t=bc.TRANSLATE_SMALL,n=bc.TRANSLATE_BIG;return $e(this,"_resizerKeyboardManager",new $y([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],He.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return $e(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new G8({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(He._l10n??(He._l10n=e),He._l10nResizer||(He._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),He._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);He._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Lt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return d(this,Mm)}set _isDraggable(e){var t;T(this,Mm,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=d(this,Jb)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(M(this,Ne,Cg).call(this),(t=d(this,Xr))==null||t.remove(),T(this,Xr,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(d(this,pu)?T(this,pu,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}translate(e,t){M(this,Ne,iT).call(this,this.parentDimensions,e,t)}translateInPage(e,t){d(this,rs)||T(this,rs,[this.x,this.y,this.width,this.height]),M(this,Ne,iT).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){d(this,rs)||T(this,rs,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!d(this,rs)&&(d(this,rs)[0]!==this.x||d(this,rs)[1]!==this.y)}get _hasBeenResized(){return!!d(this,rs)&&(d(this,rs)[2]!==this.width||d(this,rs)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=He,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=n,h*=s,o*=n,l*=s,this._mustFixPosition)switch(e){case 0:o=ci(o,0,n-c),l=ci(l,0,s-h);break;case 90:o=ci(o,0,n-h),l=ci(l,c,s);break;case 180:o=ci(o,c,n),l=ci(l,h,s);break;case 270:o=ci(o,h,n),l=ci(l,0,s-c);break}this.x=o/=n,this.y=l/=s;const[f,g]=this.getBaseTranslation();o+=f,l+=g,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return M(n=He,Dm,sT).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return M(n=He,Dm,sT).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=d(this,Yt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||d(this,gu))return this._editToolbar;this._editToolbar=new YE(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=d(this,Yt))==null||t.destroy()}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return d(this,Yt)||(Cb.initialize(He._l10n),T(this,Yt,new Cb(this)),d(this,hu)&&(d(this,Yt).data=d(this,hu),T(this,hu,null))),d(this,Yt)}get altTextData(){var e;return(e=d(this,Yt))==null?void 0:e.data}set altTextData(e){d(this,Yt)&&(d(this,Yt).data=e)}get guessedAltText(){var e;return(e=d(this,Yt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=d(this,Yt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=d(this,Yt))==null?void 0:t.serialize(e)}hasAltText(){return!!d(this,Yt)&&!d(this,Yt).isEmpty()}hasAltTextData(){var e;return((e=d(this,Yt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=d(this,Nt))==null||e.focusButton()}addCommentButton(){return d(this,Nt)||T(this,Nt,new Av(this))}addStandaloneCommentButton(){if(d(this,Jo)){this._uiManager.isEditingMode()&&d(this,Jo).classList.remove("hidden");return}this.hasComment&&(T(this,Jo,d(this,Nt).renderForStandalone()),this.div.append(d(this,Jo)))}removeStandaloneCommentButton(){d(this,Nt).removeStandaloneCommentButton(),T(this,Jo,null)}hideStandaloneCommentButton(){var e;(e=d(this,Jo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=d(this,Nt);return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){d(this,Nt)||T(this,Nt,new Av(this)),d(this,Nt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(d(this,Nt)||T(this,Nt,new Av(this)),d(this,Nt).setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=d(this,Nt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=d(this,Nt))==null?void 0:e.isDeleted()}get hasComment(){return!!d(this,Nt)&&!d(this,Nt).isEmpty()&&!d(this,Nt).isDeleted()}async editComment(e){d(this,Nt)||T(this,Nt,new Av(this)),d(this,Nt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){d(this,Nt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,c=l+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){d(this,Nt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var l;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=d(this,sf)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),M(this,Ne,lT).call(this);const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),l2(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(d(this,mu)||T(this,mu,new em({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:M(this,Ne,w2).bind(this),onPinching:M(this,Ne,x2).bind(this),onPinchEnd:M(this,Ne,C2).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(l=this._uiManager._editorUndoBar)==null||l.hide(),e}pointerdown(e){const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(T(this,pu,!0),this._isDraggable){M(this,Ne,R2).call(this,e);return}M(this,Ne,aT).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){d(this,Kr)&&clearTimeout(d(this,Kr)),T(this,Kr,setTimeout(()=>{var e;T(this,Kr,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,g=t/s,y=this.x*o,b=this.y*l,A=this.width*o,w=this.height*l;switch(n){case 0:return[y+f+c,l-b-g-w+h,y+f+A+c,l-b-g+h];case 90:return[y+g+c,l-b+f+h,y+g+w+c,l-b+f+A+h];case 180:return[y-f-A+c,l-b+g+h,y-f+c,l-b+g+w+h];case 270:return[y-g-w+c,l-b-f-A+h,y-g+c,l-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,l]=e,c=o-n,h=l-s;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&He._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=d(this,Nt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:l},uid:c,pageIndex:h,creationDate:f,modificationDate:g}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:f,modificationDate:n||g,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),T(this,gu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),T(this,gu,!1),!0):!1}isInEditMode(){return d(this,gu)}shouldGetKeyboardEvents(){return d(this,Zo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return t<l&&s>0&&e<o&&n>0}rebuild(){M(this,Ne,lT).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,T(s,hu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[o,l]=s.pageDimensions,[c,h,f,g]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/o,s.y=h/l,s.width=f/o,s.height=g/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=d(this,Bl))==null||e.abort(),T(this,Bl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(this,Kr)&&(clearTimeout(d(this,Kr)),T(this,Kr,null)),M(this,Ne,Cg).call(this),this.removeEditToolbar(),d(this,Ws)){for(const n of d(this,Ws).values())clearTimeout(n);T(this,Ws,null)}this.parent=null,(t=d(this,mu))==null||t.destroy(),T(this,mu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(M(this,Ne,E2).call(this),d(this,Yn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,l]=this.getPDFRect();return[He._round(n+(o-n)*e),He._round(s+(l-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return d(this,Nt).commentPopupPositionInLayer}set commentPopupPosition(e){d(this,Nt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return d(this,Nt).hasDefaultPopupPosition()}get commentButtonWidth(){return d(this,Nt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){d(this,Nt).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),T(this,Qo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=d(this,Yn).children;if(!d(this,dr)){T(this,dr,Array.from(t));const l=M(this,Ne,I2).bind(this),c=M(this,Ne,N2).bind(this),h=this._uiManager._signal;for(const f of d(this,dr)){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",M(this,Ne,M2).bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",He._l10nResizer[g])}}const n=d(this,dr)[0];let s=0;for(const l of t){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(d(this,dr).length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)d(this,Yn).append(d(this,Yn).firstChild);else if(o>s)for(let c=0;c<o-s;c++)d(this,Yn).firstChild.before(d(this,Yn).lastChild);let l=0;for(const c of t){const f=d(this,dr)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",He._l10nResizer[f])}}M(this,Ne,cT).call(this,0),T(this,Zo,!0),d(this,Yn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){d(this,Zo)&&M(this,Ne,oT).call(this,d(this,Im),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){M(this,Ne,Cg).call(this),this.div.focus()}select(){var e,t,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,o;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((o=this._editToolbar)==null||o.show())});return}(t=this._editToolbar)==null||t.show(),(n=d(this,Yt))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,n,s,o;this.isSelected&&(this.isSelected=!1,(e=d(this,Yn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(o=d(this,Yt))==null||o.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return d(this,Nm)}set isEditing(e){T(this,Nm,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){d(this,Ws)||T(this,Ws,new Map);const{action:n}=e;let s=d(this,Ws).get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),d(this,Ws).delete(n),d(this,Ws).size===0&&T(this,Ws,null)},He._telemetryTimeout),d(this,Ws).set(n,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),T(this,sf,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,sf,!0)}updateFakeAnnotationElement(e){if(!d(this,Xr)&&!this.deleted){T(this,Xr,e.addFakeAnnotation(this));return}if(this.deleted){d(this,Xr).remove(),T(this,Xr,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&d(this,Xr).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};hu=new WeakMap,dr=new WeakMap,Yt=new WeakMap,Nt=new WeakMap,Jo=new WeakMap,sf=new WeakMap,Fl=new WeakMap,Rm=new WeakMap,Yn=new WeakMap,fu=new WeakMap,Qo=new WeakMap,Xr=new WeakMap,Bl=new WeakMap,Im=new WeakMap,pu=new WeakMap,rs=new WeakMap,Nm=new WeakMap,gu=new WeakMap,Zo=new WeakMap,Kr=new WeakMap,rf=new WeakMap,of=new WeakMap,Ws=new WeakMap,mu=new WeakMap,Mm=new WeakMap,Jb=new WeakMap,Ne=new WeakSet,iT=function([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Dm=new WeakSet,sT=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Bv=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},E2=function(){if(d(this,Yn))return;T(this,Yn,document.createElement("div")),d(this,Yn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");d(this,Yn).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",M(this,Ne,T2).bind(this,n),{signal:t}),s.addEventListener("contextmenu",xs,{signal:t}),s.tabIndex=-1}this.div.prepend(d(this,Yn))},T2=function(e,t){var g;t.preventDefault();const{isMac:n}=On.platform;if(t.button!==0||t.ctrlKey&&n)return;(g=d(this,Yt))==null||g.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,T(this,fu,[t.screenX,t.screenY]);const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",M(this,Ne,oT).bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Jt,{passive:!1,signal:l}),window.addEventListener("contextmenu",xs,{signal:l}),T(this,Qo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{var y;o.abort(),this.parent.togglePointerEvents(!0),(y=d(this,Yt))==null||y.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,M(this,Ne,Hv).call(this)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},rT=function(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Hv=function(){if(!d(this,Qo))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=d(this,Qo);T(this,Qo,null);const o=this.x,l=this.y,c=this.width,h=this.height;o===e&&l===t&&c===n&&h===s||this.addCommands({cmd:M(this,Ne,rT).bind(this,o,l,c,h),undo:M(this,Ne,rT).bind(this,e,t,n,s),mustExec:!0})},oT=function(e,t){const[n,s]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=He.MIN_SIZE/n,g=He.MIN_SIZE/s,y=M(this,Ne,Bv).call(this,this.rotation),b=(G,$)=>[y[0]*G+y[2]*$,y[1]*G+y[3]*$],A=M(this,Ne,Bv).call(this,360-this.rotation),w=(G,$)=>[A[0]*G+A[2]*$,A[1]*G+A[3]*$];let x,N,I=!1,P=!1;switch(e){case"topLeft":I=!0,x=(G,$)=>[0,0],N=(G,$)=>[G,$];break;case"topMiddle":x=(G,$)=>[G/2,0],N=(G,$)=>[G/2,$];break;case"topRight":I=!0,x=(G,$)=>[G,0],N=(G,$)=>[0,$];break;case"middleRight":P=!0,x=(G,$)=>[G,$/2],N=(G,$)=>[0,$/2];break;case"bottomRight":I=!0,x=(G,$)=>[G,$],N=(G,$)=>[0,0];break;case"bottomMiddle":x=(G,$)=>[G/2,$],N=(G,$)=>[G/2,0];break;case"bottomLeft":I=!0,x=(G,$)=>[0,$],N=(G,$)=>[G,0];break;case"middleLeft":P=!0,x=(G,$)=>[0,$/2],N=(G,$)=>[G,$/2];break}const k=x(c,h),L=N(c,h);let O=b(...L);const F=He._round(o+O[0]),U=He._round(l+O[1]);let X=1,q=1,Z,ee;if(t.fromKeyboard)({deltaX:Z,deltaY:ee}=t);else{const{screenX:G,screenY:$}=t,[oe,ge]=d(this,fu);[Z,ee]=this.screenToPageTranslation(G-oe,$-ge),d(this,fu)[0]=G,d(this,fu)[1]=$}if([Z,ee]=w(Z/n,ee/s),I){const G=Math.hypot(c,h);X=q=Math.max(Math.min(Math.hypot(L[0]-k[0]-Z,L[1]-k[1]-ee)/G,1/c,1/h),f/c,g/h)}else P?X=ci(Math.abs(L[0]-k[0]-Z),f,1)/c:q=ci(Math.abs(L[1]-k[1]-ee),g,1)/h;const se=He._round(c*X),le=He._round(h*q);O=b(...N(se,le));const ue=F-O[0],ye=U-O[1];d(this,rs)||T(this,rs,[this.x,this.y,this.width,this.height]),this.width=se,this.height=le,this.x=ue,this.y=ye,this.setDims(),this.fixAndSetPosition(),this._onResizing()},w2=function(){var e;T(this,Qo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=d(this,Yt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},x2=function(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const l=M(this,Ne,Bv).call(this,this.rotation),c=(F,U)=>[l[0]*F+l[2]*U,l[1]*F+l[3]*U],[h,f]=this.parentDimensions,g=this.x,y=this.y,b=this.width,A=this.height,w=He.MIN_SIZE/h,x=He.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),w/b,x/A);const N=He._round(b*o),I=He._round(A*o);if(N===b&&I===A)return;d(this,rs)||T(this,rs,[g,y,b,A]);const P=c(b/2,A/2),k=He._round(g+P[0]),L=He._round(y+P[1]),O=c(N/2,I/2);this.x=k-O[0],this.y=L-O[1],this.width=N,this.height=I,this.setDims(),this.fixAndSetPosition(),this._onResizing()},C2=function(){var e;(e=d(this,Yt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),M(this,Ne,Hv).call(this)},aT=function(e){const{isMac:t}=On.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},R2=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),T(this,Fl,null),T(this,pu,!1),this._uiManager.endDragSession()||M(this,Ne,aT).call(this,f),n&&this._onStopDragging()};t&&(T(this,rf,e.clientX),T(this,of,e.clientY),T(this,Fl,e.pointerId),T(this,Rm,e.pointerType),window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:y,pointerId:b}=f;if(b!==d(this,Fl)){Jt(f);return}const[A,w]=this.screenToPageTranslation(g-d(this,rf),y-d(this,of));T(this,rf,g),T(this,of,y),this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",Jt,l),window.addEventListener("pointerdown",f=>{f.pointerType===d(this,Rm)&&(d(this,mu)||f.isPrimary)&&c(f),Jt(f)},l));const h=f=>{if(!d(this,Fl)||d(this,Fl)===f.pointerId){c(f);return}Jt(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})},lT=function(){if(d(this,Bl)||!this.div)return;T(this,Bl,new AbortController);const e=this._uiManager.combinedSignal(d(this,Bl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},I2=function(e){He._resizerKeyboardManager.exec(this,e)},N2=function(e){var t;d(this,Zo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==d(this,Yn)&&M(this,Ne,Cg).call(this)},M2=function(e){T(this,Im,d(this,Zo)?e:"")},cT=function(e){if(d(this,dr))for(const t of d(this,dr))t.tabIndex=e},Cg=function(){T(this,Zo,!1),M(this,Ne,cT).call(this,-1),M(this,Ne,Hv).call(this)},R(He,Dm),ce(He,"_l10n",null),ce(He,"_l10nResizer",null),ce(He,"_borderLineWidth",-1),ce(He,"_colorManager",new XE),ce(He,"_zIndex",1),ce(He,"_telemetryTimeout",1e3);let Ut=He;class G8 extends Ut{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const MM=3285377520,Bs=4294901760,Br=65535;class D2{constructor(e){this.h1=e?e&4294967295:MM,this.h2=e?e&4294967295:MM}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,N=e.length;x<N;x++){const I=e.charCodeAt(x);I<=255?t[n++]=I:(t[n++]=I>>>8,t[n++]=I&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,g=this.h2;const y=3432918353,b=461845907,A=y&Br,w=b&Br;for(let x=0;x<s;x++)x&1?(c=l[x],c=c*y&Bs|c*A&Br,c=c<<15|c>>>17,c=c*b&Bs|c*w&Br,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[x],h=h*y&Bs|h*A&Br,h=h<<15|h>>>17,h=h*b&Bs|h*w&Br,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*y&Bs|c*A&Br,c=c<<15|c>>>17,c=c*b&Bs|c*w&Br,s&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Bs|e*36045&Br,t=t*4283543511&Bs|((t<<16|e>>>16)*2950163797&Bs)>>>16,e^=t>>>1,e=e*444984403&Bs|e*60499&Br,t=t*3301882366&Bs|((t<<16|e>>>16)*3120437893&Bs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const uT=Object.freeze({map:null,hash:"",transfer:void 0});var yu,vu,ea,jn,Qb,k2;class tx{constructor(){R(this,Qb);R(this,yu,!1);R(this,vu,null);R(this,ea,null);R(this,jn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=d(this,jn).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return d(this,jn).get(e)}remove(e){const t=d(this,jn).get(e);if(t!==void 0&&(t instanceof Ut&&d(this,ea).delete(t.annotationElementId),d(this,jn).delete(e),d(this,jn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of d(this,jn).values())if(n instanceof Ut)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=d(this,jn).get(e);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(t))n[o]!==l&&(s=!0,n[o]=l);else s=!0,d(this,jn).set(e,t);s&&M(this,Qb,k2).call(this),t instanceof Ut&&((d(this,ea)||T(this,ea,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return d(this,jn).has(e)}get size(){return d(this,jn).size}resetModified(){d(this,yu)&&(T(this,yu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new P2(this)}get serializable(){if(d(this,jn).size===0)return uT;const e=new Map,t=new D2,n=[],s=Object.create(null);let o=!1;for(const[l,c]of d(this,jn)){const h=c instanceof Ut?c.serialize(!1,s):c;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),o||(o=!!h.bitmap))}if(o)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:uT}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of d(this,jn).values()){if(!(o instanceof Ut)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||(e=Object.create(null));const h=e[c]||(e[c]=new Map);for(const[f,g]of Object.entries(l)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const b=y.get(g)??0;y.set(g,b+1)}}if((s>0||n>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,l]of t)e[o]=l.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){T(this,vu,null)}updateEditor(e,t){var s;const n=(s=d(this,ea))==null?void 0:s.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=d(this,ea))==null?void 0:t.get(e))||null}get modifiedIds(){if(d(this,vu))return d(this,vu);const e=[];if(d(this,ea))for(const t of d(this,ea).values())t.serialize()&&e.push(t.annotationElementId);return T(this,vu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return d(this,jn).entries()}}yu=new WeakMap,vu=new WeakMap,ea=new WeakMap,jn=new WeakMap,Qb=new WeakSet,k2=function(){d(this,yu)||(T(this,yu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var km;class P2 extends tx{constructor(t){super();R(this,km);const{map:n,hash:s,transfer:o}=t.serializable,l=structuredClone(n,o?{transfer:o}:null);T(this,km,{map:l,hash:s,transfer:o})}get print(){Lt("Should not call PrintAnnotationStorage.print")}get serializable(){return d(this,km)}get modifiedIds(){return $e(this,"modifiedIds",{ids:new Set,hash:""})}}km=new WeakMap;var af;class z8{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){R(this,af,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),d(this,af).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||d(this,af).has(e.loadedName))){if(ot(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:l}=e,c=new FontFace(s,o,l);this.addNativeFontFace(c);try{await c.load(),d(this,af).add(s),n==null||n(e)}catch{Fe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Lt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Fe(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return $e(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return $e(this,"isSyncFontLoadingSupported",Ei||On.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ot(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return $e(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(L,O){return L.charCodeAt(O)<<24|L.charCodeAt(O+1)<<16|L.charCodeAt(O+2)<<8|L.charCodeAt(O+3)&255}function s(L,O,F,U){const X=L.substring(0,O),q=L.substring(O+F);return X+U+q}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(L,O){if(++f>30){Fe("Load test font never loaded."),O();return}if(h.font="30px "+L,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,L,O))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=s(b,976,y.length,y);const w=16,x=1482184792;let N=n(b,w);for(o=0,l=y.length-3;o<l;o+=4)N=N-x+n(y,o)|0;o<y.length&&(N=N-x+n(y+"XXX",o)|0),b=s(b,w,4,I8(N));const I=`url(data:font/opentype;base64,${btoa(b)});`,P=`@font-face {font-family:"${y}";src:${I}}`;this.insertRule(P);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const L of[e.loadedName,y]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=L,k.append(O)}this._document.body.append(k),g(y,()=>{k.remove(),t.complete()})}}af=new WeakMap;var Tt;class V8{constructor(e,t=null,n,s){R(this,Tt);this.compiledGlyphs=Object.create(null),T(this,Tt,e),this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Kk(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Fe(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return d(this,Tt).black}get bold(){return d(this,Tt).bold}get disableFontFace(){return d(this,Tt).disableFontFace??!1}get fontExtraProperties(){return d(this,Tt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return d(this,Tt).isInvalidPDFjsFont}get isType3Font(){return d(this,Tt).isType3Font}get italic(){return d(this,Tt).italic}get missingFile(){return d(this,Tt).missingFile}get remeasure(){return d(this,Tt).remeasure}get vertical(){return d(this,Tt).vertical}get ascent(){return d(this,Tt).ascent}get defaultWidth(){return d(this,Tt).defaultWidth}get descent(){return d(this,Tt).descent}get bbox(){return d(this,Tt).bbox}get fontMatrix(){return d(this,Tt).fontMatrix}get fallbackName(){return d(this,Tt).fallbackName}get loadedName(){return d(this,Tt).loadedName}get mimetype(){return d(this,Tt).mimetype}get name(){return d(this,Tt).name}get data(){return d(this,Tt).data}clearData(){d(this,Tt).clearData()}get cssFontInfo(){return d(this,Tt).cssFontInfo}get systemFontInfo(){return d(this,Tt).systemFontInfo}get defaultVMetrics(){return d(this,Tt).defaultVMetrics}}Tt=new WeakMap;function q8(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Ei)return i;const e=URL.parse(i,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function $8(i){if(Ei&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return zy(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ev(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const dT=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,Y8=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",L2=k8.bind(null,dT,Y8);var ta,Zb;class j8{constructor(){R(this,ta,new Map);R(this,Zb,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};d(this,Zb).then(()=>{for(const[s]of d(this,ta))s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:o}=n;if(o.aborted){Fe("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}d(this,ta).set(t,s)}removeEventListener(e,t){const n=d(this,ta).get(t);n==null||n(),d(this,ta).delete(t)}terminate(){for(const[,e]of d(this,ta))e==null||e();d(this,ta).clear()}}ta=new WeakMap,Zb=new WeakMap;const Tv={DATA:1,ERROR:2},vn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function DM(){}function Ui(i){if(i instanceof ka||i instanceof wb||i instanceof TM||i instanceof Jg||i instanceof rE)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||Lt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new ka(i.message);case"InvalidPDFException":return new wb(i.message);case"PasswordException":return new TM(i.message,i.code);case"ResponseException":return new Jg(i.message,i.status,i.missing);case"UnknownErrorException":return new rE(i.message,i.details)}return new rE(i.message,i.toString())}var lf,tr,O2,U2,F2,Gv;class Rg{constructor(e,t,n){R(this,tr);R(this,lf,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",M(this,tr,O2).bind(this),{signal:d(this,lf).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,h.postMessage({sourceName:l,targetName:c,stream:vn.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{ot(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:vn.CANCEL,streamId:o,reason:Ui(f)}),g.promise}},n)}destroy(){var e;(e=d(this,lf))==null||e.abort(),T(this,lf,null)}}lf=new WeakMap,tr=new WeakSet,O2=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){M(this,tr,F2).call(this,e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Tv.DATA)s.resolve(e.data);else if(e.callback===Tv.ERROR)s.reject(Ui(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(l){o.postMessage({sourceName:n,targetName:s,callback:Tv.DATA,callbackId:e.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:s,callback:Tv.ERROR,callbackId:e.callbackId,reason:Ui(l)})});return}if(e.streamId){M(this,tr,U2).call(this,e);return}t(e.data)},U2=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(f,g=1,y){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=g,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:vn.ENQUEUE,streamId:t,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:vn.CLOSE,streamId:t}),delete l.streamSinks[t])},error(f){ot(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:vn.ERROR,streamId:t,reason:Ui(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:vn.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:vn.START_COMPLETE,streamId:t,reason:Ui(f)})})},F2=function(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case vn.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Ui(e.reason));break;case vn.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Ui(e.reason));break;case vn.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:vn.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||DM).then(function(){o.postMessage({sourceName:n,targetName:s,stream:vn.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:vn.PULL_COMPLETE,streamId:t,reason:Ui(f)})});break;case vn.ENQUEUE:if(ot(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case vn.CLOSE:if(ot(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),M(this,tr,Gv).call(this,l,t);break;case vn.ERROR:ot(l,"error should have stream controller"),l.controller.error(Ui(e.reason)),M(this,tr,Gv).call(this,l,t);break;case vn.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Ui(e.reason)),M(this,tr,Gv).call(this,l,t);break;case vn.CANCEL:if(!c)break;const h=Ui(e.reason);Promise.try(c.onCancel||DM,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:vn.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:vn.CANCEL_COMPLETE,streamId:t,reason:Ui(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Gv=async function(e,t){var n,s,o;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(s=e.pullCall)==null?void 0:s.promise,(o=e.cancelCall)==null?void 0:o.promise]),delete this.streamControllers[t]};var Pm;class B2{constructor({enableHWA:e=!1}){R(this,Pm,!1);T(this,Pm,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!d(this,Pm)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Lt("Abstract method `_createCanvas` called.")}}Pm=new WeakMap;class W8 extends B2{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class H2{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Lt("Abstract method `_fetch` called.")}}class kM extends H2{async _fetch(e){const t=await _p(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):zy(t)}}class G2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}var bu,cf,na,ia,ri,_u,Su,me,ni,Ig,yh,zv,vh,z2,hT,bh,Ng,Mg,fT,Dg;class X8 extends G2{constructor({docId:t,ownerDocument:n=globalThis.document}){super();R(this,me);R(this,bu);R(this,cf);R(this,na);R(this,ia);R(this,ri);R(this,_u);R(this,Su,0);T(this,ia,t),T(this,ri,n)}addFilter(t){if(!t)return"none";let n=d(this,me,ni).get(t);if(n)return n;const[s,o,l]=M(this,me,zv).call(this,t),c=t.length===1?s:`${s}${o}${l}`;if(n=d(this,me,ni).get(c),n)return d(this,me,ni).set(t,n),n;const h=`g_${d(this,ia)}_transfer_map_${An(this,Su)._++}`,f=M(this,me,vh).call(this,h);d(this,me,ni).set(t,f),d(this,me,ni).set(c,f);const g=M(this,me,bh).call(this,h);return M(this,me,Mg).call(this,s,o,l,g),f}addHCMFilter(t,n){var w;const s=`${t}-${n}`,o="base";let l=d(this,me,Ig).get(o);if((l==null?void 0:l.key)===s||(l?((w=l.filter)==null||w.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},d(this,me,Ig).set(o,l)),!t||!n))return l.url;const c=M(this,me,Dg).call(this,t);t=be.makeHexColor(...c);const h=M(this,me,Dg).call(this,n);if(n=be.makeHexColor(...h),d(this,me,yh).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return l.url;const f=new Array(256);for(let x=0;x<=255;x++){const N=x/255;f[x]=N<=.03928?N/12.92:((N+.055)/1.055)**2.4}const g=f.join(","),y=`g_${d(this,ia)}_hcm_filter`,b=l.filter=M(this,me,bh).call(this,y);M(this,me,Mg).call(this,g,g,g,b),M(this,me,hT).call(this,b);const A=(x,N)=>{const I=c[x]/255,P=h[x]/255,k=new Array(N+1);for(let L=0;L<=N;L++)k[L]=I+L/N*(P-I);return k.join(",")};return M(this,me,Mg).call(this,A(0,5),A(1,5),A(2,5),b),l.url=M(this,me,vh).call(this,y),l.url}addAlphaFilter(t){let n=d(this,me,ni).get(t);if(n)return n;const[s]=M(this,me,zv).call(this,[t]),o=`alpha_${s}`;if(n=d(this,me,ni).get(o),n)return d(this,me,ni).set(t,n),n;const l=`g_${d(this,ia)}_alpha_map_${An(this,Su)._++}`,c=M(this,me,vh).call(this,l);d(this,me,ni).set(t,c),d(this,me,ni).set(o,c);const h=M(this,me,bh).call(this,l);return M(this,me,fT).call(this,s,h),c}addLuminosityFilter(t){let n=d(this,me,ni).get(t||"luminosity");if(n)return n;let s,o;if(t?([s]=M(this,me,zv).call(this,[t]),o=`luminosity_${s}`):o="luminosity",n=d(this,me,ni).get(o),n)return d(this,me,ni).set(t,n),n;const l=`g_${d(this,ia)}_luminosity_map_${An(this,Su)._++}`,c=M(this,me,vh).call(this,l);d(this,me,ni).set(t,c),d(this,me,ni).set(o,c);const h=M(this,me,bh).call(this,l);return M(this,me,z2).call(this,h),t&&M(this,me,fT).call(this,s,h),c}addHighlightHCMFilter(t,n,s,o,l){var P;const c=`${n}-${s}-${o}-${l}`;let h=d(this,me,Ig).get(t);if((h==null?void 0:h.key)===c||(h?((P=h.filter)==null||P.remove(),h.key=c,h.url="none",h.filter=null):(h={key:c,url:"none",filter:null},d(this,me,Ig).set(t,h)),!n||!s))return h.url;const[f,g]=[n,s].map(M(this,me,Dg).bind(this));let y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),b=Math.round(.2126*g[0]+.7152*g[1]+.0722*g[2]),[A,w]=[o,l].map(M(this,me,Dg).bind(this));b<y&&([y,b,A,w]=[b,y,w,A]),d(this,me,yh).style.color="";const x=(k,L,O)=>{const F=new Array(256),U=(b-y)/O,X=k/255,q=(L-k)/(255*O);let Z=0;for(let ee=0;ee<=O;ee++){const se=Math.round(y+ee*U),le=X+ee*q;for(let ue=Z;ue<=se;ue++)F[ue]=le;Z=se+1}for(let ee=Z;ee<256;ee++)F[ee]=F[Z-1];return F.join(",")},N=`g_${d(this,ia)}_hcm_${t}_filter`,I=h.filter=M(this,me,bh).call(this,N);return M(this,me,hT).call(this,I),M(this,me,Mg).call(this,x(A[0],w[0],5),x(A[1],w[1],5),x(A[2],w[2],5),I),h.url=M(this,me,vh).call(this,N),h.url}destroy(t=!1){var n,s,o,l;t&&((n=d(this,_u))!=null&&n.size)||((s=d(this,na))==null||s.parentNode.parentNode.remove(),T(this,na,null),(o=d(this,cf))==null||o.clear(),T(this,cf,null),(l=d(this,_u))==null||l.clear(),T(this,_u,null),T(this,Su,0))}}bu=new WeakMap,cf=new WeakMap,na=new WeakMap,ia=new WeakMap,ri=new WeakMap,_u=new WeakMap,Su=new WeakMap,me=new WeakSet,ni=function(){return d(this,cf)||T(this,cf,new Map)},Ig=function(){return d(this,_u)||T(this,_u,new Map)},yh=function(){if(!d(this,na)){const t=d(this,ri).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const s=d(this,ri).createElementNS(Bo,"svg");s.setAttribute("width",0),s.setAttribute("height",0),T(this,na,d(this,ri).createElementNS(Bo,"defs")),t.append(s),s.append(d(this,na)),d(this,ri).body.append(t)}return d(this,na)},zv=function(t){if(t.length===1){const f=t[0],g=new Array(256);for(let b=0;b<256;b++)g[b]=f[b]/255;const y=g.join(",");return[y,y,y]}const[n,s,o]=t,l=new Array(256),c=new Array(256),h=new Array(256);for(let f=0;f<256;f++)l[f]=n[f]/255,c[f]=s[f]/255,h[f]=o[f]/255;return[l.join(","),c.join(","),h.join(",")]},vh=function(t){if(d(this,bu)===void 0){T(this,bu,"");const n=d(this,ri).URL;n!==d(this,ri).baseURI&&(qy(n)?Fe('#createUrl: ignore "data:"-URL for performance reasons.'):T(this,bu,Kw(n,"")))}return`url(${d(this,bu)}#${t})`},z2=function(t){const n=d(this,ri).createElementNS(Bo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},hT=function(t){const n=d(this,ri).createElementNS(Bo,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},bh=function(t){const n=d(this,ri).createElementNS(Bo,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),d(this,me,yh).append(n),n},Ng=function(t,n,s){const o=d(this,ri).createElementNS(Bo,n);o.setAttribute("type","discrete"),o.setAttribute("tableValues",s),t.append(o)},Mg=function(t,n,s,o){const l=d(this,ri).createElementNS(Bo,"feComponentTransfer");o.append(l),M(this,me,Ng).call(this,l,"feFuncR",t),M(this,me,Ng).call(this,l,"feFuncG",n),M(this,me,Ng).call(this,l,"feFuncB",s)},fT=function(t,n){const s=d(this,ri).createElementNS(Bo,"feComponentTransfer");n.append(s),M(this,me,Ng).call(this,s,"feFuncA",t)},Dg=function(t){return d(this,me,yh).style.color=t,Sp(getComputedStyle(d(this,me,yh)).getPropertyValue("color"))};class V2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Lt("Abstract method `_fetch` called.")}}class PM extends V2{async _fetch(e){const t=await _p(e,"arraybuffer");return new Uint8Array(t)}}class q2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Lt("Abstract method `_fetch` called.")}}class LM extends q2{async _fetch(e){const t=await _p(e,"arraybuffer");return new Uint8Array(t)}}Ei&&Fe("Please use the `legacy` build in Node.js environments.");async function nx(i){const t=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(t)}class K8 extends G2{}class J8 extends B2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Q8 extends H2{async _fetch(e){return nx(e)}}class Z8 extends V2{async _fetch(e){return nx(e)}}class eq extends q2{async _fetch(e){return nx(e)}}const fh="__forcedDependency",{floor:OM,ceil:UM}=Math;function wv(i,e,t,n,s,o){i[e*4+0]=Math.min(i[e*4+0],t),i[e*4+1]=Math.min(i[e*4+1],n),i[e*4+2]=Math.max(i[e*4+2],s),i[e*4+3]=Math.max(i[e*4+3],o)}const pT=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var uf,Hl;class tq{constructor(e,t){R(this,uf);R(this,Hl);T(this,uf,e),T(this,Hl,t)}get length(){return d(this,uf).length}isEmpty(e){return d(this,uf)[e]===pT}minX(e){return d(this,Hl)[e*4+0]/256}minY(e){return d(this,Hl)[e*4+1]/256}maxX(e){return(d(this,Hl)[e*4+2]+1)/256}maxY(e){return(d(this,Hl)[e*4+3]+1)/256}}uf=new WeakMap,Hl=new WeakMap;const xv=(i,e)=>{if(!i)return;let t=i.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},i.set(e,t)),t};var Hi,Gi,Au,hr,Eu,sa,_t,wt,ra,zi,Lm,df,Tu,wu,oa,oi,Jr,Om,gT;class nq{constructor(e,t,n=!1){R(this,Om);R(this,Hi,{__proto__:null});R(this,Gi,{__proto__:null,transform:[],moveText:[],sameLineText:[],[fh]:[]});R(this,Au,new Map);R(this,hr,[]);R(this,Eu,[]);R(this,sa,[[1,0,0,1,0,0]]);R(this,_t,[-1/0,-1/0,1/0,1/0]);R(this,wt,new Float64Array([1/0,1/0,-1/0,-1/0]));R(this,ra,-1);R(this,zi,new Set);R(this,Lm,new Map);R(this,df,new Map);R(this,Tu);R(this,wu);R(this,oa);R(this,oi);R(this,Jr);T(this,Tu,e.width),T(this,wu,e.height),M(this,Om,gT).call(this,t),n&&T(this,Jr,new Map)}growOperationsCount(e){e>=d(this,oi).length&&M(this,Om,gT).call(this,e,d(this,oi))}save(e){return T(this,Hi,{__proto__:d(this,Hi)}),T(this,Gi,{__proto__:d(this,Gi),transform:{__proto__:d(this,Gi).transform},moveText:{__proto__:d(this,Gi).moveText},sameLineText:{__proto__:d(this,Gi).sameLineText},[fh]:{__proto__:d(this,Gi)[fh]}}),T(this,_t,{__proto__:d(this,_t)}),d(this,hr).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(d(this,Hi));if(t===null)return this;T(this,Hi,t),T(this,Gi,Object.getPrototypeOf(d(this,Gi))),T(this,_t,Object.getPrototypeOf(d(this,_t)));const n=d(this,hr).pop();return n!==void 0&&((s=xv(d(this,Jr),e))==null||s.dependencies.add(n),d(this,oi)[e]=d(this,oi)[n]),this}recordOpenMarker(e){return d(this,hr).push(e),this}getOpenMarker(){return d(this,hr).length===0?null:d(this,hr).at(-1)}recordCloseMarker(e){var n;const t=d(this,hr).pop();return t!==void 0&&((n=xv(d(this,Jr),e))==null||n.dependencies.add(t),d(this,oi)[e]=d(this,oi)[t]),this}beginMarkedContent(e){return d(this,Eu).push(e),this}endMarkedContent(e){var n;const t=d(this,Eu).pop();return t!==void 0&&((n=xv(d(this,Jr),e))==null||n.dependencies.add(t),d(this,oi)[e]=d(this,oi)[t]),this}pushBaseTransform(e){return d(this,sa).push(be.multiplyByDOMMatrix(d(this,sa).at(-1),e.getTransform())),this}popBaseTransform(){return d(this,sa).length>1&&d(this,sa).pop(),this}recordSimpleData(e,t){return d(this,Hi)[e]=t,this}recordIncrementalData(e,t){return d(this,Gi)[e].push(t),this}resetIncrementalData(e,t){return d(this,Gi)[e].length=0,this}recordNamedData(e,t){return d(this,Au).set(e,t),this}recordSimpleDataFromNamed(e,t,n){d(this,Hi)[e]=d(this,Au).get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(fh,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in d(this,Hi)&&this.recordFutureForcedDependency(t,d(this,Hi)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of d(this,zi))this.recordFutureForcedDependency(fh,e);return this}resetBBox(e){return d(this,ra)!==e&&(T(this,ra,e),d(this,wt)[0]=1/0,d(this,wt)[1]=1/0,d(this,wt)[2]=-1/0,d(this,wt)[3]=-1/0),this}recordClipBox(e,t,n,s,o,l){const c=be.multiplyByDOMMatrix(d(this,sa).at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];be.axialAlignedBoundingBox([n,o,s,l],c,h);const f=be.intersect(d(this,_t),h);return f?(d(this,_t)[0]=f[0],d(this,_t)[1]=f[1],d(this,_t)[2]=f[2],d(this,_t)[3]=f[3]):(d(this,_t)[0]=d(this,_t)[1]=1/0,d(this,_t)[2]=d(this,_t)[3]=-1/0),this}recordBBox(e,t,n,s,o,l){const c=d(this,_t);if(c[0]===1/0)return this;const h=be.multiplyByDOMMatrix(d(this,sa).at(-1),t.getTransform());if(c[0]===-1/0)return be.axialAlignedBoundingBox([n,o,s,l],h,d(this,wt)),this;const f=[1/0,1/0,-1/0,-1/0];return be.axialAlignedBoundingBox([n,o,s,l],h,f),d(this,wt)[0]=Math.min(d(this,wt)[0],Math.max(f[0],c[0])),d(this,wt)[1]=Math.min(d(this,wt)[1],Math.max(f[1],c[1])),d(this,wt)[2]=Math.max(d(this,wt)[2],Math.min(f[2],c[2])),d(this,wt)[3]=Math.max(d(this,wt)[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,l=0,c){const h=n.bbox;let f,g;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&d(this,df).get(n),f!==!1&&(g=[0,0,0,0],be.axialAlignedBoundingBox(h,n.fontMatrix,g),(s!==1||o!==0||l!==0)&&be.scaleMinMax([s,0,0,-s,o,l],g),f)))return this.recordBBox(e,t,g[0],g[2],g[1],g[3]);if(!c)return this.recordFullPageBBox(e);const y=c();return h&&g&&f===void 0&&(f=g[0]<=o-y.actualBoundingBoxLeft&&g[2]>=o+y.actualBoundingBoxRight&&g[1]<=l-y.actualBoundingBoxAscent&&g[3]>=l+y.actualBoundingBoxDescent,d(this,df).set(n,f),f)?this.recordBBox(e,t,g[0],g[2],g[1],g[3]):this.recordBBox(e,t,o-y.actualBoundingBoxLeft,o+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(e){return d(this,wt)[0]=Math.max(0,d(this,_t)[0]),d(this,wt)[1]=Math.max(0,d(this,_t)[1]),d(this,wt)[2]=Math.min(d(this,Tu),d(this,_t)[2]),d(this,wt)[3]=Math.min(d(this,wu),d(this,_t)[3]),this}getSimpleIndex(e){return d(this,Hi)[e]}recordDependencies(e,t){const n=d(this,zi),s=d(this,Hi),o=d(this,Gi);for(const l of t)l in d(this,Hi)?n.add(s[l]):l in o&&o[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return d(this,Au).has(t)&&d(this,zi).add(d(this,Au).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[fh]),d(this,Jr)){const n=xv(d(this,Jr),e),{dependencies:s}=n;d(this,zi).forEach(s.add,s),d(this,hr).forEach(s.add,s),d(this,Eu).forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(d(this,ra)===e){const n=OM(d(this,wt)[0]*256/d(this,Tu)),s=OM(d(this,wt)[1]*256/d(this,wu)),o=UM(d(this,wt)[2]*256/d(this,Tu)),l=UM(d(this,wt)[3]*256/d(this,wu));wv(d(this,oa),e,n,s,o,l);for(const c of d(this,zi))c!==e&&wv(d(this,oa),c,n,s,o,l);for(const c of d(this,hr))c!==e&&wv(d(this,oa),c,n,s,o,l);for(const c of d(this,Eu))c!==e&&wv(d(this,oa),c,n,s,o,l);t||(d(this,zi).clear(),T(this,ra,-1))}return this}recordShowTextOperation(e,t=!1){const n=Array.from(d(this,zi));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return d(this,ra)===e&&(T(this,ra,-1),d(this,_t)[0]=Math.max(d(this,_t)[0],d(this,wt)[0]),d(this,_t)[1]=Math.max(d(this,_t)[1],d(this,wt)[1]),d(this,_t)[2]=Math.min(d(this,_t)[2],d(this,wt)[2]),d(this,_t)[3]=Math.min(d(this,_t)[3],d(this,wt)[3]),t||d(this,zi).clear()),this}_takePendingDependencies(){const e=d(this,zi);return T(this,zi,new Set),e}_extractOperation(e){const t=d(this,Lm).get(e);return d(this,Lm).delete(e),t}_pushPendingDependencies(e){for(const t of e)d(this,zi).add(t)}take(){return d(this,df).clear(),new tq(d(this,oi),d(this,oa))}takeDebugMetadata(){return d(this,Jr)}}Hi=new WeakMap,Gi=new WeakMap,Au=new WeakMap,hr=new WeakMap,Eu=new WeakMap,sa=new WeakMap,_t=new WeakMap,wt=new WeakMap,ra=new WeakMap,zi=new WeakMap,Lm=new WeakMap,df=new WeakMap,Tu=new WeakMap,wu=new WeakMap,oa=new WeakMap,oi=new WeakMap,Jr=new WeakMap,Om=new WeakSet,gT=function(e,t){const n=new ArrayBuffer(e*4);T(this,oa,new Uint8ClampedArray(n)),T(this,oi,new Uint32Array(n)),t&&t.length>0?(d(this,oi).set(t),d(this,oi).fill(pT,t.length)):d(this,oi).fill(pT)};var Mt,sn,fr,hf,ff;const Mx=class Mx{constructor(e,t,n){R(this,Mt);R(this,sn);R(this,fr);R(this,hf,0);R(this,ff,0);if(e instanceof Mx&&d(e,fr)===!!n)return e;T(this,Mt,e),T(this,sn,t),T(this,fr,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(e){return An(this,ff)._++,d(this,Mt).save(d(this,sn)),this}restore(e){return d(this,ff)>0&&(d(this,Mt).restore(d(this,sn)),An(this,ff)._--),this}recordOpenMarker(e){return An(this,hf)._++,this}getOpenMarker(){return d(this,hf)>0?d(this,sn):d(this,Mt).getOpenMarker()}recordCloseMarker(e){return An(this,hf)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return d(this,Mt).pushBaseTransform(e),this}popBaseTransform(){return d(this,Mt).popBaseTransform(),this}recordSimpleData(e,t){return d(this,Mt).recordSimpleData(e,d(this,sn)),this}recordIncrementalData(e,t){return d(this,Mt).recordIncrementalData(e,d(this,sn)),this}resetIncrementalData(e,t){return d(this,Mt).resetIncrementalData(e,d(this,sn)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return d(this,Mt).recordSimpleDataFromNamed(e,t,d(this,sn)),this}recordFutureForcedDependency(e,t){return d(this,Mt).recordFutureForcedDependency(e,d(this,sn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return d(this,Mt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return d(this,Mt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return d(this,fr)||d(this,Mt).resetBBox(d(this,sn)),this}recordClipBox(e,t,n,s,o,l){return d(this,fr)||d(this,Mt).recordClipBox(d(this,sn),t,n,s,o,l),this}recordBBox(e,t,n,s,o,l){return d(this,fr)||d(this,Mt).recordBBox(d(this,sn),t,n,s,o,l),this}recordCharacterBBox(e,t,n,s,o,l,c){return d(this,fr)||d(this,Mt).recordCharacterBBox(d(this,sn),t,n,s,o,l,c),this}recordFullPageBBox(e){return d(this,fr)||d(this,Mt).recordFullPageBBox(d(this,sn)),this}getSimpleIndex(e){return d(this,Mt).getSimpleIndex(e)}recordDependencies(e,t){return d(this,Mt).recordDependencies(d(this,sn),t),this}recordNamedDependency(e,t){return d(this,Mt).recordNamedDependency(d(this,sn),t),this}recordOperation(e){return d(this,Mt).recordOperation(d(this,sn),!0),this}recordShowTextOperation(e){return d(this,Mt).recordShowTextOperation(d(this,sn),!0),this}bboxToClipBoxDropOperation(e){return d(this,fr)||d(this,Mt).bboxToClipBoxDropOperation(d(this,sn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Mt=new WeakMap,sn=new WeakMap,fr=new WeakMap,hf=new WeakMap,ff=new WeakMap;let Rb=Mx;const Hs={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Kn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function mT(i,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),i.clip(s)}class ix{isModifyingCurrentTransform(){return!1}getPattern(){Lt("Abstract method `getPattern` called.")}}class iq extends ix{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===Kn.STROKE||s===Kn.FILL){const l=t.current.getClippedPathBoundingBox(s,Kt(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=be.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...t.baseTransform),this.matrix&&g.transform(...this.matrix),mT(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=e.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);o.setTransform(y)}else mT(e,this._bbox),o=this._createGradient(e);return o}}function lE(i,e,t,n,s,o,l,c){const h=e.coords,f=e.colors,g=i.data,y=i.width*4;let b;h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b),h[n+1]>h[s+1]&&(b=n,n=s,s=b,b=l,l=c,c=b),h[t+1]>h[n+1]&&(b=t,t=n,n=b,b=o,o=l,l=b);const A=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,x=(h[n]+e.offsetX)*e.scaleX,N=(h[n+1]+e.offsetY)*e.scaleY,I=(h[s]+e.offsetX)*e.scaleX,P=(h[s+1]+e.offsetY)*e.scaleY;if(w>=P)return;const k=f[o],L=f[o+1],O=f[o+2],F=f[l],U=f[l+1],X=f[l+2],q=f[c],Z=f[c+1],ee=f[c+2],se=Math.round(w),le=Math.round(P);let ue,ye,G,$,oe,ge,Me,H;for(let K=se;K<=le;K++){if(K<N){const Te=K<w?0:(w-K)/(w-N);ue=A-(A-x)*Te,ye=k-(k-F)*Te,G=L-(L-U)*Te,$=O-(O-X)*Te}else{let Te;K>P?Te=1:N===P?Te=0:Te=(N-K)/(N-P),ue=x-(x-I)*Te,ye=F-(F-q)*Te,G=U-(U-Z)*Te,$=X-(X-ee)*Te}let re;K<w?re=0:K>P?re=1:re=(w-K)/(w-P),oe=A-(A-I)*re,ge=k-(k-q)*re,Me=L-(L-Z)*re,H=O-(O-ee)*re;const de=Math.round(Math.min(ue,oe)),_e=Math.round(Math.max(ue,oe));let Se=y*K+de*4;for(let Te=de;Te<=_e;Te++)re=(ue-Te)/(ue-oe),re<0?re=0:re>1&&(re=1),g[Se++]=ye-(ye-ge)*re|0,g[Se++]=G-(G-Me)*re|0,g[Se++]=$-($-H)*re|0,g[Se++]=255}}function sq(i,e,t){const n=e.coords,s=e.colors;let o,l;switch(e.type){case"lattice":const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let g=o*c;for(let y=0;y<f;y++,g++)lE(i,t,n[g],n[g+1],n[g+c],s[g],s[g+1],s[g+c]),lE(i,t,n[g+c+1],n[g+1],n[g+c],s[g+c+1],s[g+1],s[g+c])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)lE(i,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class rq extends ix{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(g*e[1]*1.1)),3e3),A=f/y,w=g/b,x={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/A,scaleY:1/w},N=y+4,I=b+4,P=n.getCanvas("mesh",N,I),k=P.context,L=k.createImageData(y,b);if(t){const F=L.data;for(let U=0,X=F.length;U<X;U+=4)F[U]=t[0],F[U+1]=t[1],F[U+2]=t[2],F[U+3]=255}for(const F of this._figures)sq(L,F,x);return k.putImageData(L,2,2),{canvas:P.canvas,offsetX:c-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){mT(e,this._bbox);const o=new Float32Array(2);if(s===Kn.SHADING)be.singularValueDecompose2dScale(Kt(e),o);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;be.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else be.singularValueDecompose2dScale(t.baseTransform,o);const l=this._createMeshCanvas(o,s===Kn.SHADING?null:this._background,t.cachedCanvases);return s!==Kn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class oq extends ix{getPattern(){return"hotpink"}}function aq(i){switch(i[0]){case"RadialAxial":return new iq(i);case"Mesh":return new rq(i);case"Dummy":return new oq}throw new Error(`Unknown IR type: ${i[0]}`)}const FM={COLORED:1,UNCOLORED:2},e_=class e_{constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){var ge,Me;const{bbox:n,operatorList:s,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),b_("TilingType: "+l);const y=n[0],b=n[1],A=n[2],w=n[3],x=A-y,N=w-b,I=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,I);const[P,k]=I;be.singularValueDecompose2dScale(this.baseTransform,I);const L=P*I[0],O=k*I[1];let F=x,U=N,X=!1,q=!1;const Z=Math.ceil(f*L),ee=Math.ceil(g*O),se=Math.ceil(x*L),le=Math.ceil(N*O);Z>=se?F=f:X=!0,ee>=le?U=g:q=!0;const ue=this.getSizeAndScale(F,this.ctx.canvas.width,L),ye=this.getSizeAndScale(U,this.ctx.canvas.height,O),G=e.cachedCanvases.getCanvas("pattern",ue.size,ye.size),$=G.context,oe=h.createCanvasGraphics($,t);if(oe.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(oe,o,c),$.translate(-ue.scale*y,-ye.scale*b),oe.transform(0,ue.scale,0,0,ye.scale,0,0),$.save(),(ge=oe.dependencyTracker)==null||ge.save(),this.clipBbox(oe,y,b,A,w),oe.baseTransform=Kt(oe.ctx),oe.executeOperatorList(s),oe.endDrawing(),(Me=oe.dependencyTracker)==null||Me.restore(),$.restore(),X||q){const H=G.canvas;X&&(F=f),q&&(U=g);const K=this.getSizeAndScale(F,this.ctx.canvas.width,L),re=this.getSizeAndScale(U,this.ctx.canvas.height,O),de=K.size,_e=re.size,Se=e.cachedCanvases.getCanvas("pattern-workaround",de,_e),Te=Se.context,Ke=X?Math.floor(x/f):0,Ve=q?Math.floor(N/g):0;for(let zt=0;zt<=Ke;zt++)for(let We=0;We<=Ve;We++)Te.drawImage(H,de*zt,_e*We,de,_e,0,0,de,_e);return{canvas:Se.canvas,scaleX:K.scale,scaleY:re.scale,offsetX:y,offsetY:b}}return{canvas:G.canvas,scaleX:ue.scale,scaleY:ye.scale,offsetX:y,offsetY:b}}getSizeAndScale(e,t,n){const s=Math.max(e_.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const l=s-t,c=o-n;e.ctx.rect(t,n,l,c),be.axialAlignedBoundingBox([t,n,s,o],Kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case FM.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=l,s.strokeStyle=o.strokeColor=c;break;case FM.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new R8(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let l=n;s!==Kn.SHADING&&(l=be.transform(l,t.baseTransform),this.matrix&&(l=be.transform(l,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}};ce(e_,"MAX_PATTERN_SIZE",3e3);let yT=e_;function lq({src:i,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=On.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],g=n>>3,y=n&7,b=i.length;t=new Uint32Array(t.buffer);let A=0;for(let w=0;w<s;w++){for(const N=e+g;e<N;e++){const I=e<b?i[e]:255;t[A++]=I&128?f:h,t[A++]=I&64?f:h,t[A++]=I&32?f:h,t[A++]=I&16?f:h,t[A++]=I&8?f:h,t[A++]=I&4?f:h,t[A++]=I&2?f:h,t[A++]=I&1?f:h}if(y===0)continue;const x=e<b?i[e++]:255;for(let N=0;N<y;N++)t[A++]=x&1<<7-N?f:h}return{srcPos:e,destPos:A}}const BM=16,HM=100,cq=15,GM=10,Yi=16,cE=new DOMMatrix,Ss=new Float32Array(2),wh=new Float32Array([1/0,1/0,-1/0,-1/0]);function uq(i,e){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){e.save(),this.__originalSave()},i.restore=function(){e.restore(),this.__originalRestore()},i.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},i.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},i.transform=function(t,n,s,o,l,c){e.transform(t,n,s,o,l,c),this.__originalTransform(t,n,s,o,l,c)},i.setTransform=function(t,n,s,o,l,c){e.setTransform(t,n,s,o,l,c),this.__originalSetTransform(t,n,s,o,l,c)},i.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},i.rotate=function(t){e.rotate(t),this.__originalRotate(t)},i.clip=function(t){e.clip(t),this.__originalClip(t)},i.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},i.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},i.bezierCurveTo=function(t,n,s,o,l,c){e.bezierCurveTo(t,n,s,o,l,c),this.__originalBezierCurveTo(t,n,s,o,l,c)},i.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},i.closePath=function(){e.closePath(),this.__originalClosePath()},i.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class dq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Cv(i,e,t,n,s,o,l,c,h,f){const[g,y,b,A,w,x]=Kt(i);if(y===0&&b===0){const P=l*g+w,k=Math.round(P),L=c*A+x,O=Math.round(L),F=(l+h)*g+w,U=Math.abs(Math.round(F)-k)||1,X=(c+f)*A+x,q=Math.abs(Math.round(X)-O)||1;return i.setTransform(Math.sign(g),0,0,Math.sign(A),k,O),i.drawImage(e,t,n,s,o,0,0,U,q),i.setTransform(g,y,b,A,w,x),[U,q]}if(g===0&&A===0){const P=c*b+w,k=Math.round(P),L=l*y+x,O=Math.round(L),F=(c+f)*b+w,U=Math.abs(Math.round(F)-k)||1,X=(l+h)*y+x,q=Math.abs(Math.round(X)-O)||1;return i.setTransform(0,Math.sign(y),Math.sign(b),0,k,O),i.drawImage(e,t,n,s,o,0,0,q,U),i.setTransform(g,y,b,A,w,x),[q,U]}i.drawImage(e,t,n,s,o,l,c,h,f);const N=Math.hypot(g,y),I=Math.hypot(b,A);return[N*h,I*f]}class zM{constructor(e,t,n){ce(this,"alphaIsShape",!1);ce(this,"fontSize",0);ce(this,"fontSizeScale",1);ce(this,"textMatrix",null);ce(this,"textMatrixScale",1);ce(this,"fontMatrix",VE);ce(this,"leading",0);ce(this,"x",0);ce(this,"y",0);ce(this,"lineX",0);ce(this,"lineY",0);ce(this,"charSpacing",0);ce(this,"wordSpacing",0);ce(this,"textHScale",1);ce(this,"textRenderingMode",qn.FILL);ce(this,"textRise",0);ce(this,"fillColor","#000000");ce(this,"strokeColor","#000000");ce(this,"patternFill",!1);ce(this,"patternStroke",!1);ce(this,"fillAlpha",1);ce(this,"strokeAlpha",1);ce(this,"lineWidth",1);ce(this,"activeSMask",null);ce(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=wh.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Kn.FILL,t=null){const n=this.minMax.slice();if(e===Kn.STROKE){t||Lt("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(t,Ss);const s=Ss[0]*this.lineWidth/2,o=Ss[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(wh,0)}getClippedPathBoundingBox(e=Kn.FILL,t=null){return be.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function VM(i,e){if(e instanceof ImageData){i.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%Yi,o=(t-s)/Yi,l=s===0?o:o+1,c=i.createImageData(n,Yi);let h=0,f;const g=e.data,y=c.data;let b,A,w,x;if(e.kind===Yg.GRAYSCALE_1BPP){const N=g.byteLength,I=new Uint32Array(y.buffer,0,y.byteLength>>2),P=I.length,k=n+7>>3,L=4294967295,O=On.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(w=b<o?Yi:s,f=0,A=0;A<w;A++){const F=N-h;let U=0;const X=F>k?n:F*8-7,q=X&-8;let Z=0,ee=0;for(;U<q;U+=8)ee=g[h++],I[f++]=ee&128?L:O,I[f++]=ee&64?L:O,I[f++]=ee&32?L:O,I[f++]=ee&16?L:O,I[f++]=ee&8?L:O,I[f++]=ee&4?L:O,I[f++]=ee&2?L:O,I[f++]=ee&1?L:O;for(;U<X;U++)Z===0&&(ee=g[h++],Z=128),I[f++]=ee&Z?L:O,Z>>=1}for(;f<P;)I[f++]=0;i.putImageData(c,0,b*Yi)}}else if(e.kind===Yg.RGBA_32BPP){for(A=0,x=n*Yi*4,b=0;b<o;b++)y.set(g.subarray(h,h+x)),h+=x,i.putImageData(c,0,A),A+=Yi;b<l&&(x=n*s*4,y.set(g.subarray(h,h+x)),i.putImageData(c,0,A))}else if(e.kind===Yg.RGB_24BPP)for(w=Yi,x=n*w,b=0;b<l;b++){for(b>=o&&(w=s,x=n*w),f=0,A=x;A--;)y[f++]=g[h++],y[f++]=g[h++],y[f++]=g[h++],y[f++]=255;i.putImageData(c,0,b*Yi)}else throw new Error(`bad image kind: ${e.kind}`)}function qM(i,e){if(e.bitmap){i.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%Yi,o=(t-s)/Yi,l=s===0?o:o+1,c=i.createImageData(n,Yi);let h=0;const f=e.data,g=c.data;for(let y=0;y<l;y++){const b=y<o?Yi:s;({srcPos:h}=lq({src:f,srcPos:h,dest:g,width:n,height:b,nonBlackColor:0})),i.putImageData(c,0,y*Yi)}}function yg(i,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)i[n]!==void 0&&(e[n]=i[n]);i.setLineDash!==void 0&&(e.setLineDash(i.getLineDash()),e.lineDashOffset=i.lineDashOffset)}function Rv(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:e}=i;e!=="none"&&e!==""&&(i.filter="none")}function $M(i,e){if(e)return!0;be.singularValueDecompose2dScale(i,Ss);const t=Math.fround(xr.pixelRatio*Pa.PDF_TO_CSS_UNITS);return Ss[0]<=t&&Ss[1]<=t}const hq=["butt","round","square"],fq=["miter","round","bevel"],pq={},YM={};var Rr,vT,bT,_T;const Dx=class Dx{constructor(e,t,n,s,o,{optionalContentConfig:l,markedContentStack:c=null},h,f,g){R(this,Rr);this.ctx=e,this.current=new zM(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new dq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(e,t,n=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Kt(this.compositeCtx))}this.ctx.save(),Rv(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Kt(this.ctx)}executeOperatorList(e,t,n,s,o){var I;const l=e.argsArray,c=e.fnArray;let h=t||0;const f=l.length;if(f===h)return h;const g=f-h>GM&&typeof n=="function",y=g?Date.now()+cq:0;let b=0;const A=this.commonObjs,w=this.objs;let x,N;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(x=c[h],N=l[h]??null,x!==fp.dependency)N===null?this[x](h):this[x](h,...N);else for(const P of N){(I=this.dependencyTracker)==null||I.recordNamedData(P,h);const k=P.startsWith("g_")?A:w;if(!k.has(P))return k.get(P,n),h}if(h++,h===f)return h;if(g&&++b>GM){if(Date.now()>y)return n(),h;b=0}}}endDrawing(){M(this,Rr,vT).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),M(this,Rr,bT).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",g,y;for(;o>2&&c>1||l>2&&h>1;){let b=c,A=h;o>2&&c>1&&(b=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/b),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),g=this.cachedCanvases.getCanvas(f,b,A),y=g.context,y.clearRect(0,0,b,A),y.drawImage(e,0,0,c,h,0,0,b,A),e=g.canvas,c=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){var Z,ee;const n=this.ctx,{width:s,height:o}=t,l=this.current.fillColor,c=this.current.patternFill,h=Kt(n);let f,g,y,b;if((t.bitmap||t.data)&&t.count>1){const se=t.bitmap||t.data.buffer;g=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(se),f||(f=new Map,this._cachedBitmapsMap.set(se,f));const le=f.get(g);if(le&&!c){const ue=Math.round(Math.min(h[0],h[2])+h[4]),ye=Math.round(Math.min(h[1],h[3])+h[5]);return(Z=this.dependencyTracker)==null||Z.recordDependencies(e,Hs.transformAndFill),{canvas:le,offsetX:ue,offsetY:ye}}y=le}y||(b=this.cachedCanvases.getCanvas("maskCanvas",s,o),qM(b.context,t));let A=be.transform(h,[1/s,0,0,-1/o,0,0]);A=be.transform(A,[1,0,0,1,0,-o]);const w=wh.slice();be.axialAlignedBoundingBox([0,0,s,o],A,w);const[x,N,I,P]=w,k=Math.round(I-x)||1,L=Math.round(P-N)||1,O=this.cachedCanvases.getCanvas("fillCanvas",k,L),F=O.context,U=x,X=N;F.translate(-U,-X),F.transform(...A),y||(y=this._scaleImage(b.canvas,Fr(F)),y=y.img,f&&c&&f.set(g,y)),F.imageSmoothingEnabled=$M(Kt(F),t.interpolate),Cv(F,y,0,0,y.width,y.height,0,0,s,o),F.globalCompositeOperation="source-in";const q=be.transform(Fr(F),[1,0,0,1,-U,-X]);return F.fillStyle=c?l.getPattern(n,this,q,Kn.FILL,e):l,F.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),(ee=this.dependencyTracker)==null||ee.recordDependencies(e,Hs.transformAndFill),{canvas:O.canvas,offsetX:Math.round(U),offsetY:Math.round(X)}}setLineWidth(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",e),this.ctx.lineCap=hq[t]}setLineJoin(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",e),this.ctx.lineJoin=fq[t]}setMiterLimit(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){var o;(o=this.dependencyTracker)==null||o.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var n,s,o,l,c;for(const[h,f]of t)switch(h){case"LW":this.setLineWidth(e,f);break;case"LC":this.setLineCap(e,f);break;case"LJ":this.setLineJoin(e,f);break;case"ML":this.setMiterLimit(e,f);break;case"D":this.setDash(e,f[0],f[1]);break;case"RI":this.setRenderingIntent(e,f);break;case"FL":this.setFlatness(e,f);break;case"Font":this.setFont(e,f[0],f[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=f;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=f;break;case"BM":(o=this.dependencyTracker)==null||o.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=f;break;case"SMask":(l=this.dependencyTracker)==null||l.recordSimpleData("SMask",e),this.current.activeSMask=f?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(c=this.dependencyTracker)==null||c.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(f);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),yg(this.suspendedCtx,l),uq(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),yg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],l=s[1],c=s[2]-o,h=s[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,l,c,h,f,g,y){let b=e.canvas,A=h-g,w=f-y;if(l)if(A<0||w<0||A+n>b.width||w+s>b.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,s),I=N.context;I.drawImage(b,-A,-w),I.globalCompositeOperation="destination-atop",I.fillStyle=l,I.fillRect(0,0,n,s),I.globalCompositeOperation="source-over",b=N.canvas,A=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(A,w,n,s),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(A,w,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const x=new Path2D;x.rect(h,f,n,s),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(b,A,w,n,s,h,f,n,s),t.restore()}save(e){var n;this.inSMaskMode&&yg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(n=this.dependencyTracker)==null||n.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&yg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,l,c){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||(o=n[0]=new Path2D),this[t](e,o);return}if(this.dependencyTracker!==null){const l=t===fp.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const l=n[0]=new Path2D;for(let c=0,h=o.length;c<h;)switch(o[c++]){case Sv.moveTo:l.moveTo(o[c++],o[c++]);break;case Sv.lineTo:l.lineTo(o[c++],o[c++]);break;case Sv.curveTo:l.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);break;case Sv.closePath:l.closePath();break;default:Fe(`Unrecognized drawing path operator: ${o[c-1]}`);break}o=l}be.axialAlignedBoundingBox(s,Kt(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){var l;const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const c=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,Fr(s),Kn.STROKE,e),c){const h=new Path2D;h.addPath(t,s.getTransform().invertSelf().multiplySelf(c)),t=h}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(l=this.dependencyTracker)==null||l.recordDependencies(e,Hs.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Kn.STROKE,Kt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){var f,g,y;const s=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const b=o.isModifyingCurrentTransform()?s.getTransform():null;if((f=this.dependencyTracker)==null||f.save(e),s.save(),s.fillStyle=o.getPattern(s,this,Fr(s),Kn.FILL,e),b){const A=new Path2D;A.addPath(t,s.getTransform().invertSelf().multiplySelf(b)),t=A}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(g=this.dependencyTracker)==null||g.recordDependencies(e,Hs.fill),c&&(s.restore(),(y=this.dependencyTracker)==null||y.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var n;this.ctx.fill(t),(n=this.dependencyTracker)==null||n.recordDependencies(e,Hs.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=pq}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=YM}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:g}of t)g&&s.addPath(g,new DOMMatrix(l).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){var y,b;(y=this.dependencyTracker)==null||y.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||VE,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Fe("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=((b=s.systemFontInfo)==null?void 0:b.css)||`"${l}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let g=n;n<BM?g=BM:n>HM&&(g=HM),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${h} ${g}px ${c}`}setTextRenderingMode(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,n,s,o,l){var I,P,k,L;const c=this.ctx,h=this.current,f=h.font,g=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,b=g&qn.FILL_STROKE_MASK,A=!!(g&qn.ADD_TO_PATH_FLAG),w=h.patternFill&&!f.missingFile,x=h.patternStroke&&!f.missingFile;let N;if((f.disableFontFace||A||w||x)&&!f.missingFile&&(N=f.getPathGenerator(this.commonObjs,t)),N&&(f.disableFontFace||w||x)){c.save(),c.translate(n,s),c.scale(y,-y),(I=this.dependencyTracker)==null||I.recordCharacterBBox(e,c,f);let O;if(b===qn.FILL||b===qn.FILL_STROKE)if(o){O=c.getTransform(),c.setTransform(...o);const F=M(this,Rr,_T).call(this,N,O,o);c.fill(F)}else c.fill(N);if(b===qn.STROKE||b===qn.FILL_STROKE)if(l){O||(O=c.getTransform()),c.setTransform(...l);const{a:F,b:U,c:X,d:q}=O,Z=be.inverseTransform(l),ee=be.transform([F,U,X,q,0,0],Z);be.singularValueDecompose2dScale(ee,Ss),c.lineWidth*=Math.max(Ss[0],Ss[1])/y,c.stroke(M(this,Rr,_T).call(this,N,O,l))}else c.lineWidth/=y,c.stroke(N);c.restore()}else(b===qn.FILL||b===qn.FILL_STROKE)&&(c.fillText(t,n,s),(P=this.dependencyTracker)==null||P.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t))),(b===qn.STROKE||b===qn.FILL_STROKE)&&(this.dependencyTracker&&((k=this.dependencyTracker)==null||k.recordCharacterBBox(e,c,f,y,n,s,()=>c.measureText(t)).recordDependencies(e,Hs.stroke)),c.strokeText(t,n,s));A&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Kt(c),x:n,y:s,fontSize:y,path:N}),(L=this.dependencyTracker)==null||L.recordCharacterBBox(e,c,f,y,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return $e(this,"isFontSubpixelAAEnabled",n)}showText(e,t){var X,q,Z,ee;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Hs.showText).resetBBox(e),this.current.textRenderingMode&qn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),(X=this.dependencyTracker)==null||X.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){(q=this.dependencyTracker)==null||q.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,y=n.textHScale*g,b=t.length,A=s.vertical,w=A?1:-1,x=s.defaultVMetrics,N=o*n.fontMatrix[0],I=n.textRenderingMode===qn.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),g>0?l.scale(y,-1):l.scale(y,1);let P,k;if(n.patternFill){l.save();const se=n.fillColor.getPattern(l,this,Fr(l),Kn.FILL,e);P=Kt(l),l.restore(),l.fillStyle=se}if(n.patternStroke){l.save();const se=n.strokeColor.getPattern(l,this,Fr(l),Kn.STROKE,e);k=Kt(l),l.restore(),l.strokeStyle=se}let L=n.lineWidth;const O=n.textMatrixScale;if(O===0||L===0){const se=n.textRenderingMode&qn.FILL_STROKE_MASK;(se===qn.STROKE||se===qn.FILL_STROKE)&&(L=this.getSinglePixelWidth())}else L/=O;if(c!==1&&(l.scale(c,c),L/=c),l.lineWidth=L,s.isInvalidPDFjsFont){const se=[];let le=0;for(const ye of t)se.push(ye.unicode),le+=ye.width;const ue=se.join("");if(l.fillText(ue,0,0),this.dependencyTracker!==null){const ye=l.measureText(ue);this.dependencyTracker.recordBBox(e,this.ctx,-ye.actualBoundingBoxLeft,ye.actualBoundingBoxRight,-ye.actualBoundingBoxAscent,ye.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=le*N*y,l.restore(),this.compose();return}let F=0,U;for(U=0;U<b;++U){const se=t[U];if(typeof se=="number"){F+=w*se*o/1e3;continue}let le=!1;const ue=(se.isSpace?f:0)+h,ye=se.fontChar,G=se.accent;let $,oe,ge=se.width;if(A){const K=se.vmetric||x,re=-(se.vmetric?K[1]:ge*.5)*N,de=K[2]*N;ge=K?-K[0]:ge,$=re/c,oe=(F+de)/c}else $=F/c,oe=0;let Me;if(s.remeasure&&ge>0){Me=l.measureText(ye);const K=Me.width*1e3/o*c;if(ge<K&&this.isFontSubpixelAAEnabled){const re=ge/K;le=!0,l.save(),l.scale(re,1),$/=re}else ge!==K&&($+=(ge-K)/2e3*o/c)}if(this.contentVisible&&(se.isInFont||s.missingFile)){if(I&&!G)l.fillText(ye,$,oe),(Z=this.dependencyTracker)==null||Z.recordCharacterBBox(e,l,Me?{bbox:null}:s,o/c,$,oe,()=>Me??l.measureText(ye));else if(this.paintChar(e,ye,$,oe,P,k),G){const K=$+o*G.offset.x/c,re=oe-o*G.offset.y/c;this.paintChar(e,G.fontChar,K,re,P,k)}}const H=A?ge*N-ue*g:ge*N+ue*g;F+=H,le&&l.restore()}A?n.y-=F:n.x+=F*y,l.restore(),this.compose(),(ee=this.dependencyTracker)==null||ee.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,l=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,y=s.textHScale*c,b=s.fontMatrix||VE,A=t.length,w=s.textRenderingMode===qn.INVISIBLE;let x,N,I,P;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(y,c);const k=this.dependencyTracker;for(this.dependencyTracker=k?new Rb(k,e):null,x=0;x<A;++x){if(N=t[x],typeof N=="number"){P=h*N*l/1e3,this.ctx.translate(P,0),s.x+=P*y;continue}const L=(N.isSpace?g:0)+f,O=o.charProcOperatorList[N.operatorListId];O?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...b),this.executeOperatorList(O),this.restore()):Fe(`Type3 character "${N.operatorListId}" is not available.`);const F=[N.width,0];be.applyTransform(F,b),I=F[0]*l+L,n.translate(I,0),s.x+=I*y}n.restore(),k&&(this.dependencyTracker=k)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,l,c){var f;const h=new Path2D;h.rect(s,o,l-s,c-o),this.ctx.clip(h),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,s,l,o,c).recordClipBox(e,this.ctx,s,l,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Kt(this.ctx),o={createCanvasGraphics:(l,c)=>new Dx(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Rb(this.dependencyTracker,c,!0):null)};n=new yT(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=aq(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){var l;if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,Fr(n),Kn.SHADING,e);const o=Fr(n);if(o){const{width:c,height:h}=n.canvas,f=wh.slice();be.axialAlignedBoundingBox([0,0,c,h],o,f);const[g,y,b,A]=f;this.ctx.fillRect(g,y,b-g,A-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(l=this.dependencyTracker)==null||l.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Hs.transform).recordDependencies(e,Hs.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Lt("Should not call beginInlineImage")}beginImageData(){Lt("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Kt(this.ctx),n)){be.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[o,l,c,h]=n,f=new Path2D;f.rect(o,l,c-o,h-l),this.ctx.clip(f),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,o,c,l,h),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var k;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||b_("TODO: Support non-isolated groups."),t.knockout&&Fe("Knockout groups not supported.");const s=Kt(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=wh.slice();be.axialAlignedBoundingBox(t.bbox,Kt(n),o);const l=[0,0,n.canvas.width,n.canvas.height];o=be.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),g=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,g]);let y="groupAt"+this.groupLevel;t.smask&&(y+="_smask_"+this.smaskCounter++%2);const b=this.cachedCanvases.getCanvas(y,f,g),A=b.context;A.translate(-c,-h),A.transform(...s);let w=new Path2D;const[x,N,I,P]=t.bbox;if(w.rect(x,N,I-x,P-N),t.matrix){const L=new Path2D;L.addPath(w,new DOMMatrix(t.matrix)),w=L}A.clip(w),t.smask&&this.smaskStack.push({canvas:b.canvas,context:A,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),yg(n,A),this.ctx=A,(k=this.dependencyTracker)==null||k.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){var o;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(o=this.dependencyTracker)==null||o.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Kt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...l);const c=wh.slice();be.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],l,c),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(e,t,n,s,o,l){if(M(this,Rr,vT).call(this),Rv(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,be.singularValueDecompose2dScale(Kt(this.ctx),Ss);const{viewportScale:f}=this,g=Math.ceil(c*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,y);const{canvas:b,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Ss[0],0,0,-Ss[1],0,h*Ss[1]),Rv(this.ctx)}else{Rv(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new zM(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),M(this,Rr,bT).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var c;if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,l,c){var y,b,A;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Kt(h);h.transform(n,s,o,l,0,0);const g=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),(y=this.dependencyTracker)==null||y.resetBBox(e);for(let w=0,x=c.length;w<x;w+=2){const N=be.transform(f,[n,s,o,l,c[w],c[w+1]]);h.drawImage(g.canvas,N[4],N[5]),(b=this.dependencyTracker)==null||b.recordBBox(e,this.ctx,N[4],N[4]+g.canvas.width,N[5],N[5]+g.canvas.height)}h.restore(),this.compose(),(A=this.dependencyTracker)==null||A.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var l,c,h;if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;(l=this.dependencyTracker)==null||l.resetBBox(e).recordDependencies(e,Hs.transformAndFill);for(const f of t){const{data:g,width:y,height:b,transform:A}=f,w=this.cachedCanvases.getCanvas("maskCanvas",y,b),x=w.context;x.save();const N=this.getObject(e,g,f);qM(x,N),x.globalCompositeOperation="source-in",x.fillStyle=o?s.getPattern(x,this,Fr(n),Kn.FILL,e):s,x.fillRect(0,0,y,b),x.restore(),n.save(),n.transform(...A),n.scale(1,-1),Cv(n,w.canvas,0,0,y,b,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,n,0,y,0,b),n.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Fe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Fe("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let g=0,y=o.length;g<y;g+=2)f.push({transform:[n,0,0,s,o[g],o[g+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e,t){var f;if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const y=this.cachedCanvases.getCanvas("inlineImage",n,s).context;VM(y,t),c=this.applyTransferMapsToCanvas(y)}const h=this._scaleImage(c,Fr(o));o.imageSmoothingEnabled=$M(Kt(o),t.interpolate),(f=this.dependencyTracker)==null||f.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,Hs.imageXObject).recordOperation(e),Cv(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){var l,c,h;if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const f=t.width,g=t.height,b=this.cachedCanvases.getCanvas("inlineImage",f,g).context;VM(b,t),o=this.applyTransferMapsToCanvas(b)}(l=this.dependencyTracker)==null||l.resetBBox(e);for(const f of n)s.save(),s.transform(...f.transform),s.scale(1,-1),Cv(s,o,f.x,f.y,f.w,f.h,0,-1,1,1),(c=this.dependencyTracker)==null||c.recordBBox(e,s,0,1,-1,0),s.restore();(h=this.dependencyTracker)==null||h.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Hs.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){var l,c;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===YM?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,(l=this.dependencyTracker)==null||l.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(c=this.dependencyTracker)==null||c.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)l=c=1/h;else{const g=h*e;l=c=g<1?1/g:1}else if(e===0)l=1/h,c=1/f;else{const g=h*e,y=f*e;l=g<1?1/g:1,c=y<1?1/y:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),g=Math.hypot(s,o);if(e===0)l=g/h,c=f/h;else{const y=e*h;l=g>y?g/y:1,c=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,l),cE.a=1/o,cE.d=1/l;const h=new Path2D;if(h.addPath(e,cE),c.length>0){const f=Math.max(o,l);n.setLineDash(c.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Rr=new WeakSet,vT=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},bT=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},_T=function(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s};let kh=Dx;for(const i in fp)kh.prototype[i]!==void 0&&(kh.prototype[fp[i]]=kh.prototype[i]);var pf,gf,Um,mf,Vv;const Rh=class Rh{constructor(e){R(this,mf);R(this,pf);R(this,gf);R(this,Um);T(this,pf,e),T(this,gf,new DataView(d(this,pf))),T(this,Um,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const f of Rh.strings){const g=t.encode(e[f]);n[f]=g,s+=4+g.length}const o=new ArrayBuffer(s),l=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of Rh.strings){const g=n[f],y=g.length;c.setUint32(h,y),l.set(g,h+4),h+=4+y}return ot(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}get fontFamily(){return M(this,mf,Vv).call(this,0)}get fontWeight(){return M(this,mf,Vv).call(this,1)}get italicAngle(){return M(this,mf,Vv).call(this,2)}};pf=new WeakMap,gf=new WeakMap,Um=new WeakMap,mf=new WeakSet,Vv=function(e){ot(e<Rh.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=d(this,gf).getUint32(t)+4;const n=d(this,gf).getUint32(t);return d(this,Um).decode(new Uint8Array(d(this,pf),t+4,n))},ce(Rh,"strings",["fontFamily","fontWeight","italicAngle"]);let Ib=Rh;var Gl,Qr,xu,Cu,kg;const Ih=class Ih{constructor(e){R(this,Cu);R(this,Gl);R(this,Qr);R(this,xu);T(this,Gl,e),T(this,Qr,new DataView(d(this,Gl))),T(this,xu,new TextDecoder)}static write(e){const t=new TextEncoder,n={};let s=0;for(const b of Ih.strings){const A=t.encode(e[b]);n[b]=A,s+=4+A.length}s+=4;let o,l,c=1+s;e.style&&(o=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+o.length+4+l.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;g.setUint8(y++,e.guessFallback?1:0),g.setUint32(y,0),y+=4,s=0;for(const b of Ih.strings){const A=n[b],w=A.length;s+=4+w,g.setUint32(y,w),f.set(A,y+4),y+=4+w}return g.setUint32(y-s-4,s),e.style&&(g.setUint32(y,o.length),f.set(o,y+4),y+=4+o.length,g.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),ot(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}get guessFallback(){return d(this,Qr).getUint8(0)!==0}get css(){return M(this,Cu,kg).call(this,0)}get loadedName(){return M(this,Cu,kg).call(this,1)}get baseFontName(){return M(this,Cu,kg).call(this,2)}get src(){return M(this,Cu,kg).call(this,3)}get style(){let e=1;e+=4+d(this,Qr).getUint32(e);const t=d(this,Qr).getUint32(e),n=d(this,xu).decode(new Uint8Array(d(this,Gl),e+4,t));e+=4+t;const s=d(this,Qr).getUint32(e),o=d(this,xu).decode(new Uint8Array(d(this,Gl),e+4,s));return{style:n,weight:o}}};Gl=new WeakMap,Qr=new WeakMap,xu=new WeakMap,Cu=new WeakSet,kg=function(e){ot(e<Ih.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=d(this,Qr).getUint32(t)+4;const n=d(this,Qr).getUint32(t);return d(this,xu).decode(new Uint8Array(d(this,Gl),t+4,n))},ce(Ih,"strings",["css","loadedName","baseFontName","src"]);let Nb=Ih;var yf,vf,bf,_f,os,Zr,Fm,xt,an,ar,qv,Pg;const ze=class ze{constructor({data:e,extra:t}){R(this,an);R(this,Zr);R(this,Fm);R(this,xt);T(this,Zr,e),T(this,Fm,new TextDecoder),T(this,xt,new DataView(d(this,Zr))),t&&Object.assign(this,t)}get black(){return M(this,an,ar).call(this,0)}get bold(){return M(this,an,ar).call(this,1)}get disableFontFace(){return M(this,an,ar).call(this,2)}get fontExtraProperties(){return M(this,an,ar).call(this,3)}get isInvalidPDFjsFont(){return M(this,an,ar).call(this,4)}get isType3Font(){return M(this,an,ar).call(this,5)}get italic(){return M(this,an,ar).call(this,6)}get missingFile(){return M(this,an,ar).call(this,7)}get remeasure(){return M(this,an,ar).call(this,8)}get vertical(){return M(this,an,ar).call(this,9)}get ascent(){return M(this,an,qv).call(this,0)}get defaultWidth(){return M(this,an,qv).call(this,1)}get descent(){return M(this,an,qv).call(this,2)}get bbox(){let e=d(ze,vf);if(d(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(d(this,xt).getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=d(ze,bf);if(d(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(d(this,xt).getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=d(ze,_f);if(d(this,xt).getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(d(this,xt).getInt16(e,!0)),e+=2;return n}get fallbackName(){return M(this,an,Pg).call(this,0)}get loadedName(){return M(this,an,Pg).call(this,1)}get mimetype(){return M(this,an,Pg).call(this,2)}get name(){return M(this,an,Pg).call(this,3)}get data(){let e=d(ze,os);const t=d(this,xt).getUint32(e);e+=4+t;const n=d(this,xt).getUint32(e);e+=4+n;const s=d(this,xt).getUint32(e);e+=4+s;const o=d(this,xt).getUint32(e);if(o!==0)return new Uint8Array(d(this,Zr),e+4,o)}clearData(){let e=d(ze,os);const t=d(this,xt).getUint32(e);e+=4+t;const n=d(this,xt).getUint32(e);e+=4+n;const s=d(this,xt).getUint32(e);e+=4+s;const o=d(this,xt).getUint32(e);new Uint8Array(d(this,Zr),e+4,o).fill(0),d(this,xt).setUint32(e,0)}get cssFontInfo(){let e=d(ze,os);const t=d(this,xt).getUint32(e);e+=4+t;const n=d(this,xt).getUint32(e);e+=4+n;const s=d(this,xt).getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(d(this,Zr),e+4,s)),new Ib(o.buffer)}get systemFontInfo(){let e=d(ze,os);const t=d(this,xt).getUint32(e);e+=4+t;const n=d(this,xt).getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Zr),e+4,n)),new Nb(s.buffer)}static write(e){const t=e.systemFontInfo?Nb.write(e.systemFontInfo):null,n=e.cssFontInfo?Ib.write(e.cssFontInfo):null,s=new TextEncoder,o={};let l=0;for(const x of ze.strings)o[x]=s.encode(e[x]),l+=4+o[x].length;const c=d(ze,os)+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),g=new DataView(h);let y=0;const b=ze.bools.length;let A=0,w=0;for(let x=0;x<b;x++){const N=e[ze.bools[x]];A|=(N===void 0?0:N?2:1)<<w,w+=2,(w===8||x===b-1)&&(g.setUint8(y++,A),A=0,w=0)}ot(y===d(ze,yf),"FontInfo.write: Boolean properties offset mismatch");for(const x of ze.numbers)g.setFloat64(y,e[x]),y+=8;if(ot(y===d(ze,vf),"FontInfo.write: Number properties offset mismatch"),e.bbox){g.setUint8(y++,4);for(const x of e.bbox)g.setInt16(y,x,!0),y+=2}else g.setUint8(y++,0),y+=8;if(ot(y===d(ze,bf),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){g.setUint8(y++,6);for(const x of e.fontMatrix)g.setFloat64(y,x,!0),y+=8}else g.setUint8(y++,0),y+=48;if(ot(y===d(ze,_f),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){g.setUint8(y++,1);for(const x of e.defaultVMetrics)g.setInt16(y,x,!0),y+=2}else g.setUint8(y++,0),y+=6;ot(y===d(ze,os),"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(d(ze,os),0),y+=4;for(const x of ze.strings){const N=o[x],I=N.length;g.setUint32(y,I),f.set(N,y+4),y+=4+I}if(g.setUint32(d(ze,os),y-d(ze,os)-4),!t)g.setUint32(y,0),y+=4;else{const x=t.byteLength;g.setUint32(y,x),ot(y+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),y+4),y+=4+x}if(!n)g.setUint32(y,0),y+=4;else{const x=n.byteLength;g.setUint32(y,x),ot(y+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),y+4),y+=4+x}return e.data===void 0?(g.setUint32(y,0),y+=4):(g.setUint32(y,e.data.length),f.set(e.data,y+4),y+=4+e.data.length),ot(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}};yf=new WeakMap,vf=new WeakMap,bf=new WeakMap,_f=new WeakMap,os=new WeakMap,Zr=new WeakMap,Fm=new WeakMap,xt=new WeakMap,an=new WeakSet,ar=function(e){ot(e<ze.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=d(this,xt).getUint8(t)>>n&3;return s===0?void 0:s===2},qv=function(e){return ot(e<ze.numbers.length,"Invalid number index"),d(this,xt).getFloat64(d(ze,yf)+e*8)},Pg=function(e){ot(e<ze.strings.length,"Invalid string index");let t=d(ze,os)+4;for(let o=0;o<e;o++)t+=d(this,xt).getUint32(t)+4;const n=d(this,xt).getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(d(this,Zr),t+4,n)),d(this,Fm).decode(s)},ce(ze,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),ce(ze,"numbers",["ascent","defaultWidth","descent"]),ce(ze,"strings",["fallbackName","loadedName","mimetype","name"]),R(ze,yf,Math.ceil(ze.bools.length*2/8)),R(ze,vf,d(ze,yf)+ze.numbers.length*8),R(ze,bf,d(ze,vf)+1+8),R(ze,_f,d(ze,bf)+1+48),R(ze,os,d(ze,_f)+1+6);let ST=ze;var Bm,Hm;class Qs{static get workerPort(){return d(this,Bm)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");T(this,Bm,e)}static get workerSrc(){return d(this,Hm)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");T(this,Hm,e)}}Bm=new WeakMap,Hm=new WeakMap,R(Qs,Bm,null),R(Qs,Hm,"");var Sf,Gm;class gq{constructor({parsedData:e,rawData:t}){R(this,Sf);R(this,Gm);T(this,Sf,e),T(this,Gm,t)}getRaw(){return d(this,Gm)}get(e){return d(this,Sf).get(e)??null}[Symbol.iterator](){return d(this,Sf).entries()}}Sf=new WeakMap,Gm=new WeakMap;const _h=Symbol("INTERNAL");var zm,Vm,qm,Af;class mq{constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){R(this,zm,!1);R(this,Vm,!1);R(this,qm,!1);R(this,Af,!0);T(this,zm,!!(e&_s.DISPLAY)),T(this,Vm,!!(e&_s.PRINT)),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(d(this,qm))return d(this,Af);if(!d(this,Af))return!1;const{print:e,view:t}=this.usage;return d(this,zm)?(t==null?void 0:t.viewState)!=="OFF":d(this,Vm)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==_h&&Lt("Internal method `_setVisible` called."),T(this,qm,n),T(this,Af,t)}}zm=new WeakMap,Vm=new WeakMap,qm=new WeakMap,Af=new WeakMap;var zl,Ct,Ef,Tf,$m,AT;class yq{constructor(e,t=_s.DISPLAY){R(this,$m);R(this,zl,null);R(this,Ct,new Map);R(this,Ef,null);R(this,Tf,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,T(this,Tf,e.order);for(const n of e.groups)d(this,Ct).set(n.id,new mq(t,n));if(e.baseState==="OFF")for(const n of d(this,Ct).values())n._setVisible(_h,!1);for(const n of e.on)d(this,Ct).get(n)._setVisible(_h,!0);for(const n of e.off)d(this,Ct).get(n)._setVisible(_h,!1);T(this,Ef,this.getHash())}}isVisible(e){if(d(this,Ct).size===0)return!0;if(!e)return b_("Optional content group not defined."),!0;if(e.type==="OCG")return d(this,Ct).has(e.id)?d(this,Ct).get(e.id).visible:(Fe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return M(this,$m,AT).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!d(this,Ct).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(d(this,Ct).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!d(this,Ct).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!d(this,Ct).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!d(this,Ct).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(!d(this,Ct).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!d(this,Ct).has(t))return Fe(`Optional content group not found: ${t}`),!0;if(d(this,Ct).get(t).visible)return!1}return!0}return Fe(`Unknown optional content policy ${e.policy}.`),!0}return Fe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var o;const s=d(this,Ct).get(e);if(!s){Fe(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const l of s.rbGroups)for(const c of l)c!==e&&((o=d(this,Ct).get(c))==null||o._setVisible(_h,!1,!0));s._setVisible(_h,!!t,!0),T(this,zl,null)}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=d(this,Ct).get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}T(this,zl,null)}get hasInitialVisibility(){return d(this,Ef)===null||this.getHash()===d(this,Ef)}getOrder(){return d(this,Ct).size?d(this,Tf)?d(this,Tf).slice():[...d(this,Ct).keys()]:null}getGroup(e){return d(this,Ct).get(e)||null}getHash(){if(d(this,zl)!==null)return d(this,zl);const e=new D2;for(const[t,n]of d(this,Ct))e.update(`${t}:${n.visible}`);return T(this,zl,e.hexdigest())}[Symbol.iterator](){return d(this,Ct).entries()}}zl=new WeakMap,Ct=new WeakMap,Ef=new WeakMap,Tf=new WeakMap,$m=new WeakSet,AT=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let l;if(Array.isArray(o))l=M(this,$m,AT).call(this,o);else if(d(this,Ct).has(o))l=d(this,Ct).get(o).visible;else return Fe(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class vq{constructor(e,{disableRange:t=!1,disableStream:n=!1}){ot(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(o==null?void 0:o.length)>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});ot(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,s,o;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(o=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||o.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ot(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new bq(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new _q(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class bq{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=S_(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class _q{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Sq(i){let e=!0,t=n("filename\\*","i").exec(i);if(t){t=t[1];let g=c(t);return g=unescape(g),g=h(g),g=f(g),o(g)}if(t=l(i),t){const g=f(t);return o(g)}if(t=n("filename","i").exec(i),t){t=t[1];let g=c(t);return g=f(g),o(g)}function n(g,y){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function s(g,y){if(g){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const b=new TextDecoder(g,{fatal:!0}),A=zy(y);y=b.decode(A),e=!1}catch{}}return y}function o(g){return e&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),e&&(g=s("iso-8859-1",g))),g}function l(g){const y=[];let b;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(g))!==null;){let[,x,N,I]=b;if(x=parseInt(x,10),x in y){if(x===0)break;continue}y[x]=[N,I]}const w=[];for(let x=0;x<y.length&&x in y;++x){let[N,I]=y[x];I=c(I),N&&(I=unescape(I),x===0&&(I=h(I))),w.push(I)}return w.join("")}function c(g){if(g.startsWith('"')){const y=g.slice(1).split('\\"');for(let b=0;b<y.length;++b){const A=y[b].indexOf('"');A!==-1&&(y[b]=y[b].slice(0,A),y.length=b+1),y[b]=y[b].replaceAll(/\\(.)/g,"$1")}g=y.join('"')}return g}function h(g){const y=g.indexOf("'");if(y===-1)return g;const b=g.slice(0,y),w=g.slice(y+1).replace(/^[^']*'/,"");return s(b,w)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,N){return String.fromCharCode(parseInt(N,16))}),s(b,w);try{w=atob(w)}catch{}return s(b,w)})}return""}function $2(i,e){const t=new Headers;if(!i||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function A_(i){var e;return((e=URL.parse(i))==null?void 0:e.origin)??null}function Y2({responseHeaders:i,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function j2(i){const e=i.get("Content-Disposition");if(e){let t=Sq(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(S_(t))return t}return null}function Yy(i,e){return new Jg(`Unexpected server response (${i}) while retrieving PDF "${e}".`,i,i===404||i===0&&e.startsWith("file:"))}function W2(i){return i===200||i===206}function X2(i,e,t){return{method:"GET",headers:i,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function K2(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(Fe(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class Aq{constructor(e){ce(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=$2(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Eq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Tq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Eq{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,X2(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=A_(o.url),!W2(o.status))throw Yy(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=Y2({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=j2(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ka("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:K2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Tq{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,X2(o,this._withCredentials,this._abortController)).then(c=>{const h=A_(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!W2(c.status))throw Yy(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:K2(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const uE=200,dE=206;function wq(i){const e=i.response;return typeof e!="string"?e:zy(e).buffer}class xq{constructor({url:e,httpHeaders:t,withCredentials:n}){ce(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=$2(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,l]of this.headers)t.setRequestHeader(o,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=dE):s.expectedStatus=uE,t.responseType="arraybuffer",ot(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var s;const n=this.pendingRequests[e];n&&((s=n.onProgress)==null||s.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||uE;if(!(o===uE&&n.expectedStatus===dE)&&o!==n.expectedStatus){n.onError(s.status);return}const c=wq(s);if(o===dE){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(Fe('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Cq{constructor(e){this._source=e,this._manager=new xq(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ot(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Rq(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new Iq(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Rq{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=A_(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=Y2({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=j2(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Yy(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Iq{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=A_((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Yy(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Nq=/^[a-z][a-z0-9\-+.]+:/i;function Mq(i){if(Nq.test(i))return new URL(i);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(i))}class Dq{constructor(e){this.source=e,this.url=Mq(e.url),ot(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new kq(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Pq(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class kq{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Yy(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ka("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Pq{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vg=Symbol("INITIAL_DATA");var as,Ym,ET;class J2{constructor(){R(this,Ym);R(this,as,Object.create(null))}get(e,t=null){if(t){const s=M(this,Ym,ET).call(this,e);return s.promise.then(()=>t(s.data)),null}const n=d(this,as)[e];if(!n||n.data===vg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=d(this,as)[e];return!!t&&t.data!==vg}delete(e){const t=d(this,as)[e];return!t||t.data===vg?!1:(delete d(this,as)[e],!0)}resolve(e,t=null){const n=M(this,Ym,ET).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in d(this,as)){const{data:n}=d(this,as)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}T(this,as,Object.create(null))}*[Symbol.iterator](){for(const e in d(this,as)){const{data:t}=d(this,as)[e];t!==vg&&(yield[e,t])}}}as=new WeakMap,Ym=new WeakSet,ET=function(e){var t;return(t=d(this,as))[e]||(t[e]={...Promise.withResolvers(),data:vg})};const Lq=1e5,jM=30;var jD,Vl,Vi,jm,Wm,Ru,aa,Xm,Km,Iu,wf,xf,ql,Cf,Jm,Rf,Nu,Qm,Zm,on,If,Mu,ey,$l,Nf,Ba,Q2,Z2,TT,ws,$v,wT,eP,tP;let tm=(on=class{constructor({textContentSource:e,container:t,viewport:n}){R(this,Ba);R(this,Vl,Promise.withResolvers());R(this,Vi,null);R(this,jm,!1);R(this,Wm,!!((jD=globalThis.FontInspector)!=null&&jD.enabled));R(this,Ru,null);R(this,aa,null);R(this,Xm,0);R(this,Km,0);R(this,Iu,null);R(this,wf,null);R(this,xf,0);R(this,ql,0);R(this,Cf,Object.create(null));R(this,Jm,[]);R(this,Rf,null);R(this,Nu,[]);R(this,Qm,new WeakMap);R(this,Zm,null);var h;if(e instanceof ReadableStream)T(this,Rf,e);else if(typeof e=="object")T(this,Rf,new ReadableStream({start(f){f.enqueue(e),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,Vi,T(this,wf,t)),T(this,ql,n.scale*xr.pixelRatio),T(this,xf,n.rotation),T(this,aa,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:o,pageX:l,pageY:c}=n.rawDims;T(this,Zm,[1,0,0,-1,-l,c+o]),T(this,Km,s),T(this,Xm,o),M(h=on,ws,eP).call(h),vc(t,n),d(this,Vl).promise.finally(()=>{d(on,Nf).delete(this),T(this,aa,null),T(this,Cf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=On.platform;return $e(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{d(this,Iu).read().then(({value:t,done:n})=>{if(n){d(this,Vl).resolve();return}d(this,Ru)??T(this,Ru,t.lang),Object.assign(d(this,Cf),t.styles),M(this,Ba,Q2).call(this,t.items),e()},d(this,Vl).reject)};return T(this,Iu,d(this,Rf).getReader()),d(on,Nf).add(this),e(),d(this,Vl).promise}update({viewport:e,onBefore:t=null}){var o;const n=e.scale*xr.pixelRatio,s=e.rotation;if(s!==d(this,xf)&&(t==null||t(),T(this,xf,s),vc(d(this,wf),{rotation:s})),n!==d(this,ql)){t==null||t(),T(this,ql,n);const l={div:null,properties:null,ctx:M(o=on,ws,$v).call(o,d(this,Ru))};for(const c of d(this,Nu))l.properties=d(this,Qm).get(c),l.div=c,M(this,Ba,TT).call(this,l)}}cancel(){var t;const e=new ka("TextLayer task cancelled.");(t=d(this,Iu))==null||t.cancel(e).catch(()=>{}),T(this,Iu,null),d(this,Vl).reject(e)}get textDivs(){return d(this,Nu)}get textContentItemsStr(){return d(this,Jm)}static cleanup(){if(!(d(this,Nf).size>0)){d(this,If).clear();for(const{canvas:e}of d(this,Mu).values())e.remove();d(this,Mu).clear()}}},Vl=new WeakMap,Vi=new WeakMap,jm=new WeakMap,Wm=new WeakMap,Ru=new WeakMap,aa=new WeakMap,Xm=new WeakMap,Km=new WeakMap,Iu=new WeakMap,wf=new WeakMap,xf=new WeakMap,ql=new WeakMap,Cf=new WeakMap,Jm=new WeakMap,Rf=new WeakMap,Nu=new WeakMap,Qm=new WeakMap,Zm=new WeakMap,If=new WeakMap,Mu=new WeakMap,ey=new WeakMap,$l=new WeakMap,Nf=new WeakMap,Ba=new WeakSet,Q2=function(e){var s,o;if(d(this,jm))return;(o=d(this,aa)).ctx??(o.ctx=M(s=on,ws,$v).call(s,d(this,Ru)));const t=d(this,Nu),n=d(this,Jm);for(const l of e){if(t.length>Lq){Fe("Ignoring additional textDivs for performance reasons."),T(this,jm,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=d(this,Vi);T(this,Vi,document.createElement("span")),d(this,Vi).classList.add("markedContent"),l.id&&d(this,Vi).setAttribute("id",`${l.id}`),c.append(d(this,Vi))}else l.type==="endMarkedContent"&&T(this,Vi,d(this,Vi).parentNode);continue}n.push(l.str),M(this,Ba,Z2).call(this,l)}},Z2=function(e){var x;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};d(this,Nu).push(t);const s=be.transform(d(this,Zm),e.transform);let o=Math.atan2(s[1],s[0]);const l=d(this,Cf)[e.fontName];l.vertical&&(o+=Math.PI/2);let c=d(this,Wm)&&l.fontSubstitution||l.fontFamily;c=on.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*M(x=on,ws,tP).call(x,c,l,d(this,Ru));let g,y;o===0?(g=s[4],y=s[5]-f):(g=s[4]+f*Math.sin(o),y=s[5]-f*Math.cos(o));const b="calc(var(--total-scale-factor) *",A=t.style;d(this,Vi)===d(this,wf)?(A.left=`${(100*g/d(this,Km)).toFixed(2)}%`,A.top=`${(100*y/d(this,Xm)).toFixed(2)}%`):(A.left=`${b}${g.toFixed(2)}px)`,A.top=`${b}${y.toFixed(2)}px)`),A.fontSize=`${b}${(d(on,$l)*h).toFixed(2)}px)`,A.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,d(this,Wm)&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),I=Math.abs(e.transform[3]);N!==I&&Math.max(N,I)/Math.min(N,I)>1.5&&(w=!0)}if(w&&(n.canvasWidth=l.vertical?e.height:e.width),d(this,Qm).set(t,n),d(this,aa).div=t,d(this,aa).properties=n,M(this,Ba,TT).call(this,d(this,aa)),n.hasText&&d(this,Vi).append(t),n.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),d(this,Vi).append(N)}},TT=function(e){var c;const{div:t,properties:n,ctx:s}=e,{style:o}=t;let l="";if(d(on,$l)>1&&(l=`scale(${1/d(on,$l)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=o,{canvasWidth:f,fontSize:g}=n;M(c=on,ws,wT).call(c,s,g*d(this,ql),h);const{width:y}=s.measureText(t.textContent);y>0&&(l=`scaleX(${f*d(this,ql)/y}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(o.transform=l)},ws=new WeakSet,$v=function(e=null){let t=d(this,Mu).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),d(this,Mu).set(e,t),d(this,ey).set(t,{size:0,family:""})}return t},wT=function(e,t,n){const s=d(this,ey).get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)},eP=function(){if(d(this,$l)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),T(this,$l,e.getBoundingClientRect().height),e.remove()},tP=function(e,t,n){const s=d(this,If).get(e);if(s)return s;const o=M(this,ws,$v).call(this,n);o.canvas.width=o.canvas.height=jM,M(this,ws,wT).call(this,o,jM,e);const l=o.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(On.platform.isFirefox&&Fe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),d(this,If).set(e,f),f},R(on,ws),R(on,If,new Map),R(on,Mu,new Map),R(on,ey,new WeakMap),R(on,$l,null),R(on,Nf,new Set),on);const Oq=100;function sx(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const e=new xT,{docId:t}=e,n=i.url?q8(i.url):null,s=i.data?$8(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,c=i.password??null,h=i.range instanceof rx?i.range:null,f=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let g=i.worker instanceof pp?i.worker:null;const y=i.verbosity,b=typeof i.docBaseUrl=="string"&&!qy(i.docBaseUrl)?i.docBaseUrl:null,A=Ev(i.cMapUrl),w=i.cMapPacked!==!1,x=i.CMapReaderFactory||(Ei?Q8:kM),N=Ev(i.iccUrl),I=Ev(i.standardFontDataUrl),P=i.StandardFontDataFactory||(Ei?Z8:PM),k=Ev(i.wasmUrl),L=i.WasmFactory||(Ei?eq:LM),O=i.stopAtErrors!==!0,F=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,U=i.isEvalSupported!==!1,X=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Ei,q=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Ei&&(On.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,ee=typeof i.disableFontFace=="boolean"?i.disableFontFace:Ei,se=i.fontExtraProperties===!0,le=i.enableXfa===!0,ue=i.ownerDocument||globalThis.document,ye=i.disableRange===!0,G=i.disableStream===!0,$=i.disableAutoFetch===!0,oe=i.pdfBug===!0,ge=i.CanvasFactory||(Ei?J8:W8),Me=i.FilterFactory||(Ei?K8:X8),H=i.enableHWA===!0,K=i.useWasm!==!1,re=h?h.length:i.length??NaN,de=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Ei&&!ee,_e=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(x===kM&&P===PM&&L===LM&&A&&I&&k&&Ag(A,document.baseURI)&&Ag(I,document.baseURI)&&Ag(k,document.baseURI)),Se=null;w8(y);const Te={canvasFactory:new ge({ownerDocument:ue,enableHWA:H}),filterFactory:new Me({docId:t,ownerDocument:ue}),cMapReaderFactory:_e?null:new x({baseUrl:A,isCompressed:w}),standardFontDataFactory:_e?null:new P({baseUrl:I}),wasmFactory:_e?null:new L({baseUrl:k})};g||(g=pp.create({verbosity:y,port:Qs.workerPort}),e._worker=g);const Ke={docId:t,apiVersion:"5.4.296",data:s,password:c,disableAutoFetch:$,rangeChunkSize:f,length:re,docBaseUrl:b,enableXfa:le,evaluatorOptions:{maxImageSize:F,disableFontFace:ee,ignoreErrors:O,isEvalSupported:U,isOffscreenCanvasSupported:X,isImageDecoderSupported:q,canvasMaxAreaInBytes:Z,fontExtraProperties:se,useSystemFonts:de,useWasm:K,useWorkerFetch:_e,cMapUrl:A,iccUrl:N,standardFontDataUrl:I,wasmUrl:k}},Ve={ownerDocument:ue,pdfBug:oe,styleElement:Se,loadingParams:{disableAutoFetch:$,enableXfa:le}};return g.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const zt=g.messageHandler.sendWithPromise("GetDocRequest",Ke,s?[s.buffer]:null);let We;if(h)We=new vq(h,{disableRange:ye,disableStream:G});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Fn=Ag(n)?Aq:Ei?Dq:Cq;We=new Fn({url:n,length:re,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:ye,disableStream:G})}return zt.then(Fn=>{if(e.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const at=new Rg(t,Fn,g.port),Je=new Bq(at,e,We,Ve,Te,H);e._transport=Je,at.send("Ready",null)})}).catch(e._capability.reject),e}var t_;const n_=class n_{constructor(){ce(this,"_capability",Promise.withResolvers());ce(this,"_transport",null);ce(this,"_worker",null);ce(this,"docId",`d${An(n_,t_)._++}`);ce(this,"destroyed",!1);ce(this,"onPassword",null);ce(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,n,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(o){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,o}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};t_=new WeakMap,R(n_,t_,0);let xT=n_;var Du,ty,ny,iy,sy,WD;let rx=(WD=class{constructor(e,t,n=!1,s=null){R(this,Du,Promise.withResolvers());R(this,ty,[]);R(this,ny,[]);R(this,iy,[]);R(this,sy,[]);this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){d(this,sy).push(e)}addProgressListener(e){d(this,iy).push(e)}addProgressiveReadListener(e){d(this,ny).push(e)}addProgressiveDoneListener(e){d(this,ty).push(e)}onDataRange(e,t){for(const n of d(this,sy))n(e,t)}onDataProgress(e,t){d(this,Du).promise.then(()=>{for(const n of d(this,iy))n(e,t)})}onDataProgressiveRead(e){d(this,Du).promise.then(()=>{for(const t of d(this,ny))t(e)})}onDataProgressiveDone(){d(this,Du).promise.then(()=>{for(const e of d(this,ty))e()})}transportReady(){d(this,Du).resolve()}requestDataRange(e,t){Lt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Du=new WeakMap,ty=new WeakMap,ny=new WeakMap,iy=new WeakMap,sy=new WeakMap,WD);class Uq{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var la,ku,Lg;class Fq{constructor(e,t,n,s=!1){R(this,ku);R(this,la,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new xM:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new J2,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new Vy({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return $e(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=uo.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:y=null,isEditing:b=!1,recordOperations:A=!1,operationsFilter:w=null}){var q,Z,ee;(q=this._stats)==null||q.time("Overall");const x=this._transport.getRenderingIntent(s,o,y,b),{renderingIntent:N,cacheKey:I}=x;T(this,la,!1),h||(h=this._transport.getOptionalContentConfig(N));let P=this._intentStates.get(I);P||(P=Object.create(null),this._intentStates.set(I,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);const k=!!(N&_s.PRINT);P.displayReadyCapability||(P.displayReadyCapability=Promise.withResolvers(),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Z=this._stats)==null||Z.time("Page Request"),this._pumpOperatorList(x));const L=!!(this._pdfBug&&((ee=globalThis.StepperManager)!=null&&ee.enabled)),O=!this.recordedBBoxes&&(A||L),F=se=>{var le,ue;if(P.renderTasks.delete(U),O){const ye=(le=U.gfx)==null?void 0:le.dependencyTracker.take();ye&&(U.stepper&&U.stepper.setOperatorBBoxes(ye,U.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=ye))}k&&T(this,la,!0),M(this,ku,Lg).call(this),se?(U.capability.reject(se),this._abortOperatorList({intentState:P,reason:se instanceof Error?se:new Error(se)})):U.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(ue=globalThis.Stats)!=null&&ue.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},U=new CT({callback:F,params:{canvas:t,canvasContext:e,dependencyTracker:O?new nq(t,P.operatorList.length,L):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:w});(P.renderTasks||(P.renderTasks=new Set)).add(U);const X=U.task;return Promise.all([P.displayReadyCapability.promise,h]).then(([se,le])=>{var ue;if(this.destroyed){F();return}if((ue=this._stats)==null||ue.time("Rendering"),!(le.renderingIntent&N))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");U.initializeGraphics({transparency:se,optionalContentConfig:le}),U.operatorListChanged()}).catch(F),X}getOperatorList({intent:e="display",annotationMode:t=uo.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){var f;function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Qg.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){l.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??(c.lang=h.lang),Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),T(this,la,!1),Promise.all(e)}cleanup(e=!1){T(this,la,!0);const t=M(this,ku,Lg).call(this);return e&&t&&this._stats&&(this._stats=new xM),t}_startRenderPage(e,t){var s,o;const n=this._intentStates.get(t);n&&((s=this._stats)==null||s.timeEnd("Page Request"),(o=n.displayReadyCapability)==null||o.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&M(this,ku,Lg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},l).getReader(),f=this._intentStates.get(t);f.streamReader=h;const g=()=>{h.read().then(({value:y,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),g())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();M(this,ku,Lg).call(this)}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};g()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof __){let s=Oq;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new ka(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}la=new WeakMap,ku=new WeakSet,Lg=function(){if(!d(this,la)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,la,!1),!0};var Yl,pr,ca,Pu,i_,Lu,Ou,Ti,Yv,nP,iP,Og,Mf,jv;const $t=class $t{constructor({name:e=null,port:t=null,verbosity:n=x8()}={}){R(this,Ti);R(this,Yl,Promise.withResolvers());R(this,pr,null);R(this,ca,null);R(this,Pu,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(d($t,Ou).has(t))throw new Error("Cannot use more than one PDFWorker per port.");d($t,Ou).set(t,this),M(this,Ti,nP).call(this,t)}else M(this,Ti,iP).call(this)}get promise(){return d(this,Yl).promise}get port(){return d(this,ca)}get messageHandler(){return d(this,pr)}destroy(){var e,t;this.destroyed=!0,(e=d(this,Pu))==null||e.terminate(),T(this,Pu,null),d($t,Ou).delete(d(this,ca)),T(this,ca,null),(t=d(this,pr))==null||t.destroy(),T(this,pr,null)}static create(e){const t=d(this,Ou).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new $t(e)}static get workerSrc(){if(Qs.workerSrc)return Qs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return $e(this,"_setupFakeWorkerGlobal",(async()=>d(this,Mf,jv)?d(this,Mf,jv):(await import(this.workerSrc)).WorkerMessageHandler)())}};Yl=new WeakMap,pr=new WeakMap,ca=new WeakMap,Pu=new WeakMap,i_=new WeakMap,Lu=new WeakMap,Ou=new WeakMap,Ti=new WeakSet,Yv=function(){d(this,Yl).resolve(),d(this,pr).send("configure",{verbosity:this.verbosity})},nP=function(e){T(this,ca,e),T(this,pr,new Rg("main","worker",e)),d(this,pr).on("ready",()=>{}),M(this,Ti,Yv).call(this)},iP=function(){if(d($t,Lu)||d($t,Mf,jv)){M(this,Ti,Og).call(this);return}let{workerSrc:e}=$t;try{$t._isSameOrigin(window.location,e)||(e=$t._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Rg("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?d(this,Yl).reject(new Error("Worker was destroyed")):M(this,Ti,Og).call(this)},o=new AbortController;t.addEventListener("error",()=>{d(this,Pu)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}T(this,pr,n),T(this,ca,t),T(this,Pu,t),M(this,Ti,Yv).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{M(this,Ti,Og).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{b_("The worker has been disabled.")}M(this,Ti,Og).call(this)},Og=function(){d($t,Lu)||(Fe("Setting up fake worker."),T($t,Lu,!0)),$t._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){d(this,Yl).reject(new Error("Worker was destroyed"));return}const t=new j8;T(this,ca,t);const n=`fake${An($t,i_)._++}`,s=new Rg(n+"_worker",n,t);e.setup(s,t),T(this,pr,new Rg(n,n+"_worker",t)),M(this,Ti,Yv).call(this)}).catch(e=>{d(this,Yl).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Mf=new WeakSet,jv=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},R($t,Mf),R($t,i_,0),R($t,Lu,!1),R($t,Ou,new WeakMap),Ei&&(T($t,Lu,!0),Qs.workerSrc||(Qs.workerSrc="./pdf.worker.mjs")),$t._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},$t._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},$t.fromPort=e=>{if(L8("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return $t.create(e)};let pp=$t;var ua,eo,Df,kf,da,Uu,Ug;class Bq{constructor(e,t,n,s,o,l){R(this,Uu);R(this,ua,new Map);R(this,eo,new Map);R(this,Df,new Map);R(this,kf,new Map);R(this,da,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new J2,this.fontLoader=new z8({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}get annotationStorage(){return $e(this,"annotationStorage",new tx)}getRenderingIntent(e,t=uo.ENABLE,n=null,s=!1,o=!1){let l=_s.DISPLAY,c=uT;switch(e){case"any":l=_s.ANY;break;case"display":break;case"print":l=_s.PRINT;break;default:Fe(`getRenderingIntent - invalid intent: ${e}`)}const h=l&_s.PRINT&&n instanceof P2?n:this.annotationStorage;switch(t){case uo.DISABLE:l+=_s.ANNOTATIONS_DISABLE;break;case uo.ENABLE:break;case uo.ENABLE_FORMS:l+=_s.ANNOTATIONS_FORMS;break;case uo.ENABLE_STORAGE:l+=_s.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Fe(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=_s.IS_EDITING),o&&(l+=_s.OPLIST);const{ids:f,hash:g}=h.modifiedIds,y=[l,c.hash,g];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=d(this,da))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of d(this,eo).values())e.push(s._destroy());d(this,eo).clear(),d(this,Df).clear(),d(this,kf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,o;this.commonObjs.clear(),this.fontLoader.clear(),d(this,ua).clear(),this.filterFactory.destroy(),tm.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new ka("Worker was terminated.")),(o=this.messageHandler)==null||o.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{ot(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}ot(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:l}=this._fullReader;return(!s||!o)&&(this._lastProgress&&((c=t.onProgress)==null||c.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var f;(f=t.onProgress)==null||f.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{ot(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){s.close();return}ot(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Uq(n,this))}),e.on("DocException",n=>{t._capability.reject(Ui(n))}),e.on("PasswordRequest",n=>{T(this,da,Promise.withResolvers());try{if(!t.onPassword)throw Ui(n);const s=o=>{o instanceof Error?d(this,da).reject(o):d(this,da).resolve({password:o})};t.onPassword(s,n.code)}catch(s){d(this,da).reject(s)}return d(this,da).promise}),e.on("DataLoaded",n=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;d(this,eo).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const y=o.error;Fe(`Error during font loading: ${y}`),this.commonObjs.resolve(n,y);break}const c=new ST(o),h=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(y,b)=>globalThis.FontInspector.fontAdded(y,b):null,f=new V8(c,h,o.extra,o.charProcOperatorList);this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&f.clearData(),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:g}=o;ot(g,"The imageRef must be defined.");for(const y of d(this,eo).values())for(const[,b]of y.objs)if((b==null?void 0:b.ref)===g)return b.dataLen?(this.commonObjs.resolve(n,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,l])=>{var h;if(this.destroyed)return;const c=d(this,eo).get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Fe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=d(this,Df).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&d(this,kf).set(o.refStr,e);const l=new Fq(t,o,this,this._params.pdfBug);return d(this,eo).set(t,l),l});return d(this,Df).set(t,s),s}getPageIndex(e){return dT(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return M(this,Uu,Ug).call(this,"GetFieldObjects")}hasJSActions(){return M(this,Uu,Ug).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return M(this,Uu,Ug).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return M(this,Uu,Ug).call(this,"GetOptionalContentConfig").then(t=>new yq(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=d(this,ua).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>{var o,l;return{info:s[0],metadata:s[1]?new gq(s[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return d(this,ua).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of d(this,eo).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),d(this,ua).clear(),this.filterFactory.destroy(!0),tm.cleanup()}}cachedPageNumber(e){if(!dT(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return d(this,kf).get(t)??null}}ua=new WeakMap,eo=new WeakMap,Df=new WeakMap,kf=new WeakMap,da=new WeakMap,Uu=new WeakSet,Ug=function(e,t=null){const n=d(this,ua).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return d(this,ua).set(e,s),s};var jl;class Hq{constructor(e){R(this,jl,null);ce(this,"onContinue",null);ce(this,"onError",null);T(this,jl,e)}get promise(){return d(this,jl).capability.promise}cancel(e=0){d(this,jl).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=d(this,jl).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=d(this,jl);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}jl=new WeakMap;var Wl,Fu;const Jc=class Jc{constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:y=!1,pageColors:b=null,enableHWA:A=!1,operationsFilter:w=null}){R(this,Wl,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Hq(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=A,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var h,f;if(this.cancelled)return;if(this._canvas){if(d(Jc,Fu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");d(Jc,Fu).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new kh(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(e=null,t=0){var n,s,o;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),d(this,Wl)&&(window.cancelAnimationFrame(d(this,Wl)),T(this,Wl,null)),d(Jc,Fu).delete(this._canvas),e||(e=new __(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(o=(s=this.task).onError)==null||o.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?T(this,Wl,window.requestAnimationFrame(()=>{T(this,Wl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),d(Jc,Fu).delete(this._canvas),this.callback())))}};Wl=new WeakMap,Fu=new WeakMap,R(Jc,Fu,new WeakSet);let CT=Jc;const ox="5.4.296",sP="f56dc8601";var ls,Bu,Pf,wn,ry,Lf,ha,oy,Xl,gr,ay,Rt,RT,IT,NT,Yc,rP,ml;const Fi=class Fi{constructor({editor:e=null,uiManager:t=null}){R(this,Rt);R(this,ls,null);R(this,Bu,null);R(this,Pf);R(this,wn,null);R(this,ry,!1);R(this,Lf,!1);R(this,ha,null);R(this,oy);R(this,Xl,null);R(this,gr,null);var n,s;e?(T(this,Lf,!1),T(this,ha,e)):T(this,Lf,!0),T(this,gr,(e==null?void 0:e._uiManager)||t),T(this,oy,d(this,gr)._eventBus),T(this,Pf,((n=e==null?void 0:e.color)==null?void 0:n.toUpperCase())||((s=d(this,gr))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),d(Fi,ay)||T(Fi,ay,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return $e(this,"_keyboardManager",new $y([[["Escape","mac+Escape"],Fi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Fi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Fi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Fi.prototype._moveToPrevious],[["Home","mac+Home"],Fi.prototype._moveToBeginning],[["End","mac+End"],Fi.prototype._moveToEnd]]))}renderButton(){const e=T(this,ls,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",d(this,ha)&&(e.ariaControls=`${d(this,ha).id}_colorpicker_dropdown`);const t=d(this,gr)._signal;e.addEventListener("click",M(this,Rt,Yc).bind(this),{signal:t}),e.addEventListener("keydown",M(this,Rt,NT).bind(this),{signal:t});const n=T(this,Bu,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=d(this,Pf),e.append(n),e}renderMainDropdown(){const e=T(this,wn,M(this,Rt,RT).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===d(this,ls)){M(this,Rt,Yc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&M(this,Rt,IT).call(this,t,e)}_moveToNext(e){var t,n;if(!d(this,Rt,ml)){M(this,Rt,Yc).call(this,e);return}if(e.target===d(this,ls)){(t=d(this,wn).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=d(this,wn))==null?void 0:t.firstChild)||e.target===d(this,ls)){d(this,Rt,ml)&&this._hideDropdownFromKeyboard();return}d(this,Rt,ml)||M(this,Rt,Yc).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!d(this,Rt,ml)){M(this,Rt,Yc).call(this,e);return}(t=d(this,wn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!d(this,Rt,ml)){M(this,Rt,Yc).call(this,e);return}(t=d(this,wn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=d(this,wn))==null||e.classList.add("hidden"),d(this,ls).ariaExpanded="false",(t=d(this,Xl))==null||t.abort(),T(this,Xl,null)}_hideDropdownFromKeyboard(){var e;if(!d(this,Lf)){if(!d(this,Rt,ml)){(e=d(this,ha))==null||e.unselect();return}this.hideDropdown(),d(this,ls).focus({preventScroll:!0,focusVisible:d(this,ry)})}}updateColor(e){if(d(this,Bu)&&(d(this,Bu).style.backgroundColor=e),!d(this,wn))return;const t=d(this,gr).highlightColors.values();for(const n of d(this,wn).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=d(this,ls))==null||e.remove(),T(this,ls,null),T(this,Bu,null),(t=d(this,wn))==null||t.remove(),T(this,wn,null)}};ls=new WeakMap,Bu=new WeakMap,Pf=new WeakMap,wn=new WeakMap,ry=new WeakMap,Lf=new WeakMap,ha=new WeakMap,oy=new WeakMap,Xl=new WeakMap,gr=new WeakMap,ay=new WeakMap,Rt=new WeakSet,RT=function(){const e=document.createElement("div"),t=d(this,gr)._signal;e.addEventListener("contextmenu",xs,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),d(this,ha)&&(e.id=`${d(this,ha).id}_colorpicker_dropdown`);for(const[n,s]of d(this,gr).highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",d(Fi,ay)[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.ariaSelected=s===d(this,Pf),o.addEventListener("click",M(this,Rt,IT).bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",M(this,Rt,NT).bind(this),{signal:t}),e},IT=function(e,t){t.stopPropagation(),d(this,oy).dispatch("switchannotationeditorparams",{source:this,type:it.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},NT=function(e){Fi._keyboardManager.exec(this,e)},Yc=function(e){if(d(this,Rt,ml)){this.hideDropdown();return}if(T(this,ry,e.detail===0),d(this,Xl)||(T(this,Xl,new AbortController),window.addEventListener("pointerdown",M(this,Rt,rP).bind(this),{signal:d(this,gr).combinedSignal(d(this,Xl))})),d(this,ls).ariaExpanded="true",d(this,wn)){d(this,wn).classList.remove("hidden");return}const t=T(this,wn,M(this,Rt,RT).call(this));d(this,ls).append(t)},rP=function(e){var t;(t=d(this,wn))!=null&&t.contains(e.target)||this.hideDropdown()},ml=function(){return d(this,wn)&&!d(this,wn).classList.contains("hidden")},R(Fi,ay,null);let nm=Fi;var to,ly,Of,cy;const Qc=class Qc{constructor(e){R(this,to,null);R(this,ly,null);R(this,Of,null);T(this,ly,e),T(this,Of,e._uiManager),d(Qc,cy)||T(Qc,cy,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(d(this,to))return d(this,to);const{editorType:e,colorType:t,colorValue:n}=d(this,ly),s=T(this,to,document.createElement("input"));return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",d(Qc,cy)[e]),s.addEventListener("input",()=>{d(this,Of).updateParams(t,s.value)},{signal:d(this,Of)._signal}),s}update(e){d(this,to)&&(d(this,to).value=e)}destroy(){var e;(e=d(this,to))==null||e.remove(),T(this,to,null)}hideDropdown(){}};to=new WeakMap,ly=new WeakMap,Of=new WeakMap,cy=new WeakMap,R(Qc,cy,null);let Mb=Qc;function WM(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function bg(i){return Math.max(0,Math.min(255,255*i))}class XM{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=bg(e),[e,e,e]}static G_HTML([e]){const t=WM(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(bg)}static RGB_HTML(e){return`#${e.map(WM).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[bg(1-Math.min(1,e+s)),bg(1-Math.min(1,n+s)),bg(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,l=1-n,c=Math.min(s,o,l);return["CMYK",s,o,l,c]}}class Gq{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Lt("Abstract method `_createSVG` called.")}}class im extends Gq{_createSVG(e){return document.createElementNS(Bo,e)}}const zq=9,hd=new WeakSet,Vq=new Date().getTimezoneOffset()*60*1e3;class KM{static create(e){switch(e.data.annotationType){case un.LINK:return new ax(e);case un.TEXT:return new $q(e);case un.WIDGET:switch(e.data.fieldType){case"Tx":return new Yq(e);case"Btn":return e.data.radioButton?new lP(e):e.data.checkBox?new Wq(e):new Xq(e);case"Ch":return new Kq(e);case"Sig":return new jq(e)}return new Sd(e);case un.POPUP:return new DT(e);case un.FREETEXT:return new fP(e);case un.LINE:return new Qq(e);case un.SQUARE:return new Zq(e);case un.CIRCLE:return new e$(e);case un.POLYLINE:return new pP(e);case un.CARET:return new n$(e);case un.INK:return new lx(e);case un.POLYGON:return new t$(e);case un.HIGHLIGHT:return new gP(e);case un.UNDERLINE:return new i$(e);case un.SQUIGGLY:return new s$(e);case un.STRIKEOUT:return new r$(e);case un.STAMP:return new mP(e);case un.FILEATTACHMENT:return new o$(e);default:return new Qt(e)}}}var Hu,Uf,Xs,uy,MT;const kx=class kx{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){R(this,uy);R(this,Hu,null);R(this,Uf,!1);R(this,Xs,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return kx._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:e}=this,t=(n=this.annotationStorage)==null?void 0:n.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var c;const e=(c=this.annotationStorage)==null?void 0:c.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,l=-1/0;if((t==null?void 0:t.length)>=8){for(let h=0;h<t.length;h+=8)t[h+1]>l?(l=t[h+1],o=t[h+2]):t[h+1]===l&&(o=Math.max(o,t[h+2]));return[o,l]}if((n==null?void 0:n.length)>=1){for(const h of n)for(let f=0,g=h.length;f<g;f+=2)h[f+1]>l?(l=h[f+1],o=h[f]):h[f+1]===l&&(o=Math.max(o,h[f]));if(o!==1/0)return[o,l]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-l)/s,e}get commentText(){var t,n,s;const{data:e}=this;return((n=(t=this.annotationStorage.getRawValue(`${Kg}${e.id}`))==null?void 0:t.popup)==null?void 0:n.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Kg}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=d(this,Xs))==null?void 0:e.popup)||this.popup)==null||t.remove(),T(this,Xs,this.popup=null)}updateEdited(e){var o;if(!this.container)return;e.rect&&(d(this,Hu)||T(this,Hu,{rect:this.data.rect.slice(0)}));const{rect:t,popup:n}=e;t&&M(this,uy,MT).call(this,t);let s=((o=d(this,Xs))==null?void 0:o.popup)||this.popup;!s&&(n!=null&&n.text)&&(this._createPopup(n),s=d(this,Xs).popup),s&&(s.updateEdited(e),n!=null&&n.deleted&&(s.remove(),T(this,Xs,null),this.popup=null))}resetEdited(){var e;d(this,Hu)&&(M(this,uy,MT).call(this,d(this,Hu).rect),(e=d(this,Xs))==null||e.popup.resetEdited(),T(this,Hu,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof Sd)&&!(this instanceof ax)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof DT){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(x>0||N>0){const P=`calc(${x}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;l.borderRadius=P}else if(this instanceof lP){const P=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=P}switch(t.borderStyle.style){case gh.SOLID:l.borderStyle="solid";break;case gh.DASHED:l.borderStyle="dashed";break;case gh.BEVELED:Fe("Unimplemented border style: beveled");break;case gh.INSET:Fe("Unimplemented border style: inset");break;case gh.UNDERLINE:l.borderBottomStyle="solid";break}const I=t.borderColor||null;I?(T(this,Uf,!0),l.borderColor=be.makeHexColor(I[0]|0,I[1]|0,I[2]|0)):l.borderWidth=0}const f=be.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:y,pageX:b,pageY:A}=s.rawDims;l.left=`${100*(f[0]-b)/g}%`,l.top=`${100*(f[1]-A)/y}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(l.width=`${100*c/g}%`,l.height=`${100*h/y}%`):this.setRotation(w,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:l}=this;e%180!==0&&([o,l]=[l,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*l/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],l=o[0],c=o.slice(1);s.target.style[n]=XM[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:XM[`${l}_rgb`](c)})};return $e(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail)){const o=e[s]||n[s];o==null||o(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:o},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,N,I,P]=e.subarray(2,6);if(s===x&&o===N&&t===I&&n===P)return}const{style:l}=this.container;let c;if(d(this,Uf)){const{borderColor:x,borderWidth:N}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:g}=this,y=g.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const b=g.createElement("defs");y.append(b);const A=g.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let x=2,N=e.length;x<N;x+=8){const I=e[x],P=e[x+1],k=e[x+2],L=e[x+3],O=g.createElement("rect"),F=(k-t)/h,U=(o-P)/f,X=(I-k)/h,q=(P-L)/f;O.setAttribute("x",F),O.setAttribute("y",U),O.setAttribute("width",X),O.setAttribute("height",q),A.append(O),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${U}" width="${X}" height="${q}"/>`)}d(this,Uf)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(y),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate);const o=T(this,Xs,new DT({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(d(this,Xs)||this.popup||this.data.popupRef)}get extraPopupElement(){return d(this,Xs)}render(){Lt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:l,exportValues:c}of s){if(o===-1||l===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!hd.has(f)){Fe(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==t&&hd.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Hu=new WeakMap,Uf=new WeakMap,Xs=new WeakMap,uy=new WeakSet,MT=function(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;n==null||n.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(l-e[3]+h)/l}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(s)};let Qt=kx;class qq extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var As,jc,oP,aP;class ax extends Qt{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});R(this,As);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let o=!1;return t.url?(n.addLinkAttributes(s,t.url,t.newWindow),o=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),o=!0):t.attachment?(M(this,As,oP).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),o=!0):t.setOCGState?(M(this,As,aP).call(this,s,t.setOCGState,t.overlaidText),o=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),o=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),o=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),o=!0):this.isTooltipOnly&&!o&&(this._bindLink(s,""),o=!0)),this.container.classList.add("linkAnnotation"),o&&this.container.append(s),this.container}_bindLink(t,n,s=""){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&M(this,As,jc).call(this),s&&(t.title=s)}_bindNamedAction(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),s&&(t.title=s),M(this,As,jc).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const o of Object.keys(n.actions)){const l=s.get(o);l&&(t[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:o}}),!1})}n.overlaidText&&(t.title=n.overlaidText),t.onclick||(t.onclick=()=>!1),M(this,As,jc).call(this)}_bindResetFormAction(t,n){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),M(this,As,jc).call(this),!this._fieldObjects){Fe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var y;s==null||s();const{fields:o,refs:l,include:c}=n,h=[];if(o.length!==0||l.length!==0){const b=new Set(l);for(const A of o){const w=this._fieldObjects[A]||[];for(const{id:x}of w)b.add(x)}for(const A of Object.values(this._fieldObjects))for(const w of A)b.has(w.id)===c&&h.push(w)}else for(const b of Object.values(this._fieldObjects))h.push(...b);const f=this.annotationStorage,g=[];for(const b of h){const{id:A}=b;switch(g.push(A),b.type){case"text":{const x=b.defaultValue||"";f.setValue(A,{value:x});break}case"checkbox":case"radiobutton":{const x=b.defaultValue===b.exportValues;f.setValue(A,{value:x});break}case"combobox":case"listbox":{const x=b.defaultValue||"";f.setValue(A,{value:x});break}default:continue}const w=document.querySelector(`[data-element-id="${A}"]`);if(w){if(!hd.has(w)){Fe(`_bindResetFormAction - element not allowed: ${A}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:g,name:"ResetForm"}})),!1}}}As=new WeakSet,jc=function(){this.container.setAttribute("data-internal-link","")},oP=function(t,n,s="",o=null){t.href=this.linkService.getAnchorUrl(""),n.description?t.title=n.description:s&&(t.title=s),t.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(n.content,n.filename,o),!1},M(this,As,jc).call(this)},aP=function(t,n,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),s&&(t.title=s),M(this,As,jc).call(this)};class $q extends Qt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Sd extends Qt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return On.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{var c;if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}}))})}_setEventListeners(e,t,n,s){var o,l,c;for(const[h,f]of n)(f==="Action"||(o=this.data.actions)!=null&&o[f])&&((f==="Focus"||f==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,h,f,s),f==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(e,t,"blur","Blur",null):f==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":be.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||zq,o=e.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(sE*s))||1,y=f/g;l=Math.min(s,h(y/sE))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,h(f/sE))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=be.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Yq extends Sd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),o.setValue(l.id,{[s]:n})}render(){var s,o;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=e.getValue(t,{value:this.data.fieldValue});let c=l.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&c.length>h&&(c=c.slice(0,h));let f=l.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const g={userValue:c,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=f??c,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",f??c),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),hd.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:y,datetimeType:b,timeStep:A}=this.data,w=!!b&&this.enableScripting;y&&(n.title=y),this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",N=>{e.setValue(t,{value:N.target.value}),this.setPropertyOnSiblings(n,"value",N.target.value,"value"),g.formattedValue=null}),n.addEventListener("resetform",N=>{const I=this.data.defaultFieldValue??"";n.value=g.userValue=I,g.formattedValue=null});let x=N=>{const{formattedValue:I}=g;I!=null&&(N.target.value=I),N.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",I=>{var k;if(g.focused)return;const{target:P}=I;if(w&&(P.type=b,A&&(P.step=A)),g.userValue){const L=g.userValue;if(w)if(b==="time"){const O=new Date(L),F=[O.getHours(),O.getMinutes(),O.getSeconds()];P.value=F.map(U=>U.toString().padStart(2,"0")).join(":")}else P.value=new Date(L-Vq).toISOString().split(b==="date"?"T":".",1)[0];else P.value=L}g.lastCommittedValue=P.value,g.commitKey=1,(k=this.data.actions)!=null&&k.Focus||(g.focused=!0)}),n.addEventListener("updatefromsandbox",I=>{this.showElementAndHideCanvas(I.target);const P={value(k){g.userValue=k.detail.value??"",w||e.setValue(t,{value:g.userValue.toString()}),k.target.value=g.userValue},formattedValue(k){const{formattedValue:L}=k.detail;g.formattedValue=L,L!=null&&k.target!==document.activeElement&&(k.target.value=L);const O={formattedValue:L};w&&(O.value=L),e.setValue(t,O)},selRange(k){k.target.setSelectionRange(...k.detail.selRange)},charLimit:k=>{var U;const{charLimit:L}=k.detail,{target:O}=k;if(L===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",L);let F=g.userValue;!F||F.length<=L||(F=F.slice(0,L),O.value=g.userValue=F,e.setValue(t,{value:F}),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:F,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(P,I)}),n.addEventListener("keydown",I=>{var L;g.commitKey=1;let P=-1;if(I.key==="Escape"?P=0:I.key==="Enter"&&!this.data.multiLine?P=2:I.key==="Tab"&&(g.commitKey=3),P===-1)return;const{value:k}=I.target;g.lastCommittedValue!==k&&(g.lastCommittedValue=k,g.userValue=k,(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:P,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}}))});const N=x;x=null,n.addEventListener("blur",I=>{var L,O;if(!g.focused||!I.relatedTarget)return;(L=this.data.actions)!=null&&L.Blur||(g.focused=!1);const{target:P}=I;let{value:k}=P;if(w){if(k&&b==="time"){const F=k.split(":").map(U=>parseInt(U,10));k=new Date(2e3,0,1,F[0],F[1],F[2]||0).valueOf(),P.step=""}else k.includes("T")||(k=`${k}T00:00`),k=new Date(k).valueOf();P.type="text"}g.userValue=k,g.lastCommittedValue!==k&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,willCommit:!0,commitKey:g.commitKey,selStart:I.target.selectionStart,selEnd:I.target.selectionEnd}})),N(I)}),(o=this.data.actions)!=null&&o.Keystroke&&n.addEventListener("beforeinput",I=>{var q;g.lastCommittedValue=null;const{data:P,target:k}=I,{value:L,selectionStart:O,selectionEnd:F}=k;let U=O,X=F;switch(I.inputType){case"deleteWordBackward":{const Z=L.substring(0,O).match(/\w*[^\w]*$/);Z&&(U-=Z[0].length);break}case"deleteWordForward":{const Z=L.substring(O).match(/^[^\w]*\w*/);Z&&(X+=Z[0].length);break}case"deleteContentBackward":O===F&&(U-=1);break;case"deleteContentForward":O===F&&(X+=1);break}I.preventDefault(),(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:L,change:P||"",willCommit:!1,selStart:U,selEnd:X}})}),this._setEventListeners(n,g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],I=>I.target.value)}if(x&&n.addEventListener("blur",x),this.data.comb){const I=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${I}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class jq extends Sd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Wq extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return hd.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n)){const g=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=g),e.setValue(f.id,{value:g})}e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class lP extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(hd.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const b=g&&y.id===n;y.domElement&&(y.domElement.checked=b),e.setValue(y.id,{value:b})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Xq extends ax{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class Kq extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");hd.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const y=this.data.defaultFieldValue;for(const b of s.options)b.selected=b.value===y});for(const g of this.data.options){const y=document.createElement("option");y.textContent=g.displayValue,y.value=g.exportValue,n.value.includes(g.exportValue)&&(y.setAttribute("selected",!0),o=!1),s.append(y)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),l=()=>{g.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=g=>{const y=g?"value":"textContent",{options:b,multiple:A}=s;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[y]):b.selectedIndex===-1?null:b[b.selectedIndex][y]};let h=c(!1);const f=g=>{const y=g.target.options;return Array.prototype.map.call(y,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const y={value(b){l==null||l();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const x of s.options)x.selected=w.has(x.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(b){s.multiple=!0},remove(b){const A=s.options,w=b.detail.remove;A[w].selected=!1,s.remove(w),A.length>0&&Array.prototype.findIndex.call(A,N=>N.selected)===-1&&(A[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},clear(b){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(b){const{index:A,displayValue:w,exportValue:x}=b.detail.insert,N=s.children[A],I=document.createElement("option");I.textContent=w,I.value=x,N?N.before(I):s.append(I),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},items(b){const{items:A}=b.detail;for(;s.length!==0;)s.remove(0);for(const w of A){const{displayValue:x,exportValue:N}=w,I=document.createElement("option");I.textContent=x,I.value=N,s.append(I)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(b)}),h=c(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(y,g)}),s.addEventListener("input",g=>{var A;const y=c(!0),b=c(!1);e.setValue(t,{value:y}),g.preventDefault(),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:b,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var dy,kT;class DT extends Qt{constructor(t){const{data:n,elements:s,parent:o}=t,l=!!o._commentManager;super(t,{isRenderable:!l&&Qt._hasPopupData(n)});R(this,dy);if(this.elements=s,l&&Qt._hasPopupData(n)){const c=this.popup=M(this,dy,kT).call(this);for(const h of s)h.popup=c}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const n=this.popup=M(this,dy,kT).call(this),s=[];for(const o of this.elements)o.popup=n,o.container.ariaHasPopup="dialog",s.push(o.data.id),o.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(o=>`${Qw}${o}`).join(",")),this.container}}dy=new WeakSet,kT=function(){return new Jq({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var cs,Kl,s_,r_,Ff,Bf,rn,no,Jl,Gu,Hf,Gf,io,us,fa,pa,Nn,ga,Ql,hy,ma,zf,zu,Zl,ai,ec,je,Wv,PT,LT,OT,Xv,UT,cP,uP,dP,hP,Kv,Jv,FT;class Jq{constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:g,open:y,commentManager:b=null}){R(this,je);R(this,cs,null);R(this,Kl,M(this,je,dP).bind(this));R(this,s_,M(this,je,FT).bind(this));R(this,r_,M(this,je,Jv).bind(this));R(this,Ff,M(this,je,Kv).bind(this));R(this,Bf,null);R(this,rn,null);R(this,no,null);R(this,Jl,null);R(this,Gu,null);R(this,Hf,null);R(this,Gf,null);R(this,io,!1);R(this,us,null);R(this,fa,null);R(this,pa,null);R(this,Nn,null);R(this,ga,null);R(this,Ql,null);R(this,hy,null);R(this,ma,null);R(this,zf,null);R(this,zu,null);R(this,Zl,!1);R(this,ai,null);R(this,ec,null);T(this,rn,e),T(this,zf,s),T(this,no,l),T(this,ma,c),T(this,Hf,h),T(this,Bf,t),T(this,hy,f),T(this,Gf,g),T(this,Gu,n),T(this,cs,b),T(this,ai,n[0]),T(this,Jl,Zg.toDateObject(o)),this.trigger=n.flatMap(A=>A.getElementsToTriggerPopup()),b?this.renderCommentButton():(M(this,je,Wv).call(this),d(this,rn).hidden=!0,y&&M(this,je,Kv).call(this))}renderCommentButton(){if(d(this,Nn)||(d(this,ga)||M(this,je,PT).call(this),!d(this,ga)))return;const{signal:e}=T(this,fa,new AbortController),t=!!d(this,ai).extraPopupElement,n=()=>{d(this,cs).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{d(this,cs).toggleCommentPopup(this,!1,!0,!t)},o=()=>{d(this,cs).toggleCommentPopup(this,!1,!1)};if(t){T(this,Nn,d(this,ai).container);for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",d(this,Kl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=T(this,Nn,document.createElement("button"));l.className="annotationCommentButton";const c=d(this,ai).container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),M(this,je,OT).call(this),M(this,je,LT).call(this),l.addEventListener("keydown",d(this,Kl),{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),c.after(l)}}get commentButtonColor(){const{color:e,opacity:t}=d(this,ai).commentData;return e?d(this,Hf)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=d(this,Nn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=d(this,ai).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return d(this,Nn)}get comment(){return d(this,ec)||T(this,ec,d(this,ai).commentText),d(this,ec)}set comment(e){e!==this.comment&&(d(this,ai).commentText=T(this,ec,e))}get parentBoundingClientRect(){return d(this,ai).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){d(this,Nn)&&(d(this,Nn).classList.toggle("selected",e),d(this,Nn).ariaExpanded=t)}setSelectedCommentButton(e){d(this,Nn).classList.toggle("selected",e)}get commentPopupPosition(){if(d(this,Ql))return d(this,Ql);const{x:e,y:t,height:n}=d(this,Nn).getBoundingClientRect(),{x:s,y:o,width:l,height:c}=d(this,ai).layer.getBoundingClientRect();return[(e-s)/l,(t+n-o)/c]}set commentPopupPosition(e){T(this,Ql,e)}hasDefaultPopupPosition(){return d(this,Ql)===null}get commentButtonPosition(){return d(this,ga)}get commentButtonWidth(){return d(this,Nn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=d(this,Ql)||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:l,width:c,height:h}=s;d(this,cs).showDialog(null,this,o+t*c,l+n*h,{...e,parentDimensions:s})}render(){var n,s;if(d(this,us))return;const e=T(this,us,document.createElement("div"));if(e.className="popup",d(this,Bf)){const o=e.style.outlineColor=be.makeHexColor(...d(this,Bf));e.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`}const t=document.createElement("span");if(t.className="header",(n=d(this,zf))!=null&&n.str){const o=document.createElement("span");o.className="title",t.append(o),{dir:o.dir,str:o.textContent}=d(this,zf)}if(e.append(t),d(this,Jl)){const o=document.createElement("time");o.className="popupDate",o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:d(this,Jl).valueOf()})),o.dateTime=d(this,Jl).toISOString(),t.append(o)}ex({html:d(this,je,Xv)||d(this,no).str,dir:(s=d(this,no))==null?void 0:s.dir,className:"popupContent"},e),d(this,rn).append(e)}updateEdited({rect:e,popup:t,deleted:n}){var s;if(d(this,cs)){n?(this.remove(),T(this,ec,null)):t&&(t.deleted?this.remove():(M(this,je,OT).call(this),T(this,ec,t.text))),e&&(T(this,ga,null),M(this,je,PT).call(this),M(this,je,LT).call(this));return}if(n||t!=null&&t.deleted){this.remove();return}M(this,je,Wv).call(this),d(this,zu)||T(this,zu,{contentsObj:d(this,no),richText:d(this,ma)}),e&&T(this,pa,null),t&&t.text&&(T(this,ma,M(this,je,uP).call(this,t.text)),T(this,Jl,Zg.toDateObject(t.date)),T(this,no,null)),(s=d(this,us))==null||s.remove(),T(this,us,null)}resetEdited(){var e;d(this,zu)&&({contentsObj:An(this,no)._,richText:An(this,ma)._}=d(this,zu),T(this,zu,null),(e=d(this,us))==null||e.remove(),T(this,us,null),T(this,pa,null))}remove(){var e,t,n;if((e=d(this,fa))==null||e.abort(),T(this,fa,null),(t=d(this,us))==null||t.remove(),T(this,us,null),T(this,Zl,!1),T(this,io,!1),(n=d(this,Nn))==null||n.remove(),T(this,Nn,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){T(this,Zl,this.isVisible),d(this,Zl)&&(d(this,rn).hidden=!0)}maybeShow(){d(this,cs)||(M(this,je,Wv).call(this),d(this,Zl)&&(d(this,us)||M(this,je,Jv).call(this),T(this,Zl,!1),d(this,rn).hidden=!1))}get isVisible(){return d(this,cs)?!1:d(this,rn).hidden===!1}}cs=new WeakMap,Kl=new WeakMap,s_=new WeakMap,r_=new WeakMap,Ff=new WeakMap,Bf=new WeakMap,rn=new WeakMap,no=new WeakMap,Jl=new WeakMap,Gu=new WeakMap,Hf=new WeakMap,Gf=new WeakMap,io=new WeakMap,us=new WeakMap,fa=new WeakMap,pa=new WeakMap,Nn=new WeakMap,ga=new WeakMap,Ql=new WeakMap,hy=new WeakMap,ma=new WeakMap,zf=new WeakMap,zu=new WeakMap,Zl=new WeakMap,ai=new WeakMap,ec=new WeakMap,je=new WeakSet,Wv=function(){var t;if(d(this,fa))return;T(this,fa,new AbortController);const{signal:e}=d(this,fa);for(const n of this.trigger)n.addEventListener("click",d(this,Ff),{signal:e}),n.addEventListener("pointerenter",d(this,r_),{signal:e}),n.addEventListener("pointerleave",d(this,s_),{signal:e}),n.classList.add("popupTriggerArea");for(const n of d(this,Gu))(t=n.container)==null||t.addEventListener("keydown",d(this,Kl),{signal:e})},PT=function(){const e=d(this,Gu).find(t=>t.hasCommentButton);e&&T(this,ga,e._normalizePoint(e.commentButtonPosition))},LT=function(){if(d(this,ai).extraPopupElement&&!d(this,ai).editor)return;this.renderCommentButton();const[e,t]=d(this,ga),{style:n}=d(this,Nn);n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`},OT=function(){d(this,ai).extraPopupElement||(this.renderCommentButton(),d(this,Nn).style.backgroundColor=this.commentButtonColor||"")},Xv=function(){const e=d(this,ma),t=d(this,no);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&d(this,ma).html||null},UT=function(){var e,t,n;return((n=(t=(e=d(this,je,Xv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},cP=function(){var e,t,n;return((n=(t=(e=d(this,je,Xv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},uP=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:d(this,je,cP),fontSize:d(this,je,UT)?`calc(${d(this,je,UT)}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n},dP=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&d(this,io))&&M(this,je,Kv).call(this)},hP=function(){if(d(this,pa)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=d(this,Hf);let l=!!d(this,Gf),c=l?d(this,Gf):d(this,hy);for(const w of d(this,Gu))if(!c||be.intersect(w.data.rect,c)!==null){c=w.data.rect,l=!0;break}const h=be.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),g=l?c[2]-c[0]+5:0,y=h[0]+g,b=h[1];T(this,pa,[100*(y-s)/t,100*(b-o)/n]);const{style:A}=d(this,rn);A.left=`${d(this,pa)[0]}%`,A.top=`${d(this,pa)[1]}%`},Kv=function(){if(d(this,cs)){d(this,cs).toggleCommentPopup(this,!1);return}T(this,io,!d(this,io)),d(this,io)?(M(this,je,Jv).call(this),d(this,rn).addEventListener("click",d(this,Ff)),d(this,rn).addEventListener("keydown",d(this,Kl))):(M(this,je,FT).call(this),d(this,rn).removeEventListener("click",d(this,Ff)),d(this,rn).removeEventListener("keydown",d(this,Kl)))},Jv=function(){d(this,us)||this.render(),this.isVisible?d(this,io)&&d(this,rn).classList.add("focused"):(M(this,je,hP).call(this),d(this,rn).hidden=!1,d(this,rn).style.zIndex=parseInt(d(this,rn).style.zIndex)+1e3)},FT=function(){d(this,rn).classList.remove("focused"),!(d(this,io)||!this.isVisible)&&(d(this,rn).hidden=!0,d(this,rn).style.zIndex=parseInt(d(this,rn).style.zIndex)-1e3)};class fP extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ue.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var fy;class Qq extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,fy,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=T(this,fy,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),o.append(l),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,fy)}addHighlightArea(){this.container.classList.add("highlightArea")}}fy=new WeakMap;var py;class Zq extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,py,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=T(this,py,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",n-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,py)}addHighlightArea(){this.container.classList.add("highlightArea")}}py=new WeakMap;var gy;class e$ extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,gy,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:n,height:s}=this,o=this.svgFactory.create(n,s,!0),l=t.borderStyle.width,c=T(this,gy,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",n/2),c.setAttribute("cy",s/2),c.setAttribute("rx",n/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,gy)}addHighlightArea(){this.container.classList.add("highlightArea")}}gy=new WeakMap;var my;class pP extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,my,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:s,popupRef:o},width:l,height:c}=this;if(!n)return this.container;const h=this.svgFactory.create(l,c,!0);let f=[];for(let y=0,b=n.length;y<b;y+=2){const A=n[y]-t[0],w=t[3]-n[y+1];f.push(`${A},${w}`)}f=f.join(" ");const g=T(this,my,this.svgFactory.createElement(this.svgElementName));return g.setAttribute("points",f),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),h.append(g),this.container.append(h),!o&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,my)}addHighlightArea(){this.container.classList.add("highlightArea")}}my=new WeakMap;class t$ extends pP{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class n$ extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var yy,Vu,vy,BT;class lx extends Qt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,vy);R(this,yy,null);R(this,Vu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ue.HIGHLIGHT:Ue.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:s,borderStyle:o,popupRef:l}}=this,{transform:c,width:h,height:f}=M(this,vy,BT).call(this,n,t),g=this.svgFactory.create(h,f,!0),y=T(this,yy,this.svgFactory.createElement("svg:g"));g.append(y),y.setAttribute("stroke-width",o.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",c);for(let b=0,A=s.length;b<A;b++){const w=this.svgFactory.createElement(this.svgElementName);d(this,Vu).push(w),w.setAttribute("points",s[b].join(",")),y.append(w)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(g),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:s,rect:o}=t,l=d(this,yy);if(n>=0&&l.setAttribute("stroke-width",n||1),s)for(let c=0,h=d(this,Vu).length;c<h;c++)d(this,Vu)[c].setAttribute("points",s[c].join(","));if(o){const{transform:c,width:h,height:f}=M(this,vy,BT).call(this,this.data.rotation,o);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${f}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return d(this,Vu)}addHighlightArea(){this.container.classList.add("highlightArea")}}yy=new WeakMap,Vu=new WeakMap,vy=new WeakSet,BT=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class gP extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ue.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class i$ extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class s$ extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class r$ extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class mP extends Qt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ue.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var by,_y,HT;class o$ extends Qt{constructor(t){var s;super(t,{isRenderable:!0});R(this,_y);R(this,by,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",M(this,_y,HT).bind(this)),T(this,by,s);const{isMac:o}=On.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(o?l.metaKey:l.ctrlKey)&&M(this,_y,HT).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return d(this,by)}addHighlightArea(){this.container.classList.add("highlightArea")}}by=new WeakMap,_y=new WeakSet,HT=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Vf,qu,qf,tc,Sy,$u,Sc,GT,zT,$f;let cx=($f=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:g}){R(this,Sc);R(this,Vf,null);R(this,qu,null);R(this,qf,null);R(this,tc,new Map);R(this,Sy,null);R(this,$u,null);this.div=e,T(this,Vf,t),T(this,qu,n),T(this,Sy,c||null),T(this,$u,f||null),T(this,qf,g||new tx),this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return d(this,tc).size>0}async render(e){var l,c,h;const{annotations:t}=e,n=this.div;vc(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:d(this,$u),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new im,annotationStorage:d(this,qf),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const f of t){if(f.noHTML)continue;const g=f.annotationType===un.POPUP;if(g){const A=s.get(f.id);if(!A)continue;o.elements=A}else if(f.rect[2]===f.rect[0]||f.rect[3]===f.rect[1])continue;o.data=f;const y=KM.create(o);if(!y.isRenderable)continue;if(!g&&f.popupRef){const A=s.get(f.popupRef);A?A.push(y):s.set(f.popupRef,[y])}const b=y.render();f.hidden&&(b.style.visibility="hidden"),await M(this,Sc,GT).call(this,b,f.id,o.elements),(c=(l=y.extraPopupElement)==null?void 0:l.popup)==null||c.renderCommentButton(),y._isEditable&&(d(this,tc).set(y.data.id,y),(h=this._annotationEditorUIManager)==null||h.renderAnnotationElement(y))}M(this,Sc,zT).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:d(this,$u),svgFactory:new im,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=$f._defaultBorderStyle),t.data=n;const s=KM.create(t);if(!s.isRenderable)continue;const o=s.render();await M(this,Sc,GT).call(this,o,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,vc(t,{rotation:e.rotation}),M(this,Sc,zT).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(d(this,tc).values())}getEditableAnnotation(e){return d(this,tc).get(e)}addFakeAnnotation(e){var c;const{div:t}=this,{id:n,rotation:s}=e,o=new qq({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:d(this,$u),annotationStorage:d(this,qf)}),l=o.render();return t.append(l),(c=d(this,Vf))==null||c.moveElementInDOM(t,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return $e(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:gh.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Vf=new WeakMap,qu=new WeakMap,qf=new WeakMap,tc=new WeakMap,Sy=new WeakMap,$u=new WeakMap,Sc=new WeakSet,GT=async function(e,t,n){var c,h;const s=e.firstChild||e,o=s.id=`${Qw}${t}`,l=await((c=d(this,Sy))==null?void 0:c.getAriaAttributes(o));if(l)for(const[f,g]of l)s.setAttribute(f,g);n?n.at(-1).container.after(e):(this.div.append(e),(h=d(this,Vf))==null||h.moveElementInDOM(this.div,e,s,!1))},zT=function(){var t;if(!d(this,qu))return;const e=this.div;for(const[n,s]of d(this,qu)){const o=e.querySelector(`[data-annotation-id="${n}"]`);if(!o)continue;s.className="annotationContent";const{firstChild:l}=o;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):o.append(s);const c=d(this,tc).get(n);c&&(c._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(n,o.id,s),c._hasNoCanvas=!1):c.canvas=s)}d(this,qu).clear()},$f);const Iv=/\r\n?|\n/g;var ds,Ay,Yu,hs,_n,yP,vP,bP,Qv,Ma,Zv,eb,_P,qT,SP;const Gt=class Gt extends Ut{constructor(t){super({...t,name:"freeTextEditor"});R(this,_n);R(this,ds,"");R(this,Ay,`${this.id}-editor`);R(this,Yu,null);R(this,hs);ce(this,"_colorPicker",null);this.color=t.color||Gt._defaultColor||Ut._defaultLineColor,T(this,hs,t.fontSize||Gt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Gt.prototype,n=l=>l.isEmpty(),s=bc.TRANSLATE_SMALL,o=bc.TRANSLATE_BIG;return $e(this,"_keyboardManager",new $y([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-o,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[o,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-o],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,o],checker:n}]]))}static initialize(t,n){Ut.initialize(t,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case it.FREETEXT_SIZE:Gt._defaultFontSize=n;break;case it.FREETEXT_COLOR:Gt._defaultColor=n;break}}updateParams(t,n){switch(t){case it.FREETEXT_SIZE:M(this,_n,yP).call(this,n);break;case it.FREETEXT_COLOR:M(this,_n,vP).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[it.FREETEXT_SIZE,Gt._defaultFontSize],[it.FREETEXT_COLOR,Gt._defaultColor||Ut._defaultLineColor]]}get propertiesToUpdate(){return[[it.FREETEXT_SIZE,d(this,hs)],[it.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Mb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return it.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Gt._internalPadding*t,-(Gt._internalPadding+d(this,hs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),T(this,Yu,new AbortController);const t=this._uiManager.combinedSignal(d(this,Yu));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,Ay)),this._isDraggable=!0,(t=d(this,Yu))==null||t.abort(),T(this,Yu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=d(this,ds),n=T(this,ds,M(this,_n,bP).call(this).trimEnd());if(t===n)return;const s=o=>{if(T(this,ds,o),!o){this.remove();return}M(this,_n,eb).call(this),this._uiManager.rebuild(this),M(this,_n,Qv).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(t)},mustExec:!1}),M(this,_n,Qv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Gt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,Ay)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${d(this,hs)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[o,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[h,f]=this.getInitialTranslation();[h,f]=this.pageTranslationToScreen(h,f);const[g,y]=this.pageDimensions,[b,A]=this.pageTranslation;let w,x;switch(this.rotation){case 0:w=t+(c[0]-b)/g,x=n+this.height-(c[1]-A)/y;break;case 90:w=t+(c[0]-b)/g,x=n-(c[1]-A)/y,[h,f]=[f,-h];break;case 180:w=t-this.width+(c[0]-b)/g,x=n-(c[1]-A)/y,[h,f]=[-h,-f];break;case 270:w=t+(c[0]-b-this.height*y)/g,x=n+(c[1]-A-this.width*g)/y,[h,f]=[-f,h];break}this.setAt(w*o,x*l,h,f)}else this._moveAfterPaste(t,n);M(this,_n,eb).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,x,N;const n=t.clipboardData||window.clipboardData,{types:s}=n;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const o=M(w=Gt,Ma,qT).call(w,n.getData("text")||"").replaceAll(Iv,`
`);if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!o.includes(`
`)){c.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=c,g=[],y=[];if(h.nodeType===Node.TEXT_NODE){const I=h.parentElement;if(y.push(h.nodeValue.slice(f).replaceAll(Iv,"")),I!==this.editorDiv){let P=g;for(const k of this.editorDiv.childNodes){if(k===I){P=y;continue}P.push(M(x=Gt,Ma,Zv).call(x,k))}}g.push(h.nodeValue.slice(0,f).replaceAll(Iv,""))}else if(h===this.editorDiv){let I=g,P=0;for(const k of this.editorDiv.childNodes)P++===f&&(I=y),I.push(M(N=Gt,Ma,Zv).call(N,k))}T(this,ds,`${g.join(`
`)}${o}${y.join(`
`)}`),M(this,_n,eb).call(this);const b=new Range;let A=Math.sumPrecise(g.map(I=>I.length));for(const{firstChild:I}of this.editorDiv.childNodes)if(I.nodeType===Node.TEXT_NODE){const P=I.nodeValue.length;if(A<=P){b.setStart(I,A),b.setEnd(I,A);break}A-=P}l.removeAllRanges(),l.addRange(b)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Gt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,s){var c;let o=null;if(t instanceof fP){const{data:{defaultAppearanceData:{fontSize:h,fontColor:f},rect:g,rotation:y,id:b,popupRef:A,richText:w,contentsObj:x,creationDate:N,modificationDate:I},textContent:P,textPosition:k,parent:{page:{pageNumber:L}}}=t;if(!P||P.length===0)return null;o=t={annotationType:Ue.FREETEXT,color:Array.from(f),fontSize:h,value:P.join(`
`),position:k,pageIndex:L-1,rect:g.slice(0),rotation:y,annotationElementId:b,id:b,deleted:!1,popupRef:A,comment:(x==null?void 0:x.str)||null,richText:w,creationDate:N,modificationDate:I}}const l=await super.deserialize(t,n,s);return T(l,hs,t.fontSize),l.color=be.makeHexColor(...t.color),T(l,ds,M(c=Gt,Ma,qT).call(c,t.value)),l._initialData=o,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:n,fontSize:d(this,hs),value:M(this,_n,_P).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!M(this,_n,SP).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(!n)return null;const{style:s}=n;s.fontSize=`calc(${d(this,hs)}px * var(--total-scale-factor))`,s.color=this.color,n.replaceChildren();for(const o of d(this,ds).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),n.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:d(this,ds)}}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ds=new WeakMap,Ay=new WeakMap,Yu=new WeakMap,hs=new WeakMap,_n=new WeakSet,yP=function(t){const n=o=>{this.editorDiv.style.fontSize=`calc(${o}px * var(--total-scale-factor))`,this.translate(0,-(o-d(this,hs))*this.parentScale),T(this,hs,o),M(this,_n,Qv).call(this)},s=d(this,hs);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},vP=function(t){const n=o=>{this.color=o,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},bP=function(){var s;const t=[];this.editorDiv.normalize();let n=null;for(const o of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&o.nodeName==="BR"||(t.push(M(s=Gt,Ma,Zv).call(s,o)),n=o);return t.join(`
`)},Qv=function(){const[t,n]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:o,div:l}=this,c=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",o.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/n):(this.width=s.height/t,this.height=s.width/n),this.fixAndSetPosition()},Ma=new WeakSet,Zv=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Iv,"")},eb=function(){if(this.editorDiv.replaceChildren(),!!d(this,ds))for(const t of d(this,ds).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},_P=function(){return d(this,ds).replaceAll(""," ")},qT=function(t){return t.replaceAll(" ","")},SP=function(t){const{value:n,fontSize:s,color:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==s||t.color.some((c,h)=>c!==o[h])||t.pageIndex!==l},R(Gt,Ma),ce(Gt,"_freeTextDefaultContent",""),ce(Gt,"_internalPadding",0),ce(Gt,"_defaultColor",null),ce(Gt,"_defaultFontSize",10),ce(Gt,"_type","freetext"),ce(Gt,"_editorType",Ue.FREETEXT);let VT=Gt;class ve{toSVGPath(){Lt("Abstract method `toSVGPath` must be implemented.")}get box(){Lt("Abstract getter `box` must be implemented.")}serialize(e,t){Lt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*o;return l}static _rescaleAndSwap(e,t,n,s,o,l){l||(l=new Float32Array(e.length));for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*o;return l}static _translate(e,t,n,s){s||(s=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+l)/6,(n+o)/2,(s+l)/2]}}ce(ve,"PRECISION",1e-4);var fs,mr,Yf,jf,so,Qe,ju,Wu,Ey,Ty,Wf,Xf,nc,wy,o_,a_,xn,Fg,AP,EP,TP,wP,xP,CP;const Vo=class Vo{constructor({x:e,y:t},n,s,o,l,c=0){R(this,xn);R(this,fs);R(this,mr,[]);R(this,Yf);R(this,jf);R(this,so,[]);R(this,Qe,new Float32Array(18));R(this,ju);R(this,Wu);R(this,Ey);R(this,Ty);R(this,Wf);R(this,Xf);R(this,nc,[]);T(this,fs,n),T(this,Xf,o*s),T(this,jf,l),d(this,Qe).set([NaN,NaN,NaN,NaN,e,t],6),T(this,Yf,c),T(this,Ty,d(Vo,wy)*s),T(this,Ey,d(Vo,a_)*s),T(this,Wf,s),d(this,nc).push(e,t)}isEmpty(){return isNaN(d(this,Qe)[8])}add({x:e,y:t}){var q;T(this,ju,e),T(this,Wu,t);const[n,s,o,l]=d(this,fs);let[c,h,f,g]=d(this,Qe).subarray(8,12);const y=e-f,b=t-g,A=Math.hypot(y,b);if(A<d(this,Ey))return!1;const w=A-d(this,Ty),x=w/A,N=x*y,I=x*b;let P=c,k=h;c=f,h=g,f+=N,g+=I,(q=d(this,nc))==null||q.push(e,t);const L=-I/w,O=N/w,F=L*d(this,Xf),U=O*d(this,Xf);return d(this,Qe).set(d(this,Qe).subarray(2,8),0),d(this,Qe).set([f+F,g+U],4),d(this,Qe).set(d(this,Qe).subarray(14,18),12),d(this,Qe).set([f-F,g-U],16),isNaN(d(this,Qe)[6])?(d(this,so).length===0&&(d(this,Qe).set([c+F,h+U],2),d(this,so).push(NaN,NaN,NaN,NaN,(c+F-n)/o,(h+U-s)/l),d(this,Qe).set([c-F,h-U],14),d(this,mr).push(NaN,NaN,NaN,NaN,(c-F-n)/o,(h-U-s)/l)),d(this,Qe).set([P,k,c,h,f,g],6),!this.isEmpty()):(d(this,Qe).set([P,k,c,h,f,g],6),Math.abs(Math.atan2(k-h,P-c)-Math.atan2(I,N))<Math.PI/2?([c,h,f,g]=d(this,Qe).subarray(2,6),d(this,so).push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+g)/2-s)/l),[c,h,P,k]=d(this,Qe).subarray(14,18),d(this,mr).push(NaN,NaN,NaN,NaN,((P+c)/2-n)/o,((k+h)/2-s)/l),!0):([P,k,c,h,f,g]=d(this,Qe).subarray(0,6),d(this,so).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),[f,g,c,h,P,k]=d(this,Qe).subarray(12,18),d(this,mr).push(((P+5*c)/6-n)/o,((k+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+g)/6-s)/l,((c+f)/2-n)/o,((h+g)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=d(this,so),t=d(this,mr);if(isNaN(d(this,Qe)[6])&&!this.isEmpty())return M(this,xn,AP).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);M(this,xn,TP).call(this,n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return M(this,xn,EP).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,s,o,l){return new RP(e,t,n,s,o,l)}getOutlines(){var y;const e=d(this,so),t=d(this,mr),n=d(this,Qe),[s,o,l,c]=d(this,fs),h=new Float32Array((((y=d(this,nc))==null?void 0:y.length)??0)+2);for(let b=0,A=h.length-2;b<A;b+=2)h[b]=(d(this,nc)[b]-s)/l,h[b+1]=(d(this,nc)[b+1]-o)/c;if(h[h.length-2]=(d(this,ju)-s)/l,h[h.length-1]=(d(this,Wu)-o)/c,isNaN(n[6])&&!this.isEmpty())return M(this,xn,wP).call(this,h);const f=new Float32Array(d(this,so).length+24+d(this,mr).length);let g=e.length;for(let b=0;b<g;b+=2){if(isNaN(e[b])){f[b]=f[b+1]=NaN;continue}f[b]=e[b],f[b+1]=e[b+1]}g=M(this,xn,CP).call(this,f,g);for(let b=t.length-6;b>=6;b-=6)for(let A=0;A<6;A+=2){if(isNaN(t[b+A])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=t[b+A],f[g+1]=t[b+A+1],g+=2}return M(this,xn,xP).call(this,f,g),this.newFreeDrawOutline(f,h,d(this,fs),d(this,Wf),d(this,Yf),d(this,jf))}};fs=new WeakMap,mr=new WeakMap,Yf=new WeakMap,jf=new WeakMap,so=new WeakMap,Qe=new WeakMap,ju=new WeakMap,Wu=new WeakMap,Ey=new WeakMap,Ty=new WeakMap,Wf=new WeakMap,Xf=new WeakMap,nc=new WeakMap,wy=new WeakMap,o_=new WeakMap,a_=new WeakMap,xn=new WeakSet,Fg=function(){const e=d(this,Qe).subarray(4,6),t=d(this,Qe).subarray(16,18),[n,s,o,l]=d(this,fs);return[(d(this,ju)+(e[0]-t[0])/2-n)/o,(d(this,Wu)+(e[1]-t[1])/2-s)/l,(d(this,ju)+(t[0]-e[0])/2-n)/o,(d(this,Wu)+(t[1]-e[1])/2-s)/l]},AP=function(){const[e,t,n,s]=d(this,fs),[o,l,c,h]=M(this,xn,Fg).call(this);return`M${(d(this,Qe)[2]-e)/n} ${(d(this,Qe)[3]-t)/s} L${(d(this,Qe)[4]-e)/n} ${(d(this,Qe)[5]-t)/s} L${o} ${l} L${c} ${h} L${(d(this,Qe)[16]-e)/n} ${(d(this,Qe)[17]-t)/s} L${(d(this,Qe)[14]-e)/n} ${(d(this,Qe)[15]-t)/s} Z`},EP=function(e){const t=d(this,mr);e.push(`L${t[4]} ${t[5]} Z`)},TP=function(e){const[t,n,s,o]=d(this,fs),l=d(this,Qe).subarray(4,6),c=d(this,Qe).subarray(16,18),[h,f,g,y]=M(this,xn,Fg).call(this);e.push(`L${(l[0]-t)/s} ${(l[1]-n)/o} L${h} ${f} L${g} ${y} L${(c[0]-t)/s} ${(c[1]-n)/o}`)},wP=function(e){const t=d(this,Qe),[n,s,o,l]=d(this,fs),[c,h,f,g]=M(this,xn,Fg).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/l],0),this.newFreeDrawOutline(y,e,d(this,fs),d(this,Wf),d(this,Yf),d(this,jf))},xP=function(e,t){const n=d(this,mr);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},CP=function(e,t){const n=d(this,Qe).subarray(4,6),s=d(this,Qe).subarray(16,18),[o,l,c,h]=d(this,fs),[f,g,y,b]=M(this,xn,Fg).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,y,b,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-l)/h],t),t+=24},R(Vo,wy,8),R(Vo,o_,2),R(Vo,a_,d(Vo,wy)+d(Vo,o_));let Db=Vo;var Kf,Xu,ya,xy,ps,Cy,hn,l_,IP;class RP extends ve{constructor(t,n,s,o,l,c){super();R(this,l_);R(this,Kf);R(this,Xu,new Float32Array(4));R(this,ya);R(this,xy);R(this,ps);R(this,Cy);R(this,hn);T(this,hn,t),T(this,ps,n),T(this,Kf,s),T(this,Cy,o),T(this,ya,l),T(this,xy,c),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],M(this,l_,IP).call(this,c);const[h,f,g,y]=d(this,Xu);for(let b=0,A=t.length;b<A;b+=2)t[b]=(t[b]-h)/g,t[b+1]=(t[b+1]-f)/y;for(let b=0,A=n.length;b<A;b+=2)n[b]=(n[b]-h)/g,n[b+1]=(n[b+1]-f)/y}toSVGPath(){const t=[`M${d(this,hn)[4]} ${d(this,hn)[5]}`];for(let n=6,s=d(this,hn).length;n<s;n+=6){if(isNaN(d(this,hn)[n])){t.push(`L${d(this,hn)[n+4]} ${d(this,hn)[n+5]}`);continue}t.push(`C${d(this,hn)[n]} ${d(this,hn)[n+1]} ${d(this,hn)[n+2]} ${d(this,hn)[n+3]} ${d(this,hn)[n+4]} ${d(this,hn)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,s,o],l){const c=s-t,h=o-n;let f,g;switch(l){case 0:f=ve._rescale(d(this,hn),t,o,c,-h),g=ve._rescale(d(this,ps),t,o,c,-h);break;case 90:f=ve._rescaleAndSwap(d(this,hn),t,n,c,h),g=ve._rescaleAndSwap(d(this,ps),t,n,c,h);break;case 180:f=ve._rescale(d(this,hn),s,n,-c,h),g=ve._rescale(d(this,ps),s,n,-c,h);break;case 270:f=ve._rescaleAndSwap(d(this,hn),s,o,-c,-h),g=ve._rescaleAndSwap(d(this,ps),s,o,-c,-h);break}return{outline:Array.from(f),points:[Array.from(g)]}}get box(){return d(this,Xu)}newOutliner(t,n,s,o,l,c=0){return new Db(t,n,s,o,l,c)}getNewOutline(t,n){const[s,o,l,c]=d(this,Xu),[h,f,g,y]=d(this,Kf),b=l*g,A=c*y,w=s*g+h,x=o*y+f,N=this.newOutliner({x:d(this,ps)[0]*b+w,y:d(this,ps)[1]*A+x},d(this,Kf),d(this,Cy),t,d(this,xy),n??d(this,ya));for(let I=2;I<d(this,ps).length;I+=2)N.add({x:d(this,ps)[I]*b+w,y:d(this,ps)[I+1]*A+x});return N.getOutlines()}}Kf=new WeakMap,Xu=new WeakMap,ya=new WeakMap,xy=new WeakMap,ps=new WeakMap,Cy=new WeakMap,hn=new WeakMap,l_=new WeakSet,IP=function(t){const n=d(this,hn);let s=n[4],o=n[5];const l=[s,o,s,o];let c=s,h=o,f=s,g=o;const y=t?Math.max:Math.min,b=new Float32Array(4);for(let w=6,x=n.length;w<x;w+=6){const N=n[w+4],I=n[w+5];isNaN(n[w])?(be.pointBoundingBox(N,I,l),h>I?(c=N,h=I):h===I&&(c=y(c,N)),g<I?(f=N,g=I):g===I&&(f=y(f,N))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,be.bezierBoundingBox(s,o,...n.slice(w,w+6),b),be.rectBoundingBox(b[0],b[1],b[2],b[3],l),h>b[1]?(c=b[0],h=b[1]):h===b[1]&&(c=y(c,b[0])),g<b[3]?(f=b[2],g=b[3]):g===b[3]&&(f=y(f,b[2]))),s=N,o=I}const A=d(this,Xu);A[0]=l[0]-d(this,ya),A[1]=l[1]-d(this,ya),A[2]=l[2]-l[0]+2*d(this,ya),A[3]=l[3]-l[1]+2*d(this,ya),this.firstPoint=[c,h],this.lastPoint=[f,g]};var Ry,Iy,Ny,ic,yr,xi,NP,tb,MP,DP,YT;class $T{constructor(e,t=0,n=0,s=!0){R(this,xi);R(this,Ry);R(this,Iy);R(this,Ny);R(this,ic,[]);R(this,yr,[]);const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x,y:N,width:I,height:P}of e){const k=Math.floor((x-t)/l)*l,L=Math.ceil((x+I+t)/l)*l,O=Math.floor((N-t)/l)*l,F=Math.ceil((N+P+t)/l)*l,U=[k,O,F,!0],X=[L,O,F,!1];d(this,ic).push(U,X),be.rectBoundingBox(k,O,L,F,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,g=o[1]-n;let y=s?-1/0:1/0,b=1/0;const A=d(this,ic).at(s?-1:-2),w=[A[0],A[2]];for(const x of d(this,ic)){const[N,I,P,k]=x;!k&&s?I<b?(b=I,y=N):I===b&&(y=Math.max(y,N)):k&&!s&&(I<b?(b=I,y=N):I===b&&(y=Math.min(y,N))),x[0]=(N-f)/c,x[1]=(I-g)/h,x[2]=(P-g)/h}T(this,Ry,new Float32Array([f,g,c,h])),T(this,Iy,[y,b]),T(this,Ny,w)}getOutlines(){d(this,ic).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of d(this,ic))t[3]?(e.push(...M(this,xi,YT).call(this,t)),M(this,xi,MP).call(this,t)):(M(this,xi,DP).call(this,t),e.push(...M(this,xi,YT).call(this,t)));return M(this,xi,NP).call(this,e)}}Ry=new WeakMap,Iy=new WeakMap,Ny=new WeakMap,ic=new WeakMap,yr=new WeakMap,xi=new WeakSet,NP=function(e){const t=[],n=new Set;for(const l of e){const[c,h,f]=l;t.push([c,h,l],[c,f,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],f=t[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[c,h,f,g,y]=l;n.delete(l);let b=c,A=h;for(o=[c,f],s.push(o);;){let w;if(n.has(g))w=g;else if(n.has(y))w=y;else break;n.delete(w),[c,h,f,g,y]=w,b!==c&&(o.push(b,A,c,A===h?h:f),b=c),A=A===h?f:h}o.push(b,A)}return new a$(s,d(this,Ry),d(this,Iy),d(this,Ny))},tb=function(e){const t=d(this,yr);let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,l=t[o][0];if(l===e)return o;l<e?n=o+1:s=o-1}return s+1},MP=function([,e,t]){const n=M(this,xi,tb).call(this,e);d(this,yr).splice(n,0,[e,t])},DP=function([,e,t]){const n=M(this,xi,tb).call(this,e);for(let s=n;s<d(this,yr).length;s++){const[o,l]=d(this,yr)[s];if(o!==e)break;if(o===e&&l===t){d(this,yr).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=d(this,yr)[s];if(o!==e)break;if(o===e&&l===t){d(this,yr).splice(s,1);return}}},YT=function(e){const[t,n,s]=e,o=[[t,n,s]],l=M(this,xi,tb).call(this,s);for(let c=0;c<l;c++){const[h,f]=d(this,yr)[c];for(let g=0,y=o.length;g<y;g++){const[,b,A]=o[g];if(!(f<=b||A<=h)){if(b>=h){if(A>f)o[g][1]=f;else{if(y===1)return[];o.splice(g,1),g--,y--}continue}o[g][2]=h,A>f&&o.push([t,f,A])}}}return o};var My,Jf;class a$ extends ve{constructor(t,n,s,o){super();R(this,My);R(this,Jf);T(this,Jf,t),T(this,My,n),this.firstPoint=s,this.lastPoint=o}toSVGPath(){const t=[];for(const n of d(this,Jf)){let[s,o]=n;t.push(`M${s} ${o}`);for(let l=2;l<n.length;l+=2){const c=n[l],h=n[l+1];c===s?(t.push(`V${h}`),o=h):h===o&&(t.push(`H${c}`),s=c)}t.push("Z")}return t.join(" ")}serialize([t,n,s,o],l){const c=[],h=s-t,f=o-n;for(const g of d(this,Jf)){const y=new Array(g.length);for(let b=0;b<g.length;b+=2)y[b]=t+g[b]*h,y[b+1]=o-g[b+1]*f;c.push(y)}return c}get box(){return d(this,My)}get classNamesForOutlining(){return["highlightOutline"]}}My=new WeakMap,Jf=new WeakMap;class jT extends Db{newFreeDrawOutline(e,t,n,s,o,l){return new l$(e,t,n,s,o,l)}}class l$ extends RP{newOutliner(e,t,n,s,o,l=0){return new jT(e,t,n,s,o,l)}}var Qf,Dy,va,Ku,ky,qi,Py,Ly,Ju,gs,ms,Wn,Zf,ep,li,tp,Ks,Oy,Ye,WT,nb,kP,PP,LP,XT,Wc,Zs,Sh,OP,ib,sb,UP,FP,BP,HP,GP;const pt=class pt extends Ut{constructor(t){super({...t,name:"highlightEditor"});R(this,Ye);R(this,Qf,null);R(this,Dy,0);R(this,va);R(this,Ku,null);R(this,ky,null);R(this,qi,null);R(this,Py,null);R(this,Ly,0);R(this,Ju,null);R(this,gs,null);R(this,ms,null);R(this,Wn,!1);R(this,Zf,null);R(this,ep,null);R(this,li,null);R(this,tp,"");R(this,Ks);R(this,Oy,"");this.color=t.color||pt._defaultColor,T(this,Ks,t.thickness||pt._defaultThickness),this.opacity=t.opacity||pt._defaultOpacity,T(this,va,t.boxes||null),T(this,Oy,t.methodOfCreation||""),T(this,tp,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(T(this,Wn,!0),M(this,Ye,nb).call(this,t),M(this,Ye,Wc).call(this)):d(this,va)&&(T(this,Qf,t.anchorNode),T(this,Dy,t.anchorOffset),T(this,Py,t.focusNode),T(this,Ly,t.focusOffset),M(this,Ye,WT).call(this),M(this,Ye,Wc).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=pt.prototype;return $e(this,"_keyboardManager",new $y([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:d(this,Wn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:d(this,Ks),methodOfCreation:d(this,Oy)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var s;Ut.initialize(t,n),pt._defaultColor||(pt._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case it.HIGHLIGHT_COLOR:pt._defaultColor=n;break;case it.HIGHLIGHT_THICKNESS:pt._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return d(this,ep)}get commentButtonPosition(){return d(this,Zf)}updateParams(t,n){switch(t){case it.HIGHLIGHT_COLOR:M(this,Ye,kP).call(this,n);break;case it.HIGHLIGHT_THICKNESS:M(this,Ye,PP).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[it.HIGHLIGHT_COLOR,pt._defaultColor],[it.HIGHLIGHT_THICKNESS,pt._defaultThickness]]}get propertiesToUpdate(){return[[it.HIGHLIGHT_COLOR,this.color||pt._defaultColor],[it.HIGHLIGHT_THICKNESS,d(this,Ks)||pt._defaultThickness],[it.HIGHLIGHT_FREE,d(this,Wn)]]}onUpdatedColor(){var t,n;(t=this.parent)==null||t.drawLayer.updateProperties(d(this,ms),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=d(this,ky))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",T(this,ky,new nm({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(M(this,Ye,sb).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,M(this,Ye,sb).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){M(this,Ye,XT).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,Ye,Wc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?M(this,Ye,XT).call(this):t&&(M(this,Ye,Wc).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var o,l,c;const{drawLayer:n}=this.parent;let s;d(this,Wn)?(t=(t-this.rotation+360)%360,s=M(o=pt,Zs,Sh).call(o,d(this,gs).box,t)):s=M(l=pt,Zs,Sh).call(l,[this.x,this.y,this.width,this.height],t),n.updateProperties(d(this,ms),{bbox:s,root:{"data-main-rotation":t}}),n.updateProperties(d(this,li),{bbox:M(c=pt,Zs,Sh).call(c,d(this,qi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();d(this,tp)&&(t.setAttribute("aria-label",d(this,tp)),t.setAttribute("role","mark")),d(this,Wn)?t.classList.add("free"):this.div.addEventListener("keydown",M(this,Ye,OP).bind(this),{signal:this._uiManager._signal});const n=T(this,Ju,document.createElement("div"));return t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=d(this,Ku),this.setDims(this.width,this.height),l2(this,d(this,Ju),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,li),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,li),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:M(this,Ye,ib).call(this,!0);break;case 1:case 3:M(this,Ye,ib).call(this,!1);break}}select(){var t;super.select(),d(this,li)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,li),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),d(this,li)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,li),{rootClass:{selected:!1}}),d(this,Wn)||M(this,Ye,ib).call(this,!1))}get _mustFixPosition(){return!d(this,Wn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(d(this,ms),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(d(this,li),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:s,x:o,y:l}){const{x:c,y:h,width:f,height:g}=s.getBoundingClientRect(),y=new AbortController,b=t.combinedSignal(y),A=w=>{y.abort(),M(this,Zs,HP).call(this,t,w)};window.addEventListener("blur",A,{signal:b}),window.addEventListener("pointerup",A,{signal:b}),window.addEventListener("pointerdown",Jt,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",xs,{signal:b}),s.addEventListener("pointermove",M(this,Zs,BP).bind(this,t),{signal:b}),this._freeHighlight=new jT({x:o,y:l},[c,h,f,g],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,s){var x,N,I,P;let o=null;if(t instanceof gP){const{data:{quadPoints:k,rect:L,rotation:O,id:F,color:U,opacity:X,popupRef:q,richText:Z,contentsObj:ee,creationDate:se,modificationDate:le},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Ue.HIGHLIGHT,color:Array.from(U),opacity:X,quadPoints:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:F,id:F,deleted:!1,popupRef:q,richText:Z,comment:(ee==null?void 0:ee.str)||null,creationDate:se,modificationDate:le}}else if(t instanceof lx){const{data:{inkLists:k,rect:L,rotation:O,id:F,color:U,borderStyle:{rawWidth:X},popupRef:q,richText:Z,contentsObj:ee,creationDate:se,modificationDate:le},parent:{page:{pageNumber:ue}}}=t;o=t={annotationType:Ue.HIGHLIGHT,color:Array.from(U),thickness:X,inkLists:k,boxes:null,pageIndex:ue-1,rect:L.slice(0),rotation:O,annotationElementId:F,id:F,deleted:!1,popupRef:q,richText:Z,comment:(ee==null?void 0:ee.str)||null,creationDate:se,modificationDate:le}}const{color:l,quadPoints:c,inkLists:h,opacity:f}=t,g=await super.deserialize(t,n,s);g.color=be.makeHexColor(...l),g.opacity=f||1,h&&T(g,Ks,t.thickness),g._initialData=o,t.comment&&g.setCommentData(t);const[y,b]=g.pageDimensions,[A,w]=g.pageTranslation;if(c){const k=T(g,va,[]);for(let L=0;L<c.length;L+=8)k.push({x:(c[L]-A)/y,y:1-(c[L+1]-w)/b,width:(c[L+2]-c[L])/y,height:(c[L+1]-c[L+5])/b});M(x=g,Ye,WT).call(x),M(N=g,Ye,Wc).call(N),g.rotate(g.rotation)}else if(h){T(g,Wn,!0);const k=h[0],L={x:k[0]-A,y:b-(k[1]-w)},O=new jT(L,[0,0,y,b],1,d(g,Ks)/2,!0,.001);for(let X=0,q=k.length;X<q;X+=2)L.x=k[X]-A,L.y=b-(k[X+1]-w),O.add(L);const{id:F,clipPathId:U}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:O.toSVGPath()}},!0,!0);M(I=g,Ye,nb).call(I,{highlightOutlines:O.getOutlines(),highlightId:F,clipPathId:U}),M(P=g,Ye,Wc).call(P),g.rotate(g.parentRotation)}return g}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=Ut._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:n,opacity:this.opacity,thickness:d(this,Ks),quadPoints:M(this,Ye,UP).call(this),outlines:M(this,Ye,FP).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!M(this,Ye,GP).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Qf=new WeakMap,Dy=new WeakMap,va=new WeakMap,Ku=new WeakMap,ky=new WeakMap,qi=new WeakMap,Py=new WeakMap,Ly=new WeakMap,Ju=new WeakMap,gs=new WeakMap,ms=new WeakMap,Wn=new WeakMap,Zf=new WeakMap,ep=new WeakMap,li=new WeakMap,tp=new WeakMap,Ks=new WeakMap,Oy=new WeakMap,Ye=new WeakSet,WT=function(){const t=new $T(d(this,va),.001);T(this,gs,t.getOutlines()),[this.x,this.y,this.width,this.height]=d(this,gs).box;const n=new $T(d(this,va),.0025,.001,this._uiManager.direction==="ltr");T(this,qi,n.getOutlines());const{firstPoint:s}=d(this,gs);T(this,Zf,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:o}=d(this,qi);T(this,ep,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},nb=function({highlightOutlines:t,highlightId:n,clipPathId:s}){var b,A;if(T(this,gs,t),T(this,qi,t.getNewOutline(d(this,Ks)/2+1.5,.0025)),n>=0)T(this,ms,n),T(this,Ku,s),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),T(this,li,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:d(this,qi).box,path:{d:d(this,qi).toSVGPath()}},!0));else if(this.parent){const w=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(d(this,ms),{bbox:M(b=pt,Zs,Sh).call(b,d(this,gs).box,(w-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(d(this,li),{bbox:M(A=pt,Zs,Sh).call(A,d(this,qi).box,w),path:{d:d(this,qi).toSVGPath()}})}const[l,c,h,f]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=h,this.height=f;break;case 90:{const[w,x]=this.parentDimensions;this.x=c,this.y=1-l,this.width=h*x/w,this.height=f*w/x;break}case 180:this.x=1-l,this.y=1-c,this.width=h,this.height=f;break;case 270:{const[w,x]=this.parentDimensions;this.x=1-c,this.y=l,this.width=h*x/w,this.height=f*w/x;break}}const{firstPoint:g}=t;T(this,Zf,[(g[0]-l)/h,(g[1]-c)/f]);const{lastPoint:y}=d(this,qi);T(this,ep,[(y[0]-l)/h,(y[1]-c)/f])},kP=function(t){const n=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},s=this.color,o=this.opacity;this.addCommands({cmd:n.bind(this,t,pt._defaultOpacity),undo:n.bind(this,s,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},PP=function(t){const n=d(this,Ks),s=o=>{T(this,Ks,o),M(this,Ye,LP).call(this,o)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},LP=function(t){d(this,Wn)&&(M(this,Ye,nb).call(this,{highlightOutlines:d(this,gs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},XT=function(){d(this,ms)===null||!this.parent||(this.parent.drawLayer.remove(d(this,ms)),T(this,ms,null),this.parent.drawLayer.remove(d(this,li)),T(this,li,null))},Wc=function(t=this.parent){d(this,ms)===null&&({id:An(this,ms)._,clipPathId:An(this,Ku)._}=t.drawLayer.draw({bbox:d(this,gs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:d(this,Wn)},path:{d:d(this,gs).toSVGPath()}},!1,!0),T(this,li,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:d(this,Wn)},bbox:d(this,qi).box,path:{d:d(this,qi).toSVGPath()}},d(this,Wn))),d(this,Ju)&&(d(this,Ju).style.clipPath=d(this,Ku)))},Zs=new WeakSet,Sh=function([t,n,s,o],l){switch(l){case 90:return[1-n-o,t,o,s];case 180:return[1-t-s,1-n-o,s,o];case 270:return[n,1-t-s,o,s]}return[t,n,s,o]},OP=function(t){pt._keyboardManager.exec(this,t)},ib=function(t){if(!d(this,Qf))return;const n=window.getSelection();t?n.setPosition(d(this,Qf),d(this,Dy)):n.setPosition(d(this,Py),d(this,Ly))},sb=function(){return d(this,Wn)?this.rotation:0},UP=function(){if(d(this,Wn))return null;const[t,n]=this.pageDimensions,[s,o]=this.pageTranslation,l=d(this,va),c=new Float32Array(l.length*8);let h=0;for(const{x:f,y:g,width:y,height:b}of l){const A=f*t+s,w=(1-g)*n+o;c[h]=c[h+4]=A,c[h+1]=c[h+3]=w,c[h+2]=c[h+6]=A+y*t,c[h+5]=c[h+7]=w-b*n,h+=8}return c},FP=function(t){return d(this,gs).serialize(t,M(this,Ye,sb).call(this))},BP=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},HP=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},GP=function(t){const{color:n}=this._initialData;return this.hasEditedComment||t.color.some((s,o)=>s!==n[o])},R(pt,Zs),ce(pt,"_defaultColor",null),ce(pt,"_defaultOpacity",1),ce(pt,"_defaultThickness",12),ce(pt,"_type","highlight"),ce(pt,"_editorType",Ue.HIGHLIGHT),ce(pt,"_freeHighlightId",-1),ce(pt,"_freeHighlight",null),ce(pt,"_freeHighlightClipId","");let kb=pt;var Qu;class zP{constructor(){R(this,Qu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){d(this,Qu)[e]=t}toSVGProperties(){const e=d(this,Qu);return T(this,Qu,Object.create(null)),{root:e}}reset(){T(this,Qu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Lt("Not implemented")}}Qu=new WeakMap;var ys,np,Mn,Zu,ed,sc,rc,oc,td,lt,KT,JT,QT,Bg,VP,rb,Hg,Ah;const Ee=class Ee extends Ut{constructor(t){super(t);R(this,lt);R(this,ys,null);R(this,np);ce(this,"_colorPicker",null);ce(this,"_drawId",null);T(this,np,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(M(this,lt,KT).call(this,t),M(this,lt,Bg).call(this))}static _mergeSVGProperties(t,n){const s=new Set(Object.keys(t));for(const[o,l]of Object.entries(n))s.has(o)?Object.assign(t[o],l):t[o]=l;return t}static getDefaultDrawingOptions(t){Lt("Not implemented")}static get typesMap(){Lt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(d(Ee,Mn).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[s,o]of this.typesMap)t.push([s,n[o]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[s,o]of this.constructor.typesMap)t.push([s,n[o]]);return t}_updateProperty(t,n,s){const o=this._drawingOptions,l=o[n],c=h=>{var g;o.updateProperty(n,h);const f=d(this,ys).updateProperty(n,h);f&&M(this,lt,Hg).call(this,f),(g=this.parent)==null||g.drawLayer.updateProperties(this._drawId,o.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ee._mergeSVGProperties(d(this,ys).getPathResizingSVGProperties(M(this,lt,rb).call(this)),{bbox:M(this,lt,Ah).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ee._mergeSVGProperties(d(this,ys).getPathResizedSVGProperties(M(this,lt,rb).call(this)),{bbox:M(this,lt,Ah).call(this)}))}_onTranslating(t,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:M(this,lt,Ah).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ee._mergeSVGProperties(d(this,ys).getPathTranslatedSVGProperties(M(this,lt,rb).call(this),this.parentDimensions),{bbox:M(this,lt,Ah).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,d(this,np)&&(T(this,np,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){M(this,lt,QT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(M(this,lt,Bg).call(this),M(this,lt,Hg).call(this,d(this,ys).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),M(this,lt,QT).call(this)):t&&(this._uiManager.addShouldRescale(this),M(this,lt,Bg).call(this,t),n=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ee._mergeSVGProperties({bbox:M(this,lt,Ah).call(this)},d(this,ys).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&M(this,lt,Hg).call(this,d(this,ys).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,n;this._isCopy&&(t=this.x,n=this.y);const s=super.render();s.classList.add("draw");const o=document.createElement("div");return s.append(o),o.setAttribute("aria-hidden","true"),o.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),s}static createDrawerInstance(t,n,s,o,l){Lt("Not implemented")}static startDrawing(t,n,s,o){var N;const{target:l,offsetX:c,offsetY:h,pointerId:f,pointerType:g}=o;if(d(Ee,rc)&&d(Ee,rc)!==g)return;const{viewport:{rotation:y}}=t,{width:b,height:A}=l.getBoundingClientRect(),w=T(Ee,Zu,new AbortController),x=t.combinedSignal(w);if(d(Ee,sc)||T(Ee,sc,f),d(Ee,rc)??T(Ee,rc,g),window.addEventListener("pointerup",I=>{var P;d(Ee,sc)===I.pointerId?this._endDraw(I):(P=d(Ee,oc))==null||P.delete(I.pointerId)},{signal:x}),window.addEventListener("pointercancel",I=>{var P;d(Ee,sc)===I.pointerId?this._currentParent.endDrawingSession():(P=d(Ee,oc))==null||P.delete(I.pointerId)},{signal:x}),window.addEventListener("pointerdown",I=>{d(Ee,rc)===I.pointerType&&((d(Ee,oc)||T(Ee,oc,new Set)).add(I.pointerId),d(Ee,Mn).isCancellable()&&(d(Ee,Mn).removeLastElement(),d(Ee,Mn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",xs,{signal:x}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),l.addEventListener("touchmove",I=>{I.timeStamp===d(Ee,td)&&Jt(I)},{signal:x}),t.toggleDrawing(),(N=n._editorUndoBar)==null||N.hide(),d(Ee,Mn)){t.drawLayer.updateProperties(this._currentDrawId,d(Ee,Mn).startNew(c,h,b,A,y));return}n.updateUIForDefaultProperties(this),T(Ee,Mn,this.createDrawerInstance(c,h,b,A,y)),T(Ee,ed,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(d(Ee,ed).toSVGProperties(),d(Ee,Mn).defaultSVGProperties),!0,!1)}static _drawMove(t){var l;if(T(Ee,td,-1),!d(Ee,Mn))return;const{offsetX:n,offsetY:s,pointerId:o}=t;if(d(Ee,sc)===o){if(((l=d(Ee,oc))==null?void 0:l.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,d(Ee,Mn).add(n,s)),T(Ee,td,t.timeStamp),Jt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,T(Ee,Mn,null),T(Ee,ed,null),T(Ee,rc,null),T(Ee,td,NaN)),d(Ee,Zu)&&(d(Ee,Zu).abort(),T(Ee,Zu,null),T(Ee,sc,NaN),T(Ee,oc,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,d(Ee,Mn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=d(Ee,Mn),o=this._currentDrawId,l=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(o,s.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(o,s.removeLastElement())},mustExec:!1,type:it.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(it.DRAW_STEP),!d(Ee,Mn).isEmpty()){const{pageDimensions:[s,o],scale:l}=n,c=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:d(Ee,Mn).getOutlines(s*l,o*l,l,this._INNER_MARGIN),drawingOptions:d(Ee,ed),mustBeCommitted:!t});return this._cleanup(!0),c}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,s,o,l,c){Lt("Not implemented")}static async deserialize(t,n,s){var y,b;const{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}=n.viewport,f=this.deserializeDraw(c,h,o,l,this._INNER_MARGIN,t),g=await super.deserialize(t,n,s);return g.createDrawingOptions(t),M(y=g,lt,KT).call(y,{drawOutlines:f}),M(b=g,lt,Bg).call(b),g.onScaleChanging(),g.rotate(),g}serializeDraw(t){const[n,s]=this.pageTranslation,[o,l]=this.pageDimensions;return d(this,ys).serialize([n,s,o,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ys=new WeakMap,np=new WeakMap,Mn=new WeakMap,Zu=new WeakMap,ed=new WeakMap,sc=new WeakMap,rc=new WeakMap,oc=new WeakMap,td=new WeakMap,lt=new WeakSet,KT=function({drawOutlines:t,drawId:n,drawingOptions:s}){T(this,ys,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=M(this,lt,JT).call(this,t,this.parent),M(this,lt,Hg).call(this,t.box)},JT=function(t,n){const{id:s}=n.drawLayer.draw(Ee._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},QT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Bg=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=M(this,lt,JT).call(this,d(this,ys),t)}},VP=function([t,n,s,o]){const{parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[n,1-t,s*(c/l),o*(l/c)];case 180:return[1-t,1-n,s,o];case 270:return[1-n,t,s*(c/l),o*(l/c)];default:return[t,n,s,o]}},rb=function(){const{x:t,y:n,width:s,height:o,parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[1-n,t,s*(l/c),o*(c/l)];case 180:return[1-t,1-n,s,o];case 270:return[n,1-t,s*(l/c),o*(c/l)];default:return[t,n,s,o]}},Hg=function(t){[this.x,this.y,this.width,this.height]=M(this,lt,VP).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ah=function(){const{x:t,y:n,width:s,height:o,rotation:l,parentRotation:c,parentDimensions:[h,f]}=this;switch((l*4+c)/90){case 1:return[1-n-o,t,o,s];case 2:return[1-t-s,1-n-o,s,o];case 3:return[n,1-t-s,o,s];case 4:return[t,n-s*(h/f),o*(f/h),s*(h/f)];case 5:return[1-n,t,s*(h/f),o*(f/h)];case 6:return[1-t-o*(f/h),1-n,o*(f/h),s*(h/f)];case 7:return[n-s*(h/f),1-t-o*(f/h),s*(h/f),o*(f/h)];case 8:return[t-s,n-o,s,o];case 9:return[1-n,t-s,o,s];case 10:return[1-t,1-n,s,o];case 11:return[n-o,1-t,o,s];case 12:return[t-o*(f/h),n,o*(f/h),s*(h/f)];case 13:return[1-n-s*(h/f),t-o*(f/h),s*(h/f),o*(f/h)];case 14:return[1-t,1-n-s*(h/f),o*(f/h),s*(h/f)];case 15:return[n,1-t,s*(h/f),o*(f/h)];default:return[t,n,s,o]}},ce(Ee,"_currentDrawId",-1),ce(Ee,"_currentParent",null),R(Ee,Mn,null),R(Ee,Zu,null),R(Ee,ed,null),R(Ee,sc,NaN),R(Ee,rc,null),R(Ee,oc,null),R(Ee,td,NaN),ce(Ee,"_INNER_MARGIN",3);let Pb=Ee;var ro,Dn,kn,nd,ip,bi,Xn,Js,id,sd,rd,sp,ob;class c${constructor(e,t,n,s,o,l){R(this,sp);R(this,ro,new Float64Array(6));R(this,Dn);R(this,kn);R(this,nd);R(this,ip);R(this,bi);R(this,Xn,"");R(this,Js,0);R(this,id,new jy);R(this,sd);R(this,rd);T(this,sd,n),T(this,rd,s),T(this,nd,o),T(this,ip,l),[e,t]=M(this,sp,ob).call(this,e,t);const c=T(this,Dn,[NaN,NaN,NaN,NaN,e,t]);T(this,bi,[e,t]),T(this,kn,[{line:c,points:d(this,bi)}]),d(this,ro).set(c,0)}updateProperty(e,t){e==="stroke-width"&&T(this,ip,t)}isEmpty(){return!d(this,kn)||d(this,kn).length===0}isCancellable(){return d(this,bi).length<=10}add(e,t){[e,t]=M(this,sp,ob).call(this,e,t);const[n,s,o,l]=d(this,ro).subarray(2,6),c=e-o,h=t-l;return Math.hypot(d(this,sd)*c,d(this,rd)*h)<=2?null:(d(this,bi).push(e,t),isNaN(n)?(d(this,ro).set([o,l,e,t],2),d(this,Dn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(d(this,ro)[0])&&d(this,Dn).splice(6,6),d(this,ro).set([n,s,o,l,e,t],0),d(this,Dn).push(...ve.createBezierPoints(n,s,o,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(d(this,bi).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){T(this,sd,n),T(this,rd,s),T(this,nd,o),[e,t]=M(this,sp,ob).call(this,e,t);const l=T(this,Dn,[NaN,NaN,NaN,NaN,e,t]);T(this,bi,[e,t]);const c=d(this,kn).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),d(this,kn).push({line:l,points:d(this,bi)}),d(this,ro).set(l,0),T(this,Js,0),this.toSVGPath(),null}getLastElement(){return d(this,kn).at(-1)}setLastElement(e){return d(this,kn)?(d(this,kn).push(e),T(this,Dn,e.line),T(this,bi,e.points),T(this,Js,0),{path:{d:this.toSVGPath()}}):d(this,id).setLastElement(e)}removeLastElement(){if(!d(this,kn))return d(this,id).removeLastElement();d(this,kn).pop(),T(this,Xn,"");for(let e=0,t=d(this,kn).length;e<t;e++){const{line:n,points:s}=d(this,kn)[e];T(this,Dn,n),T(this,bi,s),T(this,Js,0),this.toSVGPath()}return{path:{d:d(this,Xn)}}}toSVGPath(){const e=ve.svgRound(d(this,Dn)[4]),t=ve.svgRound(d(this,Dn)[5]);if(d(this,bi).length===2)return T(this,Xn,`${d(this,Xn)} M ${e} ${t} Z`),d(this,Xn);if(d(this,bi).length<=6){const s=d(this,Xn).lastIndexOf("M");T(this,Xn,`${d(this,Xn).slice(0,s)} M ${e} ${t}`),T(this,Js,6)}if(d(this,bi).length===4){const s=ve.svgRound(d(this,Dn)[10]),o=ve.svgRound(d(this,Dn)[11]);return T(this,Xn,`${d(this,Xn)} L ${s} ${o}`),T(this,Js,12),d(this,Xn)}const n=[];d(this,Js)===0&&(n.push(`M ${e} ${t}`),T(this,Js,6));for(let s=d(this,Js),o=d(this,Dn).length;s<o;s+=6){const[l,c,h,f,g,y]=d(this,Dn).slice(s,s+6).map(ve.svgRound);n.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}return T(this,Xn,d(this,Xn)+n.join(" ")),T(this,Js,d(this,Dn).length),d(this,Xn)}getOutlines(e,t,n,s){const o=d(this,kn).at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),d(this,id).build(d(this,kn),e,t,n,d(this,nd),d(this,ip),s),T(this,ro,null),T(this,Dn,null),T(this,kn,null),T(this,Xn,null),d(this,id)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ro=new WeakMap,Dn=new WeakMap,kn=new WeakMap,nd=new WeakMap,ip=new WeakMap,bi=new WeakMap,Xn=new WeakMap,Js=new WeakMap,id=new WeakMap,sd=new WeakMap,rd=new WeakMap,sp=new WeakSet,ob=function(e,t){return ve._normalizePoint(e,t,d(this,sd),d(this,rd),d(this,nd))};var _i,Uy,Fy,vs,oo,ao,rp,op,od,Jn,Go,qP,$P,YP;class jy extends ve{constructor(){super(...arguments);R(this,Jn);R(this,_i);R(this,Uy,0);R(this,Fy);R(this,vs);R(this,oo);R(this,ao);R(this,rp);R(this,op);R(this,od)}build(t,n,s,o,l,c,h){T(this,oo,n),T(this,ao,s),T(this,rp,o),T(this,op,l),T(this,od,c),T(this,Fy,h??0),T(this,vs,t),M(this,Jn,$P).call(this)}get thickness(){return d(this,od)}setLastElement(t){return d(this,vs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return d(this,vs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of d(this,vs)){if(t.push(`M${ve.svgRound(n[4])} ${ve.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12&&isNaN(n[6])){t.push(`L${ve.svgRound(n[10])} ${ve.svgRound(n[11])}`);continue}for(let s=6,o=n.length;s<o;s+=6){const[l,c,h,f,g,y]=n.subarray(s,s+6).map(ve.svgRound);t.push(`C${l} ${c} ${h} ${f} ${g} ${y}`)}}return t.join("")}serialize([t,n,s,o],l){const c=[],h=[],[f,g,y,b]=M(this,Jn,qP).call(this);let A,w,x,N,I,P,k,L,O;switch(d(this,op)){case 0:O=ve._rescale,A=t,w=n+o,x=s,N=-o,I=t+f*s,P=n+(1-g-b)*o,k=t+(f+y)*s,L=n+(1-g)*o;break;case 90:O=ve._rescaleAndSwap,A=t,w=n,x=s,N=o,I=t+g*s,P=n+f*o,k=t+(g+b)*s,L=n+(f+y)*o;break;case 180:O=ve._rescale,A=t+s,w=n,x=-s,N=o,I=t+(1-f-y)*s,P=n+g*o,k=t+(1-f)*s,L=n+(g+b)*o;break;case 270:O=ve._rescaleAndSwap,A=t+s,w=n+o,x=-s,N=-o,I=t+(1-g-b)*s,P=n+(1-f-y)*o,k=t+(1-g)*s,L=n+(1-f)*o;break}for(const{line:F,points:U}of d(this,vs))c.push(O(F,A,w,x,N,l?new Array(F.length):null)),h.push(O(U,A,w,x,N,l?new Array(U.length):null));return{lines:c,points:h,rect:[I,P,k,L]}}static deserialize(t,n,s,o,l,{paths:{lines:c,points:h},rotation:f,thickness:g}){const y=[];let b,A,w,x,N;switch(f){case 0:N=ve._rescale,b=-t/s,A=n/o+1,w=1/s,x=-1/o;break;case 90:N=ve._rescaleAndSwap,b=-n/o,A=-t/s,w=1/o,x=1/s;break;case 180:N=ve._rescale,b=t/s+1,A=-n/o,w=-1/s,x=1/o;break;case 270:N=ve._rescaleAndSwap,b=n/o+1,A=t/s+1,w=-1/o,x=-1/s;break}if(!c){c=[];for(const P of h){const k=P.length;if(k===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1]]));continue}if(k===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,P[0],P[1],NaN,NaN,NaN,NaN,P[2],P[3]]));continue}const L=new Float32Array(3*(k-2));c.push(L);let[O,F,U,X]=P.subarray(0,4);L.set([NaN,NaN,NaN,NaN,O,F],0);for(let q=4;q<k;q+=2){const Z=P[q],ee=P[q+1];L.set(ve.createBezierPoints(O,F,U,X,Z,ee),(q-2)*3),[O,F,U,X]=[U,X,Z,ee]}}}for(let P=0,k=c.length;P<k;P++)y.push({line:N(c[P].map(L=>L??NaN),b,A,w,x),points:N(h[P].map(L=>L??NaN),b,A,w,x)});const I=new this.prototype.constructor;return I.build(y,s,o,1,f,g,l),I}get box(){return d(this,_i)}updateProperty(t,n){return t==="stroke-width"?M(this,Jn,YP).call(this,n):null}updateParentDimensions([t,n],s){const[o,l]=M(this,Jn,Go).call(this);T(this,oo,t),T(this,ao,n),T(this,rp,s);const[c,h]=M(this,Jn,Go).call(this),f=c-o,g=h-l,y=d(this,_i);return y[0]-=f,y[1]-=g,y[2]+=2*f,y[3]+=2*g,y}updateRotation(t){return T(this,Uy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return d(this,_i).map(ve.svgRound).join(" ")}get defaultProperties(){const[t,n]=d(this,_i);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=d(this,_i);let s=0,o=0,l=0,c=0,h=0,f=0;switch(d(this,Uy)){case 90:o=n/t,l=-t/n,h=t;break;case 180:s=-1,c=-1,h=t,f=n;break;case 270:o=-n/t,l=t/n,f=n;break;default:return""}return`matrix(${s} ${o} ${l} ${c} ${ve.svgRound(h)} ${ve.svgRound(f)})`}getPathResizingSVGProperties([t,n,s,o]){const[l,c]=M(this,Jn,Go).call(this),[h,f,g,y]=d(this,_i);if(Math.abs(g-l)<=ve.PRECISION||Math.abs(y-c)<=ve.PRECISION){const N=t+s/2-(h+g/2),I=n+o/2-(f+y/2);return{path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:`${this.rotationTransform} translate(${N} ${I})`}}}const b=(s-2*l)/(g-2*l),A=(o-2*c)/(y-2*c),w=g/s,x=y/o;return{path:{"transform-origin":`${ve.svgRound(h)} ${ve.svgRound(f)}`,transform:`${this.rotationTransform} scale(${w} ${x}) translate(${ve.svgRound(l)} ${ve.svgRound(c)}) scale(${b} ${A}) translate(${ve.svgRound(-l)} ${ve.svgRound(-c)})`}}}getPathResizedSVGProperties([t,n,s,o]){const[l,c]=M(this,Jn,Go).call(this),h=d(this,_i),[f,g,y,b]=h;if(h[0]=t,h[1]=n,h[2]=s,h[3]=o,Math.abs(y-l)<=ve.PRECISION||Math.abs(b-c)<=ve.PRECISION){const I=t+s/2-(f+y/2),P=n+o/2-(g+b/2);for(const{line:k,points:L}of d(this,vs))ve._translate(k,I,P,k),ve._translate(L,I,P,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(s-2*l)/(y-2*l),w=(o-2*c)/(b-2*c),x=-A*(f+l)+t+l,N=-w*(g+c)+n+c;if(A!==1||w!==1||x!==0||N!==0)for(const{line:I,points:P}of d(this,vs))ve._rescale(I,x,N,A,w,I),ve._rescale(P,x,N,A,w,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],s){const[o,l]=s,c=d(this,_i),h=t-c[0],f=n-c[1];if(d(this,oo)===o&&d(this,ao)===l)for(const{line:g,points:y}of d(this,vs))ve._translate(g,h,f,g),ve._translate(y,h,f,y);else{const g=d(this,oo)/o,y=d(this,ao)/l;T(this,oo,o),T(this,ao,l);for(const{line:b,points:A}of d(this,vs))ve._rescale(b,h,f,g,y,b),ve._rescale(A,h,f,g,y,A);c[2]*=g,c[3]*=y}return c[0]=t,c[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t)} ${ve.svgRound(n)}`}}}get defaultSVGProperties(){const t=d(this,_i);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ve.svgRound(t[0])} ${ve.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}_i=new WeakMap,Uy=new WeakMap,Fy=new WeakMap,vs=new WeakMap,oo=new WeakMap,ao=new WeakMap,rp=new WeakMap,op=new WeakMap,od=new WeakMap,Jn=new WeakSet,Go=function(t=d(this,od)){const n=d(this,Fy)+t/2*d(this,rp);return d(this,op)%180===0?[n/d(this,oo),n/d(this,ao)]:[n/d(this,ao),n/d(this,oo)]},qP=function(){const[t,n,s,o]=d(this,_i),[l,c]=M(this,Jn,Go).call(this,0);return[t+l,n+c,s-2*l,o-2*c]},$P=function(){const t=T(this,_i,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:o}of d(this,vs)){if(o.length<=12){for(let h=4,f=o.length;h<f;h+=6)be.pointBoundingBox(o[h],o[h+1],t);continue}let l=o[4],c=o[5];for(let h=6,f=o.length;h<f;h+=6){const[g,y,b,A,w,x]=o.subarray(h,h+6);be.bezierBoundingBox(l,c,g,y,b,A,w,x,t),l=w,c=x}}const[n,s]=M(this,Jn,Go).call(this);t[0]=ci(t[0]-n,0,1),t[1]=ci(t[1]-s,0,1),t[2]=ci(t[2]+n,0,1),t[3]=ci(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},YP=function(t){const[n,s]=M(this,Jn,Go).call(this);T(this,od,t);const[o,l]=M(this,Jn,Go).call(this),[c,h]=[o-n,l-s],f=d(this,_i);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f};class E_ extends zP{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new E_(this._viewParameters);return e.updateAll(this),e}}var c_,jP;const Nh=class Nh extends Pb{constructor(t){super({...t,name:"inkEditor"});R(this,c_);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,n){Ut.initialize(t,n),this._defaultDrawingOptions=new E_(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return $e(this,"typesMap",new Map([[it.INK_THICKNESS,"stroke-width"],[it.INK_COLOR,"stroke"],[it.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,s,o,l){return new c$(t,n,s,o,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,s,o,l,c){return jy.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){let o=null;if(t instanceof lx){const{data:{inkLists:c,rect:h,rotation:f,id:g,color:y,opacity:b,borderStyle:{rawWidth:A},popupRef:w,richText:x,contentsObj:N,creationDate:I,modificationDate:P},parent:{page:{pageNumber:k}}}=t;o=t={annotationType:Ue.INK,color:Array.from(y),thickness:A,opacity:b,paths:{points:c},boxes:null,pageIndex:k-1,rect:h.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:w,richText:x,comment:(N==null?void 0:N.str)||null,creationDate:I,modificationDate:P}}const l=await super.deserialize(t,n,s);return l._initialData=o,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Mb(this)),[["colorPicker",this._colorPicker]]}get colorType(){return it.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:s}){this._drawingOptions=Nh.getDefaultDrawingOptions({stroke:be.makeHexColor(...t),"stroke-width":n,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":c}}=this,h=Object.assign(super.serialize(t),{color:Ut._colorManager.convert(o),opacity:l,thickness:c,paths:{lines:n,points:s}});return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!M(this,c_,jP).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:n,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};c_=new WeakSet,jP=function(t){const{color:n,thickness:s,opacity:o,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,h)=>c!==n[h])||t.thickness!==s||t.opacity!==o||t.pageIndex!==l},ce(Nh,"_type","ink"),ce(Nh,"_editorType",Ue.INK),ce(Nh,"_defaultDrawingOptions",null);let ZT=Nh;class ew extends jy{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Nv=8,_g=3;var ad,gt,tw,vr,WP,XP,nw,ab,KP,JP,QP,iw,sw,ZP;class ho{static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,l,c,h){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const y=200,b=g.font=`${n} ${s} ${y}px ${t}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:x,actualBoundingBoxDescent:N,fontBoundingBoxAscent:I,fontBoundingBoxDescent:P,width:k}=g.measureText(e),L=1.5,O=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,k)*L),F=Math.ceil(Math.max(Math.abs(x)+Math.abs(N)||y,Math.abs(I)+Math.abs(P)||y)*L);f=new OffscreenCanvas(O,F),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=b,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,F),g.fillStyle="black",g.fillText(e,O*(L-1)/2,F*(3-L)/2);const U=M(this,gt,iw).call(this,g.getImageData(0,0,O,F).data),X=M(this,gt,QP).call(this,U),q=M(this,gt,sw).call(this,X),Z=M(this,gt,nw).call(this,U,O,F,q);return this.processDrawnLines({lines:{curves:Z,width:O,height:F},pageWidth:o,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[l,c,h]=M(this,gt,ZP).call(this,e),[f,g]=M(this,gt,JP).call(this,l,c,h,Math.hypot(c,h)*d(this,ad).sigmaSFactor,d(this,ad).sigmaR,d(this,ad).kernelSize),y=M(this,gt,sw).call(this,g),b=M(this,gt,nw).call(this,f,c,h,y);return this.processDrawnLines({lines:{curves:b,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:l,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:g}=e,y=e.thickness??0,b=[],A=Math.min(t/f,n/g),w=A/t,x=A/n,N=[];for(const{points:P}of h){const k=l?M(this,gt,KP).call(this,P):P;if(!k)continue;N.push(k);const L=k.length,O=new Float32Array(L),F=new Float32Array(3*(L===2?2:L-2));if(b.push({line:F,points:O}),L===2){O[0]=k[0]*w,O[1]=k[1]*x,F.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[U,X,q,Z]=k;U*=w,X*=x,q*=w,Z*=x,O.set([U,X,q,Z],0),F.set([NaN,NaN,NaN,NaN,U,X],0);for(let ee=4;ee<L;ee+=2){const se=O[ee]=k[ee]*w,le=O[ee+1]=k[ee+1]*x;F.set(ve.createBezierPoints(U,X,q,Z,se,le),(ee-2)*3),[U,X,q,Z]=[q,Z,se,le]}}if(b.length===0)return null;const I=c?new ew:new jy;return I.build(b,t,n,1,s,c?0:y,o),{outline:I,newCurves:N,areContours:c,thickness:y,width:f,height:g}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let l=1/0,c=-1/0,h=0;for(const k of e){h+=k.length;for(let L=2,O=k.length;L<O;L++){const F=k[L]-k[L-2];l=Math.min(l,F),c=Math.max(c,F)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const g=e.length,y=Nv+_g*g,b=new Uint32Array(y);let A=0;b[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*g)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=s,b[A++]=o,b[A++]=t?0:1,b[A++]=Math.max(0,Math.floor(n??0)),b[A++]=g,b[A++]=f.BYTES_PER_ELEMENT;for(const k of e)b[A++]=k.length-2,b[A++]=k[0],b[A++]=k[1];const w=new CompressionStream("deflate-raw"),x=w.writable.getWriter();await x.ready,x.write(b);const N=f.prototype.constructor;for(const k of e){const L=new N(k.length-2);for(let O=2,F=k.length;O<F;O++)L[O-2]=k[O]-k[O-2];x.write(L)}x.close();const I=await new Response(w.readable).arrayBuffer(),P=new Uint8Array(I);return Kk(P)}static async decompressSignature(e){try{const t=P8(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,c=0;for await(const k of n)l||(l=new Uint8Array(new Uint32Array(k.buffer,0,4)[0])),l.set(k,c),c+=k.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=h[2],y=h[3],b=h[4]===0,A=h[5],w=h[6],x=h[7],N=[],I=(Nv+_g*w)*Uint32Array.BYTES_PER_ELEMENT;let P;switch(x){case Int8Array.BYTES_PER_ELEMENT:P=new Int8Array(l.buffer,I);break;case Int16Array.BYTES_PER_ELEMENT:P=new Int16Array(l.buffer,I);break;case Int32Array.BYTES_PER_ELEMENT:P=new Int32Array(l.buffer,I);break}c=0;for(let k=0;k<w;k++){const L=h[_g*k+Nv],O=new Float32Array(L+2);N.push(O);for(let F=0;F<_g-1;F++)O[F]=h[_g*k+Nv+F+1];for(let F=0;F<L;F++)O[F+2]=O[F]+P[c++]}return{areContours:b,thickness:A,outlines:N,width:g,height:y}}catch(t){return Fe(`decompressSignature: ${t}`),null}}}ad=new WeakMap,gt=new WeakSet,tw=function(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s},vr=new WeakMap,WP=function(e,t,n,s,o,l,c){const h=M(this,gt,tw).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(-f+h-c+16)%8,y=d(this,vr)[2*g],b=d(this,vr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},XP=function(e,t,n,s,o,l,c){const h=M(this,gt,tw).call(this,n,s,o,l);for(let f=0;f<8;f++){const g=(f+h+c+16)%8,y=d(this,vr)[2*g],b=d(this,vr)[2*g+1];if(e[(n+y)*t+(s+b)]!==0)return g}return-1},nw=function(e,t,n,s){const o=e.length,l=new Int32Array(o);for(let g=0;g<o;g++)l[g]=e[g]<=s?1:0;for(let g=1;g<n-1;g++)l[g*t]=l[g*t+t-1]=0;for(let g=0;g<t;g++)l[g]=l[t*n-1-g]=0;let c=1,h;const f=[];for(let g=1;g<n-1;g++){h=1;for(let y=1;y<t-1;y++){const b=g*t+y,A=l[b];if(A===0)continue;let w=g,x=y;if(A===1&&l[b-1]===0)c+=1,x-=1;else if(A>=1&&l[b+1]===0)c+=1,x+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const N=[y,g],I=x===y+1,P={isHole:I,points:N,id:c,parent:0};f.push(P);let k;for(const ee of f)if(ee.id===h){k=ee;break}k?k.isHole?P.parent=I?k.parent:h:P.parent=I?h:k.parent:P.parent=I?h:0;const L=M(this,gt,WP).call(this,l,t,g,y,w,x,0);if(L===-1){l[b]=-c,l[b]!==1&&(h=Math.abs(l[b]));continue}let O=d(this,vr)[2*L],F=d(this,vr)[2*L+1];const U=g+O,X=y+F;w=U,x=X;let q=g,Z=y;for(;;){const ee=M(this,gt,XP).call(this,l,t,q,Z,w,x,1);O=d(this,vr)[2*ee],F=d(this,vr)[2*ee+1];const se=q+O,le=Z+F;N.push(le,se);const ue=q*t+Z;if(l[ue+1]===0?l[ue]=-c:l[ue]===1&&(l[ue]=c),se===g&&le===y&&q===U&&Z===X){l[b]!==1&&(h=Math.abs(l[b]));break}else w=q,x=Z,q=se,Z=le}}}return f},ab=function(e,t,n,s){if(n-t<=4){for(let U=t;U<n-2;U+=2)s.push(e[U],e[U+1]);return}const o=e[t],l=e[t+1],c=e[n-4]-o,h=e[n-3]-l,f=Math.hypot(c,h),g=c/f,y=h/f,b=g*l-y*o,A=h/c,w=1/f,x=Math.atan(A),N=Math.cos(x),I=Math.sin(x),P=w*(Math.abs(N)+Math.abs(I)),k=w*(1-P+P**2),L=Math.max(Math.atan(Math.abs(I+N)*k),Math.atan(Math.abs(I-N)*k));let O=0,F=t;for(let U=t+2;U<n-2;U+=2){const X=Math.abs(b-g*e[U+1]+y*e[U]);X>O&&(F=U,O=X)}O>(f*L)**2?(M(this,gt,ab).call(this,e,t,F+2,s),M(this,gt,ab).call(this,e,F,n,s)):s.push(o,l)},KP=function(e){const t=[],n=e.length;return M(this,gt,ab).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t},JP=function(e,t,n,s,o,l){const c=new Float32Array(l**2),h=-2*s**2,f=l>>1;for(let x=0;x<l;x++){const N=(x-f)**2;for(let I=0;I<l;I++)c[x*l+I]=Math.exp((N+(I-f)**2)/h)}const g=new Float32Array(256),y=-2*o**2;for(let x=0;x<256;x++)g[x]=Math.exp(x**2/y);const b=e.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let x=0;x<n;x++)for(let N=0;N<t;N++){const I=x*t+N,P=e[I];let k=0,L=0;for(let F=0;F<l;F++){const U=x+F-f;if(!(U<0||U>=n))for(let X=0;X<l;X++){const q=N+X-f;if(q<0||q>=t)continue;const Z=e[U*t+q],ee=c[F*l+X]*g[Math.abs(Z-P)];k+=Z*ee,L+=ee}}const O=A[I]=Math.round(k/L);w[O]++}return[A,w]},QP=function(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t},iw=function(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const l=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*l;return n},sw=function(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let l=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-l>s&&(s=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t},ZP=function(e){const t=e,{width:n,height:s}=e,{maxDim:o}=d(this,ad);let l=n,c=s;if(n>o||s>o){let b=n,A=s,w=Math.log2(Math.max(n,s)/o);const x=Math.floor(w);w=w===x?x-1:x;for(let I=0;I<w;I++){l=Math.ceil(b/2),c=Math.ceil(A/2);const P=new OffscreenCanvas(l,c);P.getContext("2d").drawImage(e,0,0,b,A,0,0,l,c),b=l,A=c,e!==t&&e.close(),e=P.transferToImageBitmap()}const N=Math.min(o/l,o/c);l=Math.round(l*N),c=Math.round(c*N)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,l,c);const g=f.getImageData(0,0,l,c).data;return[M(this,gt,iw).call(this,g),l,c]},R(ho,gt),R(ho,ad,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),R(ho,vr,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class ux extends zP{constructor(){super(),super.updateProperties({fill:Ut._defaultLineColor,"stroke-width":0})}clone(){const e=new ux;return e.updateAll(this),e}}class dx extends E_{constructor(e){super(e),super.updateProperties({stroke:Ut._defaultLineColor,"stroke-width":1})}clone(){const e=new dx(this._viewParameters);return e.updateAll(this),e}}var ac,lo,lc,ld;const ns=class ns extends Pb{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});R(this,ac,!1);R(this,lo,null);R(this,lc,null);R(this,ld,null);this._willKeepAspectRatio=!0,T(this,lc,t.signatureData||null),T(this,lo,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,n){Ut.initialize(t,n),this._defaultDrawingOptions=new ux,this._defaultDrawnSignatureOptions=new dx(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return $e(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!d(this,lo)}}static computeTelemetryFinalData(t){const n=t.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(d(this,lc)){const{lines:o,mustSmooth:l,areContours:c,description:h,uuid:f,heightInPage:g}=d(this,lc),{rawDims:{pageWidth:y,pageHeight:b},rotation:A}=this.parent.viewport,w=ho.processDrawnLines({lines:o,pageWidth:y,pageHeight:b,rotation:A,innerMargin:ns._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(w,g,h,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:d(this,lo)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(t){T(this,ld,t),this.addEditToolbar()}getUuid(){return d(this,ld)}get description(){return d(this,lo)}set description(t){T(this,lo,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:n,thickness:s,width:o,height:l}=d(this,lc),c=Math.max(o,l),h=ho.processDrawnLines({lines:{curves:t.map(f=>({points:f})),thickness:s,width:o,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,s,o){const{x:l,y:c}=this,{outline:h}=T(this,lc,t);T(this,ac,h instanceof ew),this.description=s;let f;d(this,ac)?f=ns.getDefaultDrawingOptions():(f=ns._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:f});const[,g]=this.pageDimensions;let y=n/g;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(o),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!o,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return ho.process(t,n,s,o,ns._INNER_MARGIN)}getFromText(t,n){const{rawDims:{pageWidth:s,pageHeight:o},rotation:l}=this.parent.viewport;return ho.extractContoursFromText(t,n,s,o,l,ns._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return ho.processDrawnLines({lines:t,pageWidth:n,pageHeight:s,rotation:o,innerMargin:ns._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=ns.getDefaultDrawingOptions():(this._drawingOptions=ns._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:n,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:d(this,ac),color:[0,0,0],thickness:d(this,ac)?0:o});return this.addComment(l),t?(l.paths={lines:n,points:s},l.uuid=d(this,ld),l.isCopy=!0):l.lines=n,d(this,lo)&&(l.accessibilityData={type:"Figure",alt:d(this,lo)}),l}static deserializeDraw(t,n,s,o,l,c){return c.areContours?ew.deserialize(t,n,s,o,l,c):jy.deserialize(t,n,s,o,l,c)}static async deserialize(t,n,s){var l;const o=await super.deserialize(t,n,s);return T(o,ac,t.areContours),o.description=((l=t.accessibilityData)==null?void 0:l.alt)||"",T(o,ld,t.uuid),o}};ac=new WeakMap,lo=new WeakMap,lc=new WeakMap,ld=new WeakMap,ce(ns,"_type","signature"),ce(ns,"_editorType",Ue.SIGNATURE),ce(ns,"_defaultDrawingOptions",null);let rw=ns;var jt,Pn,cc,ba,uc,ap,_a,cd,co,bs,lp,ct,Gg,zg,lb,cb,ub,aw,db,eL;class ow extends Ut{constructor(t){super({...t,name:"stampEditor"});R(this,ct);R(this,jt,null);R(this,Pn,null);R(this,cc,null);R(this,ba,null);R(this,uc,null);R(this,ap,"");R(this,_a,null);R(this,cd,!1);R(this,co,null);R(this,bs,!1);R(this,lp,!1);T(this,ba,t.bitmapUrl),T(this,uc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,n){Ut.initialize(t,n)}static isHandlingMimeForPasting(t){return xb.includes(t)}static paste(t,n){n.pasteEditor({mode:Ue.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:o,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,h=await s.guess({name:"altText",request:{data:o,width:l,height:c,channels:o.length/(l*c)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const f=h.output;return await this.setGuessedAltText(f),n&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var t;d(this,Pn)&&(T(this,jt,null),this._uiManager.imageManager.deleteId(d(this,Pn)),(t=d(this,_a))==null||t.remove(),T(this,_a,null),d(this,co)&&(clearTimeout(d(this,co)),T(this,co,null))),super.remove()}rebuild(){if(!this.parent){d(this,Pn)&&M(this,ct,lb).call(this);return}super.rebuild(),this.div!==null&&(d(this,Pn)&&d(this,_a)===null&&M(this,ct,lb).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(d(this,cc)||d(this,jt)||d(this,ba)||d(this,uc)||d(this,Pn)||d(this,cd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;return this._isCopy&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),d(this,cd)||(d(this,jt)?M(this,ct,cb).call(this):M(this,ct,lb).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,n){const{id:s,bitmap:o}=this._uiManager.imageManager.getFromCanvas(t,n);n.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(T(this,Pn,s),o&&T(this,jt,o),T(this,cd,!1),M(this,ct,cb).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;d(this,co)!==null&&clearTimeout(d(this,co)),T(this,co,setTimeout(()=>{T(this,co,null),M(this,ct,aw).call(this)},200))}copyCanvas(t,n,s=!1){t||(t=224);const{width:o,height:l}=d(this,jt),c=new xr;let h=d(this,jt),f=o,g=l,y=null;if(n){if(o>n||l>n){const U=Math.min(n/o,n/l);f=Math.floor(o*U),g=Math.floor(l*U)}y=document.createElement("canvas");const A=y.width=Math.ceil(f*c.sx),w=y.height=Math.ceil(g*c.sy);d(this,bs)||(h=M(this,ct,ub).call(this,A,w));const x=y.getContext("2d");x.filter=this._uiManager.hcmFilter;let N="white",I="#cfcfd8";this._uiManager.hcmFilter!=="none"?I="black":U8.isDarkMode&&(N="#8f8f9d",I="#42414d");const P=15,k=P*c.sx,L=P*c.sy,O=new OffscreenCanvas(k*2,L*2),F=O.getContext("2d");F.fillStyle=N,F.fillRect(0,0,k*2,L*2),F.fillStyle=I,F.fillRect(0,0,k,L),F.fillRect(k,L,k,L),x.fillStyle=x.createPattern(O,"repeat"),x.fillRect(0,0,A,w),x.drawImage(h,0,0,h.width,h.height,0,0,A,w)}let b=null;if(s){let A,w;if(c.symmetric&&h.width<t&&h.height<t)A=h.width,w=h.height;else if(h=d(this,jt),o>t||l>t){const I=Math.min(t/o,t/l);A=Math.floor(o*I),w=Math.floor(l*I),d(this,bs)||(h=M(this,ct,ub).call(this,A,w))}const N=new OffscreenCanvas(A,w).getContext("2d",{willReadFrequently:!0});N.drawImage(h,0,0,h.width,h.height,0,0,A,w),b={width:A,height:w,data:N.getImageData(0,0,A,w).data}}return{canvas:y,width:f,height:g,imageData:b}}static async deserialize(t,n,s){var N;let o=null,l=!1;if(t instanceof mP){const{data:{rect:I,rotation:P,id:k,structParent:L,popupRef:O,richText:F,contentsObj:U,creationDate:X,modificationDate:q},container:Z,parent:{page:{pageNumber:ee}},canvas:se}=t;let le,ue;se?(delete t.canvas,{id:le,bitmap:ue}=s.imageManager.getFromCanvas(Z.id,se),se.remove()):(l=!0,t._hasNoCanvas=!0);const ye=((N=await n._structTree.getAriaAttributes(`${Qw}${k}`))==null?void 0:N.get("aria-label"))||"";o=t={annotationType:Ue.STAMP,bitmapId:le,bitmap:ue,pageIndex:ee-1,rect:I.slice(0),rotation:P,annotationElementId:k,id:k,deleted:!1,accessibilityData:{decorative:!1,altText:ye},isSvg:!1,structParent:L,popupRef:O,richText:F,comment:(U==null?void 0:U.str)||null,creationDate:X,modificationDate:q}}const c=await super.deserialize(t,n,s),{rect:h,bitmap:f,bitmapUrl:g,bitmapId:y,isSvg:b,accessibilityData:A}=t;l?(s.addMissingCanvas(t.id,c),T(c,cd,!0)):y&&s.imageManager.isValidId(y)?(T(c,Pn,y),f&&T(c,jt,f)):T(c,ba,g),T(c,bs,b);const[w,x]=c.pageDimensions;return c.width=(h[2]-h[0])/w,c.height=(h[3]-h[1])/x,A&&(c.altTextData=A),c._initialData=o,t.comment&&c.setCommentData(t),T(c,lp,!!o),c}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:d(this,Pn),isSvg:d(this,bs)});if(this.addComment(s),t)return s.bitmapUrl=M(this,ct,db).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:o,altText:l}=this.serializeAltText(!1);if(!o&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=M(this,ct,eL).call(this,s);return h.isSame?null:(h.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(n===null)return s;n.stamps||(n.stamps=new Map);const c=d(this,bs)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!n.stamps.has(d(this,Pn)))n.stamps.set(d(this,Pn),{area:c,serialized:s}),s.bitmap=M(this,ct,db).call(this,!1);else if(d(this,bs)){const h=n.stamps.get(d(this,Pn));c>h.area&&(h.area=c,h.serialized.bitmap.close(),h.serialized.bitmap=M(this,ct,db).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}jt=new WeakMap,Pn=new WeakMap,cc=new WeakMap,ba=new WeakMap,uc=new WeakMap,ap=new WeakMap,_a=new WeakMap,cd=new WeakMap,co=new WeakMap,bs=new WeakMap,lp=new WeakMap,ct=new WeakSet,Gg=function(t,n=!1){if(!t){this.remove();return}T(this,jt,t.bitmap),n||(T(this,Pn,t.id),T(this,bs,t.isSvg)),t.file&&T(this,ap,t.file.name),M(this,ct,cb).call(this)},zg=function(){if(T(this,cc,null),this._uiManager.enableWaiting(!1),!!d(this,_a)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,jt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,jt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},lb=function(){if(d(this,Pn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(d(this,Pn)).then(s=>M(this,ct,Gg).call(this,s,!0)).finally(()=>M(this,ct,zg).call(this));return}if(d(this,ba)){const s=d(this,ba);T(this,ba,null),this._uiManager.enableWaiting(!0),T(this,cc,this._uiManager.imageManager.getFromUrl(s).then(o=>M(this,ct,Gg).call(this,o)).finally(()=>M(this,ct,zg).call(this)));return}if(d(this,uc)){const s=d(this,uc);T(this,uc,null),this._uiManager.enableWaiting(!0),T(this,cc,this._uiManager.imageManager.getFromFile(s).then(o=>M(this,ct,Gg).call(this,o)).finally(()=>M(this,ct,zg).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=xb.join(",");const n=this._uiManager._signal;T(this,cc,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),M(this,ct,Gg).call(this,o)}s()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:n})}).finally(()=>M(this,ct,zg).call(this))),t.click()},cb=function(){var f;const{div:t}=this;let{width:n,height:s}=d(this,jt);const[o,l]=this.pageDimensions,c=.75;if(this.width)n=this.width*o,s=this.height*l;else if(n>c*o||s>c*l){const g=Math.min(c*o/n,c*l/s);n*=g,s*=g}this._uiManager.enableWaiting(!1);const h=T(this,_a,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/o,this.height=s/l,this.setDims(),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),M(this,ct,aw).call(this),d(this,lp)||(this.parent.addUndoableEditor(this),T(this,lp,!0)),this._reportTelemetry({action:"inserted_image"}),d(this,ap)&&this.div.setAttribute("aria-description",d(this,ap)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},ub=function(t,n){const{width:s,height:o}=d(this,jt);let l=s,c=o,h=d(this,jt);for(;l>2*t||c>2*n;){const f=l,g=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*n&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const y=new OffscreenCanvas(l,c);y.getContext("2d").drawImage(h,0,0,f,g,0,0,l,c),h=y.transferToImageBitmap()}return h},aw=function(){const[t,n]=this.parentDimensions,{width:s,height:o}=this,l=new xr,c=Math.ceil(s*t*l.sx),h=Math.ceil(o*n*l.sy),f=d(this,_a);if(!f||f.width===c&&f.height===h)return;f.width=c,f.height=h;const g=d(this,bs)?d(this,jt):M(this,ct,ub).call(this,c,h),y=f.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(g,0,0,g.width,g.height,0,0,c,h)},db=function(t){if(t){if(d(this,bs)){const o=this._uiManager.imageManager.getSvgUrl(d(this,Pn));if(o)return o}const n=document.createElement("canvas");return{width:n.width,height:n.height}=d(this,jt),n.getContext("2d").drawImage(d(this,jt),0,0),n.toDataURL()}if(d(this,bs)){const[n,s]=this.pageDimensions,o=Math.round(this.width*n*Pa.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Pa.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(o,l);return c.getContext("2d").drawImage(d(this,jt),0,0,d(this,jt).width,d(this,jt).height,0,0,o,l),c.transferToImageBitmap()}return structuredClone(d(this,jt))},eL=function(t){var c;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,o=t.pageIndex===n,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&o&&l,isSameAltText:l}},ce(ow,"_type","stamp"),ce(ow,"_editorType",Ue.STAMP);var ud,cp,dc,hc,Sa,$i,fc,up,dp,br,Aa,Ln,Ea,pc,hp,xe,gc,Pt,lw,tL,Hr,cw,uw,hb;const lr=class lr{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:g}){R(this,Pt);R(this,ud);R(this,cp,!1);R(this,dc,null);R(this,hc,null);R(this,Sa,null);R(this,$i,new Map);R(this,fc,!1);R(this,up,!1);R(this,dp,!1);R(this,br,null);R(this,Aa,null);R(this,Ln,null);R(this,Ea,null);R(this,pc,null);R(this,hp,-1);R(this,xe);const y=[...d(lr,gc).values()];if(!lr._initialized){lr._initialized=!0;for(const b of y)b.initialize(g,e)}e.registerEditorTypes(y),T(this,xe,e),this.pageIndex=t,this.div=n,T(this,ud,o),T(this,dc,l),this.viewport=f,T(this,Ln,h),this.drawLayer=c,this._structTree=s,d(this,xe).addLayer(this)}get isEmpty(){return d(this,$i).size===0}get isInvisible(){return this.isEmpty&&d(this,xe).getMode()===Ue.NONE}updateToolbar(e){d(this,xe).updateToolbar(e)}updateMode(e=d(this,xe).getMode()){switch(M(this,Pt,hb).call(this),e){case Ue.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ue.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ue.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ue.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of d(lr,gc).values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=d(this,Ln))==null?void 0:t.div)}setEditingState(e){d(this,xe).setEditingState(e)}addCommands(e){d(this,xe).addCommands(e)}cleanUndoStack(e){d(this,xe).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=d(this,dc))==null||t.div.classList.toggle("disabled",!e)}async enable(){var n;T(this,dp,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=d(this,pc))==null||n.abort(),T(this,pc,null);const e=new Set;for(const s of d(this,Pt,lw))s.enableEditing(),s.show(!0),s.annotationElementId&&(d(this,xe).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=d(this,dc);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),d(this,xe).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const o=await this.deserialize(s);o&&(this.addOrRebuild(o),o.enableEditing())}T(this,dp,!1),d(this,xe)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var n;if(T(this,up,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),d(this,Ln)&&!d(this,pc)){T(this,pc,new AbortController);const s=d(this,xe).combinedSignal(d(this,pc));d(this,Ln).div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,g=d(this,hp);if(f-g>500){T(this,hp,f);return}T(this,hp,-1);const{classList:y}=this.div;y.toggle("getElements",!0);const b=document.elementsFromPoint(c,h);if(y.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${Kg}[0-9]+$`);for(const N of b)if(w.test(N.id)){A=N.id;break}if(!A)return;const x=d(this,$i).get(A);(x==null?void 0:x.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),x.dblclick(o))},{signal:s,capture:!0})}const e=d(this,dc);if(e){const s=new Map,o=new Map;for(const c of d(this,Pt,lw)){if(c.disableEditing(),!c.annotationElementId){c.updateFakeAnnotationElement(e);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);(n=this.getEditableAnnotation(c.annotationElementId))==null||n.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(d(this,xe).isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=s.get(h),f&&(d(this,xe).addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}M(this,Pt,hb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const s of d(lr,gc).values())t.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,up,!1)}getEditableAnnotation(e){var t;return((t=d(this,dc))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){d(this,xe).getActive()!==e&&d(this,xe).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=d(this,Ln))!=null&&e.div&&!d(this,Ea)){T(this,Ea,new AbortController);const t=d(this,xe).combinedSignal(d(this,Ea));d(this,Ln).div.addEventListener("pointerdown",M(this,Pt,tL).bind(this),{signal:t}),d(this,Ln).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=d(this,Ln))!=null&&e.div&&d(this,Ea)&&(d(this,Ea).abort(),T(this,Ea,null),d(this,Ln).div.classList.remove("highlighting"))}enableClick(){if(d(this,hc))return;T(this,hc,new AbortController);const e=d(this,xe).combinedSignal(d(this,hc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=d(this,hc))==null||e.abort(),T(this,hc,null)}attach(e){d(this,$i).set(e.id,e);const{annotationElementId:t}=e;t&&d(this,xe).isDeletedAnnotationElement(t)&&d(this,xe).removeDeletedAnnotationElement(e)}detach(e){var t;d(this,$i).delete(e.id),(t=d(this,ud))==null||t.removePointerInTextLayer(e.contentDiv),!d(this,up)&&e.annotationElementId&&d(this,xe).addDeletedAnnotationElement(e)}remove(e){this.detach(e),d(this,xe).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(d(this,xe).addDeletedAnnotationElement(e.annotationElementId),Ut.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),d(this,xe).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!d(this,dp)),d(this,xe).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!d(this,Sa)&&(e._focusEventsAllowed=!1,T(this,Sa,setTimeout(()=>{T(this,Sa,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:d(this,xe)._signal}),t.focus())},0))),e._structTreeParentId=(n=d(this,ud))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of d(this,$i).values())if(t.uid===e)return t;return null}getNextId(){return d(this,xe).getId()}combinedSignal(e){return d(this,xe).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=d(this,Pt,Hr))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await d(this,xe).updateMode(e.mode);const{offsetX:n,offsetY:s}=M(this,Pt,uw).call(this),o=this.getNextId(),l=M(this,Pt,cw).call(this,{parent:this,id:o,x:n,y:s,uiManager:d(this,xe),isCentered:!0,...t});l&&this.add(l)}async deserialize(e){var t;return await((t=d(lr,gc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,d(this,xe)))||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=M(this,Pt,cw).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:d(this,xe),isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(M(this,Pt,uw).call(this),!0,e)}setSelected(e){d(this,xe).setSelected(e)}toggleSelected(e){d(this,xe).toggleSelected(e)}unselect(e){d(this,xe).unselect(e)}pointerup(e){var s;const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!d(this,fc)||(T(this,fc,!1),(s=d(this,Pt,Hr))!=null&&s.isDrawer&&d(this,Pt,Hr).supportMultipleDrawings))return;if(!d(this,cp)){T(this,cp,!0);return}const n=d(this,xe).getMode();if(n===Ue.STAMP||n===Ue.SIGNATURE){d(this,xe).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(d(this,xe).getMode()===Ue.HIGHLIGHT&&this.enableTextSelection(),d(this,fc)){T(this,fc,!1);return}const{isMac:t}=On.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(T(this,fc,!0),(s=d(this,Pt,Hr))!=null&&s.isDrawer){this.startDrawingSession(e);return}const n=d(this,xe).getActive();T(this,cp,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),d(this,br)){d(this,Pt,Hr).startDrawing(this,d(this,xe),!1,e);return}d(this,xe).setCurrentDrawingSession(this),T(this,br,new AbortController);const t=d(this,xe).combinedSignal(d(this,br));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(T(this,Aa,null),this.commitOrRemove())},{signal:t}),d(this,Pt,Hr).startDrawing(this,d(this,xe),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&T(this,Aa,t);return}d(this,Aa)&&setTimeout(()=>{var t;(t=d(this,Aa))==null||t.focus(),T(this,Aa,null)},0)}endDrawingSession(e=!1){return d(this,br)?(d(this,xe).setCurrentDrawingSession(null),d(this,br).abort(),T(this,br,null),T(this,Aa,null),d(this,Pt,Hr).endDrawing(e)):null}findNewParent(e,t,n){const s=d(this,xe).findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return d(this,br)?(this.endDrawingSession(),!0):!1}onScaleChanging(){d(this,br)&&d(this,Pt,Hr).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=d(this,xe).getActive())==null?void 0:e.parent)===this&&(d(this,xe).commitOrRemove(),d(this,xe).setActiveEditor(null)),d(this,Sa)&&(clearTimeout(d(this,Sa)),T(this,Sa,null));for(const n of d(this,$i).values())(t=d(this,ud))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,d(this,$i).clear(),d(this,xe).removeLayer(this)}render({viewport:e}){this.viewport=e,vc(this.div,e);for(const t of d(this,xe).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){d(this,xe).commitOrRemove(),M(this,Pt,hb).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,vc(this.div,{rotation:n}),t!==n)for(const s of d(this,$i).values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return d(this,xe).viewParameters.realScale}};ud=new WeakMap,cp=new WeakMap,dc=new WeakMap,hc=new WeakMap,Sa=new WeakMap,$i=new WeakMap,fc=new WeakMap,up=new WeakMap,dp=new WeakMap,br=new WeakMap,Aa=new WeakMap,Ln=new WeakMap,Ea=new WeakMap,pc=new WeakMap,hp=new WeakMap,xe=new WeakMap,gc=new WeakMap,Pt=new WeakSet,lw=function(){return d(this,$i).size!==0?d(this,$i).values():d(this,xe).getEditors(this.pageIndex)},tL=function(e){d(this,xe).unselectAll();const{target:t}=e;if(t===d(this,Ln).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&d(this,Ln).div.contains(t)){const{isMac:n}=On.platform;if(e.button!==0||e.ctrlKey&&n)return;d(this,xe).showAllEditors("highlight",!0,!0),d(this,Ln).div.classList.add("free"),this.toggleDrawing(),kb.startHighlighting(this,d(this,xe).direction==="ltr",{target:d(this,Ln).div,x:e.x,y:e.y}),d(this,Ln).div.addEventListener("pointerup",()=>{d(this,Ln).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:d(this,xe)._signal}),e.preventDefault()}},Hr=function(){return d(lr,gc).get(d(this,xe).getMode())},cw=function(e){const t=d(this,Pt,Hr);return t?new t.prototype.constructor(e):null},uw=function(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,g=(l+h)/2-t,[y,b]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:y,offsetY:b}},hb=function(){for(const e of d(this,$i).values())e.isEmpty()&&e.remove()},ce(lr,"_initialized",!1),R(lr,gc,new Map([VT,ZT,ow,kb,rw].map(e=>[e._editorType,e])));let Lb=lr;var _r,Si,dd,By,u_,nL,yo,dw,iL,hw;const En=class En{constructor({pageIndex:e}){R(this,yo);R(this,_r,null);R(this,Si,new Map);R(this,dd,new Map);this.pageIndex=e}setParent(e){if(!d(this,_r)){T(this,_r,e);return}if(d(this,_r)!==e){if(d(this,Si).size>0)for(const t of d(this,Si).values())t.remove(),e.append(t);T(this,_r,e)}}static get _svgFactory(){return $e(this,"_svgFactory",new im)}draw(e,t=!1,n=!1){const s=An(En,By)._++,o=M(this,yo,dw).call(this),l=En._svgFactory.createElement("defs");o.append(l);const c=En._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&d(this,dd).set(s,c);const f=n?M(this,yo,iL).call(this,l,h):null,g=En._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(o,e),d(this,Si).set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=An(En,By)._++,s=M(this,yo,dw).call(this),o=En._svgFactory.createElement("defs");s.append(o);const l=En._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const y=En._svgFactory.createElement("mask");o.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const b=En._svgFactory.createElement("rect");y.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=En._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${c}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=En._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,e),d(this,Si).set(n,s),n}finalizeDraw(e,t){d(this,dd).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var h;if(!t)return;const{root:n,bbox:s,rootClass:o,path:l}=t,c=typeof e=="number"?d(this,Si).get(e):e;if(c){if(n&&M(this,yo,hw).call(this,c,n),s&&M(h=En,u_,nL).call(h,c,s),o){const{classList:f}=c;for(const[g,y]of Object.entries(o))f.toggle(g,y)}if(l){const g=c.firstChild.firstChild;M(this,yo,hw).call(this,g,l)}}}updateParent(e,t){if(t===this)return;const n=d(this,Si).get(e);n&&(d(t,_r).append(n),d(this,Si).delete(e),d(t,Si).set(e,n))}remove(e){d(this,dd).delete(e),d(this,_r)!==null&&(d(this,Si).get(e).remove(),d(this,Si).delete(e))}destroy(){T(this,_r,null);for(const e of d(this,Si).values())e.remove();d(this,Si).clear(),d(this,dd).clear()}};_r=new WeakMap,Si=new WeakMap,dd=new WeakMap,By=new WeakMap,u_=new WeakSet,nL=function(e,[t,n,s,o]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*o}%`},yo=new WeakSet,dw=function(){const e=En._svgFactory.create(1,1,!0);return d(this,_r).append(e),e.setAttribute("aria-hidden",!0),e},iL=function(e,t){const n=En._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=En._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s},hw=function(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)},R(En,u_),R(En,By,0);let Ob=En;globalThis._pdfjsTestingUtils={HighlightOutliner:$T};globalThis.pdfjsLib={AbortException:ka,AnnotationEditorLayer:Lb,AnnotationEditorParamsType:it,AnnotationEditorType:Ue,AnnotationEditorUIManager:bc,AnnotationLayer:cx,AnnotationMode:uo,AnnotationType:un,applyOpacity:t2,build:sP,ColorPicker:nm,createValidAbsoluteUrl:Xw,CSSConstants:e2,DOMSVGFactory:im,DrawLayer:Ob,FeatureTest:On,fetchData:_p,findContrastColor:n2,getDocument:sx,getFilenameFromUrl:Jk,getPdfFilenameFromUrl:Qk,getRGB:Sp,getUuid:Jw,getXfaPageViewport:Zk,GlobalWorkerOptions:Qs,ImageKind:Yg,InvalidPDFException:wb,isDataScheme:qy,isPdfFile:S_,isValidExplicitDest:L2,MathClamp:ci,noContextMenu:xs,normalizeUnicode:Xk,OPS:fp,OutputScale:xr,PasswordResponses:jk,PDFDataRangeTransport:rx,PDFDateString:Zg,PDFWorker:pp,PermissionFlag:Yk,PixelsPerInch:Pa,RenderingCancelledException:__,renderRichText:ex,ResponseException:Jg,setLayerDimensions:vc,shadow:$e,SignatureExtractor:ho,stopEvent:Jt,SupportedImageMimeTypes:xb,TextLayer:tm,TouchManager:em,updateUrlHash:Kw,Util:be,VerbosityLevel:Gy,version:ox,XfaLayer:Zw};const u$=Object.freeze(Object.defineProperty({__proto__:null,AbortException:ka,AnnotationEditorLayer:Lb,AnnotationEditorParamsType:it,AnnotationEditorType:Ue,AnnotationEditorUIManager:bc,AnnotationLayer:cx,AnnotationMode:uo,AnnotationType:un,CSSConstants:e2,ColorPicker:nm,DOMSVGFactory:im,DrawLayer:Ob,FeatureTest:On,GlobalWorkerOptions:Qs,ImageKind:Yg,InvalidPDFException:wb,MathClamp:ci,OPS:fp,OutputScale:xr,PDFDataRangeTransport:rx,PDFDateString:Zg,PDFWorker:pp,PasswordResponses:jk,PermissionFlag:Yk,PixelsPerInch:Pa,RenderingCancelledException:__,ResponseException:Jg,SignatureExtractor:ho,SupportedImageMimeTypes:xb,TextLayer:tm,TouchManager:em,Util:be,VerbosityLevel:Gy,XfaLayer:Zw,applyOpacity:t2,build:sP,createValidAbsoluteUrl:Xw,fetchData:_p,findContrastColor:n2,getDocument:sx,getFilenameFromUrl:Jk,getPdfFilenameFromUrl:Qk,getRGB:Sp,getUuid:Jw,getXfaPageViewport:Zk,isDataScheme:qy,isPdfFile:S_,isValidExplicitDest:L2,noContextMenu:xs,normalizeUnicode:Xk,renderRichText:ex,setLayerDimensions:vc,shadow:$e,stopEvent:Jt,updateUrlHash:Kw,version:ox},Symbol.toStringTag,{value:"Module"}));function sL(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var s=i.length;for(e=0;e<s;e++)i[e]&&(t=sL(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function T_(){for(var i,e,t=0,n="",s=arguments.length;t<s;t++)(i=arguments[t])&&(e=sL(i))&&(n&&(n+=" "),n+=e);return n}var JM=Object.prototype.hasOwnProperty;function QM(i,e,t){for(t of i.keys())if(Ph(t,e))return t}function Ph(i,e){var t,n,s;if(i===e)return!0;if(i&&e&&(t=i.constructor)===e.constructor){if(t===Date)return i.getTime()===e.getTime();if(t===RegExp)return i.toString()===e.toString();if(t===Array){if((n=i.length)===e.length)for(;n--&&Ph(i[n],e[n]););return n===-1}if(t===Set){if(i.size!==e.size)return!1;for(n of i)if(s=n,s&&typeof s=="object"&&(s=QM(e,s),!s)||!e.has(s))return!1;return!0}if(t===Map){if(i.size!==e.size)return!1;for(n of i)if(s=n[0],s&&typeof s=="object"&&(s=QM(e,s),!s)||!Ph(n[1],e.get(s)))return!1;return!0}if(t===ArrayBuffer)i=new Uint8Array(i),e=new Uint8Array(e);else if(t===DataView){if((n=i.byteLength)===e.byteLength)for(;n--&&i.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(i)){if((n=i.byteLength)===e.byteLength)for(;n--&&i[n]===e[n];);return n===-1}if(!t||typeof i=="object"){n=0;for(t in i)if(JM.call(i,t)&&++n&&!JM.call(e,t)||!(t in e)||!Ph(i[t],e[t]))return!1;return Object.keys(e).length===n}}return i!==i&&e!==e}function Wy(i){let e=!1;return{promise:new Promise((n,s)=>{i.then(o=>!e&&n(o)).catch(o=>!e&&s(o))}),cancel(){e=!0}}}const d$=["onCopy","onCut","onPaste"],h$=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],f$=["onFocus","onBlur"],p$=["onInput","onInvalid","onReset","onSubmit"],g$=["onLoad","onError"],m$=["onKeyDown","onKeyPress","onKeyUp"],y$=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],v$=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],b$=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],_$=["onSelect"],S$=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],A$=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],E$=["onScroll"],T$=["onWheel"],w$=["onAnimationStart","onAnimationEnd","onAnimationIteration"],x$=["onTransitionEnd"],C$=["onToggle"],R$=["onChange"],I$=[...d$,...h$,...f$,...p$,...g$,...m$,...y$,...v$,...b$,..._$,...S$,...A$,...E$,...T$,...w$,...x$,...R$,...C$];function rL(i,e){const t={};for(const n of I$){const s=i[n];s&&(e?t[n]=(o=>s(o,e(n))):t[n]=s)}return t}var N$="Invariant failed";function Dt(i,e){if(!i)throw new Error(N$)}var hE,ZM;function M$(){if(ZM)return hE;ZM=1;var i=function(){};return hE=i,hE}var D$=M$();const ui=xw(D$),oL=J.createContext(null),k$="noopener noreferrer nofollow";class P${constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Dt(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Dt(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||k$,e.target=n?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Dt(this.pdfDocument),Dt(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Dt(Array.isArray(t));const n=t[0];new Promise(s=>{Dt(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(o=>{s(o)}).catch(()=>{Dt(!1)}):typeof n=="number"?s(n):Dt(!1)}).then(s=>{const o=s+1;Dt(this.pdfViewer),Dt(o>=1&&o<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:s,pageNumber:o})})})}goToPage(e){const t=e-1;Dt(this.pdfViewer),Dt(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function Lh({children:i,type:e}){return E.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:i})}const eD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function L$(i,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return i}}function gp(){return J.useReducer(L$,{value:void 0,error:void 0})}const w_=typeof window<"u",aL=w_&&window.location.protocol==="file:";function O$(i){return typeof i<"u"}function qc(i){return O$(i)&&i!==null}function U$(i){return typeof i=="string"}function F$(i){return i instanceof ArrayBuffer}function B$(i){return Dt(w_),i instanceof Blob}function fw(i){return U$(i)&&/^data:/.test(i)}function tD(i){Dt(fw(i));const[e="",t=""]=i.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function H$(){return w_&&window.devicePixelRatio||1}const lL="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function nD(){ui(!aL,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${lL}`)}function G$(){ui(!aL,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${lL}`)}function fd(i){i!=null&&i.cancel&&i.cancel()}function pw(i,e){return Object.defineProperty(i,"width",{get(){return this.getViewport({scale:e}).width},configurable:!0}),Object.defineProperty(i,"height",{get(){return this.getViewport({scale:e}).height},configurable:!0}),Object.defineProperty(i,"originalWidth",{get(){return this.getViewport({scale:1}).width},configurable:!0}),Object.defineProperty(i,"originalHeight",{get(){return this.getViewport({scale:1}).height},configurable:!0}),i}function cL(i){return i.name==="AbortException"||i.name==="RenderingCancelledException"}function z$(i){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=s=>{if(!s.target)return t(new Error("Error while reading a file."));const{error:o}=s.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(i)})}const{PDFDataRangeTransport:V$}=u$,q$=(i,e)=>{switch(e){case eD.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");i(t);break}case eD.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");i(t);break}}};function iD(i){return typeof i=="object"&&i!==null&&("data"in i||"range"in i||"url"in i)}const $$=J.forwardRef(function({children:e,className:t,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF",noData:g="No PDF file specified.",onItemClick:y,onLoadError:b,onLoadProgress:A,onLoadSuccess:w,onPassword:x=q$,onSourceError:N,onSourceSuccess:I,options:P,renderMode:k,rotate:L,scale:O,...F},U){const[X,q]=gp(),{value:Z,error:ee}=X,[se,le]=gp(),{value:ue,error:ye}=se,G=J.useRef(new P$),$=J.useRef([]),oe=J.useRef(void 0),ge=J.useRef(void 0);l&&l!==oe.current&&iD(l)&&(ui(!Ph(l,oe.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),oe.current=l),P&&P!==ge.current&&(ui(!Ph(P,ge.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ge.current=P);const Me=J.useRef({scrollPageIntoView:at=>{const{dest:Je,pageNumber:mt,pageIndex:Vt=mt-1}=at;if(y){y({dest:Je,pageIndex:Vt,pageNumber:mt});return}const Ft=$.current[Vt];if(Ft){Ft.scrollIntoView();return}ui(!1,`An internal link leading to page ${mt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});J.useImperativeHandle(U,()=>({linkService:G,pages:$,viewer:Me}),[]);function H(){I&&I()}function K(){ee&&(ui(!1,ee.toString()),N&&N(ee))}function re(){q({type:"RESET"})}J.useEffect(re,[l,q]);const de=J.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return fw(l)?{data:tD(l)}:(nD(),{url:l});if(l instanceof V$)return{range:l};if(F$(l))return{data:l};if(w_&&B$(l))return{data:await z$(l)};if(Dt(typeof l=="object"),Dt(iD(l)),"url"in l&&typeof l.url=="string"){if(fw(l.url)){const{url:at,...Je}=l;return{data:tD(at),...Je}}nD()}return l},[l]);J.useEffect(()=>{const at=Wy(de());return at.promise.then(Je=>{q({type:"RESOLVE",value:Je})}).catch(Je=>{q({type:"REJECT",error:Je})}),()=>{fd(at)}},[de,q]),J.useEffect(()=>{if(!(typeof Z>"u")){if(Z===!1){K();return}H()}},[Z]);function _e(){ue&&(w&&w(ue),$.current=new Array(ue.numPages),G.current.setDocument(ue))}function Se(){ye&&(ui(!1,ye.toString()),b&&b(ye))}J.useEffect(function(){le({type:"RESET"})},[le,Z]),J.useEffect(function(){if(!Z)return;const Je=P?{...Z,...P}:Z,mt=sx(Je);A&&(mt.onProgress=A),x&&(mt.onPassword=x);const Vt=mt;return Vt.promise.then(Ft=>{Vt.destroyed||le({type:"RESOLVE",value:Ft})}).catch(Ft=>{Vt.destroyed||le({type:"REJECT",error:Ft})}),()=>{Vt.destroy()}},[P,le,Z]),J.useEffect(()=>{if(!(typeof ue>"u")){if(ue===!1){Se();return}_e()}},[ue]),J.useEffect(function(){G.current.setViewer(Me.current),G.current.setExternalLinkRel(s),G.current.setExternalLinkTarget(o)},[s,o]);const Te=J.useCallback((at,Je)=>{$.current[at]=Je},[]),Ke=J.useCallback(at=>{delete $.current[at]},[]),Ve=J.useMemo(()=>({imageResourcesPath:h,linkService:G.current,onItemClick:y,pdf:ue,registerPage:Te,renderMode:k,rotate:L,scale:O,unregisterPage:Ke}),[h,y,ue,Te,k,L,O,Ke]),zt=J.useMemo(()=>rL(F,()=>ue),[F,ue]);function We(){function at(mt){return!!(mt!=null&&mt.pdf)}if(!at(Ve))throw new Error("pdf is undefined");const Je=typeof e=="function"?e(Ve):e;return E.jsx(oL.Provider,{value:Ve,children:Je})}function Fn(){return l?ue==null?E.jsx(Lh,{type:"loading",children:typeof f=="function"?f():f}):ue===!1?E.jsx(Lh,{type:"error",children:typeof n=="function"?n():n}):We():E.jsx(Lh,{type:"no-data",children:typeof g=="function"?g():g})}return E.jsx("div",{className:T_("react-pdf__Document",t),ref:c,...zt,children:Fn()})});function uL(){return J.useContext(oL)}function dL(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=i.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(o){for(var l=0,c=t;l<c.length;l++){var h=c[l];typeof h=="function"?h(o):h&&(h.current=o)}}}const hL=J.createContext(null);function x_(){return J.useContext(hL)}function Y$(){const i=uL(),e=x_();Dt(e);const t={...i,...e},{filterAnnotations:n,imageResourcesPath:s,linkService:o,onGetAnnotationsError:l,onGetAnnotationsSuccess:c,onRenderAnnotationLayerError:h,onRenderAnnotationLayerSuccess:f,page:g,pdf:y,renderForms:b,rotate:A,scale:w=1}=t;Dt(y),Dt(g),Dt(o);const[x,N]=gp(),{value:I,error:P}=x,k=J.useRef(null);ui(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function L(){I&&c&&c(I)}function O(){P&&(ui(!1,P.toString()),l&&l(P))}J.useEffect(function(){N({type:"RESET"})},[N,g]),J.useEffect(function(){if(!g)return;const Z=Wy(g.getAnnotations()),ee=Z;return Z.promise.then(se=>{N({type:"RESOLVE",value:se})}).catch(se=>{N({type:"REJECT",error:se})}),()=>{fd(ee)}},[N,g]),J.useEffect(()=>{if(I!==void 0){if(I===!1){O();return}L()}},[I]);function F(){f&&f()}function U(q){ui(!1,`${q}`),h&&h(q)}const X=J.useMemo(()=>g.getViewport({scale:w,rotation:A}),[g,A,w]);return J.useEffect(function(){if(!y||!g||!o||!I)return;const{current:Z}=k;if(!Z)return;const ee=X.clone({dontFlip:!0}),se={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:y.annotationStorage,commentManager:null,div:Z,l10n:null,linkService:o,page:g,structTreeLayer:null,viewport:ee},le={annotations:n?n({annotations:I}):I,annotationStorage:y.annotationStorage,div:Z,imageResourcesPath:s,linkService:o,page:g,renderForms:b,viewport:ee};Z.innerHTML="";try{new cx(se).render(le),F()}catch(ue){U(ue)}return()=>{}},[I,n,s,o,g,y,b,X]),E.jsx("div",{className:T_("react-pdf__Page__annotations","annotationLayer"),ref:k})}const fL={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},j$=/^H(\d+)$/;function W$(i){return i in fL}function C_(i){return"children"in i}function pL(i){return C_(i)?i.children.length===1&&0 in i.children&&"id"in i.children[0]:!1}function X$(i){const e={};if(C_(i)){const{role:t}=i,n=t.match(j$);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(W$(t)){const s=fL[t];s&&(e.role=s)}}return e}function gL(i){const e={};if(C_(i)){if(i.alt!==void 0&&(e["aria-label"]=i.alt),i.lang!==void 0&&(e.lang=i.lang),pL(i)){const[t]=i.children;if(t){const n=gL(t);return{...e,...n}}}}else"id"in i&&(e["aria-owns"]=i.id);return e}function K$(i){return i?{...X$(i),...gL(i)}:null}function mL({className:i,node:e}){const t=J.useMemo(()=>K$(e),[e]),n=J.useMemo(()=>!C_(e)||pL(e)?null:e.children.map((s,o)=>E.jsx(mL,{node:s},o)),[e]);return E.jsx("span",{className:i,...t,children:n})}function J$(){const i=x_();Dt(i);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=i,[n,s]=gp(),{value:o,error:l}=n,{customTextRenderer:c,page:h}=i;function f(){o&&t&&t(o)}function g(){l&&(ui(!1,l.toString()),e&&e(l))}return J.useEffect(function(){s({type:"RESET"})},[s,h]),J.useEffect(function(){if(c||!h)return;const b=Wy(h.getStructTree()),A=b;return b.promise.then(w=>{s({type:"RESOLVE",value:w})}).catch(w=>{s({type:"REJECT",error:w})}),()=>fd(A)},[c,h,s]),J.useEffect(()=>{if(o!==void 0){if(o===!1){g();return}f()}},[o]),o?E.jsx(mL,{className:"react-pdf__Page__structTree structTree",node:o}):null}const sD=uo;function Q$(i){const e=x_();Dt(e);const t={...e,...i},{_className:n,canvasBackground:s,devicePixelRatio:o=H$(),onRenderError:l,onRenderSuccess:c,page:h,renderForms:f,renderTextLayer:g,rotate:y,scale:b}=t,{canvasRef:A}=i;Dt(h);const w=J.useRef(null);function x(){h&&c&&c(pw(h,b))}function N(L){cL(L)||(ui(!1,L.toString()),l&&l(L))}const I=J.useMemo(()=>h.getViewport({scale:b*o,rotation:y}),[o,h,y,b]),P=J.useMemo(()=>h.getViewport({scale:b,rotation:y}),[h,y,b]);J.useEffect(function(){if(!h)return;h.cleanup();const{current:O}=w;if(!O)return;O.width=I.width,O.height=I.height,O.style.width=`${Math.floor(P.width)}px`,O.style.height=`${Math.floor(P.height)}px`,O.style.visibility="hidden";const F={annotationMode:f?sD.ENABLE_FORMS:sD.ENABLE,canvas:O,canvasContext:O.getContext("2d",{alpha:!1}),viewport:I};s&&(F.background=s);const U=h.render(F),X=U;return U.promise.then(()=>{O.style.visibility="",x()}).catch(N),()=>fd(X)},[s,h,f,I,P]);const k=J.useCallback(()=>{const{current:L}=w;L&&(L.width=0,L.height=0)},[]);return J.useEffect(()=>k,[k]),E.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:dL(A,w),style:{display:"block",userSelect:"none"},children:g?E.jsx(J$,{}):null})}function Z$(i){return"str"in i}function e7(){const i=x_();Dt(i);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:o,page:l,pageIndex:c,pageNumber:h,rotate:f,scale:g}=i;Dt(l);const[y,b]=gp(),{value:A,error:w}=y,x=J.useRef(null);ui(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function N(){A&&n&&n(A)}function I(){w&&(ui(!1,w.toString()),t&&t(w))}J.useEffect(function(){b({type:"RESET"})},[l,b]),J.useEffect(function(){if(!l)return;const X=Wy(l.getTextContent()),q=X;return X.promise.then(Z=>{b({type:"RESOLVE",value:Z})}).catch(Z=>{b({type:"REJECT",error:Z})}),()=>fd(q)},[l,b]),J.useEffect(()=>{if(A!==void 0){if(A===!1){I();return}N()}},[A]);const P=J.useCallback(()=>{o&&o()},[o]),k=J.useCallback(U=>{cL(U)||(ui(!1,U.toString()),s&&s(U))},[s]);function L(){const U=x.current;U&&U.classList.add("selecting")}function O(){const U=x.current;U&&U.classList.remove("selecting")}const F=J.useMemo(()=>l.getViewport({scale:g,rotation:f}),[l,f,g]);return J.useLayoutEffect(function(){if(!l||!A)return;const{current:X}=x;if(!X)return;X.innerHTML="";const q=l.streamTextContent({includeMarkedContent:!0}),Z={container:X,textContentSource:q,viewport:F},ee=new tm(Z),se=ee;return ee.render().then(()=>{const le=document.createElement("div");le.className="endOfContent",X.append(le);const ue=X.querySelectorAll('[role="presentation"]');if(e){let ye=0;A.items.forEach((G,$)=>{if(!Z$(G))return;const oe=ue[ye];if(!oe)return;const ge=e({pageIndex:c,pageNumber:h,itemIndex:$,...G});oe.innerHTML=ge,ye+=G.str&&G.hasEOL?2:1})}P()}).catch(k),()=>fd(se)},[e,k,P,l,c,h,A,F]),E.jsx("div",{className:T_("react-pdf__Page__textContent","textLayer"),onMouseUp:O,onMouseDown:L,ref:x})}const rD=1;function t7(i){const t={...uL(),...i},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:o,canvasRef:l,children:c,className:h,customRenderer:f,customTextRenderer:g,devicePixelRatio:y,error:b="Failed to load the page.",filterAnnotations:A,height:w,inputRef:x,loading:N="Loading page",noData:I="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:F,onGetTextSuccess:U,onLoadError:X,onLoadSuccess:q,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:ee,onRenderError:se,onRenderSuccess:le,onRenderTextLayerError:ue,onRenderTextLayerSuccess:ye,pageIndex:G,pageNumber:$,pdf:oe,registerPage:ge,renderAnnotationLayer:Me=!0,renderForms:H=!1,renderMode:K="canvas",renderTextLayer:re=!0,rotate:de,scale:_e=rD,unregisterPage:Se,width:Te,...Ke}=t,[Ve,zt]=gp(),{value:We,error:Fn}=Ve,at=J.useRef(null);Dt(oe);const Je=qc($)?$-1:G??null,mt=$??(qc(G)?G+1:null),Vt=de??(We?We.rotate:null),Ft=J.useMemo(()=>{if(!We)return null;let fn=1;const pi=_e??rD;if(Te||w){const Wi=We.getViewport({scale:1,rotation:Vt});Te?fn=Te/Wi.width:w&&(fn=w/Wi.height)}return pi*fn},[w,We,Vt,_e,Te]);J.useEffect(function(){return()=>{qc(Je)&&s&&Se&&Se(Je)}},[s,oe,Je,Se]);function ji(){if(q){if(!We||!Ft)return;q(pw(We,Ft))}if(s&&ge){if(!qc(Je)||!at.current)return;ge(Je,at.current)}}function hi(){Fn&&(ui(!1,Fn.toString()),X&&X(Fn))}J.useEffect(function(){zt({type:"RESET"})},[zt,oe,Je]),J.useEffect(function(){if(!oe||!mt)return;const pi=Wy(oe.getPage(mt)),Wi=pi;return pi.promise.then(Va=>{zt({type:"RESOLVE",value:Va})}).catch(Va=>{zt({type:"REJECT",error:Va})}),()=>fd(Wi)},[zt,oe,mt]),J.useEffect(()=>{if(We!==void 0){if(We===!1){hi();return}ji()}},[We,Ft]);const Ii=J.useMemo(()=>qc(Je)&&mt&&qc(Vt)&&qc(Ft)?{_className:n,canvasBackground:o,customTextRenderer:g,devicePixelRatio:y,filterAnnotations:A,onGetAnnotationsError:P,onGetAnnotationsSuccess:k,onGetStructTreeError:L,onGetStructTreeSuccess:O,onGetTextError:F,onGetTextSuccess:U,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:ee,onRenderError:se,onRenderSuccess:le,onRenderTextLayerError:ue,onRenderTextLayerSuccess:ye,page:We,pageIndex:Je,pageNumber:mt,renderForms:H,renderTextLayer:re,rotate:Vt,scale:Ft}:null,[n,o,g,y,A,P,k,L,O,F,U,Z,ee,se,le,ue,ye,We,Je,mt,H,re,Vt,Ft]),Rs=J.useMemo(()=>rL(Ke,()=>We&&(Ft?pw(We,Ft):void 0)),[Ke,We,Ft]),ae=`${Je}@${Ft}/${Vt}`;function Be(){switch(K){case"custom":return Dt(f),E.jsx(f,{},`${ae}_custom`);case"none":return null;case"canvas":default:return E.jsx(Q$,{canvasRef:l},`${ae}_canvas`)}}function Ce(){return re?E.jsx(e7,{},`${ae}_text`):null}function Wt(){return Me?E.jsx(Y$,{},`${ae}_annotations`):null}function fi(){function fn(Wi){return!!(Wi!=null&&Wi.page)}if(!fn(Ii))throw new Error("page is undefined");const pi=typeof c=="function"?c(Ii):c;return E.jsxs(hL.Provider,{value:Ii,children:[Be(),Ce(),Wt(),pi]})}function Zn(){return mt?oe===null||We===void 0||We===null?E.jsx(Lh,{type:"loading",children:typeof N=="function"?N():N}):oe===!1||We===!1?E.jsx(Lh,{type:"error",children:typeof b=="function"?b():b}):fi():E.jsx(Lh,{type:"no-data",children:typeof I=="function"?I():I})}return E.jsx("div",{className:T_(n,h),"data-page-number":mt,ref:dL(x,at),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Ft}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:o||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...Rs,children:Zn()})}G$();Qs.workerSrc="pdf.worker.mjs";Qs.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${ox}/pdf.worker.min.js`;const n7=({book:i,onClose:e,onReward:t,onUpdateBookData:n})=>{const[s,o]=J.useState(!1),[l,c]=J.useState(""),[h,f]=J.useState(!0),[g,y]=J.useState(i.isLocal?"complete":"selecting"),[b,A]=J.useState(i.currentChapter||1),[w,x]=J.useState(null),[N,I]=J.useState(i.userHighlights||[]),[P,k]=J.useState(i.userNotes||[]),[L,O]=J.useState(null),[F,U]=J.useState(""),[X,q]=J.useState(!1),[Z,ee]=J.useState(""),[se,le]=J.useState([]),[ue,ye]=J.useState(""),[G,$]=J.useState(!1),[oe,ge]=J.useState(null),[Me,H]=J.useState(!1),[K,re]=J.useState(""),[de,_e]=J.useState(!1),[Se,Te]=J.useState(null),[Ke,Ve]=J.useState(i.lastPage||1),[zt,We]=J.useState(""),[Fn,at]=J.useState(!1),Je=J.useRef(null);J.useRef(null);const[mt,Vt]=J.useState(!1),[Ft,ji]=J.useState(""),[hi,Ii]=J.useState(!1),[Rs]=J.useState([{chapter:1,title:"The Beginning"},{chapter:2,title:"Rising Action"},{chapter:3,title:"Complications"},{chapter:4,title:"The Turning Point"},{chapter:5,title:"Falling Action"},{chapter:6,title:"Resolution"},{chapter:7,title:"Epilogue"}]),[ae,Be]=J.useState(!1),[Ce,Wt]=J.useState(""),[fi,Zn]=J.useState(!1),[fn,pi]=J.useState(null);function Wi({numPages:he}){Te(he),i.lastPage&&i.lastPage<=he&&Ve(i.lastPage)}const Va=he=>{he.target.closest(".selection-toolbar")||he.target.closest(".note-input")||setTimeout(()=>{const Xe=window.getSelection(),st=Xe?Xe.toString().trim():"";if(st.length>0){const ir=Xe.getRangeAt(0).getBoundingClientRect();console.log("Selection detected:",st.substring(0,50)+"..."),U(st),x({text:st,top:ir.bottom+10,left:ir.left+ir.width/2}),q(!1),ge(null)}else X||(x(null),U(""),ge(null))},10)};J.useEffect(()=>{n(i.id,{userNotes:P,userHighlights:N,lastReadDate:Date.now(),currentChapter:b,lastPage:Ke})},[P,N,b,Ke]);const Dr=async he=>{if(f(!0),i.isLocal&&i.fileUrl)f(!1);else{const Xe=await S8(i.title,i.author,he),st=ei(Xe,N);c(st),f(!1)}};J.useEffect(()=>{i.isLocal?(y("complete"),f(!1)):i.content&&i.currentChapter?(y("complete"),c(ei(i.content,N)),A(i.currentChapter||1),f(!1)):(y("complete"),Dr(i.currentChapter||1))},[]);const qa=he=>{y(he),Dr(he==="preview"?1:b)},gi=()=>{const he=b+1;A(he),Dr(he),window.scrollTo(0,0)},kr=()=>{if(b>1){const he=b-1;A(he),Dr(he),window.scrollTo(0,0)}},ei=(he,Xe)=>{let st=he;return Xe.forEach(Zt=>{st.includes(Zt.text)&&(st=st.replace(Zt.text,`<mark style="background-color: ${Zt.color}; color: black; border-radius: 2px; padding: 2px 0;">${Zt.text}</mark>`))}),st},P_=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),o(!1)):(document.documentElement.requestFullscreen(),o(!0))},t0=async()=>{if(Ce.trim()){Zn(!0),pi(null);try{const he=`I'm reading "${i.title}" by ${i.author}. The user wants to go to: "${Ce}". 
      Based on typical book structure, which chapter (1-7) would most likely contain this part of the story?
      Respond with ONLY a JSON object: {"chapter": <number>, "description": "<brief explanation of what happens in that section>"}`,st=(await zE(i.title,he,[])).match(/\{[\s\S]*\}/);if(st){const Zt=JSON.parse(st[0]);pi({chapter:Zt.chapter||1,description:Zt.description||"Found a matching section"})}else pi({chapter:4,description:"Based on your description, this might be in the middle chapters of the book."})}catch(he){console.error("AI Navigation error:",he),pi({chapter:4,description:"I found a section that might match your description."})}Zn(!1)}},L_=()=>{fn&&(A(fn.chapter),Dr(fn.chapter),Be(!1),Wt(""),pi(null))},Td=he=>{he.preventDefault()},wd=he=>{var Xe;if(w&&w.text){const st=w.text,Zt={id:Date.now().toString(),text:st,color:he};I(ir=>[...ir,Zt]),i.isLocal||c(ir=>ir.replace(st,`<mark style="background-color: ${he}; color: inherit; border-radius: 2px; padding: 0 2px;">${st}</mark>`)),x(null),U(""),window.getSelection&&((Xe=window.getSelection())==null||Xe.removeAllRanges())}},xd=async()=>{if(!w||!w.text)return;const he=w.text,{top:Xe,left:st}=w;ge({text:"Translating...",type:"translation",top:Xe,left:st}),x(null),U("");const Zt=await b8(he);ge({text:Zt,type:"translation",top:Xe,left:st})},_o=async()=>{if(!w||!w.text)return;const he=w.text,{top:Xe,left:st}=w;ge({text:"Analyzing context...",type:"explanation",top:Xe,left:st}),x(null),U("");const Zt=await _8(he,i.title);ge({text:Zt,type:"explanation",top:Xe,left:st})},Cd=()=>{!w||!w.text||(window.open(`https://www.google.com/search?q=${encodeURIComponent(w.text)}`,"_blank"),x(null),U(""))},wc=()=>{q(!0)},O_=()=>{if(w&&w.text&&Z){const he={id:Date.now().toString(),text:Z,selectedText:w.text,createdAt:Date.now()};k(Xe=>[...Xe,he]),ee(""),q(!1),x(null),O("notes")}},n0=async he=>{if(he.preventDefault(),!ue.trim())return;const Xe=ue;ye(""),le(Zt=>[...Zt,{role:"user",text:Xe}]),$(!0);const st=await zE(i.title,Xe,se);le(Zt=>[...Zt,{role:"model",text:st}]),$(!1)},Rd=async he=>{O("chat"),$(!0);let Xe="";he==="summarize"?(le(st=>[...st,{role:"user",text:"Summarize this book."}]),Xe=await A8(i.title)):(le(st=>[...st,{role:"user",text:"Where was I? Recap the context."}]),Xe=await E8(i.title)),le(st=>[...st,{role:"model",text:Xe}]),$(!1)},xc=()=>{H(!0)},U_=()=>{H(!1),n(i.id,{isFinished:!0}),_e(!0),t&&t()};return g==="selecting"&&!i.isLocal?E.jsx("div",{className:"fixed inset-0 z-50 bg-[#F5F5F7] flex items-center justify-center p-4",children:E.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-[2rem] p-8 shadow-2xl animate-spring",children:[E.jsxs("div",{className:"text-center mb-8",children:[E.jsx(vB,{size:48,className:"mx-auto text-blue-500 mb-4"}),E.jsx("h2",{className:"text-3xl font-serif font-bold mb-2",children:"How would you like to read?"}),E.jsxs("p",{className:"text-gray-500",children:['Choose your reading experience for "',i.title,'".']})]}),E.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[E.jsxs("button",{onClick:()=>qa("preview"),className:"p-6 rounded-3xl border-2 border-gray-100 hover:border-blue-500 hover:bg-blue-50 transition-all text-left group",children:[E.jsx(IB,{size:24,className:"text-gray-400 group-hover:text-blue-500 mb-4"}),E.jsx("h3",{className:"font-bold text-lg mb-1",children:"Quick Preview"}),E.jsx("p",{className:"text-sm text-gray-500",children:"Read a generated summary and excerpt to see if it's your vibe."})]}),E.jsxs("button",{onClick:()=>qa("complete"),className:"p-6 rounded-3xl border-2 border-black bg-black text-white hover:scale-[1.02] transition-all text-left",children:[E.jsx(Ca,{size:24,className:"text-white mb-4"}),E.jsx("h3",{className:"font-bold text-lg mb-1",children:"Read Complete Book"}),E.jsx("p",{className:"text-sm text-gray-400",children:"Read the full book chapter by chapter with AI generation."})]})]}),E.jsx("button",{onClick:e,className:"mt-8 mx-auto block text-sm font-bold text-gray-400 hover:text-gray-900",children:"Cancel"})]})}):E.jsxs("div",{className:"flex h-screen bg-[#F5F5F7] text-[#1d1d1f] animate-in fade-in duration-300 overflow-hidden font-sans",children:[E.jsxs("div",{className:`flex-1 flex flex-col relative transition-all duration-500 ${L?"mr-96":""}`,children:[E.jsxs("div",{className:"h-16 flex items-center justify-between px-6 bg-white/70 backdrop-blur-xl border-b border-[#d2d2d7]/50 z-20",children:[E.jsx("button",{onClick:e,className:"p-2 hover:bg-black/5 rounded-full transition-colors text-[#1d1d1f]",children:E.jsx(fB,{size:20})}),E.jsxs("div",{className:"text-center",children:[E.jsx("h1",{className:"text-sm font-bold",children:i.title}),E.jsxs("p",{className:"text-xs text-gray-500",children:[i.author,g==="complete"&&!i.isLocal&&E.jsxs("span",{className:"ml-2 bg-gray-100 px-2 py-0.5 rounded-full text-[10px] font-bold tracking-wide",children:["CH ",b]})]})]}),E.jsx("div",{className:"flex gap-2",children:E.jsx("button",{onClick:P_,className:"p-2 hover:bg-gray-100 rounded-full",children:s?E.jsx(ZB,{size:20}):E.jsx(KB,{size:20})})})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-8 md:p-16 relative scroll-smooth",onMouseUp:Va,children:[h?E.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[E.jsx(Ta,{className:"animate-spin text-gray-400"}),E.jsxs("p",{className:"text-sm text-gray-400",children:["Loading ",g==="complete"?`Chapter ${b}`:"Preview","..."]})]}):i.isLocal&&!i.fileUrl?E.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[E.jsx("div",{className:"bg-gray-100 p-6 rounded-full mb-4",children:E.jsx(HI,{size:32,className:"text-gray-400"})}),E.jsx("h3",{className:"text-lg font-bold mb-2",children:"File Content Missing"}),E.jsx("p",{className:"text-gray-500 max-w-sm",children:"This is a local file. For security reasons, the browser does not persist the PDF content after a reload. Please re-upload to read again."})]}):i.isLocal&&i.fileUrl?E.jsxs("div",{className:"w-full h-full rounded-2xl shadow-sm overflow-auto",children:[E.jsx($$,{ref:Je,file:i.fileUrl,onLoadSuccess:Wi,loading:E.jsx("div",{className:"flex items-center justify-center h-full",children:E.jsx(Ta,{className:"animate-spin",size:24})}),error:E.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:"Failed to load PDF"}),children:E.jsx(t7,{pageNumber:Ke,renderTextLayer:!0,renderAnnotationLayer:!1,onMouseUp:Va,className:"shadow-lg"})}),Se&&E.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 p-4 bg-white rounded-2xl shadow-lg border border-gray-100",children:[E.jsx("button",{onClick:()=>Ve(Math.max(1,Ke-1)),disabled:Ke<=1,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50 transition-colors",title:"Previous page",children:E.jsx(BI,{size:20})}),E.jsx("div",{className:"relative",children:Fn?E.jsx("form",{onSubmit:he=>{he.preventDefault();const Xe=parseInt(zt);Xe>=1&&Xe<=Se&&Ve(Xe),at(!1),We("")},children:E.jsx("input",{type:"number",value:zt,onChange:he=>We(he.target.value),placeholder:`1-${Se}`,className:"w-20 px-3 py-1.5 rounded-lg border border-gray-200 text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onBlur:()=>{at(!1),We("")},min:1,max:Se})}):E.jsxs("button",{onClick:()=>at(!0),className:"px-4 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors text-sm font-medium",children:["Page ",Ke," of ",Se]})}),E.jsx("button",{onClick:()=>Ve(Math.min(Se,Ke+1)),disabled:Ke>=Se,className:"p-2 rounded-full hover:bg-gray-100 disabled:opacity-50 transition-colors",title:"Next page",children:E.jsx(Dv,{size:20})}),E.jsxs("div",{className:"border-l border-gray-200 pl-4 flex gap-2",children:[E.jsx("button",{onClick:()=>Ve(1),disabled:Ke===1,className:"px-2 py-1 text-xs font-medium text-gray-500 hover:text-gray-900 hover:bg-gray-100 rounded disabled:opacity-50",title:"Go to first page",children:"First"}),E.jsx("button",{onClick:()=>Ve(Se),disabled:Ke===Se,className:"px-2 py-1 text-xs font-medium text-gray-500 hover:text-gray-900 hover:bg-gray-100 rounded disabled:opacity-50",title:"Go to last page",children:"Last"})]})]})]}):E.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-12 shadow-sm rounded-[2px] min-h-full leading-loose text-lg text-gray-800 selection:bg-blue-100 selection:text-blue-900 pb-32",children:[E.jsx("div",{dangerouslySetInnerHTML:{__html:l}}),g==="complete"&&E.jsx("div",{className:"mt-16 pt-8 border-t border-gray-100",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("button",{onClick:kr,disabled:b<=1,className:"flex items-center gap-2 px-6 py-3 rounded-full text-sm font-bold text-gray-500 hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent",children:[E.jsx(BI,{size:16})," Previous"]}),E.jsx("div",{className:"flex items-center gap-3",children:mt?E.jsx("form",{onSubmit:he=>{he.preventDefault();const Xe=parseInt(Ft);Xe>=1&&(A(Xe),Dr(Xe)),Vt(!1),ji("")},children:E.jsx("input",{type:"number",value:Ft,onChange:he=>ji(he.target.value),placeholder:"Chapter #",className:"w-24 px-3 py-2 rounded-lg border border-gray-200 text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,onBlur:()=>{Vt(!1),ji("")},min:1})}):E.jsxs("button",{onClick:()=>Vt(!0),className:"px-4 py-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors text-sm font-medium",children:["Chapter ",b]})}),E.jsxs("button",{onClick:gi,className:"flex items-center gap-2 px-8 py-3 bg-black text-white rounded-full text-sm font-bold hover:scale-105 transition-transform",children:["Next Chapter ",E.jsx(Dv,{size:16})]})]})}),g==="preview"&&E.jsx("div",{className:"mt-8 pt-8 border-t border-gray-100 text-center text-xs text-gray-400 italic",children:'This is an AI-generated preview. Switch to "Complete Book" mode to read more.'})]}),w&&F&&!X&&E.jsxs("div",{className:"selection-toolbar fixed z-[100] bg-[#1d1d1f] text-white rounded-[12px] shadow-[0_4px_24px_rgba(0,0,0,0.16)] flex items-center gap-0.5 p-1 animate-in zoom-in-95 duration-200 font-sans",style:{top:Math.max(10,w.top),left:Math.max(10,Math.min(window.innerWidth-320,w.left-160)),transform:"translateX(0)"},onMouseDown:Td,children:[E.jsxs("button",{onClick:()=>wd("#fef08a"),className:"p-3 hover:bg-white/20 rounded-xl flex items-center gap-2 text-sm",title:"Highlight",children:[E.jsx(HB,{size:18,className:"text-yellow-300"}),E.jsx("span",{className:"hidden sm:inline",children:"Highlight"})]}),E.jsx("div",{className:"w-px h-6 bg-white/20"}),E.jsx("button",{onClick:wc,className:"p-3 hover:bg-white/20 rounded-xl flex items-center gap-2 text-sm",title:"Add Note",children:E.jsx(eE,{size:18,className:"text-pink-300"})}),E.jsx("div",{className:"w-px h-6 bg-white/20"}),E.jsx("button",{onClick:xd,className:"p-3 hover:bg-white/20 rounded-xl flex items-center gap-2 text-sm",title:"Translate",children:E.jsx(OB,{size:18,className:"text-blue-300"})}),E.jsx("div",{className:"w-px h-6 bg-white/20"}),E.jsx("button",{onClick:_o,className:"p-3 hover:bg-white/20 rounded-xl flex items-center gap-2 text-sm",title:"Explain",children:E.jsx(Ca,{size:18,className:"text-green-300"})}),E.jsx("div",{className:"w-px h-6 bg-white/20"}),E.jsx("button",{onClick:Cd,className:"p-3 hover:bg-white/20 rounded-xl",title:"Search Google",children:E.jsx(wE,{size:18,className:"text-gray-300"})})]}),X&&F&&E.jsxs("div",{className:"fixed z-50 bg-white rounded-2xl shadow-2xl p-4 w-72 animate-in zoom-in-95 duration-200 border border-gray-100",style:{top:w.top-120,left:w.left-144},onMouseDown:he=>he.stopPropagation(),children:[E.jsx("textarea",{className:"w-full bg-yellow-50 p-3 rounded-xl text-sm mb-2 focus:outline-none focus:ring-2 focus:ring-yellow-200",placeholder:"Add your note here...",rows:3,value:Z,onChange:he=>ee(he.target.value),autoFocus:!0}),E.jsxs("div",{className:"flex justify-end gap-2",children:[E.jsx("button",{onClick:()=>q(!1),className:"text-xs font-bold text-gray-400 px-3 py-1.5 hover:bg-gray-100 rounded-lg",children:"Cancel"}),E.jsx("button",{onClick:O_,className:"text-xs font-bold bg-black text-white px-3 py-1.5 rounded-lg",children:"Save Note"})]})]}),oe&&E.jsxs("div",{style:{top:oe.top,left:oe.left},className:"fixed z-[100] bg-white text-[#1d1d1f] rounded-[14px] shadow-[0_12px_32px_rgba(0,0,0,0.12)] p-4 w-72 animate-in zoom-in-95 border border-[#d2d2d7]/50 ring-1 ring-black/5",children:[E.jsxs("div",{className:"flex justify-between items-start mb-2",children:[E.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-[#0071e3]",children:oe.type==="translation"?"Translation":"Context"}),E.jsx("button",{onClick:()=>ge(null),children:E.jsx(yl,{size:14,className:"text-[#86868b] hover:text-[#1d1d1f]"})})]}),E.jsx("p",{className:"text-[#1d1d1f] leading-relaxed font-serif text-[15px]",children:oe.text})]})]}),E.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-xl border border-white/40 shadow-[0_8px_32px_rgba(0,0,0,0.12)] rounded-full px-4 py-2 flex items-center gap-4 z-30 transition-transform scale-95 origin-bottom hover:scale-100",children:[!i.isLocal&&E.jsxs(E.Fragment,{children:[E.jsxs("button",{onClick:()=>Ii(!hi),className:`flex items-center gap-1.5 text-xs font-medium ${hi?"text-[#0071e3]":"text-[#86868b]"} hover:text-[#1d1d1f] transition-colors`,title:"Table of Contents",children:[E.jsx(GI,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Contents"})]}),E.jsx("div",{className:"w-px h-4 bg-[#d2d2d7]"}),E.jsxs("button",{onClick:()=>Be(!ae),className:`flex items-center gap-1.5 text-xs font-medium ${ae?"text-[#0071e3]":"text-[#86868b]"} hover:text-[#1d1d1f] transition-colors`,title:"AI Go-To",children:[E.jsx(VI,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Go To..."})]}),E.jsx("div",{className:"w-px h-4 bg-[#d2d2d7]"})]}),E.jsxs("button",{onClick:()=>O(L==="chat"?null:"chat"),className:`flex items-center gap-1.5 text-xs font-medium ${L==="chat"?"text-[#0071e3]":"text-[#86868b]"} hover:text-[#1d1d1f] transition-colors`,children:[E.jsx(zI,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Companion"})]}),E.jsx("div",{className:"w-px h-4 bg-[#d2d2d7]"}),E.jsxs("button",{onClick:()=>O(L==="notes"?null:"notes"),className:`flex items-center gap-1.5 text-xs font-medium ${L==="notes"?"text-[#0071e3]":"text-[#86868b]"} hover:text-[#1d1d1f] transition-colors`,children:[E.jsx(TE,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Notes"})," (",P.length,")"]}),E.jsx("div",{className:"w-px h-4 bg-[#d2d2d7]"}),E.jsxs("button",{onClick:xc,className:"flex items-center gap-1.5 text-xs font-medium text-[#86868b] hover:text-[#1d1d1f]",children:[E.jsx(CB,{size:16}),E.jsx("span",{className:"hidden sm:inline",children:"Finish"})]})]}),hi&&!i.isLocal&&E.jsxs("div",{className:"absolute bottom-24 left-8 bg-white rounded-2xl shadow-2xl border border-gray-100 w-80 max-h-96 overflow-hidden z-40 animate-in slide-in-from-bottom-4",children:[E.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[E.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[E.jsx(GI,{size:18})," Table of Contents"]}),E.jsx("button",{onClick:()=>Ii(!1),children:E.jsx(yl,{size:18,className:"text-gray-400 hover:text-gray-900"})})]}),E.jsx("div",{className:"overflow-y-auto max-h-72",children:Rs.map(he=>E.jsxs("button",{onClick:()=>{A(he.chapter),Dr(he.chapter),Ii(!1)},className:`w-full text-left p-4 hover:bg-blue-50 border-b border-gray-50 transition-colors ${b===he.chapter?"bg-blue-50 border-l-4 border-l-blue-500":""}`,children:[E.jsxs("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:["Chapter ",he.chapter]}),E.jsx("p",{className:"font-medium text-gray-800",children:he.title})]},he.chapter))})]}),ae&&!i.isLocal&&E.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 animate-in fade-in",children:E.jsxs("div",{className:"bg-white rounded-[20px] shadow-[0_40px_80px_rgba(0,0,0,0.12)] w-full max-w-md mx-4 overflow-hidden animate-in zoom-in-95 scale-100 ring-1 ring-black/5",children:[E.jsxs("div",{className:"p-5 border-b border-[#F5F5F7] bg-white sticky top-0",children:[E.jsxs("div",{className:"flex justify-between items-center",children:[E.jsxs("h3",{className:"text-lg font-bold text-[#1d1d1f] flex items-center gap-2 tracking-tight",children:[E.jsx(VI,{size:20,className:"text-[#0071e3]"})," AI Go-To"]}),E.jsx("button",{onClick:()=>{Be(!1),pi(null),Wt("")},className:"bg-[#F5F5F7] p-1.5 rounded-full hover:bg-[#E5E5EA] transition-colors",children:E.jsx(yl,{size:16,className:"text-[#86868b]"})})]}),E.jsx("p",{className:"text-[#86868b] text-[13px] mt-1.5",children:"Describe a scene, quote, or moment to jump there."})]}),E.jsxs("div",{className:"p-5 bg-[#F5F5F7]/50",children:[E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{type:"text",value:Ce,onChange:he=>Wt(he.target.value),onKeyDown:he=>he.key==="Enter"&&t0(),placeholder:'e.g., "where they find the treasure"',className:"flex-1 px-3 py-2.5 rounded-[10px] border border-[#d2d2d7] bg-white focus:outline-none focus:border-[#0071e3] focus:ring-4 focus:ring-[#0071e3]/10 text-[#1d1d1f] placeholder-[#86868b] shadow-sm transition-all text-sm",autoFocus:!0}),E.jsx("button",{onClick:t0,disabled:fi||!Ce.trim(),className:"px-5 py-2.5 bg-[#0071e3] text-white rounded-[10px] text-sm font-medium hover:bg-[#0077ED] disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-sm active:scale-95",children:fi?E.jsx(Ta,{size:16,className:"animate-spin"}):"Find"})]}),fn&&E.jsxs("div",{className:"mt-6 p-5 bg-white rounded-2xl border border-[#d2d2d7]/50 shadow-sm animate-in slide-in-from-bottom-2",children:[E.jsx("p",{className:"text-xs text-[#0066CC] font-bold mb-2 uppercase tracking-wide",children:"Result Found"}),E.jsx("p",{className:"text-[#1d1d1f] mb-5 font-serif text-lg leading-relaxed",children:fn.description}),E.jsxs("button",{onClick:L_,className:"w-full py-3.5 bg-[#F5F5F7] text-[#0066CC] rounded-xl font-semibold hover:bg-[#E5E5EA] transition-colors flex items-center justify-center gap-2 group",children:["Jump to Chapter ",fn.chapter," ",E.jsx(Dv,{size:18,className:"group-hover:translate-x-1 transition-transform"})]})]}),E.jsxs("div",{className:"mt-8",children:[E.jsx("p",{className:"text-xs text-[#86868b] font-semibold uppercase tracking-wider mb-3",children:"Suggestions"}),E.jsx("div",{className:"flex flex-wrap gap-2",children:["the beginning","the climax","the ending","a plot twist"].map(he=>E.jsx("button",{onClick:()=>{Wt(he)},className:"px-3 py-1.5 bg-white border border-[#d2d2d7] text-[#1d1d1f] rounded-full text-sm font-medium hover:border-[#0066CC] hover:text-[#0066CC] transition-colors shadow-sm",children:he},he))})]})]})]})})]}),E.jsxs("div",{className:`fixed top-0 right-0 bottom-0 w-96 bg-white border-l border-gray-200 shadow-2xl transform transition-transform duration-500 z-40 ${L?"translate-x-0":"translate-x-full"}`,children:[L==="chat"&&E.jsxs("div",{className:"flex flex-col h-full",children:[E.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[E.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[E.jsx(Es,{size:18,className:"text-blue-500"})," Reading Companion"]}),E.jsx("button",{onClick:()=>O(null),children:E.jsx(yl,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),E.jsxs("div",{className:"p-4 flex gap-2 overflow-x-auto border-b border-gray-50",children:[E.jsxs("button",{onClick:()=>Rd("summarize"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-full text-xs font-bold hover:bg-blue-100 whitespace-nowrap",children:[E.jsx(HI,{size:12})," Summarize"]}),E.jsxs("button",{onClick:()=>Rd("recap"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-purple-50 text-purple-600 rounded-full text-xs font-bold hover:bg-purple-100 whitespace-nowrap",children:[E.jsx(d3,{size:12})," Where was I?"]})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-white",children:[se.length===0&&E.jsxs("div",{className:"text-center mt-10 text-gray-400",children:[E.jsx(zI,{size:32,className:"mx-auto mb-2 opacity-20"}),E.jsx("p",{className:"text-sm",children:"Ask anything about the book."})]}),se.map((he,Xe)=>E.jsx("div",{className:`p-3 rounded-xl text-sm leading-relaxed shadow-sm ${he.role==="user"?"bg-black text-white ml-8 rounded-br-none":"bg-gray-100 text-gray-800 mr-8 rounded-bl-none"}`,children:he.text},Xe)),G&&E.jsx("div",{className:"p-3 bg-gray-50 rounded-xl w-12",children:E.jsx(Ta,{size:16,className:"animate-spin text-gray-400"})})]}),E.jsx("form",{onSubmit:n0,className:"p-4 bg-white border-t border-gray-100",children:E.jsxs("div",{className:"relative",children:[E.jsx("input",{value:ue,onChange:he=>ye(he.target.value),placeholder:"Ask about the plot...",className:"w-full bg-gray-100 rounded-full px-4 py-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow"}),E.jsx("button",{type:"submit",className:"absolute right-2 top-2 p-1.5 bg-blue-500 text-white rounded-full hover:scale-105 transition-transform",children:E.jsx(Iw,{size:14})})]})})]}),L==="notes"&&E.jsxs("div",{className:"flex flex-col h-full",children:[E.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[E.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[E.jsx(eE,{size:18,className:"text-pink-500"})," My Notes"]}),E.jsx("button",{onClick:()=>O(null),children:E.jsx(yl,{size:20,className:"text-gray-400 hover:text-gray-900"})})]}),E.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:P.length===0?E.jsxs("div",{className:"text-center mt-20 opacity-50",children:[E.jsx(TE,{size:48,className:"mx-auto mb-4 text-gray-300"}),E.jsx("p",{className:"text-gray-500 font-medium",children:"No notes yet."}),E.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Select text to add a note."})]}):P.map(he=>E.jsxs("div",{className:"bg-yellow-50 p-4 rounded-2xl border border-yellow-100/50 shadow-sm",children:[E.jsxs("div",{className:"text-xs font-bold text-yellow-600/70 uppercase tracking-wider mb-2 flex items-center gap-1",children:[E.jsx(eE,{size:10})," Note"]}),E.jsxs("p",{className:"text-gray-900 font-medium text-sm mb-3 font-serif",children:['"',he.text,'"']}),he.selectedText&&E.jsx("div",{className:"pl-3 border-l-2 border-yellow-200",children:E.jsxs("p",{className:"text-xs text-gray-500 italic line-clamp-2",children:['Re: "',he.selectedText,'"']})}),E.jsx("p",{className:"text-[10px] text-right text-gray-400 mt-2",children:new Date(he.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},he.id))})]})]}),Me&&E.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4 animate-in fade-in",children:E.jsxs("div",{className:"bg-white rounded-[2rem] w-full max-w-lg p-8 shadow-2xl animate-spring",children:[E.jsx("h2",{className:"text-3xl font-serif font-bold text-center mb-2",children:"Congratulations!"}),E.jsxs("p",{className:"text-center text-gray-500 mb-8",children:["You've finished ",i.title,"."]}),E.jsxs("div",{className:"mb-6",children:[E.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-gray-400 mb-2",children:"Leave a note for the author"}),E.jsx("textarea",{className:"w-full bg-gray-50 rounded-2xl p-4 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-100 h-32 resize-none",placeholder:"Your thoughts meant the world...",value:K,onChange:he=>re(he.target.value)})]}),E.jsxs("button",{onClick:U_,className:"w-full bg-black text-white py-4 rounded-xl font-bold text-lg hover:scale-[1.02] transition-transform flex items-center justify-center gap-2",children:["Send & Claim Reward ",E.jsx(PB,{size:18})]})]})}),de&&E.jsxs("div",{className:"fixed inset-0 z-[70] flex flex-col items-center justify-center bg-black/90 text-white animate-in fade-in duration-500",children:[E.jsxs("div",{className:"relative mb-8 animate-[spin_10s_linear_infinite]",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-yellow-400 to-purple-500 blur-3xl opacity-50 rounded-full"}),E.jsx("div",{className:"relative w-64 h-80 bg-gray-800 rounded-xl overflow-hidden border-2 border-yellow-500/50 shadow-[0_0_50px_rgba(234,179,8,0.3)]",children:E.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{backgroundColor:i.coverColor},children:E.jsx(Ca,{size:64,className:"text-white/50"})})})]}),E.jsx("h1",{className:"text-4xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:"NFT Minted!"}),E.jsx("p",{className:"text-gray-400 mb-8",children:"You earned 50 Suitcase Tokens (SCT)"}),E.jsx("button",{onClick:()=>{_e(!1),e()},className:"px-8 py-3 bg-white text-black rounded-full font-bold hover:bg-gray-200 transition-colors",children:"Add to Wallet"})]})]})},i7=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],s7=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],r7=({onComplete:i})=>{const[e,t]=J.useState(1),[n,s]=J.useState([]),[o,l]=J.useState(""),[c,h]=J.useState(""),f=y=>{n.includes(y)?s(b=>b.filter(A=>A!==y)):n.length<3&&s(b=>[...b,y])},g=()=>{e===1&&c.trim()?t(2):e===2&&n.length>0?t(3):e===3&&o&&i({name:c,genres:n,readingGoal:o,onboardingComplete:!0,joinDate:Date.now()})};return E.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-[#F5F5F7]",children:E.jsxs("div",{className:"max-w-xl w-full p-8 animate-spring",children:[E.jsxs("div",{className:"flex justify-center gap-2 mb-12",children:[E.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=1?"bg-black":"bg-gray-200"}`}),E.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=2?"bg-black":"bg-gray-200"}`}),E.jsx("div",{className:`h-1 w-12 rounded-full transition-colors ${e>=3?"bg-black":"bg-gray-200"}`})]}),E.jsxs("div",{className:"text-center mb-10",children:[E.jsx("div",{className:"inline-block p-4 bg-white rounded-[2rem] shadow-lg mb-6 rotate-3",children:E.jsx(Es,{size:32,className:"text-blue-500"})}),E.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-4",children:e===1?"Welcome Traveler":e===2?"What do you like to read?":"Why are you reading?"}),E.jsx("p",{className:"text-gray-500 text-lg",children:e===1?"What should we call you?":e===2?"Pick up to 3 genres.":"Help us curate your perfect suitcase."})]}),E.jsxs("div",{className:"min-h-[200px]",children:[e===1&&E.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:E.jsx("input",{value:c,onChange:y=>h(y.target.value),className:"w-full text-center text-3xl font-bold border-b-2 border-gray-200 focus:border-black bg-transparent outline-none py-2",placeholder:"Enter your name",autoFocus:!0})}),e===2&&E.jsx("div",{className:"flex flex-wrap justify-center gap-3 animate-in fade-in slide-in-from-bottom-4",children:i7.map(y=>E.jsx("button",{onClick:()=>f(y),className:`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${n.includes(y)?"bg-black text-white shadow-lg scale-105":"bg-white text-gray-500 hover:bg-gray-100"}`,children:y},y))}),e===3&&E.jsx("div",{className:"grid gap-4 animate-in fade-in slide-in-from-bottom-4",children:s7.map(y=>E.jsxs("button",{onClick:()=>l(y.label),className:`flex items-center gap-4 p-5 rounded-[2rem] text-left transition-all duration-300 border-2 ${o===y.label?"border-blue-500 bg-blue-50 shadow-lg":"border-transparent bg-white hover:bg-gray-50"}`,children:[E.jsx("span",{className:"text-3xl",children:y.icon}),E.jsx("span",{className:`text-xl font-bold ${o===y.label?"text-blue-900":"text-gray-700"}`,children:y.label}),o===y.label&&E.jsx(EE,{className:"ml-auto text-blue-500"})]},y.id))})]}),E.jsx("div",{className:"flex justify-center mt-8",children:E.jsxs("button",{onClick:g,disabled:e===1?!c.trim():e===2?n.length===0:!o,className:"group flex items-center gap-2 bg-black text-white px-8 py-4 rounded-full font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:scale-105 active:scale-95",children:[e===3?"Finish Setup":"Next",E.jsx(Rw,{className:"group-hover:translate-x-1 transition-transform"})]})})]})})},o7=["Sci-Fi","Mystery","Romance","History","Fantasy","Business","Philosophy","Thriller"],oD=[{id:"relax",label:"Relax & Escape",icon:""},{id:"learn",label:"Learn & Grow",icon:""},{id:"adventure",label:"Adventure",icon:""}],a7=({userPrefs:i,wallet:e,library:t,onClose:n,onUpdateProfile:s,onReset:o})=>{var L;const[l,c]=J.useState(!1),[h,f]=J.useState(i.name||"Traveler"),[g,y]=J.useState(i.readingGoal),[b,A]=J.useState(i.genres),w=t.filter(O=>O.isFinished).length,x=t.reduce((O,F)=>{var U;return O+(((U=F.userNotes)==null?void 0:U.length)||0)},0),N=t.filter(O=>e.nfts.includes(O.id)),I=()=>{s({...i,name:h,readingGoal:g,genres:b}),c(!1)},P=()=>{f(i.name||"Traveler"),y(i.readingGoal),A(i.genres),c(!1)},k=O=>{b.includes(O)?A(F=>F.filter(U=>U!==O)):b.length<5&&A(F=>[...F,O])};return E.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-300 max-w-4xl mx-auto mt-8 mb-24",children:[E.jsx("div",{className:"flex justify-end mb-4",children:l?E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:P,className:"px-4 py-2 bg-white text-gray-500 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm",children:"Cancel"}),E.jsxs("button",{onClick:I,className:"px-4 py-2 bg-black text-white rounded-full font-bold shadow-lg hover:bg-gray-800 text-sm flex items-center gap-2",children:[E.jsx(EE,{size:14})," Save Changes"]})]}):E.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-white text-gray-900 rounded-full font-bold shadow-sm hover:bg-gray-50 text-sm flex items-center gap-2",children:[E.jsx(i3,{size:14})," Edit Profile"]})}),E.jsxs("div",{className:"bg-white rounded-[2.5rem] p-8 shadow-sm mb-8 relative overflow-hidden",children:[E.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-bl from-blue-100 to-purple-100 rounded-bl-[10rem] -z-0 opacity-50 pointer-events-none"}),E.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 relative z-10",children:[E.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-tr from-gray-900 to-gray-700 shadow-2xl flex items-center justify-center text-4xl font-serif font-bold text-white border-4 border-white",children:h.charAt(0).toUpperCase()}),E.jsxs("div",{className:"text-center md:text-left flex-1 w-full",children:[l?E.jsxs("div",{className:"flex flex-col gap-2 mb-2 w-full max-w-md",children:[E.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider",children:"Display Name"}),E.jsx("input",{value:h,onChange:O=>f(O.target.value),className:"text-2xl font-serif font-bold text-gray-900 bg-gray-50 rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500 w-full"})]}):E.jsx("h1",{className:"text-4xl font-serif font-bold text-gray-900 mb-2",children:h}),E.jsx("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 text-sm text-gray-500 font-medium",children:E.jsxs("span",{className:"flex items-center gap-1.5",children:[E.jsx(JD,{size:14})," Joined ",new Date(i.joinDate).toLocaleDateString()]})})]}),E.jsxs("div",{className:"bg-gray-900 text-white p-6 rounded-3xl shadow-xl min-w-[200px] text-center md:text-right relative overflow-hidden group",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/20 to-purple-500/20 group-hover:opacity-100 transition-opacity opacity-0"}),E.jsxs("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 flex items-center justify-end gap-2",children:["Balance ",E.jsx(A3,{size:12})]}),E.jsxs("div",{className:"text-3xl font-mono font-bold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:[e.balance," SCT"]})]})]})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[E.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[E.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[E.jsx(Es,{size:14})," Current Focus"]}),l?E.jsx("div",{className:"grid gap-2",children:oD.map(O=>E.jsxs("button",{onClick:()=>y(O.label),className:`flex items-center gap-3 p-3 rounded-xl border text-left transition-colors ${g===O.label?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-100 hover:bg-gray-50"}`,children:[E.jsx("span",{className:"text-xl",children:O.icon}),E.jsx("span",{className:"font-bold text-sm",children:O.label}),g===O.label&&E.jsx(EE,{size:16,className:"ml-auto text-blue-600"})]},O.id))}):E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("span",{className:"text-3xl",children:((L=oD.find(O=>O.label===g))==null?void 0:L.icon)||""}),E.jsx("span",{className:"text-xl font-bold text-gray-900",children:g})]})]}),E.jsxs("div",{className:`bg-white p-6 rounded-3xl shadow-sm border border-gray-100 ${l?"ring-2 ring-blue-500/20":""}`,children:[E.jsxs("h3",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider mb-4 flex items-center gap-2",children:[E.jsx(Ca,{size:14})," Favorite Genres"]}),E.jsx("div",{className:"flex flex-wrap gap-2",children:l?o7.map(O=>E.jsx("button",{onClick:()=>k(O),className:`px-3 py-1.5 rounded-full text-sm font-bold transition-colors ${b.includes(O)?"bg-black text-white":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:O},O)):b.map(O=>E.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm font-bold",children:O},O))})]})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-50 flex items-center justify-center text-blue-600",children:E.jsx(Ca,{size:24})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w}),E.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Books Finished"})]})]}),E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 rounded-2xl bg-purple-50 flex items-center justify-center text-purple-600",children:E.jsx(TE,{size:24})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x}),E.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"Notes Taken"})]})]}),E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4",children:[E.jsx("div",{className:"w-12 h-12 rounded-2xl bg-yellow-50 flex items-center justify-center text-yellow-600",children:E.jsx(FI,{size:24})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.nfts.length}),E.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wide",children:"NFTs Collected"})]})]})]}),E.jsxs("div",{className:"mb-12",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-6 px-2",children:[E.jsx(Es,{className:"text-yellow-500",size:20}),E.jsx("h2",{className:"text-2xl font-serif font-bold text-gray-900",children:"Your Collection (NFTs)"})]}),N.length===0?E.jsxs("div",{className:"bg-white rounded-[2rem] p-12 text-center border-2 border-dashed border-gray-200",children:[E.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300",children:E.jsx(FI,{size:32})}),E.jsx("h3",{className:"text-gray-900 font-bold mb-1",children:"No Digital Collectibles Yet"}),E.jsx("p",{className:"text-gray-500 text-sm",children:"Finish books to mint their covers as NFTs."})]}):E.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:N.map(O=>E.jsxs("div",{className:"group relative aspect-[2/3] rounded-2xl overflow-hidden shadow-lg transition-transform hover:scale-105",children:[E.jsx("div",{className:"absolute inset-0",style:{backgroundColor:O.coverColor}}),O.isbn&&E.jsx("img",{src:`https://covers.openlibrary.org/b/isbn/${O.isbn}-L.jpg`,className:"absolute inset-0 w-full h-full object-cover",alt:O.title}),E.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-4",children:[E.jsx("p",{className:"text-white font-bold text-sm line-clamp-2",children:O.title}),E.jsx("div",{className:"flex items-center gap-1 mt-1",children:E.jsx("span",{className:"text-[10px] font-bold bg-yellow-400 text-black px-1.5 rounded",children:"NFT"})})]})]},O.id))})]}),E.jsx("div",{className:"flex justify-center",children:E.jsxs("button",{onClick:o,className:"text-red-500 text-sm font-bold flex items-center gap-2 hover:bg-red-50 px-6 py-3 rounded-full transition-colors",children:[E.jsx(WB,{size:16})," Reset Profile & Data"]})})]})},l7=()=>{};var aD={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yL=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},c7=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=i[t++];e[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=i[t++],l=i[t++],c=i[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=i[t++],l=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},vL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const o=i[s],l=s+1<i.length,c=l?i[s+1]:0,h=s+2<i.length,f=h?i[s+2]:0,g=o>>2,y=(o&3)<<4|c>>4;let b=(c&15)<<2|f>>6,A=f&63;h||(A=64,l||(b=64)),n.push(t[g],t[y],t[b],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(yL(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):c7(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const o=t[i.charAt(s++)],c=s<i.length?t[i.charAt(s)]:0;++s;const f=s<i.length?t[i.charAt(s)]:64;++s;const y=s<i.length?t[i.charAt(s)]:64;if(++s,o==null||c==null||f==null||y==null)throw new u7;const b=o<<2|c>>4;if(n.push(b),f!==64){const A=c<<4&240|f>>2;if(n.push(A),y!==64){const w=f<<6&192|y;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class u7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const d7=function(i){const e=yL(i);return vL.encodeByteArray(e,!0)},bL=function(i){return d7(i).replace(/\./g,"")},_L=function(i){try{return vL.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7=()=>h7().__FIREBASE_DEFAULTS__,p7=()=>{if(typeof process>"u"||typeof aD>"u")return;const i=aD.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},g7=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&_L(i[1]);return e&&JSON.parse(e)},hx=()=>{try{return l7()||f7()||p7()||g7()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},m7=i=>{var e,t;return(t=(e=hx())==null?void 0:e.emulatorHosts)==null?void 0:t[i]},SL=()=>{var i;return(i=hx())==null?void 0:i.config},AL=i=>{var e;return(e=hx())==null?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v7(i){return(await fetch(i,{credentials:"include"})).ok}const jg={};function b7(){const i={prod:[],emulator:[]};for(const e of Object.keys(jg))jg[e]?i.emulator.push(e):i.prod.push(e);return i}function _7(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let lD=!1;function S7(i,e){if(typeof window>"u"||typeof document>"u"||!R_(window.location.host)||jg[i]===e||jg[i]||lD)return;jg[i]=e;function t(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=b7().prod.length>0;function l(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,A){b.setAttribute("width","24"),b.setAttribute("id",A),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{lD=!0,l()},b}function g(b,A){b.setAttribute("id",A),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function y(){const b=_7(n),A=t("text"),w=document.getElementById(A)||document.createElement("span"),x=t("learnmore"),N=document.getElementById(x)||document.createElement("a"),I=t("preprendIcon"),P=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const k=b.element;c(k),g(N,x);const L=f();h(P,I),k.append(P,w,N,L),document.body.appendChild(k)}o?(w.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function A7(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ri())}function E7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function EL(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function T7(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function w7(){const i=Ri();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function TL(){try{return typeof indexedDB=="object"}catch{return!1}}function wL(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}function x7(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C7="FirebaseError";class bo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=C7,Object.setPrototypeOf(this,bo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ad.prototype.create)}}class Ad{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?R7(o,n):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new bo(s,c,n)}}function R7(i,e){return i.replace(I7,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const I7=/\{\$([^}]+)}/g;function N7(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function pd(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const o=i[s],l=e[s];if(cD(o)&&cD(l)){if(!pd(o,l))return!1}else if(o!==l)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function cD(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(i){const e=[];for(const[t,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Vg(i){const e={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,o]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function qg(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function M7(i,e){const t=new D7(i,e);return t.subscribe.bind(t)}class D7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");k7(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=fE),s.error===void 0&&(s.error=fE),s.complete===void 0&&(s.complete=fE);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function k7(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function fE(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P7=1e3,L7=2,O7=14400*1e3,U7=.5;function uD(i,e=P7,t=L7){const n=e*Math.pow(t,i),s=Math.round(U7*n*(Math.random()-.5)*2);return Math.min(O7,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(i){return i&&i._delegate?i._delegate:i}class mo{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new y7;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H7(e))try{this.getOrInitializeService({instanceIdentifier:Xc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(e=Xc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xc){return this.instances.has(e)}getOptions(e=Xc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&l.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&e(o,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:B7(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Xc){return this.component?this.component.multipleInstances?e:Xc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function B7(i){return i===Xc?void 0:i}function H7(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new F7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(kt||(kt={}));const z7={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},V7=kt.INFO,q7={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},$7=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=q7[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fx{constructor(e){this.name=e,this._logLevel=V7,this._logHandler=$7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?z7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}const Y7=(i,e)=>e.some(t=>i instanceof t);let dD,hD;function j7(){return dD||(dD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W7(){return hD||(hD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xL=new WeakMap,gw=new WeakMap,CL=new WeakMap,pE=new WeakMap,px=new WeakMap;function X7(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",o),i.removeEventListener("error",l)},o=()=>{t(mc(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",o),i.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&xL.set(t,i)}).catch(()=>{}),px.set(e,i),e}function K7(i){if(gw.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",l),i.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",o),i.addEventListener("error",l),i.addEventListener("abort",l)});gw.set(i,e)}let mw={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return gw.get(i);if(e==="objectStoreNames")return i.objectStoreNames||CL.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return mc(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function J7(i){mw=i(mw)}function Q7(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(gE(this),e,...t);return CL.set(n,e.sort?e.sort():[e]),mc(n)}:W7().includes(i)?function(...e){return i.apply(gE(this),e),mc(xL.get(this))}:function(...e){return mc(i.apply(gE(this),e))}}function Z7(i){return typeof i=="function"?Q7(i):(i instanceof IDBTransaction&&K7(i),Y7(i,j7())?new Proxy(i,mw):i)}function mc(i){if(i instanceof IDBRequest)return X7(i);if(pE.has(i))return pE.get(i);const e=Z7(i);return e!==i&&(pE.set(i,e),px.set(e,i)),e}const gE=i=>px.get(i);function RL(i,e,{blocked:t,upgrade:n,blocking:s,terminated:o}={}){const l=indexedDB.open(i,e),c=mc(l);return n&&l.addEventListener("upgradeneeded",h=>{n(mc(l.result),h.oldVersion,h.newVersion,mc(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const e9=["get","getKey","getAll","getAllKeys","count"],t9=["put","add","delete","clear"],mE=new Map;function fD(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(mE.get(e))return mE.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=t9.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||e9.includes(t)))return;const o=async function(l,...c){const h=this.transaction(l,s?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),s&&h.done]))[0]};return mE.set(e,o),o}J7(i=>({...i,get:(e,t,n)=>fD(e,t)||i.get(e,t,n),has:(e,t)=>!!fD(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(i9(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function i9(i){const e=i.getComponent();return(e==null?void 0:e.type)==="VERSION"}const yw="@firebase/app",pD="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new fx("@firebase/app"),s9="@firebase/app-compat",r9="@firebase/analytics-compat",o9="@firebase/analytics",a9="@firebase/app-check-compat",l9="@firebase/app-check",c9="@firebase/auth",u9="@firebase/auth-compat",d9="@firebase/database",h9="@firebase/data-connect",f9="@firebase/database-compat",p9="@firebase/functions",g9="@firebase/functions-compat",m9="@firebase/installations",y9="@firebase/installations-compat",v9="@firebase/messaging",b9="@firebase/messaging-compat",_9="@firebase/performance",S9="@firebase/performance-compat",A9="@firebase/remote-config",E9="@firebase/remote-config-compat",T9="@firebase/storage",w9="@firebase/storage-compat",x9="@firebase/firestore",C9="@firebase/ai",R9="@firebase/firestore-compat",I9="firebase",N9="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="[DEFAULT]",M9={[yw]:"fire-core",[s9]:"fire-core-compat",[o9]:"fire-analytics",[r9]:"fire-analytics-compat",[l9]:"fire-app-check",[a9]:"fire-app-check-compat",[c9]:"fire-auth",[u9]:"fire-auth-compat",[d9]:"fire-rtdb",[h9]:"fire-data-connect",[f9]:"fire-rtdb-compat",[p9]:"fire-fn",[g9]:"fire-fn-compat",[m9]:"fire-iid",[y9]:"fire-iid-compat",[v9]:"fire-fcm",[b9]:"fire-fcm-compat",[_9]:"fire-perf",[S9]:"fire-perf-compat",[A9]:"fire-rc",[E9]:"fire-rc-compat",[T9]:"fire-gcs",[w9]:"fire-gcs-compat",[x9]:"fire-fst",[R9]:"fire-fst-compat",[C9]:"fire-vertex","fire-js":"fire-js",[I9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=new Map,D9=new Map,bw=new Map;function gD(i,e){try{i.container.addComponent(e)}catch(t){La.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Oa(i){const e=i.name;if(bw.has(e))return La.debug(`There were multiple attempts to register component ${e}.`),!1;bw.set(e,i);for(const t of Ub.values())gD(t,i);for(const t of D9.values())gD(t,i);return!0}function Ap(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Sr(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yc=new Ad("app","Firebase",k9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new mo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=N9;function IL(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:vw,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw yc.create("bad-app-name",{appName:String(s)});if(t||(t=SL()),!t)throw yc.create("no-options");const o=Ub.get(s);if(o){if(pd(t,o.options)&&pd(n,o.config))return o;throw yc.create("duplicate-app",{appName:s})}const l=new G7(s);for(const h of bw.values())l.addComponent(h);const c=new P9(t,n,l);return Ub.set(s,c),c}function NL(i=vw){const e=Ub.get(i);if(!e&&i===vw&&SL())return IL();if(!e)throw yc.create("no-app",{appName:i});return e}function fo(i,e,t){let n=M9[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${n}" with version "${e}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),La.warn(l.join(" "));return}Oa(new mo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L9="firebase-heartbeat-database",O9=1,sm="firebase-heartbeat-store";let yE=null;function ML(){return yE||(yE=RL(L9,O9,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(sm)}catch(t){console.warn(t)}}}}).catch(i=>{throw yc.create("idb-open",{originalErrorMessage:i.message})})),yE}async function U9(i){try{const t=(await ML()).transaction(sm),n=await t.objectStore(sm).get(DL(i));return await t.done,n}catch(e){if(e instanceof bo)La.warn(e.message);else{const t=yc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});La.warn(t.message)}}}async function mD(i,e){try{const n=(await ML()).transaction(sm,"readwrite");await n.objectStore(sm).put(e,DL(i)),await n.done}catch(t){if(t instanceof bo)La.warn(t.message);else{const n=yc.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});La.warn(n.message)}}}function DL(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F9=1024,B9=30;class H9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new z9(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=yD();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>B9){const l=V9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){La.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=yD(),{heartbeatsToSend:n,unsentEntries:s}=G9(this._heartbeatsCache.heartbeats),o=bL(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return La.warn(t),""}}}function yD(){return new Date().toISOString().substring(0,10)}function G9(i,e=F9){const t=[];let n=i.slice();for(const s of i){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),vD(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),vD(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class z9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TL()?wL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await U9(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return mD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return mD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function vD(i){return bL(JSON.stringify({version:2,heartbeats:i})).length}function V9(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q9(i){Oa(new mo("platform-logger",e=>new n9(e),"PRIVATE")),Oa(new mo("heartbeat",e=>new H9(e),"PRIVATE")),fo(yw,pD,i),fo(yw,pD,"esm2020"),fo("fire-js","")}q9("");function kL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $9=kL,PL=new Ad("auth","Firebase",kL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=new fx("@firebase/auth");function Y9(i,...e){Fb.logLevel<=kt.WARN&&Fb.warn(`Auth (${Ky}): ${i}`,...e)}function fb(i,...e){Fb.logLevel<=kt.ERROR&&Fb.error(`Auth (${Ky}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(i,...e){throw gx(i,...e)}function po(i,...e){return gx(i,...e)}function LL(i,e,t){const n={...$9(),[e]:t};return new Ad("auth","Firebase",n).create(e,{appName:i.name})}function Ra(i){return LL(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gx(i,...e){if(typeof i!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(t,...n)}return PL.create(i,...e)}function De(i,e,...t){if(!i)throw gx(e,...t)}function wa(i){const e="INTERNAL ASSERTION FAILED: "+i;throw fb(e),new Error(e)}function Ua(i,e){i||wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.href)||""}function j9(){return bD()==="http:"||bD()==="https:"}function bD(){var i;return typeof self<"u"&&((i=self.location)==null?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(j9()||EL()||"connection"in navigator)?navigator.onLine:!0}function X9(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ua(t>e,"Short delay should be less than long delay!"),this.isMobile=A7()||T7()}get(){return W9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(i,e){Ua(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OL{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Q9=new Jy(3e4,6e4);function Tc(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function za(i,e,t,n,s={}){return UL(i,s,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const c=Xy({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const f={method:e,headers:h,...o};return E7()||(f.referrerPolicy="no-referrer"),i.emulatorConfig&&R_(i.emulatorConfig.host)&&(f.credentials="include"),OL.fetch()(await FL(i,i.config.apiHost,t,c),f)})}async function UL(i,e,t){i._canInitEmulator=!1;const n={...K9,...e};try{const s=new eY(i),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Mv(i,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[h,f]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mv(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Mv(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw Mv(i,"user-disabled",l);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw LL(i,g,f);Cr(i,g)}}catch(s){if(s instanceof bo)throw s;Cr(i,"network-request-failed",{message:String(s)})}}async function Qy(i,e,t,n,s={}){const o=await za(i,e,t,n,s);return"mfaPendingCredential"in o&&Cr(i,"multi-factor-auth-required",{_serverResponse:o}),o}async function FL(i,e,t,n){const s=`${e}${t}?${n}`,o=i,l=o.config.emulator?mx(i.config,s):`${i.config.apiScheme}://${s}`;return J9.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function Z9(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eY{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(po(this.auth,"network-request-failed")),Q9.get())})}}function Mv(i,e,t){const n={appName:i.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=po(i,e,n);return s.customData._tokenResponse=t,s}function _D(i){return i!==void 0&&i.enterprise!==void 0}class tY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Z9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function nY(i,e){return za(i,"GET","/v2/recaptchaConfig",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iY(i,e){return za(i,"POST","/v1/accounts:delete",e)}async function Bb(i,e){return za(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sY(i,e=!1){const t=Cs(i),n=await t.getIdToken(e),s=yx(n);De(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:n,authTime:Wg(vE(s.auth_time)),issuedAtTime:Wg(vE(s.iat)),expirationTime:Wg(vE(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function vE(i){return Number(i)*1e3}function yx(i){const[e,t,n]=i.split(".");if(e===void 0||t===void 0||n===void 0)return fb("JWT malformed, contained fewer than 3 sections"),null;try{const s=_L(t);return s?JSON.parse(s):(fb("Failed to decode base64 JWT payload"),null)}catch(s){return fb("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function SD(i){const e=yx(i);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mp(i,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof bo&&rY(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function rY({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wg(this.lastLoginAt),this.creationTime=Wg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hb(i){var y;const e=i.auth,t=await i.getIdToken(),n=await mp(i,Bb(e,{idToken:t}));De(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const o=(y=s.providerUserInfo)!=null&&y.length?BL(s.providerUserInfo):[],l=lY(i.providerData,o),c=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!(l!=null&&l.length),f=c?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Sw(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(i,g)}async function aY(i){const e=Cs(i);await Hb(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lY(i,e){return[...i.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function BL(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cY(i,e){const t=await UL(i,{},async()=>{const n=Xy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=i.config,l=await FL(i,s,"/v1/token",`key=${o}`),c=await i._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return i.emulatorConfig&&R_(i.emulatorConfig.host)&&(h.credentials="include"),OL.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function uY(i,e){return za(i,"POST","/v2/accounts:revokeToken",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):SD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=SD(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:o}=await cY(e,t);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:o}=t,l=new Oh;return n&&(De(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),s&&(De(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(De(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oh,this.toJSON())}_performRefresh(){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(i,e){De(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Ar{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new oY(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Sw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await mp(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sY(this,e)}reload(){return aY(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Hb(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Sr(this.auth.app))return Promise.reject(Ra(this.auth));const e=await this.getIdToken();return await mp(this,iY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:y,emailVerified:b,isAnonymous:A,providerData:w,stsTokenManager:x}=t;De(y&&x,e,"internal-error");const N=Oh.fromJSON(this.name,x);De(typeof y=="string",e,"internal-error"),gl(n,e.name),gl(s,e.name),De(typeof b=="boolean",e,"internal-error"),De(typeof A=="boolean",e,"internal-error"),gl(o,e.name),gl(l,e.name),gl(c,e.name),gl(h,e.name),gl(f,e.name),gl(g,e.name);const I=new Ar({uid:y,auth:e,email:s,emailVerified:b,displayName:n,isAnonymous:A,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:N,createdAt:f,lastLoginAt:g});return w&&Array.isArray(w)&&(I.providerData=w.map(P=>({...P}))),h&&(I._redirectEventId=h),I}static async _fromIdTokenResponse(e,t,n=!1){const s=new Oh;s.updateFromServerResponse(t);const o=new Ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Hb(o),o}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];De(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?BL(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),c=new Oh;c.updateFromIdToken(n);const h=new Ar({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Sw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new Map;function xa(i){Ua(i instanceof Function,"Expected a class definition");let e=AD.get(i);return e?(Ua(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,AD.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}HL.type="NONE";const ED=HL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(i,e,t){return`firebase:${i}:${e}:${t}`}class Uh{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=pb(this.userKey,s.apiKey,o),this.fullPersistenceKey=pb("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Bb(this.auth,{idToken:e}).catch(()=>{});return t?Ar._fromGetAccountInfoResponse(this.auth,t,e):null}return Ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Uh(xa(ED),e,n);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||xa(ED);const l=pb(n,e.config.apiKey,e.name);let c=null;for(const f of t)try{const g=await f._get(l);if(g){let y;if(typeof g=="string"){const b=await Bb(e,{idToken:g}).catch(()=>{});if(!b)break;y=await Ar._fromGetAccountInfoResponse(e,b,g)}else y=Ar._fromJSON(e,g);f!==o&&(c=y),o=f;break}}catch{}const h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Uh(o,e,n):(o=h[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new Uh(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(GL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YL(e))return"Blackberry";if(jL(e))return"Webos";if(zL(e))return"Safari";if((e.includes("chrome/")||VL(e))&&!e.includes("edge/"))return"Chrome";if($L(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function GL(i=Ri()){return/firefox\//i.test(i)}function zL(i=Ri()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VL(i=Ri()){return/crios\//i.test(i)}function qL(i=Ri()){return/iemobile/i.test(i)}function $L(i=Ri()){return/android/i.test(i)}function YL(i=Ri()){return/blackberry/i.test(i)}function jL(i=Ri()){return/webos/i.test(i)}function vx(i=Ri()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function dY(i=Ri()){var e;return vx(i)&&!!((e=window.navigator)!=null&&e.standalone)}function hY(){return w7()&&document.documentMode===10}function WL(i=Ri()){return vx(i)||$L(i)||jL(i)||YL(i)||/windows phone/i.test(i)||qL(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XL(i,e=[]){let t;switch(i){case"Browser":t=TD(Ri());break;case"Worker":t=`${TD(Ri())}-${i}`;break;default:t=i}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ky}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((l,c)=>{try{const h=e(o);l(h)}catch(h){c(h)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pY(i,e={}){return za(i,"GET","/v2/passwordPolicy",Tc(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY=6;class mY{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??gY,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yY{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new wD(this),this.idTokenSubscription=new wD(this),this.beforeStateQueue=new fY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xa(t)),this._initializationPromise=this.queue(async()=>{var n,s,o;if(!this._deleted&&(this.persistenceManager=await Uh.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Bb(this,{idToken:e}),n=await Ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(Sr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,c=n==null?void 0:n._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&(h!=null&&h.user)&&(n=h.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hb(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=X9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Sr(this.app))return Promise.reject(Ra(this));const t=e?Cs(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Sr(this.app)?Promise.reject(Ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Sr(this.app)?Promise.reject(Ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await pY(this),t=new mY(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ad("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await uY(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xa(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Uh.create(this,[xa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=XL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Y9(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ed(i){return Cs(i)}class wD{constructor(e){this.auth=e,this.observer=null,this.addObserver=M7(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vY(i){I_=i}function KL(i){return I_.loadJS(i)}function bY(){return I_.recaptchaEnterpriseScript}function _Y(){return I_.gapiScript}function SY(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class AY{constructor(){this.enterprise=new EY}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class EY{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const TY="recaptcha-enterprise",JL="NO_RECAPTCHA";class wY{constructor(e){this.type=TY,this.auth=Ed(e)}async verify(e="verify",t=!1){async function n(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,c)=>{nY(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const f=new tY(h);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(h=>{c(h)})})}function s(o,l,c){const h=window.grecaptcha;_D(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(f=>{l(f)}).catch(()=>{l(JL)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AY().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(c=>{if(!t&&_D(window.grecaptcha))s(c,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=bY();h.length!==0&&(h+=c),KL(h).then(()=>{s(c,o,l)}).catch(f=>{l(f)})}}).catch(c=>{l(c)})})}}async function xD(i,e,t,n=!1,s=!1){const o=new wY(i);let l;if(s)l=JL;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const h=c.phoneEnrollmentInfo.phoneNumber,f=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const h=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:l}):Object.assign(c,{captchaResponse:l}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Aw(i,e,t,n,s){var o;if((o=i._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await xD(i,e,t,t==="getOobCode");return n(i,l)}else return n(i,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await xD(i,e,t,t==="getOobCode");return n(i,c)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xY(i,e){const t=Ap(i,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(pd(o,e??{}))return s;Cr(s,"already-initialized")}return t.initialize({options:e})}function CY(i,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(xa);e!=null&&e.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function RY(i,e,t){const n=Ed(i);De(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,o=QL(e),{host:l,port:c}=IY(e),h=c===null?"":`:${c}`,f={url:`${o}//${l}${h}/`},g=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){De(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),De(pd(f,n.config.emulator)&&pd(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,R_(l)?(v7(`${o}//${l}${h}`),S7("Auth",!0)):NY()}function QL(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function IY(i){const e=QL(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:CD(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:CD(l)}}}function CD(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function NY(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return wa("not implemented")}_getIdTokenResponse(e){return wa("not implemented")}_linkToIdToken(e,t){return wa("not implemented")}_getReauthenticationResolver(e){return wa("not implemented")}}async function MY(i,e){return za(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DY(i,e){return Qy(i,"POST","/v1/accounts:signInWithPassword",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kY(i,e){return Qy(i,"POST","/v1/accounts:signInWithEmailLink",Tc(i,e))}async function PY(i,e){return Qy(i,"POST","/v1/accounts:signInWithEmailLink",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm extends bx{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new rm(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new rm(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Aw(e,t,"signInWithPassword",DY);case"emailLink":return kY(e,{email:this._email,oobCode:this._password});default:Cr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Aw(e,n,"signUpPassword",MY);case"emailLink":return PY(e,{idToken:t,email:this._email,oobCode:this._password});default:Cr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(i,e){return Qy(i,"POST","/v1/accounts:signInWithIdp",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY="http://localhost";class gd extends bx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Cr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...o}=t;if(!n||!s)return null;const l=new gd(n,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Fh(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Fh(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fh(e,t)}buildRequest(){const e={requestUri:LY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xy(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OY(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function UY(i){const e=Vg(qg(i)).link,t=e?Vg(qg(e)).deep_link_id:null,n=Vg(qg(i)).deep_link_id;return(n?Vg(qg(n)).link:null)||n||t||e||i}class _x{constructor(e){const t=Vg(qg(e)),n=t.apiKey??null,s=t.oobCode??null,o=OY(t.mode??null);De(n&&s&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=UY(e);try{return new _x(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(){this.providerId=Ep.PROVIDER_ID}static credential(e,t){return rm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=_x.parseLink(t);return De(n,"argument-error"),rm._fromEmailAndCode(e,n.code,n.tenantId)}}Ep.PROVIDER_ID="password";Ep.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ep.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy extends ZL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl extends Zy{constructor(){super("facebook.com")}static credential(e){return gd._fromParams({providerId:vl.PROVIDER_ID,signInMethod:vl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vl.credentialFromTaggedObject(e)}static credentialFromError(e){return vl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vl.credential(e.oauthAccessToken)}catch{return null}}}vl.FACEBOOK_SIGN_IN_METHOD="facebook.com";vl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends Zy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gd._fromParams({providerId:bl.PROVIDER_ID,signInMethod:bl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return bl.credentialFromTaggedObject(e)}static credentialFromError(e){return bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return bl.credential(t,n)}catch{return null}}}bl.GOOGLE_SIGN_IN_METHOD="google.com";bl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Zy{constructor(){super("github.com")}static credential(e){return gd._fromParams({providerId:_l.PROVIDER_ID,signInMethod:_l.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _l.credentialFromTaggedObject(e)}static credentialFromError(e){return _l.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _l.credential(e.oauthAccessToken)}catch{return null}}}_l.GITHUB_SIGN_IN_METHOD="github.com";_l.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl extends Zy{constructor(){super("twitter.com")}static credential(e,t){return gd._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Sl.credential(t,n)}catch{return null}}}Sl.TWITTER_SIGN_IN_METHOD="twitter.com";Sl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FY(i,e){return Qy(i,"POST","/v1/accounts:signUp",Tc(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const o=await Ar._fromIdTokenResponse(e,n,s),l=RD(n);return new md({user:o,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=RD(n);return new md({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function RD(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb extends bo{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Gb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Gb(e,t,n,s)}}function eO(i,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Gb._fromErrorAndOperation(i,o,e,n):o})}async function BY(i,e,t=!1){const n=await mp(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return md._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HY(i,e,t=!1){const{auth:n}=i;if(Sr(n.app))return Promise.reject(Ra(n));const s="reauthenticate";try{const o=await mp(i,eO(n,s,e,i),t);De(o.idToken,n,"internal-error");const l=yx(o.idToken);De(l,n,"internal-error");const{sub:c}=l;return De(i.uid===c,n,"user-mismatch"),md._forOperation(i,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Cr(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(i,e,t=!1){if(Sr(i.app))return Promise.reject(Ra(i));const n="signIn",s=await eO(i,n,e),o=await md._fromIdTokenResponse(i,n,s);return t||await i._updateCurrentUser(o.user),o}async function GY(i,e){return tO(Ed(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(i){const e=Ed(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function zY(i,e,t){if(Sr(i.app))return Promise.reject(Ra(i));const n=Ed(i),l=await Aw(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FY).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&nO(i),h}),c=await md._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(c.user),c}function VY(i,e,t){return Sr(i.app)?Promise.reject(Ra(i)):GY(Cs(i),Ep.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&nO(i),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qY(i,e){return za(i,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $Y(i,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const n=Cs(i),o={idToken:await n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await mp(n,qY(n.auth,o));n.displayName=l.displayName||null,n.photoURL=l.photoUrl||null;const c=n.providerData.find(({providerId:h})=>h==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(l)}function YY(i,e,t,n){return Cs(i).onIdTokenChanged(e,t,n)}function jY(i,e,t){return Cs(i).beforeAuthStateChanged(e,t)}function WY(i,e,t,n){return Cs(i).onAuthStateChanged(e,t,n)}function XY(i){return Cs(i).signOut()}const zb="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zb,"1"),this.storage.removeItem(zb),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KY=1e3,JY=10;class sO extends iO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=WL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);hY()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,JY):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},KY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}sO.type="LOCAL";const QY=sO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO extends iO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}rO.type="SESSION";const oO=rO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZY(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new N_(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(l).map(async f=>f(t.origin,o)),h=await ZY(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}N_.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(i="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((c,h)=>{const f=Sx("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(y){const b=y;if(b.data.eventId===f)switch(b.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(){return window}function tj(i){go().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aO(){return typeof go().WorkerGlobalScope<"u"&&typeof go().importScripts=="function"}async function nj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ij(){var i;return((i=navigator==null?void 0:navigator.serviceWorker)==null?void 0:i.controller)||null}function sj(){return aO()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO="firebaseLocalStorageDb",rj=1,Vb="firebaseLocalStorage",cO="fbase_key";class e0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function M_(i,e){return i.transaction([Vb],e?"readwrite":"readonly").objectStore(Vb)}function oj(){const i=indexedDB.deleteDatabase(lO);return new e0(i).toPromise()}function Ew(){const i=indexedDB.open(lO,rj);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Vb,{keyPath:cO})}catch(s){t(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Vb)?e(n):(n.close(),await oj(),e(await Ew()))})})}async function ID(i,e,t){const n=M_(i,!0).put({[cO]:e,value:t});return new e0(n).toPromise()}async function aj(i,e){const t=M_(i,!1).get(e),n=await new e0(t).toPromise();return n===void 0?null:n.value}function ND(i,e){const t=M_(i,!0).delete(e);return new e0(t).toPromise()}const lj=800,cj=3;class uO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ew(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>cj)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return aO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=N_._getInstance(sj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await nj(),!this.activeServiceWorker)return;this.sender=new ej(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ij()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ew();return await ID(e,zb,"1"),await ND(e,zb),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ID(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>aj(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ND(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=M_(s,!1).getAll();return new e0(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uO.type="LOCAL";const uj=uO;new Jy(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(i,e){return e?xa(e):(De(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax extends bx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fh(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fh(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fh(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function hj(i){return tO(i.auth,new Ax(i),i.bypassAuthState)}function fj(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),HY(t,new Ax(i),i.bypassAuthState)}async function pj(i){const{auth:e,user:t}=i;return De(t,e,"internal-error"),BY(t,new Ax(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,t,n,s,o=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hj;case"linkViaPopup":case"linkViaRedirect":return pj;case"reauthViaPopup":case"reauthViaRedirect":return fj;default:Cr(this.auth,"internal-error")}}resolve(e){Ua(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ua(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj=new Jy(2e3,1e4);class xh extends dO{constructor(e,t,n,s,o){super(e,t,s,o),this.provider=n,this.authWindow=null,this.pollId=null,xh.currentPopupAction&&xh.currentPopupAction.cancel(),xh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Ua(this.filter.length===1,"Popup operations only handle one event");const e=Sx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(po(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(po(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(po(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gj.get())};e()}}xh.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="pendingRedirect",gb=new Map;class yj extends dO{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=gb.get(this.auth._key());if(!e){try{const n=await vj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}gb.set(this.auth._key(),e)}return this.bypassAuthState||gb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vj(i,e){const t=Sj(e),n=_j(i);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function bj(i,e){gb.set(i._key(),e)}function _j(i){return xa(i._redirectPersistence)}function Sj(i){return pb(mj,i.config.apiKey,i.name)}async function Aj(i,e,t=!1){if(Sr(i.app))return Promise.reject(Ra(i));const n=Ed(i),s=dj(n,e),l=await new yj(n,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej=600*1e3;class Tj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!hO(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(po(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ej&&this.cachedEventUids.clear(),this.cachedEventUids.has(MD(e))}saveEventToCache(e){this.cachedEventUids.add(MD(e)),this.lastProcessedEventTime=Date.now()}}function MD(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function hO({type:i,error:e}){return i==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wj(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hO(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xj(i,e={}){return za(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Rj=/^https?/;async function Ij(i){if(i.config.emulator)return;const{authorizedDomains:e}=await xj(i);for(const t of e)try{if(Nj(t))return}catch{}Cr(i,"unauthorized-domain")}function Nj(i){const e=_w(),{protocol:t,hostname:n}=new URL(e);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!Rj.test(t))return!1;if(Cj.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=new Jy(3e4,6e4);function DD(){const i=go().___jsl;if(i!=null&&i.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function Dj(i){return new Promise((e,t)=>{var s,o,l;function n(){DD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DD(),t(po(i,"network-request-failed"))},timeout:Mj.get()})}if((o=(s=go().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=go().gapi)!=null&&l.load)n();else{const c=SY("iframefcb");return go()[c]=()=>{gapi.load?n():t(po(i,"network-request-failed"))},KL(`${_Y()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw mb=null,e})}let mb=null;function kj(i){return mb=mb||Dj(i),mb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj=new Jy(5e3,15e3),Lj="__/auth/iframe",Oj="emulator/auth/iframe",Uj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Fj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bj(i){const e=i.config;De(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?mx(e,Oj):`https://${i.config.authDomain}/${Lj}`,n={apiKey:e.apiKey,appName:i.name,v:Ky},s=Fj.get(i.config.apiHost);s&&(n.eid=s);const o=i._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Xy(n).slice(1)}`}async function Hj(i){const e=await kj(i),t=go().gapi;return De(t,i,"internal-error"),e.open({where:document.body,url:Bj(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Uj,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const l=po(i,"network-request-failed"),c=go().setTimeout(()=>{o(l)},Pj.get());function h(){go().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zj=500,Vj=600,qj="_blank",$j="http://localhost";class kD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Yj(i,e,t,n=zj,s=Vj){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...Gj,width:n.toString(),height:s.toString(),top:o,left:l},f=Ri().toLowerCase();t&&(c=VL(f)?qj:t),GL(f)&&(e=e||$j,h.scrollbars="yes");const g=Object.entries(h).reduce((b,[A,w])=>`${b}${A}=${w},`,"");if(dY(f)&&c!=="_self")return jj(e||"",c),new kD(null);const y=window.open(e||"",c,g);De(y,i,"popup-blocked");try{y.focus()}catch{}return new kD(y)}function jj(i,e){const t=document.createElement("a");t.href=i,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj="__/auth/handler",Xj="emulator/auth/handler",Kj=encodeURIComponent("fac");async function PD(i,e,t,n,s,o){De(i.config.authDomain,i,"auth-domain-config-required"),De(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:n,v:Ky,eventId:s};if(e instanceof ZL){e.setDefaultLanguage(i.languageCode),l.providerId=e.providerId||"",N7(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries({}))l[g]=y}if(e instanceof Zy){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(l.scopes=g.join(","))}i.tenantId&&(l.tid=i.tenantId);const c=l;for(const g of Object.keys(c))c[g]===void 0&&delete c[g];const h=await i._getAppCheckToken(),f=h?`#${Kj}=${encodeURIComponent(h)}`:"";return`${Jj(i)}?${Xy(c).slice(1)}${f}`}function Jj({config:i}){return i.emulator?mx(i,Xj):`https://${i.authDomain}/${Wj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE="webStorageSupport";class Qj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=oO,this._completeRedirectFn=Aj,this._overrideRedirectResult=bj}async _openPopup(e,t,n,s){var l;Ua((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await PD(e,t,n,_w(),s);return Yj(e,o,Sx())}async _openRedirect(e,t,n,s){await this._originValidation(e);const o=await PD(e,t,n,_w(),s);return tj(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Ua(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Hj(e),n=new Tj(e);return t.register("authEvent",s=>(De(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(bE,{type:bE},s=>{var l;const o=(l=s==null?void 0:s[0])==null?void 0:l[bE];o!==void 0&&t(!!o),Cr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ij(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return WL()||zL()||vx()}}const Zj=Qj;var LD="@firebase/auth",OD="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nW(i){Oa(new mo("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;De(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:XL(i)},f=new yY(n,s,o,h);return CY(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Oa(new mo("auth-internal",e=>{const t=Ed(e.getProvider("auth").getImmediate());return(n=>new eW(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fo(LD,OD,tW(i)),fo(LD,OD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iW=300,sW=AL("authIdTokenMaxAge")||iW;let UD=null;const rW=i=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>sW)return;const s=t==null?void 0:t.token;UD!==s&&(UD=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function oW(i=NL()){const e=Ap(i,"auth");if(e.isInitialized())return e.getImmediate();const t=xY(i,{popupRedirectResolver:Zj,persistence:[uj,QY,oO]}),n=AL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=rW(o.toString());jY(t,l,()=>l(t.currentUser)),YY(t,c=>l(c))}}const s=m7("auth");return s&&RY(t,`http://${s}`),t}function aW(){var i;return((i=document.getElementsByTagName("head"))==null?void 0:i[0])??document}vY({loadJS(i){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=e,n.onerror=s=>{const o=po("internal-error");o.customData=s,t(o)},n.type="text/javascript",n.charset="UTF-8",aW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nW("Browser");var lW="firebase",cW="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fo(lW,cW,"app");const fO="@firebase/installations",Ex="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=1e4,gO=`w:${Ex}`,mO="FIS_v2",uW="https://firebaseinstallations.googleapis.com/v1",dW=3600*1e3,hW="installations",fW="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},yd=new Ad(hW,fW,pW);function yO(i){return i instanceof bo&&i.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO({projectId:i}){return`${uW}/projects/${i}/installations`}function bO(i){return{token:i.token,requestStatus:2,expiresIn:mW(i.expiresIn),creationTime:Date.now()}}async function _O(i,e){const n=(await e.json()).error;return yd.create("request-failed",{requestName:i,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function SO({apiKey:i}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":i})}function gW(i,{refreshToken:e}){const t=SO(i);return t.append("Authorization",yW(e)),t}async function AO(i){const e=await i();return e.status>=500&&e.status<600?i():e}function mW(i){return Number(i.replace("s","000"))}function yW(i){return`${mO} ${i}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vW({appConfig:i,heartbeatServiceProvider:e},{fid:t}){const n=vO(i),s=SO(i),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={fid:t,authVersion:mO,appId:i.appId,sdkVersion:gO},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await AO(()=>fetch(n,c));if(h.ok){const f=await h.json();return{fid:f.fid||t,registrationStatus:2,refreshToken:f.refreshToken,authToken:bO(f.authToken)}}else throw await _O("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(i){return new Promise(e=>{setTimeout(e,i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bW(i){return btoa(String.fromCharCode(...i)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W=/^[cdef][\w-]{21}$/,Tw="";function SW(){try{const i=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(i),i[0]=112+i[0]%16;const t=AW(i);return _W.test(t)?t:Tw}catch{return Tw}}function AW(i){return bW(i).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(i){return`${i.appName}!${i.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=new Map;function wO(i,e){const t=D_(i);xO(t,e),EW(t,e)}function xO(i,e){const t=TO.get(i);if(t)for(const n of t)n(e)}function EW(i,e){const t=TW();t&&t.postMessage({key:i,fid:e}),wW()}let Zc=null;function TW(){return!Zc&&"BroadcastChannel"in self&&(Zc=new BroadcastChannel("[Firebase] FID Change"),Zc.onmessage=i=>{xO(i.data.key,i.data.fid)}),Zc}function wW(){TO.size===0&&Zc&&(Zc.close(),Zc=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xW="firebase-installations-database",CW=1,vd="firebase-installations-store";let _E=null;function Tx(){return _E||(_E=RL(xW,CW,{upgrade:(i,e)=>{switch(e){case 0:i.createObjectStore(vd)}}})),_E}async function qb(i,e){const t=D_(i),s=(await Tx()).transaction(vd,"readwrite"),o=s.objectStore(vd),l=await o.get(t);return await o.put(e,t),await s.done,(!l||l.fid!==e.fid)&&wO(i,e.fid),e}async function CO(i){const e=D_(i),n=(await Tx()).transaction(vd,"readwrite");await n.objectStore(vd).delete(e),await n.done}async function k_(i,e){const t=D_(i),s=(await Tx()).transaction(vd,"readwrite"),o=s.objectStore(vd),l=await o.get(t),c=e(l);return c===void 0?await o.delete(t):await o.put(c,t),await s.done,c&&(!l||l.fid!==c.fid)&&wO(i,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wx(i){let e;const t=await k_(i.appConfig,n=>{const s=RW(n),o=IW(i,s);return e=o.registrationPromise,o.installationEntry});return t.fid===Tw?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function RW(i){const e=i||{fid:SW(),registrationStatus:0};return RO(e)}function IW(i,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(yd.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=NW(i,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:MW(i)}:{installationEntry:e}}async function NW(i,e){try{const t=await vW(i,e);return qb(i.appConfig,t)}catch(t){throw yO(t)&&t.customData.serverCode===409?await CO(i.appConfig):await qb(i.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function MW(i){let e=await FD(i.appConfig);for(;e.registrationStatus===1;)await EO(100),e=await FD(i.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await wx(i);return n||t}return e}function FD(i){return k_(i,e=>{if(!e)throw yd.create("installation-not-found");return RO(e)})}function RO(i){return DW(i)?{fid:i.fid,registrationStatus:0}:i}function DW(i){return i.registrationStatus===1&&i.registrationTime+pO<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kW({appConfig:i,heartbeatServiceProvider:e},t){const n=PW(i,t),s=gW(i,t),o=e.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&s.append("x-firebase-client",f)}const l={installation:{sdkVersion:gO,appId:i.appId}},c={method:"POST",headers:s,body:JSON.stringify(l)},h=await AO(()=>fetch(n,c));if(h.ok){const f=await h.json();return bO(f)}else throw await _O("Generate Auth Token",h)}function PW(i,{fid:e}){return`${vO(i)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xx(i,e=!1){let t;const n=await k_(i.appConfig,o=>{if(!IO(o))throw yd.create("not-registered");const l=o.authToken;if(!e&&UW(l))return o;if(l.requestStatus===1)return t=LW(i,e),o;{if(!navigator.onLine)throw yd.create("app-offline");const c=BW(o);return t=OW(i,c),c}});return t?await t:n.authToken}async function LW(i,e){let t=await BD(i.appConfig);for(;t.authToken.requestStatus===1;)await EO(100),t=await BD(i.appConfig);const n=t.authToken;return n.requestStatus===0?xx(i,e):n}function BD(i){return k_(i,e=>{if(!IO(e))throw yd.create("not-registered");const t=e.authToken;return HW(t)?{...e,authToken:{requestStatus:0}}:e})}async function OW(i,e){try{const t=await kW(i,e),n={...e,authToken:t};return await qb(i.appConfig,n),t}catch(t){if(yO(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await CO(i.appConfig);else{const n={...e,authToken:{requestStatus:0}};await qb(i.appConfig,n)}throw t}}function IO(i){return i!==void 0&&i.registrationStatus===2}function UW(i){return i.requestStatus===2&&!FW(i)}function FW(i){const e=Date.now();return e<i.creationTime||i.creationTime+i.expiresIn<e+dW}function BW(i){const e={requestStatus:1,requestTime:Date.now()};return{...i,authToken:e}}function HW(i){return i.requestStatus===1&&i.requestTime+pO<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GW(i){const e=i,{installationEntry:t,registrationPromise:n}=await wx(e);return n?n.catch(console.error):xx(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zW(i,e=!1){const t=i;return await VW(t),(await xx(t,e)).token}async function VW(i){const{registrationPromise:e}=await wx(i);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qW(i){if(!i||!i.options)throw SE("App Configuration");if(!i.name)throw SE("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!i.options[t])throw SE(t);return{appName:i.name,projectId:i.options.projectId,apiKey:i.options.apiKey,appId:i.options.appId}}function SE(i){return yd.create("missing-app-config-values",{valueName:i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO="installations",$W="installations-internal",YW=i=>{const e=i.getProvider("app").getImmediate(),t=qW(e),n=Ap(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},jW=i=>{const e=i.getProvider("app").getImmediate(),t=Ap(e,NO).getImmediate();return{getId:()=>GW(t),getToken:s=>zW(t,s)}};function WW(){Oa(new mo(NO,YW,"PUBLIC")),Oa(new mo($W,jW,"PRIVATE"))}WW();fo(fO,Ex);fo(fO,Ex,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b="analytics",XW="firebase_id",KW="origin",JW=60*1e3,QW="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Cx="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi=new fx("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZW={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Ts=new Ad("analytics","Analytics",ZW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eX(i){if(!i.startsWith(Cx)){const e=Ts.create("invalid-gtag-resource",{gtagURL:i});return wi.warn(e.message),""}return i}function MO(i){return Promise.all(i.map(e=>e.catch(t=>t)))}function tX(i,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(i,e)),t}function nX(i,e){const t=tX("firebase-js-sdk-policy",{createScriptURL:eX}),n=document.createElement("script"),s=`${Cx}?l=${i}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function iX(i){let e=[];return Array.isArray(window[i])?e=window[i]:window[i]=e,e}async function sX(i,e,t,n,s,o){const l=n[s];try{if(l)await e[l];else{const h=(await MO(t)).find(f=>f.measurementId===s);h&&await e[h.appId]}}catch(c){wi.error(c)}i("config",s,o)}async function rX(i,e,t,n,s){try{let o=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const c=await MO(t);for(const h of l){const f=c.find(y=>y.measurementId===h),g=f&&e[f.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),i("event",n,s||{})}catch(o){wi.error(o)}}function oX(i,e,t,n){async function s(o,...l){try{if(o==="event"){const[c,h]=l;await rX(i,e,t,c,h)}else if(o==="config"){const[c,h]=l;await sX(i,e,t,n,c,h)}else if(o==="consent"){const[c,h]=l;i("consent",c,h)}else if(o==="get"){const[c,h,f]=l;i("get",c,h,f)}else if(o==="set"){const[c]=l;i("set",c)}else i(o,...l)}catch(c){wi.error(c)}}return s}function aX(i,e,t,n,s){let o=function(...l){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=oX(o,i,e,t),{gtagCore:o,wrappedGtag:window[s]}}function lX(i){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Cx)&&t.src.includes(i))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX=30,uX=1e3;class dX{constructor(e={},t=uX){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const DO=new dX;function hX(i){return new Headers({Accept:"application/json","x-goog-api-key":i})}async function fX(i){var l;const{appId:e,apiKey:t}=i,n={method:"GET",headers:hX(t)},s=QW.replace("{app-id}",e),o=await fetch(s,n);if(o.status!==200&&o.status!==304){let c="";try{const h=await o.json();(l=h.error)!=null&&l.message&&(c=h.error.message)}catch{}throw Ts.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}async function pX(i,e=DO,t){const{appId:n,apiKey:s,measurementId:o}=i.options;if(!n)throw Ts.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:n};throw Ts.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new yX;return setTimeout(async()=>{c.abort()},JW),kO({appId:n,apiKey:s,measurementId:o},l,c,e)}async function kO(i,{throttleEndTimeMillis:e,backoffCount:t},n,s=DO){var c;const{appId:o,measurementId:l}=i;try{await gX(n,e)}catch(h){if(l)return wi.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:l};throw h}try{const h=await fX(i);return s.deleteThrottleMetadata(o),h}catch(h){const f=h;if(!mX(f)){if(s.deleteThrottleMetadata(o),l)return wi.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:o,measurementId:l};throw h}const g=Number((c=f==null?void 0:f.customData)==null?void 0:c.httpStatus)===503?uD(t,s.intervalMillis,cX):uD(t,s.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return s.setThrottleMetadata(o,y),wi.debug(`Calling attemptFetch again in ${g} millis`),kO(i,y,n,s)}}function gX(i,e){return new Promise((t,n)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);i.addEventListener(()=>{clearTimeout(o),n(Ts.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function mX(i){if(!(i instanceof bo)||!i.customData)return!1;const e=Number(i.customData.httpStatus);return e===429||e===500||e===503||e===504}class yX{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function vX(i,e,t,n,s){if(s&&s.global){i("event",t,n);return}else{const o=await e,l={...n,send_to:o};i("event",t,l)}}async function bX(i,e,t,n){if(n&&n.global){const s={};for(const o of Object.keys(t))s[`user_properties.${o}`]=t[o];return i("set",s),Promise.resolve()}else{const s=await e;i("config",s,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _X(){if(TL())try{await wL()}catch(i){return wi.warn(Ts.create("indexeddb-unavailable",{errorInfo:i==null?void 0:i.toString()}).message),!1}else return wi.warn(Ts.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function SX(i,e,t,n,s,o,l){const c=pX(i);c.then(b=>{t[b.measurementId]=b.appId,i.options.measurementId&&b.measurementId!==i.options.measurementId&&wi.warn(`The measurement ID in the local Firebase config (${i.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>wi.error(b)),e.push(c);const h=_X().then(b=>{if(b)return n.getId()}),[f,g]=await Promise.all([c,h]);lX(o)||nX(o,f.measurementId),s("js",new Date);const y=(l==null?void 0:l.config)??{};return y[KW]="firebase",y.update=!0,g!=null&&(y[XW]=g),s("config",f.measurementId,y),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AX{constructor(e){this.app=e}_delete(){return delete Bh[this.app.options.appId],Promise.resolve()}}let Bh={},HD=[];const GD={};let AE="dataLayer",EX="gtag",zD,Rx,VD=!1;function TX(){const i=[];if(EL()&&i.push("This is a browser extension environment."),x7()||i.push("Cookies are not available."),i.length>0){const e=i.map((n,s)=>`(${s+1}) ${n}`).join(" "),t=Ts.create("invalid-analytics-context",{errorInfo:e});wi.warn(t.message)}}function wX(i,e,t){TX();const n=i.options.appId;if(!n)throw Ts.create("no-app-id");if(!i.options.apiKey)if(i.options.measurementId)wi.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${i.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Ts.create("no-api-key");if(Bh[n]!=null)throw Ts.create("already-exists",{id:n});if(!VD){iX(AE);const{wrappedGtag:o,gtagCore:l}=aX(Bh,HD,GD,AE,EX);Rx=o,zD=l,VD=!0}return Bh[n]=SX(i,HD,GD,e,zD,AE,t),new AX(i)}function xX(i=NL()){i=Cs(i);const e=Ap(i,$b);return e.isInitialized()?e.getImmediate():CX(i)}function CX(i,e={}){const t=Ap(i,$b);if(t.isInitialized()){const s=t.getImmediate();if(pd(e,t.getOptions()))return s;throw Ts.create("already-initialized")}return t.initialize({options:e})}function RX(i,e,t){i=Cs(i),bX(Rx,Bh[i.app.options.appId],e,t).catch(n=>wi.error(n))}function IX(i,e,t,n){i=Cs(i),vX(Rx,Bh[i.app.options.appId],e,t,n).catch(s=>wi.error(s))}const qD="@firebase/analytics",$D="0.10.19";function NX(){Oa(new mo($b,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return wX(n,s,t)},"PUBLIC")),Oa(new mo("analytics-internal",i,"PRIVATE")),fo(qD,$D),fo(qD,$D,"esm2020");function i(e){try{const t=e.getProvider($b).getImmediate();return{logEvent:(n,s,o)=>IX(t,n,s,o),setUserProperties:(n,s)=>RX(t,n,s)}}catch(t){throw Ts.create("interop-component-reg-failed",{reason:t})}}}NX();const MX={apiKey:"AIzaSyDGAI-Y0jWMkkTwVa3pWRYTRnIjeR5IgDo",authDomain:"suitcase-e579b.firebaseapp.com",projectId:"suitcase-e579b",storageBucket:"suitcase-e579b.firebasestorage.app",messagingSenderId:"535507830039",appId:"1:535507830039:web:1380d5f29396b0a614e352",measurementId:"G-1E9GL03TX0"},PO=IL(MX);xX(PO);const $g=oW(PO),yb=i=>({id:i.uid,email:i.email||"",name:i.displayName||"Traveler"}),ww={signup:async(i,e,t)=>{try{const n=await zY($g,e,t);return await $Y(n.user,{displayName:i}),yb({...n.user,displayName:i})}catch(n){throw console.error("Signup Error:",n),new Error(YD(n.code))}},login:async(i,e)=>{try{const t=await VY($g,i,e);return yb(t.user)}catch(t){throw console.error("Login Error:",t),new Error(YD(t.code))}},logout:async()=>{try{await XY($g)}catch(i){console.error("Logout Error",i)}},getCurrentUser:()=>{const i=$g.currentUser;return i?yb(i):null}},YD=i=>{switch(i){case"auth/email-already-in-use":return"That email is already registered.";case"auth/invalid-email":return"Please enter a valid email address.";case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":return"Invalid email or password.";case"auth/weak-password":return"Password should be at least 6 characters.";default:return"Authentication failed. Please try again."}},DX=({onSuccess:i})=>{const[e,t]=J.useState(!0),[n,s]=J.useState(!1),[o,l]=J.useState(null),[c,h]=J.useState(""),[f,g]=J.useState(""),[y,b]=J.useState(""),A=async w=>{w.preventDefault(),l(null),s(!0);try{let x;if(e)x=await ww.login(f,y);else{if(!c.trim())throw new Error("Name is required");x=await ww.signup(c,f,y)}i(x)}catch(x){l(x.message||"Something went wrong")}finally{s(!1)}};return E.jsxs("div",{className:"min-h-screen bg-white flex flex-col md:flex-row relative",children:[E.jsxs("div",{className:"w-full md:w-1/2 bg-[#F5F5F7] p-8 md:p-12 flex flex-col justify-between relative overflow-hidden h-[30vh] md:h-auto",children:[E.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-tr from-blue-200 to-purple-200 rounded-full blur-[80px] opacity-60 animate-float pointer-events-none"}),E.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[E.jsx("div",{className:"p-2 bg-black text-white rounded-xl",children:E.jsx(KD,{size:24})}),E.jsx("span",{className:"font-serif font-bold text-2xl tracking-tight text-gray-900",children:"Suitcase"})]}),E.jsxs("div",{className:"relative z-10 hidden md:block",children:[E.jsxs("h1",{className:"text-5xl lg:text-7xl font-serif font-bold text-gray-900 mb-6 leading-[1.1]",children:["Pack your ",E.jsx("br",{})," ",E.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"imagination."})]}),E.jsx("p",{className:"text-xl text-gray-500 max-w-md leading-relaxed",children:"Your intelligent travel companion for literary journeys. Discover, read, and collect books with smart insights."})]}),E.jsx("div",{className:"relative z-10 md:hidden mt-4",children:E.jsx("h1",{className:"text-3xl font-serif font-bold text-gray-900",children:"Your literary journey starts here."})}),E.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm font-bold text-gray-400 uppercase tracking-widest",children:[E.jsx(Es,{size:16,className:"text-yellow-500"}),E.jsx("span",{children:"Next Gen Library"})]})]}),E.jsx("div",{className:"w-full md:w-1/2 p-8 md:p-20 flex flex-col justify-center bg-white -mt-6 md:mt-0 rounded-t-[2rem] md:rounded-none shadow-[0_-10px_40px_-10px_rgba(0,0,0,0.1)] md:shadow-none z-20",children:E.jsxs("div",{className:"max-w-md w-full mx-auto",children:[E.jsxs("div",{className:"mb-8",children:[E.jsx("h2",{className:"text-3xl font-serif font-bold text-gray-900 mb-2",children:e?"Welcome back":"Create account"}),E.jsx("p",{className:"text-gray-500",children:e?"Enter your details to access your library.":"Start building your digital suitcase today."})]}),o&&E.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-xl flex items-center gap-2 text-sm font-medium animate-in slide-in-from-top-2",children:[E.jsx(wB,{size:16}),o]}),E.jsxs("form",{onSubmit:A,className:"space-y-4",children:[!e&&E.jsxs("div",{className:"space-y-1 animate-in fade-in slide-in-from-bottom-2",children:[E.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Full Name"}),E.jsx("input",{type:"text",value:c,onChange:w=>h(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"Ernest Hemingway"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Email Address"}),E.jsx("input",{type:"email",value:f,onChange:w=>g(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"reader@example.com",autoComplete:"email"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold uppercase text-gray-400 tracking-wider ml-1",children:"Password"}),E.jsx("input",{type:"password",value:y,onChange:w=>b(w.target.value),className:"w-full bg-gray-50 border-2 border-transparent focus:bg-white focus:border-black rounded-2xl px-5 py-4 text-gray-900 font-medium outline-none transition-all",placeholder:"",autoComplete:"current-password"})]}),E.jsx("button",{type:"submit",disabled:n,className:"w-full bg-black text-white py-5 rounded-2xl font-bold text-lg hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 mt-4 shadow-xl shadow-gray-200",children:n?E.jsx(Ta,{className:"animate-spin"}):E.jsxs(E.Fragment,{children:[e?"Sign In":"Create Account"," ",E.jsx(Rw,{size:20})]})})]}),E.jsx("div",{className:"mt-8 text-center",children:E.jsx("button",{onClick:()=>{t(!e),l(null)},className:"text-sm font-semibold text-gray-500 hover:text-black transition-colors",children:e?"New to Suitcase? Create an account":"Already have an account? Log in"})})]})}),E.jsx("div",{className:"absolute bottom-4 right-8 z-30 hidden md:block",children:E.jsxs("p",{className:"text-xs font-medium text-gray-400 flex items-center gap-1",children:["Crafted with ",E.jsx(FB,{size:10,className:"fill-red-400 text-red-400"})," by Yashraj Pardeshi (@incyashraj)"]})})]})},Ia=(i,e)=>`suitcase_${i}_${e}`,kX=(i,e)=>{try{localStorage.setItem(Ia(i,"prefs"),JSON.stringify(e))}catch(t){console.error("Failed to save prefs",t)}},PX=i=>{try{const e=localStorage.getItem(Ia(i,"prefs"));return e?JSON.parse(e):null}catch{return null}},LX=(i,e)=>{try{const t=e.map(n=>({...n,fileUrl:n.isLocal?void 0:n.fileUrl}));localStorage.setItem(Ia(i,"library"),JSON.stringify(t))}catch(t){console.error("Failed to save library",t)}},OX=i=>{try{const e=localStorage.getItem(Ia(i,"library"));return e?JSON.parse(e):[]}catch{return[]}},UX=(i,e)=>{try{localStorage.setItem(Ia(i,"wallet"),JSON.stringify(e))}catch(t){console.error("Failed to save wallet",t)}},FX=i=>{try{const e=localStorage.getItem(Ia(i,"wallet"));return e?JSON.parse(e):{balance:0,nfts:[]}}catch{return{balance:0,nfts:[]}}},BX=i=>{localStorage.removeItem(Ia(i,"prefs")),localStorage.removeItem(Ia(i,"library")),localStorage.removeItem(Ia(i,"wallet")),window.location.reload()};function HX(){const[i,e]=J.useState(null),[t,n]=J.useState("auth"),[s,o]=J.useState(null),[l,c]=J.useState([]),[h,f]=J.useState(null),[g,y]=J.useState({balance:0,nfts:[]}),[b,A]=J.useState(!1),[w,x]=J.useState([]),[N,I]=J.useState([]),[P,k]=J.useState([]),[L,O]=J.useState(""),[F,U]=J.useState(""),[X,q]=J.useState(!1),[Z,ee]=J.useState(!1),[se,le]=J.useState("library"),[ue,ye]=J.useState(!1),[G,$]=J.useState(!1),oe=J.useRef(null),ge=J.useRef(null),Me=J.useRef(null);J.useEffect(()=>{const ae=WY($g,Be=>{if(Be){const Ce=yb(Be);e(Ce),H(Ce.id)}else e(null),n("auth"),A(!0)});return()=>ae()},[]);const H=ae=>{const Be=PX(ae),Ce=OX(ae),Wt=FX(ae);f(Be),c(Ce),y(Wt),A(!0),Be?(n("library"),iE(Be).then(fi=>{fi&&fi.length>0&&I(fi)})):n("onboarding")};J.useEffect(()=>{i&&b&&h&&kX(i.id,h)},[h,b,i]),J.useEffect(()=>{i&&b&&LX(i.id,l)},[l,b,i]),J.useEffect(()=>{i&&b&&UX(i.id,g)},[g,b,i]),J.useEffect(()=>{se==="search"&&ge.current&&ge.current.focus()},[se]),J.useEffect(()=>{var ae;se==="mood"&&((ae=Me.current)==null||ae.scrollIntoView({behavior:"smooth"}))},[P,se]);const K=()=>{const ae=new Date().getHours();return ae<12?"Good morning":ae<18?"Good afternoon":"Good evening"},re=ae=>{e(ae),H(ae.id)},de=async()=>{await ww.logout(),f(null),c([]),y({balance:0,nfts:[]})},_e=ae=>{var Ce;const Be=(Ce=ae.target.files)==null?void 0:Ce[0];Be&&Be.type==="application/pdf"&&Ve(Be)},Se=ae=>{ae.preventDefault(),ae.stopPropagation(),ye(!0)},Te=ae=>{ae.preventDefault(),ae.stopPropagation(),!ae.currentTarget.contains(ae.relatedTarget)&&ye(!1)},Ke=ae=>{ae.preventDefault(),ae.stopPropagation(),ye(!1);const Be=ae.dataTransfer.files;Be&&Be.length>0&&Be[0].type==="application/pdf"&&Ve(Be[0])},Ve=ae=>{const Be={id:`local-${Date.now()}`,title:ae.name.replace(".pdf",""),author:"My Document",description:"Imported PDF document from local device.",coverColor:zt(),fileUrl:URL.createObjectURL(ae),isLocal:!0,categories:["Uploads"],publishedYear:new Date().getFullYear().toString()};c(Ce=>[Be,...Ce]),se!=="library"&&le("library")},zt=()=>{const ae=["#e0f2fe","#f0fdf4","#fdf4ff","#fff1f2","#fefce8"];return ae[Math.floor(Math.random()*ae.length)]},We=async ae=>{if(ae.preventDefault(),!F.trim())return;q(!0),x([]),ee(!1);const Be=await m8(F);x(Be),ee(!0),q(!1)},Fn=async ae=>{if(ae.preventDefault(),!L.trim())return;const Be=L;O(""),q(!0),k(Zn=>[...Zn,{role:"user",text:Be}]);const Ce=P.map(Zn=>({role:Zn.role,text:Zn.text})),{reply:Wt,suggestions:fi}=await y8(Be,Ce);k(Zn=>[...Zn,{role:"model",text:Wt,books:fi}]),q(!1)},at=async ae=>{$(!0),f(ae),y({balance:100,nfts:[]});const Be=new Promise(Zn=>setTimeout(Zn,2500)),Ce=iE(ae),[Wt,fi]=await Promise.all([Be,Ce]);I(fi),$(!1),n("library")},Je=()=>{y(ae=>({...ae,balance:ae.balance+50,nfts:[...ae.nfts,(s==null?void 0:s.id)||"unknown"]}))},mt=(ae,Be)=>{c(Ce=>Ce.map(Wt=>Wt.id===ae?{...Wt,...Be}:Wt)),s&&s.id===ae&&o(Ce=>Ce?{...Ce,...Be}:null)},Vt=ae=>{f(ae),iE(ae).then(I)},Ft=()=>{i&&(BX(i.id),de())},ji=ae=>{const Be=l.find(Ce=>Ce.id===ae.id);o(Be||ae),n("details")},hi=ae=>{const Be=l.find(Ce=>Ce.id===ae.id);if(Be)o(Be);else{const Ce={...ae,lastReadDate:Date.now()};c(Wt=>[Ce,...Wt]),o(Ce)}n("reader")},Ii=()=>{n("library"),o(null)},Rs=({icon:ae,label:Be,isActive:Ce,onClick:Wt})=>E.jsxs("button",{onClick:Wt,className:"group relative flex flex-col items-center justify-center w-12 h-12 rounded-full dock-icon-transition hover:scale-125 hover:-translate-y-2",children:[E.jsx("div",{className:`p-2.5 rounded-full transition-colors duration-300 ${Ce?"bg-blue-50 text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:E.jsx(ae,{size:26,strokeWidth:Ce?2.5:2})}),E.jsx("span",{className:`absolute -bottom-1 w-1.5 h-1.5 rounded-full bg-blue-600 transition-transform duration-300 ${Ce?"scale-100":"scale-0"}`})]});return!b&&t!=="auth"?E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F5F5F7]",children:E.jsx(Ta,{className:"animate-spin text-gray-400"})}):t==="auth"?E.jsx(DX,{onSuccess:re}):t==="onboarding"?E.jsx(r7,{onComplete:at}):G?E.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#F5F5F7] animate-in fade-in duration-500",children:[E.jsx("div",{className:"relative",children:E.jsx(Ca,{size:48,className:"relative text-[#0071e3] mb-4 animate-bounce"})}),E.jsx("h2",{className:"text-xl font-semibold text-[#1d1d1f] mb-1 tracking-tight",children:"Curating your library..."}),E.jsx("p",{className:"text-[#86868b] text-sm",children:"Matching books to you."})]}):E.jsxs("div",{className:"min-h-screen flex flex-col bg-[#F5F5F7] selection:bg-[#B3D7FF] selection:text-black overflow-x-hidden relative",onDragOver:Se,onDragLeave:Te,onDrop:Ke,children:[ue&&E.jsx("div",{className:"fixed inset-0 z-[100] bg-white/80 backdrop-blur-xl border-4 border-[#0071e3] border-dashed m-6 rounded-[24px] flex items-center justify-center pointer-events-none animate-in fade-in duration-200",children:E.jsxs("div",{className:"bg-white px-8 py-6 rounded-[18px] shadow-2xl flex flex-col items-center border border-black/5",children:[E.jsx(qI,{size:32,className:"text-[#0071e3] mb-3 animate-bounce"}),E.jsx("h2",{className:"text-xl font-semibold text-[#1d1d1f] tracking-tight",children:"Drop PDF"})]})}),E.jsxs("div",{className:"fixed top-0 left-0 right-0 z-30 px-6 py-3 flex justify-between items-center pointer-events-none",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(KD,{size:18,className:"text-[#1d1d1f]"}),E.jsx("span",{className:"font-semibold text-sm tracking-tight text-[#1d1d1f] hidden sm:block",children:"Suitcase"})]}),E.jsx("div",{className:"pointer-events-auto flex items-center gap-3",children:E.jsxs("div",{onClick:()=>{le("library"),n("profile")},className:"bg-white/80 backdrop-blur-xl px-3 py-1.5 rounded-full shadow-sm border border-black/5 flex items-center gap-2 hover:scale-105 transition-transform cursor-pointer",children:[E.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-tr from-[#FFD60A] to-[#FF9F0A] flex items-center justify-center shadow-sm",children:E.jsx("span",{className:"text-[9px] font-bold text-white",children:"$"})}),E.jsx("span",{className:"text-xs font-medium text-[#1d1d1f]",children:g.balance})]})})]}),E.jsx("input",{type:"file",ref:oe,className:"hidden",accept:"application/pdf",onChange:_e}),E.jsxs("main",{className:"flex-1 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-24 pb-36 w-full",children:[t==="profile"&&h&&E.jsx(a7,{userPrefs:h,wallet:g,library:l,onClose:()=>n("library"),onUpdateProfile:Vt,onReset:Ft}),t==="library"&&se==="mood"&&h&&E.jsxs("div",{className:"max-w-4xl mx-auto h-[calc(100vh-140px)] flex flex-col",children:[P.length===0?E.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-spring pb-20",children:[E.jsx("div",{className:"animate-float inline-flex items-center justify-center w-20 h-20 bg-gradient-to-tr from-blue-100 to-purple-100 rounded-full mb-6 shadow-xl shadow-blue-100/50",children:E.jsx(Es,{size:32,className:"text-blue-500"})}),E.jsx("h1",{className:"text-4xl md:text-5xl font-serif font-bold text-gray-900 mb-4 tracking-tight",children:"How are you feeling?"}),E.jsx("p",{className:"text-gray-500 text-lg max-w-md mb-8",children:"Tell me your mood, or what you're curious about, and I'll curate a selection just for you."})]}):E.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 pb-24 px-4 scroll-smooth",children:[P.map((ae,Be)=>E.jsxs("div",{className:`flex flex-col ${ae.role==="user"?"items-end":"items-start"} animate-in fade-in slide-in-from-bottom-2`,children:[E.jsx("div",{className:`max-w-[85%] md:max-w-[70%] p-5 rounded-[1.5rem] text-base leading-relaxed shadow-sm ${ae.role==="user"?"bg-black text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none border border-gray-100"}`,children:ae.text}),ae.books&&ae.books.length>0&&E.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-4 w-full",children:ae.books.map(Ce=>E.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-500",children:E.jsx(gv,{book:Ce,onClick:()=>ji(Ce),onRead:Wt=>{Wt.stopPropagation(),hi(Ce)}})},Ce.id))})]},Be)),X&&E.jsx("div",{className:"flex justify-start",children:E.jsxs("div",{className:"bg-white border border-gray-100 p-4 rounded-[1.5rem] rounded-bl-none shadow-sm flex gap-2 items-center text-gray-400",children:[E.jsx(Es,{size:16,className:"animate-pulse"}),E.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Suitcase is thinking..."})]})}),E.jsx("div",{ref:Me})]}),E.jsx("div",{className:`${P.length===0?"relative mb-10":"fixed bottom-24 left-4 right-4 max-w-4xl mx-auto z-40"}`,children:E.jsxs("form",{onSubmit:Fn,className:"relative group",children:[E.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full blur-xl opacity-20 group-hover:opacity-40 transition-opacity"}),E.jsx("input",{type:"text",placeholder:"I want a mystery set in Paris...",className:"w-full relative bg-white/90 backdrop-blur-xl border border-white/60 p-5 pl-8 pr-16 rounded-full text-lg text-gray-900 placeholder:text-gray-400 outline-none shadow-[0_8px_30px_rgb(0,0,0,0.06)] focus:shadow-[0_12px_40px_rgb(0,0,0,0.1)] transition-all duration-300 font-medium",value:L,onChange:ae=>O(ae.target.value),autoFocus:P.length===0}),E.jsx("button",{type:"submit",disabled:!L.trim()||X,className:"absolute right-2 top-2 bottom-2 aspect-square bg-black text-white rounded-full flex items-center justify-center hover:scale-105 transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:X?E.jsx(Ta,{size:18,className:"animate-spin"}):P.length===0?E.jsx(Rw,{size:20}):E.jsx(Iw,{size:18})})]})})]}),t==="library"&&se==="search"&&E.jsxs("div",{className:"max-w-6xl mx-auto animate-spring mt-8",children:[E.jsx("div",{className:"mb-8 max-w-2xl mx-auto relative px-4",children:E.jsxs("div",{className:"relative",children:[E.jsx(wE,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-gray-400 w-6 h-6"}),E.jsx("form",{onSubmit:We,children:E.jsx("input",{ref:ge,type:"text",placeholder:"Search for books, authors...",className:"w-full pl-16 pr-6 py-5 bg-white/90 backdrop-blur-xl border border-white/50 rounded-3xl text-2xl text-gray-900 placeholder:text-gray-300 outline-none shadow-2xl shadow-gray-200/50 transition-all duration-300 font-serif",value:F,onChange:ae=>U(ae.target.value)})}),F&&E.jsx("button",{onClick:()=>{U(""),x([]),ee(!1)},className:"absolute right-6 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-full text-gray-400 transition-colors",children:E.jsx(yl,{size:16})})]})}),X?E.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6 opacity-50 pointer-events-none",children:[1,2,3,4,5].map(ae=>E.jsx("div",{className:"aspect-[2/3] bg-white rounded-2xl animate-pulse"},ae))}):E.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:Z&&w.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-60",children:[E.jsx(MB,{size:64,className:"text-gray-300 mb-4"}),E.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"No books found"}),E.jsx("p",{className:"text-gray-500",children:"Try checking the spelling or use different keywords."})]}):w.length>0&&E.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6",children:w.map(ae=>E.jsx(gv,{book:ae,onClick:()=>ji(ae),onRead:()=>hi(ae)},ae.id))})})]}),t==="library"&&se==="library"&&E.jsxs("div",{className:"animate-in fade-in duration-500 space-y-12",children:[E.jsxs("div",{className:"flex flex-col gap-1 px-2",children:[E.jsxs("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-gray-900",children:[K(),", ",(i==null?void 0:i.name.split(" ")[0])||"Traveler","."]}),E.jsx("p",{className:"text-gray-500",children:"Ready to continue your journey?"})]}),N.length>0&&E.jsxs("section",{children:[E.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Es,{size:18,className:"text-blue-500"}),E.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"For You"})]}),E.jsxs("button",{className:"text-xs font-bold text-gray-400 hover:text-gray-900 flex items-center gap-1",children:["View All ",E.jsx(Dv,{size:12})]})]}),E.jsx("div",{className:"flex gap-6 overflow-x-auto pb-8 -mx-4 px-4 scrollbar-hide snap-x snap-mandatory",children:N.map(ae=>E.jsx("div",{className:"min-w-[160px] md:min-w-[180px] snap-start",children:E.jsx(gv,{book:ae,onClick:()=>ji(ae),onRead:()=>hi(ae)})},ae.id))})]}),E.jsxs("section",{children:[E.jsxs("div",{className:"flex items-end justify-between mb-6 px-2 border-b border-gray-200 pb-2",children:[E.jsx("h2",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Your Suitcase"}),E.jsxs("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest bg-white px-2 py-1 rounded-md border border-gray-100",children:[l.length," Items"]})]}),l.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 rounded-3xl transition-all cursor-pointer group bg-white border border-gray-100 hover:border-blue-200 hover:shadow-lg",onClick:()=>{var ae;return(ae=oe.current)==null?void 0:ae.click()},children:[E.jsx("div",{className:"relative mb-4",children:E.jsx("div",{className:"animate-float relative bg-blue-50 w-20 h-20 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-500",children:E.jsx(qI,{className:"text-blue-600 w-8 h-8"})})}),E.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"It's empty here"}),E.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Upload a PDF to start reading."}),E.jsx("button",{className:"bg-[#073642] text-[#fdf6e3] px-6 py-2 rounded-full text-sm font-bold hover:bg-[#002b36] transition-colors",children:"Import Book"})]}):E.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-x-6 gap-y-10",children:[E.jsxs("button",{onClick:()=>{var ae;return(ae=oe.current)==null?void 0:ae.click()},className:"aspect-[2/3] rounded-xl bg-[#E5E5EA] border border-dashed border-[#d2d2d7] hover:border-[#0071e3] hover:bg-[#0071e3]/5 transition-all group flex flex-col items-center justify-center gap-2",children:[E.jsx("div",{className:"w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center text-[#86868b] group-hover:text-[#0071e3] transition-colors",children:E.jsx(a3,{size:20})}),E.jsx("span",{className:"text-[11px] font-semibold text-[#86868b] group-hover:text-[#0071e3] uppercase tracking-wide",children:"Add Book"})]}),l.map(ae=>E.jsx(gv,{book:ae,onClick:()=>ji(ae),onRead:()=>hi(ae)},ae.id))]})]})]})]}),t!=="reader"&&E.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40 animate-in slide-in-from-bottom-12 duration-1000 ease-out",children:E.jsxs("div",{className:"flex items-center gap-1 p-1.5 px-3 rounded-[20px] shadow-[0_12px_32px_rgba(0,0,0,0.08)] bg-white/80 backdrop-blur-xl border border-white/40 ring-1 ring-black/5 scale-90 origin-bottom",children:[E.jsx(Rs,{icon:zB,label:"Library",isActive:t==="library"&&se==="library",onClick:()=>{n("library"),le("library")}}),E.jsx(Rs,{icon:Es,label:"Concierge",isActive:t==="library"&&se==="mood",onClick:()=>{n("library"),le("mood")}}),E.jsx(Rs,{icon:wE,label:"Search",isActive:t==="library"&&se==="search",onClick:()=>{n("library"),le("search")}}),E.jsx(Rs,{icon:QD,label:"Profile",isActive:t==="profile",onClick:()=>{n("profile")}})]})}),t==="details"&&s&&E.jsx(T8,{book:s,onClose:Ii,onRead:()=>hi(s)}),t==="reader"&&s&&E.jsx("div",{className:"fixed inset-0 z-50",children:E.jsx(n7,{book:s,onClose:Ii,onReward:Je,onUpdateBookData:mt})})]})}const LO=document.getElementById("root");if(!LO)throw new Error("Could not find root element to mount to");const GX=oB.createRoot(LO);GX.render(E.jsx(QF.StrictMode,{children:E.jsx(HX,{})}));
